<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm DDA: src/magic.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm DDA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">magic.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="magic_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="magic_8h.html">magic.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="avatar_8h.html">avatar.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="bodypart_8h.html">bodypart.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="calendar_8h.html">calendar.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cata__utility_8h.html">cata_utility.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="catacharset_8h.html">catacharset.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="character_8h.html">character.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="color_8h.html">color.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="condition_8h.html">condition.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="creature_8h.html">creature.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="creature__tracker_8h.html">creature_tracker.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cursesdef_8h.html">cursesdef.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="damage_8h.html">damage.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="debug_8h.html">debug.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="enum__conversions_8h.html">enum_conversions.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="enums_8h.html">enums.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="event_8h.html">event.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="event__bus_8h.html">event_bus.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="field_8h.html">field.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="generic__factory_8h.html">generic_factory.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="input__context_8h.html">input_context.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="inventory_8h.html">inventory.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="item_8h.html">item.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="json_8h.html">json.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="line_8h.html">line.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="localized__comparator_8h.html">localized_comparator.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="magic__enchantment_8h.html">magic_enchantment.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map_8h.html">map.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map__iterator_8h.html">map_iterator.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="messages_8h.html">messages.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mongroup_8h.html">mongroup.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="monster_8h.html">monster.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mtype_8h.html">mtype.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutation_8h.html">mutation.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="npc_8h.html">npc.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="output_8h.html">output.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pimpl_8h.html">pimpl.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="point_8h.html">point.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="projectile_8h.html">projectile.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="requirements_8h.html">requirements.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rng_8h.html">rng.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sounds_8h.html">sounds.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="string__formatter_8h.html">string_formatter.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="translations_8h.html">translations.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ui_8h.html">ui.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="units_8h.html">units.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="magic_8cpp.html#affad52c1fd604b4619fae07ee57a714d">   56</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">json_character_flag</a> <a class="code" href="magic_8cpp.html#affad52c1fd604b4619fae07ee57a714d">json_flag_NO_PSIONICS</a>( <span class="stringliteral">&quot;NO_PSIONICS&quot;</span> );</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a3a15cd3f4a620df4e0fc5b4ecb0111af">   57</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">json_character_flag</a> <a class="code" href="magic_8cpp.html#a3a15cd3f4a620df4e0fc5b4ecb0111af">json_flag_NO_SPELLCASTING</a>( <span class="stringliteral">&quot;NO_SPELLCASTING&quot;</span> );</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="magic_8cpp.html#ad199c3bc7a5d8202c5122a34588b792e">   58</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">json_character_flag</a> <a class="code" href="magic_8cpp.html#ad199c3bc7a5d8202c5122a34588b792e">json_flag_SILENT_SPELL</a>( <span class="stringliteral">&quot;SILENT_SPELL&quot;</span> );</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a7e54b3fea40776c033ce3476443d8eed">   59</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">json_character_flag</a> <a class="code" href="magic_8cpp.html#a7e54b3fea40776c033ce3476443d8eed">json_flag_SUBTLE_SPELL</a>( <span class="stringliteral">&quot;SUBTLE_SPELL&quot;</span> );</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a590ef3994731209005acce4df397de71">   61</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">skill_id</a> <a class="code" href="magic_8cpp.html#a590ef3994731209005acce4df397de71">skill_spellcraft</a>( <span class="stringliteral">&quot;spellcraft&quot;</span> );</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">   63</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">trait_id</a> <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a>( <span class="stringliteral">&quot;NONE&quot;</span> );</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="magic_8cpp.html#ad62eb3216b3dd4152ccd605b3803b5aa">   65</a></span>&#160;<span class="keyword">static</span> std::string <a class="code" href="magic_8cpp.html#ad62eb3216b3dd4152ccd605b3803b5aa">target_to_string</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7">spell_target</a> data )</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">switch</span>( data ) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a2ad733df56aaafa5650bafc9c98c6ffb">spell_target::ally</a>:</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a>( <span class="stringliteral">&quot;Valid spell target&quot;</span>, <span class="stringliteral">&quot;ally&quot;</span> );</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a8e20e5f0a627b4dd4dedc41a597ab672">spell_target::hostile</a>:</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a>( <span class="stringliteral">&quot;Valid spell target&quot;</span>, <span class="stringliteral">&quot;hostile&quot;</span> );</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a590f53e8699817c6fa498cc11a4cbe63">spell_target::self</a>:</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a>( <span class="stringliteral">&quot;Valid spell target&quot;</span>, <span class="stringliteral">&quot;self&quot;</span> );</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a578552719239a72a2d45ad422f67d24d">spell_target::ground</a>:</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a>( <span class="stringliteral">&quot;Valid spell target&quot;</span>, <span class="stringliteral">&quot;ground&quot;</span> );</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a334c4a4c42fdb79d7ebc3e73b517e6f8">spell_target::none</a>:</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a>( <span class="stringliteral">&quot;Valid spell target&quot;</span>, <span class="stringliteral">&quot;none&quot;</span> );</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc">spell_target::item</a>:</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a>( <span class="stringliteral">&quot;Valid spell target&quot;</span>, <span class="stringliteral">&quot;item&quot;</span> );</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a06e3d36fa30cea095545139854ad1fb9">spell_target::field</a>:</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a>( <span class="stringliteral">&quot;Valid spell target&quot;</span>, <span class="stringliteral">&quot;field&quot;</span> );</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a6a406aeb26461172ad7d4e04543dcc48">spell_target::num_spell_targets</a>:</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Invalid valid_target&quot;</span> );</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;THIS IS A BUG&quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceio.html">io</a></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">// *INDENT-OFF*</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="namespaceio.html#acc8d7dc9e887c8b157bf1299c9fcd0ee">   93</a></span>&#160;std::string <a class="code" href="namespaceio.html#acc8d7dc9e887c8b157bf1299c9fcd0ee">enum_to_string&lt;spell_target&gt;</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7">spell_target</a> data )</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">switch</span>( data ) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a2ad733df56aaafa5650bafc9c98c6ffb">spell_target::ally</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;ally&quot;</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a8e20e5f0a627b4dd4dedc41a597ab672">spell_target::hostile</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;hostile&quot;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a590f53e8699817c6fa498cc11a4cbe63">spell_target::self</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;self&quot;</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a578552719239a72a2d45ad422f67d24d">spell_target::ground</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;ground&quot;</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a334c4a4c42fdb79d7ebc3e73b517e6f8">spell_target::none</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;none&quot;</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc">spell_target::item</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;item&quot;</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a06e3d36fa30cea095545139854ad1fb9">spell_target::field</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;field&quot;</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a6a406aeb26461172ad7d4e04543dcc48">spell_target::num_spell_targets</a>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="debug_8h.html#a78e9818ca59dd528129905767f99fcc5">cata_fatal</a>( <span class="stringliteral">&quot;Invalid valid_target&quot;</span> );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="namespaceio.html#a83a97f58da1856e663769bfd6760c4bc">  108</a></span>&#160;std::string <a class="code" href="namespaceio.html#a83a97f58da1856e663769bfd6760c4bc">enum_to_string&lt;spell_shape&gt;</a>( <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9c">spell_shape</a> data )</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">switch</span>( data ) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca9e1b93b20faf4a4798c106c0db299473">spell_shape::blast</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;blast&quot;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca29d6fc960c94b5a330f850284e75ab1f">spell_shape::cone</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;cone&quot;</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">spell_shape::line</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;line&quot;</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca94b7959740e5e38e177a4087ac6fffcd">spell_shape::num_shapes</a>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="debug_8h.html#a78e9818ca59dd528129905767f99fcc5">cata_fatal</a>( <span class="stringliteral">&quot;Invalid spell_shape&quot;</span> );</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="namespaceio.html#aa9fc27bb3026b3bb037c509994b7c1f3">  119</a></span>&#160;std::string <a class="code" href="namespaceio.html#aa9fc27bb3026b3bb037c509994b7c1f3">enum_to_string&lt;spell_flag&gt;</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197b">spell_flag</a> data )</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">switch</span>( data ) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba54bcf9b291726b4cf8343f61681a5cfd">spell_flag::PERMANENT</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;PERMANENT&quot;</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba82397545cee465e4bda1cb70ef78c0f0">spell_flag::PERMANENT_ALL_LEVELS</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;PERMANENT_ALL_LEVELS&quot;</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba83ce92712f6d8aea3340cd5dcc2158f4">spell_flag::PERCENTAGE_DAMAGE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;PERCENTAGE_DAMAGE&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bab81bbaf3469acdc62858db28297bfa0e">spell_flag::IGNORE_WALLS</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;IGNORE_WALLS&quot;</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba54cdca63f8089e9058dff2c73ef37831">spell_flag::NO_PROJECTILE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;NO_PROJECTILE&quot;</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bab981b82e2e1e66ac734a980c4b8bf3bd">spell_flag::HOSTILE_SUMMON</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;HOSTILE_SUMMON&quot;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba58cc7b1820751d4103b0014007be83f3">spell_flag::HOSTILE_50</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;HOSTILE_50&quot;</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bae674ff44932849359ce070ea3ee6ca84">spell_flag::FRIENDLY_POLY</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;FRIENDLY_POLY&quot;</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba315fc579dd9a280bceb7e5845c5cc675">spell_flag::POLYMORPH_GROUP</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;POLYMORPH_GROUP&quot;</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba7e92d833d7720dbe631730a6cea03346">spell_flag::SILENT</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;SILENT&quot;</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197baf74dd9cac3d1ddf2d67b8946417328ca">spell_flag::NO_EXPLOSION_SFX</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;NO_EXPLOSION_SFX&quot;</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba658a021a796aa5501503220adb38cf45">spell_flag::LOUD</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOUD&quot;</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba604cda0a87a71f133cff82d25d1195c2">spell_flag::VERBAL</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;VERBAL&quot;</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba7f3501211ea094337741cf2259a3e333">spell_flag::SOMATIC</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;SOMATIC&quot;</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197baf3e1ebf88738c62c2ae49c2319642213">spell_flag::NO_HANDS</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;NO_HANDS&quot;</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba5b16e7a428e2fc90a37998f0fb12631f">spell_flag::NO_LEGS</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;NO_LEGS&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba4a55e275f9b875f2d9419cb72ebc4d97">spell_flag::UNSAFE_TELEPORT</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;UNSAFE_TELEPORT&quot;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bae93770c51d7965a32c742fadf5aa635f">spell_flag::TARGET_TELEPORT</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;TARGET_TELEPORT&quot;</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197badcff654db70678d152058c282d87aa8b">spell_flag::SWAP_POS</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;SWAP_POS&quot;</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba0297e660e18811956462c321349a263c">spell_flag::CONCENTRATE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;CONCENTRATE&quot;</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6281a96f78b881bbd1821d8834054992">spell_flag::RANDOM_AOE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;RANDOM_AOE&quot;</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba24ae034aca7659a9c3b08c3df679b065">spell_flag::RANDOM_DAMAGE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;RANDOM_DAMAGE&quot;</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac17984263d7ed29c73a2b4fe8f783030">spell_flag::RANDOM_DURATION</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;RANDOM_DURATION&quot;</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba95aa3650620c7879b3276744d8284b0d">spell_flag::RANDOM_TARGET</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;RANDOM_TARGET&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba501200349c2d922a2e4c5eb5d6cde0c5">spell_flag::RANDOM_CRITTER</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;RANDOM_CRITTER&quot;</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba66c5da0bf17c3aeb5d116a41cf020e0b">spell_flag::MUTATE_TRAIT</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;MUTATE_TRAIT&quot;</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba8d901ff21b8710b02926205b244cd30d">spell_flag::PAIN_NORESIST</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;PAIN_NORESIST&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba0169f99da4a426e9b5b04c43733d8ec8">spell_flag::SPAWN_GROUP</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;SPAWN_GROUP&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba2286362f6c079bf6e2dfdf7e62068021">spell_flag::IGNITE_FLAMMABLE</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;IGNITE_FLAMMABLE&quot;</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba60c0bff03788dc44e951565aa413a637">spell_flag::NO_FAIL</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;NO_FAIL&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac1324f642ae16e50278d5fad88240254">spell_flag::WONDER</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;WONDER&quot;</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197baeda01abd967f7e1e749ce88aab441d33">spell_flag::EXTRA_EFFECTS_FIRST</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;EXTRA_EFFECTS_FIRST&quot;</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba32c2090ece9876c90fa493fc4054151a">spell_flag::MUST_HAVE_CLASS_TO_LEARN</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;MUST_HAVE_CLASS_TO_LEARN&quot;</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba340031a71f628a23e6215861f612401b">spell_flag::SPAWN_WITH_DEATH_DROPS</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;SPAWN_WITH_DEATH_DROPS&quot;</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba19813152707f85385e889ef54cdd266b">spell_flag::NO_CORPSE_QUIET</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;NO_CORPSE_QUIET&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac069ee334aa83ece77ad0af5bd596ec2">spell_flag::NON_MAGICAL</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;NON_MAGICAL&quot;</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;PSIONIC&quot;</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bae2952c753df986965413041d46f4ba2c">spell_flag::RECHARM</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;RECHARM&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197baf447f5c03508de4d88e340390ba7c78f">spell_flag::LAST</a>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="debug_8h.html#a78e9818ca59dd528129905767f99fcc5">cata_fatal</a>( <span class="stringliteral">&quot;Invalid spell_flag&quot;</span> );</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="namespaceio.html#a6349530d530232624735ee7a4e4dc04b">  165</a></span>&#160;std::string <a class="code" href="namespaceio.html#a6349530d530232624735ee7a4e4dc04b">enum_to_string&lt;magic_energy_type&gt;</a>( <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1">magic_energy_type</a> data )</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">switch</span>( data ) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d">magic_energy_type::bionic</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;BIONIC&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;HP&quot;</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f">magic_energy_type::mana</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;MANA&quot;</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8">magic_energy_type::none</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;NONE&quot;</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">magic_energy_type::stamina</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;STAMINA&quot;</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a98bd1c45684cf587ac2347a92dd7bb51">magic_energy_type::last</a>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="debug_8h.html#a78e9818ca59dd528129905767f99fcc5">cata_fatal</a>( <span class="stringliteral">&quot;Invalid magic_energy_type&quot;</span> );</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">// *INDENT-ON*</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;} <span class="comment">// namespace io</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">const</span> std::optional&lt;int&gt; <a class="code" href="structfake__spell.html#a351ade87eb87a5db164447a626d7aef7">fake_spell::max_level_default</a> = std::nullopt;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structfake__spell.html#aa3e038ff6094f65acb5293dccff578c3">fake_spell::level_default</a> = 0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structfake__spell.html#a6c5ae8a2fbe530336f41d6a09530f561">fake_spell::self_default</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structfake__spell.html#a1c7c420c1d92ae415db6e26df163b1ec">fake_spell::trigger_once_in_default</a> = 1;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keyword">const</span> <a class="code" href="classstring__id.html">skill_id</a> <a class="code" href="classspell__type.html#ae2e0120de261304cf182bbef5700c492">spell_type::skill_default</a> = <a class="code" href="magic_8cpp.html#a590ef3994731209005acce4df397de71">skill_spellcraft</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">// empty string</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keyword">const</span> <a class="code" href="classstring__id.html">requirement_id</a> <a class="code" href="classspell__type.html#acae42f8b49667db0c62b6982351359c5">spell_type::spell_components_default</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keyword">const</span> <a class="code" href="classtranslation.html">translation</a> <a class="code" href="classspell__type.html#a0a1613360b65577766130af10b7527ae">spell_type::message_default</a> = <a class="code" href="translation_8cpp.html#a176e288c640c6506a86330cb10fbe13a">to_translation</a>( <span class="stringliteral">&quot;You cast %s!&quot;</span> );</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keyword">const</span> <a class="code" href="classtranslation.html">translation</a> <a class="code" href="classspell__type.html#a21afbf660e1de0739ec37cfe8cc409d5">spell_type::sound_description_default</a> = <a class="code" href="translation_8cpp.html#a176e288c640c6506a86330cb10fbe13a">to_translation</a>( <span class="stringliteral">&quot;an explosion.&quot;</span> );</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keyword">const</span> <a class="code" href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3">sounds::sound_t</a> <a class="code" href="classspell__type.html#a2fb4614f39f5253b86d6095192dc4a97">spell_type::sound_type_default</a> = <a class="code" href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3ac222ae0d4e9c59bd254b72521b9e74ed">sounds::sound_t::combat</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classspell__type.html#a5e3c1434fc8d2303d503aa2f901e0a37">spell_type::sound_ambient_default</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">// empty string</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keyword">const</span> std::string <a class="code" href="classspell__type.html#aef9dc4b5d446dc53a65b206bc1ee2ecf">spell_type::sound_id_default</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keyword">const</span> std::string <a class="code" href="classspell__type.html#a6d74ff9fdcc59a96412c9bdeb73e69e0">spell_type::sound_variant_default</a> = <span class="stringliteral">&quot;default&quot;</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">// empty string</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keyword">const</span> std::string <a class="code" href="classspell__type.html#a6f2ea5fc2b28d67cc32a65b4227acc23">spell_type::effect_str_default</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="keyword">const</span> std::optional&lt;field_type_id&gt; <a class="code" href="classspell__type.html#a641c1dbe678475ecc72974c15aaa77a4">spell_type::field_default</a> = std::nullopt;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a468c48b7d109cc65c14f72af881125f1">spell_type::field_chance_default</a> = 1;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#afaaa44863d219ad483b230fc41bdebab">spell_type::min_field_intensity_default</a> = 0;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a8cc4f2167f1ea512d9e462cf5ae8fda5">spell_type::max_field_intensity_default</a> = 0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#ae352f61f100a46df52791a975dd754f9">spell_type::field_intensity_increment_default</a> = 0.0f;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#ac10338c30d2989699573e02cd5f60135">spell_type::field_intensity_variance_default</a> = 0.0f;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a4013ffcfd9071b49699038d4120749cb">spell_type::min_accuracy_default</a> = 20;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#a80f705529ff936de2cbb7e67720c41a4">spell_type::accuracy_increment_default</a> = 0.0f;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#ab4ab3a7ce1ea8d0f57b9ebac8c45f06f">spell_type::max_accuracy_default</a> = 20;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a88a5469428a3df2f93daba51a4c21803">spell_type::min_damage_default</a> = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#a3afdff53a2be2c160fadc0cd4833bb8e">spell_type::damage_increment_default</a> = 0.0f;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a9c0dafac52e934828f652ae49c111ffb">spell_type::max_damage_default</a> = 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a97a4eea59f0c7dcbbadf32f7038dd742">spell_type::min_range_default</a> = 0;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#af6d3542c439bdfbd6c34157d686af9fe">spell_type::range_increment_default</a> = 0.0f;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#ad2bc4f5cfc43f8fddbab8ee7d464fbbd">spell_type::max_range_default</a> = 0;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a41cd20e0a5993d5f3a378bc0339ae918">spell_type::min_aoe_default</a> = 0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#a12a2f88598abde1c5913628dee45e882">spell_type::aoe_increment_default</a> = 0.0f;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#aad4fa941a70475847d13e1de3862c965">spell_type::max_aoe_default</a> = 0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a9705a52b5936dfba68763b9ebb173788">spell_type::min_dot_default</a> = 0;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#a7d91bdf3d04bd110e544bb401778fe6a">spell_type::dot_increment_default</a> = 0.0f;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a737a48fb1019ec08d21a3a0b241779c4">spell_type::max_dot_default</a> = 0;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#aa35f381ae36b923d5eb8759087bd3ddd">spell_type::min_duration_default</a> = 0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a16fd458bb92e74815eb9fb928fbe97ad">spell_type::duration_increment_default</a> = 0;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#ad4ed1c14fab837303d765643f1fd2dd8">spell_type::max_duration_default</a> = 0;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a85d117bedc34d5780a37a7fb82d294b7">spell_type::min_pierce_default</a> = 0;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#ad56ab0a53c5ed44bf7b40977e8b3bb28">spell_type::pierce_increment_default</a> = 0.0f;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#aa77544331a0516008a5a39fb527a5b9f">spell_type::max_pierce_default</a> = 0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#ac6581e716558984035ff45c6a2b4ddb8">spell_type::base_energy_cost_default</a> = 0;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#af26dbfb0a777931b4a0449af83758ab0">spell_type::energy_increment_default</a> = 0.0f;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keyword">const</span> <a class="code" href="classstring__id.html">trait_id</a> <a class="code" href="classspell__type.html#aaf35eb6ac32a3c4e3458c38c5fd627d4">spell_type::spell_class_default</a> = <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keyword">const</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1">magic_energy_type</a> <a class="code" href="classspell__type.html#a3be2c0ad4d9749e8a1dc35dcf7f80429">spell_type::energy_source_default</a> = <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8">magic_energy_type::none</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keyword">const</span> <a class="code" href="classstring__id.html">damage_type_id</a> <a class="code" href="classspell__type.html#af13dedd3462cf8d0e0a81fb024d05976">spell_type::dmg_type_default</a> = <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">damage_type_id::NULL_ID</a>();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#a232bcad60b60e42ff8ee884aa26837ab">spell_type::difficulty_default</a> = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#abf6f5f121eafafc780f381abefd1ae89">spell_type::max_level_default</a> = 0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classspell__type.html#ae9a03b4bdfa2041bb5f7a2431ad3cfe9">spell_type::base_casting_time_default</a> = 0;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="classspell__type.html#aea0732988fd57d4da9622f8505d0c23d">spell_type::casting_time_increment_default</a> = 0.0f;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">// LOADING</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">// spell_type</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02magic_8cpp_03.html">  238</a></span>&#160;<span class="keyword">namespace</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">  240</a></span>&#160;<a class="code" href="classgeneric__factory.html">generic_factory&lt;spell_type&gt;</a> <a class="code" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">spell_factory</a>( <span class="stringliteral">&quot;spell&quot;</span> );</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keyword">const</span> <a class="code" href="classspell__type.html">spell_type</a> &amp;<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">string_id&lt;spell_type&gt;::obj</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">spell_factory</a>.obj( *<span class="keyword">this</span> );</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keyword">template</span>&lt;&gt;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classstring__id.html#a8ca0e76fa665125f1e50bd1ed8dbd213">string_id&lt;spell_type&gt;::is_valid</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">spell_factory</a>.is_valid( *<span class="keyword">this</span> );</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="classspell__type.html#acb7db60423fe07ce71c9a07697c8870d">  255</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell__type.html#acb7db60423fe07ce71c9a07697c8870d">spell_type::load_spell</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;jo, <span class="keyword">const</span> std::string &amp;src )</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">spell_factory</a>.load( jo, <a class="code" href="classspell__type.html#a8a299f32ae67edfb733d424000042d91">src</a> );</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a9f6573c11f8d6e7562a97ba6f807396e">  260</a></span>&#160;<span class="keyword">static</span> std::string <a class="code" href="magic_8cpp.html#a9f6573c11f8d6e7562a97ba6f807396e">moves_to_string</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> moves )</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span>( moves &lt; to_moves&lt;int&gt;( 2_seconds ) ) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#a45dd4e3da9b83845bcd1c2d8e80cf802">n_gettext</a>( <span class="stringliteral">&quot;%d move&quot;</span>, <span class="stringliteral">&quot;%d moves&quot;</span>, moves ), moves );</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">to_string</a>( <a class="code" href="classtime__duration.html#aacd074821aecb38a24d9ce6ca42a9127">time_duration::from_moves</a>( moves ) );</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="classspell__type.html#af764a45351f8495b3b1708ef8a05b937">  269</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell__type.html#af764a45351f8495b3b1708ef8a05b937">spell_type::load</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;jo, <span class="keyword">const</span> std::string_view src )</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;{</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="classspell__type.html#afca82c905601cf50d72c07a65dc56f11">src_mod</a> = <a class="code" href="type__id_8h.html#aabcbcb9fb77661ba75c47b6287318e03">mod_id</a>( <a class="code" href="classspell__type.html#a8a299f32ae67edfb733d424000042d91">src</a> );</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="overmap_8cpp.html#a1aa258a4b1427766c283c1ae9ea81f05ac5e3b9675d114c21ad3367d318f6aa95">mandatory</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;name&quot;</span>, <a class="code" href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">name</a> );</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="overmap_8cpp.html#a1aa258a4b1427766c283c1ae9ea81f05ac5e3b9675d114c21ad3367d318f6aa95">mandatory</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;description&quot;</span>, <a class="code" href="classspell__type.html#a0bf174d1f3134b53667d8381c02d6ee4">description</a> );</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;skill&quot;</span>, <a class="code" href="classspell__type.html#abd2cfd23c656755b0f887064683d9e13">skill</a>, <a class="code" href="classspell__type.html#ae2e0120de261304cf182bbef5700c492">skill_default</a> );</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;teachable&quot;</span>, <a class="code" href="classspell__type.html#ad9cd92ba641b2fd6c48e80bcd6ba40bc">teachable</a>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;components&quot;</span>, <a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>, <a class="code" href="classspell__type.html#acae42f8b49667db0c62b6982351359c5">spell_components_default</a> );</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;message&quot;</span>, <a class="code" href="classspell__type.html#a1e5fb7d2cfe305bd5b26dccdce21273b">message</a>, <a class="code" href="classspell__type.html#a0a1613360b65577766130af10b7527ae">message_default</a> );</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;sound_description&quot;</span>, <a class="code" href="classspell__type.html#a868516b343411f98fcf2a2c961de01cb">sound_description</a>, <a class="code" href="classspell__type.html#a21afbf660e1de0739ec37cfe8cc409d5">sound_description_default</a> );</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;sound_type&quot;</span>, <a class="code" href="classspell__type.html#a2dc22c6c8d58f23f22a4a9b72cd7eed7">sound_type</a>, <a class="code" href="classspell__type.html#a2fb4614f39f5253b86d6095192dc4a97">sound_type_default</a> );</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;sound_ambient&quot;</span>, <a class="code" href="classspell__type.html#ac5fb63c1cb3f31f1c705e9988e882e4a">sound_ambient</a>, <a class="code" href="classspell__type.html#a5e3c1434fc8d2303d503aa2f901e0a37">sound_ambient_default</a> );</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;sound_id&quot;</span>, <a class="code" href="classspell__type.html#a91953b9d5715f36608e753b3fc5e805d">sound_id</a>, <a class="code" href="classspell__type.html#aef9dc4b5d446dc53a65b206bc1ee2ecf">sound_id_default</a> );</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;sound_variant&quot;</span>, <a class="code" href="classspell__type.html#a8a9f3e75988d34cf9e89abfec583ba67">sound_variant</a>, <a class="code" href="classspell__type.html#a6d74ff9fdcc59a96412c9bdeb73e69e0">sound_variant_default</a> );</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="overmap_8cpp.html#a1aa258a4b1427766c283c1ae9ea81f05ac5e3b9675d114c21ad3367d318f6aa95">mandatory</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;effect&quot;</span>, <a class="code" href="classspell__type.html#afa2cd70d2587c495c1565209b2292a36">effect_name</a> );</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> found_effect = <a class="code" href="namespacespell__effect.html#aa73cea2405311f4cb14c4d4c34ae027e">spell_effect::effect_map</a>.find( <a class="code" href="classspell__type.html#afa2cd70d2587c495c1565209b2292a36">effect_name</a> );</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span>( found_effect == <a class="code" href="namespacespell__effect.html#aa73cea2405311f4cb14c4d4c34ae027e">spell_effect::effect_map</a>.cend() ) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="classeffect.html">effect</a> = <a class="code" href="namespacespell__effect.html#a853f1ec509f13190ef10d85be9bf657e">spell_effect::none</a>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: spell %s has invalid effect %s&quot;</span>, <span class="keywordtype">id</span>.c_str(), <a class="code" href="classspell__type.html#afa2cd70d2587c495c1565209b2292a36">effect_name</a> );</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="classeffect.html">effect</a> = found_effect-&gt;second;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="overmap_8cpp.html#a1aa258a4b1427766c283c1ae9ea81f05ac5e3b9675d114c21ad3367d318f6aa95">mandatory</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;shape&quot;</span>, <a class="code" href="classspell__type.html#abf08fe1f454fd0649d9855104630afe4">spell_area</a> );</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="classspell__type.html#a5d51ae843768a4cacadb5e88cf871ebe">spell_area_function</a> = <a class="code" href="namespacespell__effect.html#a119ecf99be57db7f769f97c984531cf0">spell_effect::shape_map</a>.at( <a class="code" href="classspell__type.html#abf08fe1f454fd0649d9855104630afe4">spell_area</a> );</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> targeted_monster_ids_reader = <a class="code" href="classstring__id__reader.html">string_id_reader&lt;::mtype&gt;</a> {};</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;targeted_monster_ids&quot;</span>, <a class="code" href="classspell__type.html#af64d6acee71a4ba9f6a51459fddb9953">targeted_monster_ids</a>,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;              targeted_monster_ids_reader );</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> targeted_monster_species_reader = <a class="code" href="classstring__id__reader.html">string_id_reader&lt;::species_type&gt;</a> {};</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;targeted_monster_species&quot;</span>, <a class="code" href="classspell__type.html#a60c88145cf9b37dfe7b141b143095246">targeted_species_ids</a>,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;              targeted_monster_species_reader );</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ignored_monster_species_reader = <a class="code" href="classstring__id__reader.html">string_id_reader&lt;::species_type&gt;</a> {};</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;ignored_monster_species&quot;</span>, <a class="code" href="classspell__type.html#a48f952d3f551b2cab4fdb46087613c48">ignored_species_ids</a>,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;              ignored_monster_species_reader );</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> trigger_reader = <a class="code" href="classenum__flags__reader.html">enum_flags_reader&lt;spell_target&gt;</a> { <span class="stringliteral">&quot;valid_targets&quot;</span> };</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="overmap_8cpp.html#a1aa258a4b1427766c283c1ae9ea81f05ac5e3b9675d114c21ad3367d318f6aa95">mandatory</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;valid_targets&quot;</span>, <a class="code" href="classspell__type.html#ae696150ec8cf81bc7a35102c562d4517">valid_targets</a>, trigger_reader );</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;extra_effects&quot;</span>, <a class="code" href="classspell__type.html#addae5132e10abe659f19d1575547d185">additional_spells</a> );</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;affected_body_parts&quot;</span>, <a class="code" href="classspell__type.html#ad2ddb53d6c4f656d913e5093d84f1ad6">affected_bps</a> );</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">if</span>( jo.<a class="code" href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">has_array</a>( <span class="stringliteral">&quot;flags&quot;</span> ) ) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;flag : jo.<a class="code" href="classJsonObject.html#a332ecdfbbcefd21204fad5e03ff43735">get_string_array</a>( <span class="stringliteral">&quot;flags&quot;</span> ) ) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="comment">// Save all provided flags as strings in spell_type.flags</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="comment">// If the flag is listed as a possible enum of type spell_flag, we also save it to spell_type.spell_tags</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <a class="code" href="classspell__type.html#a40d30bd9621c0f8c64b488bed2a0ce51">flags</a>.insert( flag );</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            std::optional&lt;spell_flag&gt; f = io::string_to_enum_optional&lt;spell_flag&gt;( flag );</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="keywordflow">if</span>( f.has_value() ) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                <a class="code" href="classspell__type.html#a74d93ff32c5d02d21548e7164e39b7f1">spell_tags</a>.<a class="code" href="classenum__bitset.html#a4817796a50f9f258865e0413ff1f91f9">set</a>( f.value() );</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( jo.<a class="code" href="classJsonObject.html#ac8dd6467300eb62e7ce842c3d99c083e">has_string</a>( <span class="stringliteral">&quot;flags&quot;</span> ) ) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">const</span> std::string flag = jo.<a class="code" href="classJsonObject.html#a1abb3808bb2a992716d5ef6f27a32b3c">get_string</a>( <span class="stringliteral">&quot;flags&quot;</span> );</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="classspell__type.html#a40d30bd9621c0f8c64b488bed2a0ce51">flags</a>.insert( flag );</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        std::optional&lt;spell_flag&gt; f = io::string_to_enum_optional&lt;spell_flag&gt;( flag );</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">if</span>( f.has_value() ) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <a class="code" href="classspell__type.html#a74d93ff32c5d02d21548e7164e39b7f1">spell_tags</a>.<a class="code" href="classenum__bitset.html#a4817796a50f9f258865e0413ff1f91f9">set</a>( f.value() );</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;effect_str&quot;</span>, <a class="code" href="classspell__type.html#ab1b1ec17f8a72265b3de8de7182b42e6">effect_str</a>, <a class="code" href="classspell__type.html#a6f2ea5fc2b28d67cc32a65b4227acc23">effect_str_default</a> );</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    std::string field_input;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// Because the field this is loading into is not part of this type,</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// the default value will not be supplied when using copy-from if we pass was_loaded</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// So just pass false instead</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <span class="keyword">false</span>, <span class="stringliteral">&quot;field_id&quot;</span>, field_input, <span class="stringliteral">&quot;none&quot;</span> );</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span>( field_input != <span class="stringliteral">&quot;none&quot;</span> ) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="classfield.html">field</a> = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a1e3f04102267eaf5e8d0ca424fd5c561">field_type_id</a>( field_input );</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;field_chance&quot;</span> ) ) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <a class="code" href="classspell__type.html#ad7c34417b82c32b2f70b4d049b50f854">field_chance</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;field_chance&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a468c48b7d109cc65c14f72af881125f1">field_chance_default</a> );</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;min_field_intensity&quot;</span> ) ) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="classspell__type.html#a59beaea1200f5386e09aee0c7c7866df">min_field_intensity</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;min_field_intensity&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                              <a class="code" href="classspell__type.html#afaaa44863d219ad483b230fc41bdebab">min_field_intensity_default</a> );</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_field_intensity&quot;</span> ) ) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <a class="code" href="classspell__type.html#abe44166acf59a9344d7f0bd0dd934dd9">max_field_intensity</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_field_intensity&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                              <a class="code" href="classspell__type.html#a8cc4f2167f1ea512d9e462cf5ae8fda5">max_field_intensity_default</a> );</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;field_intensity_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <a class="code" href="classspell__type.html#a4e0d43953a8887f6b183e9007fead3f1">field_intensity_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;field_intensity_increment&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                    <a class="code" href="classspell__type.html#ae352f61f100a46df52791a975dd754f9">field_intensity_increment_default</a> );</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;field_intensity_variance&quot;</span> ) ) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="classspell__type.html#acedfba24abe1ece6dad25009b1797c33">field_intensity_variance</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;field_intensity_variance&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                   <a class="code" href="classspell__type.html#ac10338c30d2989699573e02cd5f60135">field_intensity_variance_default</a> );</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;min_accuracy&quot;</span> ) ) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="classspell__type.html#a5073999c6ea0fa0356c6e6f2a0e407aa">min_accuracy</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;min_accuracy&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a4013ffcfd9071b49699038d4120749cb">min_accuracy_default</a> );</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;accuracy_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="classspell__type.html#aefd93bc4dce14e7b60c6d6bd4b691613">accuracy_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;accuracy_increment&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                             <a class="code" href="classspell__type.html#a80f705529ff936de2cbb7e67720c41a4">accuracy_increment_default</a> );</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_accuracy&quot;</span> ) ) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="classspell__type.html#a4aecb94219e95161d7be0a9b3ad4ab28">max_accuracy</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_accuracy&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#ab4ab3a7ce1ea8d0f57b9ebac8c45f06f">max_accuracy_default</a> );</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;min_damage&quot;</span> ) ) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <a class="code" href="classspell__type.html#a60beddc934a1d3571d46ae521cc1fc6c">min_damage</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;min_damage&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a88a5469428a3df2f93daba51a4c21803">min_damage_default</a> );</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;damage_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="classspell__type.html#aa4c09471023f07665681f5bf684d1e37">damage_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;damage_increment&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                           <a class="code" href="classspell__type.html#a3afdff53a2be2c160fadc0cd4833bb8e">damage_increment_default</a> );</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_damage&quot;</span> ) ) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_damage&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a9c0dafac52e934828f652ae49c111ffb">max_damage_default</a> );</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;min_range&quot;</span> ) ) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <a class="code" href="classspell__type.html#aa4b832cf689f208feda1c32d37fcdba5">min_range</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;min_range&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a97a4eea59f0c7dcbbadf32f7038dd742">min_range_default</a> );</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;range_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="classspell__type.html#acb2e4a03f710e9444583ba6c59da06be">range_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;range_increment&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#af6d3542c439bdfbd6c34157d686af9fe">range_increment_default</a> );</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_range&quot;</span> ) ) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="classspell__type.html#a5b8690441c94b9182bf777d1a14ffe8f">max_range</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_range&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#ad2bc4f5cfc43f8fddbab8ee7d464fbbd">max_range_default</a> );</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;min_aoe&quot;</span> ) ) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="classspell__type.html#aa503b99197533fa1dfa5de8052a4119b">min_aoe</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;min_aoe&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a41cd20e0a5993d5f3a378bc0339ae918">min_aoe_default</a> );</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;aoe_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <a class="code" href="classspell__type.html#a86eb7c8c5fa42a5307de55cc4646b97e">aoe_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;aoe_increment&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a12a2f88598abde1c5913628dee45e882">aoe_increment_default</a> );</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_aoe&quot;</span> ) ) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_aoe&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#aad4fa941a70475847d13e1de3862c965">max_aoe_default</a> );</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;min_dot&quot;</span> ) ) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="classspell__type.html#a3f73cb1637c08d9057dfc4e31a35f17e">min_dot</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;min_dot&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a9705a52b5936dfba68763b9ebb173788">min_dot_default</a> );</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;dot_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="classspell__type.html#a1b2255ccbd2b5132192d6cd16dc913a8">dot_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;dot_increment&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a7d91bdf3d04bd110e544bb401778fe6a">dot_increment_default</a> );</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_dot&quot;</span> ) ) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <a class="code" href="classspell__type.html#a1cd139dd8336e9b357b7c512c600daf8">max_dot</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_dot&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a737a48fb1019ec08d21a3a0b241779c4">max_dot_default</a> );</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;min_duration&quot;</span> ) ) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <a class="code" href="classspell__type.html#a51accd4d56a09f1c2f5dae55832a8797">min_duration</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;min_duration&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#aa35f381ae36b923d5eb8759087bd3ddd">min_duration_default</a> );</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;duration_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <a class="code" href="classspell__type.html#a6e7735afc9f1817f48ad9c43f710b5f4">duration_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;duration_increment&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                             <a class="code" href="classspell__type.html#a16fd458bb92e74815eb9fb928fbe97ad">duration_increment_default</a> );</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_duration&quot;</span> ) ) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">max_duration</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_duration&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#ad4ed1c14fab837303d765643f1fd2dd8">max_duration_default</a> );</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;min_pierce&quot;</span> ) ) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="classspell__type.html#a7b2ad93661e6cecf3ff87e123f9269b6">min_pierce</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;min_pierce&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a85d117bedc34d5780a37a7fb82d294b7">min_pierce_default</a> );</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;pierce_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="classspell__type.html#a2f9ed4a15576c8883bc42c768c52cf45">pierce_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;pierce_increment&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                           <a class="code" href="classspell__type.html#ad56ab0a53c5ed44bf7b40977e8b3bb28">pierce_increment_default</a> );</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_pierce&quot;</span> ) ) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <a class="code" href="classspell__type.html#ada2df5912b75656b1b85b9d3bd7359d5">max_pierce</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_pierce&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#aa77544331a0516008a5a39fb527a5b9f">max_pierce_default</a> );</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;base_energy_cost&quot;</span> ) ) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;base_energy_cost&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                           <a class="code" href="classspell__type.html#ac6581e716558984035ff45c6a2b4ddb8">base_energy_cost_default</a> );</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span>( jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;final_energy_cost&quot;</span> ) ) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="classspell__type.html#a171e7148d9087468c1be262d13802338">final_energy_cost</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;final_energy_cost&quot;</span> );</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> ) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <a class="code" href="classspell__type.html#a171e7148d9087468c1be262d13802338">final_energy_cost</a> = <a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;energy_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="classspell__type.html#a374a9343878e6614c0185f25acf37b30">energy_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;energy_increment&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                           <a class="code" href="classspell__type.html#af26dbfb0a777931b4a0449af83758ab0">energy_increment_default</a> );</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;spell_class&quot;</span>, <a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>, <a class="code" href="classspell__type.html#aaf35eb6ac32a3c4e3458c38c5fd627d4">spell_class_default</a> );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;energy_source&quot;</span>, <a class="code" href="classspell__type.html#ad7a21ee64ec72743911b9461e3add78b">energy_source</a>, <a class="code" href="classspell__type.html#a3be2c0ad4d9749e8a1dc35dcf7f80429">energy_source_default</a> );</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a>, <span class="stringliteral">&quot;damage_type&quot;</span>, <a class="code" href="classspell__type.html#a7e9db1d8b823fa853544a91327332eee">dmg_type</a>, <a class="code" href="classspell__type.html#af13dedd3462cf8d0e0a81fb024d05976">dmg_type_default</a> );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;difficulty&quot;</span> ) ) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <a class="code" href="classspell__type.html#a960a7f198bd614a7c048405d7d120f61">difficulty</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;difficulty&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a232bcad60b60e42ff8ee884aa26837ab">difficulty_default</a> );</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_level&quot;</span> ) ) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="classspell__type.html#ad2535cbbbb4a50c01ee79c47d3dde019">max_level</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_level&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#abf6f5f121eafafc780f381abefd1ae89">max_level_default</a> );</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;base_casting_time&quot;</span> ) ) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;base_casting_time&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                            <a class="code" href="classspell__type.html#ae9a03b4bdfa2041bb5f7a2431ad3cfe9">base_casting_time_default</a> );</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">if</span>( jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;final_casting_time&quot;</span> ) ) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="classspell__type.html#adccbac25f546cf4b277b1058b59f0ae8">final_casting_time</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;final_casting_time&quot;</span> );</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> ) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="classspell__type.html#adccbac25f546cf4b277b1058b59f0ae8">final_casting_time</a> = <a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;max_damage&quot;</span> ) ) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;max_damage&quot;</span>, <span class="keyword">false</span>, <a class="code" href="classspell__type.html#a9c0dafac52e934828f652ae49c111ffb">max_damage_default</a> );</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#af0135c2939a0e930754f362571905b45">was_loaded</a> || jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;casting_time_increment&quot;</span> ) ) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="classspell__type.html#a094462d9091edcb781516ba1c6bf5096">casting_time_increment</a> = <a class="code" href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a>( jo, <span class="stringliteral">&quot;casting_time_increment&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                 <a class="code" href="classspell__type.html#aea0732988fd57d4da9622f8505d0c23d">casting_time_increment_default</a> );</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonMember.html">JsonMember</a> <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a> : jo.<a class="code" href="classJsonObject.html#a3b9722313d9692826235c87e73e94f04">get_object</a>( <span class="stringliteral">&quot;learn_spells&quot;</span> ) ) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="classspell__type.html#a54a3704127c6ab03b7314bc998522e04">learn_spells</a>.insert( std::pair&lt;std::string, int&gt;( <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a>.name(), <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a>.get_int() ) );</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classspell__type.html#a8cfa4b25f6959244b9bdea9363d6b63d">  483</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell__type.html#a8cfa4b25f6959244b9bdea9363d6b63d">spell_type::serialize</a>( <a class="code" href="classJsonOut.html">JsonOut</a> &amp;json )<span class="keyword"> const</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    json.<a class="code" href="classJsonOut.html#a4756f9a569adbfc60de127f7c335d82f">start_object</a>();</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;SPELL&quot;</span> );</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;src_mod&quot;</span>, <a class="code" href="classspell__type.html#afca82c905601cf50d72c07a65dc56f11">src_mod</a> );</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;name&quot;</span>, <a class="code" href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">name</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>() );</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;description&quot;</span>, <a class="code" href="classspell__type.html#a0bf174d1f3134b53667d8381c02d6ee4">description</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>() );</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;effect&quot;</span>, <a class="code" href="classspell__type.html#afa2cd70d2587c495c1565209b2292a36">effect_name</a> );</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;shape&quot;</span>, <a class="code" href="namespaceio.html#aa8fa8545615e452e23e6bcc8a6a3a37a">io::enum_to_string</a>( <a class="code" href="classspell__type.html#abf08fe1f454fd0649d9855104630afe4">spell_area</a> ) );</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;valid_targets&quot;</span>, <a class="code" href="classspell__type.html#ae696150ec8cf81bc7a35102c562d4517">valid_targets</a>, <a class="code" href="classenum__bitset.html">enum_bitset&lt;spell_target&gt;</a> {} );</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;effect_str&quot;</span>, <a class="code" href="classspell__type.html#ab1b1ec17f8a72265b3de8de7182b42e6">effect_str</a>, <a class="code" href="classspell__type.html#a6f2ea5fc2b28d67cc32a65b4227acc23">effect_str_default</a> );</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;skill&quot;</span>, <a class="code" href="classspell__type.html#abd2cfd23c656755b0f887064683d9e13">skill</a>, <a class="code" href="classspell__type.html#ae2e0120de261304cf182bbef5700c492">skill_default</a> );</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;teachable&quot;</span>, <a class="code" href="classspell__type.html#ad9cd92ba641b2fd6c48e80bcd6ba40bc">teachable</a>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;components&quot;</span>, <a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>, <a class="code" href="classspell__type.html#acae42f8b49667db0c62b6982351359c5">spell_components_default</a> );</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;message&quot;</span>, <a class="code" href="classspell__type.html#a1e5fb7d2cfe305bd5b26dccdce21273b">message</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>(), <a class="code" href="classspell__type.html#a0a1613360b65577766130af10b7527ae">message_default</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>() );</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;sound_description&quot;</span>, <a class="code" href="classspell__type.html#a868516b343411f98fcf2a2c961de01cb">sound_description</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>(),</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                 <a class="code" href="classspell__type.html#a21afbf660e1de0739ec37cfe8cc409d5">sound_description_default</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>() );</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;sound_type&quot;</span>, <a class="code" href="namespaceio.html#aa8fa8545615e452e23e6bcc8a6a3a37a">io::enum_to_string</a>( <a class="code" href="classspell__type.html#a2dc22c6c8d58f23f22a4a9b72cd7eed7">sound_type</a> ),</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                 <a class="code" href="namespaceio.html#aa8fa8545615e452e23e6bcc8a6a3a37a">io::enum_to_string</a>( <a class="code" href="classspell__type.html#a2fb4614f39f5253b86d6095192dc4a97">sound_type_default</a> ) );</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;sound_ambient&quot;</span>, <a class="code" href="classspell__type.html#ac5fb63c1cb3f31f1c705e9988e882e4a">sound_ambient</a>, <a class="code" href="classspell__type.html#a5e3c1434fc8d2303d503aa2f901e0a37">sound_ambient_default</a> );</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;sound_id&quot;</span>, <a class="code" href="classspell__type.html#a91953b9d5715f36608e753b3fc5e805d">sound_id</a>, <a class="code" href="classspell__type.html#aef9dc4b5d446dc53a65b206bc1ee2ecf">sound_id_default</a> );</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;sound_variant&quot;</span>, <a class="code" href="classspell__type.html#a8a9f3e75988d34cf9e89abfec583ba67">sound_variant</a>, <a class="code" href="classspell__type.html#a6d74ff9fdcc59a96412c9bdeb73e69e0">sound_variant_default</a> );</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;targeted_monster_ids&quot;</span>, <a class="code" href="classspell__type.html#af64d6acee71a4ba9f6a51459fddb9953">targeted_monster_ids</a>, std::set&lt;mtype_id&gt; {} );</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;targeted_monster_species&quot;</span>, <a class="code" href="classspell__type.html#a60c88145cf9b37dfe7b141b143095246">targeted_species_ids</a>, std::set&lt;species_id&gt; {} );</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;ignored_monster_species&quot;</span>, <a class="code" href="classspell__type.html#a48f952d3f551b2cab4fdb46087613c48">ignored_species_ids</a>, std::set&lt;species_id&gt; {} );</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;extra_effects&quot;</span>, <a class="code" href="classspell__type.html#addae5132e10abe659f19d1575547d185">additional_spells</a>, std::vector&lt;fake_spell&gt; {} );</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#ad2ddb53d6c4f656d913e5093d84f1ad6">affected_bps</a>.<a class="code" href="classbody__part__set.html#a9eea3a88425e1aaf2d3e9ebf87c2e976">none</a>() ) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;affected_body_parts&quot;</span>, <a class="code" href="classspell__type.html#ad2ddb53d6c4f656d913e5093d84f1ad6">affected_bps</a> );</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;flags&quot;</span>, <a class="code" href="classspell__type.html#a40d30bd9621c0f8c64b488bed2a0ce51">flags</a>, std::set&lt;std::string&gt; {} );</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classfield.html">field</a> ) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;field_id&quot;</span>, <a class="code" href="classfield.html">field</a>-&gt;id().str() );</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;field_chance&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#ad7c34417b82c32b2f70b4d049b50f854">field_chance</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                     <a class="code" href="classspell__type.html#a468c48b7d109cc65c14f72af881125f1">field_chance_default</a> );</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_field_intensity&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#abe44166acf59a9344d7f0bd0dd934dd9">max_field_intensity</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                     <a class="code" href="classspell__type.html#a8cc4f2167f1ea512d9e462cf5ae8fda5">max_field_intensity_default</a> );</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;min_field_intensity&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a59beaea1200f5386e09aee0c7c7866df">min_field_intensity</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                     <a class="code" href="classspell__type.html#afaaa44863d219ad483b230fc41bdebab">min_field_intensity_default</a> );</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;field_intensity_increment&quot;</span>,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                     <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a4e0d43953a8887f6b183e9007fead3f1">field_intensity_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                     <a class="code" href="classspell__type.html#ae352f61f100a46df52791a975dd754f9">field_intensity_increment_default</a> );</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;field_intensity_variance&quot;</span>,</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                     <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#acedfba24abe1ece6dad25009b1797c33">field_intensity_variance</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                     <a class="code" href="classspell__type.html#ac10338c30d2989699573e02cd5f60135">field_intensity_variance_default</a> );</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;min_damage&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a60beddc934a1d3571d46ae521cc1fc6c">min_damage</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#a88a5469428a3df2f93daba51a4c21803">min_damage_default</a> );</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_damage&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#a9c0dafac52e934828f652ae49c111ffb">max_damage_default</a> );</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;damage_increment&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#aa4c09471023f07665681f5bf684d1e37">damage_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                 <a class="code" href="classspell__type.html#a3afdff53a2be2c160fadc0cd4833bb8e">damage_increment_default</a> );</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;min_accuracy&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a5073999c6ea0fa0356c6e6f2a0e407aa">min_accuracy</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                 <a class="code" href="classspell__type.html#a4013ffcfd9071b49699038d4120749cb">min_accuracy_default</a> );</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;accuracy_increment&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#aefd93bc4dce14e7b60c6d6bd4b691613">accuracy_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                 <a class="code" href="classspell__type.html#a80f705529ff936de2cbb7e67720c41a4">accuracy_increment_default</a> );</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_accuracy&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a4aecb94219e95161d7be0a9b3ad4ab28">max_accuracy</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                 <a class="code" href="classspell__type.html#ab4ab3a7ce1ea8d0f57b9ebac8c45f06f">max_accuracy_default</a> );</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;min_range&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#aa4b832cf689f208feda1c32d37fcdba5">min_range</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#a97a4eea59f0c7dcbbadf32f7038dd742">min_range_default</a> );</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_range&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a5b8690441c94b9182bf777d1a14ffe8f">max_range</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#a97a4eea59f0c7dcbbadf32f7038dd742">min_range_default</a> );</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;range_increment&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#acb2e4a03f710e9444583ba6c59da06be">range_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                 <a class="code" href="classspell__type.html#af6d3542c439bdfbd6c34157d686af9fe">range_increment_default</a> );</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;min_aoe&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#aa503b99197533fa1dfa5de8052a4119b">min_aoe</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#a41cd20e0a5993d5f3a378bc0339ae918">min_aoe_default</a> );</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_aoe&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#aad4fa941a70475847d13e1de3862c965">max_aoe_default</a> );</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;aoe_increment&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a86eb7c8c5fa42a5307de55cc4646b97e">aoe_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                 <a class="code" href="classspell__type.html#a12a2f88598abde1c5913628dee45e882">aoe_increment_default</a> );</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;min_dot&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a3f73cb1637c08d9057dfc4e31a35f17e">min_dot</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#a9705a52b5936dfba68763b9ebb173788">min_dot_default</a> );</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_dot&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a1cd139dd8336e9b357b7c512c600daf8">max_dot</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#a737a48fb1019ec08d21a3a0b241779c4">max_dot_default</a> );</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;dot_increment&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a1b2255ccbd2b5132192d6cd16dc913a8">dot_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                 <a class="code" href="classspell__type.html#a7d91bdf3d04bd110e544bb401778fe6a">dot_increment_default</a> );</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;min_duration&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a51accd4d56a09f1c2f5dae55832a8797">min_duration</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                 <a class="code" href="classspell__type.html#aa35f381ae36b923d5eb8759087bd3ddd">min_duration_default</a> );</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_duration&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">max_duration</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                 <a class="code" href="classspell__type.html#ad4ed1c14fab837303d765643f1fd2dd8">max_duration_default</a> );</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;duration_increment&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a6e7735afc9f1817f48ad9c43f710b5f4">duration_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                 <a class="code" href="classspell__type.html#a16fd458bb92e74815eb9fb928fbe97ad">duration_increment_default</a> );</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;min_pierce&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a7b2ad93661e6cecf3ff87e123f9269b6">min_pierce</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#a85d117bedc34d5780a37a7fb82d294b7">min_pierce_default</a> );</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_pierce&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#ada2df5912b75656b1b85b9d3bd7359d5">max_pierce</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#aa77544331a0516008a5a39fb527a5b9f">max_pierce_default</a> );</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;pierce_increment&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a2f9ed4a15576c8883bc42c768c52cf45">pierce_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                 <a class="code" href="classspell__type.html#ad56ab0a53c5ed44bf7b40977e8b3bb28">pierce_increment_default</a> );</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;base_energy_cost&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                 <a class="code" href="classspell__type.html#ac6581e716558984035ff45c6a2b4ddb8">base_energy_cost_default</a> );</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;final_energy_cost&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a171e7148d9087468c1be262d13802338">final_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                 <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ) );</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;energy_increment&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a374a9343878e6614c0185f25acf37b30">energy_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                 <a class="code" href="classspell__type.html#af26dbfb0a777931b4a0449af83758ab0">energy_increment_default</a> );</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;spell_class&quot;</span>, <a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>, <a class="code" href="classspell__type.html#aaf35eb6ac32a3c4e3458c38c5fd627d4">spell_class_default</a> );</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;energy_source&quot;</span>, <a class="code" href="namespaceio.html#aa8fa8545615e452e23e6bcc8a6a3a37a">io::enum_to_string</a>( <a class="code" href="classspell__type.html#ad7a21ee64ec72743911b9461e3add78b">energy_source</a> ),</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                 <a class="code" href="namespaceio.html#aa8fa8545615e452e23e6bcc8a6a3a37a">io::enum_to_string</a>( <a class="code" href="classspell__type.html#a3be2c0ad4d9749e8a1dc35dcf7f80429">energy_source_default</a> ) );</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;damage_type&quot;</span>, <a class="code" href="classspell__type.html#a7e9db1d8b823fa853544a91327332eee">dmg_type</a>, <a class="code" href="classspell__type.html#af13dedd3462cf8d0e0a81fb024d05976">dmg_type_default</a> );</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;difficulty&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a960a7f198bd614a7c048405d7d120f61">difficulty</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#a232bcad60b60e42ff8ee884aa26837ab">difficulty_default</a> );</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_level&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#ad2535cbbbb4a50c01ee79c47d3dde019">max_level</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#abf6f5f121eafafc780f381abefd1ae89">max_level_default</a> );</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;base_casting_time&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                 <a class="code" href="classspell__type.html#ae9a03b4bdfa2041bb5f7a2431ad3cfe9">base_casting_time_default</a> );</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;final_casting_time&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#adccbac25f546cf4b277b1058b59f0ae8">final_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ),</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                 <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ) );</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;casting_time_increment&quot;</span>,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                 <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell__type.html#a094462d9091edcb781516ba1c6bf5096">casting_time_increment</a>.<a class="code" href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">min</a>.<a class="code" href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_val</a>.value() ), <a class="code" href="classspell__type.html#aea0732988fd57d4da9622f8505d0c23d">casting_time_increment_default</a> );</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell__type.html#a54a3704127c6ab03b7314bc998522e04">learn_spells</a>.empty() ) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;learn_spells&quot;</span> );</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        json.<a class="code" href="classJsonOut.html#a4756f9a569adbfc60de127f7c335d82f">start_object</a>();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const std::string, int&gt; &amp;sp : <a class="code" href="classspell__type.html#a54a3704127c6ab03b7314bc998522e04">learn_spells</a> ) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( sp.first, sp.second );</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        json.<a class="code" href="classJsonOut.html#aa38d37840ed6ba168b78a43570e98681">end_object</a>();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    json.<a class="code" href="classJsonOut.html#aa38d37840ed6ba168b78a43570e98681">end_object</a>();</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="magic_8cpp.html#aaa151d8292663b41260f6b2c8638694a">  595</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="magic_8cpp.html#aaa151d8292663b41260f6b2c8638694a">spell_infinite_loop_check</a>( std::set&lt;spell_id&gt; spell_effects, <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span>( spell_effects.count( sp ) ) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    spell_effects.emplace( sp );</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    std::set&lt;spell_id&gt; unique_spell_list;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structfake__spell.html">fake_spell</a> &amp;fake_sp : sp-&gt;<a class="code" href="classspell__type.html#addae5132e10abe659f19d1575547d185">additional_spells</a> ) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        unique_spell_list.emplace( fake_sp.<a class="code" href="structfake__spell.html#abef5b674d81d5f6009385005f20b26b9">id</a> );</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;other_sp : unique_spell_list ) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="magic_8cpp.html#aaa151d8292663b41260f6b2c8638694a">spell_infinite_loop_check</a>( spell_effects, other_sp ) ) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;}</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="classspell__type.html#a51475bfe17e94f2400eada8e930f0877">  615</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell__type.html#a51475bfe17e94f2400eada8e930f0877">spell_type::check_consistency</a>()</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;{</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classspell__type.html">spell_type</a> &amp;sp_t : <a class="code" href="classspell__type.html#a969fc5645fa6d17530ffb392cb4d960e">get_all</a>() ) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">if</span>( sp_t.effect_name == <span class="stringliteral">&quot;summon_vehicle&quot;</span> ) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">if</span>( !sp_t.effect_str.empty() &amp;&amp; !<a class="code" href="classstring__id.html">vproto_id</a>( sp_t.effect_str ).<a class="code" href="classstring__id.html#a8ca0e76fa665125f1e50bd1ed8dbd213">is_valid</a>() ) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR %s specifies a vehicle to summon, but vehicle %s is not valid&quot;</span>, sp_t.id.c_str(),</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                          sp_t.effect_str );</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        std::set&lt;spell_id&gt; spell_effect_list;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="magic_8cpp.html#aaa151d8292663b41260f6b2c8638694a">spell_infinite_loop_check</a>( spell_effect_list, sp_t.id ) ) {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: %s has infinite loop in extra_effects&quot;</span>, sp_t.id.c_str() );</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keywordflow">if</span>( sp_t.spell_tags[<a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac1324f642ae16e50278d5fad88240254">spell_flag::WONDER</a>] &amp;&amp; sp_t.additional_spells.empty() ) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: %s has WONDER flag but no spells to choose from!&quot;</span>, sp_t.id.c_str() );</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;}</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno"><a class="line" href="classspell__type.html#a969fc5645fa6d17530ffb392cb4d960e">  634</a></span>&#160;<span class="keyword">const</span> std::vector&lt;spell_type&gt; &amp;<a class="code" href="classspell__type.html#a969fc5645fa6d17530ffb392cb4d960e">spell_type::get_all</a>()</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;{</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">spell_factory</a>.get_all();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="classspell__type.html#a226b53feab51ac683efe4a33483dc88c">  639</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell__type.html#a226b53feab51ac683efe4a33483dc88c">spell_type::reset_all</a>()</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;{</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">spell_factory</a>.reset();</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno"><a class="line" href="classspell__type.html#ab9b1f0c5e1c6127b4bb37b371ff09e92">  644</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell__type.html#ab9b1f0c5e1c6127b4bb37b371ff09e92">spell_type::is_valid</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">spell_factory</a>.is_valid( this-&gt;<span class="keywordtype">id</span> );</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;}</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">// spell</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno"><a class="line" href="classspell.html#a0312f96464a4cd8f9104c66e910cc026">  651</a></span>&#160;<a class="code" href="classspell.html#a04c24cc9ecaf5416e147dfa8b4ca3f41">spell::spell</a>( <a class="code" href="classstring__id.html">spell_id</a> sp, <span class="keywordtype">int</span> xp, <span class="keywordtype">int</span> level_adjustment ) :</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    type( sp ),</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    experience( xp ),</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    temp_level_adjustment( level_adjustment )</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{}</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno"><a class="line" href="classspell.html#a59e8773eaa3a6236182746cbc3930d07">  657</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a59e8773eaa3a6236182746cbc3930d07">spell::set_message</a>( <span class="keyword">const</span> <a class="code" href="classtranslation.html">translation</a> &amp;msg )</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;{</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="classspell.html#a838599c428e33e70b7e62b3e195dc6b9">alt_message</a> = msg;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="classspell.html#a7d44bdaf4c9faff438e6b30973d68615">  662</a></span>&#160;<a class="code" href="classstring__id.html">spell_id</a> <a class="code" href="classspell.html#a7d44bdaf4c9faff438e6b30973d68615">spell::id</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="classspell.html#a388a3e18bba1c58aa9c00dc53bc97aef">  667</a></span>&#160;<a class="code" href="classstring__id.html">trait_id</a> <a class="code" href="classspell.html#a388a3e18bba1c58aa9c00dc53bc97aef">spell::spell_class</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="classspell.html#ab4c5d1958442f999fe006be4d89883cf">  672</a></span>&#160;<a class="code" href="classstring__id.html">skill_id</a> <a class="code" href="classspell.html#ab4c5d1958442f999fe006be4d89883cf">spell::skill</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#abd2cfd23c656755b0f887064683d9e13">skill</a>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="classspell.html#a9a0b1eb365a5b17870ea15171a60ee14">  677</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a9a0b1eb365a5b17870ea15171a60ee14">spell::field_intensity</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#abe44166acf59a9344d7f0bd0dd934dd9">max_field_intensity</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ),</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                     <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a59beaea1200f5386e09aee0c7c7866df">min_field_intensity</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) + <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() *</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                       <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a4e0d43953a8887f6b183e9007fead3f1">field_intensity_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ) );</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="classspell.html#a85529eef5a29f1e17b390ae63869c781">  685</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a85529eef5a29f1e17b390ae63869c781">spell::min_leveled_damage</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a60beddc934a1d3571d46ae521cc1fc6c">min_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) + <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() *</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#aa4c09471023f07665681f5bf684d1e37">damage_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>(</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                d ) );</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="classspell.html#a039ec3d7b031caad827a8b7aa7e0acea">  693</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classspell.html#a039ec3d7b031caad827a8b7aa7e0acea">spell::dps</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;caster, <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp; )<span class="keyword"> const</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#afa2cd70d2587c495c1565209b2292a36">effect_name</a> != <span class="stringliteral">&quot;attack&quot;</span> ) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> time_modifier = 100.0f / <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a>( caster );</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> failure_modifier = 1.0f - <a class="code" href="classspell.html#ada3a6b9f7ba0c643ee59b8389b9f56ec">spell_fail</a>( caster );</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> raw_dps = <a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( caster ) + <a class="code" href="classspell.html#aaf83b0a24bf04d172819c3c82317a7c6">damage_dot</a>( caster ) * <a class="code" href="classspell.html#ad0fe357d9c04c94f9c6329c89d683dae">duration_turns</a>( caster ) / 1_turns;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// TODO: calculate true dps with armor and resistances and any caster bonuses</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">return</span> raw_dps * time_modifier * failure_modifier;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;}</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">  705</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">spell::damage</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> leveled_damage = <a class="code" href="classspell.html#a85529eef5a29f1e17b390ae63869c781">min_leveled_damage</a>( caster );</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba24ae034aca7659a9c3b08c3df679b065">spell_flag::RANDOM_DAMAGE</a> ) ) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( leveled_damage, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ),</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                    <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( leveled_damage,</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                              <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ) );</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a60beddc934a1d3571d46ae521cc1fc6c">min_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt;= 0 ||</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt;= <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a60beddc934a1d3571d46ae521cc1fc6c">min_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( leveled_damage, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// if it&#39;s negative, min and max work differently</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( leveled_damage, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;}</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno"><a class="line" href="classspell.html#ad83fcc2ff2b800a12c1a14c65103e1c7">  724</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#ad83fcc2ff2b800a12c1a14c65103e1c7">spell::min_leveled_accuracy</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a5073999c6ea0fa0356c6e6f2a0e407aa">min_accuracy</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) + <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() *</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#aefd93bc4dce14e7b60c6d6bd4b691613">accuracy_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) );</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;}</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="classspell.html#a35a5f0a79a86833afef958fe1627d198">  731</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a35a5f0a79a86833afef958fe1627d198">spell::accuracy</a>( <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> leveled_accuracy = <a class="code" href="classspell.html#ad83fcc2ff2b800a12c1a14c65103e1c7">min_leveled_accuracy</a>( caster );</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a5073999c6ea0fa0356c6e6f2a0e407aa">min_accuracy</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt;= 0 ||</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a4aecb94219e95161d7be0a9b3ad4ab28">max_accuracy</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt;= <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a5073999c6ea0fa0356c6e6f2a0e407aa">min_accuracy</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( leveled_accuracy, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a4aecb94219e95161d7be0a9b3ad4ab28">max_accuracy</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// if it&#39;s negative, min and max work differently</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( leveled_accuracy, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a4aecb94219e95161d7be0a9b3ad4ab28">max_accuracy</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;}</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="classspell.html#a462c98a4cef24f9d7014f7afc9118aa3">  743</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a462c98a4cef24f9d7014f7afc9118aa3">spell::min_leveled_dot</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a3f73cb1637c08d9057dfc4e31a35f17e">min_dot</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) + <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() *</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a1b2255ccbd2b5132192d6cd16dc913a8">dot_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) );</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;}</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="classspell.html#aaf83b0a24bf04d172819c3c82317a7c6">  750</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#aaf83b0a24bf04d172819c3c82317a7c6">spell::damage_dot</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> leveled_dot = <a class="code" href="classspell.html#a462c98a4cef24f9d7014f7afc9118aa3">min_leveled_dot</a>( caster );</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a3f73cb1637c08d9057dfc4e31a35f17e">min_dot</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt;= 0 ||</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a1cd139dd8336e9b357b7c512c600daf8">max_dot</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt;= <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a3f73cb1637c08d9057dfc4e31a35f17e">min_dot</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( leveled_dot, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a1cd139dd8336e9b357b7c512c600daf8">max_dot</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// if it&#39;s negative, min and max work differently</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( leveled_dot, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a1cd139dd8336e9b357b7c512c600daf8">max_dot</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;}</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="classspell.html#a134d0709b0c5bc67e43a56ff6165854a">  762</a></span>&#160;<a class="code" href="classdamage__over__time__data.html">damage_over_time_data</a> <a class="code" href="classspell.html#a134d0709b0c5bc67e43a56ff6165854a">spell::damage_over_time</a>( <span class="keyword">const</span> std::vector&lt;bodypart_str_id&gt; &amp;bps,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <a class="code" href="classdamage__over__time__data.html">damage_over_time_data</a> <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>.bps = bps;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>.duration = <a class="code" href="classspell.html#ad0fe357d9c04c94f9c6329c89d683dae">duration_turns</a>( caster );</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>.amount = <a class="code" href="classspell.html#aaf83b0a24bf04d172819c3c82317a7c6">damage_dot</a>( caster );</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>.type = <a class="code" href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b">dmg_type</a>();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;}</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno"><a class="line" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">  773</a></span>&#160;std::string <a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">spell::damage_string</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    std::string <a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba24ae034aca7659a9c3b08c3df679b065">spell_flag::RANDOM_DAMAGE</a> ) ) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a> = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%d-%d&quot;</span>, <a class="code" href="classspell.html#a85529eef5a29f1e17b390ae63869c781">min_leveled_damage</a>( caster ),</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                       <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> dmg = <a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( caster );</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keywordflow">if</span>( dmg &gt;= 0 ) {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a> = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%d&quot;</span>, dmg );</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a> = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;+%d&quot;</span>, <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( dmg ) );</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba83ce92712f6d8aea3340cd5dcc2158f4">spell_flag::PERCENTAGE_DAMAGE</a> ) ) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a> = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s%% %s&quot;</span>, <a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;of current HP&quot;</span> ) );</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="classspell.html#a25db0a720eff61873d779a5db0428b16">  794</a></span>&#160;std::optional&lt;tripoint&gt; <a class="code" href="classspell.html#a25db0a720eff61873d779a5db0428b16">spell::select_target</a>( <a class="code" href="classCreature.html">Creature</a> *source )</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;{</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> target = source-&gt;<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>();</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">bool</span> target_is_valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a>( *source ) &gt; 0 &amp;&amp; !<a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a334c4a4c42fdb79d7ebc3e73b517e6f8">spell_target::none</a> ) &amp;&amp;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        !<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba95aa3650620c7879b3276744d8284b0d">spell_flag::RANDOM_TARGET</a> ) ) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">if</span>( source-&gt;<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() ) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <a class="code" href="classavatar.html">avatar</a> &amp;source_avatar = *source-&gt;<a class="code" href="classCreature.html#a3efb920d8e3d22ee766b62012ad0f9cd">as_avatar</a>();</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                std::vector&lt;tripoint&gt; <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a> = <a class="code" href="namespacetarget__handler.html#a10911d1ab9fa4b1484138f1bc379baa5">target_handler::mode_spell</a>( source_avatar, *<span class="keyword">this</span>,</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                                   <span class="keyword">true</span>,</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                                                   <span class="keyword">true</span> );</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                <span class="keywordflow">if</span>( !<a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.empty() ) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                    target = <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.back();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                    target_is_valid = <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( source_avatar, target );</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                    <span class="keywordflow">if</span>( !( <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a578552719239a72a2d45ad422f67d24d">spell_target::ground</a> ) || source_avatar.<a class="code" href="classCharacter.html#a906192bd3a5f29a61ee12695e18d2eb5">sees</a>( target ) ) ) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                        target_is_valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                    }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    target_is_valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                <span class="keywordflow">if</span>( !target_is_valid ) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                    <span class="keywordflow">if</span>( <a class="code" href="output_8cpp.html#ab62599a77867b8f416669b92f60f4900">query_yn</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Stop targeting?  Time spent will be lost.&quot;</span> ) ) ) {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            } <span class="keywordflow">while</span>( !target_is_valid );</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( source-&gt;<a class="code" href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">is_npc</a>() ) {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <a class="code" href="classnpc.html">npc</a> &amp;source_npc = *source-&gt;<a class="code" href="classCreature.html#a5de5f5e0d08deb03b68749608eb360b2">as_npc</a>();</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <a class="code" href="classnpc__attack__spell.html">npc_attack_spell</a> npc_spell( <span class="keywordtype">id</span>() );</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">// recalculate effectiveness because it&#39;s been a few turns since the npc started casting.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keyword">const</span> <a class="code" href="classnpc__attack__rating.html">npc_attack_rating</a> effectiveness = npc_spell.<a class="code" href="classnpc__attack__spell.html#a84b08e3a63323c4a5641c7d87e791f54">evaluate</a>( source_npc,</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                                                    source_npc.<a class="code" href="classCharacter.html#a15520bb61b6da84f9bd753fa43dcbabc">last_target</a>.lock().get() );</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="keywordflow">if</span>( effectiveness &lt; 0 ) {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af23f8ccb0fd99b8a3db9e9223a5714a2">debugmode::debug_filter::DF_NPC</a>, <span class="stringliteral">&quot;%s cancels casting %s, target lost&quot;</span>,</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                               source_npc.<a class="code" href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">disp_name</a>(), <a class="code" href="classspell.html#abdf34d5415c3fdafcd84fe3a7101bddb">name</a>() );</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                target = effectiveness.<a class="code" href="classnpc__attack__rating.html#a5edbe25131a7337a3738bd24cd113f5b">target</a>();</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        } <span class="comment">// TODO: move monster spell attack targeting here</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba95aa3650620c7879b3276744d8284b0d">spell_flag::RANDOM_TARGET</a> ) ) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keyword">const</span> std::optional&lt;tripoint&gt; target_ = <a class="code" href="classspell.html#a7a62c6ffd858fa8baeeb225aba2f06ac">random_valid_target</a>( *source, source-&gt;<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">if</span>( !target_ ) {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            source-&gt;<a class="code" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code" href="structgame__message__params.html">game_message_params</a>{ <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code" href="enums_8h.html#a3c6c2b91b92d3e5471a017b197da3d29a400a66f0d4015783e72f1e33c0b7dcb8">gmf_bypass_cooldown</a> },</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                       <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;You can&#39;t find a suitable target.&quot;</span> ) );</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        target = *target_;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">return</span> target;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;}</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="classspell.html#ae81b37281ed73857316479ab0bbb2395">  847</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#ae81b37281ed73857316479ab0bbb2395">spell::min_leveled_aoe</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#aa503b99197533fa1dfa5de8052a4119b">min_aoe</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) + <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() *</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a86eb7c8c5fa42a5307de55cc4646b97e">aoe_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) );</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;}</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno"><a class="line" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">  854</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">spell::aoe</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> leveled_aoe = <a class="code" href="classspell.html#ae81b37281ed73857316479ab0bbb2395">min_leveled_aoe</a>( caster );</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordtype">int</span> return_value;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6281a96f78b881bbd1821d8834054992">spell_flag::RANDOM_AOE</a> ) ) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        return_value = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( leveled_aoe, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ),</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                            <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( leveled_aoe, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ) );</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt;= <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#aa503b99197533fa1dfa5de8052a4119b">min_aoe</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            return_value = <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( leveled_aoe, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            return_value = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( leveled_aoe, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">return</span> return_value * <a class="code" href="classspell.html#a2857365ef6cc65207a1ee75fc390ef13">temp_aoe_multiplyer</a>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;}</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno"><a class="line" href="classspell.html#a10720b544d7c92b9606008819cc2896e">  873</a></span>&#160;std::set&lt;tripoint&gt; <a class="code" href="classspell.html#a10720b544d7c92b9606008819cc2896e">spell::effect_area</a>( <span class="keyword">const</span> <a class="code" href="structspell__effect_1_1override__parameters.html">spell_effect::override_parameters</a> &amp;params,</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;source, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target )<span class="keyword"> const</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a5d51ae843768a4cacadb5e88cf871ebe">spell_area_function</a>( params, source, target );</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno"><a class="line" href="classspell.html#aab9c6da52fa3253933f9b011f5c0412b">  879</a></span>&#160;std::set&lt;tripoint&gt; <a class="code" href="classspell.html#a10720b544d7c92b9606008819cc2896e">spell::effect_area</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;source, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target,</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#a10720b544d7c92b9606008819cc2896e">effect_area</a>( <a class="code" href="structspell__effect_1_1override__parameters.html">spell_effect::override_parameters</a>( *<span class="keyword">this</span>, caster ), source, target );</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno"><a class="line" href="classspell.html#a4bee370b3c3d69be45411856fb2f333f">  885</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a4bee370b3c3d69be45411856fb2f333f">spell::in_aoe</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;source, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target, <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6281a96f78b881bbd1821d8834054992">spell_flag::RANDOM_AOE</a> ) ) {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source, target ) &lt;= <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d );</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source, target ) &lt;= <a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">aoe</a>( caster );</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;}</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno"><a class="line" href="classspell.html#a335dc296fd7e166be557e69dc6d9f147">  895</a></span>&#160;std::string <a class="code" href="classspell.html#a335dc296fd7e166be557e69dc6d9f147">spell::aoe_string</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6281a96f78b881bbd1821d8834054992">spell_flag::RANDOM_AOE</a> ) ) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%d-%d&quot;</span>, <a class="code" href="classspell.html#ae81b37281ed73857316479ab0bbb2395">min_leveled_aoe</a>( caster ), <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) );</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%d&quot;</span>, <a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">aoe</a>( caster ) );</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;}</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno"><a class="line" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">  905</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">spell::range</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> leveled_range = <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#aa4b832cf689f208feda1c32d37fcdba5">min_range</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) + <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() *</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                              <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#acb2e4a03f710e9444583ba6c59da06be">range_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) );</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a5b8690441c94b9182bf777d1a14ffe8f">max_range</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt;= <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#aa4b832cf689f208feda1c32d37fcdba5">min_range</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a> = <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( leveled_range, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a5b8690441c94b9182bf777d1a14ffe8f">max_range</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a> = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( leveled_range, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a5b8690441c94b9182bf777d1a14ffe8f">max_range</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a> * <a class="code" href="classspell.html#a03dea8803fea1685efa62ace8ab9b082">temp_range_multiplyer</a>, 0.0f );</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;}</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno"><a class="line" href="classspell.html#a9917a8122ab05a8c6a88da3d699546b3">  919</a></span>&#160;std::vector&lt;tripoint&gt; <a class="code" href="classspell.html#a9917a8122ab05a8c6a88da3d699546b3">spell::targetable_locations</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;source )<span class="keyword"> const</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> char_pos = source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>();</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> select_ground = <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a578552719239a72a2d45ad422f67d24d">spell_target::ground</a> );</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> ignore_walls = <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba54cdca63f8089e9058dff2c73ef37831">spell_flag::NO_PROJECTILE</a> );</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">// TODO: put this in a namespace for reuse</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="npc__attack_8cpp.html#aafbcce917c2d2d11a56b3f35f1b642dc">has_obstruction</a> = [&amp;]( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp; at ) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;line_point : <a class="code" href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a>( char_pos, at ) ) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">impassable</a>( line_point ) ) {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    };</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    std::vector&lt;tripoint&gt; selectable_targets;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;query : here.<a class="code" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( char_pos, <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a>( source ) ) ) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordflow">if</span>( !ignore_walls &amp;&amp; <a class="code" href="npc__attack_8cpp.html#aafbcce917c2d2d11a56b3f35f1b642dc">has_obstruction</a>( query ) ) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="comment">// it&#39;s blocked somewhere!</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="keywordflow">if</span>( !select_ground ) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="keywordflow">if</span>( !source.<a class="code" href="classCharacter.html#a906192bd3a5f29a61ee12695e18d2eb5">sees</a>( query ) ) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                <span class="comment">// can&#39;t target a critter you can&#39;t see</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( source, query ) ) {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            selectable_targets.push_back( query );</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">return</span> selectable_targets;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;}</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno"><a class="line" href="classspell.html#a19feb836872fc2fe3818f933a9029f00">  958</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a19feb836872fc2fe3818f933a9029f00">spell::min_leveled_duration</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a51accd4d56a09f1c2f5dae55832a8797">min_duration</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) + <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() *</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a6e7735afc9f1817f48ad9c43f710b5f4">duration_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) );</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;}</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno"><a class="line" href="classspell.html#a3a67307def07ddc6d2e2c134d21c245f">  965</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a3a67307def07ddc6d2e2c134d21c245f">spell::duration</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> leveled_duration = <a class="code" href="classspell.html#a19feb836872fc2fe3818f933a9029f00">min_leveled_duration</a>( caster );</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="classspell.html#a3a67307def07ddc6d2e2c134d21c245f">duration</a>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac17984263d7ed29c73a2b4fe8f783030">spell_flag::RANDOM_DURATION</a> ) ) {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( leveled_duration, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">max_duration</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ),</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                    <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( leveled_duration,</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                              <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">max_duration</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ) );</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">max_duration</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt;= <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a51accd4d56a09f1c2f5dae55832a8797">min_duration</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( leveled_duration, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">max_duration</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( leveled_duration, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">max_duration</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    }</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( <a class="code" href="classspell.html#a3a67307def07ddc6d2e2c134d21c245f">duration</a> * <a class="code" href="classspell.html#afca00dce83ea257e838d8cfade31955c">temp_duration_multiplyer</a>, 0.0f );</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;}</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno"><a class="line" href="classspell.html#a4b1a5a0c2bd28fb4101608783f25b101">  985</a></span>&#160;std::string <a class="code" href="classspell.html#a4b1a5a0c2bd28fb4101608783f25b101">spell::duration_string</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac17984263d7ed29c73a2b4fe8f783030">spell_flag::RANDOM_DURATION</a> ) ) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s - %s&quot;</span>, <a class="code" href="magic_8cpp.html#a9f6573c11f8d6e7562a97ba6f807396e">moves_to_string</a>( <a class="code" href="classspell.html#a19feb836872fc2fe3818f933a9029f00">min_leveled_duration</a>( caster ) ),</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                              <a class="code" href="magic_8cpp.html#a9f6573c11f8d6e7562a97ba6f807396e">moves_to_string</a>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">max_duration</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) );</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba54bcf9b291726b4cf8343f61681a5cfd">spell_flag::PERMANENT</a> ) &amp;&amp; ( <a class="code" href="classspell.html#ac0702e64e2757dd74767f00f2e4cd159">is_max_level</a>( caster ) ||</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                 <a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;summon&quot;</span> ) ) ||</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;               <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba82397545cee465e4bda1cb70ef78c0f0">spell_flag::PERMANENT_ALL_LEVELS</a> ) ) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Permanent&quot;</span> );</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="magic_8cpp.html#a9f6573c11f8d6e7562a97ba6f807396e">moves_to_string</a>( <a class="code" href="classspell.html#a3a67307def07ddc6d2e2c134d21c245f">duration</a>( caster ) );</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;}</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"><a class="line" href="classspell.html#ad0fe357d9c04c94f9c6329c89d683dae"> 1000</a></span>&#160;<a class="code" href="classtime__duration.html">time_duration</a> <a class="code" href="classspell.html#ad0fe357d9c04c94f9c6329c89d683dae">spell::duration_turns</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classtime__duration.html#aacd074821aecb38a24d9ce6ca42a9127">time_duration::from_moves</a>( <a class="code" href="classspell.html#a3a67307def07ddc6d2e2c134d21c245f">duration</a>( caster ) );</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;}</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"><a class="line" href="classspell.html#a682544edebcf289a96fc4fcd812890c8"> 1005</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a682544edebcf289a96fc4fcd812890c8">spell::gain_level</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;{</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <a class="code" href="classspell.html#a526d158b9396a81cb13186db31c53ae1">gain_exp</a>( guy, <a class="code" href="classspell.html#a4907623e7faca6b194e24543b1862d1e">exp_to_next_level</a>() );</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"><a class="line" href="classspell.html#a7ad2e0f8de920dad808a184a5760e295"> 1010</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a7ad2e0f8de920dad808a184a5760e295">spell::gain_levels</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keywordtype">int</span> gains )</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;{</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">if</span>( gains &lt; 1 ) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> gained = 0; gained &lt; gains &amp;&amp; !<a class="code" href="classspell.html#ac0702e64e2757dd74767f00f2e4cd159">is_max_level</a>( guy ); gained++ ) {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <a class="code" href="classspell.html#a682544edebcf289a96fc4fcd812890c8">gain_level</a>( guy );</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;}</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"><a class="line" href="classspell.html#a21f5450a0454bf54ca779f62fada69b6"> 1020</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a21f5450a0454bf54ca779f62fada69b6">spell::set_level</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keywordtype">int</span> nlevel )</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;{</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <a class="code" href="classspell.html#afe669e2e24cdf747a0133eb892eb1aa1">experience</a> = 0;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <a class="code" href="classspell.html#a7ad2e0f8de920dad808a184a5760e295">gain_levels</a>( guy, nlevel );</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;}</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"><a class="line" href="classspell.html#ac0702e64e2757dd74767f00f2e4cd159"> 1026</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#ac0702e64e2757dd74767f00f2e4cd159">spell::is_max_level</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>() &gt;= <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ad2535cbbbb4a50c01ee79c47d3dde019">max_level</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d );</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;}</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"><a class="line" href="classspell.html#a4cd3c2989310be69c17be190328586c0"> 1032</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a4cd3c2989310be69c17be190328586c0">spell::can_learn</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;}</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"><a class="line" href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924"> 1040</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924">spell::energy_cost</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordtype">int</span> cost;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( guy ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &lt; <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a171e7148d9087468c1be262d13802338">final_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        cost = <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a171e7148d9087468c1be262d13802338">final_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ),</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                         <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) +</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                                           <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a374a9343878e6614c0185f25acf37b30">energy_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) * <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() ) ) );</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt; <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a171e7148d9087468c1be262d13802338">final_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        cost = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a171e7148d9087468c1be262d13802338">final_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ),</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                         <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) +</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                           <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a374a9343878e6614c0185f25acf37b30">energy_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) * <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() ) ) );</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        cost = <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d );</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#a8fabcf473532ae18478ca8c826543ebe">no_hands</a>() &amp;&amp; !guy.<a class="code" href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">has_flag</a>( <a class="code" href="magic_8cpp.html#a7e54b3fea40776c033ce3476443d8eed">json_flag_SUBTLE_SPELL</a> ) ) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="comment">// the first 10 points of combined encumbrance is ignored, but quickly adds up</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> hands_encumb = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0,</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                           guy.<a class="code" href="classCharacter.html#a0bae97cba21daebf53484d06605e6529">avg_encumb_of_limb_type</a>( <a class="code" href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1a573ce5969e9884d49d4fab77b09a306a">body_part_type::type::hand</a> ) - 5 );</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordflow">switch</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ad7a21ee64ec72743911b9461e3add78b">energy_source</a> ) {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                cost += 10 * hands_encumb * <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a>:</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                cost += hands_encumb * <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">magic_energy_type::stamina</a>:</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                cost += 100 * hands_encumb * <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( cost * <a class="code" href="classspell.html#add38c2281c13a3e1531b72db141b2a4b">temp_spell_cost_multiplyer</a>, 0.0f );</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;}</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"><a class="line" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268"> 1074</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">spell::has_flag</a>( <span class="keyword">const</span> <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197b">spell_flag</a> &amp;flag )<span class="keyword"> const</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a74d93ff32c5d02d21548e7164e39b7f1">spell_tags</a>[flag];</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;}</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"><a class="line" href="classspell.html#aaa3543a6accbf016c6478c41d31dced7"> 1079</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">spell::has_flag</a>( <span class="keyword">const</span> std::string &amp;flag )<span class="keyword"> const</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a40d30bd9621c0f8c64b488bed2a0ce51">flags</a>.count( flag ) &gt; 0;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;}</div>
<div class="line"><a name="l01083"></a><span class="lineno"><a class="line" href="classspell.html#a8fabcf473532ae18478ca8c826543ebe"> 1083</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a8fabcf473532ae18478ca8c826543ebe">spell::no_hands</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">return</span> ( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197baf3e1ebf88738c62c2ae49c2319642213">spell_flag::NO_HANDS</a> ) || <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a> &lt;= 0 );</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;}</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"><a class="line" href="classspell.html#a1800276357c17c73c885f051c7edf1d7"> 1088</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a1800276357c17c73c885f051c7edf1d7">spell::is_spell_class</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">trait_id</a> &amp;mid )<span class="keyword"> const</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">return</span> mid == <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;}</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="classspell.html#ab2631d5fc9da8a5ec04f7c3757e6c9f5"> 1093</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#ab2631d5fc9da8a5ec04f7c3757e6c9f5">spell::can_cast</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">if</span>( guy.<a class="code" href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">has_flag</a>( <a class="code" href="magic_8cpp.html#a3a15cd3f4a620df4e0fc5b4ecb0111af">json_flag_NO_SPELLCASTING</a> ) &amp;&amp; !<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a> ) ) {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">if</span>( guy.<a class="code" href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">has_flag</a>( <a class="code" href="magic_8cpp.html#affad52c1fd604b4619fae07ee57a714d">json_flag_NO_PSIONICS</a> ) &amp;&amp; <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a> ) ) {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>.<a class="code" href="classstring__id.html#ac180a60056901aaf79f5c4b728a257bd">is_empty</a>() &amp;&amp;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        !<a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>-&gt;<a class="code" href="structrequirement__data.html#a07c67f146358ed0de2aface7588c20d2">can_make_with_inventory</a>( guy.<a class="code" href="classCharacter.html#ace218285f4fbc7c7a9feac8378bc632e">crafting_inventory</a>( guy.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 0, <span class="keyword">false</span> ),</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                return_true&lt;item&gt; ) ) {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;has_enough_energy( guy, *<span class="keyword">this</span> );</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;}</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"><a class="line" href="classspell.html#ad8ebcd422eb7d3caefc7c413ba9a910e"> 1112</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#ad8ebcd422eb7d3caefc7c413ba9a910e">spell::use_components</a>( <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>.<a class="code" href="classstring__id.html#ac180a60056901aaf79f5c4b728a257bd">is_empty</a>() ) {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keyword">const</span> <a class="code" href="structrequirement__data.html">requirement_data</a> &amp;spell_components = <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>();</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="comment">// if we&#39;re here, we&#39;re assuming the Character has the correct components (using can_cast())</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="classinventory.html">inventory</a> map_inv;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    map_inv.<a class="code" href="classinventory.html#a31bf20ee0144627b5fba528b81559bc6">form_from_map</a>( guy.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 0, &amp;guy, <span class="keyword">true</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::vector&lt;item_comp&gt; &amp;comp_vec : spell_components.<a class="code" href="structrequirement__data.html#a56dbf23ade6bced0dc6148b8e1a12d4c">get_components</a>() ) {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        guy.<a class="code" href="classCharacter.html#a5d161e8df8122b5f3d74a081ee8d12cf">consume_items</a>( guy.<a class="code" href="classCharacter.html#a15e400d8098702465a58e5ff71ad734f">select_item_component</a>( comp_vec, 1, map_inv ), 1 );</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::vector&lt;tool_comp&gt; &amp;tool_vec : spell_components.<a class="code" href="structrequirement__data.html#a175d46943600149603b7a915cb48092b">get_tools</a>() ) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        guy.<a class="code" href="classCharacter.html#a33d0aa99b607cfbe38b910d4dd6b0b1b">consume_tools</a>( guy.<a class="code" href="classCharacter.html#a860d40c9c27d0d12490c014cba63c598">select_tool_component</a>( tool_vec, 1, map_inv ), 1 );</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;}</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"><a class="line" href="classspell.html#a37603127451eef7c25b11d8dd03d208c"> 1129</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a37603127451eef7c25b11d8dd03d208c">spell::check_if_component_in_hand</a>( <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>.<a class="code" href="classstring__id.html#ac180a60056901aaf79f5c4b728a257bd">is_empty</a>() ) {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keyword">const</span> <a class="code" href="structrequirement__data.html">requirement_data</a> &amp;spell_components = <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>();</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordflow">if</span>( guy.<a class="code" href="classCharacter.html#a9511a04100db12858069c5fd802fa77e">has_weapon</a>() ) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordflow">if</span>( spell_components.<a class="code" href="structrequirement__data.html#a07c67f146358ed0de2aface7588c20d2">can_make_with_inventory</a>( *guy.<a class="code" href="classCharacter.html#aa9a4335ab1fd0d975199750b1ebf5bef">get_wielded_item</a>(), return_true&lt;item&gt; ) ) {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    }</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="comment">// if it isn&#39;t in hand, return false</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;}</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"><a class="line" href="classspell.html#a0c002dde68c8222bed0a619b28e0b91a"> 1147</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a0c002dde68c8222bed0a619b28e0b91a">spell::get_difficulty</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a960a7f198bd614a7c048405d7d120f61">difficulty</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) + <a class="code" href="classspell.html#a35f7c66814c80a047ed87d86d13ba6c6">temp_difficulty_adjustment</a>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;}</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"><a class="line" href="classspell.html#a67107306974252fab83a7ee7fb8b26bb"> 1153</a></span>&#160;<a class="code" href="classstring__id.html">mod_id</a> <a class="code" href="classspell.html#a67107306974252fab83a7ee7fb8b26bb">spell::get_src</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#afca82c905601cf50d72c07a65dc56f11">src_mod</a>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;}</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"><a class="line" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5"> 1158</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">spell::casting_time</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keywordtype">bool</span> ignore_encumb )<span class="keyword"> const</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// casting time in moves</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a> = 0;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( guy ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &lt; <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#adccbac25f546cf4b277b1058b59f0ae8">final_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a> = <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#adccbac25f546cf4b277b1058b59f0ae8">final_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ),</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                 <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) +</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                         <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a094462d9091edcb781516ba1c6bf5096">casting_time_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) *</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                         <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() ) ) );</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt; <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#adccbac25f546cf4b277b1058b59f0ae8">final_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a> = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#adccbac25f546cf4b277b1058b59f0ae8">final_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ),</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                                 <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) +</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                         <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a094462d9091edcb781516ba1c6bf5096">casting_time_increment</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) *</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                                         <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() ) ) );</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a> = <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d );</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a> = guy.<a class="code" href="classCharacter.html#add870e576ff59aa6943af286576219e9">enchantment_cache</a>-&gt;modify_value( <a class="code" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998ae9b273235243d4a251ec58ccbe1c6d1e">enchant_vals::mod::CASTING_TIME_MULTIPLIER</a>,</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                   <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a> );</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">if</span>( !ignore_encumb &amp;&amp; <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba5b16e7a428e2fc90a37998f0fb12631f">spell_flag::NO_LEGS</a> ) ) {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            <span class="comment">// the first 20 points of encumbrance combined is ignored</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> legs_encumb = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                              guy.<a class="code" href="classCharacter.html#a0bae97cba21daebf53484d06605e6529">avg_encumb_of_limb_type</a>( <a class="code" href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1a4e1df3d256693afb3630685668820df4">body_part_type::type::leg</a> ) - 10 );</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a> += legs_encumb * 3 * <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba7f3501211ea094337741cf2259a3e333">spell_flag::SOMATIC</a> ) &amp;&amp; !guy.<a class="code" href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">has_flag</a>( <a class="code" href="magic_8cpp.html#a7e54b3fea40776c033ce3476443d8eed">json_flag_SUBTLE_SPELL</a> ) ) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            <span class="comment">// the first 20 points of encumbrance combined is ignored</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> arms_encumb = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0,</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                              guy.<a class="code" href="classCharacter.html#a0bae97cba21daebf53484d06605e6529">avg_encumb_of_limb_type</a>( <a class="code" href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1af926b3e222d7afee57071b2256839701">body_part_type::type::arm</a> ) - 10 );</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a> += arms_encumb * 2 * <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( <a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a> * <a class="code" href="classspell.html#ad2aedf645ec1614d5a4d832a7d411e22">temp_cast_time_multiplyer</a>, 0.0f );</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;}</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"><a class="line" href="classspell.html#af69dedf22c42ebc9fb41f8f22102630d"> 1197</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structrequirement__data.html">requirement_data</a> &amp;<a class="code" href="classspell.html#af69dedf22c42ebc9fb41f8f22102630d">spell::components</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>();</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;}</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"><a class="line" href="classspell.html#ad8662455c101a353ea64618a49908a4b"> 1202</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#ad8662455c101a353ea64618a49908a4b">spell::has_components</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">return</span> !<a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_components</a>.<a class="code" href="classstring__id.html#ac180a60056901aaf79f5c4b728a257bd">is_empty</a>();</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;}</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"><a class="line" href="classspell.html#abdf34d5415c3fdafcd84fe3a7101bddb"> 1207</a></span>&#160;std::string <a class="code" href="classspell.html#abdf34d5415c3fdafcd84fe3a7101bddb">spell::name</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">name</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>();</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;}</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"><a class="line" href="classspell.html#ac4826c2795f1db1547ef57ccd408f8cf"> 1212</a></span>&#160;std::string <a class="code" href="classspell.html#ac4826c2795f1db1547ef57ccd408f8cf">spell::message</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#a838599c428e33e70b7e62b3e195dc6b9">alt_message</a>.<a class="code" href="classtranslation.html#a85e9c5ae8df7eb6df7bac2473b9716dd">empty</a>() ) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classspell.html#a838599c428e33e70b7e62b3e195dc6b9">alt_message</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>();</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a1e5fb7d2cfe305bd5b26dccdce21273b">message</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>();</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;}</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"><a class="line" href="classspell.html#ada3a6b9f7ba0c643ee59b8389b9f56ec"> 1220</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classspell.html#ada3a6b9f7ba0c643ee59b8389b9f56ec">spell::spell_fail</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba60c0bff03788dc44e951565aa413a637">spell_flag::NO_FAIL</a> ) ) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_psi = <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a> );</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">// formula is based on the following:</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="comment">// exponential curve</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="comment">// effective skill of 0 or less is 100% failure</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="comment">// effective skill of 8 (8 int, 0 spellcraft, 0 spell level, spell difficulty 0) is ~50% failure</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">// effective skill of 30 is 0% failure</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> effective_skill = 2 * ( <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() - <a class="code" href="classspell.html#a0c002dde68c8222bed0a619b28e0b91a">get_difficulty</a>(</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                                            guy ) ) + guy.<a class="code" href="classCharacter.html#a588d5cc1d729490552fe03b006685ae5">get_int</a>() +</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                                  guy.<a class="code" href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">get_skill_level</a>( <a class="code" href="classspell.html#ab4c5d1958442f999fe006be4d89883cf">skill</a>() );</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">// skill for psi powers downplays power level and is much more based on level and intelligence</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">// and goes up to 40 max--effective skill of 10 is 50% failure, effective skill of 40 is 0%</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// Int 8, Metaphysics 2, level 1, difficulty 1 is effective level 26.5</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">// Int 10, Metaphysics 5, level 4, difficulty 5 is effective level 27</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="comment">// Int 12, Metaphysics 8, level 7, difficulty 10 is effective level 33.5</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> two_thirds_power_level = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() ) /</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                                         <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                         ( 1.5 );</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> psi_effective_skill = 2 * ( ( guy.<a class="code" href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">get_skill_level</a>( <a class="code" href="classspell.html#ab4c5d1958442f999fe006be4d89883cf">skill</a>() ) * 2 ) - <a class="code" href="classspell.html#a0c002dde68c8222bed0a619b28e0b91a">get_difficulty</a>(</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            guy ) ) + ( guy.<a class="code" href="classCharacter.html#a588d5cc1d729490552fe03b006685ae5">get_int</a>() * 1.5 ) + two_thirds_power_level;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">// add an if statement in here because sufficiently large numbers will definitely overflow because of exponents</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordflow">if</span>( ( effective_skill &gt; 30.0f &amp;&amp; !is_psi ) || ( psi_effective_skill &gt; 40.0f &amp;&amp; is_psi ) ) {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( effective_skill &lt; 0.0f &amp;&amp; !is_psi ) || ( psi_effective_skill &lt; 0.0f &amp;&amp; is_psi ) ) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <span class="keywordflow">return</span> 1.0f;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordtype">float</span> fail_chance = std::pow( ( effective_skill - 30.0f ) / 30.0f, 2 );</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordtype">float</span> psi_fail_chance = std::pow( ( psi_effective_skill - 40.0f ) / 40.0f, 2 );</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">if</span>( !is_psi ) {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba7f3501211ea094337741cf2259a3e333">spell_flag::SOMATIC</a> ) &amp;&amp;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            !guy.<a class="code" href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">has_flag</a>( <a class="code" href="magic_8cpp.html#a7e54b3fea40776c033ce3476443d8eed">json_flag_SUBTLE_SPELL</a> ) &amp;&amp; <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <span class="comment">// the first 20 points of encumbrance combined is ignored</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> arms_encumb = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0,</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                                              guy.<a class="code" href="classCharacter.html#a0bae97cba21daebf53484d06605e6529">avg_encumb_of_limb_type</a>( <a class="code" href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1af926b3e222d7afee57071b2256839701">body_part_type::type::arm</a> ) - 10 );</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="comment">// each encumbrance point beyond the &quot;gray&quot; color counts as half an additional fail %</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            fail_chance += ( arms_encumb / 200.0f ) * <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba604cda0a87a71f133cff82d25d1195c2">spell_flag::VERBAL</a> ) &amp;&amp;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            !guy.<a class="code" href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">has_flag</a>( <a class="code" href="magic_8cpp.html#ad199c3bc7a5d8202c5122a34588b792e">json_flag_SILENT_SPELL</a> ) &amp;&amp; <a class="code" href="classspell.html#abbefbc21e6bf90db7b45cae05c3a6c9f">temp_sound_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            <span class="comment">// a little bit of mouth encumbrance is allowed, but not much</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> mouth_encumb = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0,</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                                               guy.<a class="code" href="classCharacter.html#a0bae97cba21daebf53484d06605e6529">avg_encumb_of_limb_type</a>( <a class="code" href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1acb5786412becb979c90f606f25ad4b4f">body_part_type::type::mouth</a> ) - 5 );</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            fail_chance += ( mouth_encumb / 100.0f ) * <a class="code" href="classspell.html#abbefbc21e6bf90db7b45cae05c3a6c9f">temp_sound_multiplyer</a>;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        }</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment">// concentration spells work better than you&#39;d expect with a higher focus pool</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba0297e660e18811956462c321349a263c">spell_flag::CONCENTRATE</a> ) &amp;&amp; <a class="code" href="classspell.html#a7d2e3b1f81c61f10312aa50e3626b2f9">temp_concentration_difficulty_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">if</span>( guy.<a class="code" href="classCharacter.html#a6718828920830004d1c3e0dc847fc683">get_focus</a>() &lt;= 0 ) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordtype">float</span> concentration_loss = ( 1.0f - ( guy.<a class="code" href="classCharacter.html#a6718828920830004d1c3e0dc847fc683">get_focus</a>() / 100.0f ) ) *</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                   <a class="code" href="classspell.html#a7d2e3b1f81c61f10312aa50e3626b2f9">temp_concentration_difficulty_multiplyer</a>;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        fail_chance /= 1.0f - concentration_loss;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        psi_fail_chance /= 1.0f - concentration_loss;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( is_psi ? psi_fail_chance : fail_chance, 0.0f, 1.0f );</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;}</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="classspell.html#afe11a0854d38e947a10d02e29f7fd84c"> 1289</a></span>&#160;std::string <a class="code" href="classspell.html#afe11a0854d38e947a10d02e29f7fd84c">spell::colorized_fail_percent</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> fail_fl = <a class="code" href="classspell.html#ada3a6b9f7ba0c643ee59b8389b9f56ec">spell_fail</a>( guy ) * 100.0f;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    std::string fail_str;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    fail_fl == 100.0f ? fail_str = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Too Difficult!&quot;</span> ) : fail_str = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%.1f %% %s&quot;</span>,</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                                   fail_fl, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Failure Chance&quot;</span> ) );</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <a class="code" href="classnc__color.html">nc_color</a> <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keywordflow">if</span>( fail_fl &gt; 90.0f ) {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a>;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( fail_fl &gt; 75.0f ) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( fail_fl &gt; 60.0f ) {</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="color_8h.html#aab11865a3631a7ce78da82b7fb386b71">c_light_red</a>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( fail_fl &gt; 35.0f ) {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="color_8h.html#a81e80ab9142609903b4788a6bb31ae45">c_yellow</a>;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( fail_fl &gt; 15.0f ) {</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="color_8h.html#a1cb87e74156596960610fd0a9ace766d">c_green</a>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( fail_str, <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> );</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;}</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"><a class="line" href="classspell.html#ab26955ff4600c3a2855e6fe02dc0d216"> 1312</a></span>&#160;<a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9c">spell_shape</a> <a class="code" href="classspell.html#ab26955ff4600c3a2855e6fe02dc0d216">spell::shape</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#abf08fe1f454fd0649d9855104630afe4">spell_area</a>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;}</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160; </div>
<div class="line"><a name="l01317"></a><span class="lineno"><a class="line" href="classspell.html#a1758e56413516ae56a4ee161e998c338"> 1317</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a1758e56413516ae56a4ee161e998c338">spell::xp</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#afe669e2e24cdf747a0133eb892eb1aa1">experience</a>;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;}</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"><a class="line" href="classspell.html#a526d158b9396a81cb13186db31c53ae1"> 1322</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a526d158b9396a81cb13186db31c53ae1">spell::gain_exp</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keywordtype">int</span> nxp )</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;{</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordtype">int</span> oldLevel = <a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>();</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="classspell.html#afe669e2e24cdf747a0133eb892eb1aa1">experience</a> += nxp;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">if</span>( guy.<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() &amp;&amp; oldLevel != <a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>() ) {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a15d9350620fdb06df8ad3d5410d8d54f">event_type::player_levels_spell</a>&gt;( guy.<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), <a class="code" href="classspell.html#a7d44bdaf4c9faff438e6b30973d68615">id</a>(), <a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>(),</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                <a class="code" href="classspell.html#a388a3e18bba1c58aa9c00dc53bc97aef">spell_class</a>() );</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;}</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"><a class="line" href="classspell.html#add2c742d2996e6c81ab5b70b081544d9"> 1332</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#add2c742d2996e6c81ab5b70b081544d9">spell::set_exp</a>( <span class="keywordtype">int</span> nxp )</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;{</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <a class="code" href="classspell.html#afe669e2e24cdf747a0133eb892eb1aa1">experience</a> = nxp;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;}</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"><a class="line" href="classspell.html#aeb55e6084337fb199e3cab09260ad916"> 1337</a></span>&#160;std::string <a class="code" href="classspell.html#aeb55e6084337fb199e3cab09260ad916">spell::energy_string</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ad7a21ee64ec72743911b9461e3add78b">energy_source</a> ) {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a>:</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;health&quot;</span> );</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f">magic_energy_type::mana</a>:</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;mana&quot;</span> );</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">magic_energy_type::stamina</a>:</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;stamina&quot;</span> );</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d">magic_energy_type::bionic</a>:</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;kJ&quot;</span> );</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;}</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"><a class="line" href="classspell.html#a0d3f68783edb1af2e111e85f7a1715fa"> 1353</a></span>&#160;std::string <a class="code" href="classspell.html#a0d3f68783edb1af2e111e85f7a1715fa">spell::energy_cost_string</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8">magic_energy_type::none</a> ) {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;none&quot;</span> );</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d">magic_energy_type::bionic</a> || <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f">magic_energy_type::mana</a> ) {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( <a class="code" href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924">energy_cost</a>( guy ) ), <a class="code" href="color_8h.html#a7b00fb82de0be83f6fc5f7965ea86623">c_light_blue</a> );</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    }</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a> ) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        <span class="keyword">auto</span> pair = <a class="code" href="output_8cpp.html#aafdcbf1eb3398c6e92cf3b71f6c8ad03">get_hp_bar</a>( <a class="code" href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924">energy_cost</a>( guy ), guy.<a class="code" href="classCreature.html#a6e1819fd37a50af66566c6d1b896572a">get_hp_max</a>() / 6 );</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( pair.first, pair.second );</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">magic_energy_type::stamina</a> ) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <span class="keyword">auto</span> pair = <a class="code" href="output_8cpp.html#aafdcbf1eb3398c6e92cf3b71f6c8ad03">get_hp_bar</a>( <a class="code" href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924">energy_cost</a>( guy ), guy.<a class="code" href="classCharacter.html#aefe5432750eb1c2c65fea628fd9878a7">get_stamina_max</a>() );</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( pair.first, pair.second );</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: Spell %s has invalid energy source.&quot;</span>, <span class="keywordtype">id</span>().c_str() );</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;error: energy_type&quot;</span> );</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;}</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"><a class="line" href="classspell.html#a1dc2bd4fd1f177c091237236627bd993"> 1373</a></span>&#160;std::string <a class="code" href="classspell.html#a1dc2bd4fd1f177c091237236627bd993">spell::energy_cur_string</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8">magic_energy_type::none</a> ) {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;infinite&quot;</span> );</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d">magic_energy_type::bionic</a> ) {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( <a class="code" href="namespaceunits.html#a7f3948de70e78d68af74fb3d119cf176">units::to_kilojoule</a>( guy.<a class="code" href="classCharacter.html#add22510ff2fa20a662868b4dd86e030e">get_power_level</a>() ) ), <a class="code" href="color_8h.html#a7b00fb82de0be83f6fc5f7965ea86623">c_light_blue</a> );</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f">magic_energy_type::mana</a> ) {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( guy.<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;available_mana() ), <a class="code" href="color_8h.html#a7b00fb82de0be83f6fc5f7965ea86623">c_light_blue</a> );</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">magic_energy_type::stamina</a> ) {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        <span class="keyword">auto</span> pair = <a class="code" href="output_8cpp.html#aafdcbf1eb3398c6e92cf3b71f6c8ad03">get_hp_bar</a>( guy.<a class="code" href="classCharacter.html#a0ffe14df559cee6e9b5d02f5b214d009">get_stamina</a>(), guy.<a class="code" href="classCharacter.html#aefe5432750eb1c2c65fea628fd9878a7">get_stamina_max</a>() );</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( pair.first, pair.second );</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a> ) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    }</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: Spell %s has invalid energy source.&quot;</span>, <span class="keywordtype">id</span>().c_str() );</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;error: energy_type&quot;</span> );</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;}</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; </div>
<div class="line"><a name="l01395"></a><span class="lineno"><a class="line" href="classspell.html#a0f7316c4f276b359eb3c4d5fb418d7a3"> 1395</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a0f7316c4f276b359eb3c4d5fb418d7a3">spell::is_valid</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>.<a class="code" href="classstring__id.html#a8ca0e76fa665125f1e50bd1ed8dbd213">is_valid</a>();</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;}</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"><a class="line" href="classspell.html#a6f76f8894099d3d7fd0f54f765a0991e"> 1400</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a6f76f8894099d3d7fd0f54f765a0991e">spell::bp_is_affected</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">bodypart_str_id</a> &amp;<a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> )<span class="keyword"> const</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ad2ddb53d6c4f656d913e5093d84f1ad6">affected_bps</a>.<a class="code" href="classbody__part__set.html#ac4e5ce7eea67f44279a4db416a7903cd">test</a>( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> );</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"><a class="line" href="classspell.html#a2e1753d54122c01ea14e9abbb2bd886f"> 1405</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a2e1753d54122c01ea14e9abbb2bd886f">spell::create_field</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;at, <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#aa5f6b0b99d9ffd592376016d6162359b">field</a> ) {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> = <a class="code" href="classspell.html#a9a0b1eb365a5b17870ea15171a60ee14">field_intensity</a>( caster ) + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -<a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#acedfba24abe1ece6dad25009b1797c33">field_intensity_variance</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>(</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                              d ) * <a class="code" href="classspell.html#a9a0b1eb365a5b17870ea15171a60ee14">field_intensity</a>( caster ),</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                          <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#acedfba24abe1ece6dad25009b1797c33">field_intensity_variance</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) * <a class="code" href="classspell.html#a9a0b1eb365a5b17870ea15171a60ee14">field_intensity</a>( caster ) );</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> &lt;= 0 ) {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ad7c34417b82c32b2f70b4d049b50f854">field_chance</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ) {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <a class="code" href="classfield__entry.html">field_entry</a> *<a class="code" href="classfield.html">field</a> = here.<a class="code" href="classmap.html#a30cfefdb115c16c5e1af6cc99f94bbbd">get_field</a>( at, *<a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#aa5f6b0b99d9ffd592376016d6162359b">field</a> );</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classfield.html">field</a> ) {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <a class="code" href="classfield.html">field</a>-&gt;set_field_intensity( <a class="code" href="classfield.html">field</a>-&gt;get_field_intensity() + <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> );</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            here.<a class="code" href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">add_field</a>( at, *<a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#aa5f6b0b99d9ffd592376016d6162359b">field</a>, <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a>, -<a class="code" href="classspell.html#ad0fe357d9c04c94f9c6329c89d683dae">duration_turns</a>( caster ) );</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        }</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;}</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"><a class="line" href="classspell.html#a09d458a079bc27306786045580033794"> 1428</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a09d458a079bc27306786045580033794">spell::sound_volume</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordtype">int</span> loudness = 0;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba7e92d833d7720dbe631730a6cea03346">spell_flag::SILENT</a> ) ) {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        loudness = <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( <a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( caster ) ) / 3;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba658a021a796aa5501503220adb38cf45">spell_flag::LOUD</a> ) ) {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            loudness += 1 + <a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( caster ) / 3;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( loudness * <a class="code" href="classspell.html#abbefbc21e6bf90db7b45cae05c3a6c9f">temp_sound_multiplyer</a>, 0.0f );</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;}</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"><a class="line" href="classspell.html#a09d10eac783473b568da11d51abd38a6"> 1440</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a09d10eac783473b568da11d51abd38a6">spell::make_sound</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target, <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> loudness = <a class="code" href="classspell.html#a09d458a079bc27306786045580033794">sound_volume</a>( caster );</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span>( loudness &gt; 0 ) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <a class="code" href="classspell.html#a09d10eac783473b568da11d51abd38a6">make_sound</a>( target, loudness );</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;}</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"><a class="line" href="classspell.html#a424c425308192eb085b48286f6e09fdd"> 1448</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a09d10eac783473b568da11d51abd38a6">spell::make_sound</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target, <span class="keywordtype">int</span> loudness )<span class="keyword"> const</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <a class="code" href="namespacesounds.html#a6bb79ae1c9c3dcd8c8e0b28c66b0398d">sounds::sound</a>( target, loudness, <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a2dc22c6c8d58f23f22a4a9b72cd7eed7">sound_type</a>, <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a868516b343411f98fcf2a2c961de01cb">sound_description</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>(),</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                   <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ac5fb63c1cb3f31f1c705e9988e882e4a">sound_ambient</a>, <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a91953b9d5715f36608e753b3fc5e805d">sound_id</a>, <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a8a9f3e75988d34cf9e89abfec583ba67">sound_variant</a> );</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;}</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; </div>
<div class="line"><a name="l01454"></a><span class="lineno"><a class="line" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35"> 1454</a></span>&#160;std::string <a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">spell::effect</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#afa2cd70d2587c495c1565209b2292a36">effect_name</a>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;}</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; </div>
<div class="line"><a name="l01459"></a><span class="lineno"><a class="line" href="classspell.html#a593232b1e5fc4c81d536724d40322efd"> 1459</a></span>&#160;<a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1">magic_energy_type</a> <a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">spell::energy_source</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ad7a21ee64ec72743911b9461e3add78b">energy_source</a>;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;}</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"><a class="line" href="classspell.html#a2d25bed9a9b942e4ada705b79dc43158"> 1464</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a2d25bed9a9b942e4ada705b79dc43158">spell::is_target_in_range</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( caster.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), p ) &lt;= <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a>( caster );</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;}</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"><a class="line" href="classspell.html#a60a9b2a90aefc5d4dfd630afaf0d42e6"> 1469</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">spell::is_valid_target</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7">spell_target</a> t )<span class="keyword"> const</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ae696150ec8cf81bc7a35102c562d4517">valid_targets</a>[t];</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;}</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"><a class="line" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12"> 1474</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">spell::is_valid_target</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordtype">bool</span> valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCreature.html">Creature</a> *<span class="keyword">const</span> cr = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().creature_at&lt;Creature&gt;( p ) ) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217">Creature::Attitude</a> cr_att = cr-&gt;attitude_to( caster );</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        valid = valid || ( cr_att != <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Creature::Attitude::FRIENDLY</a> &amp;&amp;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                           <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a8e20e5f0a627b4dd4dedc41a597ab672">spell_target::hostile</a> ) );</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        valid = valid || ( cr_att == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Creature::Attitude::FRIENDLY</a> &amp;&amp;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                           <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a2ad733df56aaafa5650bafc9c98c6ffb">spell_target::ally</a> ) &amp;&amp;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                           p != caster.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        valid = valid || ( <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a590f53e8699817c6fa498cc11a4cbe63">spell_target::self</a> ) &amp;&amp; p == caster.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        valid = valid &amp;&amp; <a class="code" href="classspell.html#a6a41577f639cd544a78c66360e61cc2a">target_by_monster_id</a>( p );</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        valid = valid &amp;&amp; <a class="code" href="classspell.html#aa9c08f86e5d6ba271db251ade738afd8">target_by_species_id</a>( p );</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        valid = valid &amp;&amp; <a class="code" href="classspell.html#a5e36e855e9cb0c85469e782cbb6a2e57">ignore_by_species_id</a>( p );</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        valid = <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a578552719239a72a2d45ad422f67d24d">spell_target::ground</a> );</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">return</span> valid;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;}</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; </div>
<div class="line"><a name="l01494"></a><span class="lineno"><a class="line" href="classspell.html#a6a41577f639cd544a78c66360e61cc2a"> 1494</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a6a41577f639cd544a78c66360e61cc2a">spell::target_by_monster_id</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af64d6acee71a4ba9f6a51459fddb9953">targeted_monster_ids</a>.empty() ) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordtype">bool</span> valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html">monster</a> *<span class="keyword">const</span> target = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().creature_at&lt;monster&gt;( p ) ) {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af64d6acee71a4ba9f6a51459fddb9953">targeted_monster_ids</a>.find( target-&gt;type-&gt;id ) != <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af64d6acee71a4ba9f6a51459fddb9953">targeted_monster_ids</a>.end() ) {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            valid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        }</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">return</span> valid;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;}</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160; </div>
<div class="line"><a name="l01508"></a><span class="lineno"><a class="line" href="classspell.html#aa9c08f86e5d6ba271db251ade738afd8"> 1508</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#aa9c08f86e5d6ba271db251ade738afd8">spell::target_by_species_id</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a60c88145cf9b37dfe7b141b143095246">targeted_species_ids</a>.empty() ) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="keywordtype">bool</span> valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html">monster</a> *<span class="keyword">const</span> target = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().creature_at&lt;monster&gt;( p ) ) {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">species_id</a> &amp;spid : <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a60c88145cf9b37dfe7b141b143095246">targeted_species_ids</a> ) {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            <span class="keywordflow">if</span>( target-&gt;type-&gt;in_species( spid ) ) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                valid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">return</span> valid;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;}</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"><a class="line" href="classspell.html#a5e36e855e9cb0c85469e782cbb6a2e57"> 1524</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a5e36e855e9cb0c85469e782cbb6a2e57">spell::ignore_by_species_id</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a48f952d3f551b2cab4fdb46087613c48">ignored_species_ids</a>.empty() ) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html">monster</a> *<span class="keyword">const</span> target = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().creature_at&lt;monster&gt;( p ) ) {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">species_id</a> &amp;spid : <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a48f952d3f551b2cab4fdb46087613c48">ignored_species_ids</a> ) {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            <span class="keywordflow">if</span>( target-&gt;type-&gt;in_species( spid ) ) {</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">return</span> valid;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;}</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"><a class="line" href="classspell.html#acc66691f05cd20a085370d79df52bafa"> 1543</a></span>&#160;std::string <a class="code" href="classspell.html#acc66691f05cd20a085370d79df52bafa">spell::description</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a0bf174d1f3134b53667d8381c02d6ee4">description</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>();</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;}</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; </div>
<div class="line"><a name="l01548"></a><span class="lineno"><a class="line" href="classspell.html#a1ed087b326bb00071482cadeff078b15"> 1548</a></span>&#160;<a class="code" href="classnc__color.html">nc_color</a> <a class="code" href="classspell.html#a1ed087b326bb00071482cadeff078b15">spell::damage_type_color</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b">dmg_type</a>().is_null() ) {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8h.html#a2d8f37367a34632745626276dd4c9da6">c_black</a>;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    }</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b">dmg_type</a>()-&gt;<a class="code" href="structdamage__type.html#a8872089798a7b34f4766f9a672617a0a">magic_color</a>;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;}</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"><a class="line" href="classspell.html#a33b19b10be6eded53db5dee401ba6da5"> 1556</a></span>&#160;std::string <a class="code" href="classspell.html#a33b19b10be6eded53db5dee401ba6da5">spell::damage_type_string</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b">dmg_type</a>().is_null() ) {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        <span class="keywordflow">return</span> std::string();</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b">dmg_type</a>()-&gt;<a class="code" href="structdamage__type.html#ab329ea5acb5b5b6cb1e6224ead89ebcf">name</a>.<a class="code" href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translated</a>();</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;}</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment">// constants defined below are just for the formula to be used,</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">// in order for the inverse formula to be equivalent</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f"> 1566</a></span>&#160;<span class="keyword">static</span> constexpr <span class="keywordtype">double</span> <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = 6200.0;</div>
<div class="line"><a name="l01567"></a><span class="lineno"><a class="line" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f"> 1567</a></span>&#160;<span class="keyword">static</span> constexpr <span class="keywordtype">double</span> <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> = 0.146661;</div>
<div class="line"><a name="l01568"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12"> 1568</a></span>&#160;<span class="keyword">static</span> constexpr <span class="keywordtype">double</span> <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> = -62.5;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"><a class="line" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc"> 1570</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">spell::get_level</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="comment">// you aren&#39;t at the next level unless you have the requisite xp, so floor</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a204ca52ef1b97d079c45e1cb6407f73b">std::floor</a>( <a class="code" href="math__parser__func_8h.html#a6a96e281ee5bf1967d26afebe837ad48">std::log</a>( <a class="code" href="classspell.html#afe669e2e24cdf747a0133eb892eb1aa1">experience</a> + <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> ) / <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> + <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> ) ), 0 );</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;}</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"><a class="line" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff"> 1576</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">spell::get_effective_level</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>() + <a class="code" href="classspell.html#a17425a8a64b4647f35bebaafb1ac2bed">temp_level_adjustment</a>;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;}</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"><a class="line" href="classspell.html#a8c41a03e09eb196bd6c59ff29f3f61c1"> 1581</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a8c41a03e09eb196bd6c59ff29f3f61c1">spell::get_max_level</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( caster ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ad2535cbbbb4a50c01ee79c47d3dde019">max_level</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d );</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;}</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"><a class="line" href="classspell.html#abeb00e3b3567c2b124b847c07fcd4555"> 1587</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#abeb00e3b3567c2b124b847c07fcd4555">spell::get_temp_level_adjustment</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#a17425a8a64b4647f35bebaafb1ac2bed">temp_level_adjustment</a>;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;}</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"><a class="line" href="classspell.html#a658a5172a4c77d28ef4aefdcc474301c"> 1592</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a658a5172a4c77d28ef4aefdcc474301c">spell::set_temp_level_adjustment</a>( <span class="keywordtype">int</span> adjustment )</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;{</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <a class="code" href="classspell.html#a17425a8a64b4647f35bebaafb1ac2bed">temp_level_adjustment</a> = adjustment;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;}</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"><a class="line" href="classspell.html#aaebea12d6d996597d17c65e3b5445807"> 1598</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#aaebea12d6d996597d17c65e3b5445807">spell::set_temp_adjustment</a>( <span class="keyword">const</span> std::string &amp;target_property, <span class="keywordtype">float</span> adjustment )</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;{</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;caster_level&quot;</span> ) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <a class="code" href="classspell.html#a17425a8a64b4647f35bebaafb1ac2bed">temp_level_adjustment</a> += adjustment;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;casting_time&quot;</span> ) {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <a class="code" href="classspell.html#ad2aedf645ec1614d5a4d832a7d411e22">temp_cast_time_multiplyer</a> += adjustment;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;cost&quot;</span> ) {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <a class="code" href="classspell.html#add38c2281c13a3e1531b72db141b2a4b">temp_spell_cost_multiplyer</a> += adjustment;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;aoe&quot;</span> ) {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        <a class="code" href="classspell.html#a2857365ef6cc65207a1ee75fc390ef13">temp_aoe_multiplyer</a> += adjustment;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;range&quot;</span> ) {</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        <a class="code" href="classspell.html#a03dea8803fea1685efa62ace8ab9b082">temp_range_multiplyer</a> += adjustment;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;duration&quot;</span> ) {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <a class="code" href="classspell.html#afca00dce83ea257e838d8cfade31955c">temp_duration_multiplyer</a> += adjustment;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;difficulty&quot;</span> ) {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        <a class="code" href="classspell.html#a35f7c66814c80a047ed87d86d13ba6c6">temp_difficulty_adjustment</a> += adjustment;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;somatic_difficulty&quot;</span> ) {</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a> += adjustment;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;sound&quot;</span> ) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        <a class="code" href="classspell.html#abbefbc21e6bf90db7b45cae05c3a6c9f">temp_sound_multiplyer</a> += adjustment;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( target_property == <span class="stringliteral">&quot;concentration&quot;</span> ) {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <a class="code" href="classspell.html#a7d2e3b1f81c61f10312aa50e3626b2f9">temp_concentration_difficulty_multiplyer</a> += adjustment;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: invalid spellcasting adjustment name: %s&quot;</span>, target_property );</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;}</div>
<div class="line"><a name="l01624"></a><span class="lineno"><a class="line" href="classspell.html#ae3c8a866c5a9199636ed5601844f2399"> 1624</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#ae3c8a866c5a9199636ed5601844f2399">spell::clear_temp_adjustments</a>()</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;{</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <a class="code" href="classspell.html#a17425a8a64b4647f35bebaafb1ac2bed">temp_level_adjustment</a> = 0;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <a class="code" href="classspell.html#ad2aedf645ec1614d5a4d832a7d411e22">temp_cast_time_multiplyer</a> = 1;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <a class="code" href="classspell.html#add38c2281c13a3e1531b72db141b2a4b">temp_spell_cost_multiplyer</a> = 1;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <a class="code" href="classspell.html#a2857365ef6cc65207a1ee75fc390ef13">temp_aoe_multiplyer</a> = 1;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <a class="code" href="classspell.html#a03dea8803fea1685efa62ace8ab9b082">temp_range_multiplyer</a> = 1;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <a class="code" href="classspell.html#afca00dce83ea257e838d8cfade31955c">temp_duration_multiplyer</a> = 1;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <a class="code" href="classspell.html#a35f7c66814c80a047ed87d86d13ba6c6">temp_difficulty_adjustment</a> = 0;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a> = 1;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <a class="code" href="classspell.html#abbefbc21e6bf90db7b45cae05c3a6c9f">temp_sound_multiplyer</a> = 1;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <a class="code" href="classspell.html#a7d2e3b1f81c61f10312aa50e3626b2f9">temp_concentration_difficulty_multiplyer</a> = 1;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;}</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">// helper function to calculate xp needed to be at a certain level</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">// pulled out as a helper function to make it easier to either be used in the future</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment">// or easier to tweak the formula</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"><a class="line" href="classspell.html#ad4dff616ba1d80004e9da4b9858b54ea"> 1641</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#ad4dff616ba1d80004e9da4b9858b54ea">spell::exp_for_level</a>( <span class="keywordtype">int</span> level )</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;{</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="comment">// level 0 never needs xp</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">if</span>( level == 0 ) {</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    }</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#ac9196b0cf8d9dd209db9fc00a69a55f6">std::ceil</a>( std::exp( ( level - <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> ) * <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> ) ) - <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;}</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160; </div>
<div class="line"><a name="l01650"></a><span class="lineno"><a class="line" href="classspell.html#a4907623e7faca6b194e24543b1862d1e"> 1650</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#a4907623e7faca6b194e24543b1862d1e">spell::exp_to_next_level</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#ad4dff616ba1d80004e9da4b9858b54ea">exp_for_level</a>( <a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>() + 1 ) - <a class="code" href="classspell.html#a1758e56413516ae56a4ee161e998c338">xp</a>();</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;}</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160; </div>
<div class="line"><a name="l01655"></a><span class="lineno"><a class="line" href="classspell.html#a231a9d535b9ea869e90963f7e2351c66"> 1655</a></span>&#160;std::string <a class="code" href="classspell.html#a231a9d535b9ea869e90963f7e2351c66">spell::exp_progress</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> level = <a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>();</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> this_level_xp = <a class="code" href="classspell.html#ad4dff616ba1d80004e9da4b9858b54ea">exp_for_level</a>( level );</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> next_level_xp = <a class="code" href="classspell.html#ad4dff616ba1d80004e9da4b9858b54ea">exp_for_level</a>( level + 1 );</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> denominator = next_level_xp - this_level_xp;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> progress = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classspell.html#a1758e56413516ae56a4ee161e998c338">xp</a>() - this_level_xp ) / <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 1.0f,</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                           <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( denominator ) );</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%i%%&quot;</span>, <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( progress * 100 ) ), 0, 99 ) );</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;}</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; </div>
<div class="line"><a name="l01666"></a><span class="lineno"><a class="line" href="classspell.html#ad7a99f3d7def292a3e9af0b869e51103"> 1666</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classspell.html#ad7a99f3d7def292a3e9af0b869e51103">spell::exp_modifier</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> int_modifier = ( guy.<a class="code" href="classCharacter.html#a588d5cc1d729490552fe03b006685ae5">get_int</a>() - 8.0f ) / 8.0f;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> difficulty_modifier = <a class="code" href="classspell.html#a0c002dde68c8222bed0a619b28e0b91a">get_difficulty</a>( guy ) / 20.0f;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> spellcraft_modifier = guy.<a class="code" href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">get_skill_level</a>( <a class="code" href="classspell.html#ab4c5d1958442f999fe006be4d89883cf">skill</a>() ) / 10.0f;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordflow">return</span> ( int_modifier + difficulty_modifier + spellcraft_modifier ) / 5.0f + 1.0f;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;}</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"><a class="line" href="classspell.html#adb7b86747726cfee704cd4a91009b93c"> 1675</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#adb7b86747726cfee704cd4a91009b93c">spell::casting_exp</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="comment">// the amount of xp you would get with no modifiers</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> base_casting_xp = 75;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( guy.<a class="code" href="classCharacter.html#aaef69a97be3cf8ddca64a0174467a86c">adjust_for_focus</a>( base_casting_xp * <a class="code" href="classspell.html#ad7a99f3d7def292a3e9af0b869e51103">exp_modifier</a>( guy ) ) );</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;}</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"><a class="line" href="classspell.html#af5435ef2b2d958b64074ba3846dd96c4"> 1683</a></span>&#160;std::string <a class="code" href="classspell.html#af5435ef2b2d958b64074ba3846dd96c4">spell::enumerate_targets</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    std::vector&lt;std::string&gt; all_valid_targets;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="keywordtype">int</span> last_target = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a6a406aeb26461172ad7d4e04543dcc48">spell_target::num_spell_targets</a> );</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; last_target; ++i ) {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7">spell_target</a> t = <span class="keyword">static_cast&lt;</span><a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7">spell_target</a><span class="keyword">&gt;</span>( i );</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( t ) &amp;&amp; t != <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a334c4a4c42fdb79d7ebc3e73b517e6f8">spell_target::none</a> ) {</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;            all_valid_targets.emplace_back( <a class="code" href="magic_8cpp.html#ad62eb3216b3dd4152ccd605b3803b5aa">target_to_string</a>( t ) );</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keywordflow">if</span>( all_valid_targets.size() == 1 ) {</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <span class="keywordflow">return</span> all_valid_targets[0];</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    std::string <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="comment">// TODO: if only we had a function to enumerate strings and concatenate them...</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">auto</span> iter = all_valid_targets.begin(); iter != all_valid_targets.end(); iter++ ) {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keywordflow">if</span>( iter + 1 == all_valid_targets.end() ) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;%s and %s&quot;</span> ), <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>, *iter );</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( iter == all_valid_targets.begin() ) {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = *iter;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;%s, %s&quot;</span> ), <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>, *iter );</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        }</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;}</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"><a class="line" href="classspell.html#a3a661a14d3c40f8cbd2bd727e7b9f712"> 1710</a></span>&#160;std::string <a class="code" href="classspell.html#a3a661a14d3c40f8cbd2bd727e7b9f712">spell::list_targeted_monster_names</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af64d6acee71a4ba9f6a51459fddb9953">targeted_monster_ids</a>.empty() ) {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    std::vector&lt;std::string&gt; all_valid_monster_names;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">mtype_id</a> &amp;mon_id : <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#af64d6acee71a4ba9f6a51459fddb9953">targeted_monster_ids</a> ) {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        all_valid_monster_names.emplace_back( mon_id-&gt;<a class="code" href="structmtype.html#a9a8f4ead67d1836e3f4db624533af5aa">nname</a>() );</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">//remove repeat names</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    all_valid_monster_names.erase( std::unique( all_valid_monster_names.begin(),</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                                   all_valid_monster_names.end() ), all_valid_monster_names.end() );</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    std::string <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = <a class="code" href="output_8h.html#a4be67498ee67b5186fcae5cf706f7512">enumerate_as_string</a>( all_valid_monster_names );</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;}</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"><a class="line" href="classspell.html#ad25f9b130e010a30b39d8996f7ef92e4"> 1726</a></span>&#160;std::string <a class="code" href="classspell.html#ad25f9b130e010a30b39d8996f7ef92e4">spell::list_targeted_species_names</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a60c88145cf9b37dfe7b141b143095246">targeted_species_ids</a>.empty() ) {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    }</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    std::vector&lt;std::string&gt; all_valid_species_names;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">species_id</a> &amp;specie_id : <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a60c88145cf9b37dfe7b141b143095246">targeted_species_ids</a> ) {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        all_valid_species_names.emplace_back( specie_id.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>() );</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">//remove repeat names</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    all_valid_species_names.erase( std::unique( all_valid_species_names.begin(),</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                   all_valid_species_names.end() ), all_valid_species_names.end() );</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    std::string <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = <a class="code" href="output_8h.html#a4be67498ee67b5186fcae5cf706f7512">enumerate_as_string</a>( all_valid_species_names );</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;}</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"><a class="line" href="classspell.html#ae1e6dd5185da5ec685fabeced2a8b73b"> 1742</a></span>&#160;std::string <a class="code" href="classspell.html#ae1e6dd5185da5ec685fabeced2a8b73b">spell::list_ignored_species_names</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a48f952d3f551b2cab4fdb46087613c48">ignored_species_ids</a>.empty() ) {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    }</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    std::vector&lt;std::string&gt; all_valid_species_names;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">species_id</a> &amp;<a class="code" href="classstring__id.html">species_id</a> : <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a48f952d3f551b2cab4fdb46087613c48">ignored_species_ids</a> ) {</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        all_valid_species_names.emplace_back( <a class="code" href="classstring__id.html">species_id</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>() );</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">//remove repeat names</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    all_valid_species_names.erase( std::unique( all_valid_species_names.begin(),</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                                   all_valid_species_names.end() ), all_valid_species_names.end() );</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    std::string <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = <a class="code" href="output_8h.html#a4be67498ee67b5186fcae5cf706f7512">enumerate_as_string</a>( all_valid_species_names );</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;}</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"><a class="line" href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b"> 1758</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classstring__id.html">damage_type_id</a> &amp;<a class="code" href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b">spell::dmg_type</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a7e9db1d8b823fa853544a91327332eee">dmg_type</a>;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;}</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160; </div>
<div class="line"><a name="l01763"></a><span class="lineno"><a class="line" href="classspell.html#ae1585ff21871ebf0e2274b4e98582360"> 1763</a></span>&#160;<a class="code" href="structdamage__instance.html">damage_instance</a> <a class="code" href="classspell.html#ae1585ff21871ebf0e2274b4e98582360">spell::get_damage_instance</a>( <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <a class="code" href="structdamage__instance.html">damage_instance</a> dmg;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    dmg.<a class="code" href="structdamage__instance.html#a9eff5065ef6631935e95d061ca756ae4">add_damage</a>( <a class="code" href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b">dmg_type</a>(), <a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( caster ) );</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordflow">return</span> dmg;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;}</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"><a class="line" href="classspell.html#a49cd3d61f5381025968b3f5b5109aa3b"> 1770</a></span>&#160;<a class="code" href="structdealt__damage__instance.html">dealt_damage_instance</a> <a class="code" href="classspell.html#a49cd3d61f5381025968b3f5b5109aa3b">spell::get_dealt_damage_instance</a>( <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <a class="code" href="structdealt__damage__instance.html">dealt_damage_instance</a> dmg;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    dmg.<a class="code" href="structdealt__damage__instance.html#a215bb5b13d9c221bbda09d88f8b9cdae">set_damage</a>( <a class="code" href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b">dmg_type</a>(), <a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( caster ) );</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keywordflow">return</span> dmg;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;}</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"><a class="line" href="classspell.html#a19e44ba50463fee4395980d76c6e6bb6"> 1777</a></span>&#160;<a class="code" href="structdealt__projectile__attack.html">dealt_projectile_attack</a> <a class="code" href="classspell.html#a19e44ba50463fee4395980d76c6e6bb6">spell::get_projectile_attack</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target,</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        <a class="code" href="classCreature.html">Creature</a> &amp;hit_critter, <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <a class="code" href="structprojectile.html">projectile</a> bolt;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    bolt.<a class="code" href="structprojectile.html#aa2af53bce63feecb719ef1edba54689e">speed</a> = 10000;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    bolt.<a class="code" href="structprojectile.html#a82d8f657f8cfc4e180c15bfab8ca8a6e">impact</a> = <a class="code" href="classspell.html#ae1585ff21871ebf0e2274b4e98582360">get_damage_instance</a>( caster );</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    bolt.<a class="code" href="structprojectile.html#a4536010a51aee3302d749f2eb4dcaf35">proj_effects</a>.emplace( <span class="stringliteral">&quot;MAGIC&quot;</span> );</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <a class="code" href="structdealt__projectile__attack.html">dealt_projectile_attack</a> atk;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    atk.<a class="code" href="structdealt__projectile__attack.html#a7dd960a5108456f89dc1f8ef369a1096">end_point</a> = target;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    atk.<a class="code" href="structdealt__projectile__attack.html#a466f327979e41691bc19c91e622078b6">hit_critter</a> = &amp;hit_critter;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    atk.<a class="code" href="structdealt__projectile__attack.html#a93f05a2866e4dbc8c4d432a67daf8ab6">proj</a> = bolt;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    atk.<a class="code" href="structdealt__projectile__attack.html#ab874a1233da5daa95ff296cdb1ee1849">missed_by</a> = 0.0;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160; </div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordflow">return</span> atk;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;}</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"><a class="line" href="classspell.html#ab6f8776ac707639708392c616d93fa58"> 1794</a></span>&#160;std::string <a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">spell::effect_data</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ab1b1ec17f8a72265b3de8de7182b42e6">effect_str</a>;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;}</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; </div>
<div class="line"><a name="l01799"></a><span class="lineno"><a class="line" href="classspell.html#a1b42ae28bea14653bbc623f2f3c8a2cb"> 1799</a></span>&#160;<a class="code" href="classstring__id.html">vproto_id</a> <a class="code" href="classspell.html#a1b42ae28bea14653bbc623f2f3c8a2cb">spell::summon_vehicle_id</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="type__id_8h.html#a64efc8ab51816a59711440d464136eda">vproto_id</a>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#ab1b1ec17f8a72265b3de8de7182b42e6">effect_str</a> );</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;}</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; </div>
<div class="line"><a name="l01804"></a><span class="lineno"><a class="line" href="classspell.html#af12e38d6e97fefcf10174cd91df53bd4"> 1804</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classspell.html#af12e38d6e97fefcf10174cd91df53bd4">spell::heal</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target, <a class="code" href="classCreature.html">Creature</a> &amp;caster )<span class="keyword"> const</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <a class="code" href="classmonster.html">monster</a> *<span class="keyword">const</span> mon = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classmonster.html">monster</a>&gt;( target );</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordflow">if</span>( mon ) {</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="keywordflow">return</span> mon-&gt;<a class="code" href="classmonster.html#af7763c0da8025aea231a29272f25d5fc">heal</a>( -<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( caster ) );</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    }</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <a class="code" href="classCharacter.html">Character</a> *<span class="keyword">const</span> p = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classCharacter.html">Character</a>&gt;( target );</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordflow">if</span>( p ) {</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        p-&gt;<a class="code" href="classCharacter.html#ae7a558a2455f552673b825e3ad2e0fd4">healall</a>( -<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( caster ) );</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( caster );</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;}</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"><a class="line" href="classspell.html#a381100da3ed24e4029ae1c34882dcfe7"> 1819</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a381100da3ed24e4029ae1c34882dcfe7">spell::cast_spell_effect</a>( <a class="code" href="classCreature.html">Creature</a> &amp;source, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target )<span class="keyword"> const</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <a class="code" href="classCharacter.html">Character</a> *caster = source.<a class="code" href="classCreature.html#a55d12f92d62a7c89c44b466d7e7cb00d">as_character</a>();</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keywordflow">if</span>( caster ) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <a class="code" href="classcharacter__id.html">character_id</a> c_id = caster-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>();</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="comment">// send casting to the event bus</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a91ebffe1a2751b920ac93e8f5549a4c2">event_type::character_casts_spell</a>&gt;( c_id, this-&gt;<a class="code" href="classspell.html#a7d44bdaf4c9faff438e6b30973d68615">id</a>(), this-&gt;<a class="code" href="classspell.html#a388a3e18bba1c58aa9c00dc53bc97aef">spell_class</a>(),</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                this-&gt;<a class="code" href="classspell.html#a0c002dde68c8222bed0a619b28e0b91a">get_difficulty</a>( source ), this-&gt;<a class="code" href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924">energy_cost</a>( *caster ), this-&gt;<a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a>( *caster ),</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                this-&gt;<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( source ) );</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    }</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a2f4c3da42b12fcb9160f5110214db5e7">effect</a>( *<span class="keyword">this</span>, source, target );</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;}</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"><a class="line" href="classspell.html#a0752e28bd2c982a681521d2012eec12d"> 1833</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a0752e28bd2c982a681521d2012eec12d">spell::cast_all_effects</a>( <a class="code" href="classCreature.html">Creature</a> &amp;source, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target )<span class="keyword"> const</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac1324f642ae16e50278d5fad88240254">spell_flag::WONDER</a> ) ) {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> iter = <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#addae5132e10abe659f19d1575547d185">additional_spells</a>.begin();</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> num_spells = <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( <a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( source ) ); num_spells &gt; 0; num_spells-- ) {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#addae5132e10abe659f19d1575547d185">additional_spells</a>.empty() ) {</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: %s has WONDER flag but no spells to choose from!&quot;</span>, <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a>.<a class="code" href="classstring__id.html#a2c0e3a434bcb9e3c353b337053ff22d8">c_str</a>() );</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;            }</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> rand_spell = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#addae5132e10abe659f19d1575547d185">additional_spells</a>.size() - 1 );</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            <a class="code" href="classspell.html">spell</a> sp = ( iter + rand_spell )-&gt;get_spell( source, <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() );</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> _self = ( iter + rand_spell )-&gt;<span class="keyword">self</span>;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            <span class="comment">// This spell flag makes it so the message of the spell that&#39;s cast using this spell will be sent.</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            <span class="comment">// if a message is added to the casting spell, it will be sent as well.</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            source.<a class="code" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( sp.<a class="code" href="classspell.html#ac4826c2795f1db1547ef57ccd408f8cf">message</a>() );</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba95aa3650620c7879b3276744d8284b0d">spell_flag::RANDOM_TARGET</a> ) ) {</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                <span class="keywordflow">if</span>( <span class="keyword">const</span> std::optional&lt;tripoint&gt; new_target = sp.<a class="code" href="classspell.html#a7a62c6ffd858fa8baeeb225aba2f06ac">random_valid_target</a>( source,</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                        _self ? source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() : target ) ) {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                    sp.<a class="code" href="classspell.html#a0752e28bd2c982a681521d2012eec12d">cast_all_effects</a>( source, *new_target );</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                <span class="keywordflow">if</span>( _self ) {</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                    sp.<a class="code" href="classspell.html#a0752e28bd2c982a681521d2012eec12d">cast_all_effects</a>( source, source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                    sp.<a class="code" href="classspell.html#a0752e28bd2c982a681521d2012eec12d">cast_all_effects</a>( source, target );</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                }</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197baeda01abd967f7e1e749ce88aab441d33">spell_flag::EXTRA_EFFECTS_FIRST</a> ) ) {</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <a class="code" href="classspell.html#a78b43a6e49d2fac622fe8a98ccbb9989">cast_extra_spell_effects</a>( source, target );</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            <a class="code" href="classspell.html#a381100da3ed24e4029ae1c34882dcfe7">cast_spell_effect</a>( source, target );</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            <a class="code" href="classspell.html#a381100da3ed24e4029ae1c34882dcfe7">cast_spell_effect</a>( source, target );</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;            <a class="code" href="classspell.html#a78b43a6e49d2fac622fe8a98ccbb9989">cast_extra_spell_effects</a>( source, target );</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    }</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;}</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160; </div>
<div class="line"><a name="l01874"></a><span class="lineno"><a class="line" href="classspell.html#a78b43a6e49d2fac622fe8a98ccbb9989"> 1874</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell.html#a78b43a6e49d2fac622fe8a98ccbb9989">spell::cast_extra_spell_effects</a>( <a class="code" href="classCreature.html">Creature</a> &amp;source, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target )<span class="keyword"> const</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structfake__spell.html">fake_spell</a> &amp;extra_spell : <a class="code" href="classspell.html#acacc930abceced994590480b878ccdd8">type</a>-&gt;<a class="code" href="classspell__type.html#addae5132e10abe659f19d1575547d185">additional_spells</a> ) {</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <a class="code" href="classspell.html">spell</a> sp = extra_spell.<a class="code" href="structfake__spell.html#ad4f9daba773dc6b7b96dcc256e9213ad">get_spell</a>( source, <a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>() );</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba95aa3650620c7879b3276744d8284b0d">spell_flag::RANDOM_TARGET</a> ) ) {</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            <span class="keywordflow">if</span>( <span class="keyword">const</span> std::optional&lt;tripoint&gt; new_target = sp.<a class="code" href="classspell.html#a7a62c6ffd858fa8baeeb225aba2f06ac">random_valid_target</a>( source,</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                    extra_spell.<a class="code" href="structfake__spell.html#afa2a4b38d223f38100fb8148d92fca2a">self</a> ? source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() : target ) ) {</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                sp.<a class="code" href="classspell.html#a0752e28bd2c982a681521d2012eec12d">cast_all_effects</a>( source, *new_target );</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            }</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            <span class="keywordflow">if</span>( extra_spell.<a class="code" href="structfake__spell.html#afa2a4b38d223f38100fb8148d92fca2a">self</a> ) {</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                sp.<a class="code" href="classspell.html#a0752e28bd2c982a681521d2012eec12d">cast_all_effects</a>( source, source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                sp.<a class="code" href="classspell.html#a0752e28bd2c982a681521d2012eec12d">cast_all_effects</a>( source, target );</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            }</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        }</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    }</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;}</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"><a class="line" href="classspell.html#a7a62c6ffd858fa8baeeb225aba2f06ac"> 1893</a></span>&#160;std::optional&lt;tripoint&gt; <a class="code" href="classspell.html#a7a62c6ffd858fa8baeeb225aba2f06ac">spell::random_valid_target</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster,</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;caster_pos )<span class="keyword"> const</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> ignore_ground = <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba501200349c2d922a2e4c5eb5d6cde0c5">spell_flag::RANDOM_CRITTER</a> );</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    std::set&lt;tripoint&gt; valid_area;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <a class="code" href="structspell__effect_1_1override__parameters.html">spell_effect::override_parameters</a> blast_params( *<span class="keyword">this</span>, caster );</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="comment">// we want to pick a random target within range, not aoe</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    blast_params.<a class="code" href="structspell__effect_1_1override__parameters.html#acdd82cf7a573dcb57eedbcc051c5388b">aoe_radius</a> = <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a>( caster );</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target : <a class="code" href="namespacespell__effect.html#a9e71032270fa0320ba243005a7b50a5f">spell_effect::spell_effect_blast</a>(</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;             blast_params, caster_pos, caster_pos ) ) {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        <span class="keywordflow">if</span>( target != caster_pos &amp;&amp; <a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( caster, target ) &amp;&amp;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            ( !ignore_ground || creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classCreature.html">Creature</a>&gt;( target ) ) ) {</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;            valid_area.emplace( target );</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    }</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">if</span>( valid_area.empty() ) {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rng_8h.html#a12244355ee77108f1b08618e9962e4d1">random_entry</a>( valid_area );</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;}</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160; </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">// player</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"><a class="line" href="classknown__magic.html#a2e9d576a3710bfe2534471e630df5bb7"> 1917</a></span>&#160;<a class="code" href="classknown__magic.html#a2e9d576a3710bfe2534471e630df5bb7">known_magic::known_magic</a>()</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;{</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <a class="code" href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">mana_base</a> = 1000;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> = <a class="code" href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">mana_base</a>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;}</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"><a class="line" href="classknown__magic.html#af8acd3edf4541649cd1b1ee21124dd0a"> 1923</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#af8acd3edf4541649cd1b1ee21124dd0a">known_magic::serialize</a>( <a class="code" href="classJsonOut.html">JsonOut</a> &amp;json )<span class="keyword"> const</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    json.<a class="code" href="classJsonOut.html#a4756f9a569adbfc60de127f7c335d82f">start_object</a>();</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;mana&quot;</span>, <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> );</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; </div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;spellbook&quot;</span> );</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    json.<a class="code" href="classJsonOut.html#a4550e2036b904c4d4a90e440dd41c684">start_array</a>();</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;pair : <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a> ) {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        json.<a class="code" href="classJsonOut.html#a4756f9a569adbfc60de127f7c335d82f">start_object</a>();</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;id&quot;</span>, pair.second.id() );</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;xp&quot;</span>, pair.second.xp() );</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        json.<a class="code" href="classJsonOut.html#aa38d37840ed6ba168b78a43570e98681">end_object</a>();</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    }</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    json.<a class="code" href="classJsonOut.html#a44cdd853d4c6913b37caa9f0131eeff2">end_array</a>();</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;invlets&quot;</span>, <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a> );</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;favorites&quot;</span>, <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a> );</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    json.<a class="code" href="classJsonOut.html#aa38d37840ed6ba168b78a43570e98681">end_object</a>();</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;}</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; </div>
<div class="line"><a name="l01944"></a><span class="lineno"><a class="line" href="classknown__magic.html#a9438df7eceda90e40f98f3d6a1f38147"> 1944</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a9438df7eceda90e40f98f3d6a1f38147">known_magic::deserialize</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;data )</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;{</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    data.<a class="code" href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">read</a>( <span class="stringliteral">&quot;mana&quot;</span>, <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> );</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classJsonObject.html">JsonObject</a> jo : data.<a class="code" href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">get_array</a>( <span class="stringliteral">&quot;spellbook&quot;</span> ) ) {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        std::string <span class="keywordtype">id</span> = jo.get_string( <span class="stringliteral">&quot;id&quot;</span> );</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <a class="code" href="classstring__id.html">spell_id</a> sp = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="keywordtype">int</span> xp = jo.get_int( <span class="stringliteral">&quot;xp&quot;</span> );</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>[sp].set_exp( xp );</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.emplace( sp, <a class="code" href="classspell.html">spell</a>( sp, xp ) );</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        }</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    data.<a class="code" href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">read</a>( <span class="stringliteral">&quot;invlets&quot;</span>, <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a> );</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    data.<a class="code" href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">read</a>( <span class="stringliteral">&quot;favorites&quot;</span>, <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a> );</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;}</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"><a class="line" href="classknown__magic.html#af808c41802489957df2f33a5e3e381c7"> 1962</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">known_magic::knows_spell</a>( <span class="keyword">const</span> std::string &amp;sp )<span class="keyword"> const</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( sp ) );</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;}</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; </div>
<div class="line"><a name="l01967"></a><span class="lineno"><a class="line" href="classknown__magic.html#a8921c5cb6ecfcb2ad0f76a54f516070b"> 1967</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">known_magic::knows_spell</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )<span class="keyword"> const</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.count( sp ) == 1;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;}</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; </div>
<div class="line"><a name="l01972"></a><span class="lineno"><a class="line" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e"> 1972</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">known_magic::knows_spell</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">return</span> !<a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.empty();</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;}</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"><a class="line" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa"> 1977</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">known_magic::learn_spell</a>( <span class="keyword">const</span> std::string &amp;sp, <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keywordtype">bool</span> <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> )</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;{</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <a class="code" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">learn_spell</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( sp ), guy, <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> );</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;}</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; </div>
<div class="line"><a name="l01982"></a><span class="lineno"><a class="line" href="classknown__magic.html#aeab7b087a69b633b0ae61509ca5e0d48"> 1982</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">known_magic::learn_spell</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp, <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keywordtype">bool</span> <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> )</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;{</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <a class="code" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">learn_spell</a>( &amp;sp.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>(), guy, <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> );</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;}</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160; </div>
<div class="line"><a name="l01987"></a><span class="lineno"><a class="line" href="classknown__magic.html#a7dc8309c014c9d2698826bdb8883cd39"> 1987</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">known_magic::learn_spell</a>( <span class="keyword">const</span> <a class="code" href="classspell__type.html">spell_type</a> *sp, <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keywordtype">bool</span> <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> )</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;{</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="keywordflow">if</span>( !sp-&gt;<a class="code" href="classspell__type.html#ab9b1f0c5e1c6127b4bb37b371ff09e92">is_valid</a>() ) {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Tried to learn invalid spell&quot;</span> );</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keywordflow">if</span>( guy.<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;knows_spell( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> ) ) {</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="comment">// you already know the spell</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <a class="code" href="classspell.html">spell</a> temp_spell( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="keywordflow">if</span>( !temp_spell.<a class="code" href="classspell.html#a0f7316c4f276b359eb3c4d5fb418d7a3">is_valid</a>() ) {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Tried to learn invalid spell&quot;</span> );</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> &amp;&amp; sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> != <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ) {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classknown__magic.html#ad4bdf834ec136179f6755e4566435b61">can_learn_spell</a>( guy, sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> ) &amp;&amp; !guy.<a class="code" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> ) ) {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            std::string trait_cancel;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">trait_id</a> &amp;<a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a> : sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a> ) {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a> == sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.back() &amp;&amp;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                    sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.back() != sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.front() ) {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                    trait_cancel = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;%s and %s&quot;</span> ), trait_cancel, <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a>-&gt;name() );</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a> == sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.front() ) {</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                    trait_cancel = <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a>-&gt;name();</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                    <span class="keywordflow">if</span>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.size() == 1 ) {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                        trait_cancel = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, trait_cancel, <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a>-&gt;desc() );</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                    }</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                    trait_cancel = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;%s, %s&quot;</span> ), trait_cancel, <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a>-&gt;name() );</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                }</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a> == sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.back() ) {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                    trait_cancel += <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                }</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            }</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            <span class="keywordflow">if</span>( !guy.<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() || <a class="code" href="output_8cpp.html#ab62599a77867b8f416669b92f60f4900">query_yn</a>(</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                    <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Learning this spell will make you a\n\n%s: %s\n\nand lock you out of\n\n%s\n\nContinue?&quot;</span> ),</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                    sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a2805339d7f40d83fbfb0846cca44761c">name</a>(), sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a67f764c2a0612a360980e59a5e4fef21">desc</a>(), trait_cancel ) ) {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                guy.<a class="code" href="classCharacter.html#a9256aa3e6577c96e4a19eb23d8810ca6">set_mutation</a>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                guy.<a class="code" href="classCharacter.html#a4609d68fa1977aefed931d2a51afa52b">on_mutation_gain</a>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                guy.<a class="code" href="classCharacter.html#af0503012f1ff927cbb5ad126e39cb103">add_msg_if_player</a>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmutation__branch.html#a67f764c2a0612a360980e59a5e4fef21">desc</a>() );</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            }</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        }</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> || <a class="code" href="classknown__magic.html#ad4bdf834ec136179f6755e4566435b61">can_learn_spell</a>( guy, sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> ) ) {</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.emplace( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a>, temp_spell );</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">event_type::character_learns_spell</a>&gt;( guy.<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        guy.<a class="code" href="classCharacter.html#ac81e06f5fbbb42c673f235a6f37d9d4b">add_msg_player_or_npc</a>( <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10">m_good</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;You learned %s!&quot;</span> ), <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;&lt;npcname&gt; learned %s!&quot;</span> ), sp-&gt;<a class="code" href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">name</a> );</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        guy.<a class="code" href="classCharacter.html#ac81e06f5fbbb42c673f235a6f37d9d4b">add_msg_player_or_npc</a>( <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;You can&#39;t learn this spell.&quot;</span> ),</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                                   <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;&lt;npcname&gt; can&#39;t learn this spell.&quot;</span> ) );</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;}</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; </div>
<div class="line"><a name="l02042"></a><span class="lineno"><a class="line" href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6"> 2042</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6">known_magic::forget_spell</a>( <span class="keyword">const</span> std::string &amp;sp )</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;{</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <a class="code" href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6">forget_spell</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( sp ) );</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;}</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"><a class="line" href="classknown__magic.html#ad23426154495b1a395dc6309ce47c6cc"> 2047</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6">known_magic::forget_spell</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;{</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Can&#39;t forget a spell you don&#39;t know!&quot;</span> );</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;All knowledge of %s leaves you.&quot;</span> ), sp-&gt;<a class="code" href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">name</a> );</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="comment">// TODO: add parameter for owner of known_magic for this function</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">event_type::character_forgets_spell</a>&gt;( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.erase( sp );</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;}</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; </div>
<div class="line"><a name="l02059"></a><span class="lineno"><a class="line" href="classknown__magic.html#a800de0f2bcb32e309629216f85456e31"> 2059</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a800de0f2bcb32e309629216f85456e31">known_magic::set_spell_level</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp, <span class="keywordtype">int</span> new_level, <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> *guy )</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;{</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <a class="code" href="classspell.html">spell</a> temp_spell( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        <span class="keywordflow">if</span>( new_level &gt;= 0 ) {</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            temp_spell.<a class="code" href="classspell.html#a21f5450a0454bf54ca779f62fada69b6">set_level</a>( *guy, new_level );</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.emplace( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a>, <a class="code" href="classspell.html">spell</a>( temp_spell ) );</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">event_type::character_learns_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="keywordflow">if</span>( new_level &gt;= 0 ) {</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;            <a class="code" href="classspell.html">spell</a> &amp;temp_sp = <a class="code" href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">get_spell</a>( sp );</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            temp_sp.<a class="code" href="classspell.html#a21f5450a0454bf54ca779f62fada69b6">set_level</a>( *guy, new_level );</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">event_type::character_forgets_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.erase( sp );</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        }</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;}</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160; </div>
<div class="line"><a name="l02079"></a><span class="lineno"><a class="line" href="classknown__magic.html#a90fcfdbfe3d0dd04780ff2d8e672a1ef"> 2079</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a90fcfdbfe3d0dd04780ff2d8e672a1ef">known_magic::set_spell_exp</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp, <span class="keywordtype">int</span> new_exp, <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> *guy )</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;{</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <a class="code" href="classspell.html">spell</a> temp_spell( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        <span class="keywordflow">if</span>( new_exp &gt;= 0 ) {</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            temp_spell.<a class="code" href="classspell.html#add2c742d2996e6c81ab5b70b081544d9">set_exp</a>( new_exp );</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.emplace( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a>, <a class="code" href="classspell.html">spell</a>( temp_spell ) );</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">event_type::character_learns_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        }</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keywordflow">if</span>( new_exp &gt;= 0 ) {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            <a class="code" href="classspell.html">spell</a> &amp;temp_sp = <a class="code" href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">get_spell</a>( sp );</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            <span class="keywordtype">int</span> old_level = temp_sp.<a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>();</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            temp_sp.<a class="code" href="classspell.html#add2c742d2996e6c81ab5b70b081544d9">set_exp</a>( new_exp );</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            <span class="keywordflow">if</span>( guy-&gt;<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() &amp;&amp; old_level != temp_sp.<a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>() ) {</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a15d9350620fdb06df8ad3d5410d8d54f">event_type::player_levels_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a>, temp_sp.<a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>(),</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                        sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">event_type::character_forgets_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.erase( sp );</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        }</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    }</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;}</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; </div>
<div class="line"><a name="l02104"></a><span class="lineno"><a class="line" href="classknown__magic.html#ad4bdf834ec136179f6755e4566435b61"> 2104</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classknown__magic.html#ad4bdf834ec136179f6755e4566435b61">known_magic::can_learn_spell</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )<span class="keyword"> const</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keyword">const</span> <a class="code" href="classspell__type.html">spell_type</a> &amp;sp_t = sp.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>();</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="keywordflow">if</span>( sp_t.<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ) {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="keywordflow">if</span>( sp_t.<a class="code" href="classspell__type.html#a74d93ff32c5d02d21548e7164e39b7f1">spell_tags</a>[<a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba32c2090ece9876c90fa493fc4054151a">spell_flag::MUST_HAVE_CLASS_TO_LEARN</a>] ) {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( sp_t.<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="keywordflow">return</span> !guy.<a class="code" href="classCharacter.html#a809f85bef6731c16373600ad9f97dad7">has_opposite_trait</a>( sp_t.<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    }</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;}</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"><a class="line" href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea"> 2117</a></span>&#160;<a class="code" href="classspell.html">spell</a> &amp;<a class="code" href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">known_magic::get_spell</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;{</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: Tried to get unknown spell&quot;</span> );</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    }</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <a class="code" href="classspell.html">spell</a> &amp;temp_spell = <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>[ sp ];</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="keywordflow">return</span> temp_spell;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;}</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; </div>
<div class="line"><a name="l02126"></a><span class="lineno"><a class="line" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab"> 2126</a></span>&#160;std::vector&lt;spell *&gt; <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">known_magic::get_spells</a>()</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;{</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    std::vector&lt;spell *&gt; <a class="code" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">spells</a>;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <a class="code" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">spells</a>.reserve( <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.size() );</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;spell_pair : <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a> ) {</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        <a class="code" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">spells</a>.emplace_back( &amp;spell_pair.second );</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    }</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">spells</a>;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;}</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160; </div>
<div class="line"><a name="l02136"></a><span class="lineno"><a class="line" href="classknown__magic.html#afe4bbf2ea0bcb6c32349b7a54640b6c5"> 2136</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classknown__magic.html#afe4bbf2ea0bcb6c32349b7a54640b6c5">known_magic::available_mana</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a>;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;}</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"><a class="line" href="classknown__magic.html#aeed71b588441f7580d8f3bf9d27a7eb9"> 2141</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#aeed71b588441f7580d8f3bf9d27a7eb9">known_magic::set_mana</a>( <span class="keywordtype">int</span> new_mana )</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;{</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> = new_mana;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;}</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; </div>
<div class="line"><a name="l02146"></a><span class="lineno"><a class="line" href="classknown__magic.html#ae44e12a998ae53c5d487828d83165168"> 2146</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#ae44e12a998ae53c5d487828d83165168">known_magic::mod_mana</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keywordtype">int</span> add_mana )</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;{</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <a class="code" href="classknown__magic.html#aeed71b588441f7580d8f3bf9d27a7eb9">set_mana</a>( <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> + add_mana, 0, <a class="code" href="classknown__magic.html#af1d54e77049ce1b9ed9d20a559ae0a38">max_mana</a>( guy ) ) );</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;}</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160; </div>
<div class="line"><a name="l02151"></a><span class="lineno"><a class="line" href="classknown__magic.html#af1d54e77049ce1b9ed9d20a559ae0a38"> 2151</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classknown__magic.html#af1d54e77049ce1b9ed9d20a559ae0a38">known_magic::max_mana</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> int_bonus = ( ( 0.2f + guy.<a class="code" href="classCharacter.html#a588d5cc1d729490552fe03b006685ae5">get_int</a>() * 0.1f ) - 1.0f ) * <a class="code" href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">mana_base</a>;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="keywordtype">int</span> penalty_calc = <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( std::max&lt;int64_t&gt;( 0,</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                                   <a class="code" href="namespaceunits.html#a7f3948de70e78d68af74fb3d119cf176">units::to_kilojoule</a>( guy.<a class="code" href="classCharacter.html#add22510ff2fa20a662868b4dd86e030e">get_power_level</a>() ) ) );</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> bionic_penalty = guy.<a class="code" href="classCharacter.html#add870e576ff59aa6943af286576219e9">enchantment_cache</a>-&gt;modify_value(</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                                   <a class="code" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a6d2912cc5d535f00c9c7405dcd9f25d3">enchant_vals::mod::BIONIC_MANA_PENALTY</a>, penalty_calc );</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> unaugmented_mana = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0.0f,</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                                   ( <a class="code" href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">mana_base</a> + int_bonus ) - bionic_penalty );</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#a18fed39d4de0f6d75af204da88833098">calculate_by_enchantment</a>( unaugmented_mana, <a class="code" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998ab808652fb6f0bf7ede1ba2cdaf1f8b84">enchant_vals::mod::MAX_MANA</a>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;}</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"><a class="line" href="classknown__magic.html#a3f18d965190b820f8b2b91170a899580"> 2165</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a3f18d965190b820f8b2b91170a899580">known_magic::update_mana</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keywordtype">float</span> turns )</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;{</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="comment">// mana should replenish in 8 hours.</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> full_replenish = to_turns&lt;double&gt;( 8_hours );</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ratio = turns / full_replenish;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <a class="code" href="classknown__magic.html#ae44e12a998ae53c5d487828d83165168">mod_mana</a>( guy, <a class="code" href="math__parser__func_8h.html#a204ca52ef1b97d079c45e1cb6407f73b">std::floor</a>( ratio * guy.<a class="code" href="classCharacter.html#a18fed39d4de0f6d75af204da88833098">calculate_by_enchantment</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( <a class="code" href="classknown__magic.html#af1d54e77049ce1b9ed9d20a559ae0a38">max_mana</a>(</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                                   guy ) ), <a class="code" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a886de14f24b5a2f60b4e4a88d0a95834">enchant_vals::mod::REGEN_MANA</a> ) ) );</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;}</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; </div>
<div class="line"><a name="l02174"></a><span class="lineno"><a class="line" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0"> 2174</a></span>&#160;std::vector&lt;spell_id&gt; <a class="code" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">known_magic::spells</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    std::vector&lt;spell_id&gt; spell_ids;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    spell_ids.reserve( <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.size() );</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const spell_id, spell&gt; &amp;pair : <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a> ) {</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        spell_ids.emplace_back( pair.first );</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordflow">return</span> spell_ids;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;}</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160; </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">// does the Character have enough energy (of the type of the spell) to cast the spell?</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"><a class="line" href="classknown__magic.html#aba521f548900ab333a4b13884baa2c6d"> 2185</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classknown__magic.html#aba521f548900ab333a4b13884baa2c6d">known_magic::has_enough_energy</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> &amp;sp )<span class="keyword"> const</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keywordtype">int</span> cost = sp.<a class="code" href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924">energy_cost</a>( guy );</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keywordflow">switch</span>( sp.<a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() ) {</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f">magic_energy_type::mana</a>:</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#afe4bbf2ea0bcb6c32349b7a54640b6c5">available_mana</a>() &gt;= cost;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d">magic_energy_type::bionic</a>:</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#add22510ff2fa20a662868b4dd86e030e">get_power_level</a>() &gt;= <a class="code" href="namespaceunits.html#a9a9f862b2cd8fb3133a67b8bf927b017">units::from_kilojoule</a>( <span class="keyword">static_cast&lt;</span>std::int64_t<span class="keyword">&gt;</span>( cost ) );</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">magic_energy_type::stamina</a>:</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#a0ffe14df559cee6e9b5d02f5b214d009">get_stamina</a>() &gt;= cost;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a>:</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const bodypart_str_id, bodypart&gt; &amp;elem : guy.<a class="code" href="classCreature.html#ac4dbde454c86b3296f53681c60612974">get_body</a>() ) {</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                <span class="keywordflow">if</span>( elem.second.get_hp_cur() &gt; cost ) {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            }</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8">magic_energy_type::none</a>:</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    }</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;}</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"><a class="line" href="classknown__magic.html#a0373cb48f63ed992b40057b8e30d7e7c"> 2209</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a0373cb48f63ed992b40057b8e30d7e7c">known_magic::clear_opens_spellbook_data</a>()</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;{</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <a class="code" href="classknown__magic.html#ad3556aef7b10779c8854c6983c215ac0">caster_level_adjustment</a> = 0;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <a class="code" href="classknown__magic.html#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">caster_level_adjustment_by_spell</a>.clear();</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <a class="code" href="classknown__magic.html#a1dafae5436ced5d37e293d92c1bacd57">caster_level_adjustment_by_school</a>.clear();</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classspell.html">spell</a> *sp : <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>() ) {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        sp-&gt;clear_temp_adjustments();</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;}</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160; </div>
<div class="line"><a name="l02219"></a><span class="lineno"><a class="line" href="classknown__magic.html#ab9085db0eed27ce45061cdc575ea9b6e"> 2219</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#ab9085db0eed27ce45061cdc575ea9b6e">known_magic::evaluate_opens_spellbook_data</a>()</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;{</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classspell.html">spell</a> *sp : <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>() ) {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="keywordtype">double</span> raw_level_adjust = <a class="code" href="classknown__magic.html#ad3556aef7b10779c8854c6983c215ac0">caster_level_adjustment</a>;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        std::map&lt;trait_id, double&gt;::iterator school_it =</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            <a class="code" href="classknown__magic.html#a1dafae5436ced5d37e293d92c1bacd57">caster_level_adjustment_by_school</a>.find( sp-&gt;spell_class() );</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <span class="keywordflow">if</span>( school_it != <a class="code" href="classknown__magic.html#a1dafae5436ced5d37e293d92c1bacd57">caster_level_adjustment_by_school</a>.end() ) {</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            raw_level_adjust += school_it-&gt;second;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        }</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        std::map&lt;spell_id, double&gt;::iterator spell_it =</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            <a class="code" href="classknown__magic.html#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">caster_level_adjustment_by_spell</a>.find( sp-&gt;id() );</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        <span class="keywordflow">if</span>( spell_it != <a class="code" href="classknown__magic.html#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">caster_level_adjustment_by_spell</a>.end() ) {</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            raw_level_adjust += spell_it-&gt;second;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        }</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        <span class="keywordtype">int</span> final_level = <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( sp-&gt;get_level() + <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( raw_level_adjust ), 0,</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                                 sp-&gt;get_max_level( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() ) );</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        sp-&gt;set_temp_level_adjustment( final_level - sp-&gt;get_level() );</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;}</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160; </div>
<div class="line"><a name="l02239"></a><span class="lineno"><a class="line" href="classknown__magic.html#ad425ea60cd0b564225bddfd3afd7e40c"> 2239</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classknown__magic.html#a3ec46640014cc1ea785a7db001203b37">known_magic::time_to_learn_spell</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keyword">const</span> std::string &amp;str )<span class="keyword"> const</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#a3ec46640014cc1ea785a7db001203b37">time_to_learn_spell</a>( guy, <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( str ) );</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;}</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160; </div>
<div class="line"><a name="l02244"></a><span class="lineno"><a class="line" href="classknown__magic.html#a3ec46640014cc1ea785a7db001203b37"> 2244</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classknown__magic.html#a3ec46640014cc1ea785a7db001203b37">known_magic::time_to_learn_spell</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy, <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )<span class="keyword"> const</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( guy ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> base_time = to_moves&lt;int&gt;( 30_minutes );</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> int_modifier = ( guy.<a class="code" href="classCharacter.html#a588d5cc1d729490552fe03b006685ae5">get_int</a>() - 8.0 ) / 8.0;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> skill_modifier = guy.<a class="code" href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">get_skill_level</a>( sp-&gt;<a class="code" href="classspell__type.html#abd2cfd23c656755b0f887064683d9e13">skill</a> ) / 10.0;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordflow">return</span> base_time * ( 1.0 + sp-&gt;<a class="code" href="classspell__type.html#a960a7f198bd614a7c048405d7d120f61">difficulty</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) / ( 1.0 + int_modifier + skill_modifier ) );</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;}</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160; </div>
<div class="line"><a name="l02253"></a><span class="lineno"><a class="line" href="classknown__magic.html#adb9da4817cfdc19624a8674d4cc16fea"> 2253</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classknown__magic.html#adb9da4817cfdc19624a8674d4cc16fea">known_magic::get_spellname_max_width</a>()</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;{</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keywordtype">int</span> width = 0;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> *sp : <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>() ) {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        width = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( width, <a class="code" href="catacharset_8cpp.html#af20ee33da59ccceb9f4c14005c0bbe80">utf8_width</a>( sp-&gt;name() ) );</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keywordflow">return</span> width;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;}</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"><a class="line" href="classCharacter.html#a47b6d8827b1199e069ec04280c5adafb"> 2262</a></span>&#160;std::vector&lt;spell&gt; <a class="code" href="classCharacter.html#a47b6d8827b1199e069ec04280c5adafb">Character::spells_known_of_class</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">trait_id</a> &amp;spell_class )<span class="keyword"> const</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    std::vector&lt;spell&gt; <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( spell_class ) ) {</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    }</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160; </div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp : <a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;spells() ) {</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        <span class="keywordflow">if</span>( sp-&gt;spell_class == spell_class ) {</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.push_back( <a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;get_spell( sp ) );</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        }</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    }</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;}</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; </div>
<div class="line"><a name="l02279"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a59eae2fd66ff3b9691a4cacfabbd0f3b"> 2279</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="magic_8cpp.html#a59eae2fd66ff3b9691a4cacfabbd0f3b">reflesh_favorite</a>( <a class="code" href="classuilist.html">uilist</a> *menu, std::vector&lt;spell *&gt; known_spells )</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;{</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="structuilist__entry.html">uilist_entry</a> &amp;entry : menu-&gt;<a class="code" href="classuilist.html#af5fc2972d43a795c49a632dbcf58132b">entries</a> ) {</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().magic-&gt;is_favorite( known_spells[entry.<a class="code" href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">retval</a>]-&gt;id() ) ) {</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            entry.<a class="code" href="structuilist__entry.html#aa967deb004ba949adcf9c394af0b74b6">extratxt</a>.<a class="code" href="structmvwzstr.html#a494d0f1cb6eb7a18473507b18a2d161a">left</a> = 0;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            entry.<a class="code" href="structuilist__entry.html#aa967deb004ba949adcf9c394af0b74b6">extratxt</a>.<a class="code" href="structmvwzstr.html#a2cbf4c0eb637d1887e053912de9c1266">txt</a> = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;*&quot;</span> );</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;            entry.<a class="code" href="structuilist__entry.html#aa967deb004ba949adcf9c394af0b74b6">extratxt</a>.<a class="code" href="structmvwzstr.html#a77700416a62b9e1bc93184f19a85ee5e">color</a> = <a class="code" href="color_8h.html#a0d06dc49b9761bbc54607397213728bb">c_white</a>;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            entry.<a class="code" href="structuilist__entry.html#aa967deb004ba949adcf9c394af0b74b6">extratxt</a>.<a class="code" href="structmvwzstr.html#a2cbf4c0eb637d1887e053912de9c1266">txt</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        }</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    }</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;}</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html"> 2292</a></span>&#160;<span class="keyword">class </span><a class="code" href="classspellcasting__callback.html">spellcasting_callback</a> : <span class="keyword">public</span> <a class="code" href="classuilist__callback.html">uilist_callback</a></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;{</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l02295"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#ad3d9c839b2b4c00656c2cbda0e25eb7a"> 2295</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classspellcasting__callback.html#ad3d9c839b2b4c00656c2cbda0e25eb7a">selected_sp</a> = 0;</div>
<div class="line"><a name="l02296"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d"> 2296</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">scroll_pos</a> = 0;</div>
<div class="line"><a name="l02297"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35"> 2297</a></span>&#160;        std::vector&lt;std::string&gt; <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>;</div>
<div class="line"><a name="l02298"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf"> 2298</a></span>&#160;        std::vector&lt;spell *&gt; <a class="code" href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf">known_spells</a>;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classspellcasting__callback.html#a2321cf8b12bc562f402f289bd30bacf9">spell_info_text</a>( <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> &amp;sp, <span class="keywordtype">int</span> width );</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classspellcasting__callback.html#abf0fad696380154cf0aa550fc5bece39">draw_spell_info</a>( <span class="keyword">const</span> <a class="code" href="classuilist.html">uilist</a> *menu );</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        <span class="comment">// invlets reserved for special functions</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#a177045736de8ee772cb9430105db4a4d"> 2303</a></span>&#160;        <span class="keyword">const</span> std::set&lt;int&gt; <a class="code" href="classspellcasting__callback.html#a177045736de8ee772cb9430105db4a4d">reserved_invlets</a>{ <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;=&#39;</span>, <span class="charliteral">&#39;*&#39;</span> };</div>
<div class="line"><a name="l02304"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383"> 2304</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383">casting_ignore</a>;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; </div>
<div class="line"><a name="l02306"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#a7f957f81933487949cac8b46811f5998"> 2306</a></span>&#160;        <a class="code" href="classspellcasting__callback.html#a7f957f81933487949cac8b46811f5998">spellcasting_callback</a>( std::vector&lt;spell *&gt; &amp;spells,</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                               <span class="keywordtype">bool</span> <a class="code" href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383">casting_ignore</a> ) : <a class="code" href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf">known_spells</a>( spells ),</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            <a class="code" href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383">casting_ignore</a>( <a class="code" href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383">casting_ignore</a> ) {}</div>
<div class="line"><a name="l02309"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#a3f4c176ee406929db8c3f0a28e88acef"> 2309</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classspellcasting__callback.html#a3f4c176ee406929db8c3f0a28e88acef">key</a>( <span class="keyword">const</span> <a class="code" href="classinput__context.html">input_context</a> &amp;ctxt, <span class="keyword">const</span> <a class="code" href="structinput__event.html">input_event</a> &amp;event, <span class="keywordtype">int</span> entnum,</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                  <a class="code" href="classuilist.html">uilist</a> *menu )<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            <span class="keyword">const</span> std::string &amp;<a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> = ctxt.<a class="code" href="classinput__context.html#a5f99b201990b09a6809f183a9cee5ab6">input_to_action</a>( event );</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> == <span class="stringliteral">&quot;CAST_IGNORE&quot;</span> ) {</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                <a class="code" href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383">casting_ignore</a> = !<a class="code" href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383">casting_ignore</a>;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> == <span class="stringliteral">&quot;CHOOSE_INVLET&quot;</span> ) {</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                <span class="keywordtype">int</span> invlet = 0;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                invlet = <a class="code" href="output_8h.html#a776e76ac0d873faf3607d5e839f08ee3">popup_getkey</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Choose a new hotkey for this spell.&quot;</span> ) );</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="inventory_8h.html#a30cdf5c616c63b894825e5e92a5b1e5c">inv_chars</a>.<a class="code" href="classinvlet__wrapper.html#a7c0b7eaf67cf02bae041ada17aa1f71d">valid</a>( invlet ) ) {</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">bool</span> invlet_set =</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                        <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;set_invlet( <a class="code" href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf">known_spells</a>[entnum]-&gt;<span class="keywordtype">id</span>(), invlet, <a class="code" href="classspellcasting__callback.html#a177045736de8ee772cb9430105db4a4d">reserved_invlets</a> );</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                    <span class="keywordflow">if</span>( !invlet_set ) {</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                        <a class="code" href="output_8cpp.html#a1e645471d321d71b235fb285da5c08ff">popup</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Hotkey already used.&quot;</span> ) );</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                        <a class="code" href="output_8cpp.html#a1e645471d321d71b235fb285da5c08ff">popup</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;%c set.  Close and reopen spell menu to refresh list with changes.&quot;</span> ),</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                               invlet );</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                    }</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                    <a class="code" href="output_8cpp.html#a1e645471d321d71b235fb285da5c08ff">popup</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Hotkey removed.&quot;</span> ) );</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                    <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;rem_invlet( <a class="code" href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf">known_spells</a>[entnum]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                }</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> == <span class="stringliteral">&quot;SCROLL_UP_SPELL_MENU&quot;</span> || <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> == <span class="stringliteral">&quot;SCROLL_DOWN_SPELL_MENU&quot;</span> ) {</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;                <a class="code" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">scroll_pos</a> += <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> == <span class="stringliteral">&quot;SCROLL_DOWN_SPELL_MENU&quot;</span> ? 1 : -1;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> == <span class="stringliteral">&quot;SCROLL_FAVORITE&quot;</span> ) {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;toggle_favorite( <a class="code" href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf">known_spells</a>[entnum]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                <a class="code" href="magic_8cpp.html#a59eae2fd66ff3b9691a4cacfabbd0f3b">reflesh_favorite</a>( menu, <a class="code" href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf">known_spells</a> );</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        }</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160; </div>
<div class="line"><a name="l02341"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#a9b22742dfdbfe2e5c727631b366a3318"> 2341</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classspellcasting__callback.html#a9b22742dfdbfe2e5c727631b366a3318">refresh</a>( <a class="code" href="classuilist.html">uilist</a> *menu )<span class="keyword"> override </span>{</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            <span class="keyword">const</span> std::string <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7a82eca2795b3af854b612ca79c53a353e">space</a>( menu-&gt;<a class="code" href="classuilist.html#a946867c48443235c3fc667a0de3d78b9">pad_right</a> - 2, <span class="charliteral">&#39; &#39;</span> );</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            <a class="code" href="output_8cpp.html#afb5597c87a5847c7d64b878ab3a77d5b">mvwputch</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#a5e8e74d29ccd984f2f9ca63a2df21cde">w_width</a> - menu-&gt;<a class="code" href="classuilist.html#a946867c48443235c3fc667a0de3d78b9">pad_right</a>, 0 ), <a class="code" href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a>, <a class="code" href="output_8h.html#a4a3bfadbe7ec0abb14ff53e5e2f8983e">LINE_OXXX</a> );</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            <a class="code" href="output_8cpp.html#afb5597c87a5847c7d64b878ab3a77d5b">mvwputch</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#a5e8e74d29ccd984f2f9ca63a2df21cde">w_width</a> - menu-&gt;<a class="code" href="classuilist.html#a946867c48443235c3fc667a0de3d78b9">pad_right</a>, menu-&gt;<a class="code" href="classuilist.html#a0ac658b356c6db04812fcb6903ac4eaa">w_height</a> - 1 ), <a class="code" href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a>,</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                      <a class="code" href="output_8h.html#a612d0d0728e93276b2b7de1fc57b096b">LINE_XXOX</a> );</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 1; i &lt; menu-&gt;<a class="code" href="classuilist.html#a0ac658b356c6db04812fcb6903ac4eaa">w_height</a> - 1; i++ ) {</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                <a class="code" href="output_8cpp.html#afb5597c87a5847c7d64b878ab3a77d5b">mvwputch</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#a5e8e74d29ccd984f2f9ca63a2df21cde">w_width</a> - menu-&gt;<a class="code" href="classuilist.html#a946867c48443235c3fc667a0de3d78b9">pad_right</a>, i ), <a class="code" href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a>, <a class="code" href="output_8h.html#a33ab4e0193402fed8f74590a30fadc3c">LINE_XOXO</a> );</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                <a class="code" href="output_8cpp.html#afb5597c87a5847c7d64b878ab3a77d5b">mvwputch</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#a5e8e74d29ccd984f2f9ca63a2df21cde">w_width</a> - menu-&gt;<a class="code" href="classuilist.html#a946867c48443235c3fc667a0de3d78b9">pad_right</a> + 1, i ), menu-&gt;<a class="code" href="classuilist.html#a4cf13b4a8551727083de162172d80a3d">text_color</a>, <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7a82eca2795b3af854b612ca79c53a353e">space</a> );</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            }</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            std::string ignore_string = <a class="code" href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383">casting_ignore</a> ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Ignore Distractions&quot;</span> ) :</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                                        <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Popup Distractions&quot;</span> );</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <a class="code" href="output_8cpp.html#a1184e3eda011b110d09bf2dcf08228f5">mvwprintz</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#a5e8e74d29ccd984f2f9ca63a2df21cde">w_width</a> - menu-&gt;<a class="code" href="classuilist.html#a946867c48443235c3fc667a0de3d78b9">pad_right</a> + 2, 0 ),</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                       <a class="code" href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383">casting_ignore</a> ? <a class="code" href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a> : <a class="code" href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a>, <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s %s&quot;</span>, <span class="stringliteral">&quot;[I]&quot;</span>, ignore_string ) );</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <span class="keyword">const</span> std::string assign_letter = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Assign Hotkey [=]&quot;</span> );</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            <a class="code" href="output_8cpp.html#a1184e3eda011b110d09bf2dcf08228f5">mvwprintz</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#a5e8e74d29ccd984f2f9ca63a2df21cde">w_width</a> - assign_letter.length() - 1, 0 ), <a class="code" href="color_8h.html#a81e80ab9142609903b4788a6bb31ae45">c_yellow</a>,</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                       assign_letter );</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            <span class="keywordflow">if</span>( menu-&gt;<a class="code" href="classuilist.html#ab0890d56d6d29dd98a0b3f17bb3ebba3">selected</a> &gt;= 0 &amp;&amp; <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>( menu-&gt;<a class="code" href="classuilist.html#ab0890d56d6d29dd98a0b3f17bb3ebba3">selected</a> ) &lt; <a class="code" href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf">known_spells</a>.size() ) {</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.empty() || <a class="code" href="classspellcasting__callback.html#ad3d9c839b2b4c00656c2cbda0e25eb7a">selected_sp</a> != menu-&gt;<a class="code" href="classuilist.html#ab0890d56d6d29dd98a0b3f17bb3ebba3">selected</a> ) {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.clear();</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                    <a class="code" href="classspellcasting__callback.html#a2321cf8b12bc562f402f289bd30bacf9">spell_info_text</a>( *<a class="code" href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf">known_spells</a>[menu-&gt;<a class="code" href="classuilist.html#ab0890d56d6d29dd98a0b3f17bb3ebba3">selected</a>], menu-&gt;<a class="code" href="classuilist.html#a946867c48443235c3fc667a0de3d78b9">pad_right</a> - 4 );</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                    <a class="code" href="classspellcasting__callback.html#ad3d9c839b2b4c00656c2cbda0e25eb7a">selected_sp</a> = menu-&gt;<a class="code" href="classuilist.html#ab0890d56d6d29dd98a0b3f17bb3ebba3">selected</a>;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                    <a class="code" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">scroll_pos</a> = 0;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">scroll_pos</a> &gt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.size() ) - ( menu-&gt;<a class="code" href="classuilist.html#a0ac658b356c6db04812fcb6903ac4eaa">w_height</a> - 2 ) ) {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                    <a class="code" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">scroll_pos</a> = <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.size() - ( menu-&gt;<a class="code" href="classuilist.html#a0ac658b356c6db04812fcb6903ac4eaa">w_height</a> - 2 );</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                }</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">scroll_pos</a> &lt; 0 ) {</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                    <a class="code" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">scroll_pos</a> = 0;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                }</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                <a class="code" href="classscrollbar.html">scrollbar</a>()</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                .<a class="code" href="classscrollbar.html#a226505801579af2a2dcf01a0c0b537df">offset_x</a>( menu-&gt;<a class="code" href="classuilist.html#a5e8e74d29ccd984f2f9ca63a2df21cde">w_width</a> - 1 )</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                .<a class="code" href="classscrollbar.html#a086351327a6cbd86aeed71287447b17f">offset_y</a>( 1 )</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                .<a class="code" href="classscrollbar.html#a98f4ed3f32292f440c0672817e74616c">content_size</a>( <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.size() )</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                .<a class="code" href="classscrollbar.html#a6d297e6f4366400fe0cc35bbeefe255e">viewport_pos</a>( <a class="code" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">scroll_pos</a> )</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                .<a class="code" href="classscrollbar.html#a93c98c6beb1deeb701317f00da76c69f">viewport_size</a>( menu-&gt;<a class="code" href="classuilist.html#a0ac658b356c6db04812fcb6903ac4eaa">w_height</a> - 2 )</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                .<a class="code" href="classscrollbar.html#ae3e092da3bab2a8bb65d662538a27f62">apply</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a> );</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;                <a class="code" href="classspellcasting__callback.html#abf0fad696380154cf0aa550fc5bece39">draw_spell_info</a>( menu );</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;            }</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            <a class="code" href="namespacecatacurses.html#aa9823d249c21fa50daf277957fabb175">wnoutrefresh</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a> );</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;        }</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;};</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160; </div>
<div class="line"><a name="l02383"></a><span class="lineno"><a class="line" href="classspell.html#a0fd925009e816157e71f96cddd9c55db"> 2383</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a0fd925009e816157e71f96cddd9c55db">spell::casting_time_encumbered</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4acdc157c853354b3b2f8f3986a7b55335">encumb</a> = 0;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba5b16e7a428e2fc90a37998f0fb12631f">spell_flag::NO_LEGS</a> ) &amp;&amp; <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        <span class="comment">// the first 20 points of encumbrance combined is ignored</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4acdc157c853354b3b2f8f3986a7b55335">encumb</a> += <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0, guy.<a class="code" href="classCharacter.html#a0bae97cba21daebf53484d06605e6529">avg_encumb_of_limb_type</a>( <a class="code" href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1a4e1df3d256693afb3630685668820df4">body_part_type::type::leg</a> ) - 10 );</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    }</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba7f3501211ea094337741cf2259a3e333">spell_flag::SOMATIC</a> ) &amp;&amp; !guy.<a class="code" href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">has_flag</a>( <a class="code" href="magic_8cpp.html#a7e54b3fea40776c033ce3476443d8eed">json_flag_SUBTLE_SPELL</a> ) &amp;&amp;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        <span class="comment">// the first 20 points of encumbrance combined is ignored</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4acdc157c853354b3b2f8f3986a7b55335">encumb</a> += <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0, guy.<a class="code" href="classCharacter.html#a0bae97cba21daebf53484d06605e6529">avg_encumb_of_limb_type</a>( <a class="code" href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1af926b3e222d7afee57071b2256839701">body_part_type::type::arm</a> ) - 10 );</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4acdc157c853354b3b2f8f3986a7b55335">encumb</a> &gt; 0;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;}</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; </div>
<div class="line"><a name="l02398"></a><span class="lineno"><a class="line" href="classspell.html#a3b6438c213ded75c5d4ea791424653e8"> 2398</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classspell.html#a3b6438c213ded75c5d4ea791424653e8">spell::energy_cost_encumbered</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#a8fabcf473532ae18478ca8c826543ebe">no_hands</a>() &amp;&amp; !guy.<a class="code" href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">has_flag</a>( <a class="code" href="magic_8cpp.html#a7e54b3fea40776c033ce3476443d8eed">json_flag_SUBTLE_SPELL</a> ) ) {</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0, guy.<a class="code" href="classCharacter.html#a0bae97cba21daebf53484d06605e6529">avg_encumb_of_limb_type</a>( <a class="code" href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1a573ce5969e9884d49d4fab77b09a306a">body_part_type::type:: hand</a> ) - 5 ) &gt;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;               0;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    }</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;}</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160; </div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="comment">// this prints various things about the spell out in a list</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">// including flags and things like &quot;goes through walls&quot;</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"><a class="line" href="classspell.html#a03e3c04f223a81a850f493fb8ee65dd3"> 2409</a></span>&#160;std::string <a class="code" href="classspell.html#a03e3c04f223a81a850f493fb8ee65dd3">spell::enumerate_spell_data</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;guy )<span class="keyword"> const</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    std::vector&lt;std::string&gt; spell_data;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a> ) ) {</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        spell_data.emplace_back( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;is a psionic power&quot;</span> ) );</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    }</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba0297e660e18811956462c321349a263c">spell_flag::CONCENTRATE</a> ) &amp;&amp; !<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a> ) &amp;&amp;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        <a class="code" href="classspell.html#a7d2e3b1f81c61f10312aa50e3626b2f9">temp_concentration_difficulty_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        spell_data.emplace_back( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;requires concentration&quot;</span> ) );</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    }</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba604cda0a87a71f133cff82d25d1195c2">spell_flag::VERBAL</a> ) &amp;&amp; <a class="code" href="classspell.html#abbefbc21e6bf90db7b45cae05c3a6c9f">temp_sound_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        spell_data.emplace_back( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;verbal&quot;</span> ) );</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    }</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba7f3501211ea094337741cf2259a3e333">spell_flag::SOMATIC</a> ) &amp;&amp; <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        spell_data.emplace_back( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;somatic&quot;</span> ) );</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    }</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#a8fabcf473532ae18478ca8c826543ebe">no_hands</a>() ) {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        spell_data.emplace_back( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;impeded by gloves&quot;</span> ) );</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classspell.html#a8fabcf473532ae18478ca8c826543ebe">no_hands</a>() &amp;&amp; !<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a> ) ) {</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        spell_data.emplace_back( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;does not require hands&quot;</span> ) );</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba5b16e7a428e2fc90a37998f0fb12631f">spell_flag::NO_LEGS</a> ) &amp;&amp; <a class="code" href="classspell.html#ae4e58f791f76940f5f07c361c745168e">temp_somatic_difficulty_multiplyer</a> &gt; 0 ) {</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        spell_data.emplace_back( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;requires mobility&quot;</span> ) );</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    }</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;attack&quot;</span> &amp;&amp; <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a>( guy ) &gt; 1 &amp;&amp; <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba54cdca63f8089e9058dff2c73ef37831">spell_flag::NO_PROJECTILE</a> ) &amp;&amp;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        !<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a> ) ) {</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        spell_data.emplace_back( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;can be cast through walls&quot;</span> ) );</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    }</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;attack&quot;</span> &amp;&amp; <a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a>( guy ) &gt; 1 &amp;&amp; <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba54cdca63f8089e9058dff2c73ef37831">spell_flag::NO_PROJECTILE</a> ) &amp;&amp;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        <a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a> ) ) {</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        spell_data.emplace_back( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;can be channeled through walls&quot;</span> ) );</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    }</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="output_8h.html#a4be67498ee67b5186fcae5cf706f7512">enumerate_as_string</a>( spell_data );</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;}</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; </div>
<div class="line"><a name="l02444"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#a2321cf8b12bc562f402f289bd30bacf9"> 2444</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspellcasting__callback.html#a2321cf8b12bc562f402f289bd30bacf9">spellcasting_callback::spell_info_text</a>( <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> &amp;sp, <span class="keywordtype">int</span> width )</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;{</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;pc = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( sp.<a class="code" href="classspell.html#a388a3e18bba1c58aa9c00dc53bc97aef">spell_class</a>() == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Classless&quot;</span> ) :</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;                                     sp.<a class="code" href="classspell.html#a388a3e18bba1c58aa9c00dc53bc97aef">spell_class</a>()-&gt;<a class="code" href="structmutation__branch.html#a2805339d7f40d83fbfb0846cca44761c">name</a>(), <a class="code" href="color_8h.html#a81e80ab9142609903b4788a6bb31ae45">c_yellow</a> ) );</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;<a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a> : <a class="code" href="output_8cpp.html#aea67d56cef07017be061e1ceefee80df">foldstring</a>( sp.<a class="code" href="classspell.html#acc66691f05cd20a085370d79df52bafa">description</a>(), width ) ) {</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a>, <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    }</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( );</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;<a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a> : <a class="code" href="output_8cpp.html#aea67d56cef07017be061e1ceefee80df">foldstring</a>( sp.<a class="code" href="classspell.html#a03e3c04f223a81a850f493fb8ee65dd3">enumerate_spell_data</a>( pc ), width ) ) {</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a>, <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    }</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( );</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160; </div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    <span class="keyword">auto</span> columnize = [&amp;width]( <span class="keyword">const</span> std::string &amp; col1, <span class="keyword">const</span> std::string &amp; col2 ) {</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        std::string <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a> = col1;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        <span class="keywordtype">int</span> pad = clamp&lt;int&gt;( width / 2 - <a class="code" href="catacharset_8cpp.html#af20ee33da59ccceb9f4c14005c0bbe80">utf8_width</a>( <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a>, <span class="keyword">true</span> ), 1, width / 2 );</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a>.append( pad, <span class="charliteral">&#39; &#39;</span> );</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;        <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a>.append( col2 );</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a>;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    };</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="comment">// Calculates temp_level_adjust from EoC, saves it to the spell for later use, and prepares to display the result</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <span class="keywordtype">int</span> temp_level_adjust = sp.<a class="code" href="classspell.html#abeb00e3b3567c2b124b847c07fcd4555">get_temp_level_adjustment</a>();</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    std::string temp_level_adjust_string;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordflow">if</span>( temp_level_adjust &lt; 0 ) {</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        temp_level_adjust_string = <span class="stringliteral">&quot; (-&quot;</span> + <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( -temp_level_adjust ) + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( temp_level_adjust &gt; 0 ) {</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        temp_level_adjust_string = <span class="stringliteral">&quot; (+&quot;</span> + <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( temp_level_adjust ) + <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160; </div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back(</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( columnize( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %d%s%s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Spell Level&quot;</span> ), sp.<a class="code" href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">get_effective_level</a>(),</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                                            sp.<a class="code" href="classspell.html#ac0702e64e2757dd74767f00f2e4cd159">is_max_level</a>( pc ) ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot; (MAX)&quot;</span> ) : <span class="stringliteral">&quot;&quot;</span>, temp_level_adjust_string.c_str() ),</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                             <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %d&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Max Level&quot;</span> ), sp.<a class="code" href="classspell.html#a8c41a03e09eb196bd6c59ff29f3f61c1">get_max_level</a>( pc ) ) ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back(</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( columnize( sp.<a class="code" href="classspell.html#afe11a0854d38e947a10d02e29f7fd84c">colorized_fail_percent</a>( pc ),</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                             <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %d&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Difficulty&quot;</span> ), sp.<a class="code" href="classspell.html#a0c002dde68c8222bed0a619b28e0b91a">get_difficulty</a>( pc ) ) ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back(</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( columnize( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Current Exp&quot;</span> ),</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                                            <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( sp.<a class="code" href="classspell.html#a1758e56413516ae56a4ee161e998c338">xp</a>() ), <a class="code" href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a> ) ),</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                             <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;to Next Level&quot;</span> ),</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                                            <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( sp.<a class="code" href="classspell.html#a4907623e7faca6b194e24543b1862d1e">exp_to_next_level</a>() ), <a class="code" href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a> ) ) ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160; </div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( );</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> cost_encumb = sp.<a class="code" href="classspell.html#a3b6438c213ded75c5d4ea791424653e8">energy_cost_encumbered</a>( pc );</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_psi = sp.<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a> );</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <span class="keywordflow">if</span>( is_psi ) {</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        std::string cost_string = cost_encumb ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Channeling Cost (impeded)&quot;</span> ) : <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Channeling Cost&quot;</span> );</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        std::string energy_cur = sp.<a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a> ? <span class="stringliteral">&quot;&quot;</span> :</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                                 <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot; (%s current)&quot;</span> ), sp.<a class="code" href="classspell.html#a1dc2bd4fd1f177c091237236627bd993">energy_cur_string</a>( pc ) );</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        <span class="keywordflow">if</span>( !pc.<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;has_enough_energy( pc, sp ) ) {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            cost_string = <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Not Enough Stamina&quot;</span> ), <a class="code" href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a> );</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;            energy_cur.clear();</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        }</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back(</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s %s%s&quot;</span>, cost_string, sp.<a class="code" href="classspell.html#a0d3f68783edb1af2e111e85f7a1715fa">energy_cost_string</a>( pc ),</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                                     sp.<a class="code" href="classspell.html#aeb55e6084337fb199e3cab09260ad916">energy_string</a>(), energy_cur ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        std::string cost_string = cost_encumb ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Casting Cost (impeded)&quot;</span> ) : <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Casting Cost&quot;</span> );</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        std::string energy_cur = sp.<a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() == <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a> ? <span class="stringliteral">&quot;&quot;</span> :</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                                 <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot; (%s current)&quot;</span> ), sp.<a class="code" href="classspell.html#a1dc2bd4fd1f177c091237236627bd993">energy_cur_string</a>( pc ) );</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;        <span class="keywordflow">if</span>( !pc.<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;has_enough_energy( pc, sp ) ) {</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            cost_string = <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Not Enough Energy&quot;</span> ), <a class="code" href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a> );</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;            energy_cur.clear();</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        }</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back(</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;            <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s %s%s&quot;</span>, cost_string, sp.<a class="code" href="classspell.html#a0d3f68783edb1af2e111e85f7a1715fa">energy_cost_string</a>( pc ),</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                                     sp.<a class="code" href="classspell.html#aeb55e6084337fb199e3cab09260ad916">energy_string</a>(), energy_cur ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    };</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_t_encumb = sp.<a class="code" href="classspell.html#a0fd925009e816157e71f96cddd9c55db">casting_time_encumbered</a>( pc );</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <span class="keywordflow">if</span>( is_psi ) {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back(</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;            <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>,</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                                     c_t_encumb ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Channeling Time (impeded)&quot;</span> ) : <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Channeling Time&quot;</span> ),</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                                     <a class="code" href="magic_8cpp.html#a9f6573c11f8d6e7562a97ba6f807396e">moves_to_string</a>( sp.<a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a>( pc ) ) ), c_t_encumb  ? <a class="code" href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a> : <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160; </div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( );</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back(</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;            <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, c_t_encumb ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Casting Time (impeded)&quot;</span> ) : <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Casting Time&quot;</span> ),</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                                     <a class="code" href="magic_8cpp.html#a9f6573c11f8d6e7562a97ba6f807396e">moves_to_string</a>( sp.<a class="code" href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">casting_time</a>( pc ) ) ), c_t_encumb  ? <a class="code" href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a> : <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160; </div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( );</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    };</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160; </div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    std::string targets;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">is_valid_target</a>( <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a334c4a4c42fdb79d7ebc3e73b517e6f8">spell_target::none</a> ) ) {</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        targets = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;self&quot;</span> );</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        targets = sp.<a class="code" href="classspell.html#af5435ef2b2d958b64074ba3846dd96c4">enumerate_targets</a>();</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    }</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back(</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Valid Targets&quot;</span> ), targets ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160; </div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( );</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160; </div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    std::string target_ids;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    target_ids = sp.<a class="code" href="classspell.html#a3a661a14d3c40f8cbd2bd727e7b9f712">list_targeted_monster_names</a>();</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="keywordflow">if</span>( !target_ids.empty() ) {</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;<a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a> :</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;             <a class="code" href="output_8cpp.html#aea67d56cef07017be061e1ceefee80df">foldstring</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Only affects the monsters: %s&quot;</span> ), target_ids ), width ) ) {</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;            <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a>, <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( );</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    }</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> damage = sp.<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( pc );</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    std::string damage_string;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    std::string aoe_string;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    <span class="comment">// if it&#39;s any type of attack spell, the stats are normal.</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;attack&quot;</span> ) {</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        <span class="keywordflow">if</span>( damage &gt; 0 ) {</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;            std::string dot_string;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;            <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aaf83b0a24bf04d172819c3c82317a7c6">damage_dot</a>( pc ) != 0 ) {</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                <span class="comment">//~ amount of damage per second, abbreviated</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                dot_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;, %d/sec&quot;</span> ), sp.<a class="code" href="classspell.html#aaf83b0a24bf04d172819c3c82317a7c6">damage_dot</a>( pc ) );</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;            }</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;            damage_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s %s%s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Damage&quot;</span> ), sp.<a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a>( pc ),</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                                           sp.<a class="code" href="classspell.html#a33b19b10be6eded53db5dee401ba6da5">damage_type_string</a>(), dot_string );</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;            damage_string = <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( damage_string, sp.<a class="code" href="classspell.html#a1ed087b326bb00071482cadeff078b15">damage_type_color</a>() );</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( damage &lt; 0 ) {</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;            damage_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Healing&quot;</span> ), <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( sp.<a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a>( pc ),</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                                           <a class="code" href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a> ) );</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        }</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">aoe</a>( pc ) &gt; 0 ) {</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;            std::string aoe_string_temp = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Spell Radius&quot;</span> );</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;            std::string degree_string;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;            <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#ab26955ff4600c3a2855e6fe02dc0d216">shape</a>() == <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca29d6fc960c94b5a330f850284e75ab1f">spell_shape::cone</a> ) {</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                aoe_string_temp = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Cone Arc&quot;</span> );</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                degree_string = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;degrees&quot;</span> );</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#ab26955ff4600c3a2855e6fe02dc0d216">shape</a>() == <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">spell_shape::line</a> ) {</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                aoe_string_temp = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Line Width&quot;</span> );</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            }</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;            aoe_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %d %s&quot;</span>, aoe_string_temp, sp.<a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">aoe</a>( pc ), degree_string );</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        }</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;short_range_teleport&quot;</span> ) {</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">aoe</a>( pc ) &gt; 0 ) {</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;            aoe_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %d&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Variance&quot;</span> ), sp.<a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">aoe</a>( pc ) );</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        }</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;spawn_item&quot;</span> ) {</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba0169f99da4a426e9b5b04c43733d8ec8">spell_flag::SPAWN_GROUP</a> ) ) {</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;            <span class="comment">// todo: more user-friendly presentation</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            damage_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Spawn item group %1$s %2$d times&quot;</span> ), sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>(),</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                                           sp.<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( pc ) );</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            damage_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s %d %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Spawn&quot;</span> ), sp.<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( pc ),</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                                           <a class="code" href="classitem.html#a438855ffd52d33307e1dfba6d607535b">item::nname</a>( <a class="code" href="classstring__id.html">itype_id</a>( sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>() ), sp.<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( pc ) ) );</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;summon&quot;</span> ) {</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        std::string monster_name = <span class="stringliteral">&quot;FIXME&quot;</span>;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba0169f99da4a426e9b5b04c43733d8ec8">spell_flag::SPAWN_GROUP</a> ) ) {</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;            <span class="comment">// TODO: Get a more user-friendly group name</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classMonsterGroupManager.html#a63d2845bca04e530ec8efb366c3725b6">MonsterGroupManager::isValidMonsterGroup</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4adcd89267470921c316111b454af6a02c">mongroup_id</a>( sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>() ) ) ) {</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                monster_name = <span class="stringliteral">&quot;from &quot;</span> + sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>();</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Unknown monster group: %s&quot;</span>, sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>() );</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;            }</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;            monster_name = <a class="code" href="classmonster.html">monster</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4aabdee90f7518eedc26e713014acfcaca">mtype_id</a>( sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>() ) ).<a class="code" href="classmonster.html#ad4fba0b9aea36097d8b972e05e66d914">get_name</a>( );</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        }</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        damage_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s %d %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Summon&quot;</span> ), sp.<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( pc ), monster_name );</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        aoe_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %d&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Spell Radius&quot;</span> ), sp.<a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">aoe</a>( pc ) );</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;targeted_polymorph&quot;</span> ) {</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        std::string monster_name = sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>();</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba315fc579dd9a280bceb7e5845c5cc675">spell_flag::POLYMORPH_GROUP</a> ) ) {</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;            <span class="comment">// TODO: Get a more user-friendly group name</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classMonsterGroupManager.html#a63d2845bca04e530ec8efb366c3725b6">MonsterGroupManager::isValidMonsterGroup</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4adcd89267470921c316111b454af6a02c">mongroup_id</a>( sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>() ) ) ) {</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                monster_name = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;random creature&quot;</span> );</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Unknown monster group: %s&quot;</span>, sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>() );</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;            }</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( monster_name.empty() ) {</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            monster_name = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;random creature&quot;</span> );</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;            monster_name = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4aabdee90f7518eedc26e713014acfcaca">mtype_id</a>( sp.<a class="code" href="classspell.html#ab6f8776ac707639708392c616d93fa58">effect_data</a>() )-&gt;nname();</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        }</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        damage_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Targets under: %dhp become a %s&quot;</span> ), sp.<a class="code" href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">damage</a>( pc ),</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                                       monster_name );</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;ter_transform&quot;</span> ) {</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        aoe_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Spell Radius&quot;</span> ), sp.<a class="code" href="classspell.html#a335dc296fd7e166be557e69dc6d9f147">aoe_string</a>( pc ) );</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">effect</a>() == <span class="stringliteral">&quot;banishment&quot;</span> ) {</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        damage_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Damage&quot;</span> ), sp.<a class="code" href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">damage_string</a>( pc ),</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                                       sp.<a class="code" href="classspell.html#a33b19b10be6eded53db5dee401ba6da5">damage_type_string</a>() );</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;        <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">aoe</a>( pc ) &gt; 0 ) {</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;            aoe_string = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Spell Radius: %d&quot;</span> ), sp.<a class="code" href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">aoe</a>( pc ) );</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;        }</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    }</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160; </div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <span class="comment">// Range / AOE in two columns</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Range&quot;</span> ),</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;                                     sp.<a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a>( pc ) &lt;= 0 ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;self&quot;</span> ) : <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( sp.<a class="code" href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">range</a>( pc ) ) ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( aoe_string, <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; </div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <span class="comment">// One line for damage / healing / spawn / summon effect</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( damage_string, <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="comment">// todo: damage over time here, when it gets implemented</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <span class="comment">// Show duration for spells that endure</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#a3a67307def07ddc6d2e2c134d21c245f">duration</a>( pc ) &gt; 0 || sp.<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba54bcf9b291726b4cf8343f61681a5cfd">spell_flag::PERMANENT</a> ) ||</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        sp.<a class="code" href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">has_flag</a>( <a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba82397545cee465e4bda1cb70ef78c0f0">spell_flag::PERMANENT_ALL_LEVELS</a> ) ) {</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back(</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;            <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Duration&quot;</span> ), sp.<a class="code" href="classspell.html#a4b1a5a0c2bd28fb4101608783f25b101">duration_string</a>( pc ) ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> ) );</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    }</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160; </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="keywordflow">if</span>( sp.<a class="code" href="classspell.html#ad8662455c101a353ea64618a49908a4b">has_components</a>() ) {</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        <span class="keywordflow">if</span>( !sp.<a class="code" href="classspell.html#af69dedf22c42ebc9fb41f8f22102630d">components</a>().<a class="code" href="structrequirement__data.html#a56dbf23ade6bced0dc6148b8e1a12d4c">get_components</a>().empty() ) {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;<a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a> : sp.<a class="code" href="classspell.html#af69dedf22c42ebc9fb41f8f22102630d">components</a>().<a class="code" href="structrequirement__data.html#a9b9025140c166ce2a00fcf41db96b7a9">get_folded_components_list</a>(</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                     width - 2, <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a>, pc.<a class="code" href="classCharacter.html#ace218285f4fbc7c7a9feac8378bc632e">crafting_inventory</a>( pc.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 0, <span class="keyword">false</span> ), return_true&lt;item&gt; ) ) {</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a> );</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;            }</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        }</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="keywordflow">if</span>( !( sp.<a class="code" href="classspell.html#af69dedf22c42ebc9fb41f8f22102630d">components</a>().<a class="code" href="structrequirement__data.html#a175d46943600149603b7a915cb48092b">get_tools</a>().empty() &amp;&amp; sp.<a class="code" href="classspell.html#af69dedf22c42ebc9fb41f8f22102630d">components</a>().<a class="code" href="structrequirement__data.html#ad7733e9b478f08e7e6e1ef94057e3502">get_qualities</a>().empty() ) ) {</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;<a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a> : sp.<a class="code" href="classspell.html#af69dedf22c42ebc9fb41f8f22102630d">components</a>().<a class="code" href="structrequirement__data.html#a7518cd295931d5e30f6ba0341f90aa8b">get_folded_tools_list</a>(</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                     width - 2, <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a>, pc.<a class="code" href="classCharacter.html#ace218285f4fbc7c7a9feac8378bc632e">crafting_inventory</a>( pc.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 0, <span class="keyword">false</span> ) ) ) {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.emplace_back( <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a> );</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;            }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;        }</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    }</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;}</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160; </div>
<div class="line"><a name="l02667"></a><span class="lineno"><a class="line" href="classspellcasting__callback.html#abf0fad696380154cf0aa550fc5bece39"> 2667</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspellcasting__callback.html#abf0fad696380154cf0aa550fc5bece39">spellcasting_callback::draw_spell_info</a>( <span class="keyword">const</span> <a class="code" href="classuilist.html">uilist</a> *menu )</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;{</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> h_offset = menu-&gt;<a class="code" href="classuilist.html#a5e8e74d29ccd984f2f9ca63a2df21cde">w_width</a> - menu-&gt;<a class="code" href="classuilist.html#a946867c48443235c3fc667a0de3d78b9">pad_right</a> + 1;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    <span class="keywordtype">int</span> row = 1;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    <a class="code" href="classnc__color.html">nc_color</a> clr = <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a>;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160; </div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a> = <a class="code" href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">scroll_pos</a>; row &lt; menu-&gt;<a class="code" href="classuilist.html#a0ac658b356c6db04812fcb6903ac4eaa">w_height</a> - 1 &amp;&amp;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;         line &lt; static_cast&lt;int&gt;( <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>.size() ); row++, <a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a>++ ) {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;        <a class="code" href="output_8cpp.html#a64a769083b78bb93dbb99935b959f3f5">print_colored_text</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( h_offset + 1, row ), clr, <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a>, <a class="code" href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">info_txt</a>[<a class="code" href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">line</a>] );</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    }</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;}</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; </div>
<div class="line"><a name="l02679"></a><span class="lineno"><a class="line" href="classknown__magic.html#ad1adf916c9f70a561c9475f40c94259f"> 2679</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classknown__magic.html#ad1adf916c9f70a561c9475f40c94259f">known_magic::set_invlet</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp, <span class="keywordtype">int</span> invlet, <span class="keyword">const</span> std::set&lt;int&gt; &amp;used_invlets )</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;{</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">if</span>( used_invlets.count( invlet ) &gt; 0 ) {</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;    }</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a>[sp] = invlet;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;}</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160; </div>
<div class="line"><a name="l02688"></a><span class="lineno"><a class="line" href="classknown__magic.html#a9c29f4c065729517316b825e410641df"> 2688</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a9c29f4c065729517316b825e410641df">known_magic::rem_invlet</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;{</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a>.erase( sp );</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;}</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160; </div>
<div class="line"><a name="l02693"></a><span class="lineno"><a class="line" href="classknown__magic.html#a0bb52cad9c545b82cd57eb1d45dc09a0"> 2693</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a0bb52cad9c545b82cd57eb1d45dc09a0">known_magic::toggle_favorite</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;{</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.count( sp ) &gt; 0 ) {</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.erase( sp );</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.emplace( sp );</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;}</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160; </div>
<div class="line"><a name="l02702"></a><span class="lineno"><a class="line" href="classknown__magic.html#a01400dc46a0d3fd5ee23bc8be16f0a55"> 2702</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classknown__magic.html#a01400dc46a0d3fd5ee23bc8be16f0a55">known_magic::is_favorite</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;{</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.count( sp ) &gt; 0;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;}</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160; </div>
<div class="line"><a name="l02707"></a><span class="lineno"><a class="line" href="classknown__magic.html#a92c16301084172b5bd459c257af9c002"> 2707</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classknown__magic.html#a92c16301084172b5bd459c257af9c002">known_magic::get_invlet</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp, std::set&lt;int&gt; &amp;used_invlets )</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;{</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <span class="keyword">auto</span> found = <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a>.find( sp );</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="keywordflow">if</span>( found != <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a>.end() ) {</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        <span class="keywordflow">return</span> found-&gt;second;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    }</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const spell_id, int&gt; &amp;invlet_pair : <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a> ) {</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        used_invlets.emplace( invlet_pair.second );</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    }</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = <span class="charliteral">&#39;a&#39;</span>; i &lt;= <span class="charliteral">&#39;z&#39;</span>; i++ ) {</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        <span class="keywordflow">if</span>( used_invlets.count( i ) == 0 ) {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            used_invlets.emplace( i );</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;            <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    }</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = <span class="charliteral">&#39;A&#39;</span>; i &lt;= <span class="charliteral">&#39;Z&#39;</span>; i++ ) {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        <span class="keywordflow">if</span>( used_invlets.count( i ) == 0 ) {</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            used_invlets.emplace( i );</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        }</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    }</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = <span class="charliteral">&#39;!&#39;</span>; i &lt;= <span class="charliteral">&#39;-&#39;</span>; i++ ) {</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;        <span class="keywordflow">if</span>( used_invlets.count( i ) == 0 ) {</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            used_invlets.emplace( i );</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        }</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;}</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160; </div>
<div class="line"><a name="l02737"></a><span class="lineno"><a class="line" href="classknown__magic.html#a98a91b2ff64d726c4d54f04a3fee000e"> 2737</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classknown__magic.html#a98a91b2ff64d726c4d54f04a3fee000e">known_magic::select_spell</a>( <a class="code" href="classCharacter.html">Character</a> &amp;guy )</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;{</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="comment">// max width of spell names</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> max_spell_name_length = <a class="code" href="classknown__magic.html#adb9da4817cfdc19624a8674d4cc16fea">get_spellname_max_width</a>();</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    std::vector&lt;spell *&gt; known_spells = <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>();</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160; </div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <a class="code" href="classuilist.html">uilist</a> spell_menu;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a7d03ff2194b5dc30035d88d77108f6a4">w_height_setup</a> = [&amp;]() -&gt; <span class="keywordtype">int</span> {</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( known_spells.size() ), 24, <a class="code" href="output_8cpp.html#a567a63be8cb70cc3eb47bf8affced8e5">TERMY</a> * 9 / 10 );</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    };</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> calc_width = []() -&gt; <span class="keywordtype">int</span> {</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 80, <a class="code" href="output_8cpp.html#a000abea6447dfafd5f9b787aa6753609">TERMX</a> * 3 / 8 );</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    };</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a5dac54c98fae0ec2bc4b0ac75c9fcd57">w_width_setup</a> = calc_width;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a790be01eb1b3db027e262729e5e95aae">pad_right_setup</a> = [&amp;]() -&gt; <span class="keywordtype">int</span> {</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        <span class="keywordflow">return</span> calc_width() - max_spell_name_length - 5;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    };</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a53ff5990a6abb4e7da837db31afea4b8">title</a> = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Choose a Spell&quot;</span> );</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a3d9259dd0d2627c4768fb4a17cddf3b6">input_category</a> = <span class="stringliteral">&quot;SPELL_MENU&quot;</span>;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;CHOOSE_INVLET&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;CAST_IGNORE&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;SCROLL_UP_SPELL_MENU&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;SCROLL_DOWN_SPELL_MENU&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;SCROLL_FAVORITE&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    spell_menu.<a class="code" href="classuilist.html#ae4ae08b4f010935825c956ea705065aa">hilight_disabled</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <a class="code" href="classspellcasting__callback.html">spellcasting_callback</a> cb( known_spells, <a class="code" href="classknown__magic.html#a8feaad1d7a7ecbb054556ef48e4599c6">casting_ignore</a> );</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    spell_menu.<a class="code" href="classuilist.html#ad4f5806d1d8ab3de3af8e3285faf47d6">callback</a> = &amp;cb;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a96c497ff6d2c333effba75839fdccede">add_category</a>( <span class="stringliteral">&quot;all&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;All&quot;</span> ) );</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a96c497ff6d2c333effba75839fdccede">add_category</a>( <span class="stringliteral">&quot;favorites&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Favorites&quot;</span> ) );</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160; </div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    std::vector&lt;std::pair&lt;std::string, std::string&gt;&gt; categories;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> *s : known_spells ) {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        <span class="keywordflow">if</span>( s-&gt;can_cast( guy ) &amp;&amp; ( s-&gt;spell_class().is_valid() || s-&gt;spell_class() == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ) ) {</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            <span class="keyword">const</span> std::string spell_class_name = s-&gt;spell_class() == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Classless&quot;</span> ) :</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                                                 s-&gt;spell_class().obj().name();</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;            categories.emplace_back( s-&gt;spell_class().str(), spell_class_name );</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;            std::sort( categories.begin(), categories.end(), []( <span class="keyword">const</span> std::pair&lt;std::string, std::string&gt; &amp;<a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>,</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;            <span class="keyword">const</span> std::pair&lt;std::string, std::string&gt; &amp;<a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> ) {</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                return localized_compare( a.second, b.second );</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            } );</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> itr = std::unique( categories.begin(), categories.end() );</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            categories.erase( itr, categories.end() );</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        }</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    }</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="keywordflow">for</span>( std::pair&lt;std::string, std::string&gt; &amp;cat : categories ) {</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        spell_menu.<a class="code" href="classuilist.html#a96c497ff6d2c333effba75839fdccede">add_category</a>( cat.first, cat.second );</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    }</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160; </div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    spell_menu.<a class="code" href="classuilist.html#add589714bd51df0cbac9b947403004c1">set_category_filter</a>( [&amp;guy, known_spells]( <span class="keyword">const</span> <a class="code" href="structuilist__entry.html">uilist_entry</a> &amp; entry,</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <span class="keyword">const</span> std::string &amp; key )-&gt;<span class="keywordtype">bool</span> {</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        <span class="keywordflow">if</span>( key == <span class="stringliteral">&quot;all&quot;</span> )</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        {</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( key == <span class="stringliteral">&quot;favorites&quot;</span> )</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;            <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;is_favorite( known_spells[entry.<a class="code" href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">retval</a>]-&gt;id() );</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        }</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <span class="keywordflow">return</span> ( known_spells[entry.<a class="code" href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">retval</a>]-&gt;spell_class().is_valid() || known_spells[entry.<a class="code" href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">retval</a>]-&gt;spell_class() == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ) &amp;&amp; known_spells[entry.<a class="code" href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">retval</a>]-&gt;spell_class().str() == key;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    } );</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.empty() ) {</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        spell_menu.<a class="code" href="classuilist.html#a9c00fd7c5cdfee33072eca7d816a4e62">set_category</a>( <span class="stringliteral">&quot;favorites&quot;</span> );</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        spell_menu.<a class="code" href="classuilist.html#a9c00fd7c5cdfee33072eca7d816a4e62">set_category</a>( <span class="stringliteral">&quot;all&quot;</span> );</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    }</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160; </div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    std::set&lt;int&gt; used_invlets{ cb.<a class="code" href="classspellcasting__callback.html#a177045736de8ee772cb9430105db4a4d">reserved_invlets</a> };</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160; </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; known_spells.size(); i++ ) {</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        spell_menu.<a class="code" href="classuilist.html#a18fd9765355d9e418bc2c399048e0645">addentry</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( i ), known_spells[i]-&gt;can_cast( guy ),</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                             <a class="code" href="classknown__magic.html#a92c16301084172b5bd459c257af9c002">get_invlet</a>( known_spells[i]-&gt;<span class="keywordtype">id</span>(), used_invlets ), known_spells[i]-&gt;<a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a>() );</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    }</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <a class="code" href="magic_8cpp.html#a59eae2fd66ff3b9691a4cacfabbd0f3b">reflesh_favorite</a>( &amp;spell_menu, known_spells );</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160; </div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    spell_menu.<a class="code" href="group__UI.html#ga7604af7545244003f0a52ac87ce37979">query</a>();</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160; </div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <a class="code" href="classknown__magic.html#a8feaad1d7a7ecbb054556ef48e4599c6">casting_ignore</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="classspellcasting__callback.html">spellcasting_callback</a> *<span class="keyword">&gt;</span>( spell_menu.<a class="code" href="classuilist.html#ad4f5806d1d8ab3de3af8e3285faf47d6">callback</a> )-&gt;<a class="code" href="classknown__magic.html#a8feaad1d7a7ecbb054556ef48e4599c6">casting_ignore</a>;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; </div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    <span class="keywordflow">return</span> spell_menu.<a class="code" href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">ret</a>;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;}</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160; </div>
<div class="line"><a name="l02817"></a><span class="lineno"><a class="line" href="classknown__magic.html#aadc9db2d8635c2b6e6e28f14bf689cd1"> 2817</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#aadc9db2d8635c2b6e6e28f14bf689cd1">known_magic::on_mutation_gain</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">trait_id</a> &amp;mid, <a class="code" href="classCharacter.html">Character</a> &amp;guy )</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;{</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const spell_id, int&gt; &amp;sp : mid-&gt;<a class="code" href="structmutation__branch.html#a7c0ff24a9aac03207154197f7f6fa789">spells_learned</a> ) {</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        <a class="code" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">learn_spell</a>( sp.first, guy, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;        <a class="code" href="classspell.html">spell</a> &amp;temp_sp = <a class="code" href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">get_spell</a>( sp.first );</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> level = 0; level &lt; sp.second; level++ ) {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;            temp_sp.<a class="code" href="classspell.html#a682544edebcf289a96fc4fcd812890c8">gain_level</a>( guy );</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;        }</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    }</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;}</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160; </div>
<div class="line"><a name="l02828"></a><span class="lineno"><a class="line" href="classknown__magic.html#a8492a7babf0a12769b76bff2e61e0098"> 2828</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classknown__magic.html#a8492a7babf0a12769b76bff2e61e0098">known_magic::on_mutation_loss</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">trait_id</a> &amp;mid )</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;{</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    std::vector&lt;spell_id&gt; spells_to_forget;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> *sp : <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>() ) {</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        <span class="keywordflow">if</span>( sp-&gt;is_spell_class( mid ) ) {</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;            spells_to_forget.emplace_back( sp-&gt;id() );</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        }</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    }</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp_id : spells_to_forget ) {</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        <a class="code" href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6">forget_spell</a>( sp_id );</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    }</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;}</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160; </div>
<div class="line"><a name="l02841"></a><span class="lineno"><a class="line" href="classspellbook__callback.html#a7cf62ee07d7389f19eb42d1f495b7443"> 2841</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspellbook__callback.html#a7cf62ee07d7389f19eb42d1f495b7443">spellbook_callback::add_spell</a>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp )</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;{</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <a class="code" href="classspellbook__callback.html#a2722c690a5d2dc3a64b0620818de12e5">spells</a>.emplace_back( sp.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>() );</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;}</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160; </div>
<div class="line"><a name="l02846"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a4469c50b5066f32942c540b43348dc68"> 2846</a></span>&#160;<span class="keyword">static</span> std::string <a class="code" href="magic_8cpp.html#a4469c50b5066f32942c540b43348dc68">color_number</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> num )</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;{</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    <span class="keywordflow">if</span>( num &gt; 0 ) {</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( num ), <a class="code" href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a> );</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( num &lt; 0 ) {</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( num ), <a class="code" href="color_8h.html#aab11865a3631a7ce78da82b7fb386b71">c_light_red</a> );</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( num ), <a class="code" href="color_8h.html#a0d06dc49b9761bbc54607397213728bb">c_white</a> );</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    }</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;}</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160; </div>
<div class="line"><a name="l02857"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a48a32678de61930b14d86bcc4a34ee52"> 2857</a></span>&#160;<span class="keyword">static</span> std::string <a class="code" href="magic_8cpp.html#a4469c50b5066f32942c540b43348dc68">color_number</a>( <span class="keyword">const</span> <span class="keywordtype">float</span> num )</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;{</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    <span class="keywordflow">if</span>( num &gt; 100 ) {</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;+%.0f&quot;</span>, num ), <a class="code" href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a> );</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( num &lt; -100 ) {</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%.0f&quot;</span>, num ), <a class="code" href="color_8h.html#aab11865a3631a7ce78da82b7fb386b71">c_light_red</a> );</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( num &gt; 0 ) {</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;+%.2f&quot;</span>, num ), <a class="code" href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a> );</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( num &lt; 0 ) {</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%.2f&quot;</span>, num ), <a class="code" href="color_8h.html#aab11865a3631a7ce78da82b7fb386b71">c_light_red</a> );</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="color_8h.html#a0d06dc49b9761bbc54607397213728bb">c_white</a> );</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    }</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;}</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160; </div>
<div class="line"><a name="l02872"></a><span class="lineno"><a class="line" href="magic_8cpp.html#a731e644204d5a89620d50e27e5f4b43a"> 2872</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="magic_8cpp.html#a731e644204d5a89620d50e27e5f4b43a">draw_spellbook_info</a>( <span class="keyword">const</span> <a class="code" href="classspell__type.html">spell_type</a> &amp;sp, <a class="code" href="classuilist.html">uilist</a> *menu )</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;{</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> width = menu-&gt;<a class="code" href="classuilist.html#ab19726dc405b4debc736cb4b68cd3b49">pad_left</a> - 4;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> start_x = 2;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a> = 1;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <span class="keyword">const</span> <a class="code" href="classcatacurses_1_1window.html">catacurses::window</a> w = menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <a class="code" href="classnc__color.html">nc_color</a> gray = <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <a class="code" href="classnc__color.html">nc_color</a> <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">yellow</a> = <a class="code" href="color_8h.html#a81e80ab9142609903b4788a6bb31ae45">c_yellow</a>;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> <a class="code" href="structfake__spell.html">fake_spell</a>( sp.<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;pc = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( pc ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160; </div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <span class="keyword">const</span> std::string spell_name = <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( sp.<a class="code" href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">name</a>, <a class="code" href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a> );</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="keyword">const</span> std::string spell_class = sp.<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Classless&quot;</span> ) :</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                                    sp.<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a2805339d7f40d83fbfb0846cca44761c">name</a>();</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <a class="code" href="output_8cpp.html#a64a769083b78bb93dbb99935b959f3f5">print_colored_text</a>( w, <a class="code" href="structpoint.html">point</a>( start_x, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a> ), gray, gray, spell_name );</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <a class="code" href="output_8cpp.html#a64a769083b78bb93dbb99935b959f3f5">print_colored_text</a>( w, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#ab19726dc405b4debc736cb4b68cd3b49">pad_left</a> - <a class="code" href="catacharset_8cpp.html#af20ee33da59ccceb9f4c14005c0bbe80">utf8_width</a>( spell_class ) - 1, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>++ ), <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">yellow</a>,</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                        <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">yellow</a>, spell_class );</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>++;</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a> += <a class="code" href="output_8cpp.html#ab9659cbe9ec23a2efd813f795cb7fb73">fold_and_print</a>( w, <a class="code" href="structpoint.html">point</a>( start_x, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a> ), width, gray, <span class="stringliteral">&quot;%s&quot;</span>, sp.<a class="code" href="classspell__type.html#a0bf174d1f3134b53667d8381c02d6ee4">description</a> );</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>++;</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160; </div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    <a class="code" href="output_8cpp.html#a1184e3eda011b110d09bf2dcf08228f5">mvwprintz</a>( w, <a class="code" href="structpoint.html">point</a>( start_x, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a> ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a>,</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;               <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %d&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Difficulty&quot;</span> ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( sp.<a class="code" href="classspell__type.html#a960a7f198bd614a7c048405d7d120f61">difficulty</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ) );</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <a class="code" href="output_8cpp.html#a1184e3eda011b110d09bf2dcf08228f5">mvwprintz</a>( w, <a class="code" href="structpoint.html">point</a>( start_x + width / 2, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>++ ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a>,</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;               <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %d&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Max Level&quot;</span> ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( sp.<a class="code" href="classspell__type.html#ad2535cbbbb4a50c01ee79c47d3dde019">max_level</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) ) ) );</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160; </div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <span class="keyword">const</span> std::string fx = sp.<a class="code" href="classspell__type.html#afa2cd70d2587c495c1565209b2292a36">effect_name</a>;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    std::string damage_string;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    std::string aoe_string;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <span class="keywordtype">bool</span> has_damage_type = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <span class="keywordflow">if</span>( fx == <span class="stringliteral">&quot;attack&quot;</span> ) {</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;        damage_string = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Damage&quot;</span> );</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;        aoe_string = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;AoE&quot;</span> );</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;        has_damage_type = sp.<a class="code" href="classspell__type.html#a60beddc934a1d3571d46ae521cc1fc6c">min_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt; 0 &amp;&amp; sp.<a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) &gt; 0;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( fx == <span class="stringliteral">&quot;spawn_item&quot;</span> || fx == <span class="stringliteral">&quot;summon_monster&quot;</span> ) {</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        damage_string = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Spawned&quot;</span> );</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( fx == <span class="stringliteral">&quot;targeted_polymorph&quot;</span> ) {</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        damage_string = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Threshold&quot;</span> );</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( fx == <span class="stringliteral">&quot;recover_energy&quot;</span> ) {</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;        damage_string = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Recover&quot;</span> );</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( fx == <span class="stringliteral">&quot;short_range_teleport&quot;</span> ) {</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        aoe_string = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Variance&quot;</span> );</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( fx == <span class="stringliteral">&quot;area_pull&quot;</span> || fx == <span class="stringliteral">&quot;area_push&quot;</span> ||  fx == <span class="stringliteral">&quot;ter_transform&quot;</span> ) {</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;        aoe_string = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;AoE&quot;</span> );</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    }</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160; </div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <span class="keywordflow">if</span>( has_damage_type ) {</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;        <a class="code" href="output_8cpp.html#a64a769083b78bb93dbb99935b959f3f5">print_colored_text</a>( w, <a class="code" href="structpoint.html">point</a>( start_x, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>++ ), gray, gray, <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>,</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                            <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Damage Type&quot;</span> ),</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                            <a class="code" href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a>( <a class="code" href="structfake__spell.html">fake_spell</a>.damage_type_string(), <a class="code" href="structfake__spell.html">fake_spell</a>.damage_type_color() ) ) );</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    }</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>++;</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160; </div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <a class="code" href="output_8cpp.html#a64a769083b78bb93dbb99935b959f3f5">print_colored_text</a>( w, <a class="code" href="structpoint.html">point</a>( start_x, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>++ ), gray, gray,</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;                        <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s %s %s %s&quot;</span>,</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;                                       <span class="comment">//~ translation should not exceed 10 console cells</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;                                       <a class="code" href="catacharset_8cpp.html#a756b52a0bf9f4b63eadbe44da3e11a00">left_justify</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Stat Gain&quot;</span> ), 10 ),</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;                                       <span class="comment">//~ translation should not exceed 7 console cells</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                                       <a class="code" href="catacharset_8cpp.html#a756b52a0bf9f4b63eadbe44da3e11a00">left_justify</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;lvl 0&quot;</span> ), 7 ),</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                                       <span class="comment">//~ translation should not exceed 7 console cells</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                                       <a class="code" href="catacharset_8cpp.html#a756b52a0bf9f4b63eadbe44da3e11a00">left_justify</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;per lvl&quot;</span> ), 7 ),</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                                       <span class="comment">//~ translation should not exceed 7 console cells</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                                       <a class="code" href="catacharset_8cpp.html#a756b52a0bf9f4b63eadbe44da3e11a00">left_justify</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;max lvl&quot;</span> ), 7 ) ) );</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160; </div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> row = [&amp;]( <span class="keyword">const</span> std::string &amp; <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a0889397d959be6d4ddc65c9f196ae3e4">label</a>, <span class="keyword">const</span> <a class="code" href="structdbl__or__var.html">dbl_or_var</a> &amp; min_d,</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <span class="keyword">const</span> <a class="code" href="structdbl__or__var.html">dbl_or_var</a> &amp; inc_d, <span class="keyword">const</span> <a class="code" href="structdbl__or__var.html">dbl_or_var</a> &amp; max_d, <span class="keywordtype">bool</span> check_minmax = false ) {</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">min</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( min_d.evaluate( d ) );</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> inc = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( inc_d.evaluate( d ) );</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">max</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( max_d.evaluate( d ) );</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;        <span class="keywordflow">if</span>( check_minmax &amp;&amp; ( <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">min</a> == 0 || <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">max</a> == 0 ) ) {</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;        }</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;        <a class="code" href="output_8cpp.html#a1184e3eda011b110d09bf2dcf08228f5">mvwprintz</a>( w, <a class="code" href="structpoint.html">point</a>( start_x, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a> ), <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a>, <a class="code" href="structlabel.html">label</a> );</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        <a class="code" href="output_8cpp.html#a64a769083b78bb93dbb99935b959f3f5">print_colored_text</a>( w, <a class="code" href="structpoint.html">point</a>( start_x + 11, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a> ), gray, gray, <a class="code" href="magic_8cpp.html#a4469c50b5066f32942c540b43348dc68">color_number</a>( <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">min</a> ) );</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;        <a class="code" href="output_8cpp.html#a64a769083b78bb93dbb99935b959f3f5">print_colored_text</a>( w, <a class="code" href="structpoint.html">point</a>( start_x + 19, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a> ), gray, gray, <a class="code" href="magic_8cpp.html#a4469c50b5066f32942c540b43348dc68">color_number</a>( inc ) );</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <a class="code" href="output_8cpp.html#a64a769083b78bb93dbb99935b959f3f5">print_colored_text</a>( w, <a class="code" href="structpoint.html">point</a>( start_x + 27, <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a> ), gray, gray, <a class="code" href="magic_8cpp.html#a4469c50b5066f32942c540b43348dc68">color_number</a>( <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">max</a> ) );</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>++;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    };</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160; </div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <span class="keywordflow">if</span>( !damage_string.empty() ) {</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        row( damage_string, sp.<a class="code" href="classspell__type.html#a60beddc934a1d3571d46ae521cc1fc6c">min_damage</a>, sp.<a class="code" href="classspell__type.html#aa4c09471023f07665681f5bf684d1e37">damage_increment</a>, sp.<a class="code" href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">max_damage</a>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    }</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160; </div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    row( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Range&quot;</span> ), sp.<a class="code" href="classspell__type.html#aa4b832cf689f208feda1c32d37fcdba5">min_range</a>, sp.<a class="code" href="classspell__type.html#acb2e4a03f710e9444583ba6c59da06be">range_increment</a>, sp.<a class="code" href="classspell__type.html#a5b8690441c94b9182bf777d1a14ffe8f">max_range</a>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160; </div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <span class="keywordflow">if</span>( !aoe_string.empty() ) {</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        row( aoe_string, sp.<a class="code" href="classspell__type.html#aa503b99197533fa1dfa5de8052a4119b">min_aoe</a>, sp.<a class="code" href="classspell__type.html#a86eb7c8c5fa42a5307de55cc4646b97e">aoe_increment</a>, sp.<a class="code" href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">max_aoe</a>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    }</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160; </div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    row( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Duration&quot;</span> ), sp.<a class="code" href="classspell__type.html#a51accd4d56a09f1c2f5dae55832a8797">min_duration</a>, sp.<a class="code" href="classspell__type.html#a6e7735afc9f1817f48ad9c43f710b5f4">duration_increment</a>, sp.<a class="code" href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">max_duration</a>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    row( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Cast Cost&quot;</span> ), sp.<a class="code" href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">base_energy_cost</a>, sp.<a class="code" href="classspell__type.html#a374a9343878e6614c0185f25acf37b30">energy_increment</a>, sp.<a class="code" href="classspell__type.html#a171e7148d9087468c1be262d13802338">final_energy_cost</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    row( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Cast Time&quot;</span> ), sp.<a class="code" href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">base_casting_time</a>, sp.<a class="code" href="classspell__type.html#a094462d9091edcb781516ba1c6bf5096">casting_time_increment</a>, sp.<a class="code" href="classspell__type.html#adccbac25f546cf4b277b1058b59f0ae8">final_casting_time</a>,</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;         <span class="keyword">false</span> );</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;}</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160; </div>
<div class="line"><a name="l02968"></a><span class="lineno"><a class="line" href="classspellbook__callback.html#a459cd620b3b7f5024903449e3c0f7638"> 2968</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspellbook__callback.html#a459cd620b3b7f5024903449e3c0f7638">spellbook_callback::refresh</a>( <a class="code" href="classuilist.html">uilist</a> *menu )</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;{</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    <a class="code" href="output_8cpp.html#afb5597c87a5847c7d64b878ab3a77d5b">mvwputch</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#ab19726dc405b4debc736cb4b68cd3b49">pad_left</a>, 0 ), <a class="code" href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a>, <a class="code" href="output_8h.html#a4a3bfadbe7ec0abb14ff53e5e2f8983e">LINE_OXXX</a> );</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    <a class="code" href="output_8cpp.html#afb5597c87a5847c7d64b878ab3a77d5b">mvwputch</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#ab19726dc405b4debc736cb4b68cd3b49">pad_left</a>, menu-&gt;<a class="code" href="classuilist.html#a0ac658b356c6db04812fcb6903ac4eaa">w_height</a> - 1 ), <a class="code" href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a>, <a class="code" href="output_8h.html#a612d0d0728e93276b2b7de1fc57b096b">LINE_XXOX</a> );</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 1; i &lt; menu-&gt;<a class="code" href="classuilist.html#a0ac658b356c6db04812fcb6903ac4eaa">w_height</a> - 1; i++ ) {</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;        <a class="code" href="output_8cpp.html#afb5597c87a5847c7d64b878ab3a77d5b">mvwputch</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a>, <a class="code" href="structpoint.html">point</a>( menu-&gt;<a class="code" href="classuilist.html#ab19726dc405b4debc736cb4b68cd3b49">pad_left</a>, i ), <a class="code" href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a>, <a class="code" href="output_8h.html#a33ab4e0193402fed8f74590a30fadc3c">LINE_XOXO</a> );</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    }</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <span class="keywordflow">if</span>( menu-&gt;<a class="code" href="classuilist.html#ab0890d56d6d29dd98a0b3f17bb3ebba3">selected</a> &gt;= 0 &amp;&amp; <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>( menu-&gt;<a class="code" href="classuilist.html#ab0890d56d6d29dd98a0b3f17bb3ebba3">selected</a> ) &lt; <a class="code" href="classspellbook__callback.html#a2722c690a5d2dc3a64b0620818de12e5">spells</a>.size() ) {</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;        <a class="code" href="magic_8cpp.html#a731e644204d5a89620d50e27e5f4b43a">draw_spellbook_info</a>( <a class="code" href="classspellbook__callback.html#a2722c690a5d2dc3a64b0620818de12e5">spells</a>[menu-&gt;<a class="code" href="classuilist.html#ab0890d56d6d29dd98a0b3f17bb3ebba3">selected</a>], menu );</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    }</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    <a class="code" href="namespacecatacurses.html#aa9823d249c21fa50daf277957fabb175">wnoutrefresh</a>( menu-&gt;<a class="code" href="classuilist.html#a363d10490fb72bde7b2537fd06836802">window</a> );</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;}</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160; </div>
<div class="line"><a name="l02981"></a><span class="lineno"><a class="line" href="structfake__spell.html#a153859c297963129f423a8636f884798"> 2981</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="structfake__spell.html#a153859c297963129f423a8636f884798">fake_spell::is_valid</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    <span class="keywordflow">return</span> <span class="keywordtype">id</span>.is_valid() &amp;&amp; !<span class="keywordtype">id</span>.is_empty();</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;}</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160; </div>
<div class="line"><a name="l02986"></a><span class="lineno"><a class="line" href="structfake__spell.html#ac440226452aa226c3cf41da10d905760"> 2986</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structfake__spell.html#ac440226452aa226c3cf41da10d905760">fake_spell::load</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;jo )</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;{</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    <a class="code" href="overmap_8cpp.html#a1aa258a4b1427766c283c1ae9ea81f05ac5e3b9675d114c21ad3367d318f6aa95">mandatory</a>( jo, <span class="keyword">false</span>, <span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <span class="keyword">false</span>, <span class="stringliteral">&quot;hit_self&quot;</span>, <span class="keyword">self</span>, <a class="code" href="structfake__spell.html#a6c5ae8a2fbe530336f41d6a09530f561">self_default</a> );</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160; </div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <span class="keyword">false</span>, <span class="stringliteral">&quot;once_in&quot;</span>, <a class="code" href="structfake__spell.html#a0b3a2e1b616c1146f62625e2d577634f">trigger_once_in</a>, <a class="code" href="structfake__spell.html#a1c7c420c1d92ae415db6e26df163b1ec">trigger_once_in_default</a> );</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <span class="keyword">false</span>, <span class="stringliteral">&quot;message&quot;</span>, <a class="code" href="structfake__spell.html#a0e93c0553212a7274c94085f50e3228f">trigger_message</a> );</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <span class="keyword">false</span>, <span class="stringliteral">&quot;npc_message&quot;</span>, <a class="code" href="structfake__spell.html#afd432c043173deab21515ad5ae6123b0">npc_trigger_message</a> );</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    <span class="keywordtype">int</span> max_level_int;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <span class="keyword">false</span>, <span class="stringliteral">&quot;max_level&quot;</span>, max_level_int, -1 );</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    <span class="keywordflow">if</span>( max_level_int == -1 ) {</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        <a class="code" href="structfake__spell.html#a4a068f23f16e41a517d65d878a4aab85">max_level</a> = std::nullopt;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        <a class="code" href="structfake__spell.html#a4a068f23f16e41a517d65d878a4aab85">max_level</a> = max_level_int;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    }</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a>( jo, <span class="keyword">false</span>, <span class="stringliteral">&quot;min_level&quot;</span>, <a class="code" href="structfake__spell.html#a59f61e26f45fbd72f16081ee60b2489e">level</a>, <a class="code" href="structfake__spell.html#aa3e038ff6094f65acb5293dccff578c3">level_default</a> );</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="keywordflow">if</span>( jo.<a class="code" href="classJsonObject.html#ac8dd6467300eb62e7ce842c3d99c083e">has_string</a>( <span class="stringliteral">&quot;level&quot;</span> ) ) {</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;level member for fake_spell was renamed to min_level.  id: %s&quot;</span>, <span class="keywordtype">id</span>.c_str() );</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    }</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;}</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03007"></a><span class="lineno"><a class="line" href="structfake__spell.html#a08de9155c3fbea0b36ddec1d73a7d5a5"> 3007</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structfake__spell.html#a08de9155c3fbea0b36ddec1d73a7d5a5">fake_spell::serialize</a>( <a class="code" href="classJsonOut.html">JsonOut</a> &amp;json )<span class="keyword"> const</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    json.<a class="code" href="classJsonOut.html#a4756f9a569adbfc60de127f7c335d82f">start_object</a>();</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;hit_self&quot;</span>, <span class="keyword">self</span>, <a class="code" href="structfake__spell.html#a6c5ae8a2fbe530336f41d6a09530f561">self_default</a> );</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;once_in&quot;</span>, <a class="code" href="structfake__spell.html#a0b3a2e1b616c1146f62625e2d577634f">trigger_once_in</a>, <a class="code" href="structfake__spell.html#a1c7c420c1d92ae415db6e26df163b1ec">trigger_once_in_default</a> );</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;max_level&quot;</span>, <a class="code" href="structfake__spell.html#a4a068f23f16e41a517d65d878a4aab85">max_level</a>, <a class="code" href="structfake__spell.html#a351ade87eb87a5db164447a626d7aef7">max_level_default</a> );</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;min_level&quot;</span>, <a class="code" href="structfake__spell.html#a59f61e26f45fbd72f16081ee60b2489e">level</a>, <a class="code" href="structfake__spell.html#aa3e038ff6094f65acb5293dccff578c3">level_default</a> );</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    json.<a class="code" href="classJsonOut.html#aa38d37840ed6ba168b78a43570e98681">end_object</a>();</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;}</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160; </div>
<div class="line"><a name="l03018"></a><span class="lineno"><a class="line" href="structfake__spell.html#ae63f19b7f34a508df35ca402a31a0074"> 3018</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structfake__spell.html#ae63f19b7f34a508df35ca402a31a0074">fake_spell::deserialize</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;data )</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;{</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    <a class="code" href="structfake__spell.html#ac440226452aa226c3cf41da10d905760">load</a>( data );</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;}</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160; </div>
<div class="line"><a name="l03023"></a><span class="lineno"><a class="line" href="structfake__spell.html#ad4f9daba773dc6b7b96dcc256e9213ad"> 3023</a></span>&#160;<a class="code" href="classspell.html">spell</a> <a class="code" href="structfake__spell.html#ad449e7a0332db668ada8a54e392dad9d">fake_spell::get_spell</a>( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;caster, <span class="keywordtype">int</span> min_level_override )<span class="keyword"> const</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    <a class="code" href="classspell.html">spell</a> sp( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="comment">// the max level this spell will be. can be optionally limited</span></div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <span class="keywordtype">int</span> spell_max_level = sp.<a class="code" href="classspell.html#a8c41a03e09eb196bd6c59ff29f3f61c1">get_max_level</a>( caster );</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <span class="keywordtype">int</span> spell_limiter = <a class="code" href="structfake__spell.html#a4a068f23f16e41a517d65d878a4aab85">max_level</a> ? *<a class="code" href="structfake__spell.html#a4a068f23f16e41a517d65d878a4aab85">max_level</a> : spell_max_level;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="comment">// level is the minimum level the fake_spell will output</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    min_level_override = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( min_level_override, <a class="code" href="structfake__spell.html#a59f61e26f45fbd72f16081ee60b2489e">level</a> );</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <span class="keywordflow">if</span>( min_level_override &gt; spell_limiter ) {</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        <span class="comment">// this override is for min level, and does not override max level</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        <span class="keywordflow">if</span>( spell_limiter &lt;= 0 ) {</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;            spell_limiter = min_level_override;</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;            min_level_override = spell_limiter;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        }</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    <span class="comment">// make sure max level is not lower then min level</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    spell_limiter = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( min_level_override, spell_limiter );</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <span class="comment">// the &quot;level&quot; of the fake spell is the goal, but needs to be clamped to min and max</span></div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    <span class="keywordtype">int</span> level_of_spell = <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <a class="code" href="structfake__spell.html#a59f61e26f45fbd72f16081ee60b2489e">level</a>, min_level_override, spell_limiter );</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="structfake__spell.html#a59f61e26f45fbd72f16081ee60b2489e">level</a> &gt; spell_limiter ) {</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: fake spell %s has higher min_level than max_level&quot;</span>, <span class="keywordtype">id</span>.c_str() );</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        <span class="keywordflow">return</span> sp;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    }</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    sp.<a class="code" href="classspell.html#add2c742d2996e6c81ab5b70b081544d9">set_exp</a>( sp.<a class="code" href="classspell.html#ad4dff616ba1d80004e9da4b9858b54ea">exp_for_level</a>( level_of_spell ) );</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160; </div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <span class="keywordflow">return</span> sp;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;}</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160; </div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="comment">// intended for spells without casters</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"><a class="line" href="structfake__spell.html#ad449e7a0332db668ada8a54e392dad9d"> 3053</a></span>&#160;<a class="code" href="classspell.html">spell</a> <a class="code" href="structfake__spell.html#ad449e7a0332db668ada8a54e392dad9d">fake_spell::get_spell</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <a class="code" href="classspell.html">spell</a> sp( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    <span class="keywordflow">return</span> sp;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;}</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03059"></a><span class="lineno"><a class="line" href="classspell__events.html#a8ef5f1becd9e0cf9621dbbf3bcc53530"> 3059</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classspell__events.html#a1a45ec3d63bc6442e05b3a6dd01c6f84">spell_events::notify</a>( <span class="keyword">const</span> <a class="code" href="classcata_1_1event.html">cata::event</a> &amp;e )</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;{</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    <span class="keywordflow">switch</span>( e.<a class="code" href="classcata_1_1event.html#a9e08beef33202dccd82822d472e76b54">type</a>() ) {</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a15d9350620fdb06df8ad3d5410d8d54f">event_type::player_levels_spell</a>: {</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;            <a class="code" href="classstring__id.html">spell_id</a> sid = e.<a class="code" href="classcata_1_1event.html#aeb4ed5ec6fcf8aa230a630a967866cf8">get</a>&lt;<a class="code" href="classstring__id.html">spell_id</a>&gt;( <span class="stringliteral">&quot;spell&quot;</span> );</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;            <span class="keywordtype">int</span> slvl = e.<a class="code" href="classcata_1_1event.html#aeb4ed5ec6fcf8aa230a630a967866cf8">get</a>&lt;<span class="keywordtype">int</span>&gt;( <span class="stringliteral">&quot;new_level&quot;</span> );</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;            <a class="code" href="classspell__type.html">spell_type</a> spell_cast = <a class="code" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">spell_factory</a>.obj( sid );</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;            <span class="keywordflow">for</span>( std::map&lt;std::string, int&gt;::iterator it = spell_cast.learn_spells.begin();</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                 it != spell_cast.learn_spells.end(); ++it ) {</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                <span class="keywordtype">int</span> learn_at_level = it-&gt;second;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                <span class="keyword">const</span> std::string learn_spell_id = it-&gt;first;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                <span class="keywordflow">if</span>( learn_at_level &lt;= slvl &amp;&amp; !<a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;knows_spell( learn_spell_id ) ) {</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                    <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;learn_spell( learn_spell_id, <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() );</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                    <a class="code" href="classspell__type.html">spell_type</a> spell_learned = <a class="code" href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">spell_factory</a>.obj( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( learn_spell_id ) );</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                    <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>(</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;                        <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Your experience and knowledge in creating and manipulating magical energies to cast %s have opened your eyes to new possibilities, you can now cast %s.&quot;</span> ),</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;                        spell_cast.name,</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;                        spell_learned.<a class="code" href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">name</a> );</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                }</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;            }</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;        }</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160; </div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    }</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;}</div>
<div class="ttc" id="aavatar_8cpp_html_a75dcf1534079311161f26d7250306379"><div class="ttname"><a href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a></div><div class="ttdeci">std::unique_ptr&lt; talker &gt; get_talker_for(avatar &amp;me)</div><div class="ttdef"><b>Definition:</b> <a href="avatar_8cpp_source.html#l01795">avatar.cpp:1795</a></div></div>
<div class="ttc" id="aavatar_8h_html"><div class="ttname"><a href="avatar_8h.html">avatar.h</a></div></div>
<div class="ttc" id="abodypart_8h_html"><div class="ttname"><a href="bodypart_8h.html">bodypart.h</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_a4249b6f1d0842211bfe53e5f9e206a10"><div class="ttname"><a href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a></div><div class="ttdeci">time_duration rng(time_duration lo, time_duration hi)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00779">calendar.cpp:779</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_abf1cdb8f4662bf96c8d762e9229df8d9"><div class="ttname"><a href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">to_string</a></div><div class="ttdeci">std::string to_string(const time_duration &amp;d, const bool compact)</div><div class="ttdoc">Returns a string showing a duration.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00546">calendar.cpp:546</a></div></div>
<div class="ttc" id="acalendar_8h_html"><div class="ttname"><a href="calendar_8h.html">calendar.h</a></div></div>
<div class="ttc" id="acata__utility_8h_html"><div class="ttname"><a href="cata__utility_8h.html">cata_utility.h</a></div></div>
<div class="ttc" id="acata__utility_8h_html_ad22b4a043b6eb4c2c06f87f83b720b15"><div class="ttname"><a href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a></div><div class="ttdeci">constexpr T clamp(const T &amp;val, const T &amp;min, const T &amp;max)</div><div class="ttdoc">Clamp first argument so that it is no lower than second and no higher than third.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00221">cata_utility.h:221</a></div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a1e3f04102267eaf5e8d0ca424fd5c561"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a1e3f04102267eaf5e8d0ca424fd5c561">cata_variant_type::field_type_id</a></div><div class="ttdeci">@ field_type_id</div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">cata_variant_type::spell_id</a></div><div class="ttdeci">@ spell_id</div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4aabdee90f7518eedc26e713014acfcaca"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4aabdee90f7518eedc26e713014acfcaca">cata_variant_type::mtype_id</a></div><div class="ttdeci">@ mtype_id</div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4adcd89267470921c316111b454af6a02c"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4adcd89267470921c316111b454af6a02c">cata_variant_type::mongroup_id</a></div><div class="ttdeci">@ mongroup_id</div></div>
<div class="ttc" id="acatacharset_8cpp_html_a756b52a0bf9f4b63eadbe44da3e11a00"><div class="ttname"><a href="catacharset_8cpp.html#a756b52a0bf9f4b63eadbe44da3e11a00">left_justify</a></div><div class="ttdeci">std::string left_justify(const std::string &amp;str, const int width, const bool ignore_tags)</div><div class="ttdef"><b>Definition:</b> <a href="catacharset_8cpp_source.html#l00127">catacharset.cpp:127</a></div></div>
<div class="ttc" id="acatacharset_8cpp_html_af20ee33da59ccceb9f4c14005c0bbe80"><div class="ttname"><a href="catacharset_8cpp.html#af20ee33da59ccceb9f4c14005c0bbe80">utf8_width</a></div><div class="ttdeci">int utf8_width(const std::string_view s, const bool ignore_tags)</div><div class="ttdef"><b>Definition:</b> <a href="catacharset_8cpp_source.html#l00104">catacharset.cpp:104</a></div></div>
<div class="ttc" id="acatacharset_8h_html"><div class="ttname"><a href="catacharset_8h.html">catacharset.h</a></div></div>
<div class="ttc" id="acharacter_8h_html"><div class="ttname"><a href="character_8h.html">character.h</a></div></div>
<div class="ttc" id="acharacter_8h_html_abaafa6561de05c3b1324214e3048745a"><div class="ttname"><a href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a></div><div class="ttdeci">Character &amp; get_player_character()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13807">game.cpp:13807</a></div></div>
<div class="ttc" id="aclassCharacter_html"><div class="ttname"><a href="classCharacter.html">Character</a></div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00522">character.h:523</a></div></div>
<div class="ttc" id="aclassCharacter_html_a0bae97cba21daebf53484d06605e6529"><div class="ttname"><a href="classCharacter.html#a0bae97cba21daebf53484d06605e6529">Character::avg_encumb_of_limb_type</a></div><div class="ttdeci">int avg_encumb_of_limb_type(body_part_type::type part_type) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l04030">character.cpp:4030</a></div></div>
<div class="ttc" id="aclassCharacter_html_a0ffe14df559cee6e9b5d02f5b214d009"><div class="ttname"><a href="classCharacter.html#a0ffe14df559cee6e9b5d02f5b214d009">Character::get_stamina</a></div><div class="ttdeci">int get_stamina() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l06806">character.cpp:6806</a></div></div>
<div class="ttc" id="aclassCharacter_html_a15520bb61b6da84f9bd753fa43dcbabc"><div class="ttname"><a href="classCharacter.html#a15520bb61b6da84f9bd753fa43dcbabc">Character::last_target</a></div><div class="ttdeci">weak_ptr_fast&lt; Creature &gt; last_target</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02761">character.h:2761</a></div></div>
<div class="ttc" id="aclassCharacter_html_a15e400d8098702465a58e5ff71ad734f"><div class="ttname"><a href="classCharacter.html#a15e400d8098702465a58e5ff71ad734f">Character::select_item_component</a></div><div class="ttdeci">comp_selection&lt; item_comp &gt; select_item_component(const std::vector&lt; item_comp &gt; &amp;components, int batch, read_only_visitable &amp;map_inv, bool can_cancel=false, const std::function&lt; bool(const item &amp;)&gt; &amp;filter=return_true&lt; item &gt;, bool player_inv=true, bool npc_query=false, const recipe *rec=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="crafting_8cpp_source.html#l01746">crafting.cpp:1746</a></div></div>
<div class="ttc" id="aclassCharacter_html_a18fed39d4de0f6d75af204da88833098"><div class="ttname"><a href="classCharacter.html#a18fed39d4de0f6d75af204da88833098">Character::calculate_by_enchantment</a></div><div class="ttdeci">double calculate_by_enchantment(double modify, enchant_vals::mod value, bool round_output=false) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l07807">character.cpp:7807</a></div></div>
<div class="ttc" id="aclassCharacter_html_a1e1996b6d6fc0a86d917cd155e1656d8"><div class="ttname"><a href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">Character::disp_name</a></div><div class="ttdeci">std::string disp_name(bool possessive=false, bool capitalize_first=false) const override</div><div class="ttdoc">Returns either &quot;you&quot; or the player's name.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00829">character.cpp:829</a></div></div>
<div class="ttc" id="aclassCharacter_html_a33d0aa99b607cfbe38b910d4dd6b0b1b"><div class="ttname"><a href="classCharacter.html#a33d0aa99b607cfbe38b910d4dd6b0b1b">Character::consume_tools</a></div><div class="ttdeci">void consume_tools(const comp_selection&lt; tool_comp &gt; &amp;tool, int batch)</div><div class="ttdef"><b>Definition:</b> <a href="crafting_8cpp_source.html#l02400">crafting.cpp:2400</a></div></div>
<div class="ttc" id="aclassCharacter_html_a4609d68fa1977aefed931d2a51afa52b"><div class="ttname"><a href="classCharacter.html#a4609d68fa1977aefed931d2a51afa52b">Character::on_mutation_gain</a></div><div class="ttdeci">void on_mutation_gain(const trait_id &amp;mid)</div><div class="ttdoc">Called when a mutation is gained.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10010">character.cpp:10010</a></div></div>
<div class="ttc" id="aclassCharacter_html_a47b6d8827b1199e069ec04280c5adafb"><div class="ttname"><a href="classCharacter.html#a47b6d8827b1199e069ec04280c5adafb">Character::spells_known_of_class</a></div><div class="ttdeci">std::vector&lt; spell &gt; spells_known_of_class(const trait_id &amp;spell_class) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02262">magic.cpp:2262</a></div></div>
<div class="ttc" id="aclassCharacter_html_a588d5cc1d729490552fe03b006685ae5"><div class="ttname"><a href="classCharacter.html#a588d5cc1d729490552fe03b006685ae5">Character::get_int</a></div><div class="ttdeci">int get_int() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l04139">character.cpp:4139</a></div></div>
<div class="ttc" id="aclassCharacter_html_a5d161e8df8122b5f3d74a081ee8d12cf"><div class="ttname"><a href="classCharacter.html#a5d161e8df8122b5f3d74a081ee8d12cf">Character::consume_items</a></div><div class="ttdeci">std::list&lt; item &gt; consume_items(const comp_selection&lt; item_comp &gt; &amp;is, int batch, const std::function&lt; bool(const item &amp;)&gt; &amp;filter=return_true&lt; item &gt;, bool select_ind=false)</div><div class="ttdef"><b>Definition:</b> <a href="crafting_8cpp_source.html#l02029">crafting.cpp:2029</a></div></div>
<div class="ttc" id="aclassCharacter_html_a6718828920830004d1c3e0dc847fc683"><div class="ttname"><a href="classCharacter.html#a6718828920830004d1c3e0dc847fc683">Character::get_focus</a></div><div class="ttdeci">int get_focus() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02745">character.h:2745</a></div></div>
<div class="ttc" id="aclassCharacter_html_a809f85bef6731c16373600ad9f97dad7"><div class="ttname"><a href="classCharacter.html#a809f85bef6731c16373600ad9f97dad7">Character::has_opposite_trait</a></div><div class="ttdeci">bool has_opposite_trait(const trait_id &amp;flag) const</div><div class="ttdoc">Returns true if the player has a trait which cancels the entered trait.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10039">character.cpp:10039</a></div></div>
<div class="ttc" id="aclassCharacter_html_a860d40c9c27d0d12490c014cba63c598"><div class="ttname"><a href="classCharacter.html#a860d40c9c27d0d12490c014cba63c598">Character::select_tool_component</a></div><div class="ttdeci">comp_selection&lt; tool_comp &gt; select_tool_component(const std::vector&lt; tool_comp &gt; &amp;tools, int batch, read_only_visitable &amp;map_inv, bool can_cancel=false, bool player_inv=true, bool npc_query=false, const std::function&lt; int(int)&gt; &amp;charges_required_modifier=[](int i) { return i;})</div><div class="ttdef"><b>Definition:</b> <a href="crafting_8cpp_source.html#l02173">crafting.cpp:2173</a></div></div>
<div class="ttc" id="aclassCharacter_html_a906192bd3a5f29a61ee12695e18d2eb5"><div class="ttname"><a href="classCharacter.html#a906192bd3a5f29a61ee12695e18d2eb5">Character::sees</a></div><div class="ttdeci">bool sees(const tripoint &amp;t, bool is_avatar=false, int range_mod=0) const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l11397">character.cpp:11397</a></div></div>
<div class="ttc" id="aclassCharacter_html_a9256aa3e6577c96e4a19eb23d8810ca6"><div class="ttname"><a href="classCharacter.html#a9256aa3e6577c96e4a19eb23d8810ca6">Character::set_mutation</a></div><div class="ttdeci">void set_mutation(const trait_id &amp;, const mutation_variant *=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8cpp_source.html#l00283">mutation.cpp:283</a></div></div>
<div class="ttc" id="aclassCharacter_html_a93a3570e884214ba5c0eb3cdf1af75cc"><div class="ttname"><a href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">Character::get_skill_level</a></div><div class="ttdeci">float get_skill_level(const skill_id &amp;ident) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03428">character.cpp:3428</a></div></div>
<div class="ttc" id="aclassCharacter_html_a9511a04100db12858069c5fd802fa77e"><div class="ttname"><a href="classCharacter.html#a9511a04100db12858069c5fd802fa77e">Character::has_weapon</a></div><div class="ttdeci">bool has_weapon() const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l11331">character.cpp:11331</a></div></div>
<div class="ttc" id="aclassCharacter_html_aa9a4335ab1fd0d975199750b1ebf5bef"><div class="ttname"><a href="classCharacter.html#aa9a4335ab1fd0d975199750b1ebf5bef">Character::get_wielded_item</a></div><div class="ttdeci">item_location get_wielded_item() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00674">character.cpp:674</a></div></div>
<div class="ttc" id="aclassCharacter_html_aaaec0279242f05b51af5c8b7bb416bb1"><div class="ttname"><a href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">Character::has_flag</a></div><div class="ttdeci">bool has_flag(const json_character_flag &amp;flag) const</div><div class="ttdoc">Returns true if player has a trait, bionic, effect, bodypart, or martial arts buff with a flag.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l11967">character.cpp:11967</a></div></div>
<div class="ttc" id="aclassCharacter_html_aaef69a97be3cf8ddca64a0174467a86c"><div class="ttname"><a href="classCharacter.html#aaef69a97be3cf8ddca64a0174467a86c">Character::adjust_for_focus</a></div><div class="ttdeci">float adjust_for_focus(float amount) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10062">character.cpp:10062</a></div></div>
<div class="ttc" id="aclassCharacter_html_ac81e06f5fbbb42c673f235a6f37d9d4b"><div class="ttname"><a href="classCharacter.html#ac81e06f5fbbb42c673f235a6f37d9d4b">Character::add_msg_player_or_npc</a></div><div class="ttdeci">void add_msg_player_or_npc(const std::string &amp;player_msg, const std::string &amp;npc_str) const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00861">character.cpp:861</a></div></div>
<div class="ttc" id="aclassCharacter_html_ace218285f4fbc7c7a9feac8378bc632e"><div class="ttname"><a href="classCharacter.html#ace218285f4fbc7c7a9feac8378bc632e">Character::crafting_inventory</a></div><div class="ttdeci">const inventory &amp; crafting_inventory(bool clear_path) const</div><div class="ttdef"><b>Definition:</b> <a href="crafting_8cpp_source.html#l00629">crafting.cpp:629</a></div></div>
<div class="ttc" id="aclassCharacter_html_adb54bdcb284abb66b6be99c8ae225065"><div class="ttname"><a href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">Character::getID</a></div><div class="ttdeci">character_id getID() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00652">character.cpp:652</a></div></div>
<div class="ttc" id="aclassCharacter_html_add22510ff2fa20a662868b4dd86e030e"><div class="ttname"><a href="classCharacter.html#add22510ff2fa20a662868b4dd86e030e">Character::get_power_level</a></div><div class="ttdeci">units::energy get_power_level() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l02824">character.cpp:2824</a></div></div>
<div class="ttc" id="aclassCharacter_html_add870e576ff59aa6943af286576219e9"><div class="ttname"><a href="classCharacter.html#add870e576ff59aa6943af286576219e9">Character::enchantment_cache</a></div><div class="ttdeci">pimpl&lt; enchant_cache &gt; enchantment_cache</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l04105">character.h:4105</a></div></div>
<div class="ttc" id="aclassCharacter_html_ae7a558a2455f552673b825e3ad2e0fd4"><div class="ttname"><a href="classCharacter.html#ae7a558a2455f552673b825e3ad2e0fd4">Character::healall</a></div><div class="ttdeci">void healall(int dam)</div><div class="ttdoc">Heals all body parts for dam.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l08427">character.cpp:8427</a></div></div>
<div class="ttc" id="aclassCharacter_html_aefe5432750eb1c2c65fea628fd9878a7"><div class="ttname"><a href="classCharacter.html#aefe5432750eb1c2c65fea628fd9878a7">Character::get_stamina_max</a></div><div class="ttdeci">int get_stamina_max() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l06815">character.cpp:6815</a></div></div>
<div class="ttc" id="aclassCharacter_html_af0503012f1ff927cbb5ad126e39cb103"><div class="ttname"><a href="classCharacter.html#af0503012f1ff927cbb5ad126e39cb103">Character::add_msg_if_player</a></div><div class="ttdeci">void add_msg_if_player(const std::string &amp;msg) const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00856">character.cpp:856</a></div></div>
<div class="ttc" id="aclassCharacter_html_af06dd97724f4f05df782e7a4b4f9cfe1"><div class="ttname"><a href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">Character::has_trait</a></div><div class="ttdeci">bool has_trait(const trait_id &amp;b) const override</div><div class="ttdoc">Returns true if the player has the entered trait.</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8cpp_source.html#l00111">mutation.cpp:111</a></div></div>
<div class="ttc" id="aclassCharacter_html_af2ff32cce5f17bcf04be958121abe524"><div class="ttname"><a href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">Character::magic</a></div><div class="ttdeci">pimpl&lt; known_magic &gt; magic</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02485">character.h:2485</a></div></div>
<div class="ttc" id="aclassCreature_html"><div class="ttname"><a href="classCreature.html">Creature</a></div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00250">creature.h:251</a></div></div>
<div class="ttc" id="aclassCreature_html_a1a65722d07102550f16d17ebd79e2743"><div class="ttname"><a href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">Creature::pos</a></div><div class="ttdeci">tripoint pos() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00178">creature.cpp:178</a></div></div>
<div class="ttc" id="aclassCreature_html_a3efb920d8e3d22ee766b62012ad0f9cd"><div class="ttname"><a href="classCreature.html#a3efb920d8e3d22ee766b62012ad0f9cd">Creature::as_avatar</a></div><div class="ttdeci">virtual avatar * as_avatar()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00280">creature.h:280</a></div></div>
<div class="ttc" id="aclassCreature_html_a55d12f92d62a7c89c44b466d7e7cb00d"><div class="ttname"><a href="classCreature.html#a55d12f92d62a7c89c44b466d7e7cb00d">Creature::as_character</a></div><div class="ttdeci">virtual Character * as_character()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00274">creature.h:274</a></div></div>
<div class="ttc" id="aclassCreature_html_a5de5f5e0d08deb03b68749608eb360b2"><div class="ttname"><a href="classCreature.html#a5de5f5e0d08deb03b68749608eb360b2">Creature::as_npc</a></div><div class="ttdeci">virtual npc * as_npc()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00286">creature.h:286</a></div></div>
<div class="ttc" id="aclassCreature_html_a6e1819fd37a50af66566c6d1b896572a"><div class="ttname"><a href="classCreature.html#a6e1819fd37a50af66566c6d1b896572a">Creature::get_hp_max</a></div><div class="ttdeci">virtual int get_hp_max(const bodypart_id &amp;bp) const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l02765">creature.cpp:2765</a></div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217">Creature::Attitude</a></div><div class="ttdeci">Attitude</div><div class="ttdoc">Simplified attitude towards any creature: hostile - hate, want to kill, etc.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00352">creature.h:352</a></div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Creature::Attitude::FRIENDLY</a></div><div class="ttdeci">@ FRIENDLY</div></div>
<div class="ttc" id="aclassCreature_html_a91dc4715c36eef7d116f944be9a4d435"><div class="ttname"><a href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">Creature::add_msg_if_player</a></div><div class="ttdeci">virtual void add_msg_if_player(const std::string &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00976">creature.h:976</a></div></div>
<div class="ttc" id="aclassCreature_html_ac209d32cbfd3774af3d5c0500e2fae52"><div class="ttname"><a href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">Creature::is_avatar</a></div><div class="ttdeci">virtual bool is_avatar() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00265">creature.h:265</a></div></div>
<div class="ttc" id="aclassCreature_html_ac4dbde454c86b3296f53681c60612974"><div class="ttname"><a href="classCreature.html#ac4dbde454c86b3296f53681c60612974">Creature::get_body</a></div><div class="ttdeci">const std::map&lt; bodypart_str_id, bodypart &gt; &amp; get_body() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l02167">creature.cpp:2167</a></div></div>
<div class="ttc" id="aclassCreature_html_aed84fe52e1335d48d53f482f8a278c87"><div class="ttname"><a href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">Creature::is_npc</a></div><div class="ttdeci">virtual bool is_npc() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00268">creature.h:268</a></div></div>
<div class="ttc" id="aclassJsonMember_html"><div class="ttname"><a href="classJsonMember.html">JsonMember</a></div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00501">flexbuffer_json.h:502</a></div></div>
<div class="ttc" id="aclassJsonObject_html"><div class="ttname"><a href="classJsonObject.html">JsonObject</a></div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00526">flexbuffer_json.h:527</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a1abb3808bb2a992716d5ef6f27a32b3c"><div class="ttname"><a href="classJsonObject.html#a1abb3808bb2a992716d5ef6f27a32b3c">JsonObject::get_string</a></div><div class="ttdeci">std::string get_string(const std::string &amp;key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00813">flexbuffer_json-inl.h:813</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a332ecdfbbcefd21204fad5e03ff43735"><div class="ttname"><a href="classJsonObject.html#a332ecdfbbcefd21204fad5e03ff43735">JsonObject::get_string_array</a></div><div class="ttdeci">std::vector&lt; std::string &gt; get_string_array(std::string_view name) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00919">flexbuffer_json-inl.h:919</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a3b9722313d9692826235c87e73e94f04"><div class="ttname"><a href="classJsonObject.html#a3b9722313d9692826235c87e73e94f04">JsonObject::get_object</a></div><div class="ttdeci">JsonObject get_object(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00864">flexbuffer_json-inl.h:864</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a4d917fcb285203f91b74002565375dce"><div class="ttname"><a href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">JsonObject::has_array</a></div><div class="ttdeci">bool has_array(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00984">flexbuffer_json-inl.h:984</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a619cb4eae7922f357db47479fc71cf9b"><div class="ttname"><a href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">JsonObject::has_member</a></div><div class="ttdeci">bool has_member(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00944">flexbuffer_json-inl.h:944</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a8517ac783372bd0bf149ab8e5f7aae18"><div class="ttname"><a href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">JsonObject::read</a></div><div class="ttdeci">bool read(std::string_view name, T &amp;t, bool throw_on_error=true) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l01059">flexbuffer_json-inl.h:1059</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a88142edb1dd9ea1e7a96c7a99cd70896"><div class="ttname"><a href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">JsonObject::get_array</a></div><div class="ttdeci">JsonArray get_array(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00855">flexbuffer_json-inl.h:855</a></div></div>
<div class="ttc" id="aclassJsonObject_html_ac8dd6467300eb62e7ce842c3d99c083e"><div class="ttname"><a href="classJsonObject.html#ac8dd6467300eb62e7ce842c3d99c083e">JsonObject::has_string</a></div><div class="ttdeci">bool has_string(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00972">flexbuffer_json-inl.h:972</a></div></div>
<div class="ttc" id="aclassJsonOut_html"><div class="ttname"><a href="classJsonOut.html">JsonOut</a></div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l00735">json.h:736</a></div></div>
<div class="ttc" id="aclassJsonOut_html_a44cdd853d4c6913b37caa9f0131eeff2"><div class="ttname"><a href="classJsonOut.html#a44cdd853d4c6913b37caa9f0131eeff2">JsonOut::end_array</a></div><div class="ttdeci">void end_array()</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02346">json.cpp:2346</a></div></div>
<div class="ttc" id="aclassJsonOut_html_a4550e2036b904c4d4a90e440dd41c684"><div class="ttname"><a href="classJsonOut.html#a4550e2036b904c4d4a90e440dd41c684">JsonOut::start_array</a></div><div class="ttdeci">void start_array(bool wrap=false)</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02335">json.cpp:2335</a></div></div>
<div class="ttc" id="aclassJsonOut_html_a4756f9a569adbfc60de127f7c335d82f"><div class="ttname"><a href="classJsonOut.html#a4756f9a569adbfc60de127f7c335d82f">JsonOut::start_object</a></div><div class="ttdeci">void start_object(bool wrap=false)</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02316">json.cpp:2316</a></div></div>
<div class="ttc" id="aclassJsonOut_html_aa38d37840ed6ba168b78a43570e98681"><div class="ttname"><a href="classJsonOut.html#aa38d37840ed6ba168b78a43570e98681">JsonOut::end_object</a></div><div class="ttdeci">void end_object()</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02327">json.cpp:2327</a></div></div>
<div class="ttc" id="aclassJsonOut_html_afb935698620b87ff71b01e7763004de1"><div class="ttname"><a href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">JsonOut::member</a></div><div class="ttdeci">void member(std::string_view name)</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02422">json.cpp:2422</a></div></div>
<div class="ttc" id="aclassMonsterGroupManager_html_a63d2845bca04e530ec8efb366c3725b6"><div class="ttname"><a href="classMonsterGroupManager.html#a63d2845bca04e530ec8efb366c3725b6">MonsterGroupManager::isValidMonsterGroup</a></div><div class="ttdeci">static bool isValidMonsterGroup(const mongroup_id &amp;group)</div><div class="ttdef"><b>Definition:</b> <a href="mongroup_8cpp_source.html#l00350">mongroup.cpp:350</a></div></div>
<div class="ttc" id="aclassavatar_html"><div class="ttname"><a href="classavatar.html">avatar</a></div><div class="ttdef"><b>Definition:</b> <a href="avatar_8h_source.html#l00083">avatar.h:84</a></div></div>
<div class="ttc" id="aclassbody__part__set_html_a9eea3a88425e1aaf2d3e9ebf87c2e976"><div class="ttname"><a href="classbody__part__set.html#a9eea3a88425e1aaf2d3e9ebf87c2e976">body_part_set::none</a></div><div class="ttdeci">bool none() const</div><div class="ttdef"><b>Definition:</b> <a href="body__part__set_8h_source.html#l00046">body_part_set.h:46</a></div></div>
<div class="ttc" id="aclassbody__part__set_html_ac4e5ce7eea67f44279a4db416a7903cd"><div class="ttname"><a href="classbody__part__set.html#ac4e5ce7eea67f44279a4db416a7903cd">body_part_set::test</a></div><div class="ttdeci">bool test(const bodypart_str_id &amp;bp) const</div><div class="ttdef"><b>Definition:</b> <a href="body__part__set_8h_source.html#l00034">body_part_set.h:34</a></div></div>
<div class="ttc" id="aclasscata_1_1event_html"><div class="ttname"><a href="classcata_1_1event.html">cata::event</a></div><div class="ttdef"><b>Definition:</b> <a href="event_8h_source.html#l00923">event.h:924</a></div></div>
<div class="ttc" id="aclasscata_1_1event_html_a9e08beef33202dccd82822d472e76b54"><div class="ttname"><a href="classcata_1_1event.html#a9e08beef33202dccd82822d472e76b54">cata::event::type</a></div><div class="ttdeci">event_type type() const</div><div class="ttdef"><b>Definition:</b> <a href="event_8h_source.html#l00960">event.h:960</a></div></div>
<div class="ttc" id="aclasscata_1_1event_html_aeb4ed5ec6fcf8aa230a630a967866cf8"><div class="ttname"><a href="classcata_1_1event.html#aeb4ed5ec6fcf8aa230a630a967866cf8">cata::event::get</a></div><div class="ttdeci">auto get(const std::string &amp;key) const</div><div class="ttdef"><b>Definition:</b> <a href="event_8h_source.html#l00971">event.h:971</a></div></div>
<div class="ttc" id="aclasscatacurses_1_1window_html"><div class="ttname"><a href="classcatacurses_1_1window.html">catacurses::window</a></div><div class="ttdoc">A wrapper over a pointer to a curses window.</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00054">cursesdef.h:55</a></div></div>
<div class="ttc" id="aclasscharacter__id_html"><div class="ttname"><a href="classcharacter__id.html">character_id</a></div><div class="ttdef"><b>Definition:</b> <a href="character__id_8h_source.html#l00009">character_id.h:10</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html"><div class="ttname"><a href="classcreature__tracker.html">creature_tracker</a></div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8h_source.html#l00024">creature_tracker.h:25</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html_aba3c6663688bcd1806ea685d6961cb72"><div class="ttname"><a href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_tracker::creature_at</a></div><div class="ttdeci">T * creature_at(const tripoint &amp;p, bool allow_hallucination=false)</div><div class="ttdoc">Returns the Creature at the given location.</div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8cpp_source.html#l00303">creature_tracker.cpp:303</a></div></div>
<div class="ttc" id="aclassdamage__over__time__data_html"><div class="ttname"><a href="classdamage__over__time__data.html">damage_over_time_data</a></div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00177">damage.h:178</a></div></div>
<div class="ttc" id="aclasseffect_html"><div class="ttname"><a href="classeffect.html">effect</a></div><div class="ttdef"><b>Definition:</b> <a href="effect_8h_source.html#l00260">effect.h:261</a></div></div>
<div class="ttc" id="aclassenum__bitset_html"><div class="ttname"><a href="classenum__bitset.html">enum_bitset&lt; spell_target &gt;</a></div></div>
<div class="ttc" id="aclassenum__bitset_html_a4817796a50f9f258865e0413ff1f91f9"><div class="ttname"><a href="classenum__bitset.html#a4817796a50f9f258865e0413ff1f91f9">enum_bitset::set</a></div><div class="ttdeci">enum_bitset &amp; set(E e, bool val=true)</div><div class="ttdef"><b>Definition:</b> <a href="enum__bitset_8h_source.html#l00048">enum_bitset.h:48</a></div></div>
<div class="ttc" id="aclassenum__flags__reader_html"><div class="ttname"><a href="classenum__flags__reader.html">enum_flags_reader</a></div><div class="ttdoc">Uses io::string_to_enum to convert the string from JSON to a C++ enum.</div><div class="ttdef"><b>Definition:</b> <a href="generic__factory_8h_source.html#l01293">generic_factory.h:1294</a></div></div>
<div class="ttc" id="aclassevent__bus_html_ab753616a3a663185377ac52560068194"><div class="ttname"><a href="classevent__bus.html#ab753616a3a663185377ac52560068194">event_bus::send</a></div><div class="ttdeci">void send(const cata::event &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="event__bus_8cpp_source.html#l00072">event_bus.cpp:72</a></div></div>
<div class="ttc" id="aclassfield__entry_html"><div class="ttname"><a href="classfield__entry.html">field_entry</a></div><div class="ttdoc">An active or passive effect existing on a tile.</div><div class="ttdef"><b>Definition:</b> <a href="field_8h_source.html#l00020">field.h:21</a></div></div>
<div class="ttc" id="aclassfield_html"><div class="ttname"><a href="classfield.html">field</a></div><div class="ttdoc">A variable sized collection of field entries on a given map square.</div><div class="ttdef"><b>Definition:</b> <a href="field_8h_source.html#l00106">field.h:107</a></div></div>
<div class="ttc" id="aclassgeneric__factory_html"><div class="ttname"><a href="classgeneric__factory.html">generic_factory</a></div><div class="ttdef"><b>Definition:</b> <a href="generic__factory_8h_source.html#l00119">generic_factory.h:120</a></div></div>
<div class="ttc" id="aclassinput__context_html"><div class="ttname"><a href="classinput__context.html">input_context</a></div><div class="ttdoc">Represents a context in which a set of actions can be performed.</div><div class="ttdef"><b>Definition:</b> <a href="input__context_8h_source.html#l00039">input_context.h:40</a></div></div>
<div class="ttc" id="aclassinput__context_html_a5f99b201990b09a6809f183a9cee5ab6"><div class="ttname"><a href="classinput__context.html#a5f99b201990b09a6809f183a9cee5ab6">input_context::input_to_action</a></div><div class="ttdeci">const std::string &amp; input_to_action(const input_event &amp;inp) const</div><div class="ttdef"><b>Definition:</b> <a href="input__context_8cpp_source.html#l00138">input_context.cpp:138</a></div></div>
<div class="ttc" id="aclassinventory_html"><div class="ttname"><a href="classinventory.html">inventory</a></div><div class="ttdef"><b>Definition:</b> <a href="inventory_8h_source.html#l00107">inventory.h:108</a></div></div>
<div class="ttc" id="aclassinventory_html_a31bf20ee0144627b5fba528b81559bc6"><div class="ttname"><a href="classinventory.html#a31bf20ee0144627b5fba528b81559bc6">inventory::form_from_map</a></div><div class="ttdeci">void form_from_map(const tripoint &amp;origin, int range, const Character *pl=nullptr, bool assign_invlet=true, bool clear_path=true)</div><div class="ttdef"><b>Definition:</b> <a href="inventory_8cpp_source.html#l00483">inventory.cpp:483</a></div></div>
<div class="ttc" id="aclassinvlet__wrapper_html_a7c0b7eaf67cf02bae041ada17aa1f71d"><div class="ttname"><a href="classinvlet__wrapper.html#a7c0b7eaf67cf02bae041ada17aa1f71d">invlet_wrapper::valid</a></div><div class="ttdeci">bool valid(int invlet) const</div><div class="ttdef"><b>Definition:</b> <a href="inventory_8cpp_source.html#l00059">inventory.cpp:59</a></div></div>
<div class="ttc" id="aclassitem_html_a438855ffd52d33307e1dfba6d607535b"><div class="ttname"><a href="classitem.html#a438855ffd52d33307e1dfba6d607535b">item::nname</a></div><div class="ttdeci">static std::string nname(const itype_id &amp;id, unsigned int quantity=1)</div><div class="ttdoc">Returns the translated item name for the item with given id.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l14557">item.cpp:14557</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a01400dc46a0d3fd5ee23bc8be16f0a55"><div class="ttname"><a href="classknown__magic.html#a01400dc46a0d3fd5ee23bc8be16f0a55">known_magic::is_favorite</a></div><div class="ttdeci">bool is_favorite(const spell_id &amp;sp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02702">magic.cpp:2702</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a0373cb48f63ed992b40057b8e30d7e7c"><div class="ttname"><a href="classknown__magic.html#a0373cb48f63ed992b40057b8e30d7e7c">known_magic::clear_opens_spellbook_data</a></div><div class="ttdeci">void clear_opens_spellbook_data()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02209">magic.cpp:2209</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a0bb52cad9c545b82cd57eb1d45dc09a0"><div class="ttname"><a href="classknown__magic.html#a0bb52cad9c545b82cd57eb1d45dc09a0">known_magic::toggle_favorite</a></div><div class="ttdeci">void toggle_favorite(const spell_id &amp;sp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02693">magic.cpp:2693</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a1dafae5436ced5d37e293d92c1bacd57"><div class="ttname"><a href="classknown__magic.html#a1dafae5436ced5d37e293d92c1bacd57">known_magic::caster_level_adjustment_by_school</a></div><div class="ttdeci">std::map&lt; trait_id, double &gt; caster_level_adjustment_by_school</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00714">magic.h:714</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a2e2bc1600c4888fb87cc14508f0111c3"><div class="ttname"><a href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">known_magic::mana_base</a></div><div class="ttdeci">int mana_base</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00655">magic.h:655</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a2e9d576a3710bfe2534471e630df5bb7"><div class="ttname"><a href="classknown__magic.html#a2e9d576a3710bfe2534471e630df5bb7">known_magic::known_magic</a></div><div class="ttdeci">known_magic()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01917">magic.cpp:1917</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a39b5a4fcc441be1ebdaba7bcbb22fffa"><div class="ttname"><a href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">known_magic::learn_spell</a></div><div class="ttdeci">void learn_spell(const std::string &amp;sp, Character &amp;guy, bool force=false)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01977">magic.cpp:1977</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a3ec46640014cc1ea785a7db001203b37"><div class="ttname"><a href="classknown__magic.html#a3ec46640014cc1ea785a7db001203b37">known_magic::time_to_learn_spell</a></div><div class="ttdeci">int time_to_learn_spell(const Character &amp;guy, const spell_id &amp;sp) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02244">magic.cpp:2244</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a3f18d965190b820f8b2b91170a899580"><div class="ttname"><a href="classknown__magic.html#a3f18d965190b820f8b2b91170a899580">known_magic::update_mana</a></div><div class="ttdeci">void update_mana(const Character &amp;guy, float turns)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02165">magic.cpp:2165</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a51f338d00a8e83a453e33766b5a05bd6"><div class="ttname"><a href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6">known_magic::forget_spell</a></div><div class="ttdeci">void forget_spell(const std::string &amp;sp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02042">magic.cpp:2042</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a67d5ecb476afb7f4a131ee82f223e44e"><div class="ttname"><a href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">known_magic::knows_spell</a></div><div class="ttdeci">bool knows_spell() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01972">magic.cpp:1972</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a7545cd34ae575060a438e9a6486762e6"><div class="ttname"><a href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">known_magic::mana</a></div><div class="ttdeci">int mana</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00657">magic.h:657</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a800de0f2bcb32e309629216f85456e31"><div class="ttname"><a href="classknown__magic.html#a800de0f2bcb32e309629216f85456e31">known_magic::set_spell_level</a></div><div class="ttdeci">void set_spell_level(const spell_id &amp;, int, const Character *)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02059">magic.cpp:2059</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a8492a7babf0a12769b76bff2e61e0098"><div class="ttname"><a href="classknown__magic.html#a8492a7babf0a12769b76bff2e61e0098">known_magic::on_mutation_loss</a></div><div class="ttdeci">void on_mutation_loss(const trait_id &amp;mid)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02828">magic.cpp:2828</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a86c3dca5ebcd118303a6be29a38a73ea"><div class="ttname"><a href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">known_magic::get_spell</a></div><div class="ttdeci">spell &amp; get_spell(const spell_id &amp;sp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02117">magic.cpp:2117</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a8ec7fa9b848fb3e139f1b9d7b6f4cb40"><div class="ttname"><a href="classknown__magic.html#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">known_magic::caster_level_adjustment_by_spell</a></div><div class="ttdeci">std::map&lt; spell_id, double &gt; caster_level_adjustment_by_spell</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00713">magic.h:713</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a8feaad1d7a7ecbb054556ef48e4599c6"><div class="ttname"><a href="classknown__magic.html#a8feaad1d7a7ecbb054556ef48e4599c6">known_magic::casting_ignore</a></div><div class="ttdeci">bool casting_ignore</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00661">magic.h:661</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a90fcfdbfe3d0dd04780ff2d8e672a1ef"><div class="ttname"><a href="classknown__magic.html#a90fcfdbfe3d0dd04780ff2d8e672a1ef">known_magic::set_spell_exp</a></div><div class="ttdeci">void set_spell_exp(const spell_id &amp;, int, const Character *)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02079">magic.cpp:2079</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a92c16301084172b5bd459c257af9c002"><div class="ttname"><a href="classknown__magic.html#a92c16301084172b5bd459c257af9c002">known_magic::get_invlet</a></div><div class="ttdeci">int get_invlet(const spell_id &amp;sp, std::set&lt; int &gt; &amp;used_invlets)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02707">magic.cpp:2707</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a9438df7eceda90e40f98f3d6a1f38147"><div class="ttname"><a href="classknown__magic.html#a9438df7eceda90e40f98f3d6a1f38147">known_magic::deserialize</a></div><div class="ttdeci">void deserialize(const JsonObject &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01944">magic.cpp:1944</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a98a91b2ff64d726c4d54f04a3fee000e"><div class="ttname"><a href="classknown__magic.html#a98a91b2ff64d726c4d54f04a3fee000e">known_magic::select_spell</a></div><div class="ttdeci">int select_spell(Character &amp;guy)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02737">magic.cpp:2737</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a9c29f4c065729517316b825e410641df"><div class="ttname"><a href="classknown__magic.html#a9c29f4c065729517316b825e410641df">known_magic::rem_invlet</a></div><div class="ttdeci">void rem_invlet(const spell_id &amp;sp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02688">magic.cpp:2688</a></div></div>
<div class="ttc" id="aclassknown__magic_html_aadc9db2d8635c2b6e6e28f14bf689cd1"><div class="ttname"><a href="classknown__magic.html#aadc9db2d8635c2b6e6e28f14bf689cd1">known_magic::on_mutation_gain</a></div><div class="ttdeci">void on_mutation_gain(const trait_id &amp;mid, Character &amp;guy)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02817">magic.cpp:2817</a></div></div>
<div class="ttc" id="aclassknown__magic_html_ab05f99ea584c7bec9ab34369e14369f0"><div class="ttname"><a href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">known_magic::spells</a></div><div class="ttdeci">std::vector&lt; spell_id &gt; spells() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02174">magic.cpp:2174</a></div></div>
<div class="ttc" id="aclassknown__magic_html_ab9085db0eed27ce45061cdc575ea9b6e"><div class="ttname"><a href="classknown__magic.html#ab9085db0eed27ce45061cdc575ea9b6e">known_magic::evaluate_opens_spellbook_data</a></div><div class="ttdeci">void evaluate_opens_spellbook_data()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02219">magic.cpp:2219</a></div></div>
<div class="ttc" id="aclassknown__magic_html_aba521f548900ab333a4b13884baa2c6d"><div class="ttname"><a href="classknown__magic.html#aba521f548900ab333a4b13884baa2c6d">known_magic::has_enough_energy</a></div><div class="ttdeci">bool has_enough_energy(const Character &amp;guy, const spell &amp;sp) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02185">magic.cpp:2185</a></div></div>
<div class="ttc" id="aclassknown__magic_html_abdb326bf0885177b20fd45f26a6d68ad"><div class="ttname"><a href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">known_magic::invlets</a></div><div class="ttdeci">std::map&lt; spell_id, int &gt; invlets</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00651">magic.h:651</a></div></div>
<div class="ttc" id="aclassknown__magic_html_ad1adf916c9f70a561c9475f40c94259f"><div class="ttname"><a href="classknown__magic.html#ad1adf916c9f70a561c9475f40c94259f">known_magic::set_invlet</a></div><div class="ttdeci">bool set_invlet(const spell_id &amp;sp, int invlet, const std::set&lt; int &gt; &amp;used_invlets)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02679">magic.cpp:2679</a></div></div>
<div class="ttc" id="aclassknown__magic_html_ad3556aef7b10779c8854c6983c215ac0"><div class="ttname"><a href="classknown__magic.html#ad3556aef7b10779c8854c6983c215ac0">known_magic::caster_level_adjustment</a></div><div class="ttdeci">double caster_level_adjustment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00712">magic.h:712</a></div></div>
<div class="ttc" id="aclassknown__magic_html_ad4bdf834ec136179f6755e4566435b61"><div class="ttname"><a href="classknown__magic.html#ad4bdf834ec136179f6755e4566435b61">known_magic::can_learn_spell</a></div><div class="ttdeci">bool can_learn_spell(const Character &amp;guy, const spell_id &amp;sp) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02104">magic.cpp:2104</a></div></div>
<div class="ttc" id="aclassknown__magic_html_adb9da4817cfdc19624a8674d4cc16fea"><div class="ttname"><a href="classknown__magic.html#adb9da4817cfdc19624a8674d4cc16fea">known_magic::get_spellname_max_width</a></div><div class="ttdeci">int get_spellname_max_width()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02253">magic.cpp:2253</a></div></div>
<div class="ttc" id="aclassknown__magic_html_ae44e12a998ae53c5d487828d83165168"><div class="ttname"><a href="classknown__magic.html#ae44e12a998ae53c5d487828d83165168">known_magic::mod_mana</a></div><div class="ttdeci">void mod_mana(const Character &amp;guy, int add_mana)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02146">magic.cpp:2146</a></div></div>
<div class="ttc" id="aclassknown__magic_html_aeed71b588441f7580d8f3bf9d27a7eb9"><div class="ttname"><a href="classknown__magic.html#aeed71b588441f7580d8f3bf9d27a7eb9">known_magic::set_mana</a></div><div class="ttdeci">void set_mana(int new_mana)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02141">magic.cpp:2141</a></div></div>
<div class="ttc" id="aclassknown__magic_html_af1d54e77049ce1b9ed9d20a559ae0a38"><div class="ttname"><a href="classknown__magic.html#af1d54e77049ce1b9ed9d20a559ae0a38">known_magic::max_mana</a></div><div class="ttdeci">int max_mana(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02151">magic.cpp:2151</a></div></div>
<div class="ttc" id="aclassknown__magic_html_af3b997dd1160faca05064fad5c845e8f"><div class="ttname"><a href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">known_magic::favorites</a></div><div class="ttdeci">std::unordered_set&lt; spell_id &gt; favorites</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00653">magic.h:653</a></div></div>
<div class="ttc" id="aclassknown__magic_html_af47da2a24159ff7852576b1db2e30eab"><div class="ttname"><a href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">known_magic::get_spells</a></div><div class="ttdeci">std::vector&lt; spell * &gt; get_spells()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02126">magic.cpp:2126</a></div></div>
<div class="ttc" id="aclassknown__magic_html_af8acd3edf4541649cd1b1ee21124dd0a"><div class="ttname"><a href="classknown__magic.html#af8acd3edf4541649cd1b1ee21124dd0a">known_magic::serialize</a></div><div class="ttdeci">void serialize(JsonOut &amp;json) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01923">magic.cpp:1923</a></div></div>
<div class="ttc" id="aclassknown__magic_html_af94169b33d6d2cd59d75efac9f92c570"><div class="ttname"><a href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">known_magic::spellbook</a></div><div class="ttdeci">std::map&lt; spell_id, spell &gt; spellbook</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00649">magic.h:649</a></div></div>
<div class="ttc" id="aclassknown__magic_html_afe4bbf2ea0bcb6c32349b7a54640b6c5"><div class="ttname"><a href="classknown__magic.html#afe4bbf2ea0bcb6c32349b7a54640b6c5">known_magic::available_mana</a></div><div class="ttdeci">int available_mana() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02136">magic.cpp:2136</a></div></div>
<div class="ttc" id="aclassmap_html"><div class="ttname"><a href="classmap.html">map</a></div><div class="ttdoc">Manage and cache data about a part of the map.</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00345">map.h:346</a></div></div>
<div class="ttc" id="aclassmap_html_a30cfefdb115c16c5e1af6cc99f94bbbd"><div class="ttname"><a href="classmap.html#a30cfefdb115c16c5e1af6cc99f94bbbd">map::get_field</a></div><div class="ttdeci">field_entry * get_field(const tripoint &amp;p, const field_type_id &amp;type)</div><div class="ttdoc">Get field of specific type at point.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06516">map.cpp:6516</a></div></div>
<div class="ttc" id="aclassmap_html_a32a9de57ddea3145ca42e6acfde7f3d6"><div class="ttname"><a href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">map::add_field</a></div><div class="ttdeci">bool add_field(const tripoint &amp;p, const field_type_id &amp;type_id, int intensity=INT_MAX, const time_duration &amp;age=0_turns, bool hit_player=true)</div><div class="ttdoc">Add field entry at point, or set intensity if present.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06563">map.cpp:6563</a></div></div>
<div class="ttc" id="aclassmap_html_a4f5f812d7e89a998429958573a4c340f"><div class="ttname"><a href="classmap.html#a4f5f812d7e89a998429958573a4c340f">map::points_in_radius</a></div><div class="ttdeci">tripoint_range&lt; tripoint &gt; points_in_radius(const tripoint &amp;center, size_t radius, size_t radiusz=0) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l10109">map.cpp:10109</a></div></div>
<div class="ttc" id="aclassmap_html_a802cc11379d4be61f4e2b13a50f6390e"><div class="ttname"><a href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">map::impassable</a></div><div class="ttdeci">bool impassable(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02462">map.cpp:2462</a></div></div>
<div class="ttc" id="aclassmonster_html"><div class="ttname"><a href="classmonster.html">monster</a></div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00085">monster.h:86</a></div></div>
<div class="ttc" id="aclassmonster_html_ad4fba0b9aea36097d8b972e05e66d914"><div class="ttname"><a href="classmonster.html#ad4fba0b9aea36097d8b972e05e66d914">monster::get_name</a></div><div class="ttdeci">std::string get_name() const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l00717">monster.cpp:717</a></div></div>
<div class="ttc" id="aclassmonster_html_af7763c0da8025aea231a29272f25d5fc"><div class="ttname"><a href="classmonster.html#af7763c0da8025aea231a29272f25d5fc">monster::heal</a></div><div class="ttdeci">int heal(int delta_hp, bool overheal=false)</div><div class="ttdoc">Flat addition to the monsters hp.</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l02149">monster.cpp:2149</a></div></div>
<div class="ttc" id="aclassnc__color_html"><div class="ttname"><a href="classnc__color.html">nc_color</a></div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00347">color.h:348</a></div></div>
<div class="ttc" id="aclassnpc__attack__rating_html"><div class="ttname"><a href="classnpc__attack__rating.html">npc_attack_rating</a></div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8h_source.html#l00017">npc_attack.h:18</a></div></div>
<div class="ttc" id="aclassnpc__attack__rating_html_a5edbe25131a7337a3738bd24cd113f5b"><div class="ttname"><a href="classnpc__attack__rating.html#a5edbe25131a7337a3738bd24cd113f5b">npc_attack_rating::target</a></div><div class="ttdeci">tripoint target() const</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8h_source.html#l00030">npc_attack.h:30</a></div></div>
<div class="ttc" id="aclassnpc__attack__spell_html"><div class="ttname"><a href="classnpc__attack__spell.html">npc_attack_spell</a></div><div class="ttdoc">The type of npc_attack that is a spell.</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8h_source.html#l00063">npc_attack.h:64</a></div></div>
<div class="ttc" id="aclassnpc__attack__spell_html_a84b08e3a63323c4a5641c7d87e791f54"><div class="ttname"><a href="classnpc__attack__spell.html#a84b08e3a63323c4a5641c7d87e791f54">npc_attack_spell::evaluate</a></div><div class="ttdeci">npc_attack_rating evaluate(const npc &amp;source, const Creature *target) const override</div><div class="ttdoc">Parameters: source - the npc making the attack target - the desired target of the npc.</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00111">npc_attack.cpp:111</a></div></div>
<div class="ttc" id="aclassnpc_html"><div class="ttname"><a href="classnpc.html">npc</a></div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00791">npc.h:792</a></div></div>
<div class="ttc" id="aclassscrollbar_html"><div class="ttname"><a href="classscrollbar.html">scrollbar</a></div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00889">output.h:890</a></div></div>
<div class="ttc" id="aclassscrollbar_html_a086351327a6cbd86aeed71287447b17f"><div class="ttname"><a href="classscrollbar.html#a086351327a6cbd86aeed71287447b17f">scrollbar::offset_y</a></div><div class="ttdeci">scrollbar &amp; offset_y(int offy)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l01733">output.cpp:1733</a></div></div>
<div class="ttc" id="aclassscrollbar_html_a226505801579af2a2dcf01a0c0b537df"><div class="ttname"><a href="classscrollbar.html#a226505801579af2a2dcf01a0c0b537df">scrollbar::offset_x</a></div><div class="ttdeci">scrollbar &amp; offset_x(int offx)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l01727">output.cpp:1727</a></div></div>
<div class="ttc" id="aclassscrollbar_html_a6d297e6f4366400fe0cc35bbeefe255e"><div class="ttname"><a href="classscrollbar.html#a6d297e6f4366400fe0cc35bbeefe255e">scrollbar::viewport_pos</a></div><div class="ttdeci">scrollbar &amp; viewport_pos(int vpos)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l01745">output.cpp:1745</a></div></div>
<div class="ttc" id="aclassscrollbar_html_a93c98c6beb1deeb701317f00da76c69f"><div class="ttname"><a href="classscrollbar.html#a93c98c6beb1deeb701317f00da76c69f">scrollbar::viewport_size</a></div><div class="ttdeci">scrollbar &amp; viewport_size(int vsize)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l01751">output.cpp:1751</a></div></div>
<div class="ttc" id="aclassscrollbar_html_a98f4ed3f32292f440c0672817e74616c"><div class="ttname"><a href="classscrollbar.html#a98f4ed3f32292f440c0672817e74616c">scrollbar::content_size</a></div><div class="ttdeci">scrollbar &amp; content_size(int csize)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l01739">output.cpp:1739</a></div></div>
<div class="ttc" id="aclassscrollbar_html_ae3e092da3bab2a8bb65d662538a27f62"><div class="ttname"><a href="classscrollbar.html#ae3e092da3bab2a8bb65d662538a27f62">scrollbar::apply</a></div><div class="ttdeci">void apply(const catacurses::window &amp;window)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l01787">output.cpp:1787</a></div></div>
<div class="ttc" id="aclassspell__events_html_a1a45ec3d63bc6442e05b3a6dd01c6f84"><div class="ttname"><a href="classspell__events.html#a1a45ec3d63bc6442e05b3a6dd01c6f84">spell_events::notify</a></div><div class="ttdeci">virtual void notify(const cata::event &amp;)=0</div></div>
<div class="ttc" id="aclassspell__type_html"><div class="ttname"><a href="classspell__type.html">spell_type</a></div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00197">magic.h:198</a></div></div>
<div class="ttc" id="aclassspell__type_html_a08e913e8b37e572c9f079e038dee36b2"><div class="ttname"><a href="classspell__type.html#a08e913e8b37e572c9f079e038dee36b2">spell_type::max_aoe</a></div><div class="ttdeci">dbl_or_var max_aoe</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00281">magic.h:281</a></div></div>
<div class="ttc" id="aclassspell__type_html_a094462d9091edcb781516ba1c6bf5096"><div class="ttname"><a href="classspell__type.html#a094462d9091edcb781516ba1c6bf5096">spell_type::casting_time_increment</a></div><div class="ttdeci">dbl_or_var casting_time_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00332">magic.h:332</a></div></div>
<div class="ttc" id="aclassspell__type_html_a0a1613360b65577766130af10b7527ae"><div class="ttname"><a href="classspell__type.html#a0a1613360b65577766130af10b7527ae">spell_type::message_default</a></div><div class="ttdeci">static const translation message_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00376">magic.h:376</a></div></div>
<div class="ttc" id="aclassspell__type_html_a0bf174d1f3134b53667d8381c02d6ee4"><div class="ttname"><a href="classspell__type.html#a0bf174d1f3134b53667d8381c02d6ee4">spell_type::description</a></div><div class="ttdeci">translation description</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00212">magic.h:212</a></div></div>
<div class="ttc" id="aclassspell__type_html_a12a2f88598abde1c5913628dee45e882"><div class="ttname"><a href="classspell__type.html#a12a2f88598abde1c5913628dee45e882">spell_type::aoe_increment_default</a></div><div class="ttdeci">static const float aoe_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00399">magic.h:399</a></div></div>
<div class="ttc" id="aclassspell__type_html_a16fd458bb92e74815eb9fb928fbe97ad"><div class="ttname"><a href="classspell__type.html#a16fd458bb92e74815eb9fb928fbe97ad">spell_type::duration_increment_default</a></div><div class="ttdeci">static const int duration_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00405">magic.h:405</a></div></div>
<div class="ttc" id="aclassspell__type_html_a171e7148d9087468c1be262d13802338"><div class="ttname"><a href="classspell__type.html#a171e7148d9087468c1be262d13802338">spell_type::final_energy_cost</a></div><div class="ttdeci">dbl_or_var final_energy_cost</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00317">magic.h:317</a></div></div>
<div class="ttc" id="aclassspell__type_html_a1b2255ccbd2b5132192d6cd16dc913a8"><div class="ttname"><a href="classspell__type.html#a1b2255ccbd2b5132192d6cd16dc913a8">spell_type::dot_increment</a></div><div class="ttdeci">dbl_or_var dot_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00288">magic.h:288</a></div></div>
<div class="ttc" id="aclassspell__type_html_a1cd139dd8336e9b357b7c512c600daf8"><div class="ttname"><a href="classspell__type.html#a1cd139dd8336e9b357b7c512c600daf8">spell_type::max_dot</a></div><div class="ttdeci">dbl_or_var max_dot</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00290">magic.h:290</a></div></div>
<div class="ttc" id="aclassspell__type_html_a1e5fb7d2cfe305bd5b26dccdce21273b"><div class="ttname"><a href="classspell__type.html#a1e5fb7d2cfe305bd5b26dccdce21273b">spell_type::message</a></div><div class="ttdeci">translation message</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00214">magic.h:214</a></div></div>
<div class="ttc" id="aclassspell__type_html_a21afbf660e1de0739ec37cfe8cc409d5"><div class="ttname"><a href="classspell__type.html#a21afbf660e1de0739ec37cfe8cc409d5">spell_type::sound_description_default</a></div><div class="ttdeci">static const translation sound_description_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00377">magic.h:377</a></div></div>
<div class="ttc" id="aclassspell__type_html_a226b53feab51ac683efe4a33483dc88c"><div class="ttname"><a href="classspell__type.html#a226b53feab51ac683efe4a33483dc88c">spell_type::reset_all</a></div><div class="ttdeci">static void reset_all()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00639">magic.cpp:639</a></div></div>
<div class="ttc" id="aclassspell__type_html_a232bcad60b60e42ff8ee884aa26837ab"><div class="ttname"><a href="classspell__type.html#a232bcad60b60e42ff8ee884aa26837ab">spell_type::difficulty_default</a></div><div class="ttdeci">static const int difficulty_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00415">magic.h:415</a></div></div>
<div class="ttc" id="aclassspell__type_html_a27241a7d092889a2be195551797dfbf8"><div class="ttname"><a href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">spell_type::id</a></div><div class="ttdeci">spell_id id</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00205">magic.h:205</a></div></div>
<div class="ttc" id="aclassspell__type_html_a2dc22c6c8d58f23f22a4a9b72cd7eed7"><div class="ttname"><a href="classspell__type.html#a2dc22c6c8d58f23f22a4a9b72cd7eed7">spell_type::sound_type</a></div><div class="ttdeci">sounds::sound_t sound_type</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00221">magic.h:221</a></div></div>
<div class="ttc" id="aclassspell__type_html_a2f4c3da42b12fcb9160f5110214db5e7"><div class="ttname"><a href="classspell__type.html#a2f4c3da42b12fcb9160f5110214db5e7">spell_type::effect</a></div><div class="ttdeci">std::function&lt; void(const spell &amp;, Creature &amp;, const tripoint &amp;)&gt; effect</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00229">magic.h:229</a></div></div>
<div class="ttc" id="aclassspell__type_html_a2f9ed4a15576c8883bc42c768c52cf45"><div class="ttname"><a href="classspell__type.html#a2f9ed4a15576c8883bc42c768c52cf45">spell_type::pierce_increment</a></div><div class="ttdeci">dbl_or_var pierce_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00308">magic.h:308</a></div></div>
<div class="ttc" id="aclassspell__type_html_a2fb4614f39f5253b86d6095192dc4a97"><div class="ttname"><a href="classspell__type.html#a2fb4614f39f5253b86d6095192dc4a97">spell_type::sound_type_default</a></div><div class="ttdeci">static const sounds::sound_t sound_type_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00378">magic.h:378</a></div></div>
<div class="ttc" id="aclassspell__type_html_a374a9343878e6614c0185f25acf37b30"><div class="ttname"><a href="classspell__type.html#a374a9343878e6614c0185f25acf37b30">spell_type::energy_increment</a></div><div class="ttdeci">dbl_or_var energy_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00315">magic.h:315</a></div></div>
<div class="ttc" id="aclassspell__type_html_a3afdff53a2be2c160fadc0cd4833bb8e"><div class="ttname"><a href="classspell__type.html#a3afdff53a2be2c160fadc0cd4833bb8e">spell_type::damage_increment_default</a></div><div class="ttdeci">static const float damage_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00393">magic.h:393</a></div></div>
<div class="ttc" id="aclassspell__type_html_a3be2c0ad4d9749e8a1dc35dcf7f80429"><div class="ttname"><a href="classspell__type.html#a3be2c0ad4d9749e8a1dc35dcf7f80429">spell_type::energy_source_default</a></div><div class="ttdeci">static const magic_energy_type energy_source_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00413">magic.h:413</a></div></div>
<div class="ttc" id="aclassspell__type_html_a3f73cb1637c08d9057dfc4e31a35f17e"><div class="ttname"><a href="classspell__type.html#a3f73cb1637c08d9057dfc4e31a35f17e">spell_type::min_dot</a></div><div class="ttdeci">dbl_or_var min_dot</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00286">magic.h:286</a></div></div>
<div class="ttc" id="aclassspell__type_html_a4013ffcfd9071b49699038d4120749cb"><div class="ttname"><a href="classspell__type.html#a4013ffcfd9071b49699038d4120749cb">spell_type::min_accuracy_default</a></div><div class="ttdeci">static const int min_accuracy_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00389">magic.h:389</a></div></div>
<div class="ttc" id="aclassspell__type_html_a40d30bd9621c0f8c64b488bed2a0ce51"><div class="ttname"><a href="classspell__type.html#a40d30bd9621c0f8c64b488bed2a0ce51">spell_type::flags</a></div><div class="ttdeci">std::set&lt; std::string &gt; flags</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00356">magic.h:356</a></div></div>
<div class="ttc" id="aclassspell__type_html_a41cd20e0a5993d5f3a378bc0339ae918"><div class="ttname"><a href="classspell__type.html#a41cd20e0a5993d5f3a378bc0339ae918">spell_type::min_aoe_default</a></div><div class="ttdeci">static const int min_aoe_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00398">magic.h:398</a></div></div>
<div class="ttc" id="aclassspell__type_html_a468c48b7d109cc65c14f72af881125f1"><div class="ttname"><a href="classspell__type.html#a468c48b7d109cc65c14f72af881125f1">spell_type::field_chance_default</a></div><div class="ttdeci">static const int field_chance_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00384">magic.h:384</a></div></div>
<div class="ttc" id="aclassspell__type_html_a48f952d3f551b2cab4fdb46087613c48"><div class="ttname"><a href="classspell__type.html#a48f952d3f551b2cab4fdb46087613c48">spell_type::ignored_species_ids</a></div><div class="ttdeci">std::set&lt; species_id &gt; ignored_species_ids</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00351">magic.h:351</a></div></div>
<div class="ttc" id="aclassspell__type_html_a4aecb94219e95161d7be0a9b3ad4ab28"><div class="ttname"><a href="classspell__type.html#a4aecb94219e95161d7be0a9b3ad4ab28">spell_type::max_accuracy</a></div><div class="ttdeci">dbl_or_var max_accuracy</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00259">magic.h:259</a></div></div>
<div class="ttc" id="aclassspell__type_html_a4e0d43953a8887f6b183e9007fead3f1"><div class="ttname"><a href="classspell__type.html#a4e0d43953a8887f6b183e9007fead3f1">spell_type::field_intensity_increment</a></div><div class="ttdeci">dbl_or_var field_intensity_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00247">magic.h:247</a></div></div>
<div class="ttc" id="aclassspell__type_html_a5073999c6ea0fa0356c6e6f2a0e407aa"><div class="ttname"><a href="classspell__type.html#a5073999c6ea0fa0356c6e6f2a0e407aa">spell_type::min_accuracy</a></div><div class="ttdeci">dbl_or_var min_accuracy</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00257">magic.h:257</a></div></div>
<div class="ttc" id="aclassspell__type_html_a51475bfe17e94f2400eada8e930f0877"><div class="ttname"><a href="classspell__type.html#a51475bfe17e94f2400eada8e930f0877">spell_type::check_consistency</a></div><div class="ttdeci">static void check_consistency()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00615">magic.cpp:615</a></div></div>
<div class="ttc" id="aclassspell__type_html_a51accd4d56a09f1c2f5dae55832a8797"><div class="ttname"><a href="classspell__type.html#a51accd4d56a09f1c2f5dae55832a8797">spell_type::min_duration</a></div><div class="ttdeci">dbl_or_var min_duration</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00295">magic.h:295</a></div></div>
<div class="ttc" id="aclassspell__type_html_a54a3704127c6ab03b7314bc998522e04"><div class="ttname"><a href="classspell__type.html#a54a3704127c6ab03b7314bc998522e04">spell_type::learn_spells</a></div><div class="ttdeci">std::map&lt; std::string, int &gt; learn_spells</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00337">magic.h:337</a></div></div>
<div class="ttc" id="aclassspell__type_html_a58dc5f9a0291fecd13320cff374013b8"><div class="ttname"><a href="classspell__type.html#a58dc5f9a0291fecd13320cff374013b8">spell_type::spell_components</a></div><div class="ttdeci">requirement_id spell_components</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00219">magic.h:219</a></div></div>
<div class="ttc" id="aclassspell__type_html_a59beaea1200f5386e09aee0c7c7866df"><div class="ttname"><a href="classspell__type.html#a59beaea1200f5386e09aee0c7c7866df">spell_type::min_field_intensity</a></div><div class="ttdeci">dbl_or_var min_field_intensity</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00245">magic.h:245</a></div></div>
<div class="ttc" id="aclassspell__type_html_a5b8690441c94b9182bf777d1a14ffe8f"><div class="ttname"><a href="classspell__type.html#a5b8690441c94b9182bf777d1a14ffe8f">spell_type::max_range</a></div><div class="ttdeci">dbl_or_var max_range</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00273">magic.h:273</a></div></div>
<div class="ttc" id="aclassspell__type_html_a5d51ae843768a4cacadb5e88cf871ebe"><div class="ttname"><a href="classspell__type.html#a5d51ae843768a4cacadb5e88cf871ebe">spell_type::spell_area_function</a></div><div class="ttdeci">std::function&lt; std::set&lt; tripoint &gt; const spell_effect::override_parameters &amp;params, const tripoint &amp;source, const tripoint &amp;target)&gt; spell_area_function</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00232">magic.h:232</a></div></div>
<div class="ttc" id="aclassspell__type_html_a5e3c1434fc8d2303d503aa2f901e0a37"><div class="ttname"><a href="classspell__type.html#a5e3c1434fc8d2303d503aa2f901e0a37">spell_type::sound_ambient_default</a></div><div class="ttdeci">static const bool sound_ambient_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00379">magic.h:379</a></div></div>
<div class="ttc" id="aclassspell__type_html_a60beddc934a1d3571d46ae521cc1fc6c"><div class="ttname"><a href="classspell__type.html#a60beddc934a1d3571d46ae521cc1fc6c">spell_type::min_damage</a></div><div class="ttdeci">dbl_or_var min_damage</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00262">magic.h:262</a></div></div>
<div class="ttc" id="aclassspell__type_html_a60c88145cf9b37dfe7b141b143095246"><div class="ttname"><a href="classspell__type.html#a60c88145cf9b37dfe7b141b143095246">spell_type::targeted_species_ids</a></div><div class="ttdeci">std::set&lt; species_id &gt; targeted_species_ids</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00349">magic.h:349</a></div></div>
<div class="ttc" id="aclassspell__type_html_a641c1dbe678475ecc72974c15aaa77a4"><div class="ttname"><a href="classspell__type.html#a641c1dbe678475ecc72974c15aaa77a4">spell_type::field_default</a></div><div class="ttdeci">static const std::optional&lt; field_type_id &gt; field_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00383">magic.h:383</a></div></div>
<div class="ttc" id="aclassspell__type_html_a6a3a8e6c712829cd8a4b8ecb6b56a041"><div class="ttname"><a href="classspell__type.html#a6a3a8e6c712829cd8a4b8ecb6b56a041">spell_type::max_duration</a></div><div class="ttdeci">dbl_or_var max_duration</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00300">magic.h:300</a></div></div>
<div class="ttc" id="aclassspell__type_html_a6d74ff9fdcc59a96412c9bdeb73e69e0"><div class="ttname"><a href="classspell__type.html#a6d74ff9fdcc59a96412c9bdeb73e69e0">spell_type::sound_variant_default</a></div><div class="ttdeci">static const std::string sound_variant_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00381">magic.h:381</a></div></div>
<div class="ttc" id="aclassspell__type_html_a6e7735afc9f1817f48ad9c43f710b5f4"><div class="ttname"><a href="classspell__type.html#a6e7735afc9f1817f48ad9c43f710b5f4">spell_type::duration_increment</a></div><div class="ttdeci">dbl_or_var duration_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00298">magic.h:298</a></div></div>
<div class="ttc" id="aclassspell__type_html_a6f2ea5fc2b28d67cc32a65b4227acc23"><div class="ttname"><a href="classspell__type.html#a6f2ea5fc2b28d67cc32a65b4227acc23">spell_type::effect_str_default</a></div><div class="ttdeci">static const std::string effect_str_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00382">magic.h:382</a></div></div>
<div class="ttc" id="aclassspell__type_html_a737a48fb1019ec08d21a3a0b241779c4"><div class="ttname"><a href="classspell__type.html#a737a48fb1019ec08d21a3a0b241779c4">spell_type::max_dot_default</a></div><div class="ttdeci">static const int max_dot_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00403">magic.h:403</a></div></div>
<div class="ttc" id="aclassspell__type_html_a74d93ff32c5d02d21548e7164e39b7f1"><div class="ttname"><a href="classspell__type.html#a74d93ff32c5d02d21548e7164e39b7f1">spell_type::spell_tags</a></div><div class="ttdeci">enum_bitset&lt; spell_flag &gt; spell_tags</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00359">magic.h:359</a></div></div>
<div class="ttc" id="aclassspell__type_html_a77a45ea3e4de418a9fbe8849be99d27c"><div class="ttname"><a href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_type::spell_class</a></div><div class="ttdeci">trait_id spell_class</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00321">magic.h:321</a></div></div>
<div class="ttc" id="aclassspell__type_html_a7b2ad93661e6cecf3ff87e123f9269b6"><div class="ttname"><a href="classspell__type.html#a7b2ad93661e6cecf3ff87e123f9269b6">spell_type::min_pierce</a></div><div class="ttdeci">dbl_or_var min_pierce</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00306">magic.h:306</a></div></div>
<div class="ttc" id="aclassspell__type_html_a7d91bdf3d04bd110e544bb401778fe6a"><div class="ttname"><a href="classspell__type.html#a7d91bdf3d04bd110e544bb401778fe6a">spell_type::dot_increment_default</a></div><div class="ttdeci">static const float dot_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00402">magic.h:402</a></div></div>
<div class="ttc" id="aclassspell__type_html_a7e9db1d8b823fa853544a91327332eee"><div class="ttname"><a href="classspell__type.html#a7e9db1d8b823fa853544a91327332eee">spell_type::dmg_type</a></div><div class="ttdeci">damage_type_id dmg_type</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00342">magic.h:342</a></div></div>
<div class="ttc" id="aclassspell__type_html_a80f705529ff936de2cbb7e67720c41a4"><div class="ttname"><a href="classspell__type.html#a80f705529ff936de2cbb7e67720c41a4">spell_type::accuracy_increment_default</a></div><div class="ttdeci">static const float accuracy_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00390">magic.h:390</a></div></div>
<div class="ttc" id="aclassspell__type_html_a85d117bedc34d5780a37a7fb82d294b7"><div class="ttname"><a href="classspell__type.html#a85d117bedc34d5780a37a7fb82d294b7">spell_type::min_pierce_default</a></div><div class="ttdeci">static const int min_pierce_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00407">magic.h:407</a></div></div>
<div class="ttc" id="aclassspell__type_html_a868516b343411f98fcf2a2c961de01cb"><div class="ttname"><a href="classspell__type.html#a868516b343411f98fcf2a2c961de01cb">spell_type::sound_description</a></div><div class="ttdeci">translation sound_description</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00216">magic.h:216</a></div></div>
<div class="ttc" id="aclassspell__type_html_a86eb7c8c5fa42a5307de55cc4646b97e"><div class="ttname"><a href="classspell__type.html#a86eb7c8c5fa42a5307de55cc4646b97e">spell_type::aoe_increment</a></div><div class="ttdeci">dbl_or_var aoe_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00279">magic.h:279</a></div></div>
<div class="ttc" id="aclassspell__type_html_a88a5469428a3df2f93daba51a4c21803"><div class="ttname"><a href="classspell__type.html#a88a5469428a3df2f93daba51a4c21803">spell_type::min_damage_default</a></div><div class="ttdeci">static const int min_damage_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00392">magic.h:392</a></div></div>
<div class="ttc" id="aclassspell__type_html_a8a299f32ae67edfb733d424000042d91"><div class="ttname"><a href="classspell__type.html#a8a299f32ae67edfb733d424000042d91">spell_type::src</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; spell_id, mod_id &gt; &gt; src</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00207">magic.h:207</a></div></div>
<div class="ttc" id="aclassspell__type_html_a8a9f3e75988d34cf9e89abfec583ba67"><div class="ttname"><a href="classspell__type.html#a8a9f3e75988d34cf9e89abfec583ba67">spell_type::sound_variant</a></div><div class="ttdeci">std::string sound_variant</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00224">magic.h:224</a></div></div>
<div class="ttc" id="aclassspell__type_html_a8cc4f2167f1ea512d9e462cf5ae8fda5"><div class="ttname"><a href="classspell__type.html#a8cc4f2167f1ea512d9e462cf5ae8fda5">spell_type::max_field_intensity_default</a></div><div class="ttdeci">static const int max_field_intensity_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00386">magic.h:386</a></div></div>
<div class="ttc" id="aclassspell__type_html_a8cfa4b25f6959244b9bdea9363d6b63d"><div class="ttname"><a href="classspell__type.html#a8cfa4b25f6959244b9bdea9363d6b63d">spell_type::serialize</a></div><div class="ttdeci">void serialize(JsonOut &amp;json) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00483">magic.cpp:483</a></div></div>
<div class="ttc" id="aclassspell__type_html_a91953b9d5715f36608e753b3fc5e805d"><div class="ttname"><a href="classspell__type.html#a91953b9d5715f36608e753b3fc5e805d">spell_type::sound_id</a></div><div class="ttdeci">std::string sound_id</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00223">magic.h:223</a></div></div>
<div class="ttc" id="aclassspell__type_html_a960a7f198bd614a7c048405d7d120f61"><div class="ttname"><a href="classspell__type.html#a960a7f198bd614a7c048405d7d120f61">spell_type::difficulty</a></div><div class="ttdeci">dbl_or_var difficulty</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00324">magic.h:324</a></div></div>
<div class="ttc" id="aclassspell__type_html_a969fc5645fa6d17530ffb392cb4d960e"><div class="ttname"><a href="classspell__type.html#a969fc5645fa6d17530ffb392cb4d960e">spell_type::get_all</a></div><div class="ttdeci">static const std::vector&lt; spell_type &gt; &amp; get_all()</div><div class="ttdoc">All spells in the game.</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00634">magic.cpp:634</a></div></div>
<div class="ttc" id="aclassspell__type_html_a9705a52b5936dfba68763b9ebb173788"><div class="ttname"><a href="classspell__type.html#a9705a52b5936dfba68763b9ebb173788">spell_type::min_dot_default</a></div><div class="ttdeci">static const int min_dot_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00401">magic.h:401</a></div></div>
<div class="ttc" id="aclassspell__type_html_a97a4eea59f0c7dcbbadf32f7038dd742"><div class="ttname"><a href="classspell__type.html#a97a4eea59f0c7dcbbadf32f7038dd742">spell_type::min_range_default</a></div><div class="ttdeci">static const int min_range_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00395">magic.h:395</a></div></div>
<div class="ttc" id="aclassspell__type_html_a9b70e44b3a6f82719d4b823eddc5d686"><div class="ttname"><a href="classspell__type.html#a9b70e44b3a6f82719d4b823eddc5d686">spell_type::base_energy_cost</a></div><div class="ttdeci">dbl_or_var base_energy_cost</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00313">magic.h:313</a></div></div>
<div class="ttc" id="aclassspell__type_html_a9c0dafac52e934828f652ae49c111ffb"><div class="ttname"><a href="classspell__type.html#a9c0dafac52e934828f652ae49c111ffb">spell_type::max_damage_default</a></div><div class="ttdeci">static const int max_damage_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00394">magic.h:394</a></div></div>
<div class="ttc" id="aclassspell__type_html_aa35f381ae36b923d5eb8759087bd3ddd"><div class="ttname"><a href="classspell__type.html#aa35f381ae36b923d5eb8759087bd3ddd">spell_type::min_duration_default</a></div><div class="ttdeci">static const int min_duration_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00404">magic.h:404</a></div></div>
<div class="ttc" id="aclassspell__type_html_aa4b832cf689f208feda1c32d37fcdba5"><div class="ttname"><a href="classspell__type.html#aa4b832cf689f208feda1c32d37fcdba5">spell_type::min_range</a></div><div class="ttdeci">dbl_or_var min_range</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00269">magic.h:269</a></div></div>
<div class="ttc" id="aclassspell__type_html_aa4c09471023f07665681f5bf684d1e37"><div class="ttname"><a href="classspell__type.html#aa4c09471023f07665681f5bf684d1e37">spell_type::damage_increment</a></div><div class="ttdeci">dbl_or_var damage_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00264">magic.h:264</a></div></div>
<div class="ttc" id="aclassspell__type_html_aa503b99197533fa1dfa5de8052a4119b"><div class="ttname"><a href="classspell__type.html#aa503b99197533fa1dfa5de8052a4119b">spell_type::min_aoe</a></div><div class="ttdeci">dbl_or_var min_aoe</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00277">magic.h:277</a></div></div>
<div class="ttc" id="aclassspell__type_html_aa5f6b0b99d9ffd592376016d6162359b"><div class="ttname"><a href="classspell__type.html#aa5f6b0b99d9ffd592376016d6162359b">spell_type::field</a></div><div class="ttdeci">std::optional&lt; field_type_id &gt; field</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00241">magic.h:241</a></div></div>
<div class="ttc" id="aclassspell__type_html_aa77544331a0516008a5a39fb527a5b9f"><div class="ttname"><a href="classspell__type.html#aa77544331a0516008a5a39fb527a5b9f">spell_type::max_pierce_default</a></div><div class="ttdeci">static const int max_pierce_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00409">magic.h:409</a></div></div>
<div class="ttc" id="aclassspell__type_html_aad4fa941a70475847d13e1de3862c965"><div class="ttname"><a href="classspell__type.html#aad4fa941a70475847d13e1de3862c965">spell_type::max_aoe_default</a></div><div class="ttdeci">static const int max_aoe_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00400">magic.h:400</a></div></div>
<div class="ttc" id="aclassspell__type_html_aaf35eb6ac32a3c4e3458c38c5fd627d4"><div class="ttname"><a href="classspell__type.html#aaf35eb6ac32a3c4e3458c38c5fd627d4">spell_type::spell_class_default</a></div><div class="ttdeci">static const trait_id spell_class_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00412">magic.h:412</a></div></div>
<div class="ttc" id="aclassspell__type_html_ab1b1ec17f8a72265b3de8de7182b42e6"><div class="ttname"><a href="classspell__type.html#ab1b1ec17f8a72265b3de8de7182b42e6">spell_type::effect_str</a></div><div class="ttdeci">std::string effect_str</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00236">magic.h:236</a></div></div>
<div class="ttc" id="aclassspell__type_html_ab4ab3a7ce1ea8d0f57b9ebac8c45f06f"><div class="ttname"><a href="classspell__type.html#ab4ab3a7ce1ea8d0f57b9ebac8c45f06f">spell_type::max_accuracy_default</a></div><div class="ttdeci">static const int max_accuracy_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00391">magic.h:391</a></div></div>
<div class="ttc" id="aclassspell__type_html_ab9b1f0c5e1c6127b4bb37b371ff09e92"><div class="ttname"><a href="classspell__type.html#ab9b1f0c5e1c6127b4bb37b371ff09e92">spell_type::is_valid</a></div><div class="ttdeci">bool is_valid() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00644">magic.cpp:644</a></div></div>
<div class="ttc" id="aclassspell__type_html_abd2cfd23c656755b0f887064683d9e13"><div class="ttname"><a href="classspell__type.html#abd2cfd23c656755b0f887064683d9e13">spell_type::skill</a></div><div class="ttdeci">skill_id skill</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00217">magic.h:217</a></div></div>
<div class="ttc" id="aclassspell__type_html_abe44166acf59a9344d7f0bd0dd934dd9"><div class="ttname"><a href="classspell__type.html#abe44166acf59a9344d7f0bd0dd934dd9">spell_type::max_field_intensity</a></div><div class="ttdeci">dbl_or_var max_field_intensity</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00249">magic.h:249</a></div></div>
<div class="ttc" id="aclassspell__type_html_abf08fe1f454fd0649d9855104630afe4"><div class="ttname"><a href="classspell__type.html#abf08fe1f454fd0649d9855104630afe4">spell_type::spell_area</a></div><div class="ttdeci">spell_shape spell_area</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00234">magic.h:234</a></div></div>
<div class="ttc" id="aclassspell__type_html_abf6f5f121eafafc780f381abefd1ae89"><div class="ttname"><a href="classspell__type.html#abf6f5f121eafafc780f381abefd1ae89">spell_type::max_level_default</a></div><div class="ttdeci">static const int max_level_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00416">magic.h:416</a></div></div>
<div class="ttc" id="aclassspell__type_html_ac10338c30d2989699573e02cd5f60135"><div class="ttname"><a href="classspell__type.html#ac10338c30d2989699573e02cd5f60135">spell_type::field_intensity_variance_default</a></div><div class="ttdeci">static const float field_intensity_variance_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00388">magic.h:388</a></div></div>
<div class="ttc" id="aclassspell__type_html_ac5fb63c1cb3f31f1c705e9988e882e4a"><div class="ttname"><a href="classspell__type.html#ac5fb63c1cb3f31f1c705e9988e882e4a">spell_type::sound_ambient</a></div><div class="ttdeci">bool sound_ambient</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00222">magic.h:222</a></div></div>
<div class="ttc" id="aclassspell__type_html_ac6581e716558984035ff45c6a2b4ddb8"><div class="ttname"><a href="classspell__type.html#ac6581e716558984035ff45c6a2b4ddb8">spell_type::base_energy_cost_default</a></div><div class="ttdeci">static const int base_energy_cost_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00410">magic.h:410</a></div></div>
<div class="ttc" id="aclassspell__type_html_acae42f8b49667db0c62b6982351359c5"><div class="ttname"><a href="classspell__type.html#acae42f8b49667db0c62b6982351359c5">spell_type::spell_components_default</a></div><div class="ttdeci">static const requirement_id spell_components_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00375">magic.h:375</a></div></div>
<div class="ttc" id="aclassspell__type_html_acb2e4a03f710e9444583ba6c59da06be"><div class="ttname"><a href="classspell__type.html#acb2e4a03f710e9444583ba6c59da06be">spell_type::range_increment</a></div><div class="ttdeci">dbl_or_var range_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00271">magic.h:271</a></div></div>
<div class="ttc" id="aclassspell__type_html_acb7db60423fe07ce71c9a07697c8870d"><div class="ttname"><a href="classspell__type.html#acb7db60423fe07ce71c9a07697c8870d">spell_type::load_spell</a></div><div class="ttdeci">static void load_spell(const JsonObject &amp;jo, const std::string &amp;src)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00255">magic.cpp:255</a></div></div>
<div class="ttc" id="aclassspell__type_html_acedfba24abe1ece6dad25009b1797c33"><div class="ttname"><a href="classspell__type.html#acedfba24abe1ece6dad25009b1797c33">spell_type::field_intensity_variance</a></div><div class="ttdeci">dbl_or_var field_intensity_variance</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00251">magic.h:251</a></div></div>
<div class="ttc" id="aclassspell__type_html_ad2535cbbbb4a50c01ee79c47d3dde019"><div class="ttname"><a href="classspell__type.html#ad2535cbbbb4a50c01ee79c47d3dde019">spell_type::max_level</a></div><div class="ttdeci">dbl_or_var max_level</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00327">magic.h:327</a></div></div>
<div class="ttc" id="aclassspell__type_html_ad2bc4f5cfc43f8fddbab8ee7d464fbbd"><div class="ttname"><a href="classspell__type.html#ad2bc4f5cfc43f8fddbab8ee7d464fbbd">spell_type::max_range_default</a></div><div class="ttdeci">static const int max_range_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00397">magic.h:397</a></div></div>
<div class="ttc" id="aclassspell__type_html_ad2ddb53d6c4f656d913e5093d84f1ad6"><div class="ttname"><a href="classspell__type.html#ad2ddb53d6c4f656d913e5093d84f1ad6">spell_type::affected_bps</a></div><div class="ttdeci">body_part_set affected_bps</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00354">magic.h:354</a></div></div>
<div class="ttc" id="aclassspell__type_html_ad4ed1c14fab837303d765643f1fd2dd8"><div class="ttname"><a href="classspell__type.html#ad4ed1c14fab837303d765643f1fd2dd8">spell_type::max_duration_default</a></div><div class="ttdeci">static const int max_duration_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00406">magic.h:406</a></div></div>
<div class="ttc" id="aclassspell__type_html_ad56ab0a53c5ed44bf7b40977e8b3bb28"><div class="ttname"><a href="classspell__type.html#ad56ab0a53c5ed44bf7b40977e8b3bb28">spell_type::pierce_increment_default</a></div><div class="ttdeci">static const float pierce_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00408">magic.h:408</a></div></div>
<div class="ttc" id="aclassspell__type_html_ad7a21ee64ec72743911b9461e3add78b"><div class="ttname"><a href="classspell__type.html#ad7a21ee64ec72743911b9461e3add78b">spell_type::energy_source</a></div><div class="ttdeci">magic_energy_type energy_source</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00340">magic.h:340</a></div></div>
<div class="ttc" id="aclassspell__type_html_ad7c34417b82c32b2f70b4d049b50f854"><div class="ttname"><a href="classspell__type.html#ad7c34417b82c32b2f70b4d049b50f854">spell_type::field_chance</a></div><div class="ttdeci">dbl_or_var field_chance</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00243">magic.h:243</a></div></div>
<div class="ttc" id="aclassspell__type_html_ad9cd92ba641b2fd6c48e80bcd6ba40bc"><div class="ttname"><a href="classspell__type.html#ad9cd92ba641b2fd6c48e80bcd6ba40bc">spell_type::teachable</a></div><div class="ttdeci">bool teachable</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00227">magic.h:227</a></div></div>
<div class="ttc" id="aclassspell__type_html_ada2df5912b75656b1b85b9d3bd7359d5"><div class="ttname"><a href="classspell__type.html#ada2df5912b75656b1b85b9d3bd7359d5">spell_type::max_pierce</a></div><div class="ttdeci">dbl_or_var max_pierce</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00310">magic.h:310</a></div></div>
<div class="ttc" id="aclassspell__type_html_adcac4bcd0931ffd34281a9eed747d93c"><div class="ttname"><a href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">spell_type::name</a></div><div class="ttdeci">translation name</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00210">magic.h:210</a></div></div>
<div class="ttc" id="aclassspell__type_html_adccbac25f546cf4b277b1058b59f0ae8"><div class="ttname"><a href="classspell__type.html#adccbac25f546cf4b277b1058b59f0ae8">spell_type::final_casting_time</a></div><div class="ttdeci">dbl_or_var final_casting_time</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00334">magic.h:334</a></div></div>
<div class="ttc" id="aclassspell__type_html_addae5132e10abe659f19d1575547d185"><div class="ttname"><a href="classspell__type.html#addae5132e10abe659f19d1575547d185">spell_type::additional_spells</a></div><div class="ttdeci">std::vector&lt; fake_spell &gt; additional_spells</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00238">magic.h:238</a></div></div>
<div class="ttc" id="aclassspell__type_html_ae2e0120de261304cf182bbef5700c492"><div class="ttname"><a href="classspell__type.html#ae2e0120de261304cf182bbef5700c492">spell_type::skill_default</a></div><div class="ttdeci">static const skill_id skill_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00374">magic.h:374</a></div></div>
<div class="ttc" id="aclassspell__type_html_ae352f61f100a46df52791a975dd754f9"><div class="ttname"><a href="classspell__type.html#ae352f61f100a46df52791a975dd754f9">spell_type::field_intensity_increment_default</a></div><div class="ttdeci">static const float field_intensity_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00387">magic.h:387</a></div></div>
<div class="ttc" id="aclassspell__type_html_ae696150ec8cf81bc7a35102c562d4517"><div class="ttname"><a href="classspell__type.html#ae696150ec8cf81bc7a35102c562d4517">spell_type::valid_targets</a></div><div class="ttdeci">enum_bitset&lt; spell_target &gt; valid_targets</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00345">magic.h:345</a></div></div>
<div class="ttc" id="aclassspell__type_html_ae9a03b4bdfa2041bb5f7a2431ad3cfe9"><div class="ttname"><a href="classspell__type.html#ae9a03b4bdfa2041bb5f7a2431ad3cfe9">spell_type::base_casting_time_default</a></div><div class="ttdeci">static const int base_casting_time_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00417">magic.h:417</a></div></div>
<div class="ttc" id="aclassspell__type_html_aea0732988fd57d4da9622f8505d0c23d"><div class="ttname"><a href="classspell__type.html#aea0732988fd57d4da9622f8505d0c23d">spell_type::casting_time_increment_default</a></div><div class="ttdeci">static const float casting_time_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00418">magic.h:418</a></div></div>
<div class="ttc" id="aclassspell__type_html_aef9dc4b5d446dc53a65b206bc1ee2ecf"><div class="ttname"><a href="classspell__type.html#aef9dc4b5d446dc53a65b206bc1ee2ecf">spell_type::sound_id_default</a></div><div class="ttdeci">static const std::string sound_id_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00380">magic.h:380</a></div></div>
<div class="ttc" id="aclassspell__type_html_aefd93bc4dce14e7b60c6d6bd4b691613"><div class="ttname"><a href="classspell__type.html#aefd93bc4dce14e7b60c6d6bd4b691613">spell_type::accuracy_increment</a></div><div class="ttdeci">dbl_or_var accuracy_increment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00258">magic.h:258</a></div></div>
<div class="ttc" id="aclassspell__type_html_af0135c2939a0e930754f362571905b45"><div class="ttname"><a href="classspell__type.html#af0135c2939a0e930754f362571905b45">spell_type::was_loaded</a></div><div class="ttdeci">bool was_loaded</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00203">magic.h:203</a></div></div>
<div class="ttc" id="aclassspell__type_html_af13dedd3462cf8d0e0a81fb024d05976"><div class="ttname"><a href="classspell__type.html#af13dedd3462cf8d0e0a81fb024d05976">spell_type::dmg_type_default</a></div><div class="ttdeci">static const damage_type_id dmg_type_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00414">magic.h:414</a></div></div>
<div class="ttc" id="aclassspell__type_html_af233ee766e2d8180dc49cfd12abad6d6"><div class="ttname"><a href="classspell__type.html#af233ee766e2d8180dc49cfd12abad6d6">spell_type::base_casting_time</a></div><div class="ttdeci">dbl_or_var base_casting_time</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00330">magic.h:330</a></div></div>
<div class="ttc" id="aclassspell__type_html_af26dbfb0a777931b4a0449af83758ab0"><div class="ttname"><a href="classspell__type.html#af26dbfb0a777931b4a0449af83758ab0">spell_type::energy_increment_default</a></div><div class="ttdeci">static const float energy_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00411">magic.h:411</a></div></div>
<div class="ttc" id="aclassspell__type_html_af64d6acee71a4ba9f6a51459fddb9953"><div class="ttname"><a href="classspell__type.html#af64d6acee71a4ba9f6a51459fddb9953">spell_type::targeted_monster_ids</a></div><div class="ttdeci">std::set&lt; mtype_id &gt; targeted_monster_ids</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00347">magic.h:347</a></div></div>
<div class="ttc" id="aclassspell__type_html_af6d3542c439bdfbd6c34157d686af9fe"><div class="ttname"><a href="classspell__type.html#af6d3542c439bdfbd6c34157d686af9fe">spell_type::range_increment_default</a></div><div class="ttdeci">static const float range_increment_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00396">magic.h:396</a></div></div>
<div class="ttc" id="aclassspell__type_html_af764a45351f8495b3b1708ef8a05b937"><div class="ttname"><a href="classspell__type.html#af764a45351f8495b3b1708ef8a05b937">spell_type::load</a></div><div class="ttdeci">void load(const JsonObject &amp;jo, std::string_view src)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00269">magic.cpp:269</a></div></div>
<div class="ttc" id="aclassspell__type_html_af8a7ec1c8764bc1c98e5f045e8612f7f"><div class="ttname"><a href="classspell__type.html#af8a7ec1c8764bc1c98e5f045e8612f7f">spell_type::max_damage</a></div><div class="ttdeci">dbl_or_var max_damage</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00266">magic.h:266</a></div></div>
<div class="ttc" id="aclassspell__type_html_afa2cd70d2587c495c1565209b2292a36"><div class="ttname"><a href="classspell__type.html#afa2cd70d2587c495c1565209b2292a36">spell_type::effect_name</a></div><div class="ttdeci">std::string effect_name</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00226">magic.h:226</a></div></div>
<div class="ttc" id="aclassspell__type_html_afaaa44863d219ad483b230fc41bdebab"><div class="ttname"><a href="classspell__type.html#afaaa44863d219ad483b230fc41bdebab">spell_type::min_field_intensity_default</a></div><div class="ttdeci">static const int min_field_intensity_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00385">magic.h:385</a></div></div>
<div class="ttc" id="aclassspell__type_html_afca82c905601cf50d72c07a65dc56f11"><div class="ttname"><a href="classspell__type.html#afca82c905601cf50d72c07a65dc56f11">spell_type::src_mod</a></div><div class="ttdeci">mod_id src_mod</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00208">magic.h:208</a></div></div>
<div class="ttc" id="aclassspell_html"><div class="ttname"><a href="classspell.html">spell</a></div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00421">magic.h:422</a></div></div>
<div class="ttc" id="aclassspell_html_a006cfd33c15f732b2463eda1ae0686cc"><div class="ttname"><a href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">spell::get_level</a></div><div class="ttdeci">int get_level() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01570">magic.cpp:1570</a></div></div>
<div class="ttc" id="aclassspell_html_a039ec3d7b031caad827a8b7aa7e0acea"><div class="ttname"><a href="classspell.html#a039ec3d7b031caad827a8b7aa7e0acea">spell::dps</a></div><div class="ttdeci">float dps(const Character &amp;caster, const Creature &amp;target) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00693">magic.cpp:693</a></div></div>
<div class="ttc" id="aclassspell_html_a03dea8803fea1685efa62ace8ab9b082"><div class="ttname"><a href="classspell.html#a03dea8803fea1685efa62ace8ab9b082">spell::temp_range_multiplyer</a></div><div class="ttdeci">float temp_range_multiplyer</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00438">magic.h:438</a></div></div>
<div class="ttc" id="aclassspell_html_a03e3c04f223a81a850f493fb8ee65dd3"><div class="ttname"><a href="classspell.html#a03e3c04f223a81a850f493fb8ee65dd3">spell::enumerate_spell_data</a></div><div class="ttdeci">std::string enumerate_spell_data(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02409">magic.cpp:2409</a></div></div>
<div class="ttc" id="aclassspell_html_a04c24cc9ecaf5416e147dfa8b4ca3f41"><div class="ttname"><a href="classspell.html#a04c24cc9ecaf5416e147dfa8b4ca3f41">spell::spell</a></div><div class="ttdeci">spell()=default</div></div>
<div class="ttc" id="aclassspell_html_a0752e28bd2c982a681521d2012eec12d"><div class="ttname"><a href="classspell.html#a0752e28bd2c982a681521d2012eec12d">spell::cast_all_effects</a></div><div class="ttdeci">void cast_all_effects(Creature &amp;source, const tripoint &amp;target) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01833">magic.cpp:1833</a></div></div>
<div class="ttc" id="aclassspell_html_a09d10eac783473b568da11d51abd38a6"><div class="ttname"><a href="classspell.html#a09d10eac783473b568da11d51abd38a6">spell::make_sound</a></div><div class="ttdeci">void make_sound(const tripoint &amp;target, Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01440">magic.cpp:1440</a></div></div>
<div class="ttc" id="aclassspell_html_a09d458a079bc27306786045580033794"><div class="ttname"><a href="classspell.html#a09d458a079bc27306786045580033794">spell::sound_volume</a></div><div class="ttdeci">int sound_volume(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01428">magic.cpp:1428</a></div></div>
<div class="ttc" id="aclassspell_html_a0c002dde68c8222bed0a619b28e0b91a"><div class="ttname"><a href="classspell.html#a0c002dde68c8222bed0a619b28e0b91a">spell::get_difficulty</a></div><div class="ttdeci">int get_difficulty(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01147">magic.cpp:1147</a></div></div>
<div class="ttc" id="aclassspell_html_a0d3f68783edb1af2e111e85f7a1715fa"><div class="ttname"><a href="classspell.html#a0d3f68783edb1af2e111e85f7a1715fa">spell::energy_cost_string</a></div><div class="ttdeci">std::string energy_cost_string(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01353">magic.cpp:1353</a></div></div>
<div class="ttc" id="aclassspell_html_a0f7316c4f276b359eb3c4d5fb418d7a3"><div class="ttname"><a href="classspell.html#a0f7316c4f276b359eb3c4d5fb418d7a3">spell::is_valid</a></div><div class="ttdeci">bool is_valid() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01395">magic.cpp:1395</a></div></div>
<div class="ttc" id="aclassspell_html_a0fd925009e816157e71f96cddd9c55db"><div class="ttname"><a href="classspell.html#a0fd925009e816157e71f96cddd9c55db">spell::casting_time_encumbered</a></div><div class="ttdeci">bool casting_time_encumbered(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02383">magic.cpp:2383</a></div></div>
<div class="ttc" id="aclassspell_html_a10720b544d7c92b9606008819cc2896e"><div class="ttname"><a href="classspell.html#a10720b544d7c92b9606008819cc2896e">spell::effect_area</a></div><div class="ttdeci">std::set&lt; tripoint &gt; effect_area(const spell_effect::override_parameters &amp;params, const tripoint &amp;source, const tripoint &amp;target) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00873">magic.cpp:873</a></div></div>
<div class="ttc" id="aclassspell_html_a134d0709b0c5bc67e43a56ff6165854a"><div class="ttname"><a href="classspell.html#a134d0709b0c5bc67e43a56ff6165854a">spell::damage_over_time</a></div><div class="ttdeci">damage_over_time_data damage_over_time(const std::vector&lt; bodypart_str_id &gt; &amp;bps, const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00762">magic.cpp:762</a></div></div>
<div class="ttc" id="aclassspell_html_a17425a8a64b4647f35bebaafb1ac2bed"><div class="ttname"><a href="classspell.html#a17425a8a64b4647f35bebaafb1ac2bed">spell::temp_level_adjustment</a></div><div class="ttdeci">int temp_level_adjustment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00434">magic.h:434</a></div></div>
<div class="ttc" id="aclassspell_html_a1758e56413516ae56a4ee161e998c338"><div class="ttname"><a href="classspell.html#a1758e56413516ae56a4ee161e998c338">spell::xp</a></div><div class="ttdeci">int xp() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01317">magic.cpp:1317</a></div></div>
<div class="ttc" id="aclassspell_html_a1800276357c17c73c885f051c7edf1d7"><div class="ttname"><a href="classspell.html#a1800276357c17c73c885f051c7edf1d7">spell::is_spell_class</a></div><div class="ttdeci">bool is_spell_class(const trait_id &amp;mid) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01088">magic.cpp:1088</a></div></div>
<div class="ttc" id="aclassspell_html_a19e44ba50463fee4395980d76c6e6bb6"><div class="ttname"><a href="classspell.html#a19e44ba50463fee4395980d76c6e6bb6">spell::get_projectile_attack</a></div><div class="ttdeci">dealt_projectile_attack get_projectile_attack(const tripoint &amp;target, Creature &amp;hit_critter, Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01777">magic.cpp:1777</a></div></div>
<div class="ttc" id="aclassspell_html_a19feb836872fc2fe3818f933a9029f00"><div class="ttname"><a href="classspell.html#a19feb836872fc2fe3818f933a9029f00">spell::min_leveled_duration</a></div><div class="ttdeci">int min_leveled_duration(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00958">magic.cpp:958</a></div></div>
<div class="ttc" id="aclassspell_html_a1b42ae28bea14653bbc623f2f3c8a2cb"><div class="ttname"><a href="classspell.html#a1b42ae28bea14653bbc623f2f3c8a2cb">spell::summon_vehicle_id</a></div><div class="ttdeci">vproto_id summon_vehicle_id() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01799">magic.cpp:1799</a></div></div>
<div class="ttc" id="aclassspell_html_a1dc2bd4fd1f177c091237236627bd993"><div class="ttname"><a href="classspell.html#a1dc2bd4fd1f177c091237236627bd993">spell::energy_cur_string</a></div><div class="ttdeci">std::string energy_cur_string(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01373">magic.cpp:1373</a></div></div>
<div class="ttc" id="aclassspell_html_a1ed087b326bb00071482cadeff078b15"><div class="ttname"><a href="classspell.html#a1ed087b326bb00071482cadeff078b15">spell::damage_type_color</a></div><div class="ttdeci">nc_color damage_type_color() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01548">magic.cpp:1548</a></div></div>
<div class="ttc" id="aclassspell_html_a21f5450a0454bf54ca779f62fada69b6"><div class="ttname"><a href="classspell.html#a21f5450a0454bf54ca779f62fada69b6">spell::set_level</a></div><div class="ttdeci">void set_level(const Character &amp;guy, int nlevel)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01020">magic.cpp:1020</a></div></div>
<div class="ttc" id="aclassspell_html_a231a9d535b9ea869e90963f7e2351c66"><div class="ttname"><a href="classspell.html#a231a9d535b9ea869e90963f7e2351c66">spell::exp_progress</a></div><div class="ttdeci">std::string exp_progress() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01655">magic.cpp:1655</a></div></div>
<div class="ttc" id="aclassspell_html_a25db0a720eff61873d779a5db0428b16"><div class="ttname"><a href="classspell.html#a25db0a720eff61873d779a5db0428b16">spell::select_target</a></div><div class="ttdeci">std::optional&lt; tripoint &gt; select_target(Creature *source)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00794">magic.cpp:794</a></div></div>
<div class="ttc" id="aclassspell_html_a2857365ef6cc65207a1ee75fc390ef13"><div class="ttname"><a href="classspell.html#a2857365ef6cc65207a1ee75fc390ef13">spell::temp_aoe_multiplyer</a></div><div class="ttdeci">float temp_aoe_multiplyer</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00437">magic.h:437</a></div></div>
<div class="ttc" id="aclassspell_html_a2d25bed9a9b942e4ada705b79dc43158"><div class="ttname"><a href="classspell.html#a2d25bed9a9b942e4ada705b79dc43158">spell::is_target_in_range</a></div><div class="ttdeci">bool is_target_in_range(const Creature &amp;caster, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01464">magic.cpp:1464</a></div></div>
<div class="ttc" id="aclassspell_html_a2e1753d54122c01ea14e9abbb2bd886f"><div class="ttname"><a href="classspell.html#a2e1753d54122c01ea14e9abbb2bd886f">spell::create_field</a></div><div class="ttdeci">void create_field(const tripoint &amp;at, Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01405">magic.cpp:1405</a></div></div>
<div class="ttc" id="aclassspell_html_a335dc296fd7e166be557e69dc6d9f147"><div class="ttname"><a href="classspell.html#a335dc296fd7e166be557e69dc6d9f147">spell::aoe_string</a></div><div class="ttdeci">std::string aoe_string(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00895">magic.cpp:895</a></div></div>
<div class="ttc" id="aclassspell_html_a33b19b10be6eded53db5dee401ba6da5"><div class="ttname"><a href="classspell.html#a33b19b10be6eded53db5dee401ba6da5">spell::damage_type_string</a></div><div class="ttdeci">std::string damage_type_string() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01556">magic.cpp:1556</a></div></div>
<div class="ttc" id="aclassspell_html_a35a5f0a79a86833afef958fe1627d198"><div class="ttname"><a href="classspell.html#a35a5f0a79a86833afef958fe1627d198">spell::accuracy</a></div><div class="ttdeci">int accuracy(Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00731">magic.cpp:731</a></div></div>
<div class="ttc" id="aclassspell_html_a35f7c66814c80a047ed87d86d13ba6c6"><div class="ttname"><a href="classspell.html#a35f7c66814c80a047ed87d86d13ba6c6">spell::temp_difficulty_adjustment</a></div><div class="ttdeci">int temp_difficulty_adjustment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00440">magic.h:440</a></div></div>
<div class="ttc" id="aclassspell_html_a37603127451eef7c25b11d8dd03d208c"><div class="ttname"><a href="classspell.html#a37603127451eef7c25b11d8dd03d208c">spell::check_if_component_in_hand</a></div><div class="ttdeci">bool check_if_component_in_hand(Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01129">magic.cpp:1129</a></div></div>
<div class="ttc" id="aclassspell_html_a381100da3ed24e4029ae1c34882dcfe7"><div class="ttname"><a href="classspell.html#a381100da3ed24e4029ae1c34882dcfe7">spell::cast_spell_effect</a></div><div class="ttdeci">void cast_spell_effect(Creature &amp;source, const tripoint &amp;target) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01819">magic.cpp:1819</a></div></div>
<div class="ttc" id="aclassspell_html_a388a3e18bba1c58aa9c00dc53bc97aef"><div class="ttname"><a href="classspell.html#a388a3e18bba1c58aa9c00dc53bc97aef">spell::spell_class</a></div><div class="ttdeci">trait_id spell_class() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00667">magic.cpp:667</a></div></div>
<div class="ttc" id="aclassspell_html_a3a661a14d3c40f8cbd2bd727e7b9f712"><div class="ttname"><a href="classspell.html#a3a661a14d3c40f8cbd2bd727e7b9f712">spell::list_targeted_monster_names</a></div><div class="ttdeci">std::string list_targeted_monster_names() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01710">magic.cpp:1710</a></div></div>
<div class="ttc" id="aclassspell_html_a3a67307def07ddc6d2e2c134d21c245f"><div class="ttname"><a href="classspell.html#a3a67307def07ddc6d2e2c134d21c245f">spell::duration</a></div><div class="ttdeci">int duration(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00965">magic.cpp:965</a></div></div>
<div class="ttc" id="aclassspell_html_a3b6438c213ded75c5d4ea791424653e8"><div class="ttname"><a href="classspell.html#a3b6438c213ded75c5d4ea791424653e8">spell::energy_cost_encumbered</a></div><div class="ttdeci">bool energy_cost_encumbered(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02398">magic.cpp:2398</a></div></div>
<div class="ttc" id="aclassspell_html_a462c98a4cef24f9d7014f7afc9118aa3"><div class="ttname"><a href="classspell.html#a462c98a4cef24f9d7014f7afc9118aa3">spell::min_leveled_dot</a></div><div class="ttdeci">int min_leveled_dot(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00743">magic.cpp:743</a></div></div>
<div class="ttc" id="aclassspell_html_a4907623e7faca6b194e24543b1862d1e"><div class="ttname"><a href="classspell.html#a4907623e7faca6b194e24543b1862d1e">spell::exp_to_next_level</a></div><div class="ttdeci">int exp_to_next_level() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01650">magic.cpp:1650</a></div></div>
<div class="ttc" id="aclassspell_html_a49cd3d61f5381025968b3f5b5109aa3b"><div class="ttname"><a href="classspell.html#a49cd3d61f5381025968b3f5b5109aa3b">spell::get_dealt_damage_instance</a></div><div class="ttdeci">dealt_damage_instance get_dealt_damage_instance(Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01770">magic.cpp:1770</a></div></div>
<div class="ttc" id="aclassspell_html_a4b1a5a0c2bd28fb4101608783f25b101"><div class="ttname"><a href="classspell.html#a4b1a5a0c2bd28fb4101608783f25b101">spell::duration_string</a></div><div class="ttdeci">std::string duration_string(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00985">magic.cpp:985</a></div></div>
<div class="ttc" id="aclassspell_html_a4bee370b3c3d69be45411856fb2f333f"><div class="ttname"><a href="classspell.html#a4bee370b3c3d69be45411856fb2f333f">spell::in_aoe</a></div><div class="ttdeci">bool in_aoe(const tripoint &amp;source, const tripoint &amp;target, const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00885">magic.cpp:885</a></div></div>
<div class="ttc" id="aclassspell_html_a4cd3c2989310be69c17be190328586c0"><div class="ttname"><a href="classspell.html#a4cd3c2989310be69c17be190328586c0">spell::can_learn</a></div><div class="ttdeci">bool can_learn(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01032">magic.cpp:1032</a></div></div>
<div class="ttc" id="aclassspell_html_a4ddf2ffd71f86bc2ca2ebca259071924"><div class="ttname"><a href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924">spell::energy_cost</a></div><div class="ttdeci">int energy_cost(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01040">magic.cpp:1040</a></div></div>
<div class="ttc" id="aclassspell_html_a4feeb99d5b76aac0263c4730be9882d5"><div class="ttname"><a href="classspell.html#a4feeb99d5b76aac0263c4730be9882d5">spell::casting_time</a></div><div class="ttdeci">int casting_time(const Character &amp;guy, bool ignore_encumb=false) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01158">magic.cpp:1158</a></div></div>
<div class="ttc" id="aclassspell_html_a526d158b9396a81cb13186db31c53ae1"><div class="ttname"><a href="classspell.html#a526d158b9396a81cb13186db31c53ae1">spell::gain_exp</a></div><div class="ttdeci">void gain_exp(const Character &amp;guy, int nxp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01322">magic.cpp:1322</a></div></div>
<div class="ttc" id="aclassspell_html_a593232b1e5fc4c81d536724d40322efd"><div class="ttname"><a href="classspell.html#a593232b1e5fc4c81d536724d40322efd">spell::energy_source</a></div><div class="ttdeci">magic_energy_type energy_source() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01459">magic.cpp:1459</a></div></div>
<div class="ttc" id="aclassspell_html_a59e8773eaa3a6236182746cbc3930d07"><div class="ttname"><a href="classspell.html#a59e8773eaa3a6236182746cbc3930d07">spell::set_message</a></div><div class="ttdeci">void set_message(const translation &amp;msg)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00657">magic.cpp:657</a></div></div>
<div class="ttc" id="aclassspell_html_a5e36e855e9cb0c85469e782cbb6a2e57"><div class="ttname"><a href="classspell.html#a5e36e855e9cb0c85469e782cbb6a2e57">spell::ignore_by_species_id</a></div><div class="ttdeci">bool ignore_by_species_id(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01524">magic.cpp:1524</a></div></div>
<div class="ttc" id="aclassspell_html_a63f22c8f5a1730ab6651342e9becbfdc"><div class="ttname"><a href="classspell.html#a63f22c8f5a1730ab6651342e9becbfdc">spell::aoe</a></div><div class="ttdeci">int aoe(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00854">magic.cpp:854</a></div></div>
<div class="ttc" id="aclassspell_html_a658a5172a4c77d28ef4aefdcc474301c"><div class="ttname"><a href="classspell.html#a658a5172a4c77d28ef4aefdcc474301c">spell::set_temp_level_adjustment</a></div><div class="ttdeci">void set_temp_level_adjustment(int adjustment)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01592">magic.cpp:1592</a></div></div>
<div class="ttc" id="aclassspell_html_a67107306974252fab83a7ee7fb8b26bb"><div class="ttname"><a href="classspell.html#a67107306974252fab83a7ee7fb8b26bb">spell::get_src</a></div><div class="ttdeci">mod_id get_src() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01153">magic.cpp:1153</a></div></div>
<div class="ttc" id="aclassspell_html_a682544edebcf289a96fc4fcd812890c8"><div class="ttname"><a href="classspell.html#a682544edebcf289a96fc4fcd812890c8">spell::gain_level</a></div><div class="ttdeci">void gain_level(const Character &amp;guy)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01005">magic.cpp:1005</a></div></div>
<div class="ttc" id="aclassspell_html_a6a41577f639cd544a78c66360e61cc2a"><div class="ttname"><a href="classspell.html#a6a41577f639cd544a78c66360e61cc2a">spell::target_by_monster_id</a></div><div class="ttdeci">bool target_by_monster_id(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01494">magic.cpp:1494</a></div></div>
<div class="ttc" id="aclassspell_html_a6f76f8894099d3d7fd0f54f765a0991e"><div class="ttname"><a href="classspell.html#a6f76f8894099d3d7fd0f54f765a0991e">spell::bp_is_affected</a></div><div class="ttdeci">bool bp_is_affected(const bodypart_str_id &amp;bp) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01400">magic.cpp:1400</a></div></div>
<div class="ttc" id="aclassspell_html_a731bc4db74246a1e9265ea6f25abd7ad"><div class="ttname"><a href="classspell.html#a731bc4db74246a1e9265ea6f25abd7ad">spell::damage_string</a></div><div class="ttdeci">std::string damage_string(const Character &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00773">magic.cpp:773</a></div></div>
<div class="ttc" id="aclassspell_html_a78b43a6e49d2fac622fe8a98ccbb9989"><div class="ttname"><a href="classspell.html#a78b43a6e49d2fac622fe8a98ccbb9989">spell::cast_extra_spell_effects</a></div><div class="ttdeci">void cast_extra_spell_effects(Creature &amp;source, const tripoint &amp;target) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01874">magic.cpp:1874</a></div></div>
<div class="ttc" id="aclassspell_html_a7a62c6ffd858fa8baeeb225aba2f06ac"><div class="ttname"><a href="classspell.html#a7a62c6ffd858fa8baeeb225aba2f06ac">spell::random_valid_target</a></div><div class="ttdeci">std::optional&lt; tripoint &gt; random_valid_target(const Creature &amp;caster, const tripoint &amp;caster_pos) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01893">magic.cpp:1893</a></div></div>
<div class="ttc" id="aclassspell_html_a7ad2e0f8de920dad808a184a5760e295"><div class="ttname"><a href="classspell.html#a7ad2e0f8de920dad808a184a5760e295">spell::gain_levels</a></div><div class="ttdeci">void gain_levels(const Character &amp;guy, int gains)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01010">magic.cpp:1010</a></div></div>
<div class="ttc" id="aclassspell_html_a7c7293c53d4dc763a6e2aa2ee1224bff"><div class="ttname"><a href="classspell.html#a7c7293c53d4dc763a6e2aa2ee1224bff">spell::get_effective_level</a></div><div class="ttdeci">int get_effective_level() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01576">magic.cpp:1576</a></div></div>
<div class="ttc" id="aclassspell_html_a7d2e3b1f81c61f10312aa50e3626b2f9"><div class="ttname"><a href="classspell.html#a7d2e3b1f81c61f10312aa50e3626b2f9">spell::temp_concentration_difficulty_multiplyer</a></div><div class="ttdeci">float temp_concentration_difficulty_multiplyer</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00443">magic.h:443</a></div></div>
<div class="ttc" id="aclassspell_html_a7d44bdaf4c9faff438e6b30973d68615"><div class="ttname"><a href="classspell.html#a7d44bdaf4c9faff438e6b30973d68615">spell::id</a></div><div class="ttdeci">spell_id id() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00662">magic.cpp:662</a></div></div>
<div class="ttc" id="aclassspell_html_a838599c428e33e70b7e62b3e195dc6b9"><div class="ttname"><a href="classspell.html#a838599c428e33e70b7e62b3e195dc6b9">spell::alt_message</a></div><div class="ttdeci">translation alt_message</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00447">magic.h:447</a></div></div>
<div class="ttc" id="aclassspell_html_a85529eef5a29f1e17b390ae63869c781"><div class="ttname"><a href="classspell.html#a85529eef5a29f1e17b390ae63869c781">spell::min_leveled_damage</a></div><div class="ttdeci">int min_leveled_damage(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00685">magic.cpp:685</a></div></div>
<div class="ttc" id="aclassspell_html_a8c41a03e09eb196bd6c59ff29f3f61c1"><div class="ttname"><a href="classspell.html#a8c41a03e09eb196bd6c59ff29f3f61c1">spell::get_max_level</a></div><div class="ttdeci">int get_max_level(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01581">magic.cpp:1581</a></div></div>
<div class="ttc" id="aclassspell_html_a8fabcf473532ae18478ca8c826543ebe"><div class="ttname"><a href="classspell.html#a8fabcf473532ae18478ca8c826543ebe">spell::no_hands</a></div><div class="ttdeci">bool no_hands() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01083">magic.cpp:1083</a></div></div>
<div class="ttc" id="aclassspell_html_a9917a8122ab05a8c6a88da3d699546b3"><div class="ttname"><a href="classspell.html#a9917a8122ab05a8c6a88da3d699546b3">spell::targetable_locations</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; targetable_locations(const Character &amp;source) const</div><div class="ttdoc">all of the tripoints the spell can be cast at.</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00919">magic.cpp:919</a></div></div>
<div class="ttc" id="aclassspell_html_a9a0b1eb365a5b17870ea15171a60ee14"><div class="ttname"><a href="classspell.html#a9a0b1eb365a5b17870ea15171a60ee14">spell::field_intensity</a></div><div class="ttdeci">int field_intensity(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00677">magic.cpp:677</a></div></div>
<div class="ttc" id="aclassspell_html_aa34fc8ebf8b820ac055f4b4dd9d78c35"><div class="ttname"><a href="classspell.html#aa34fc8ebf8b820ac055f4b4dd9d78c35">spell::effect</a></div><div class="ttdeci">std::string effect() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01454">magic.cpp:1454</a></div></div>
<div class="ttc" id="aclassspell_html_aa609bae14a69c0987d562a2a9f8a1268"><div class="ttname"><a href="classspell.html#aa609bae14a69c0987d562a2a9f8a1268">spell::has_flag</a></div><div class="ttdeci">bool has_flag(const spell_flag &amp;flag) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01074">magic.cpp:1074</a></div></div>
<div class="ttc" id="aclassspell_html_aa9c08f86e5d6ba271db251ade738afd8"><div class="ttname"><a href="classspell.html#aa9c08f86e5d6ba271db251ade738afd8">spell::target_by_species_id</a></div><div class="ttdeci">bool target_by_species_id(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01508">magic.cpp:1508</a></div></div>
<div class="ttc" id="aclassspell_html_aaebea12d6d996597d17c65e3b5445807"><div class="ttname"><a href="classspell.html#aaebea12d6d996597d17c65e3b5445807">spell::set_temp_adjustment</a></div><div class="ttdeci">void set_temp_adjustment(const std::string &amp;target_property, float adjustment)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01598">magic.cpp:1598</a></div></div>
<div class="ttc" id="aclassspell_html_aaf83b0a24bf04d172819c3c82317a7c6"><div class="ttname"><a href="classspell.html#aaf83b0a24bf04d172819c3c82317a7c6">spell::damage_dot</a></div><div class="ttdeci">int damage_dot(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00750">magic.cpp:750</a></div></div>
<div class="ttc" id="aclassspell_html_ab00175ffc465d406a7ec24331c6c55f2"><div class="ttname"><a href="classspell.html#ab00175ffc465d406a7ec24331c6c55f2">spell::range</a></div><div class="ttdeci">int range(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00905">magic.cpp:905</a></div></div>
<div class="ttc" id="aclassspell_html_ab2631d5fc9da8a5ec04f7c3757e6c9f5"><div class="ttname"><a href="classspell.html#ab2631d5fc9da8a5ec04f7c3757e6c9f5">spell::can_cast</a></div><div class="ttdeci">bool can_cast(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01093">magic.cpp:1093</a></div></div>
<div class="ttc" id="aclassspell_html_ab26955ff4600c3a2855e6fe02dc0d216"><div class="ttname"><a href="classspell.html#ab26955ff4600c3a2855e6fe02dc0d216">spell::shape</a></div><div class="ttdeci">spell_shape shape() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01312">magic.cpp:1312</a></div></div>
<div class="ttc" id="aclassspell_html_ab4c5d1958442f999fe006be4d89883cf"><div class="ttname"><a href="classspell.html#ab4c5d1958442f999fe006be4d89883cf">spell::skill</a></div><div class="ttdeci">skill_id skill() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00672">magic.cpp:672</a></div></div>
<div class="ttc" id="aclassspell_html_ab6f8776ac707639708392c616d93fa58"><div class="ttname"><a href="classspell.html#ab6f8776ac707639708392c616d93fa58">spell::effect_data</a></div><div class="ttdeci">std::string effect_data() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01794">magic.cpp:1794</a></div></div>
<div class="ttc" id="aclassspell_html_abbefbc21e6bf90db7b45cae05c3a6c9f"><div class="ttname"><a href="classspell.html#abbefbc21e6bf90db7b45cae05c3a6c9f">spell::temp_sound_multiplyer</a></div><div class="ttdeci">float temp_sound_multiplyer</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00442">magic.h:442</a></div></div>
<div class="ttc" id="aclassspell_html_abdf34d5415c3fdafcd84fe3a7101bddb"><div class="ttname"><a href="classspell.html#abdf34d5415c3fdafcd84fe3a7101bddb">spell::name</a></div><div class="ttdeci">std::string name() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01207">magic.cpp:1207</a></div></div>
<div class="ttc" id="aclassspell_html_abeb00e3b3567c2b124b847c07fcd4555"><div class="ttname"><a href="classspell.html#abeb00e3b3567c2b124b847c07fcd4555">spell::get_temp_level_adjustment</a></div><div class="ttdeci">int get_temp_level_adjustment() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01587">magic.cpp:1587</a></div></div>
<div class="ttc" id="aclassspell_html_ac0702e64e2757dd74767f00f2e4cd159"><div class="ttname"><a href="classspell.html#ac0702e64e2757dd74767f00f2e4cd159">spell::is_max_level</a></div><div class="ttdeci">bool is_max_level(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01026">magic.cpp:1026</a></div></div>
<div class="ttc" id="aclassspell_html_ac4826c2795f1db1547ef57ccd408f8cf"><div class="ttname"><a href="classspell.html#ac4826c2795f1db1547ef57ccd408f8cf">spell::message</a></div><div class="ttdeci">std::string message() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01212">magic.cpp:1212</a></div></div>
<div class="ttc" id="aclassspell_html_ac5425e8c7206d7502f6c403f95938d7b"><div class="ttname"><a href="classspell.html#ac5425e8c7206d7502f6c403f95938d7b">spell::dmg_type</a></div><div class="ttdeci">const damage_type_id &amp; dmg_type() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01758">magic.cpp:1758</a></div></div>
<div class="ttc" id="aclassspell_html_acacc930abceced994590480b878ccdd8"><div class="ttname"><a href="classspell.html#acacc930abceced994590480b878ccdd8">spell::type</a></div><div class="ttdeci">spell_id type</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00426">magic.h:426</a></div></div>
<div class="ttc" id="aclassspell_html_acc66691f05cd20a085370d79df52bafa"><div class="ttname"><a href="classspell.html#acc66691f05cd20a085370d79df52bafa">spell::description</a></div><div class="ttdeci">std::string description() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01543">magic.cpp:1543</a></div></div>
<div class="ttc" id="aclassspell_html_ad0fe357d9c04c94f9c6329c89d683dae"><div class="ttname"><a href="classspell.html#ad0fe357d9c04c94f9c6329c89d683dae">spell::duration_turns</a></div><div class="ttdeci">time_duration duration_turns(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01000">magic.cpp:1000</a></div></div>
<div class="ttc" id="aclassspell_html_ad25f9b130e010a30b39d8996f7ef92e4"><div class="ttname"><a href="classspell.html#ad25f9b130e010a30b39d8996f7ef92e4">spell::list_targeted_species_names</a></div><div class="ttdeci">std::string list_targeted_species_names() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01726">magic.cpp:1726</a></div></div>
<div class="ttc" id="aclassspell_html_ad2aedf645ec1614d5a4d832a7d411e22"><div class="ttname"><a href="classspell.html#ad2aedf645ec1614d5a4d832a7d411e22">spell::temp_cast_time_multiplyer</a></div><div class="ttdeci">float temp_cast_time_multiplyer</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00435">magic.h:435</a></div></div>
<div class="ttc" id="aclassspell_html_ad4dff616ba1d80004e9da4b9858b54ea"><div class="ttname"><a href="classspell.html#ad4dff616ba1d80004e9da4b9858b54ea">spell::exp_for_level</a></div><div class="ttdeci">static int exp_for_level(int level)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01641">magic.cpp:1641</a></div></div>
<div class="ttc" id="aclassspell_html_ad572a7c2376afa1bd84ca8ab9603ed2a"><div class="ttname"><a href="classspell.html#ad572a7c2376afa1bd84ca8ab9603ed2a">spell::damage</a></div><div class="ttdeci">int damage(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00705">magic.cpp:705</a></div></div>
<div class="ttc" id="aclassspell_html_ad7a99f3d7def292a3e9af0b869e51103"><div class="ttname"><a href="classspell.html#ad7a99f3d7def292a3e9af0b869e51103">spell::exp_modifier</a></div><div class="ttdeci">float exp_modifier(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01666">magic.cpp:1666</a></div></div>
<div class="ttc" id="aclassspell_html_ad83fcc2ff2b800a12c1a14c65103e1c7"><div class="ttname"><a href="classspell.html#ad83fcc2ff2b800a12c1a14c65103e1c7">spell::min_leveled_accuracy</a></div><div class="ttdeci">int min_leveled_accuracy(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00724">magic.cpp:724</a></div></div>
<div class="ttc" id="aclassspell_html_ad8662455c101a353ea64618a49908a4b"><div class="ttname"><a href="classspell.html#ad8662455c101a353ea64618a49908a4b">spell::has_components</a></div><div class="ttdeci">bool has_components() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01202">magic.cpp:1202</a></div></div>
<div class="ttc" id="aclassspell_html_ad8ebcd422eb7d3caefc7c413ba9a910e"><div class="ttname"><a href="classspell.html#ad8ebcd422eb7d3caefc7c413ba9a910e">spell::use_components</a></div><div class="ttdeci">void use_components(Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01112">magic.cpp:1112</a></div></div>
<div class="ttc" id="aclassspell_html_ada3a6b9f7ba0c643ee59b8389b9f56ec"><div class="ttname"><a href="classspell.html#ada3a6b9f7ba0c643ee59b8389b9f56ec">spell::spell_fail</a></div><div class="ttdeci">float spell_fail(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01220">magic.cpp:1220</a></div></div>
<div class="ttc" id="aclassspell_html_adb7b86747726cfee704cd4a91009b93c"><div class="ttname"><a href="classspell.html#adb7b86747726cfee704cd4a91009b93c">spell::casting_exp</a></div><div class="ttdeci">int casting_exp(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01675">magic.cpp:1675</a></div></div>
<div class="ttc" id="aclassspell_html_adc1aee8fd855fce28ebb1dcc39e37a12"><div class="ttname"><a href="classspell.html#adc1aee8fd855fce28ebb1dcc39e37a12">spell::is_valid_target</a></div><div class="ttdeci">bool is_valid_target(const Creature &amp;caster, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01474">magic.cpp:1474</a></div></div>
<div class="ttc" id="aclassspell_html_add2c742d2996e6c81ab5b70b081544d9"><div class="ttname"><a href="classspell.html#add2c742d2996e6c81ab5b70b081544d9">spell::set_exp</a></div><div class="ttdeci">void set_exp(int nxp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01332">magic.cpp:1332</a></div></div>
<div class="ttc" id="aclassspell_html_add38c2281c13a3e1531b72db141b2a4b"><div class="ttname"><a href="classspell.html#add38c2281c13a3e1531b72db141b2a4b">spell::temp_spell_cost_multiplyer</a></div><div class="ttdeci">float temp_spell_cost_multiplyer</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00436">magic.h:436</a></div></div>
<div class="ttc" id="aclassspell_html_ae1585ff21871ebf0e2274b4e98582360"><div class="ttname"><a href="classspell.html#ae1585ff21871ebf0e2274b4e98582360">spell::get_damage_instance</a></div><div class="ttdeci">damage_instance get_damage_instance(Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01763">magic.cpp:1763</a></div></div>
<div class="ttc" id="aclassspell_html_ae1e6dd5185da5ec685fabeced2a8b73b"><div class="ttname"><a href="classspell.html#ae1e6dd5185da5ec685fabeced2a8b73b">spell::list_ignored_species_names</a></div><div class="ttdeci">std::string list_ignored_species_names() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01742">magic.cpp:1742</a></div></div>
<div class="ttc" id="aclassspell_html_ae3c8a866c5a9199636ed5601844f2399"><div class="ttname"><a href="classspell.html#ae3c8a866c5a9199636ed5601844f2399">spell::clear_temp_adjustments</a></div><div class="ttdeci">void clear_temp_adjustments()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01624">magic.cpp:1624</a></div></div>
<div class="ttc" id="aclassspell_html_ae4e58f791f76940f5f07c361c745168e"><div class="ttname"><a href="classspell.html#ae4e58f791f76940f5f07c361c745168e">spell::temp_somatic_difficulty_multiplyer</a></div><div class="ttdeci">float temp_somatic_difficulty_multiplyer</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00441">magic.h:441</a></div></div>
<div class="ttc" id="aclassspell_html_ae81b37281ed73857316479ab0bbb2395"><div class="ttname"><a href="classspell.html#ae81b37281ed73857316479ab0bbb2395">spell::min_leveled_aoe</a></div><div class="ttdeci">int min_leveled_aoe(const Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00847">magic.cpp:847</a></div></div>
<div class="ttc" id="aclassspell_html_aeb55e6084337fb199e3cab09260ad916"><div class="ttname"><a href="classspell.html#aeb55e6084337fb199e3cab09260ad916">spell::energy_string</a></div><div class="ttdeci">std::string energy_string() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01337">magic.cpp:1337</a></div></div>
<div class="ttc" id="aclassspell_html_af12e38d6e97fefcf10174cd91df53bd4"><div class="ttname"><a href="classspell.html#af12e38d6e97fefcf10174cd91df53bd4">spell::heal</a></div><div class="ttdeci">int heal(const tripoint &amp;target, Creature &amp;caster) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01804">magic.cpp:1804</a></div></div>
<div class="ttc" id="aclassspell_html_af5435ef2b2d958b64074ba3846dd96c4"><div class="ttname"><a href="classspell.html#af5435ef2b2d958b64074ba3846dd96c4">spell::enumerate_targets</a></div><div class="ttdeci">std::string enumerate_targets() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01683">magic.cpp:1683</a></div></div>
<div class="ttc" id="aclassspell_html_af69dedf22c42ebc9fb41f8f22102630d"><div class="ttname"><a href="classspell.html#af69dedf22c42ebc9fb41f8f22102630d">spell::components</a></div><div class="ttdeci">const requirement_data &amp; components() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01197">magic.cpp:1197</a></div></div>
<div class="ttc" id="aclassspell_html_afca00dce83ea257e838d8cfade31955c"><div class="ttname"><a href="classspell.html#afca00dce83ea257e838d8cfade31955c">spell::temp_duration_multiplyer</a></div><div class="ttdeci">float temp_duration_multiplyer</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00439">magic.h:439</a></div></div>
<div class="ttc" id="aclassspell_html_afe11a0854d38e947a10d02e29f7fd84c"><div class="ttname"><a href="classspell.html#afe11a0854d38e947a10d02e29f7fd84c">spell::colorized_fail_percent</a></div><div class="ttdeci">std::string colorized_fail_percent(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01289">magic.cpp:1289</a></div></div>
<div class="ttc" id="aclassspell_html_afe669e2e24cdf747a0133eb892eb1aa1"><div class="ttname"><a href="classspell.html#afe669e2e24cdf747a0133eb892eb1aa1">spell::experience</a></div><div class="ttdeci">int experience</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00429">magic.h:429</a></div></div>
<div class="ttc" id="aclassspellbook__callback_html_a2722c690a5d2dc3a64b0620818de12e5"><div class="ttname"><a href="classspellbook__callback.html#a2722c690a5d2dc3a64b0620818de12e5">spellbook_callback::spells</a></div><div class="ttdeci">std::vector&lt; spell_type &gt; spells</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00862">magic.h:862</a></div></div>
<div class="ttc" id="aclassspellbook__callback_html_a459cd620b3b7f5024903449e3c0f7638"><div class="ttname"><a href="classspellbook__callback.html#a459cd620b3b7f5024903449e3c0f7638">spellbook_callback::refresh</a></div><div class="ttdeci">void refresh(uilist *menu) override</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02968">magic.cpp:2968</a></div></div>
<div class="ttc" id="aclassspellbook__callback_html_a7cf62ee07d7389f19eb42d1f495b7443"><div class="ttname"><a href="classspellbook__callback.html#a7cf62ee07d7389f19eb42d1f495b7443">spellbook_callback::add_spell</a></div><div class="ttdeci">void add_spell(const spell_id &amp;sp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02841">magic.cpp:2841</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html"><div class="ttname"><a href="classspellcasting__callback.html">spellcasting_callback</a></div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02292">magic.cpp:2293</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_a177045736de8ee772cb9430105db4a4d"><div class="ttname"><a href="classspellcasting__callback.html#a177045736de8ee772cb9430105db4a4d">spellcasting_callback::reserved_invlets</a></div><div class="ttdeci">const std::set&lt; int &gt; reserved_invlets</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02303">magic.cpp:2303</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_a2321cf8b12bc562f402f289bd30bacf9"><div class="ttname"><a href="classspellcasting__callback.html#a2321cf8b12bc562f402f289bd30bacf9">spellcasting_callback::spell_info_text</a></div><div class="ttdeci">void spell_info_text(const spell &amp;sp, int width)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02444">magic.cpp:2444</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_a2b0ef3985557056677d093d99d89ebcf"><div class="ttname"><a href="classspellcasting__callback.html#a2b0ef3985557056677d093d99d89ebcf">spellcasting_callback::known_spells</a></div><div class="ttdeci">std::vector&lt; spell * &gt; known_spells</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02298">magic.cpp:2298</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_a3f4c176ee406929db8c3f0a28e88acef"><div class="ttname"><a href="classspellcasting__callback.html#a3f4c176ee406929db8c3f0a28e88acef">spellcasting_callback::key</a></div><div class="ttdeci">bool key(const input_context &amp;ctxt, const input_event &amp;event, int entnum, uilist *menu) override</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02309">magic.cpp:2309</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_a445a77c1dd83724de3d0cbd08f577a35"><div class="ttname"><a href="classspellcasting__callback.html#a445a77c1dd83724de3d0cbd08f577a35">spellcasting_callback::info_txt</a></div><div class="ttdeci">std::vector&lt; std::string &gt; info_txt</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02297">magic.cpp:2297</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_a7f957f81933487949cac8b46811f5998"><div class="ttname"><a href="classspellcasting__callback.html#a7f957f81933487949cac8b46811f5998">spellcasting_callback::spellcasting_callback</a></div><div class="ttdeci">spellcasting_callback(std::vector&lt; spell * &gt; &amp;spells, bool casting_ignore)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02306">magic.cpp:2306</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_a9b22742dfdbfe2e5c727631b366a3318"><div class="ttname"><a href="classspellcasting__callback.html#a9b22742dfdbfe2e5c727631b366a3318">spellcasting_callback::refresh</a></div><div class="ttdeci">void refresh(uilist *menu) override</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02341">magic.cpp:2341</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_ab2a41fc85f301e3e1c969e0890b25383"><div class="ttname"><a href="classspellcasting__callback.html#ab2a41fc85f301e3e1c969e0890b25383">spellcasting_callback::casting_ignore</a></div><div class="ttdeci">bool casting_ignore</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02304">magic.cpp:2304</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_abf0fad696380154cf0aa550fc5bece39"><div class="ttname"><a href="classspellcasting__callback.html#abf0fad696380154cf0aa550fc5bece39">spellcasting_callback::draw_spell_info</a></div><div class="ttdeci">void draw_spell_info(const uilist *menu)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02667">magic.cpp:2667</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_ad3d9c839b2b4c00656c2cbda0e25eb7a"><div class="ttname"><a href="classspellcasting__callback.html#ad3d9c839b2b4c00656c2cbda0e25eb7a">spellcasting_callback::selected_sp</a></div><div class="ttdeci">int selected_sp</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02295">magic.cpp:2295</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html_afb7af550258fe026bbcdfebff3d4c00d"><div class="ttname"><a href="classspellcasting__callback.html#afb7af550258fe026bbcdfebff3d4c00d">spellcasting_callback::scroll_pos</a></div><div class="ttdeci">int scroll_pos</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02296">magic.cpp:2296</a></div></div>
<div class="ttc" id="aclassstring__id__reader_html"><div class="ttname"><a href="classstring__id__reader.html">string_id_reader</a></div><div class="ttdoc">A generic class to store objects identified by a string_id.</div><div class="ttdef"><b>Definition:</b> <a href="generic__factory_8h_source.html#l01317">generic_factory.h:1318</a></div></div>
<div class="ttc" id="aclassstring__id_html"><div class="ttname"><a href="classstring__id.html">string_id&lt; json_flag &gt;</a></div></div>
<div class="ttc" id="aclassstring__id_html_a1b2100ed077789ba45aaf5081791b36c"><div class="ttname"><a href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">string_id&lt; damage_type &gt;::NULL_ID</a></div><div class="ttdeci">static const string_id&lt; damage_type &gt; &amp; NULL_ID()</div><div class="ttdoc">Returns a null id whose string_id&lt;T&gt;::is_null() must always return true.</div></div>
<div class="ttc" id="aclassstring__id_html_a2c0e3a434bcb9e3c353b337053ff22d8"><div class="ttname"><a href="classstring__id.html#a2c0e3a434bcb9e3c353b337053ff22d8">string_id::c_str</a></div><div class="ttdeci">const char * c_str() const</div><div class="ttdoc">Interface to the plain C-string of the id.</div><div class="ttdef"><b>Definition:</b> <a href="string__id_8h_source.html#l00252">string_id.h:252</a></div></div>
<div class="ttc" id="aclassstring__id_html_a4796245d3cd6e0283670698a98d46ae9"><div class="ttname"><a href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">string_id::obj</a></div><div class="ttdeci">const T &amp; obj() const</div><div class="ttdoc">Returns the actual object this id refers to.</div><div class="ttdef"><b>Definition:</b> <a href="achievement_8cpp_source.html#l00071">achievement.cpp:71</a></div></div>
<div class="ttc" id="aclassstring__id_html_a8ca0e76fa665125f1e50bd1ed8dbd213"><div class="ttname"><a href="classstring__id.html#a8ca0e76fa665125f1e50bd1ed8dbd213">string_id::is_valid</a></div><div class="ttdeci">bool is_valid() const</div><div class="ttdoc">Returns whether this id is valid, that means whether it refers to an existing object.</div><div class="ttdef"><b>Definition:</b> <a href="achievement_8cpp_source.html#l00078">achievement.cpp:78</a></div></div>
<div class="ttc" id="aclassstring__id_html_ac180a60056901aaf79f5c4b728a257bd"><div class="ttname"><a href="classstring__id.html#ac180a60056901aaf79f5c4b728a257bd">string_id::is_empty</a></div><div class="ttdeci">bool is_empty() const</div><div class="ttdoc">Returns whether this id is empty.</div><div class="ttdef"><b>Definition:</b> <a href="string__id_8h_source.html#l00303">string_id.h:303</a></div></div>
<div class="ttc" id="aclassstring__id_html_ae75b0a209b55081a67c5fe6c17a4be00"><div class="ttname"><a href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">string_id::str</a></div><div class="ttdeci">const std::string &amp; str() const</div><div class="ttdoc">Returns the identifier as plain std::string.</div><div class="ttdef"><b>Definition:</b> <a href="string__id_8h_source.html#l00260">string_id.h:260</a></div></div>
<div class="ttc" id="aclasstime__duration_html"><div class="ttname"><a href="classtime__duration.html">time_duration</a></div><div class="ttdoc">A duration defined as a number of specific time units.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00196">calendar.h:197</a></div></div>
<div class="ttc" id="aclasstime__duration_html_aacd074821aecb38a24d9ce6ca42a9127"><div class="ttname"><a href="classtime__duration.html#aacd074821aecb38a24d9ce6ca42a9127">time_duration::from_moves</a></div><div class="ttdeci">static constexpr time_duration from_moves(const T t)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00225">calendar.h:225</a></div></div>
<div class="ttc" id="aclasstranslation_html"><div class="ttname"><a href="classtranslation.html">translation</a></div><div class="ttdoc">Class for storing translation context and raw string for deferred translation.</div><div class="ttdef"><b>Definition:</b> <a href="translation_8h_source.html#l00017">translation.h:18</a></div></div>
<div class="ttc" id="aclasstranslation_html_a30b5b9d586c786942c2321701a53e572"><div class="ttname"><a href="classtranslation.html#a30b5b9d586c786942c2321701a53e572">translation::translated</a></div><div class="ttdeci">std::string translated(int num=1) const</div><div class="ttdoc">Returns raw string if no translation is needed, otherwise returns the translated string.</div><div class="ttdef"><b>Definition:</b> <a href="translation_8cpp_source.html#l00294">translation.cpp:294</a></div></div>
<div class="ttc" id="aclasstranslation_html_a85e9c5ae8df7eb6df7bac2473b9716dd"><div class="ttname"><a href="classtranslation.html#a85e9c5ae8df7eb6df7bac2473b9716dd">translation::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdoc">Whether the underlying string is empty, not matter what the context is or whether translation is need...</div><div class="ttdef"><b>Definition:</b> <a href="translation_8cpp_source.html#l00327">translation.cpp:327</a></div></div>
<div class="ttc" id="aclassuilist__callback_html"><div class="ttname"><a href="classuilist__callback.html">uilist_callback</a></div><div class="ttdoc">uilist::query() handles most input events first, and then passes the event to the callback if it can'...</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00211">ui.h:212</a></div></div>
<div class="ttc" id="aclassuilist_html"><div class="ttname"><a href="classuilist.html">uilist</a></div><div class="ttdoc">uilist: scrolling vertical list menu</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00231">ui.h:232</a></div></div>
<div class="ttc" id="aclassuilist_html_a0ac658b356c6db04812fcb6903ac4eaa"><div class="ttname"><a href="classuilist.html#a0ac658b356c6db04812fcb6903ac4eaa">uilist::w_height</a></div><div class="ttdeci">int w_height</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00483">ui.h:483</a></div></div>
<div class="ttc" id="aclassuilist_html_a0baa34622db6972a59d47d478bfd21d6"><div class="ttname"><a href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">uilist::ret</a></div><div class="ttdeci">int ret</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00525">ui.h:525</a></div></div>
<div class="ttc" id="aclassuilist_html_a18fd9765355d9e418bc2c399048e0645"><div class="ttname"><a href="classuilist.html#a18fd9765355d9e418bc2c399048e0645">uilist::addentry</a></div><div class="ttdeci">void addentry(const std::string &amp;txt)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01210">ui.cpp:1210</a></div></div>
<div class="ttc" id="aclassuilist_html_a363d10490fb72bde7b2537fd06836802"><div class="ttname"><a href="classuilist.html#a363d10490fb72bde7b2537fd06836802">uilist::window</a></div><div class="ttdeci">catacurses::window window</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00479">ui.h:479</a></div></div>
<div class="ttc" id="aclassuilist_html_a3d9259dd0d2627c4768fb4a17cddf3b6"><div class="ttname"><a href="classuilist.html#a3d9259dd0d2627c4768fb4a17cddf3b6">uilist::input_category</a></div><div class="ttdeci">std::string input_category</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00424">ui.h:424</a></div></div>
<div class="ttc" id="aclassuilist_html_a4cf13b4a8551727083de162172d80a3d"><div class="ttname"><a href="classuilist.html#a4cf13b4a8551727083de162172d80a3d">uilist::text_color</a></div><div class="ttdeci">nc_color text_color</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00428">ui.h:428</a></div></div>
<div class="ttc" id="aclassuilist_html_a53ff5990a6abb4e7da837db31afea4b8"><div class="ttname"><a href="classuilist.html#a53ff5990a6abb4e7da837db31afea4b8">uilist::title</a></div><div class="ttdeci">std::string title</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00418">ui.h:418</a></div></div>
<div class="ttc" id="aclassuilist_html_a5dac54c98fae0ec2bc4b0ac75c9fcd57"><div class="ttname"><a href="classuilist.html#a5dac54c98fae0ec2bc4b0ac75c9fcd57">uilist::w_width_setup</a></div><div class="ttdeci">size_scalar w_width_setup</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00438">ui.h:438</a></div></div>
<div class="ttc" id="aclassuilist_html_a5e8e74d29ccd984f2f9ca63a2df21cde"><div class="ttname"><a href="classuilist.html#a5e8e74d29ccd984f2f9ca63a2df21cde">uilist::w_width</a></div><div class="ttdeci">int w_width</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00482">ui.h:482</a></div></div>
<div class="ttc" id="aclassuilist_html_a790be01eb1b3db027e262729e5e95aae"><div class="ttname"><a href="classuilist.html#a790be01eb1b3db027e262729e5e95aae">uilist::pad_right_setup</a></div><div class="ttdeci">size_scalar pad_right_setup</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00444">ui.h:444</a></div></div>
<div class="ttc" id="aclassuilist_html_a7d03ff2194b5dc30035d88d77108f6a4"><div class="ttname"><a href="classuilist.html#a7d03ff2194b5dc30035d88d77108f6a4">uilist::w_height_setup</a></div><div class="ttdeci">size_scalar w_height_setup</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00439">ui.h:439</a></div></div>
<div class="ttc" id="aclassuilist_html_a946867c48443235c3fc667a0de3d78b9"><div class="ttname"><a href="classuilist.html#a946867c48443235c3fc667a0de3d78b9">uilist::pad_right</a></div><div class="ttdeci">int pad_right</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00486">ui.h:486</a></div></div>
<div class="ttc" id="aclassuilist_html_a96c497ff6d2c333effba75839fdccede"><div class="ttname"><a href="classuilist.html#a96c497ff6d2c333effba75839fdccede">uilist::add_category</a></div><div class="ttdeci">void add_category(const std::string &amp;key, const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01269">ui.cpp:1269</a></div></div>
<div class="ttc" id="aclassuilist_html_a9b6f96a3e12c8b35fe79a2b3e4605d5c"><div class="ttname"><a href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">uilist::additional_actions</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; std::string, translation &gt; &gt; additional_actions</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00425">ui.h:425</a></div></div>
<div class="ttc" id="aclassuilist_html_a9c00fd7c5cdfee33072eca7d816a4e62"><div class="ttname"><a href="classuilist.html#a9c00fd7c5cdfee33072eca7d816a4e62">uilist::set_category</a></div><div class="ttdeci">void set_category(const std::string &amp;key)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01274">ui.cpp:1274</a></div></div>
<div class="ttc" id="aclassuilist_html_ab0890d56d6d29dd98a0b3f17bb3ebba3"><div class="ttname"><a href="classuilist.html#ab0890d56d6d29dd98a0b3f17bb3ebba3">uilist::selected</a></div><div class="ttdeci">int selected</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00526">ui.h:526</a></div></div>
<div class="ttc" id="aclassuilist_html_ab19726dc405b4debc736cb4b68cd3b49"><div class="ttname"><a href="classuilist.html#ab19726dc405b4debc736cb4b68cd3b49">uilist::pad_left</a></div><div class="ttdeci">int pad_left</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00485">ui.h:485</a></div></div>
<div class="ttc" id="aclassuilist_html_ad4f5806d1d8ab3de3af8e3285faf47d6"><div class="ttname"><a href="classuilist.html#ad4f5806d1d8ab3de3af8e3285faf47d6">uilist::callback</a></div><div class="ttdeci">uilist_callback * callback</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00434">ui.h:434</a></div></div>
<div class="ttc" id="aclassuilist_html_add589714bd51df0cbac9b947403004c1"><div class="ttname"><a href="classuilist.html#add589714bd51df0cbac9b947403004c1">uilist::set_category_filter</a></div><div class="ttdeci">void set_category_filter(const std::function&lt; bool(const uilist_entry &amp;, const std::string &amp;)&gt; &amp;fun)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01283">ui.cpp:1283</a></div></div>
<div class="ttc" id="aclassuilist_html_ae4ae08b4f010935825c956ea705065aa"><div class="ttname"><a href="classuilist.html#ae4ae08b4f010935825c956ea705065aa">uilist::hilight_disabled</a></div><div class="ttdeci">bool hilight_disabled</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00467">ui.h:467</a></div></div>
<div class="ttc" id="aclassuilist_html_af5fc2972d43a795c49a632dbcf58132b"><div class="ttname"><a href="classuilist.html#af5fc2972d43a795c49a632dbcf58132b">uilist::entries</a></div><div class="ttdeci">std::vector&lt; uilist_entry &gt; entries</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00422">ui.h:422</a></div></div>
<div class="ttc" id="acolor_8cpp_html_a0f25678be1fc95cb81381a004493a4cc"><div class="ttname"><a href="color_8cpp.html#a0f25678be1fc95cb81381a004493a4cc">colorize</a></div><div class="ttdeci">std::string colorize(const std::string &amp;text, const nc_color &amp;color)</div><div class="ttdef"><b>Definition:</b> <a href="color_8cpp_source.html#l00742">color.cpp:742</a></div></div>
<div class="ttc" id="acolor_8h_html"><div class="ttname"><a href="color_8h.html">color.h</a></div></div>
<div class="ttc" id="acolor_8h_html_a0d06dc49b9761bbc54607397213728bb"><div class="ttname"><a href="color_8h.html#a0d06dc49b9761bbc54607397213728bb">c_white</a></div><div class="ttdeci">#define c_white</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00016">color.h:16</a></div></div>
<div class="ttc" id="acolor_8h_html_a1b1e3c0bef566a83c3535e38a93ad733"><div class="ttname"><a href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a></div><div class="ttdeci">#define c_light_gray</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00017">color.h:17</a></div></div>
<div class="ttc" id="acolor_8h_html_a1cb87e74156596960610fd0a9ace766d"><div class="ttname"><a href="color_8h.html#a1cb87e74156596960610fd0a9ace766d">c_green</a></div><div class="ttdeci">#define c_green</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00020">color.h:20</a></div></div>
<div class="ttc" id="acolor_8h_html_a2236aa1fe66b707a104f19ad45c23230"><div class="ttname"><a href="color_8h.html#a2236aa1fe66b707a104f19ad45c23230">c_light_green</a></div><div class="ttdeci">#define c_light_green</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00026">color.h:26</a></div></div>
<div class="ttc" id="acolor_8h_html_a2d8f37367a34632745626276dd4c9da6"><div class="ttname"><a href="color_8h.html#a2d8f37367a34632745626276dd4c9da6">c_black</a></div><div class="ttdeci">#define c_black</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00015">color.h:15</a></div></div>
<div class="ttc" id="acolor_8h_html_a39fc218ef401d918701636583a85a168"><div class="ttname"><a href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a></div><div class="ttdeci">#define c_magenta</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00023">color.h:23</a></div></div>
<div class="ttc" id="acolor_8h_html_a7b00fb82de0be83f6fc5f7965ea86623"><div class="ttname"><a href="color_8h.html#a7b00fb82de0be83f6fc5f7965ea86623">c_light_blue</a></div><div class="ttdeci">#define c_light_blue</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00027">color.h:27</a></div></div>
<div class="ttc" id="acolor_8h_html_a81e80ab9142609903b4788a6bb31ae45"><div class="ttname"><a href="color_8h.html#a81e80ab9142609903b4788a6bb31ae45">c_yellow</a></div><div class="ttdeci">#define c_yellow</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00030">color.h:30</a></div></div>
<div class="ttc" id="acolor_8h_html_aab11865a3631a7ce78da82b7fb386b71"><div class="ttname"><a href="color_8h.html#aab11865a3631a7ce78da82b7fb386b71">c_light_red</a></div><div class="ttdeci">#define c_light_red</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00025">color.h:25</a></div></div>
<div class="ttc" id="acolor_8h_html_af0a87eaef36305269f4506dfa34d94c0"><div class="ttname"><a href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a></div><div class="ttdeci">#define c_red</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00019">color.h:19</a></div></div>
<div class="ttc" id="acondition_8cpp_html_a60541b4121a0b2c69c955a6727f45a5c"><div class="ttname"><a href="condition_8cpp.html#a60541b4121a0b2c69c955a6727f45a5c">get_dbl_or_var</a></div><div class="ttdeci">dbl_or_var get_dbl_or_var(const JsonObject &amp;jo, std::string_view member, bool required, double default_val)</div><div class="ttdef"><b>Definition:</b> <a href="condition_8cpp_source.html#l00206">condition.cpp:206</a></div></div>
<div class="ttc" id="acondition_8h_html"><div class="ttname"><a href="condition_8h.html">condition.h</a></div></div>
<div class="ttc" id="acondition_8h_html_a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3"><div class="ttname"><a href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">jarg::member</a></div><div class="ttdeci">@ member</div></div>
<div class="ttc" id="acoordinates_8h_html_a31847b31c6ef002e9d16afd7fd0005e3"><div class="ttname"><a href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a></div><div class="ttdeci">std::vector&lt; coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &amp;&amp;RhsInBounds &gt; &gt; line_to(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00798">coordinates.h:798</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a8e2cbab6dac12095f06b4cff66857fbb"><div class="ttname"><a href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a></div><div class="ttdeci">int rl_dist(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00769">coordinates.h:769</a></div></div>
<div class="ttc" id="acraft__command_8h_html_a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402"><div class="ttname"><a href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">usage_from::cancel</a></div><div class="ttdeci">@ cancel</div></div>
<div class="ttc" id="acreature_8h_html"><div class="ttname"><a href="creature_8h.html">creature.h</a></div></div>
<div class="ttc" id="acreature_8h_html_a299ec0c42ccc5a2d79d1739428ac3210"><div class="ttname"><a href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a></div><div class="ttdeci">int intensity</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00240">creature.h:240</a></div></div>
<div class="ttc" id="acreature_8h_html_a4b73e33b57ae387dc418906492d5f998"><div class="ttname"><a href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a></div><div class="ttdeci">bool force</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00241">creature.h:241</a></div></div>
<div class="ttc" id="acreature_8h_html_ac54f8023b2f6c4c85f60252cf47cc28d"><div class="ttname"><a href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a></div><div class="ttdeci">bodypart_id bp</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00238">creature.h:238</a></div></div>
<div class="ttc" id="acreature__tracker_8h_html"><div class="ttname"><a href="creature__tracker_8h.html">creature_tracker.h</a></div></div>
<div class="ttc" id="acreature__tracker_8h_html_a16f631f70e72b53e590770670fb301fb"><div class="ttname"><a href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a></div><div class="ttdeci">creature_tracker &amp; get_creature_tracker()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13827">game.cpp:13827</a></div></div>
<div class="ttc" id="acursesdef_8h_html"><div class="ttname"><a href="cursesdef_8h.html">cursesdef.h</a></div></div>
<div class="ttc" id="adamage_8h_html"><div class="ttname"><a href="damage_8h.html">damage.h</a></div></div>
<div class="ttc" id="adebug_8h_html"><div class="ttname"><a href="debug_8h.html">debug.h</a></div></div>
<div class="ttc" id="adebug_8h_html_a78e9818ca59dd528129905767f99fcc5"><div class="ttname"><a href="debug_8h.html#a78e9818ca59dd528129905767f99fcc5">cata_fatal</a></div><div class="ttdeci">#define cata_fatal(...)</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00083">debug.h:83</a></div></div>
<div class="ttc" id="adebug_8h_html_a87e509562277a7ada3a75330d00cb445"><div class="ttname"><a href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a></div><div class="ttdeci">#define debugmsg(...)</div><div class="ttdoc">Debug message of level D_ERROR and class D_MAIN, also includes the source file name and line,...</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00069">debug.h:69</a></div></div>
<div class="ttc" id="adialogue_8h_html_abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8"><div class="ttname"><a href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a></div><div class="ttdeci">@ action</div><div class="ttdef"><b>Definition:</b> <a href="dialogue_8h_source.html#l00044">dialogue.h:43</a></div></div>
<div class="ttc" id="adisplay_8h_html_ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f"><div class="ttname"><a href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">bodygraph_var::temp</a></div><div class="ttdeci">@ temp</div></div>
<div class="ttc" id="adisplay_8h_html_ad55df0d7f625a78f1afc728ee1a6d6a4acdc157c853354b3b2f8f3986a7b55335"><div class="ttname"><a href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4acdc157c853354b3b2f8f3986a7b55335">bodygraph_var::encumb</a></div><div class="ttdeci">@ encumb</div></div>
<div class="ttc" id="aeditmap_8cpp_html_a025a5c063205294df20818edc4cfe355"><div class="ttname"><a href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a></div><div class="ttdeci">static nc_color color(const T_t &amp;t)</div></div>
<div class="ttc" id="aenum__conversions_8h_html"><div class="ttname"><a href="enum__conversions_8h.html">enum_conversions.h</a></div></div>
<div class="ttc" id="aenums_8h_html"><div class="ttname"><a href="enums_8h.html">enums.h</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10">m_good</a></div><div class="ttdeci">@ m_good</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00347">enums.h:347</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a></div><div class="ttdeci">@ m_bad</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00348">enums.h:348</a></div></div>
<div class="ttc" id="aenums_8h_html_a3c6c2b91b92d3e5471a017b197da3d29a400a66f0d4015783e72f1e33c0b7dcb8"><div class="ttname"><a href="enums_8h.html#a3c6c2b91b92d3e5471a017b197da3d29a400a66f0d4015783e72f1e33c0b7dcb8">gmf_bypass_cooldown</a></div><div class="ttdeci">@ gmf_bypass_cooldown</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00375">enums.h:375</a></div></div>
<div class="ttc" id="aevent_8h_html"><div class="ttname"><a href="event_8h.html">event.h</a></div></div>
<div class="ttc" id="aevent_8h_html_a333a7721472705fe444b24f107f9a731a15d9350620fdb06df8ad3d5410d8d54f"><div class="ttname"><a href="event_8h.html#a333a7721472705fe444b24f107f9a731a15d9350620fdb06df8ad3d5410d8d54f">event_type::player_levels_spell</a></div><div class="ttdeci">@ player_levels_spell</div></div>
<div class="ttc" id="aevent_8h_html_a333a7721472705fe444b24f107f9a731a91ebffe1a2751b920ac93e8f5549a4c2"><div class="ttname"><a href="event_8h.html#a333a7721472705fe444b24f107f9a731a91ebffe1a2751b920ac93e8f5549a4c2">event_type::character_casts_spell</a></div><div class="ttdeci">@ character_casts_spell</div></div>
<div class="ttc" id="aevent_8h_html_a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9"><div class="ttname"><a href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">event_type::character_forgets_spell</a></div><div class="ttdeci">@ character_forgets_spell</div></div>
<div class="ttc" id="aevent_8h_html_a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098"><div class="ttname"><a href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">event_type::character_learns_spell</a></div><div class="ttdeci">@ character_learns_spell</div></div>
<div class="ttc" id="aevent__bus_8h_html"><div class="ttname"><a href="event__bus_8h.html">event_bus.h</a></div></div>
<div class="ttc" id="aevent__bus_8h_html_a4f760194b9225ccf92a1419748def636"><div class="ttname"><a href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a></div><div class="ttdeci">event_bus &amp; get_event_bus()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13832">game.cpp:13832</a></div></div>
<div class="ttc" id="afield_8h_html"><div class="ttname"><a href="field_8h.html">field.h</a></div></div>
<div class="ttc" id="agame_8cpp_html_afa1063326b0c16b43c6f3dc8c3df403d"><div class="ttname"><a href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a></div><div class="ttdeci">map &amp; get_map()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13822">game.cpp:13822</a></div></div>
<div class="ttc" id="ageneric__factory_8h_html"><div class="ttname"><a href="generic__factory_8h.html">generic_factory.h</a></div><div class="ttdoc">Helper for loading from JSON.</div></div>
<div class="ttc" id="ageneric__factory_8h_html_a43443191f61bb76aca1c2895eea4ad8f"><div class="ttname"><a href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a></div><div class="ttdeci">void optional(const JsonObject &amp;jo, const bool was_loaded, const std::string_view name, MemberType &amp;member)</div><div class="ttdef"><b>Definition:</b> <a href="generic__factory_8h_source.html#l00829">generic_factory.h:829</a></div></div>
<div class="ttc" id="agroup__UI_html_ga7604af7545244003f0a52ac87ce37979"><div class="ttname"><a href="group__UI.html#ga7604af7545244003f0a52ac87ce37979">uilist::query</a></div><div class="ttdeci">void query(bool loop=true, int timeout=-1)</div><div class="ttdoc">Handle input and update display.</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01032">ui.cpp:1032</a></div></div>
<div class="ttc" id="ainput__context_8h_html"><div class="ttname"><a href="input__context_8h.html">input_context.h</a></div></div>
<div class="ttc" id="ainventory_8h_html"><div class="ttname"><a href="inventory_8h.html">inventory.h</a></div></div>
<div class="ttc" id="ainventory_8h_html_a30cdf5c616c63b894825e5e92a5b1e5c"><div class="ttname"><a href="inventory_8h.html#a30cdf5c616c63b894825e5e92a5b1e5c">inv_chars</a></div><div class="ttdeci">const invlet_wrapper inv_chars</div></div>
<div class="ttc" id="aitem_8h_html"><div class="ttname"><a href="item_8h.html">item.h</a></div></div>
<div class="ttc" id="ajson_8h_html"><div class="ttname"><a href="json_8h.html">json.h</a></div></div>
<div class="ttc" id="aline_8h_html"><div class="ttname"><a href="line_8h.html">line.h</a></div></div>
<div class="ttc" id="alocalized__comparator_8h_html"><div class="ttname"><a href="localized__comparator_8h.html">localized_comparator.h</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">static constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01566">magic.cpp:1566</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a3a15cd3f4a620df4e0fc5b4ecb0111af"><div class="ttname"><a href="magic_8cpp.html#a3a15cd3f4a620df4e0fc5b4ecb0111af">json_flag_NO_SPELLCASTING</a></div><div class="ttdeci">static const json_character_flag json_flag_NO_SPELLCASTING(&quot;NO_SPELLCASTING&quot;)</div></div>
<div class="ttc" id="amagic_8cpp_html_a4469c50b5066f32942c540b43348dc68"><div class="ttname"><a href="magic_8cpp.html#a4469c50b5066f32942c540b43348dc68">color_number</a></div><div class="ttdeci">static std::string color_number(const int num)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02846">magic.cpp:2846</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a590ef3994731209005acce4df397de71"><div class="ttname"><a href="magic_8cpp.html#a590ef3994731209005acce4df397de71">skill_spellcraft</a></div><div class="ttdeci">static const skill_id skill_spellcraft(&quot;spellcraft&quot;)</div></div>
<div class="ttc" id="amagic_8cpp_html_a59eae2fd66ff3b9691a4cacfabbd0f3b"><div class="ttname"><a href="magic_8cpp.html#a59eae2fd66ff3b9691a4cacfabbd0f3b">reflesh_favorite</a></div><div class="ttdeci">static void reflesh_favorite(uilist *menu, std::vector&lt; spell * &gt; known_spells)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02279">magic.cpp:2279</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a6753ecfe87da659675b18c2f81d6ec12"><div class="ttname"><a href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a></div><div class="ttdeci">static constexpr double c</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01568">magic.cpp:1568</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a731e644204d5a89620d50e27e5f4b43a"><div class="ttname"><a href="magic_8cpp.html#a731e644204d5a89620d50e27e5f4b43a">draw_spellbook_info</a></div><div class="ttdeci">static void draw_spellbook_info(const spell_type &amp;sp, uilist *menu)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02872">magic.cpp:2872</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a7e54b3fea40776c033ce3476443d8eed"><div class="ttname"><a href="magic_8cpp.html#a7e54b3fea40776c033ce3476443d8eed">json_flag_SUBTLE_SPELL</a></div><div class="ttdeci">static const json_character_flag json_flag_SUBTLE_SPELL(&quot;SUBTLE_SPELL&quot;)</div></div>
<div class="ttc" id="amagic_8cpp_html_a9f6573c11f8d6e7562a97ba6f807396e"><div class="ttname"><a href="magic_8cpp.html#a9f6573c11f8d6e7562a97ba6f807396e">moves_to_string</a></div><div class="ttdeci">static std::string moves_to_string(const int moves)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00260">magic.cpp:260</a></div></div>
<div class="ttc" id="amagic_8cpp_html_aa93a189fb7bbbf87be54bcc7bd11bb6f"><div class="ttname"><a href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a></div><div class="ttdeci">static constexpr double b</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01567">magic.cpp:1567</a></div></div>
<div class="ttc" id="amagic_8cpp_html_aaa151d8292663b41260f6b2c8638694a"><div class="ttname"><a href="magic_8cpp.html#aaa151d8292663b41260f6b2c8638694a">spell_infinite_loop_check</a></div><div class="ttdeci">static bool spell_infinite_loop_check(std::set&lt; spell_id &gt; spell_effects, const spell_id &amp;sp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00595">magic.cpp:595</a></div></div>
<div class="ttc" id="amagic_8cpp_html_ad199c3bc7a5d8202c5122a34588b792e"><div class="ttname"><a href="magic_8cpp.html#ad199c3bc7a5d8202c5122a34588b792e">json_flag_SILENT_SPELL</a></div><div class="ttdeci">static const json_character_flag json_flag_SILENT_SPELL(&quot;SILENT_SPELL&quot;)</div></div>
<div class="ttc" id="amagic_8cpp_html_ad4dc12b16a8db4bc3a0debd31fa0ca5d"><div class="ttname"><a href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a></div><div class="ttdeci">static const trait_id trait_NONE(&quot;NONE&quot;)</div></div>
<div class="ttc" id="amagic_8cpp_html_ad62eb3216b3dd4152ccd605b3803b5aa"><div class="ttname"><a href="magic_8cpp.html#ad62eb3216b3dd4152ccd605b3803b5aa">target_to_string</a></div><div class="ttdeci">static std::string target_to_string(spell_target data)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00065">magic.cpp:65</a></div></div>
<div class="ttc" id="amagic_8cpp_html_affad52c1fd604b4619fae07ee57a714d"><div class="ttname"><a href="magic_8cpp.html#affad52c1fd604b4619fae07ee57a714d">json_flag_NO_PSIONICS</a></div><div class="ttdeci">static const json_character_flag json_flag_NO_PSIONICS(&quot;NO_PSIONICS&quot;)</div></div>
<div class="ttc" id="amagic_8h_html"><div class="ttname"><a href="magic_8h.html">magic.h</a></div></div>
<div class="ttc" id="amagic_8h_html_a0d790bdb16f7b815ef552e2220820e9c"><div class="ttname"><a href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9c">spell_shape</a></div><div class="ttdeci">spell_shape</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00111">magic.h:111</a></div></div>
<div class="ttc" id="amagic_8h_html_a0d790bdb16f7b815ef552e2220820e9ca29d6fc960c94b5a330f850284e75ab1f"><div class="ttname"><a href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca29d6fc960c94b5a330f850284e75ab1f">spell_shape::cone</a></div><div class="ttdeci">@ cone</div></div>
<div class="ttc" id="amagic_8h_html_a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474"><div class="ttname"><a href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca6438c669e0d0de98e6929c2cc0fac474">spell_shape::line</a></div><div class="ttdeci">@ line</div></div>
<div class="ttc" id="amagic_8h_html_a0d790bdb16f7b815ef552e2220820e9ca94b7959740e5e38e177a4087ac6fffcd"><div class="ttname"><a href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca94b7959740e5e38e177a4087ac6fffcd">spell_shape::num_shapes</a></div><div class="ttdeci">@ num_shapes</div></div>
<div class="ttc" id="amagic_8h_html_a0d790bdb16f7b815ef552e2220820e9ca9e1b93b20faf4a4798c106c0db299473"><div class="ttname"><a href="magic_8h.html#a0d790bdb16f7b815ef552e2220820e9ca9e1b93b20faf4a4798c106c0db299473">spell_shape::blast</a></div><div class="ttdeci">@ blast</div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7">spell_target</a></div><div class="ttdeci">spell_target</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00100">magic.h:100</a></div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a06e3d36fa30cea095545139854ad1fb9"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a06e3d36fa30cea095545139854ad1fb9">spell_target::field</a></div><div class="ttdeci">@ field</div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a2ad733df56aaafa5650bafc9c98c6ffb"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a2ad733df56aaafa5650bafc9c98c6ffb">spell_target::ally</a></div><div class="ttdeci">@ ally</div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a334c4a4c42fdb79d7ebc3e73b517e6f8">spell_target::none</a></div><div class="ttdeci">@ none</div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc">spell_target::item</a></div><div class="ttdeci">@ item</div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a578552719239a72a2d45ad422f67d24d"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a578552719239a72a2d45ad422f67d24d">spell_target::ground</a></div><div class="ttdeci">@ ground</div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a590f53e8699817c6fa498cc11a4cbe63"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a590f53e8699817c6fa498cc11a4cbe63">spell_target::self</a></div><div class="ttdeci">@ self</div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a6a406aeb26461172ad7d4e04543dcc48"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a6a406aeb26461172ad7d4e04543dcc48">spell_target::num_spell_targets</a></div><div class="ttdeci">@ num_spell_targets</div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a8e20e5f0a627b4dd4dedc41a597ab672"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a8e20e5f0a627b4dd4dedc41a597ab672">spell_target::hostile</a></div><div class="ttdeci">@ hostile</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197b"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197b">spell_flag</a></div><div class="ttdeci">spell_flag</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00049">magic.h:49</a></div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba0169f99da4a426e9b5b04c43733d8ec8"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba0169f99da4a426e9b5b04c43733d8ec8">spell_flag::SPAWN_GROUP</a></div><div class="ttdeci">@ SPAWN_GROUP</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba0297e660e18811956462c321349a263c"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba0297e660e18811956462c321349a263c">spell_flag::CONCENTRATE</a></div><div class="ttdeci">@ CONCENTRATE</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba19813152707f85385e889ef54cdd266b"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba19813152707f85385e889ef54cdd266b">spell_flag::NO_CORPSE_QUIET</a></div><div class="ttdeci">@ NO_CORPSE_QUIET</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba2286362f6c079bf6e2dfdf7e62068021"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba2286362f6c079bf6e2dfdf7e62068021">spell_flag::IGNITE_FLAMMABLE</a></div><div class="ttdeci">@ IGNITE_FLAMMABLE</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba24ae034aca7659a9c3b08c3df679b065"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba24ae034aca7659a9c3b08c3df679b065">spell_flag::RANDOM_DAMAGE</a></div><div class="ttdeci">@ RANDOM_DAMAGE</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba315fc579dd9a280bceb7e5845c5cc675"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba315fc579dd9a280bceb7e5845c5cc675">spell_flag::POLYMORPH_GROUP</a></div><div class="ttdeci">@ POLYMORPH_GROUP</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba32c2090ece9876c90fa493fc4054151a"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba32c2090ece9876c90fa493fc4054151a">spell_flag::MUST_HAVE_CLASS_TO_LEARN</a></div><div class="ttdeci">@ MUST_HAVE_CLASS_TO_LEARN</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba340031a71f628a23e6215861f612401b"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba340031a71f628a23e6215861f612401b">spell_flag::SPAWN_WITH_DEATH_DROPS</a></div><div class="ttdeci">@ SPAWN_WITH_DEATH_DROPS</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba4a55e275f9b875f2d9419cb72ebc4d97"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba4a55e275f9b875f2d9419cb72ebc4d97">spell_flag::UNSAFE_TELEPORT</a></div><div class="ttdeci">@ UNSAFE_TELEPORT</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba501200349c2d922a2e4c5eb5d6cde0c5"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba501200349c2d922a2e4c5eb5d6cde0c5">spell_flag::RANDOM_CRITTER</a></div><div class="ttdeci">@ RANDOM_CRITTER</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba54bcf9b291726b4cf8343f61681a5cfd"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba54bcf9b291726b4cf8343f61681a5cfd">spell_flag::PERMANENT</a></div><div class="ttdeci">@ PERMANENT</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba54cdca63f8089e9058dff2c73ef37831"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba54cdca63f8089e9058dff2c73ef37831">spell_flag::NO_PROJECTILE</a></div><div class="ttdeci">@ NO_PROJECTILE</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba58cc7b1820751d4103b0014007be83f3"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba58cc7b1820751d4103b0014007be83f3">spell_flag::HOSTILE_50</a></div><div class="ttdeci">@ HOSTILE_50</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba5b16e7a428e2fc90a37998f0fb12631f"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba5b16e7a428e2fc90a37998f0fb12631f">spell_flag::NO_LEGS</a></div><div class="ttdeci">@ NO_LEGS</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba604cda0a87a71f133cff82d25d1195c2"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba604cda0a87a71f133cff82d25d1195c2">spell_flag::VERBAL</a></div><div class="ttdeci">@ VERBAL</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba60c0bff03788dc44e951565aa413a637"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba60c0bff03788dc44e951565aa413a637">spell_flag::NO_FAIL</a></div><div class="ttdeci">@ NO_FAIL</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba6281a96f78b881bbd1821d8834054992"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6281a96f78b881bbd1821d8834054992">spell_flag::RANDOM_AOE</a></div><div class="ttdeci">@ RANDOM_AOE</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba658a021a796aa5501503220adb38cf45"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba658a021a796aa5501503220adb38cf45">spell_flag::LOUD</a></div><div class="ttdeci">@ LOUD</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba66c5da0bf17c3aeb5d116a41cf020e0b"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba66c5da0bf17c3aeb5d116a41cf020e0b">spell_flag::MUTATE_TRAIT</a></div><div class="ttdeci">@ MUTATE_TRAIT</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba6833d7b952ec22ca6fef0a01ac2e4d3a">spell_flag::PSIONIC</a></div><div class="ttdeci">@ PSIONIC</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba7e92d833d7720dbe631730a6cea03346"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba7e92d833d7720dbe631730a6cea03346">spell_flag::SILENT</a></div><div class="ttdeci">@ SILENT</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba7f3501211ea094337741cf2259a3e333"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba7f3501211ea094337741cf2259a3e333">spell_flag::SOMATIC</a></div><div class="ttdeci">@ SOMATIC</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba82397545cee465e4bda1cb70ef78c0f0"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba82397545cee465e4bda1cb70ef78c0f0">spell_flag::PERMANENT_ALL_LEVELS</a></div><div class="ttdeci">@ PERMANENT_ALL_LEVELS</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba83ce92712f6d8aea3340cd5dcc2158f4"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba83ce92712f6d8aea3340cd5dcc2158f4">spell_flag::PERCENTAGE_DAMAGE</a></div><div class="ttdeci">@ PERCENTAGE_DAMAGE</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba8d901ff21b8710b02926205b244cd30d"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba8d901ff21b8710b02926205b244cd30d">spell_flag::PAIN_NORESIST</a></div><div class="ttdeci">@ PAIN_NORESIST</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba95aa3650620c7879b3276744d8284b0d"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba95aa3650620c7879b3276744d8284b0d">spell_flag::RANDOM_TARGET</a></div><div class="ttdeci">@ RANDOM_TARGET</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197bab81bbaf3469acdc62858db28297bfa0e"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197bab81bbaf3469acdc62858db28297bfa0e">spell_flag::IGNORE_WALLS</a></div><div class="ttdeci">@ IGNORE_WALLS</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197bab981b82e2e1e66ac734a980c4b8bf3bd"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197bab981b82e2e1e66ac734a980c4b8bf3bd">spell_flag::HOSTILE_SUMMON</a></div><div class="ttdeci">@ HOSTILE_SUMMON</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197bac069ee334aa83ece77ad0af5bd596ec2"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac069ee334aa83ece77ad0af5bd596ec2">spell_flag::NON_MAGICAL</a></div><div class="ttdeci">@ NON_MAGICAL</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197bac1324f642ae16e50278d5fad88240254"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac1324f642ae16e50278d5fad88240254">spell_flag::WONDER</a></div><div class="ttdeci">@ WONDER</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197bac17984263d7ed29c73a2b4fe8f783030"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197bac17984263d7ed29c73a2b4fe8f783030">spell_flag::RANDOM_DURATION</a></div><div class="ttdeci">@ RANDOM_DURATION</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197badcff654db70678d152058c282d87aa8b"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197badcff654db70678d152058c282d87aa8b">spell_flag::SWAP_POS</a></div><div class="ttdeci">@ SWAP_POS</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197bae2952c753df986965413041d46f4ba2c"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197bae2952c753df986965413041d46f4ba2c">spell_flag::RECHARM</a></div><div class="ttdeci">@ RECHARM</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197bae674ff44932849359ce070ea3ee6ca84"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197bae674ff44932849359ce070ea3ee6ca84">spell_flag::FRIENDLY_POLY</a></div><div class="ttdeci">@ FRIENDLY_POLY</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197bae93770c51d7965a32c742fadf5aa635f"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197bae93770c51d7965a32c742fadf5aa635f">spell_flag::TARGET_TELEPORT</a></div><div class="ttdeci">@ TARGET_TELEPORT</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197baeda01abd967f7e1e749ce88aab441d33"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197baeda01abd967f7e1e749ce88aab441d33">spell_flag::EXTRA_EFFECTS_FIRST</a></div><div class="ttdeci">@ EXTRA_EFFECTS_FIRST</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197baf3e1ebf88738c62c2ae49c2319642213"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197baf3e1ebf88738c62c2ae49c2319642213">spell_flag::NO_HANDS</a></div><div class="ttdeci">@ NO_HANDS</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197baf447f5c03508de4d88e340390ba7c78f"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197baf447f5c03508de4d88e340390ba7c78f">spell_flag::LAST</a></div><div class="ttdeci">@ LAST</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197baf74dd9cac3d1ddf2d67b8946417328ca"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197baf74dd9cac3d1ddf2d67b8946417328ca">spell_flag::NO_EXPLOSION_SFX</a></div><div class="ttdeci">@ NO_EXPLOSION_SFX</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1">magic_energy_type</a></div><div class="ttdeci">magic_energy_type</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00091">magic.h:91</a></div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8">magic_energy_type::none</a></div><div class="ttdeci">@ none</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f">magic_energy_type::mana</a></div><div class="ttdeci">@ mana</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1a98bd1c45684cf587ac2347a92dd7bb51"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a98bd1c45684cf587ac2347a92dd7bb51">magic_energy_type::last</a></div><div class="ttdeci">@ last</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d">magic_energy_type::bionic</a></div><div class="ttdeci">@ bionic</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">magic_energy_type::stamina</a></div><div class="ttdeci">@ stamina</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a></div><div class="ttdeci">@ hp</div></div>
<div class="ttc" id="amagic__enchantment_8h_html"><div class="ttname"><a href="magic__enchantment_8h.html">magic_enchantment.h</a></div></div>
<div class="ttc" id="amap_8h_html"><div class="ttname"><a href="map_8h.html">map.h</a></div></div>
<div class="ttc" id="amap__iterator_8h_html"><div class="ttname"><a href="map__iterator_8h.html">map_iterator.h</a></div></div>
<div class="ttc" id="amapgen_8cpp_html_a4f3a5fd278254d867d914ad5953679e2"><div class="ttname"><a href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a></div><div class="ttdeci">void line(map *m, const ter_id &amp;type, const point &amp;p1, const point &amp;p2, int z)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l07721">mapgen.cpp:7721</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a204ca52ef1b97d079c45e1cb6407f73b"><div class="ttname"><a href="math__parser__func_8h.html#a204ca52ef1b97d079c45e1cb6407f73b">floor</a></div><div class="ttdeci">double floor(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00095">math_parser_func.h:95</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a24f6ac6e06720c7cdf972a6083847132"><div class="ttname"><a href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">abs</a></div><div class="ttdeci">double abs(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00030">math_parser_func.h:30</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a5834219bcffc7118c95b395b8cdeec20"><div class="ttname"><a href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">round</a></div><div class="ttdeci">double round(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00110">math_parser_func.h:110</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a6a96e281ee5bf1967d26afebe837ad48"><div class="ttname"><a href="math__parser__func_8h.html#a6a96e281ee5bf1967d26afebe837ad48">log</a></div><div class="ttdeci">double log(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00066">math_parser_func.h:66</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a9009aa9e5eb1323238ebddffd8e1aedf"><div class="ttname"><a href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">max</a></div><div class="ttdeci">double max(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00035">math_parser_func.h:35</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a993dede52d23a9a3d15b01a342391ef4"><div class="ttname"><a href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">min</a></div><div class="ttdeci">double min(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00043">math_parser_func.h:43</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_ac9196b0cf8d9dd209db9fc00a69a55f6"><div class="ttname"><a href="math__parser__func_8h.html#ac9196b0cf8d9dd209db9fc00a69a55f6">ceil</a></div><div class="ttdeci">double ceil(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00100">math_parser_func.h:100</a></div></div>
<div class="ttc" id="amessages_8cpp_html_a54489326fc37823819c5105addfa27f2"><div class="ttname"><a href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a></div><div class="ttdeci">void add_msg(std::string msg)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8cpp_source.html#l00997">messages.cpp:997</a></div></div>
<div class="ttc" id="amessages_8h_html"><div class="ttname"><a href="messages_8h.html">messages.h</a></div></div>
<div class="ttc" id="amessages_8h_html_ab6590bda29b082a7282bcc1a9cc8f02a"><div class="ttname"><a href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a></div><div class="ttdeci">#define add_msg_debug(type,...)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8h_source.html#l00177">messages.h:177</a></div></div>
<div class="ttc" id="amongroup_8h_html"><div class="ttname"><a href="mongroup_8h.html">mongroup.h</a></div></div>
<div class="ttc" id="amonster_8h_html"><div class="ttname"><a href="monster_8h.html">monster.h</a></div></div>
<div class="ttc" id="amtype_8h_html"><div class="ttname"><a href="mtype_8h.html">mtype.h</a></div></div>
<div class="ttc" id="amutation_8h_html"><div class="ttname"><a href="mutation_8h.html">mutation.h</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02item__tname_8cpp_03_html_a0889397d959be6d4ddc65c9f196ae3e4"><div class="ttname"><a href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a0889397d959be6d4ddc65c9f196ae3e4">anonymous_namespace{item_tname.cpp}::label</a></div><div class="ttdeci">std::string label(item const &amp;it, unsigned int quantity, segment_bitset const &amp;segments)</div><div class="ttdef"><b>Definition:</b> <a href="item__tname_8cpp_source.html#l00142">item_tname.cpp:142</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02magic_8cpp_03_html_ac638dd18bbe0cfdeedc417cddaf55c00"><div class="ttname"><a href="namespaceanonymous__namespace_02magic_8cpp_03.html#ac638dd18bbe0cfdeedc417cddaf55c00">anonymous_namespace{magic.cpp}::spell_factory</a></div><div class="ttdeci">generic_factory&lt; spell_type &gt; spell_factory(&quot;spell&quot;)</div></div>
<div class="ttc" id="anamespacecata_1_1hash64__detail_html_a5ca825db6fd06946302c60daa97333e4"><div class="ttname"><a href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">cata::hash64_detail::ret</a></div><div class="ttdeci">T ret</div><div class="ttdef"><b>Definition:</b> <a href="hash__utils_8h_source.html#l00097">hash_utils.h:97</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">catacurses::yellow</a></div><div class="ttdeci">@ yellow</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00082">cursesdef.h:82</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_aa9823d249c21fa50daf277957fabb175"><div class="ttname"><a href="namespacecatacurses.html#aa9823d249c21fa50daf277957fabb175">catacurses::wnoutrefresh</a></div><div class="ttdeci">void wnoutrefresh(const window &amp;win)</div><div class="ttdef"><b>Definition:</b> <a href="ncurses__def_8cpp_source.html#l00067">ncurses_def.cpp:67</a></div></div>
<div class="ttc" id="anamespacedebugmode_html_ac654a55a1b56b11554103f87859968f2af23f8ccb0fd99b8a3db9e9223a5714a2"><div class="ttname"><a href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af23f8ccb0fd99b8a3db9e9223a5714a2">debugmode::DF_NPC</a></div><div class="ttdeci">@ DF_NPC</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00267">debug.h:267</a></div></div>
<div class="ttc" id="anamespaceenchant__vals_html_acd6a6ebb27f9ecb82b3bce1d3aef2998a6d2912cc5d535f00c9c7405dcd9f25d3"><div class="ttname"><a href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a6d2912cc5d535f00c9c7405dcd9f25d3">enchant_vals::mod::BIONIC_MANA_PENALTY</a></div><div class="ttdeci">@ BIONIC_MANA_PENALTY</div></div>
<div class="ttc" id="anamespaceenchant__vals_html_acd6a6ebb27f9ecb82b3bce1d3aef2998a886de14f24b5a2f60b4e4a88d0a95834"><div class="ttname"><a href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a886de14f24b5a2f60b4e4a88d0a95834">enchant_vals::mod::REGEN_MANA</a></div><div class="ttdeci">@ REGEN_MANA</div></div>
<div class="ttc" id="anamespaceenchant__vals_html_acd6a6ebb27f9ecb82b3bce1d3aef2998ab808652fb6f0bf7ede1ba2cdaf1f8b84"><div class="ttname"><a href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998ab808652fb6f0bf7ede1ba2cdaf1f8b84">enchant_vals::mod::MAX_MANA</a></div><div class="ttdeci">@ MAX_MANA</div></div>
<div class="ttc" id="anamespaceenchant__vals_html_acd6a6ebb27f9ecb82b3bce1d3aef2998ae9b273235243d4a251ec58ccbe1c6d1e"><div class="ttname"><a href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998ae9b273235243d4a251ec58ccbe1c6d1e">enchant_vals::mod::CASTING_TIME_MULTIPLIER</a></div><div class="ttdeci">@ CASTING_TIME_MULTIPLIER</div></div>
<div class="ttc" id="anamespaceio_html"><div class="ttname"><a href="namespaceio.html">io</a></div><div class="ttdef"><b>Definition:</b> <a href="achievement_8cpp_source.html#l00096">achievement.cpp:97</a></div></div>
<div class="ttc" id="anamespaceio_html_a6349530d530232624735ee7a4e4dc04b"><div class="ttname"><a href="namespaceio.html#a6349530d530232624735ee7a4e4dc04b">io::enum_to_string&lt; magic_energy_type &gt;</a></div><div class="ttdeci">std::string enum_to_string&lt; magic_energy_type &gt;(magic_energy_type data)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00165">magic.cpp:165</a></div></div>
<div class="ttc" id="anamespaceio_html_a83a97f58da1856e663769bfd6760c4bc"><div class="ttname"><a href="namespaceio.html#a83a97f58da1856e663769bfd6760c4bc">io::enum_to_string&lt; spell_shape &gt;</a></div><div class="ttdeci">std::string enum_to_string&lt; spell_shape &gt;(spell_shape data)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00108">magic.cpp:108</a></div></div>
<div class="ttc" id="anamespaceio_html_aa8fa8545615e452e23e6bcc8a6a3a37a"><div class="ttname"><a href="namespaceio.html#aa8fa8545615e452e23e6bcc8a6a3a37a">io::enum_to_string</a></div><div class="ttdeci">std::string enum_to_string(E)</div></div>
<div class="ttc" id="anamespaceio_html_aa9fc27bb3026b3bb037c509994b7c1f3"><div class="ttname"><a href="namespaceio.html#aa9fc27bb3026b3bb037c509994b7c1f3">io::enum_to_string&lt; spell_flag &gt;</a></div><div class="ttdeci">std::string enum_to_string&lt; spell_flag &gt;(spell_flag data)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00119">magic.cpp:119</a></div></div>
<div class="ttc" id="anamespaceio_html_acc8d7dc9e887c8b157bf1299c9fcd0ee"><div class="ttname"><a href="namespaceio.html#acc8d7dc9e887c8b157bf1299c9fcd0ee">io::enum_to_string&lt; spell_target &gt;</a></div><div class="ttdeci">std::string enum_to_string&lt; spell_target &gt;(spell_target data)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00093">magic.cpp:93</a></div></div>
<div class="ttc" id="anamespacekeycode_html_a16ca776f0df120afb4f1b16a92e2d7f7a82eca2795b3af854b612ca79c53a353e"><div class="ttname"><a href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7a82eca2795b3af854b612ca79c53a353e">keycode::space</a></div><div class="ttdeci">@ space</div><div class="ttdef"><b>Definition:</b> <a href="input_8h_source.html#l00080">input.h:80</a></div></div>
<div class="ttc" id="anamespaceom__direction_html_a8ba958ccfad28c0a5572a04dd1428f32"><div class="ttname"><a href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">om_direction::name</a></div><div class="ttdeci">std::string name(type dir)</div><div class="ttdoc">Get Human readable name of a direction.</div><div class="ttdef"><b>Definition:</b> <a href="overmap_8cpp_source.html#l06412">overmap.cpp:6412</a></div></div>
<div class="ttc" id="anamespacesounds_html_a6bb79ae1c9c3dcd8c8e0b28c66b0398d"><div class="ttname"><a href="namespacesounds.html#a6bb79ae1c9c3dcd8c8e0b28c66b0398d">sounds::sound</a></div><div class="ttdeci">void sound(const tripoint &amp;p, int vol, sound_t category, const std::string &amp;description, bool ambient=false, const std::string &amp;id=&quot;&quot;, const std::string &amp;variant=&quot;default&quot;)</div><div class="ttdoc">Sound at (p) of intensity (vol)</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8cpp_source.html#l00318">sounds.cpp:318</a></div></div>
<div class="ttc" id="anamespacesounds_html_af6b3d144906d9ccfda6824fb87e46aa3"><div class="ttname"><a href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3">sounds::sound_t</a></div><div class="ttdeci">sound_t</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8h_source.html#l00023">sounds.h:23</a></div></div>
<div class="ttc" id="anamespacesounds_html_af6b3d144906d9ccfda6824fb87e46aa3ac222ae0d4e9c59bd254b72521b9e74ed"><div class="ttname"><a href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3ac222ae0d4e9c59bd254b72521b9e74ed">sounds::sound_t::combat</a></div><div class="ttdeci">@ combat</div></div>
<div class="ttc" id="anamespacespell__effect_html_a119ecf99be57db7f769f97c984531cf0"><div class="ttname"><a href="namespacespell__effect.html#a119ecf99be57db7f769f97c984531cf0">spell_effect::shape_map</a></div><div class="ttdeci">const std::map&lt; spell_shape, std::function&lt; std::set&lt; tripoint &gt; const override_parameters &amp;, const tripoint &amp;, const tripoint &amp;)&gt; &gt; shape_map</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00807">magic.h:807</a></div></div>
<div class="ttc" id="anamespacespell__effect_html_a853f1ec509f13190ef10d85be9bf657e"><div class="ttname"><a href="namespacespell__effect.html#a853f1ec509f13190ef10d85be9bf657e">spell_effect::none</a></div><div class="ttdeci">void none(const spell &amp;sp, Creature &amp;, const tripoint &amp;target)</div><div class="ttdef"><b>Definition:</b> <a href="magic__spell__effect_8cpp_source.html#l01302">magic_spell_effect.cpp:1302</a></div></div>
<div class="ttc" id="anamespacespell__effect_html_a9e71032270fa0320ba243005a7b50a5f"><div class="ttname"><a href="namespacespell__effect.html#a9e71032270fa0320ba243005a7b50a5f">spell_effect::spell_effect_blast</a></div><div class="ttdeci">std::set&lt; tripoint &gt; spell_effect_blast(const override_parameters &amp;params, const tripoint &amp;, const tripoint &amp;target)</div><div class="ttdef"><b>Definition:</b> <a href="magic__spell__effect_8cpp_source.html#l00225">magic_spell_effect.cpp:225</a></div></div>
<div class="ttc" id="anamespacespell__effect_html_aa73cea2405311f4cb14c4d4c34ae027e"><div class="ttname"><a href="namespacespell__effect.html#aa73cea2405311f4cb14c4d4c34ae027e">spell_effect::effect_map</a></div><div class="ttdeci">const std::map&lt; std::string, std::function&lt; void(const spell &amp;, Creature &amp;, const tripoint &amp;)&gt; &gt; effect_map</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00815">magic.h:815</a></div></div>
<div class="ttc" id="anamespacetarget__handler_html_a10911d1ab9fa4b1484138f1bc379baa5"><div class="ttname"><a href="namespacetarget__handler.html#a10911d1ab9fa4b1484138f1bc379baa5">target_handler::mode_spell</a></div><div class="ttdeci">trajectory mode_spell(avatar &amp;you, spell &amp;casting, bool no_fail, bool no_mana)</div><div class="ttdoc">Casting a spell.</div><div class="ttdef"><b>Definition:</b> <a href="ranged_8cpp_source.html#l00511">ranged.cpp:511</a></div></div>
<div class="ttc" id="anamespacetarget__handler_html_aea843144f5e69546ddea88eeda177640"><div class="ttname"><a href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">target_handler::trajectory</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; trajectory</div><div class="ttdef"><b>Definition:</b> <a href="ranged_8h_source.html#l00029">ranged.h:29</a></div></div>
<div class="ttc" id="anamespaceunits_html_a7f3948de70e78d68af74fb3d119cf176"><div class="ttname"><a href="namespaceunits.html#a7f3948de70e78d68af74fb3d119cf176">units::to_kilojoule</a></div><div class="ttdeci">constexpr value_type to_kilojoule(const quantity&lt; value_type, energy_in_millijoule_tag &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00578">units.h:578</a></div></div>
<div class="ttc" id="anamespaceunits_html_a9a9f862b2cd8fb3133a67b8bf927b017"><div class="ttname"><a href="namespaceunits.html#a9a9f862b2cd8fb3133a67b8bf927b017">units::from_kilojoule</a></div><div class="ttdeci">constexpr quantity&lt; value_type, energy_in_millijoule_tag &gt; from_kilojoule(const value_type v)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00555">units.h:555</a></div></div>
<div class="ttc" id="anpc_8h_html"><div class="ttname"><a href="npc_8h.html">npc.h</a></div></div>
<div class="ttc" id="anpc__attack_8cpp_html_aafbcce917c2d2d11a56b3f35f1b642dc"><div class="ttname"><a href="npc__attack_8cpp.html#aafbcce917c2d2d11a56b3f35f1b642dc">has_obstruction</a></div><div class="ttdeci">static bool has_obstruction(const tripoint &amp;from, const tripoint &amp;to, bool check_ally=false)</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00039">npc_attack.cpp:39</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a000abea6447dfafd5f9b787aa6753609"><div class="ttname"><a href="output_8cpp.html#a000abea6447dfafd5f9b787aa6753609">TERMX</a></div><div class="ttdeci">int TERMX</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00049">output.cpp:49</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a1184e3eda011b110d09bf2dcf08228f5"><div class="ttname"><a href="output_8cpp.html#a1184e3eda011b110d09bf2dcf08228f5">mvwprintz</a></div><div class="ttdeci">void mvwprintz(const catacurses::window &amp;w, const point &amp;p, const nc_color &amp;FG, const std::string &amp;text)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l03290">output.cpp:3290</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a1e645471d321d71b235fb285da5c08ff"><div class="ttname"><a href="output_8cpp.html#a1e645471d321d71b235fb285da5c08ff">popup</a></div><div class="ttdeci">int popup(const std::string &amp;text, PopupFlags flags)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00912">output.cpp:912</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a567a63be8cb70cc3eb47bf8affced8e5"><div class="ttname"><a href="output_8cpp.html#a567a63be8cb70cc3eb47bf8affced8e5">TERMY</a></div><div class="ttdeci">int TERMY</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00050">output.cpp:50</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a64a769083b78bb93dbb99935b959f3f5"><div class="ttname"><a href="output_8cpp.html#a64a769083b78bb93dbb99935b959f3f5">print_colored_text</a></div><div class="ttdeci">void print_colored_text(const catacurses::window &amp;w, const point &amp;p, nc_color &amp;color, const nc_color &amp;base_color, const std::string_view text, const report_color_error color_error)</div><div class="ttdoc">Print text with embedded color_tags, x, y are in curses system.</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00239">output.cpp:239</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_aafdcbf1eb3398c6e92cf3b71f6c8ad03"><div class="ttname"><a href="output_8cpp.html#aafdcbf1eb3398c6e92cf3b71f6c8ad03">get_hp_bar</a></div><div class="ttdeci">std::pair&lt; std::string, nc_color &gt; get_hp_bar(const int cur_hp, const int max_hp, const bool is_mon)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l02657">output.cpp:2657</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_ab62599a77867b8f416669b92f60f4900"><div class="ttname"><a href="output_8cpp.html#ab62599a77867b8f416669b92f60f4900">query_yn</a></div><div class="ttdeci">bool query_yn(const std::string &amp;text)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00811">output.cpp:811</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_ab9659cbe9ec23a2efd813f795cb7fb73"><div class="ttname"><a href="output_8cpp.html#ab9659cbe9ec23a2efd813f795cb7fb73">fold_and_print</a></div><div class="ttdeci">int fold_and_print(const catacurses::window &amp;w, const point &amp;begin, int width, const nc_color &amp;base_color, const std::string &amp;text, const char split)</div><div class="ttdoc">Fold and print text in the given window.</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00379">output.cpp:379</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_aea67d56cef07017be061e1ceefee80df"><div class="ttname"><a href="output_8cpp.html#aea67d56cef07017be061e1ceefee80df">foldstring</a></div><div class="ttdeci">std::vector&lt; std::string &gt; foldstring(const std::string &amp;str, int width, const char split)</div><div class="ttdoc">Split the input text into separate lines and wrap long lines.</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00123">output.cpp:123</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_afb5597c87a5847c7d64b878ab3a77d5b"><div class="ttname"><a href="output_8cpp.html#afb5597c87a5847c7d64b878ab3a77d5b">mvwputch</a></div><div class="ttdeci">void mvwputch(const catacurses::window &amp;w, const point &amp;p, nc_color FG, int ch)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00590">output.cpp:590</a></div></div>
<div class="ttc" id="aoutput_8h_html"><div class="ttname"><a href="output_8h.html">output.h</a></div></div>
<div class="ttc" id="aoutput_8h_html_a33ab4e0193402fed8f74590a30fadc3c"><div class="ttname"><a href="output_8h.html#a33ab4e0193402fed8f74590a30fadc3c">LINE_XOXO</a></div><div class="ttdeci">#define LINE_XOXO</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00046">output.h:46</a></div></div>
<div class="ttc" id="aoutput_8h_html_a4a3bfadbe7ec0abb14ff53e5e2f8983e"><div class="ttname"><a href="output_8h.html#a4a3bfadbe7ec0abb14ff53e5e2f8983e">LINE_OXXX</a></div><div class="ttdeci">#define LINE_OXXX</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00055">output.h:55</a></div></div>
<div class="ttc" id="aoutput_8h_html_a4be67498ee67b5186fcae5cf706f7512"><div class="ttname"><a href="output_8h.html#a4be67498ee67b5186fcae5cf706f7512">enumerate_as_string</a></div><div class="ttdeci">std::string enumerate_as_string(const Container &amp;values, enumeration_conjunction conj=enumeration_conjunction::and_)</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00647">output.h:647</a></div></div>
<div class="ttc" id="aoutput_8h_html_a612d0d0728e93276b2b7de1fc57b096b"><div class="ttname"><a href="output_8h.html#a612d0d0728e93276b2b7de1fc57b096b">LINE_XXOX</a></div><div class="ttdeci">#define LINE_XXOX</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00053">output.h:53</a></div></div>
<div class="ttc" id="aoutput_8h_html_a776e76ac0d873faf3607d5e839f08ee3"><div class="ttname"><a href="output_8h.html#a776e76ac0d873faf3607d5e839f08ee3">popup_getkey</a></div><div class="ttdeci">int popup_getkey(const char *const mes, Args &amp;&amp;... args)</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00482">output.h:482</a></div></div>
<div class="ttc" id="aovermap_8cpp_html_a1aa258a4b1427766c283c1ae9ea81f05ac5e3b9675d114c21ad3367d318f6aa95"><div class="ttname"><a href="overmap_8cpp.html#a1aa258a4b1427766c283c1ae9ea81f05ac5e3b9675d114c21ad3367d318f6aa95">join_type::mandatory</a></div><div class="ttdeci">@ mandatory</div></div>
<div class="ttc" id="apimpl_8h_html"><div class="ttname"><a href="pimpl_8h.html">pimpl.h</a></div></div>
<div class="ttc" id="apoint_8h_html"><div class="ttname"><a href="point_8h.html">point.h</a></div></div>
<div class="ttc" id="aprojectile_8h_html"><div class="ttname"><a href="projectile_8h.html">projectile.h</a></div></div>
<div class="ttc" id="arequirements_8h_html"><div class="ttname"><a href="requirements_8h.html">requirements.h</a></div></div>
<div class="ttc" id="arng_8cpp_html_aad28bdad07401a34ecf9912708f8b750"><div class="ttname"><a href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a></div><div class="ttdeci">bool one_in(int chance)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00108">rng.cpp:108</a></div></div>
<div class="ttc" id="arng_8h_html"><div class="ttname"><a href="rng_8h.html">rng.h</a></div></div>
<div class="ttc" id="arng_8h_html_a12244355ee77108f1b08618e9962e4d1"><div class="ttname"><a href="rng_8h.html#a12244355ee77108f1b08618e9962e4d1">random_entry</a></div><div class="ttdeci">V random_entry(const C &amp;container, D default_value)</div><div class="ttdoc">Returns a random entry in the container.</div><div class="ttdef"><b>Definition:</b> <a href="rng_8h_source.html#l00104">rng.h:104</a></div></div>
<div class="ttc" id="asounds_8h_html"><div class="ttname"><a href="sounds_8h.html">sounds.h</a></div></div>
<div class="ttc" id="astring__formatter_8h_html"><div class="ttname"><a href="string__formatter_8h.html">string_formatter.h</a></div></div>
<div class="ttc" id="astring__formatter_8h_html_a8964099387da2f95396c67566bafce3d"><div class="ttname"><a href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a></div><div class="ttdeci">std::string string_format(std::string_view format, Args &amp;&amp;...args)</div><div class="ttdoc">Simple wrapper over string_formatter::parse.</div><div class="ttdef"><b>Definition:</b> <a href="string__formatter_8h_source.html#l00417">string_formatter.h:417</a></div></div>
<div class="ttc" id="astructbody__part__type_html_a5c9ac1217c128e0f487b2f460dd3fad1a4e1df3d256693afb3630685668820df4"><div class="ttname"><a href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1a4e1df3d256693afb3630685668820df4">body_part_type::type::leg</a></div><div class="ttdeci">@ leg</div></div>
<div class="ttc" id="astructbody__part__type_html_a5c9ac1217c128e0f487b2f460dd3fad1a573ce5969e9884d49d4fab77b09a306a"><div class="ttname"><a href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1a573ce5969e9884d49d4fab77b09a306a">body_part_type::type::hand</a></div><div class="ttdeci">@ hand</div></div>
<div class="ttc" id="astructbody__part__type_html_a5c9ac1217c128e0f487b2f460dd3fad1acb5786412becb979c90f606f25ad4b4f"><div class="ttname"><a href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1acb5786412becb979c90f606f25ad4b4f">body_part_type::type::mouth</a></div><div class="ttdeci">@ mouth</div></div>
<div class="ttc" id="astructbody__part__type_html_a5c9ac1217c128e0f487b2f460dd3fad1af926b3e222d7afee57071b2256839701"><div class="ttname"><a href="structbody__part__type.html#a5c9ac1217c128e0f487b2f460dd3fad1af926b3e222d7afee57071b2256839701">body_part_type::type::arm</a></div><div class="ttdeci">@ arm</div></div>
<div class="ttc" id="astructdamage__instance_html"><div class="ttname"><a href="structdamage__instance.html">damage_instance</a></div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00132">damage.h:132</a></div></div>
<div class="ttc" id="astructdamage__instance_html_a9eff5065ef6631935e95d061ca756ae4"><div class="ttname"><a href="structdamage__instance.html#a9eff5065ef6631935e95d061ca756ae4">damage_instance::add_damage</a></div><div class="ttdeci">void add_damage(const damage_type_id &amp;dt, float amt, float arpen=0.0f, float arpen_mult=1.0f, float dmg_mult=1.0f, float unc_arpen_mult=1.0f, float unc_dmg_mult=1.0f)</div><div class="ttdoc">Adds damage to the instance.</div><div class="ttdef"><b>Definition:</b> <a href="damage_8cpp_source.html#l00316">damage.cpp:316</a></div></div>
<div class="ttc" id="astructdamage__type_html_a8872089798a7b34f4766f9a672617a0a"><div class="ttname"><a href="structdamage__type.html#a8872089798a7b34f4766f9a672617a0a">damage_type::magic_color</a></div><div class="ttdeci">nc_color magic_color</div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00037">damage.h:37</a></div></div>
<div class="ttc" id="astructdamage__type_html_ab329ea5acb5b5b6cb1e6224ead89ebcf"><div class="ttname"><a href="structdamage__type.html#ab329ea5acb5b5b6cb1e6224ead89ebcf">damage_type::name</a></div><div class="ttdeci">translation name</div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00030">damage.h:30</a></div></div>
<div class="ttc" id="astructdbl__or__var__part_html_adcd0dc06e0a6dd870f4b73e9dfcb37f0"><div class="ttname"><a href="structdbl__or__var__part.html#adcd0dc06e0a6dd870f4b73e9dfcb37f0">dbl_or_var_part::dbl_val</a></div><div class="ttdeci">std::optional&lt; double &gt; dbl_val</div><div class="ttdef"><b>Definition:</b> <a href="dialogue__helpers_8h_source.html#l00137">dialogue_helpers.h:137</a></div></div>
<div class="ttc" id="astructdbl__or__var_html"><div class="ttname"><a href="structdbl__or__var.html">dbl_or_var</a></div><div class="ttdef"><b>Definition:</b> <a href="dialogue__helpers_8h_source.html#l00165">dialogue_helpers.h:165</a></div></div>
<div class="ttc" id="astructdbl__or__var_html_ab426d2cadf2a580c189c84dd2374911c"><div class="ttname"><a href="structdbl__or__var.html#ab426d2cadf2a580c189c84dd2374911c">dbl_or_var::min</a></div><div class="ttdeci">dbl_or_var_part min</div><div class="ttdef"><b>Definition:</b> <a href="dialogue__helpers_8h_source.html#l00167">dialogue_helpers.h:167</a></div></div>
<div class="ttc" id="astructdbl__or__var_html_ab65089e65e8bcff8239572030573c540"><div class="ttname"><a href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">dbl_or_var::evaluate</a></div><div class="ttdeci">double evaluate(dialogue &amp;d) const</div><div class="ttdef"><b>Definition:</b> <a href="dialogue__helpers_8cpp_source.html#l00191">dialogue_helpers.cpp:191</a></div></div>
<div class="ttc" id="astructdealt__damage__instance_html"><div class="ttname"><a href="structdealt__damage__instance.html">dealt_damage_instance</a></div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00193">damage.h:193</a></div></div>
<div class="ttc" id="astructdealt__damage__instance_html_a215bb5b13d9c221bbda09d88f8b9cdae"><div class="ttname"><a href="structdealt__damage__instance.html#a215bb5b13d9c221bbda09d88f8b9cdae">dealt_damage_instance::set_damage</a></div><div class="ttdeci">void set_damage(const damage_type_id &amp;dt, int amount)</div><div class="ttdef"><b>Definition:</b> <a href="damage_8cpp_source.html#l00568">damage.cpp:568</a></div></div>
<div class="ttc" id="astructdealt__projectile__attack_html"><div class="ttname"><a href="structdealt__projectile__attack.html">dealt_projectile_attack</a></div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00069">projectile.h:69</a></div></div>
<div class="ttc" id="astructdealt__projectile__attack_html_a466f327979e41691bc19c91e622078b6"><div class="ttname"><a href="structdealt__projectile__attack.html#a466f327979e41691bc19c91e622078b6">dealt_projectile_attack::hit_critter</a></div><div class="ttdeci">Creature * hit_critter</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00071">projectile.h:71</a></div></div>
<div class="ttc" id="astructdealt__projectile__attack_html_a7dd960a5108456f89dc1f8ef369a1096"><div class="ttname"><a href="structdealt__projectile__attack.html#a7dd960a5108456f89dc1f8ef369a1096">dealt_projectile_attack::end_point</a></div><div class="ttdeci">tripoint end_point</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00073">projectile.h:73</a></div></div>
<div class="ttc" id="astructdealt__projectile__attack_html_a93f05a2866e4dbc8c4d432a67daf8ab6"><div class="ttname"><a href="structdealt__projectile__attack.html#a93f05a2866e4dbc8c4d432a67daf8ab6">dealt_projectile_attack::proj</a></div><div class="ttdeci">projectile proj</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00070">projectile.h:70</a></div></div>
<div class="ttc" id="astructdealt__projectile__attack_html_ab874a1233da5daa95ff296cdb1ee1849"><div class="ttname"><a href="structdealt__projectile__attack.html#ab874a1233da5daa95ff296cdb1ee1849">dealt_projectile_attack::missed_by</a></div><div class="ttdeci">double missed_by</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00074">projectile.h:74</a></div></div>
<div class="ttc" id="astructdialogue_html"><div class="ttname"><a href="structdialogue.html">dialogue</a></div><div class="ttdef"><b>Definition:</b> <a href="dialogue_8h_source.html#l00184">dialogue.h:184</a></div></div>
<div class="ttc" id="astructfake__spell_html"><div class="ttname"><a href="structfake__spell.html">fake_spell</a></div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00141">magic.h:141</a></div></div>
<div class="ttc" id="astructfake__spell_html_a08de9155c3fbea0b36ddec1d73a7d5a5"><div class="ttname"><a href="structfake__spell.html#a08de9155c3fbea0b36ddec1d73a7d5a5">fake_spell::serialize</a></div><div class="ttdeci">void serialize(JsonOut &amp;json) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l03007">magic.cpp:3007</a></div></div>
<div class="ttc" id="astructfake__spell_html_a0b3a2e1b616c1146f62625e2d577634f"><div class="ttname"><a href="structfake__spell.html#a0b3a2e1b616c1146f62625e2d577634f">fake_spell::trigger_once_in</a></div><div class="ttdeci">int trigger_once_in</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00159">magic.h:159</a></div></div>
<div class="ttc" id="astructfake__spell_html_a0e93c0553212a7274c94085f50e3228f"><div class="ttname"><a href="structfake__spell.html#a0e93c0553212a7274c94085f50e3228f">fake_spell::trigger_message</a></div><div class="ttdeci">translation trigger_message</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00161">magic.h:161</a></div></div>
<div class="ttc" id="astructfake__spell_html_a153859c297963129f423a8636f884798"><div class="ttname"><a href="structfake__spell.html#a153859c297963129f423a8636f884798">fake_spell::is_valid</a></div><div class="ttdeci">bool is_valid() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02981">magic.cpp:2981</a></div></div>
<div class="ttc" id="astructfake__spell_html_a1c7c420c1d92ae415db6e26df163b1ec"><div class="ttname"><a href="structfake__spell.html#a1c7c420c1d92ae415db6e26df163b1ec">fake_spell::trigger_once_in_default</a></div><div class="ttdeci">static const int trigger_once_in_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00157">magic.h:157</a></div></div>
<div class="ttc" id="astructfake__spell_html_a351ade87eb87a5db164447a626d7aef7"><div class="ttname"><a href="structfake__spell.html#a351ade87eb87a5db164447a626d7aef7">fake_spell::max_level_default</a></div><div class="ttdeci">static const std::optional&lt; int &gt; max_level_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00144">magic.h:144</a></div></div>
<div class="ttc" id="astructfake__spell_html_a4a068f23f16e41a517d65d878a4aab85"><div class="ttname"><a href="structfake__spell.html#a4a068f23f16e41a517d65d878a4aab85">fake_spell::max_level</a></div><div class="ttdeci">std::optional&lt; int &gt; max_level</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00147">magic.h:147</a></div></div>
<div class="ttc" id="astructfake__spell_html_a59f61e26f45fbd72f16081ee60b2489e"><div class="ttname"><a href="structfake__spell.html#a59f61e26f45fbd72f16081ee60b2489e">fake_spell::level</a></div><div class="ttdeci">int level</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00151">magic.h:151</a></div></div>
<div class="ttc" id="astructfake__spell_html_a6c5ae8a2fbe530336f41d6a09530f561"><div class="ttname"><a href="structfake__spell.html#a6c5ae8a2fbe530336f41d6a09530f561">fake_spell::self_default</a></div><div class="ttdeci">static const bool self_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00153">magic.h:153</a></div></div>
<div class="ttc" id="astructfake__spell_html_aa3e038ff6094f65acb5293dccff578c3"><div class="ttname"><a href="structfake__spell.html#aa3e038ff6094f65acb5293dccff578c3">fake_spell::level_default</a></div><div class="ttdeci">static const int level_default</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00149">magic.h:149</a></div></div>
<div class="ttc" id="astructfake__spell_html_abef5b674d81d5f6009385005f20b26b9"><div class="ttname"><a href="structfake__spell.html#abef5b674d81d5f6009385005f20b26b9">fake_spell::id</a></div><div class="ttdeci">spell_id id</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00142">magic.h:142</a></div></div>
<div class="ttc" id="astructfake__spell_html_ac440226452aa226c3cf41da10d905760"><div class="ttname"><a href="structfake__spell.html#ac440226452aa226c3cf41da10d905760">fake_spell::load</a></div><div class="ttdeci">void load(const JsonObject &amp;jo)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02986">magic.cpp:2986</a></div></div>
<div class="ttc" id="astructfake__spell_html_ad449e7a0332db668ada8a54e392dad9d"><div class="ttname"><a href="structfake__spell.html#ad449e7a0332db668ada8a54e392dad9d">fake_spell::get_spell</a></div><div class="ttdeci">spell get_spell() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l03053">magic.cpp:3053</a></div></div>
<div class="ttc" id="astructfake__spell_html_ad4f9daba773dc6b7b96dcc256e9213ad"><div class="ttname"><a href="structfake__spell.html#ad4f9daba773dc6b7b96dcc256e9213ad">fake_spell::get_spell</a></div><div class="ttdeci">spell get_spell(const Creature &amp;caster, int min_level_override=0) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l03023">magic.cpp:3023</a></div></div>
<div class="ttc" id="astructfake__spell_html_ae63f19b7f34a508df35ca402a31a0074"><div class="ttname"><a href="structfake__spell.html#ae63f19b7f34a508df35ca402a31a0074">fake_spell::deserialize</a></div><div class="ttdeci">void deserialize(const JsonObject &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l03018">magic.cpp:3018</a></div></div>
<div class="ttc" id="astructfake__spell_html_afa2a4b38d223f38100fb8148d92fca2a"><div class="ttname"><a href="structfake__spell.html#afa2a4b38d223f38100fb8148d92fca2a">fake_spell::self</a></div><div class="ttdeci">bool self</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00155">magic.h:155</a></div></div>
<div class="ttc" id="astructfake__spell_html_afd432c043173deab21515ad5ae6123b0"><div class="ttname"><a href="structfake__spell.html#afd432c043173deab21515ad5ae6123b0">fake_spell::npc_trigger_message</a></div><div class="ttdeci">translation npc_trigger_message</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00163">magic.h:163</a></div></div>
<div class="ttc" id="astructgame__message__params_html"><div class="ttname"><a href="structgame__message__params.html">game_message_params</a></div><div class="ttdoc">Structure allowing a combination of game_message_type and game_message_flags.</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00380">enums.h:380</a></div></div>
<div class="ttc" id="astructinput__event_html"><div class="ttname"><a href="structinput__event.html">input_event</a></div><div class="ttdoc">An instance of an input, like a keypress etc.</div><div class="ttdef"><b>Definition:</b> <a href="input__enums_8h_source.html#l00063">input_enums.h:63</a></div></div>
<div class="ttc" id="astructlabel_html"><div class="ttname"><a href="structlabel.html">label</a></div><div class="ttdoc">Struct used for storing labels (easier to json opposed to a std::map&lt;point, std::string&gt;)</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00687">vehicle.h:687</a></div></div>
<div class="ttc" id="astructmtype_html_a9a8f4ead67d1836e3f4db624533af5aa"><div class="ttname"><a href="structmtype.html#a9a8f4ead67d1836e3f4db624533af5aa">mtype::nname</a></div><div class="ttdeci">std::string nname(unsigned int quantity=1) const</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00330">mtype.cpp:330</a></div></div>
<div class="ttc" id="astructmutation__branch_html_a2805339d7f40d83fbfb0846cca44761c"><div class="ttname"><a href="structmutation__branch.html#a2805339d7f40d83fbfb0846cca44761c">mutation_branch::name</a></div><div class="ttdeci">std::string name(const std::string &amp;variant=&quot;&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="mutation__data_8cpp_source.html#l00579">mutation_data.cpp:579</a></div></div>
<div class="ttc" id="astructmutation__branch_html_a47e84e29e1d8622962a99479ef99bf0f"><div class="ttname"><a href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">mutation_branch::cancels</a></div><div class="ttdeci">std::vector&lt; trait_id &gt; cancels</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8h_source.html#l00324">mutation.h:324</a></div></div>
<div class="ttc" id="astructmutation__branch_html_a67f764c2a0612a360980e59a5e4fef21"><div class="ttname"><a href="structmutation__branch.html#a67f764c2a0612a360980e59a5e4fef21">mutation_branch::desc</a></div><div class="ttdeci">std::string desc(const std::string &amp;variant=&quot;&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="mutation__data_8cpp_source.html#l00589">mutation_data.cpp:589</a></div></div>
<div class="ttc" id="astructmutation__branch_html_a7c0ff24a9aac03207154197f7f6fa789"><div class="ttname"><a href="structmutation__branch.html#a7c0ff24a9aac03207154197f7f6fa789">mutation_branch::spells_learned</a></div><div class="ttdeci">std::map&lt; spell_id, int &gt; spells_learned</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8h_source.html#l00271">mutation.h:271</a></div></div>
<div class="ttc" id="astructmvwzstr_html_a2cbf4c0eb637d1887e053912de9c1266"><div class="ttname"><a href="structmvwzstr.html#a2cbf4c0eb637d1887e053912de9c1266">mvwzstr::txt</a></div><div class="ttdeci">std::string txt</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00052">ui.h:52</a></div></div>
<div class="ttc" id="astructmvwzstr_html_a494d0f1cb6eb7a18473507b18a2d161a"><div class="ttname"><a href="structmvwzstr.html#a494d0f1cb6eb7a18473507b18a2d161a">mvwzstr::left</a></div><div class="ttdeci">int left</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00050">ui.h:50</a></div></div>
<div class="ttc" id="astructmvwzstr_html_a77700416a62b9e1bc93184f19a85ee5e"><div class="ttname"><a href="structmvwzstr.html#a77700416a62b9e1bc93184f19a85ee5e">mvwzstr::color</a></div><div class="ttdeci">nc_color color</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00051">ui.h:51</a></div></div>
<div class="ttc" id="astructpoint_html"><div class="ttname"><a href="structpoint.html">point</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00020">point.h:20</a></div></div>
<div class="ttc" id="astructprojectile_html"><div class="ttname"><a href="structprojectile.html">projectile</a></div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00017">projectile.h:17</a></div></div>
<div class="ttc" id="astructprojectile_html_a4536010a51aee3302d749f2eb4dcaf35"><div class="ttname"><a href="structprojectile.html#a4536010a51aee3302d749f2eb4dcaf35">projectile::proj_effects</a></div><div class="ttdeci">std::set&lt; std::string &gt; proj_effects</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00033">projectile.h:33</a></div></div>
<div class="ttc" id="astructprojectile_html_a82d8f657f8cfc4e180c15bfab8ca8a6e"><div class="ttname"><a href="structprojectile.html#a82d8f657f8cfc4e180c15bfab8ca8a6e">projectile::impact</a></div><div class="ttdeci">damage_instance impact</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00018">projectile.h:18</a></div></div>
<div class="ttc" id="astructprojectile_html_aa2af53bce63feecb719ef1edba54689e"><div class="ttname"><a href="structprojectile.html#aa2af53bce63feecb719ef1edba54689e">projectile::speed</a></div><div class="ttdeci">int speed</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00021">projectile.h:21</a></div></div>
<div class="ttc" id="astructrequirement__data_html"><div class="ttname"><a href="structrequirement__data.html">requirement_data</a></div><div class="ttdoc">The *_vector members represent list of alternatives requirements: alter_tool_comp_vector = { * { { a,...</div><div class="ttdef"><b>Definition:</b> <a href="requirements_8h_source.html#l00209">requirements.h:209</a></div></div>
<div class="ttc" id="astructrequirement__data_html_a07c67f146358ed0de2aface7588c20d2"><div class="ttname"><a href="structrequirement__data.html#a07c67f146358ed0de2aface7588c20d2">requirement_data::can_make_with_inventory</a></div><div class="ttdeci">bool can_make_with_inventory(const read_only_visitable &amp;crafting_inv, const std::function&lt; bool(const item &amp;)&gt; &amp;filter, int batch=1, craft_flags=craft_flags::none) const</div><div class="ttdoc">Returns true if the requirements are fulfilled by the filtered inventory.</div><div class="ttdef"><b>Definition:</b> <a href="requirements_8cpp_source.html#l00840">requirements.cpp:840</a></div></div>
<div class="ttc" id="astructrequirement__data_html_a175d46943600149603b7a915cb48092b"><div class="ttname"><a href="structrequirement__data.html#a175d46943600149603b7a915cb48092b">requirement_data::get_tools</a></div><div class="ttdeci">const alter_tool_comp_vector &amp; get_tools() const</div><div class="ttdef"><b>Definition:</b> <a href="requirements_8cpp_source.html#l01152">requirements.cpp:1152</a></div></div>
<div class="ttc" id="astructrequirement__data_html_a56dbf23ade6bced0dc6148b8e1a12d4c"><div class="ttname"><a href="structrequirement__data.html#a56dbf23ade6bced0dc6148b8e1a12d4c">requirement_data::get_components</a></div><div class="ttdeci">const alter_item_comp_vector &amp; get_components() const</div><div class="ttdef"><b>Definition:</b> <a href="requirements_8cpp_source.html#l01162">requirements.cpp:1162</a></div></div>
<div class="ttc" id="astructrequirement__data_html_a7518cd295931d5e30f6ba0341f90aa8b"><div class="ttname"><a href="structrequirement__data.html#a7518cd295931d5e30f6ba0341f90aa8b">requirement_data::get_folded_tools_list</a></div><div class="ttdeci">std::vector&lt; std::string &gt; get_folded_tools_list(int width, nc_color col, const read_only_visitable &amp;crafting_inv, int batch=1) const</div><div class="ttdef"><b>Definition:</b> <a href="requirements_8cpp_source.html#l00819">requirements.cpp:819</a></div></div>
<div class="ttc" id="astructrequirement__data_html_a9b9025140c166ce2a00fcf41db96b7a9"><div class="ttname"><a href="structrequirement__data.html#a9b9025140c166ce2a00fcf41db96b7a9">requirement_data::get_folded_components_list</a></div><div class="ttdeci">std::vector&lt; std::string &gt; get_folded_components_list(int width, nc_color col, const read_only_visitable &amp;crafting_inv, const std::function&lt; bool(const item &amp;)&gt; &amp;filter, int batch=1, std::string_view hilite={}, requirement_display_flags=requirement_display_flags::none) const</div><div class="ttdef"><b>Definition:</b> <a href="requirements_8cpp_source.html#l00732">requirements.cpp:732</a></div></div>
<div class="ttc" id="astructrequirement__data_html_ad7733e9b478f08e7e6e1ef94057e3502"><div class="ttname"><a href="structrequirement__data.html#ad7733e9b478f08e7e6e1ef94057e3502">requirement_data::get_qualities</a></div><div class="ttdeci">const alter_quali_req_vector &amp; get_qualities() const</div><div class="ttdef"><b>Definition:</b> <a href="requirements_8cpp_source.html#l01157">requirements.cpp:1157</a></div></div>
<div class="ttc" id="astructspell__effect_1_1override__parameters_html"><div class="ttname"><a href="structspell__effect_1_1override__parameters.html">spell_effect::override_parameters</a></div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00738">magic.h:738</a></div></div>
<div class="ttc" id="astructspell__effect_1_1override__parameters_html_acdd82cf7a573dcb57eedbcc051c5388b"><div class="ttname"><a href="structspell__effect_1_1override__parameters.html#acdd82cf7a573dcb57eedbcc051c5388b">spell_effect::override_parameters::aoe_radius</a></div><div class="ttdeci">int aoe_radius</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00739">magic.h:739</a></div></div>
<div class="ttc" id="astructtripoint_html"><div class="ttname"><a href="structtripoint.html">tripoint</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00129">point.h:129</a></div></div>
<div class="ttc" id="astructuilist__entry_html"><div class="ttname"><a href="structuilist__entry.html">uilist_entry</a></div><div class="ttdoc">uilist_entry: entry line for uilist</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00059">ui.h:59</a></div></div>
<div class="ttc" id="astructuilist__entry_html_aa967deb004ba949adcf9c394af0b74b6"><div class="ttname"><a href="structuilist__entry.html#aa967deb004ba949adcf9c394af0b74b6">uilist_entry::extratxt</a></div><div class="ttdeci">mvwzstr extratxt</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00071">ui.h:71</a></div></div>
<div class="ttc" id="astructuilist__entry_html_aeca572914ac103f183d3e22dacf7978d"><div class="ttname"><a href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">uilist_entry::retval</a></div><div class="ttdeci">int retval</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00060">ui.h:60</a></div></div>
<div class="ttc" id="atranslation_8cpp_html_a176e288c640c6506a86330cb10fbe13a"><div class="ttname"><a href="translation_8cpp.html#a176e288c640c6506a86330cb10fbe13a">to_translation</a></div><div class="ttdeci">translation to_translation(const std::string &amp;raw)</div><div class="ttdoc">Shorthands for translation::to_translation.</div><div class="ttdef"><b>Definition:</b> <a href="translation_8cpp_source.html#l00420">translation.cpp:420</a></div></div>
<div class="ttc" id="atranslations_8h_html"><div class="ttname"><a href="translations_8h.html">translations.h</a></div></div>
<div class="ttc" id="atranslations_8h_html_a45dd4e3da9b83845bcd1c2d8e80cf802"><div class="ttname"><a href="translations_8h.html#a45dd4e3da9b83845bcd1c2d8e80cf802">n_gettext</a></div><div class="ttdeci">#define n_gettext(STRING1, STRING2, COUNT)</div><div class="ttdef"><b>Definition:</b> <a href="translations_8h_source.html#l00091">translations.h:91</a></div></div>
<div class="ttc" id="atranslations_8h_html_a46bdf4dff9d320938561cade1c9a5f7e"><div class="ttname"><a href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a></div><div class="ttdeci">#define pgettext(STRING1, STRING2)</div><div class="ttdef"><b>Definition:</b> <a href="translations_8h_source.html#l00092">translations.h:92</a></div></div>
<div class="ttc" id="atranslations_8h_html_ab92bb4161a6308b302d283816975c3a6"><div class="ttname"><a href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a></div><div class="ttdeci">#define _(STRING)</div><div class="ttdef"><b>Definition:</b> <a href="translations_8h_source.html#l00089">translations.h:89</a></div></div>
<div class="ttc" id="atype__id_8h_html_a64efc8ab51816a59711440d464136eda"><div class="ttname"><a href="type__id_8h.html#a64efc8ab51816a59711440d464136eda">vproto_id</a></div><div class="ttdeci">string_id&lt; vehicle_prototype &gt; vproto_id</div><div class="ttdef"><b>Definition:</b> <a href="type__id_8h_source.html#l00298">type_id.h:298</a></div></div>
<div class="ttc" id="atype__id_8h_html_aabcbcb9fb77661ba75c47b6287318e03"><div class="ttname"><a href="type__id_8h.html#aabcbcb9fb77661ba75c47b6287318e03">mod_id</a></div><div class="ttdeci">string_id&lt; MOD_INFORMATION &gt; mod_id</div><div class="ttdef"><b>Definition:</b> <a href="type__id_8h_source.html#l00149">type_id.h:149</a></div></div>
<div class="ttc" id="aui_8h_html"><div class="ttname"><a href="ui_8h.html">ui.h</a></div></div>
<div class="ttc" id="aunits_8h_html"><div class="ttname"><a href="units_8h.html">units.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 7 2024 08:48:28 for Cataclysm DDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
