<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm DDA: src/monmove.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm DDA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">monmove.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="monmove_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Monster movement code; essentially, the AI</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="monster_8h.html">monster.h</a>&quot;</span> <span class="comment">// IWYU pragma: associated</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;cfloat&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;climits&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;ostream&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;unordered_map&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="behavior_8h.html">behavior.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="bionics_8h.html">bionics.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cached__options_8h.html">cached_options.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cata__utility_8h.html">cata_utility.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="character_8h.html">character.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="colony_8h.html">colony.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="creature__tracker_8h.html">creature_tracker.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="debug_8h.html">debug.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="field_8h.html">field.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="field__type_8h.html">field_type.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="game_8h.html">game.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="game__constants_8h.html">game_constants.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="line_8h.html">line.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="make__static_8h.html">make_static.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map_8h.html">map.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map__iterator_8h.html">map_iterator.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mapdata_8h.html">mapdata.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mattack__common_8h.html">mattack_common.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memory__fast_8h.html">memory_fast.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="messages_8h.html">messages.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="monfaction_8h.html">monfaction.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="monster__oracle_8h.html">monster_oracle.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mtype_8h.html">mtype.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="npc_8h.html">npc.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="options_8h.html">options.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pathfinding_8h.html">pathfinding.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pimpl_8h.html">pimpl.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rng_8h.html">rng.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="scent__map_8h.html">scent_map.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sounds_8h.html">sounds.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="string__formatter_8h.html">string_formatter.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="submap_8h.html">submap.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tileray_8h.html">tileray.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="translations_8h.html">translations.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="trap_8h.html">trap.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="units_8h.html">units.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="veh__type_8h.html">veh_type.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vehicle_8h.html">vehicle.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="viewer_8h.html">viewer.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vpart__position_8h.html">vpart_position.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#aecd517a9e74b5a5a21f0c75f88f50090">   57</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">damage_type_id</a> <a class="code" href="monmove_8cpp.html#aecd517a9e74b5a5a21f0c75f88f50090">damage_cut</a>( <span class="stringliteral">&quot;cut&quot;</span> );</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#aa3320a370fe1f7f1cf6e14918ca20358">   59</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#aa3320a370fe1f7f1cf6e14918ca20358">effect_bouldering</a>( <span class="stringliteral">&quot;bouldering&quot;</span> );</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a8bbfe91713ddfaa4c647fa68f9734e34">   60</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#a8bbfe91713ddfaa4c647fa68f9734e34">effect_countdown</a>( <span class="stringliteral">&quot;countdown&quot;</span> );</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a4720d4449171de19328e9e2adc8ba622">   61</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#a4720d4449171de19328e9e2adc8ba622">effect_cramped_space</a>( <span class="stringliteral">&quot;cramped_space&quot;</span> );</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a924fe96bf3dd9ac954c9925fdd5b6901">   62</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#a924fe96bf3dd9ac954c9925fdd5b6901">effect_docile</a>( <span class="stringliteral">&quot;docile&quot;</span> );</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a08481f62adb6937636ea44b855311037">   63</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#a08481f62adb6937636ea44b855311037">effect_downed</a>( <span class="stringliteral">&quot;downed&quot;</span> );</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">   64</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a>( <span class="stringliteral">&quot;dragging&quot;</span> );</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#ae326c5e4da7f23bc429d04d215dd7c9d">   65</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#ae326c5e4da7f23bc429d04d215dd7c9d">effect_grabbed</a>( <span class="stringliteral">&quot;grabbed&quot;</span> );</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a7697771dc47ecaeff36785ff20c9aa33">   66</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#a7697771dc47ecaeff36785ff20c9aa33">effect_harnessed</a>( <span class="stringliteral">&quot;harnessed&quot;</span> );</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#ad5fa326832c0a774d6a775e605f27788">   67</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#ad5fa326832c0a774d6a775e605f27788">effect_led_by_leash</a>( <span class="stringliteral">&quot;led_by_leash&quot;</span> );</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#af079f6d5681dabcbc1c4ee804c0ba556">   68</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#af079f6d5681dabcbc1c4ee804c0ba556">effect_no_sight</a>( <span class="stringliteral">&quot;no_sight&quot;</span> );</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#ab8dd6142a7131d3af944e532002ac9e3">   69</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#ab8dd6142a7131d3af944e532002ac9e3">effect_operating</a>( <span class="stringliteral">&quot;operating&quot;</span> );</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a79654cfc6f07462199ec3f5da9e49c83">   70</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#a79654cfc6f07462199ec3f5da9e49c83">effect_pacified</a>( <span class="stringliteral">&quot;pacified&quot;</span> );</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#adcaf70773541073a0d4cdfce4b857bf7">   71</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#adcaf70773541073a0d4cdfce4b857bf7">effect_psi_stunned</a>( <span class="stringliteral">&quot;psi_stunned&quot;</span> );</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a6500d7a3ab33f453019cc4e7f55ced72">   72</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#a6500d7a3ab33f453019cc4e7f55ced72">effect_pushed</a>( <span class="stringliteral">&quot;pushed&quot;</span> );</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#ad6fd62a9ed571c6bf17d577118be3c5a">   73</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#ad6fd62a9ed571c6bf17d577118be3c5a">effect_stumbled_into_invisible</a>( <span class="stringliteral">&quot;stumbled_into_invisible&quot;</span> );</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">   74</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">effect_stunned</a>( <span class="stringliteral">&quot;stunned&quot;</span> );</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a31e2ef0b23e31f445746b9eaabbeb600">   76</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">field_type_str_id</a> <a class="code" href="monmove_8cpp.html#a31e2ef0b23e31f445746b9eaabbeb600">field_fd_last_known</a>( <span class="stringliteral">&quot;fd_last_known&quot;</span> );</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#ab41f4e77a586e85f347f7151266b9dd5">   78</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">flag_id</a> <a class="code" href="monmove_8cpp.html#ab41f4e77a586e85f347f7151266b9dd5">json_flag_GRAB</a>( <span class="stringliteral">&quot;GRAB&quot;</span> );</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a2724a97ce27ac9050939a55314eab590">   79</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">flag_id</a> <a class="code" href="monmove_8cpp.html#a2724a97ce27ac9050939a55314eab590">json_flag_GRAB_FILTER</a>( <span class="stringliteral">&quot;GRAB_FILTER&quot;</span> );</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a43d73ec1734433adc005632647aa155c">   81</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">itype_id</a> <a class="code" href="monmove_8cpp.html#a43d73ec1734433adc005632647aa155c">itype_pressurized_tank</a>( <span class="stringliteral">&quot;pressurized_tank&quot;</span> );</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a7a66d8a18b4c357a9ec56e2c6aca1d80">   83</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">material_id</a> <a class="code" href="monmove_8cpp.html#a7a66d8a18b4c357a9ec56e2c6aca1d80">material_iflesh</a>( <span class="stringliteral">&quot;iflesh&quot;</span> );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#ae4aecc728b6b9084078aaa79046ce038">   85</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">species_id</a> <a class="code" href="monmove_8cpp.html#ae4aecc728b6b9084078aaa79046ce038">species_FUNGUS</a>( <span class="stringliteral">&quot;FUNGUS&quot;</span> );</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a6d062e430202ce21974bf3fb492002bf">   86</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">species_id</a> <a class="code" href="monmove_8cpp.html#a6d062e430202ce21974bf3fb492002bf">species_ZOMBIE</a>( <span class="stringliteral">&quot;ZOMBIE&quot;</span> );</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#ada6977f9f2935b5c864914ed26ba70be">   88</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">ter_str_id</a> <a class="code" href="monmove_8cpp.html#ada6977f9f2935b5c864914ed26ba70be">ter_t_lava</a>( <span class="stringliteral">&quot;t_lava&quot;</span> );</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#aaa258c5465ca70ec4568914f0975902c">   89</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">ter_str_id</a> <a class="code" href="monmove_8cpp.html#aaa258c5465ca70ec4568914f0975902c">ter_t_pit</a>( <span class="stringliteral">&quot;t_pit&quot;</span> );</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#abd49233bc2fac36e7e5fd2ba24dcac17">   90</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">ter_str_id</a> <a class="code" href="monmove_8cpp.html#abd49233bc2fac36e7e5fd2ba24dcac17">ter_t_pit_glass</a>( <span class="stringliteral">&quot;t_pit_glass&quot;</span> );</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a5b54905268cad0ebc1a842a9594b0e65">   91</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">ter_str_id</a> <a class="code" href="monmove_8cpp.html#a5b54905268cad0ebc1a842a9594b0e65">ter_t_pit_spiked</a>( <span class="stringliteral">&quot;t_pit_spiked&quot;</span> );</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classmonster.html#a463ca0ea362cc5ea7b3b9a808c0de85c">   93</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a463ca0ea362cc5ea7b3b9a808c0de85c">monster::is_immune_field</a>( <span class="keyword">const</span> <a class="code" href="classint__id.html">field_type_id</a> &amp;fid )<span class="keyword"> const</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span>( fid == <a class="code" href="field__type_8cpp.html#acf26086090a59755ffe2d5cfd795fbee">fd_fungal_haze</a> ) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a4c417260415c080a792537389ec1c0fe">mon_flag_NO_BREATHE</a> ) || <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a51ec342d71717bb513f0158198b12840">in_species</a>( <a class="code" href="monmove_8cpp.html#ae4aecc728b6b9084078aaa79046ce038">species_FUNGUS</a> );</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span>( fid == <a class="code" href="field__type_8cpp.html#aa82146db3e3f637cba0882a8d666a6c7">fd_fungicidal_gas</a> ) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a51ec342d71717bb513f0158198b12840">in_species</a>( <a class="code" href="monmove_8cpp.html#ae4aecc728b6b9084078aaa79046ce038">species_FUNGUS</a> );</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span>( fid == <a class="code" href="field__type_8cpp.html#a7a3a035b9879e1ed52992d9857556f77">fd_insecticidal_gas</a> ) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="classmonster.html#a6e03e18c6ea5e5adb496634b2bbaea52">made_of</a>( <a class="code" href="monmove_8cpp.html#a7a66d8a18b4c357a9ec56e2c6aca1d80">material_iflesh</a> ) || <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a908bb60a3a9133ca7e129be4e6bc3e1a">mon_flag_INSECTICIDEPROOF</a> );</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span>( fid == <a class="code" href="field__type_8cpp.html#acd17fbab1a93c90c8748a2b0777027fa">fd_web</a> ) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a2d34a5d2b22293f92d8166e654529ccc">mon_flag_WEBWALK</a> );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span>( fid == <a class="code" href="field__type_8cpp.html#aef9321274b765b7943ca0412b949b373">fd_sludge</a> || fid == <a class="code" href="field__type_8cpp.html#ad5aa18f66a9c4810d561e84a2c316f03">fd_sap</a> ) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">const</span> <a class="code" href="structfield__type.html">field_type</a> &amp;ft = fid.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span>( ft.<a class="code" href="structfield__type.html#a945df8e3828398e06dddfe503b742df5">has_fume</a> ) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a4c417260415c080a792537389ec1c0fe">mon_flag_NO_BREATHE</a> );</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span>( ft.<a class="code" href="structfield__type.html#a7654ad7f889130a671e526c96f230ce6">has_acid</a> ) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a3f693ccabdc6659dd60b5e230107766c">mon_flag_ACIDPROOF</a> ) || <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span>( ft.<a class="code" href="structfield__type.html#ab660a14996c8441bdf8f3cfa6da475af">has_fire</a> ) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#af5bf953ca6152f2de9c886eaa7389d6a">mon_flag_FIREPROOF</a> );</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span>( ft.<a class="code" href="structfield__type.html#a5b08ae2a01c1e82e7cb22785d735d5e9">has_elec</a> ) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a1a2c96cda209ef35238ac3e040c62aa9">mon_flag_ELECTRIC</a> );</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span>( ft.<a class="code" href="structfield__type.html#a40a71f7f1d1c5cfccd86817061665c96">immune_mtypes</a>.count( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a60dea81cdc4c627313e540831d311b5a">id</a> ) &gt; 0 ) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// No specific immunity was found, so fall upwards</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCreature.html#a090f59402eea6b1605cbfa5c2b2ac77c">Creature::is_immune_field</a>( fid );</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a3c9d7c1da038730a8cc36cb559d1bbd8">  130</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="monmove_8cpp.html#a3c9d7c1da038730a8cc36cb559d1bbd8">z_is_valid</a>( <span class="keywordtype">int</span> z )</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;{</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> z &gt;= -<a class="code" href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a> &amp;&amp; z &lt;= <a class="code" href="game__constants_8h.html#a3984a9476d1edc78e4e7b886a08d4d4b">OVERMAP_HEIGHT</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classmonster.html#a04e580433cf344a504468495ba2d1ee3">  135</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a04e580433cf344a504468495ba2d1ee3">monster::monster_move_in_vehicle</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;m = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classmonster.html">monster</a> critter = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoptional__vpart__position.html">optional_vpart_position</a> vp = m.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( p );</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span>( vp.has_value() ) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="classvehicle.html">vehicle</a> &amp;veh = vp-&gt;vehicle();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="classunits_1_1quantity.html">units::volume</a> capacity = 0_ml;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="classunits_1_1quantity.html">units::volume</a> free_cargo = 0_ml;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keyword">auto</span> cargo_parts = veh.<a class="code" href="classvehicle.html#a38ba5bdc99241568c83ada974ed73e07">get_parts_at</a>( p, <span class="stringliteral">&quot;CARGO&quot;</span>, <a class="code" href="vehicle_8h.html#ad9a221cee9ae7a69d6f09d4de701f02ca100b8cad7cf2a56f6df78f171f97a1ec">part_status_flag::any</a> );</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="structvehicle__part.html">vehicle_part</a> *&amp;part : cargo_parts ) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <a class="code" href="classvehicle__stack.html">vehicle_stack</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a1ff93bf21a97272ada4556de4422fb80">contents</a> = veh.<a class="code" href="classvehicle.html#abbc4051229bf116dfd03c53dcc4a0765">get_items</a>( *part );</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordflow">if</span>( !vp.<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <span class="stringliteral">&quot;CARGO_PASSABLE&quot;</span>, <span class="keyword">false</span> ) &amp;&amp;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                !vp.<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <span class="stringliteral">&quot;APPLIANCE&quot;</span>, <span class="keyword">false</span> ) &amp;&amp; !vp.<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <span class="stringliteral">&quot;OBSTACLE&quot;</span>, <span class="keyword">false</span> ) ) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                capacity += <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a1ff93bf21a97272ada4556de4422fb80">contents</a>.max_volume();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                free_cargo += <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a1ff93bf21a97272ada4556de4422fb80">contents</a>.free_volume();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span>( capacity &gt; 0_ml ) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="comment">// First, we&#39;ll try to squeeze in. Open-topped vehicle parts have more room to step over cargo.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">if</span>( !veh.<a class="code" href="classvehicle.html#afccaeaa8277a4fbfc2c596682bf8b2d1">enclosed_at</a>( p ) ) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                free_cargo *= 1.2;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordflow">if</span>( !veh.<a class="code" href="classvehicle.html#afccaeaa8277a4fbfc2c596682bf8b2d1">enclosed_at</a>( p ) &amp;&amp; <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() ) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// No amount of cargo will block a flying monster if there&#39;s no roof.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keyword">const</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2">creature_size</a> <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> = <a class="code" href="classmonster.html#ab92cac0ecb2b2062fd4f821b671f86ac">get_size</a>();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordflow">if</span>( ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a> &amp;&amp; free_cargo &lt; 15625_ml ) ||</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aeb5c1399a871211c7e7ed732d15e3a8b">creature_size::small</a> &amp;&amp; free_cargo &lt; 31250_ml ) ||</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2a075a3e36a0a52dcbc568c05788e8a713">creature_size::medium</a> &amp;&amp; free_cargo &lt; 62500_ml ) ||</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aafacdb0a401ccdf6b48551bbc00e8a74">creature_size::large</a> &amp;&amp; free_cargo &lt; 125000_ml ) ||</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ab7cf27ffe6ea83cdcf8af2ef29de9285">creature_size::huge</a> &amp;&amp; free_cargo &lt; 250000_ml ) ) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="keywordflow">if</span>( ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a> &amp;&amp; free_cargo &lt; 11719_ml ) ||</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aeb5c1399a871211c7e7ed732d15e3a8b">creature_size::small</a> &amp;&amp; free_cargo &lt; 23438_ml ) ||</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2a075a3e36a0a52dcbc568c05788e8a713">creature_size::medium</a> &amp;&amp; free_cargo &lt; 46875_ml ) ||</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aafacdb0a401ccdf6b48551bbc00e8a74">creature_size::large</a> &amp;&amp; free_cargo &lt; 93750_ml ) ||</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                    ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ab7cf27ffe6ea83cdcf8af2ef29de9285">creature_size::huge</a> &amp;&amp; free_cargo &lt; 187500_ml ) ||</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    ( <a class="code" href="classmonster.html#a304aeb741c4ac28d879d3951dee4cf30">get_volume</a>() &gt; 850000_ml &amp;&amp; !vp.<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <span class="stringliteral">&quot;HUGE_OK&quot;</span>, <span class="keyword">false</span> ) ) ) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Return false if there&#39;s just no room whatsoever. Anything over 850 liters will simply never fit in a vehicle part that isn&#39;t specifically made for it.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    <span class="comment">// I&#39;m sorry but you can&#39;t let a kaiju ride shotgun.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a541f9bf8c2e84856ea34db43f88991b3">bodytype</a> == <span class="stringliteral">&quot;snake&quot;</span> || <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a541f9bf8c2e84856ea34db43f88991b3">bodytype</a> == <span class="stringliteral">&quot;blob&quot;</span> || <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a541f9bf8c2e84856ea34db43f88991b3">bodytype</a> == <span class="stringliteral">&quot;fish&quot;</span> ||</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#af87d0e11009031a09f917068f8cc0357">mon_flag_PLASTIC</a> ) || <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a0170802dff38a9711cf97c353826eeb7">mon_flag_SMALL_HIDER</a> ) ) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Return true if we&#39;re wiggly enough to be fine with cramped space.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                critter.<a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#a4720d4449171de19328e9e2adc8ba622">effect_cramped_space</a>, 2_turns, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Otherwise we add the effect and return true.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ab7cf27ffe6ea83cdcf8af2ef29de9285">creature_size::huge</a> &amp;&amp; !vp.<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <span class="stringliteral">&quot;AISLE&quot;</span>, <span class="keyword">false</span> ) &amp;&amp;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                !vp.<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <span class="stringliteral">&quot;HUGE_OK&quot;</span>, <span class="keyword">false</span> ) ) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                critter.<a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#a4720d4449171de19328e9e2adc8ba622">effect_cramped_space</a>, 2_turns, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Sufficiently gigantic creatures have trouble in stock seats, roof or no.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classmonster.html#a7d8135ba3578b7ad43d4e7b5acc9269d">  193</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a7d8135ba3578b7ad43d4e7b5acc9269d">monster::will_move_to</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">impassable</a>( p ) ) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#af705eea6e40e12d7866010955602c7b5">digging</a>() ) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a3c02a3fdfed55eb397855458954edb4d">ter_furn_flag::TFLAG_BURROWABLE</a>, p ) ) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !( <a class="code" href="classmonster.html#abca4913777aa7ed67c109de4b667ed54">can_climb</a>() &amp;&amp; here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac0ec7541a0f28e104d9c691936512481">ter_furn_flag::TFLAG_CLIMBABLE</a>, p ) ) ) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a5ee9fe3a08892870a0574b8e1ab4e6b0">has_vehicle_floor</a>( p ) ) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#a55fd0614c264b7e89a5735270ff6d2c7">can_submerge</a>() &amp;&amp; !<a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() &amp;&amp; here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac6e19e1c41724be67b2bff2870539ca1">ter_furn_flag::TFLAG_DEEP_WATER</a>, p ) ) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a22e929800e08d5458140ec4dbaad53a5">digs</a>() &amp;&amp; !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054aaebe86ebda0571101f8d02ab5f2a888c">ter_furn_flag::TFLAG_DIGGABLE</a>, p ) &amp;&amp;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a3c02a3fdfed55eb397855458954edb4d">ter_furn_flag::TFLAG_BURROWABLE</a>, p ) ) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a10899530fa212da51fd92b98b0cacdb5">mon_flag_AQUATIC</a> ) &amp;&amp; (</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, p ) ||</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="comment">// AQUATIC (confined to water) monster avoid vehicles, unless they are already underneath one</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            ( here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( p ) &amp;&amp; !here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) )</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        ) ) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#ac15b344ef0a6c63960a6b7c042b0ce94">mon_flag_SUNDEATH</a> ) &amp;&amp; <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;is_in_sunlight( p ) ) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#ab92cac0ecb2b2062fd4f821b671f86ac">get_size</a>() &gt; <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2a075a3e36a0a52dcbc568c05788e8a713">creature_size::medium</a> &amp;&amp;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        here.<a class="code" href="classmap.html#af0e872a5d0a7bf1e9745aeb18d3b5e44">has_flag_ter</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ab6eeca58f1d5eff47e105ee3c132539f">ter_furn_flag::TFLAG_SMALL_PASSAGE</a>, p ) ) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// if a large critter, can&#39;t move through tight passages</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classmonster.html#ac0c29edb1633fd1090a0a5ff3efa3fe3">  237</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#ac0c29edb1633fd1090a0a5ff3efa3fe3">monster::know_danger_at</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// Various avoiding behaviors.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordtype">bool</span> avoid_fire = <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#aaed6bfffb6b455a66dc66a4792cabefc">mon_flag_PATH_AVOID_FIRE</a> );</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">bool</span> avoid_fall = <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#ac5e2cd69bddcec0fbb472df3e6991c40">mon_flag_PATH_AVOID_FALL</a> );</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">bool</span> avoid_simple = <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#ab0b72a092cc048de39170eb7efa37b0a">mon_flag_PATH_AVOID_DANGER_1</a> );</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">bool</span> avoid_complex = <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a953954e2c6d4fac0741d4a57c41610eb">mon_flag_PATH_AVOID_DANGER_2</a> );</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordtype">bool</span> avoid_sharp = <a class="code" href="classmonster.html#a873925c09bec361ffd2363626828a362">get_pathfinding_settings</a>().<a class="code" href="structpathfinding__settings.html#ab888f81c3ce0d4f691e9f8619cf31328">avoid_sharp</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">bool</span> avoid_traps = <a class="code" href="classmonster.html#a873925c09bec361ffd2363626828a362">get_pathfinding_settings</a>().<a class="code" href="structpathfinding__settings.html#acba070ceb6ae16b9c3991a1d2814d4c8">avoid_traps</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">     * Because some avoidance behaviors are supersets of others,</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">     * we can cascade through the implications. Complex implies simple,</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">     * and simple implies fire and fall.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">     * unfortunately, fall does not necessarily imply fire, nor the converse.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span>( avoid_complex ) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        avoid_simple = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        avoid_traps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span>( avoid_simple ) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        avoid_fire = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        avoid_fall = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        avoid_sharp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// technically this will shortcut in evaluation from fire or fall</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// before hitting simple or complex but this is more explicit</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span>( avoid_fire || avoid_fall || avoid_simple ||</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        avoid_complex || avoid_traps || avoid_sharp ) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keyword">const</span> <a class="code" href="classint__id.html">ter_id</a> target = here.<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( p );</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a5ee9fe3a08892870a0574b8e1ab4e6b0">has_vehicle_floor</a>( p ) ) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">// Don&#39;t enter lava if we have any concept of heat being bad</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">if</span>( avoid_fire &amp;&amp; target == <a class="code" href="monmove_8cpp.html#ada6977f9f2935b5c864914ed26ba70be">ter_t_lava</a> ) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keywordflow">if</span>( avoid_fall ) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <span class="comment">// Don&#39;t throw ourselves off cliffs if we have a concept of falling</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a78e0a35a5041e0daf6e7a2a4ec522014">has_floor_or_water</a>( p ) &amp;&amp; !<a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() ) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="comment">// Don&#39;t enter open pits ever unless tiny, can fly or climb well</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <span class="keywordflow">if</span>( !( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a> || <a class="code" href="classmonster.html#abca4913777aa7ed67c109de4b667ed54">can_climb</a>() ) &amp;&amp;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    ( target == <a class="code" href="monmove_8cpp.html#aaa258c5465ca70ec4568914f0975902c">ter_t_pit</a> || target == <a class="code" href="monmove_8cpp.html#a5b54905268cad0ebc1a842a9594b0e65">ter_t_pit_spiked</a> || target == <a class="code" href="monmove_8cpp.html#abd49233bc2fac36e7e5fd2ba24dcac17">ter_t_pit_glass</a> ) ) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="comment">// Some things are only avoided if we&#39;re not attacking</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() != <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() ||</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a>( &amp;<a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() ) != <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a87f44dc6e793f84b2342dafd6460b263">MATT_ATTACK</a> ) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <span class="comment">// Sharp terrain is ignored while attacking</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="keywordflow">if</span>( avoid_sharp &amp;&amp; here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a28fc0832c9c36a2deaa4f618f42c9c45">ter_furn_flag::TFLAG_SHARP</a>, p ) &amp;&amp;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    !( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> == <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a> || <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() ||</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                       <a class="code" href="classmonster.html#ab55cbaa78e9a77935dfc63e5c292317b">get_armor_type</a>( <a class="code" href="monmove_8cpp.html#aecd517a9e74b5a5a21f0c75f88f50090">damage_cut</a>, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ) ) &gt;= 10 ) ) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="comment">// Don&#39;t step on any traps (if we can see)</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keyword">const</span> <a class="code" href="structtrap.html">trap</a> &amp;target_trap = here.<a class="code" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( p );</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">if</span>( avoid_traps &amp;&amp; <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a0f90cef22d42e0b8c911e8d289e1a10e">mon_flag_SEES</a> ) &amp;&amp;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                !target_trap.<a class="code" href="structtrap.html#adc8f59b97597d373f7cb0bbcf061e794">is_benign</a>() &amp;&amp; here.<a class="code" href="classmap.html#a78e0a35a5041e0daf6e7a2a4ec522014">has_floor_or_water</a>( p ) ) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keyword">const</span> <a class="code" href="classfield.html">field</a> &amp;target_field = here.<a class="code" href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">field_at</a>( p );</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">// Higher awareness is needed for identifying these as threats.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">if</span>( avoid_complex ) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="comment">// Don&#39;t enter any dangerous fields</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a6a4c43d66f5a8b50a879d78682b00976">is_dangerous_fields</a>( target_field ) ) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">// Without avoid_complex, only fire and electricity are checked for field avoidance.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">if</span>( avoid_fire &amp;&amp; target_field.<a class="code" href="classfield.html#ad45f87597ebb8629628d9f35c238947d">find_field</a>( <a class="code" href="field__type_8cpp.html#a0090428c1f6724209c133c6b04b037cd">fd_fire</a> ) &amp;&amp; !<a class="code" href="classmonster.html#a463ca0ea362cc5ea7b3b9a808c0de85c">is_immune_field</a>( <a class="code" href="field__type_8cpp.html#a0090428c1f6724209c133c6b04b037cd">fd_fire</a> ) ) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">if</span>( avoid_simple &amp;&amp; target_field.<a class="code" href="classfield.html#ad45f87597ebb8629628d9f35c238947d">find_field</a>( <a class="code" href="field__type_8cpp.html#af0e4bb585d388fc8d4ad9ac76f52d340">fd_electricity</a> ) &amp;&amp;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            !<a class="code" href="classmonster.html#a463ca0ea362cc5ea7b3b9a808c0de85c">is_immune_field</a>( <a class="code" href="field__type_8cpp.html#af0e4bb585d388fc8d4ad9ac76f52d340">fd_electricity</a> ) ) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classmonster.html#a3971d4421cdc9f956213c9aef2ff9ae3">  330</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a3971d4421cdc9f956213c9aef2ff9ae3">monster::can_reach_to</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span>( p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> &gt; <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().z &amp;&amp; <a class="code" href="monmove_8cpp.html#a3c9d7c1da038730a8cc36cb559d1bbd8">z_is_valid</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().z ) ) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a4099f16f8e2c4ea80e996db0ea6f4c02">ter_furn_flag::TFLAG_RAMP_UP</a>, <a class="code" href="structtripoint.html">tripoint</a>( p.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>(), p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> - 1 ) ) ) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a589ce1673849a76ea3bf17df3fe84ab3">ter_furn_flag::TFLAG_GOES_UP</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) &amp;&amp; here.<a class="code" href="classmap.html#ad11eaa007e285dcfe4c6ffb6f1ce46d3">has_floor</a>( p ) ) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="comment">// can&#39;t go through the roof</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> &lt; <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().z &amp;&amp; <a class="code" href="monmove_8cpp.html#a3c9d7c1da038730a8cc36cb559d1bbd8">z_is_valid</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().z ) ) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> <a class="code" href="cube__direction_8h.html#aea62013051f3c8842efa174037dfb5bca55a9d6aa251e3c334db4ab4055a4a004">above</a>( p.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>(), p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> + 1 );</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a26a026d844907da147f1350754b5210b">ter_furn_flag::TFLAG_RAMP_DOWN</a>, <a class="code" href="cube__direction_8h.html#aea62013051f3c8842efa174037dfb5bca55a9d6aa251e3c334db4ab4055a4a004">above</a> ) ) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ab09f2463f4ce060d051439b5535a47e6">ter_furn_flag::TFLAG_GOES_DOWN</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) &amp;&amp;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            ( here.<a class="code" href="classmap.html#ad11eaa007e285dcfe4c6ffb6f1ce46d3">has_floor</a>( <a class="code" href="cube__direction_8h.html#aea62013051f3c8842efa174037dfb5bca55a9d6aa251e3c334db4ab4055a4a004">above</a> ) || ( !<a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() &amp;&amp; !here.<a class="code" href="classmap.html#a78e0a35a5041e0daf6e7a2a4ec522014">has_floor_or_water</a>( <a class="code" href="cube__direction_8h.html#aea62013051f3c8842efa174037dfb5bca55a9d6aa251e3c334db4ab4055a4a004">above</a> ) ) ) ) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="comment">// can&#39;t go through the floor</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="comment">// Check floors for flying monsters movement</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">  356</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">monster::can_move_to</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a3971d4421cdc9f956213c9aef2ff9ae3">can_reach_to</a>( p ) &amp;&amp; <a class="code" href="classmonster.html#a7d8135ba3578b7ad43d4e7b5acc9269d">will_move_to</a>( p );</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="classmonster.html#aac5e0ccac0ace79a458f219f8778f223">  361</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classmonster.html#aac5e0ccac0ace79a458f219f8778f223">monster::rate_target</a>( <a class="code" href="classCreature.html">Creature</a> &amp;<a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a>, <span class="keywordtype">float</span> best, <span class="keywordtype">bool</span> smart )<span class="keyword"> const</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keyword">const</span> <a class="code" href="structFastDistanceApproximation.html">FastDistanceApproximation</a> d = <a class="code" href="line_8h.html#ab7e2c307c51b94809057c788b81afbba">rl_dist_fast</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a>.pos() );</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span>( d &lt;= 0 ) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span> FLT_MAX;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// Check a very common and cheap case first</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span>( !smart &amp;&amp; d &gt;= best ) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">return</span> FLT_MAX;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">sees</a>( <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> ) ) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">return</span> FLT_MAX;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span>( !smart ) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( d );</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="namespaceunits.html#aafd2a8bd44b71ecc20b880db8071ad53">power</a> = <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a>.power_rating();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="classmonster.html">monster</a> *mon = <span class="keyword">dynamic_cast&lt;</span> <a class="code" href="classmonster.html">monster</a> * <span class="keyword">&gt;</span>( &amp;<a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// Their attitude to us and not ours to them, so that bobcats won&#39;t get gunned down</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span>( mon != <span class="keyword">nullptr</span> &amp;&amp; mon-&gt;<a class="code" href="classmonster.html#a125622587c2069dc4dbbe07943c81336">attitude_to</a>( *<span class="keyword">this</span> ) == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Attitude::HOSTILE</a> ) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <a class="code" href="namespaceunits.html#aafd2a8bd44b71ecc20b880db8071ad53">power</a> += 2;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespaceunits.html#aafd2a8bd44b71ecc20b880db8071ad53">power</a> &gt; 0 ) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( d ) / <a class="code" href="namespaceunits.html#aafd2a8bd44b71ecc20b880db8071ad53">power</a>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> FLT_MAX;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="structmonster__plan.html">  395</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structmonster__plan.html">monster_plan</a> {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="structmonster__plan.html#ac871cff53ad2f8665c63741965b4486d">monster_plan</a>( <span class="keyword">const</span> <a class="code" href="classmonster.html">monster</a> &amp;mon );</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// Bots are more intelligent than most living stuff</span></div>
<div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">  399</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">smart_planning</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">  401</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a835410f0d4159d27640aaf03c0292386">  402</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structmonster__plan.html#a835410f0d4159d27640aaf03c0292386">docile</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a4f34314c218249a6e771e55d75a0bf4a">  404</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structmonster__plan.html#a4f34314c218249a6e771e55d75a0bf4a">angers_hostile_weak</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a609da64a368f08449b8238be8c02061a">  405</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structmonster__plan.html#a609da64a368f08449b8238be8c02061a">fears_hostile_weak</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a783d4b87496b39a7cb483e717a7d18c3">  406</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="structmonster__plan.html#a783d4b87496b39a7cb483e717a7d18c3">placate_hostile_weak</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="structmonster__plan.html#aa4b2629a9c4c573b7374d3b795778ba6">  407</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structmonster__plan.html#aa4b2629a9c4c573b7374d3b795778ba6">angers_hostile_near</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="structmonster__plan.html#abf476a1550b7942fa59da7341fdb8b63">  408</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structmonster__plan.html#abf476a1550b7942fa59da7341fdb8b63">angers_hostile_seen</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a1f17c727f34c6eb024312137cb3f5166">  410</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structmonster__plan.html#a1f17c727f34c6eb024312137cb3f5166">group_morale</a>;</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="structmonster__plan.html#ac66e19d4c63eed0cffa0ce69e9cefe8e">  411</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structmonster__plan.html#ac66e19d4c63eed0cffa0ce69e9cefe8e">swarms</a>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// 8.6f is rating for tank drone 60 tiles away, moose 16 or boomer 33</span></div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">  414</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a482740ef6a3e3f3c5d216b8aa7f320f1">  416</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structmonster__plan.html#a482740ef6a3e3f3c5d216b8aa7f320f1">max_sight_range</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="structmonster__plan.html#abcea26b7607ff796e19216edc7e93704">  418</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structmonster__plan.html#abcea26b7607ff796e19216edc7e93704">angers_mating_season</a>;</div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="structmonster__plan.html#afa25ba895f2547a4d20822e7fdc50cec">  419</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structmonster__plan.html#afa25ba895f2547a4d20822e7fdc50cec">angers_cub_threatened</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="structmonster__plan.html#ae2852d3e6a37badd21ccc50874fe09d1">  420</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structmonster__plan.html#ae2852d3e6a37badd21ccc50874fe09d1">fears_hostile_near</a>;</div>
<div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a91d261c73a3c6d8907cd55fae4ee7d0c">  421</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structmonster__plan.html#a91d261c73a3c6d8907cd55fae4ee7d0c">fears_hostile_seen</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">  423</a></span>&#160;    <a class="code" href="classCreature.html">Creature</a> *<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;};</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="structmonster__plan.html#ac871cff53ad2f8665c63741965b4486d">  426</a></span>&#160;<a class="code" href="structmonster__plan.html#ac871cff53ad2f8665c63741965b4486d">monster_plan::monster_plan</a>( <span class="keyword">const</span> <a class="code" href="classmonster.html">monster</a> &amp;mon ) :</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    angers_hostile_weak( mon.type-&gt;has_anger_trigger( <a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a>::<a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913ae3f28a00a012a9d0a71c597defad1398">HOSTILE_WEAK</a> ) ),</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    fears_hostile_weak( mon.type-&gt;has_fear_trigger( <a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a>::<a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913ae3f28a00a012a9d0a71c597defad1398">HOSTILE_WEAK</a> ) ),</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    placate_hostile_weak( mon.type-&gt;has_placate_trigger( <a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a>::<a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913ae3f28a00a012a9d0a71c597defad1398">HOSTILE_WEAK</a> ) ),</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    angers_hostile_near( mon.type-&gt;has_anger_trigger( <a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a>::<a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913a527ecba2efe7da593d8f2938d448e600">HOSTILE_CLOSE</a> ) ? 5 : 0 ),</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    angers_hostile_seen( mon.type-&gt;has_anger_trigger( <a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a>::<a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913a27586a1b07947ccc76f2f5407d486fb6">HOSTILE_SEEN</a> ) ? <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, 2 ) : 0 ),</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    angers_mating_season( mon.type-&gt;has_anger_trigger( <a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a>::<a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913a442d4420890764901db368467c4ca9ec">MATING_SEASON</a> ) ? 3 : 0 ),</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    angers_cub_threatened( mon.type-&gt;has_anger_trigger( <a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a>::<a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913af9730b9c048c70f6f9293baf0ea2ce0f">PLAYER_NEAR_BABY</a> ) ? 8 : 0 ),</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    fears_hostile_near( mon.type-&gt;has_fear_trigger( <a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a>::<a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913a527ecba2efe7da593d8f2938d448e600">HOSTILE_CLOSE</a> ) ? 5 : 0 ),</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    fears_hostile_seen( mon.type-&gt;has_fear_trigger( <a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a>::<a class="code" href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913a27586a1b07947ccc76f2f5407d486fb6">HOSTILE_SEEN</a> ) ? <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, 2 ) : 0 )</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;{</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">smart_planning</a> = mon.<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#af88ca13a69fcf00093e7f86b5d55bfbd">mon_flag_PRIORITIZE_TARGETS</a> );</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="structmonster__plan.html#a482740ef6a3e3f3c5d216b8aa7f320f1">max_sight_range</a> = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( mon.<a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a3e1904385c3aeb343021eea90b466b19">vision_day</a>, mon.<a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#af37c4d88f49584515720ebd0d9542114">vision_night</a> );</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> = !<a class="code" href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">smart_planning</a> ? <a class="code" href="structmonster__plan.html#a482740ef6a3e3f3c5d216b8aa7f320f1">max_sight_range</a> : 8.6f;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="structmonster__plan.html#a835410f0d4159d27640aaf03c0292386">docile</a> = mon.<a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> != 0 &amp;&amp; mon.<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a924fe96bf3dd9ac954c9925fdd5b6901">effect_docile</a> );</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="structmonster__plan.html#ac66e19d4c63eed0cffa0ce69e9cefe8e">swarms</a> = mon.<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a2c060d4d5caf177589dd0545f9f8d9ef">mon_flag_SWARMS</a> );</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="structmonster__plan.html#a1f17c727f34c6eb024312137cb3f5166">group_morale</a> = mon.<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a2fcb130b1992859d4c1fe76f4f4da006">mon_flag_GROUP_MORALE</a> ) &amp;&amp; mon.<a class="code" href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">morale</a> &lt; mon.<a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a8a889ba3d1d6eb87ca31ce8999c9e6d0">morale</a>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classmonster.html#a49eaa3645377b9873ceefc3418c34e82">  446</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#a49eaa3645377b9873ceefc3418c34e82">monster::anger_hostile_seen</a>( <span class="keyword">const</span> <a class="code" href="structmonster__plan.html">monster_plan</a> &amp;mon_plan )</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;{</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> ) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="comment">// runng away, too busy to be angry</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">// Decide that the player is too annoying, less likely than the other triggers</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#abf476a1550b7942fa59da7341fdb8b63">angers_hostile_seen</a> &amp;&amp; <a class="code" href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a>( <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a>, 200 ) ) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a>-&gt;<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() ) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af89f1588bb30d81d64b742d34658db06">debugmode::DF_MONSTER</a>, <span class="stringliteral">&quot;%s&#39;s character aggro triggered by seeing you&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af89f1588bb30d81d64b742d34658db06">debugmode::DF_MONSTER</a>, <span class="stringliteral">&quot;%s&#39;s character aggro triggered by seeing %s&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(),</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                           mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a>-&gt;<a class="code" href="classCreature.html#a5de5f5e0d08deb03b68749608eb360b2">as_npc</a>()-&gt;<a class="code" href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">name</a> );</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="classmonster.html#ab80f9246aad2b3c22becee9f34dc17d8">aggro_character</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="classmonster.html#a740a0ee7c4c9baa7150fc8b0d0e5d237">  465</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#a740a0ee7c4c9baa7150fc8b0d0e5d237">monster::anger_mating_season</a>( <span class="keyword">const</span> <a class="code" href="structmonster__plan.html">monster_plan</a> &amp;mon_plan )</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;{</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#abcea26b7607ff796e19216edc7e93704">angers_mating_season</a> &gt; 0 &amp;&amp; <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> &lt;= 30 ) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a9ddaee6769a480c655bdbc09e4086040">mating_angry</a>() ) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> += mon_plan.<a class="code" href="structmonster__plan.html#abcea26b7607ff796e19216edc7e93704">angers_mating_season</a>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a>( <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a>, 100 ) ) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af89f1588bb30d81d64b742d34658db06">debugmode::DF_MONSTER</a>, <span class="stringliteral">&quot;%s&#39;s character aggro triggered by season&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <a class="code" href="classmonster.html#ab80f9246aad2b3c22becee9f34dc17d8">aggro_character</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;}</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="classmonster.html#a24bcf1eb9c4beb329036ad01b5f062dd">  478</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#a24bcf1eb9c4beb329036ad01b5f062dd">monster::anger_cub_threatened</a>( <a class="code" href="structmonster__plan.html">monster_plan</a> &amp;mon_plan )</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;{</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#afa25ba895f2547a4d20822e7fdc50cec">angers_cub_threatened</a> &lt; 0 ) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="comment">// return early, not angered by cubs being threatened</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classmonster.html">monster</a> &amp;tmp : <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;all_monsters() ) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#ac3d685da5268a2d00d8b8bd14eea54c2">baby_monster</a> == tmp.type-&gt;<a class="code" href="structmtype.html#a60dea81cdc4c627313e540831d311b5a">id</a> ) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="comment">// baby nearby; is the player too close?</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> = tmp.rate_target( *mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a>, mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a>, mon_plan.<a class="code" href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">smart_planning</a> );</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> &lt;= 3 ) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="comment">//proximity to baby; monster gets furious and less likely to flee</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> += mon_plan.<a class="code" href="structmonster__plan.html#afa25ba895f2547a4d20822e7fdc50cec">angers_cub_threatened</a>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                <a class="code" href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">morale</a> += mon_plan.<a class="code" href="structmonster__plan.html#afa25ba895f2547a4d20822e7fdc50cec">angers_cub_threatened</a> / 2;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af89f1588bb30d81d64b742d34658db06">debugmode::DF_MONSTER</a>, <span class="stringliteral">&quot;%s&#39;s character aggro triggered by threatening %s&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(),</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                               tmp.name() );</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                <a class="code" href="classmonster.html#ab80f9246aad2b3c22becee9f34dc17d8">aggro_character</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="classmonster.html#a9ddaee6769a480c655bdbc09e4086040">  501</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a9ddaee6769a480c655bdbc09e4086040">monster::mating_angry</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a9ddaee6769a480c655bdbc09e4086040">mating_angry</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1b">season_type</a> <a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a> = <a class="code" href="calendar_8cpp.html#a81656706da6c7486137ad8578c0f523e">season_of_year</a>( <a class="code" href="namespacecalendar.html#ae15fcbf1c971589eb49c1a657fb6a580">calendar::turn</a> );</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;elem : <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a9636bf314611b06345f1a78b4e88e8ae">baby_flags</a> ) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span>( ( <a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a> == <a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1ba6d813ab9ea240f6c6eeff923ccb680ae">SUMMER</a> &amp;&amp; elem == <span class="stringliteral">&quot;SUMMER&quot;</span> ) ||</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            ( <a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a> == <a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1ba1d8c9db74467f6c2fdad36f154ca6873">WINTER</a> &amp;&amp; elem == <span class="stringliteral">&quot;WINTER&quot;</span> ) ||</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            ( <a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a> == <a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1ba74ce3137b26cdafc19bdb66d881971fa">SPRING</a> &amp;&amp; elem == <span class="stringliteral">&quot;SPRING&quot;</span> ) ||</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            ( <a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a> == <a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1ba5c29d7e8c16f80d457fa37c9dafab61e">AUTUMN</a> &amp;&amp; elem == <span class="stringliteral">&quot;AUTUMN&quot;</span> ) ) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <a class="code" href="classmonster.html#a9ddaee6769a480c655bdbc09e4086040">mating_angry</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a9ddaee6769a480c655bdbc09e4086040">mating_angry</a>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="classmonster.html#a7577aacda4ad32c8ce9e443cceec0a1a">  517</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#a7577aacda4ad32c8ce9e443cceec0a1a">monster::plan</a>()</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;{</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="structmonster__plan.html">monster_plan</a> mon_plan( *<span class="keyword">this</span> );</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    std::bitset&lt;OVERMAP_LAYERS&gt; seen_levels = here.<a class="code" href="classmap.html#a5191133cdc235a399330f5e322570401">get_inter_level_visibility</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().z );</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4">monster_attitude</a> <a class="code" href="widget_8h.html#ac9c40e0d5ffae2a9e10019da79b7983fadc27c0e30cacf9b64bc66bc26f09c89a">mood</a> = <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a>();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;player_character = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// If we can see the player, move toward them or flee.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> == 0 &amp;&amp; seen_levels.test( player_character.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> + <a class="code" href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a> ) &amp;&amp;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">sees</a>( player_character ) ) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> = <a class="code" href="classmonster.html#aac5e0ccac0ace79a458f219f8778f223">rate_target</a>( player_character, mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a>, mon_plan.<a class="code" href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">smart_planning</a> );</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> = mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> || <a class="code" href="classmonster.html#a0f5047243bc2dc00f32c39b5d0918002">is_fleeing</a>( player_character );</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> = &amp;player_character;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">if</span>( !mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> &amp;&amp; <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> &lt;= 20 ) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> += mon_plan.<a class="code" href="structmonster__plan.html#abf476a1550b7942fa59da7341fdb8b63">angers_hostile_seen</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="classmonster.html#a49eaa3645377b9873ceefc3418c34e82">anger_hostile_seen</a>( mon_plan );</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> &lt;= 5 ) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> &lt;= 30 ) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> += mon_plan.<a class="code" href="structmonster__plan.html#aa4b2629a9c4c573b7374d3b795778ba6">angers_hostile_near</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#aa4b2629a9c4c573b7374d3b795778ba6">angers_hostile_near</a> &amp;&amp; <a class="code" href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a>( <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a>, 100 ) ) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af89f1588bb30d81d64b742d34658db06">debugmode::DF_MONSTER</a>, <span class="stringliteral">&quot;%s&#39;s character aggro triggered by proximity&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                <a class="code" href="classmonster.html#ab80f9246aad2b3c22becee9f34dc17d8">aggro_character</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <a class="code" href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">morale</a> -= mon_plan.<a class="code" href="structmonster__plan.html#ae2852d3e6a37badd21ccc50874fe09d1">fears_hostile_near</a>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <a class="code" href="classmonster.html#a740a0ee7c4c9baa7150fc8b0d0e5d237">anger_mating_season</a>( mon_plan );</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="classmonster.html#a24bcf1eb9c4beb329036ad01b5f062dd">anger_cub_threatened</a>( mon_plan );</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> != 0 &amp;&amp; !mon_plan.<a class="code" href="structmonster__plan.html#a835410f0d4159d27640aaf03c0292386">docile</a> ) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="classmonster.html">monster</a> &amp;tmp : <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;all_monsters() ) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">if</span>( tmp.friendly == 0 &amp;&amp; tmp.attitude_to( *<span class="keyword">this</span> ) == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Attitude::HOSTILE</a> &amp;&amp;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                seen_levels.test( tmp.pos().z + <a class="code" href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a> ) ) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="keywordtype">float</span> rating = <a class="code" href="classmonster.html#aac5e0ccac0ace79a458f219f8778f223">rate_target</a>( tmp, mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a>, mon_plan.<a class="code" href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">smart_planning</a> );</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                <span class="keywordflow">if</span>( rating &lt; mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> ) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> = &amp;tmp;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                    mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> = rating;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a835410f0d4159d27640aaf03c0292386">docile</a> ) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> != 0 &amp;&amp; mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <a class="code" href="classmonster.html#a59dab0b0d7e791038c18d01277393686">set_dest</a>( mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a>-&gt;<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() );</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordtype">int</span> valid_targets = ( mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> == nullptr ) ? 0 : 1;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classnpc.html">npc</a> &amp;who : <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;all_npcs() ) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0">mf_attitude</a> faction_att = <a class="code" href="classfaction.html">faction</a>.obj().attitude( who.get_monster_faction() );</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">if</span>( faction_att == <a class="code" href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0a23a2d35aee5d2497bcb11e15f7d7c586">MFA_NEUTRAL</a> || faction_att == <a class="code" href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0a8baef7717ecdcd96e64dca04ab2b4c97">MFA_FRIENDLY</a> ) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">if</span>( !seen_levels.test( who.pos().z + <a class="code" href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a> ) ) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordtype">float</span> rating = <a class="code" href="classmonster.html#aac5e0ccac0ace79a458f219f8778f223">rate_target</a>( who, mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a>, mon_plan.<a class="code" href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">smart_planning</a> );</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordtype">bool</span> fleeing_from = <a class="code" href="classmonster.html#a0f5047243bc2dc00f32c39b5d0918002">is_fleeing</a>( who );</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">if</span>( rating == mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> &amp;&amp; ( mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> || <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a>( &amp;who ) == <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a87f44dc6e793f84b2342dafd6460b263">MATT_ATTACK</a> ||</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                                         <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a>( &amp;who ) == <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a850d5624fd1d54192310ab8b13f228ee">MATT_FOLLOW</a> ) ) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            ++valid_targets;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( valid_targets ) ) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> = &amp;who;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">// Switch targets if closer and hostile or scarier than current target</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">if</span>( ( rating &lt; mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> &amp;&amp; mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> ) ||</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            ( faction_att == <a class="code" href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0a80fd3bb623381aa87ca80a3d035d3867">MFA_HATE</a> ) ||</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            ( rating &lt; mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> &amp;&amp; <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a>( &amp;who ) == <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a87f44dc6e793f84b2342dafd6460b263">MATT_ATTACK</a> ) ||</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            ( !mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> &amp;&amp; fleeing_from ) ) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> = &amp;who;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> = rating;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            valid_targets = 1;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> = mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> || fleeing_from;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">if</span>( rating &lt;= 5 ) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> &lt;= 30 ) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> += mon_plan.<a class="code" href="structmonster__plan.html#aa4b2629a9c4c573b7374d3b795778ba6">angers_hostile_near</a>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#aa4b2629a9c4c573b7374d3b795778ba6">angers_hostile_near</a> &amp;&amp; <a class="code" href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a>( <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a>, 100 ) ) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af89f1588bb30d81d64b742d34658db06">debugmode::DF_MONSTER</a>, <span class="stringliteral">&quot;%s&#39;s character aggro triggered by proximity to %s&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(),</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                               who.name );</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <a class="code" href="classmonster.html#ab80f9246aad2b3c22becee9f34dc17d8">aggro_character</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <a class="code" href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">morale</a> -= mon_plan.<a class="code" href="structmonster__plan.html#ae2852d3e6a37badd21ccc50874fe09d1">fears_hostile_near</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <a class="code" href="classmonster.html#a740a0ee7c4c9baa7150fc8b0d0e5d237">anger_mating_season</a>( mon_plan );</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">if</span>( !mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> &amp;&amp; <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> &lt;= 20 &amp;&amp; valid_targets != 0 ) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> += mon_plan.<a class="code" href="structmonster__plan.html#abf476a1550b7942fa59da7341fdb8b63">angers_hostile_seen</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span>( !mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> &amp;&amp; valid_targets != 0 ) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <a class="code" href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">morale</a> -= mon_plan.<a class="code" href="structmonster__plan.html#a91d261c73a3c6d8907cd55fae4ee7d0c">fears_hostile_seen</a>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <a class="code" href="classmonster.html#a49eaa3645377b9873ceefc3418c34e82">anger_hostile_seen</a>( mon_plan );</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> = mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> || ( <a class="code" href="widget_8h.html#ac9c40e0d5ffae2a9e10019da79b7983fadc27c0e30cacf9b64bc66bc26f09c89a">mood</a> == <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a1c6426f1f830743448b46e8e2aa068b4">MATT_FLEE</a> );</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// Throttle monster thinking, if there are no apparent threats, stop paying attention.</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    constexpr <span class="keywordtype">int</span> max_turns_for_rate_limiting = 1800;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    constexpr <span class="keywordtype">double</span> max_turns_to_skip = 600.0;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">// Outputs a range from 0.0 - 1.0.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordtype">float</span> rate_limiting_factor = 1.0 - <a class="code" href="cata__utility_8cpp.html#a6a85dc6d2ab7bcb093e77d20fcf171d6">logarithmic_range</a>( 0, max_turns_for_rate_limiting,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                 <a class="code" href="classmonster.html#a9653c5f9353177ecee5aff0197af2fcc">turns_since_target</a> );</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">int</span> turns_to_skip = max_turns_to_skip * rate_limiting_factor;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;tracker = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> == 0 &amp;&amp; ( turns_to_skip == 0 || <a class="code" href="classmonster.html#a9653c5f9353177ecee5aff0197af2fcc">turns_since_target</a> % turns_to_skip == 0 ) ) {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        tracker.<a class="code" href="classcreature__tracker.html#a9790b8a1e05d0c5cff55a8aaeef80d94">for_each_reachable</a>( *<span class="keyword">this</span>, [<span class="keyword">this</span>]( <span class="keyword">const</span> <a class="code" href="classint__id.html">mfaction_id</a> &amp; <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a> ) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keyword">const</span> <a class="code" href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0">mf_attitude</a> faction_att = <a class="code" href="classfaction.html">faction</a>-&gt;attitude( <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a> );</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keywordflow">return</span> !( faction_att == <a class="code" href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0a23a2d35aee5d2497bcb11e15f7d7c586">MFA_NEUTRAL</a> || faction_att == <a class="code" href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0a8baef7717ecdcd96e64dca04ab2b4c97">MFA_FRIENDLY</a> );</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        },</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        [<span class="keyword">this</span>, &amp;seen_levels, &amp;mon_plan, &amp;valid_targets]( <a class="code" href="classCreature.html">Creature</a> * <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a> ) {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">if</span>( !seen_levels.test( <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a>-&gt;posz() + <a class="code" href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a> ) ) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <a class="code" href="classmonster.html">monster</a> *mon_ptr = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmonster.html">monster</a> *<span class="keyword">&gt;</span>( <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a> );</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordflow">if</span>( mon_ptr == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <a class="code" href="classmonster.html">monster</a> &amp;mon = *mon_ptr;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordtype">float</span> rating = <a class="code" href="classmonster.html#aac5e0ccac0ace79a458f219f8778f223">rate_target</a>( mon, mon_plan.dist, mon_plan.smart_planning );</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keywordflow">if</span>( rating == mon_plan.dist ) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                ++valid_targets;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( valid_targets ) ) {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    mon_plan.target = &amp;mon;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordflow">if</span>( rating &lt; mon_plan.dist ) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                mon_plan.target = &amp;mon;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                mon_plan.dist = rating;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                valid_targets = 1;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="keywordflow">if</span>( rating &lt;= 5 ) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> &lt;= 30 ) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                    <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> += mon_plan.angers_hostile_near;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                <a class="code" href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">morale</a> -= mon_plan.fears_hostile_near;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keywordflow">if</span>( !mon_plan.fleeing &amp;&amp; <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> &lt;= 20 &amp;&amp; valid_targets != 0 ) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> += mon_plan.angers_hostile_seen;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordflow">if</span>( !mon_plan.fleeing &amp;&amp; valid_targets != 0 ) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <a class="code" href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">morale</a> -= mon_plan.fears_hostile_seen;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        } );</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="comment">// Just avoiding overflow.</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <a class="code" href="classmonster.html#a9653c5f9353177ecee5aff0197af2fcc">turns_since_target</a> = <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( <a class="code" href="classmonster.html#a9653c5f9353177ecee5aff0197af2fcc">turns_since_target</a> + 1, max_turns_for_rate_limiting );</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="classmonster.html#a9653c5f9353177ecee5aff0197af2fcc">turns_since_target</a> = 0;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">// Friendly monsters here</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// Avoid for hordes of same-faction stuff or it could get expensive</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__id.html">mfaction_id</a> actual_faction = <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> == 0 ? <a class="code" href="classmonster.html#a8e30fdb59bcecd8ecb8a609431cb6caf">faction</a> : <a class="code" href="make__static_8h.html#ad8ea997925f9b41fffbf138f4c05e09f">STATIC</a>( <a class="code" href="type__id_8h.html#a0de4f7de7b6dc7d13c525e8a5e0eb615">mfaction_str_id</a>( <span class="stringliteral">&quot;player&quot;</span> ) );</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    mon_plan.<a class="code" href="structmonster__plan.html#ac66e19d4c63eed0cffa0ce69e9cefe8e">swarms</a> = mon_plan.<a class="code" href="structmonster__plan.html#ac66e19d4c63eed0cffa0ce69e9cefe8e">swarms</a> &amp;&amp; mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> == <span class="keyword">nullptr</span>; <span class="comment">// Only swarm if we have no target</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a1f17c727f34c6eb024312137cb3f5166">group_morale</a> || mon_plan.<a class="code" href="structmonster__plan.html#ac66e19d4c63eed0cffa0ce69e9cefe8e">swarms</a> ) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        tracker.<a class="code" href="classcreature__tracker.html#a9790b8a1e05d0c5cff55a8aaeef80d94">for_each_reachable</a>( *<span class="keyword">this</span>, [actual_faction]( <span class="keyword">const</span> <a class="code" href="classint__id.html">mfaction_id</a> &amp; <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a> ) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">return</span> actual_faction == <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        },</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        [<span class="keyword">this</span>, &amp;seen_levels, &amp;mon_plan]( <a class="code" href="classCreature.html">Creature</a> * <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a> ) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="keywordflow">if</span>( !seen_levels.test( <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a>-&gt;posz() + <a class="code" href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a> ) ) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="classmonster.html">monster</a> *mon_ptr = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmonster.html">monster</a> *<span class="keyword">&gt;</span>( <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a> );</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordflow">if</span>( mon_ptr == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <a class="code" href="classmonster.html">monster</a> &amp;mon = *mon_ptr;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="keywordtype">float</span> rating = <a class="code" href="classmonster.html#aac5e0ccac0ace79a458f219f8778f223">rate_target</a>( mon, mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a>, mon_plan.<a class="code" href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">smart_planning</a> );</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a1f17c727f34c6eb024312137cb3f5166">group_morale</a> &amp;&amp; rating &lt;= 10 ) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                <a class="code" href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">morale</a> += 10 - rating;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#ac66e19d4c63eed0cffa0ce69e9cefe8e">swarms</a> ) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                <span class="keywordflow">if</span>( rating &lt; 5 ) { <span class="comment">// Too crowded here</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a> = <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>();</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    <span class="keywordflow">while</span>( <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a> == <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() ) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                        <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a> += <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -3, 3 ), <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -3, 3 ) );</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    <a class="code" href="classmonster.html#a88c30bfeb57c6d44b965f92265fc16d2">wandf</a> = 2;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    <span class="comment">// Swarm to the furthest ally you can see</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( rating &lt; FLT_MAX &amp;&amp; rating &gt; mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> &amp;&amp; <a class="code" href="classmonster.html#a88c30bfeb57c6d44b965f92265fc16d2">wandf</a> &lt;= 0 ) {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> = &amp;mon;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                    mon_plan.<a class="code" href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">dist</a> = rating;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        } );</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">// Operating monster keep you safe while they operate, how nice....</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a3782082ac316cac7f189d089b3b16000">has_special_attack</a>( <span class="stringliteral">&quot;OPERATE&quot;</span> ) ) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ab8dd6142a7131d3af944e532002ac9e3">effect_operating</a> ) ) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> = 100;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordflow">for</span>( <a class="code" href="classCreature.html">Creature</a> *critter : here.<a class="code" href="classmap.html#a1a80ad5cb3705a2bde8834eb8e4a93bd">get_creatures_in_radius</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 6 ) ) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                <a class="code" href="classmonster.html">monster</a> *mon = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmonster.html">monster</a> *<span class="keyword">&gt;</span>( critter );</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <span class="keywordflow">if</span>( mon != <span class="keyword">nullptr</span> &amp;&amp; mon-&gt;<a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a51ec342d71717bb513f0158198b12840">in_species</a>( <a class="code" href="monmove_8cpp.html#a6d062e430202ce21974bf3fb492002bf">species_ZOMBIE</a> ) ) {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> = 100;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                    <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> = 0;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a> ) ) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a3782082ac316cac7f189d089b3b16000">has_special_attack</a>( <span class="stringliteral">&quot;OPERATE&quot;</span> ) ) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordtype">bool</span> found_path_to_couch = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <a class="code" href="structtripoint.html">tripoint</a> tmp( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( 12, 12 ) );</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <a class="code" href="structtripoint.html">tripoint</a> couch_loc;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;couch_pos : here.<a class="code" href="classmap.html#af714ce93fc3f45015bdc9cd4d256599f">find_furnitures_with_flag_in_radius</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 10,</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                    <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a5b189c7326ca1246de45a1579b907d5e">ter_furn_flag::TFLAG_AUTODOC_COUCH</a> ) ) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a49630763b899657bfa7c10586df7d360">clear_path</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), couch_pos, 10, 0, 100 ) ) {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    <span class="keywordflow">if</span>( <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), couch_pos ) &lt; <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), tmp ) ) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                        tmp = couch_pos;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                        found_path_to_couch = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                        couch_loc = couch_pos;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordflow">if</span>( !found_path_to_couch ) {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> = 0;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <a class="code" href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">remove_effect</a>( <a class="code" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a> );</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <a class="code" href="classmonster.html#a59dab0b0d7e791038c18d01277393686">set_dest</a>( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( couch_loc ) );</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> dest = mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a>-&gt;<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>();</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217">Creature::Attitude</a> att_to_target = <a class="code" href="classmonster.html#a125622587c2069dc4dbbe07943c81336">attitude_to</a>( *mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a> );</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">if</span>( att_to_target == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Attitude::HOSTILE</a> &amp;&amp; !mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> ) {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <a class="code" href="classmonster.html#a59dab0b0d7e791038c18d01277393686">set_dest</a>( dest );</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">fleeing</a> ) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> away = <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() - dest + <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>();</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            away.<a class="code" href="classcoords_1_1coord__point__mut.html#aa94b8bd33e85ce94a3634e6e27ab0cdd">z</a>() = <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>();</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <a class="code" href="classmonster.html#a59dab0b0d7e791038c18d01277393686">set_dest</a>( away );</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">if</span>( ( mon_plan.<a class="code" href="structmonster__plan.html#a4f34314c218249a6e771e55d75a0bf4a">angers_hostile_weak</a> || mon_plan.<a class="code" href="structmonster__plan.html#a609da64a368f08449b8238be8c02061a">fears_hostile_weak</a> ||</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;              mon_plan.<a class="code" href="structmonster__plan.html#a783d4b87496b39a7cb483e717a7d18c3">placate_hostile_weak</a> ) &amp;&amp;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            att_to_target != <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Attitude::FRIENDLY</a> ) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keywordtype">int</span> hp_per = mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a>-&gt;<a class="code" href="classCreature.html#a140c55c27932cd7a09befc12d80b9a3c">hp_percentage</a>();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordflow">if</span>( hp_per &lt;= 70 ) {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a4f34314c218249a6e771e55d75a0bf4a">angers_hostile_weak</a> &amp;&amp; <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> &lt;= 40 ) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> += 10 - <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( hp_per / 10 );</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    <span class="keywordflow">if</span>( <a class="code" href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a>( <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a>, 100 ) ) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                        <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af89f1588bb30d81d64b742d34658db06">debugmode::DF_MONSTER</a>, <span class="stringliteral">&quot;%s&#39;s character aggro triggered by %s&#39;s weakness&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(),</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                       mon_plan.<a class="code" href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">target</a>-&gt;<a class="code" href="classCreature.html#a26b7c431f85f0b99b888db69318ebdc5">disp_name</a>() );</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                        <a class="code" href="classmonster.html#ab80f9246aad2b3c22becee9f34dc17d8">aggro_character</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a609da64a368f08449b8238be8c02061a">fears_hostile_weak</a> ) {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    <a class="code" href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">morale</a> -= 10 - <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( hp_per / 10 );</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( mon_plan.<a class="code" href="structmonster__plan.html#a783d4b87496b39a7cb483e717a7d18c3">placate_hostile_weak</a> ) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    <a class="code" href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">anger</a> -= 10 - <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( hp_per / 10 );</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#ae4ddfd29306c2e768f545aed901be3f9">patrol_route</a>.empty() ) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="comment">// If we have a patrol route and no target, find the current step on the route</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> next_stop = <a class="code" href="classmonster.html#ae4ddfd29306c2e768f545aed901be3f9">patrol_route</a>.at( <a class="code" href="classmonster.html#abeb3743ffee119ce1507af082bb5a0e0">next_patrol_point</a> );</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="comment">// if there is more than one patrol point, advance to the next one if we&#39;re almost there</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="comment">// this handles impassable obstacles but patrollers can still get stuck</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordflow">if</span>( ( <a class="code" href="classmonster.html#ae4ddfd29306c2e768f545aed901be3f9">patrol_route</a>.size() &gt; 1 ) &amp;&amp; <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( next_stop, <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() ) &lt; 2 ) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <a class="code" href="classmonster.html#abeb3743ffee119ce1507af082bb5a0e0">next_patrol_point</a> = ( <a class="code" href="classmonster.html#abeb3743ffee119ce1507af082bb5a0e0">next_patrol_point</a> + 1 ) % <a class="code" href="classmonster.html#ae4ddfd29306c2e768f545aed901be3f9">patrol_route</a>.size();</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            next_stop = <a class="code" href="classmonster.html#ae4ddfd29306c2e768f545aed901be3f9">patrol_route</a>.at( <a class="code" href="classmonster.html#abeb3743ffee119ce1507af082bb5a0e0">next_patrol_point</a> );</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <a class="code" href="classmonster.html#a59dab0b0d7e791038c18d01277393686">set_dest</a>( next_stop );</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> != 0 &amp;&amp; <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ad5fa326832c0a774d6a775e605f27788">effect_led_by_leash</a> ) &amp;&amp;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;               <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>().z() == <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>().z() ) {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="comment">// visibility doesn&#39;t matter, we&#39;re getting pulled by a leash</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="comment">// To use stairs smoothly, if the destination is on a different Z-level, move there first.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="classmonster.html#a59dab0b0d7e791038c18d01277393686">set_dest</a>( player_character.<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() );</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> &gt; 0 &amp;&amp; <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 3 ) ) {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <span class="comment">// Grow restless with no targets</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a>--;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> &gt; 0 &amp;&amp; <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 3 ) ) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="comment">// Grow restless with no targets</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a>--;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a28fd163537c2f82c7a733d69c8c8da75">is_pet_follow</a>() &amp;&amp; <a class="code" href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">sees</a>( player_character ) &amp;&amp;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;               ( <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>().z() == player_character.<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>().<a class="code" href="classcoords_1_1coord__point__mut.html#aa94b8bd33e85ce94a3634e6e27ab0cdd">z</a>() ||</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                 <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>().z() == <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>().z() ) ) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="comment">// Simpleminded animals are too dumb to follow the player.</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="comment">// To use stairs smoothly, if the destination is on a different Z-level, move there first.</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <a class="code" href="classmonster.html#a59dab0b0d7e791038c18d01277393686">set_dest</a>( player_character.<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() );</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;}</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment"> * Method to make monster movement speed consistent in the face of staggering behavior and</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"> * differing distance metrics.</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment"> * It works by scaling the cost to take a step by</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment"> * how much that step reduces the distance to your goal.</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment"> * Since it incorporates the current distance metric,</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"> * it also scales for diagonal vs orthogonal movement.</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#aa9166c53ef32fe65a5c624d530a0210c">  825</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">float</span> <a class="code" href="monmove_8cpp.html#aa9166c53ef32fe65a5c624d530a0210c">get_stagger_adjust</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;source, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;destination,</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;next_step )</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;{</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="comment">// TODO: push this down into rl_dist</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> initial_dist =</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <a class="code" href="line_8cpp.html#a40b9d88f6d95e646490329d0071ec931">trigdist</a> ? <a class="code" href="coordinates_8h.html#aafe19be6ce6f4788aa78a07a71807739">trig_dist</a>( source, destination ) : <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source, destination );</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> new_dist =</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <a class="code" href="line_8cpp.html#a40b9d88f6d95e646490329d0071ec931">trigdist</a> ? <a class="code" href="coordinates_8h.html#aafe19be6ce6f4788aa78a07a71807739">trig_dist</a>( next_step, destination ) : <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( next_step, destination );</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// If we return 0, it wil cancel the action.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0.01f, initial_dist - new_dist );</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;}</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment"> * Returns true if the given square presents a possibility of drowning for the monster: it&#39;s deep water, it&#39;s liquid,</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment"> * the monster can drown, and there is no boardable vehicle part present.</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00841"></a><span class="lineno"><a class="line" href="classmonster.html#aee5ef0428af50c1c78fd68d8c92c98a5">  841</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#aee5ef0428af50c1c78fd68d8c92c98a5">monster::is_aquatic_danger</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;at_pos )<span class="keyword"> const</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">return</span> here.<a class="code" href="classmap.html#af0e872a5d0a7bf1e9745aeb18d3b5e44">has_flag_ter</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac6e19e1c41724be67b2bff2870539ca1">ter_furn_flag::TFLAG_DEEP_WATER</a>, at_pos ) &amp;&amp;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;           here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a7518f40a34b4cbfbc922c4888af267cc">ter_furn_flag::TFLAG_LIQUID</a>, at_pos ) &amp;&amp;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;           <a class="code" href="classmonster.html#ac654df3156626ea7e474365b5fd0056e">can_drown</a>() &amp;&amp; !here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( at_pos ).<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <span class="stringliteral">&quot;BOARDABLE&quot;</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno"><a class="line" href="classmonster.html#a9118d0de36f4dbb72c28cc0832bba897">  849</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a9118d0de36f4dbb72c28cc0832bba897">monster::die_if_drowning</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;at_pos, <span class="keyword">const</span> <span class="keywordtype">int</span> chance )</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;{</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aee5ef0428af50c1c78fd68d8c92c98a5">is_aquatic_danger</a>( at_pos ) &amp;&amp; <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( chance ) ) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( at_pos, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %s drowns!&quot;</span> ), <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <a class="code" href="classmonster.html#a82ae41773b05af94d4b678cb33bfb329">die</a>( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;}</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">// General movement.</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">// Currently, priority goes:</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">// 1) Special Attack</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">// 2) Sight-based tracking</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">// 3) Scent-based tracking</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">// 4) Sound-based tracking</span></div>
<div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="classmonster.html#adbc2b2a9fe75356ff70d4c6ec64eb0b5">  865</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#adbc2b2a9fe75356ff70d4c6ec64eb0b5">monster::move</a>()</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;{</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2ab576821e0d29160d6272e3c6f9faa323">debugmode::DF_MONMOVE</a>, <span class="stringliteral">&quot;Monster %s starting monmove::move, remaining moves %d&quot;</span>,</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                   <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(), <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> );</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// We decrement wandf no matter what.  We&#39;ll save our wander_to plans until</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// after we finish out set_dest plans, UNLESS they time out first.</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a88c30bfeb57c6d44b965f92265fc16d2">wandf</a> &gt; 0 ) {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="classmonster.html#a88c30bfeb57c6d44b965f92265fc16d2">wandf</a>--;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">//Hallucinations have a chance of disappearing each turn</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() &amp;&amp; <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 25 ) ) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <a class="code" href="classmonster.html#a82ae41773b05af94d4b678cb33bfb329">die</a>( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;player_character = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <a class="code" href="classbehavior_1_1monster__oracle__t.html">behavior::monster_oracle_t</a> oracle( <span class="keyword">this</span> );</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="classbehavior_1_1tree.html">behavior::tree</a> goals;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    goals.<a class="code" href="classbehavior_1_1tree.html#a8a804865e2e82225a7e2da417adbd5a4">add</a>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#adba404a1bab62eccbe6a9720cae88c42">get_goals</a>() );</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    std::string <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> = goals.<a class="code" href="classbehavior_1_1tree.html#a1bc592e4ec2c37fd3f00388b94de98bb">tick</a>( &amp;oracle );</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">//The monster can consume objects it stands on. Check if there are any.</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="comment">//If there are. Consume them.</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// TODO: Stick this in a map and dispatch to it via the action string.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">// TODO: Create a special attacks whitelist unordered map instead of an if chain.</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    std::map&lt;std::string, mtype_special_attack&gt;::const_iterator <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> =</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#ad3d8be7cacb7cd0a19b2c187c9e1ac26">special_attacks</a>.find( <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> );</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> != <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#ad3d8be7cacb7cd0a19b2c187c9e1ac26">special_attacks</a>.end() &amp;&amp; <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>-&gt;second-&gt;call( *<span class="keyword">this</span> ) ) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a939eb403e417f4b0c032e827fecc9ab3">special_attacks</a>.count( <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> ) != 0 ) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <a class="code" href="classmonster.html#a60ae9c29710c56417f769dea8381becf">reset_special</a>( <a class="code" href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a> );</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// record position before moving to put the player there if we&#39;re dragging</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> drag_to = <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> pacified = <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a79654cfc6f07462199ec3f5da9e49c83">effect_pacified</a> );</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">// First, use the special attack, if we can!</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">// The attack may change `monster::special_attacks` (e.g. by transforming</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">// this into another monster type). Therefore we can not iterate over it</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">// directly and instead iterate over the map from the monster type</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">// (properties of monster types should never change).</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;sp_type : <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#ad3d8be7cacb7cd0a19b2c187c9e1ac26">special_attacks</a> ) {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keyword">const</span> std::string &amp;special_name = sp_type.first;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> local_iter = <a class="code" href="classmonster.html#a939eb403e417f4b0c032e827fecc9ab3">special_attacks</a>.find( special_name );</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">if</span>( local_iter == <a class="code" href="classmonster.html#a939eb403e417f4b0c032e827fecc9ab3">special_attacks</a>.end() ) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <a class="code" href="classmon__special__attack.html">mon_special_attack</a> &amp;local_attack_data = local_iter-&gt;second;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">if</span>( !local_attack_data.<a class="code" href="classmon__special__attack.html#abbba44d1a5d5d62d696959bab20b8e67">enabled</a> ) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2a06b26a3d79dd171e505cf88e89ede5bb">debugmode::DF_MATTACK</a>, <span class="stringliteral">&quot;%s attempting a special attack %s, cooldown %d&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(),</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                       sp_type.first, local_attack_data.<a class="code" href="classmon__special__attack.html#a0f121c831a2ecb77efe06aa048f60e58">cooldown</a> );</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="comment">// Cooldowns are decremented in monster::process_turn</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordflow">if</span>( local_attack_data.<a class="code" href="classmon__special__attack.html#a0f121c831a2ecb77efe06aa048f60e58">cooldown</a> == 0 &amp;&amp; !pacified &amp;&amp; !<a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <span class="keywordflow">if</span>( !sp_type.second-&gt;call( *<span class="keyword">this</span> ) ) {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2a06b26a3d79dd171e505cf88e89ede5bb">debugmode::DF_MATTACK</a>, <span class="stringliteral">&quot;Attack failed&quot;</span> );</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="comment">// `special_attacks` might have changed at this point. Sadly `reset_special`</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="comment">// doesn&#39;t check the attack name, so we need to do it here.</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a939eb403e417f4b0c032e827fecc9ab3">special_attacks</a>.count( special_name ) == 0 ) {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <a class="code" href="classmonster.html#a60ae9c29710c56417f769dea8381becf">reset_special</a>( special_name );</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">// Check if they&#39;re dragging a foe and find their hapless victim</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <a class="code" href="classCharacter.html">Character</a> *dragged_foe = <a class="code" href="classmonster.html#a16052a26adbecf002c5d502660ec7434">find_dragged_foe</a>();</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="comment">// Give nursebots a chance to do surgery.</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <a class="code" href="classmonster.html#a3078e262a3a130efa9985bfa04a26bd8">nursebot_operate</a>( dragged_foe );</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">// The monster can sometimes hang in air due to last fall being blocked</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() &amp;&amp; !here.<a class="code" href="classmap.html#a78e0a35a5041e0daf6e7a2a4ec522014">has_floor_or_water</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) &amp;&amp; !here.<a class="code" href="classmap.html#a5ee9fe3a08892870a0574b8e1ab4e6b0">has_vehicle_floor</a>( <a class="code" href="classCreature.html#af7172e571c5c69240d9f71a01fddf035">pos_bub</a>() ) ) {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        here.<a class="code" href="classmap.html#ae0dae45aeed1b7221d318c0a36abca5b">creature_on_trap</a>( *<span class="keyword">this</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#af033816139df1dfa154c27b199b51da6">is_dead</a>() ) {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// if the monster is in a deep water tile, it has a chance to drown</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a9118d0de36f4dbb72c28cc0832bba897">die_if_drowning</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 10 ) ) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> &lt; 0 ) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">// TODO: Move this to attack_at/move_to/etc. functions</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">bool</span> attacking = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#aaed6da4f001755d7fdd7ea56df8ac44d">move_effects</a>( attacking ) ) {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> = 0;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#af8eb4198f7564379a407e89c13cdd1b7">mon_flag_IMMOBILE</a> ) || <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a1ce59be15eeebc2aa195dc5a5cf38358">mon_flag_RIDEABLE_MECH</a> ) ) {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> = 0;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">effect_stunned</a> ) || <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#adcaf70773541073a0d4cdfce4b857bf7">effect_psi_stunned</a> ) ) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <a class="code" href="classmonster.html#a6adba28c21a8b6e6cc1b81f2f31d1947">stumble</a>();</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> = 0;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> &gt; 0 ) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        --<a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoptional__vpart__position.html">optional_vpart_position</a> ovp = here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a7697771dc47ecaeff36785ff20c9aa33">effect_harnessed</a> ) ) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordflow">if</span>( !ovp.<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <span class="stringliteral">&quot;ANIMAL_CTRL&quot;</span>, <span class="keyword">true</span> ) ) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <a class="code" href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">remove_effect</a>( <a class="code" href="monmove_8cpp.html#a7697771dc47ecaeff36785ff20c9aa33">effect_harnessed</a> ); <span class="comment">// the harness part probably broke</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> = 0;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keywordflow">return</span>; <span class="comment">// don&#39;t move if harnessed</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keyword">const</span> std::optional&lt;vpart_reference&gt; vp_boardable = ovp.<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <span class="stringliteral">&quot;BOARDABLE&quot;</span>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">if</span>( vp_boardable &amp;&amp; <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> != 0 ) {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keyword">const</span> <a class="code" href="classvehicle.html">vehicle</a> &amp;veh = vp_boardable-&gt;<a class="code" href="classvehicle.html#a1f80b26dc4684734f1a903605f3cd4a3">vehicle</a>();</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="keywordflow">if</span>( veh.<a class="code" href="classvehicle.html#aec9a1faa6740b681867d48878e37d7bb">is_moving</a>() &amp;&amp; veh.<a class="code" href="classvehicle.html#a8d856b434f959359bf729b5b390e6278">get_monster</a>( vp_boardable-&gt;part_index() ) ) {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> = 0;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keywordflow">return</span>; <span class="comment">// don&#39;t move if friendly and passenger in a moving vehicle</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">// Set attitude to attitude to our current target</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4">monster_attitude</a> current_attitude = <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a>( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#aa58e9ab3e08e72fd37c757b761d2671c">is_wandering</a>() ) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() == player_character.<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() ) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            current_attitude = <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a>( &amp;player_character );</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classnpc.html">npc</a> &amp;guy : <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;all_npcs() ) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() == guy.get_location() ) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    current_attitude = <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a>( &amp;guy );</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a28fd163537c2f82c7a733d69c8c8da75">is_pet_follow</a>() || ( <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> != 0 &amp;&amp; <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ad5fa326832c0a774d6a775e605f27788">effect_led_by_leash</a> ) ) ) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> dist = <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>(), <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() );</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="keywordflow">if</span>( ( dist &lt;= 1 || ( dist &lt;= 2 &amp;&amp; !<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ad5fa326832c0a774d6a775e605f27788">effect_led_by_leash</a> ) &amp;&amp;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                             <a class="code" href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">sees</a>( player_character ) ) ) &amp;&amp;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            ( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() == player_character.<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() &amp;&amp;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;              <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>().z() == player_character.<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>().<a class="code" href="classcoords_1_1coord__point__mut.html#aa94b8bd33e85ce94a3634e6e27ab0cdd">z</a>() ) ) {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> = 0;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <a class="code" href="classmonster.html#a6adba28c21a8b6e6cc1b81f2f31d1947">stumble</a>();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( current_attitude == <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4aa81d19ea97def3730dddfc9451b53de5">MATT_IGNORE</a> &amp;&amp; <a class="code" href="classmonster.html#ae4ddfd29306c2e768f545aed901be3f9">patrol_route</a>.empty() ) ||</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;               ( ( current_attitude == <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a850d5624fd1d54192310ab8b13f228ee">MATT_FOLLOW</a> ||</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                   ( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#ad6a17cb01971e10f58414cf964a400e2">mon_flag_KEEP_DISTANCE</a> ) &amp;&amp; !( current_attitude == <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a1c6426f1f830743448b46e8e2aa068b4">MATT_FLEE</a> ) ) )</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                 &amp;&amp; <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>(), <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() ) &lt;= <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#afb696f9fd6734d41999a056ac3924475">tracking_distance</a> ) ) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> = 0;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <a class="code" href="classmonster.html#a6adba28c21a8b6e6cc1b81f2f31d1947">stumble</a>();</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordtype">bool</span> moved = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> destination;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordtype">bool</span> try_to_move = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;dest : here.<a class="code" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 1 ) ) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keywordflow">if</span>( dest != <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">can_move_to</a>( dest ) &amp;&amp;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( dest, <span class="keyword">true</span> ) == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                try_to_move = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="comment">// If true, don&#39;t try to greedily avoid locally bad paths</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordtype">bool</span> pathed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> local_dest = here.<a class="code" href="classmap.html#a426c21f7244ff80a61685a89e9146fec">getlocal</a>( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() );</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">if</span>( try_to_move ) {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="comment">// Move using vision by follow smells and sounds</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordtype">bool</span> move_without_target = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa58e9ab3e08e72fd37c757b761d2671c">is_wandering</a>() &amp;&amp; <a class="code" href="classmonster.html#ad0f32b1f18afffaa98c73767eb059ec9">has_intelligence</a>() &amp;&amp; <a class="code" href="classmonster.html#a79c1aef59cccba881fc60e52fb6d8cb9">can_see</a>() ) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a7598512ae9ca78a96974d3ca4237b044">mon_flag_SMELLS</a> ) ) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                <a class="code" href="classmonster.html#a1488f5a618c74a508fb87b82be05ef11">unset_dest</a>();</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                <a class="code" href="structtripoint.html">tripoint</a> tmp = <a class="code" href="classmonster.html#ace81cf5d7ddd0385d3cf2e66d4c47ff7">scent_move</a>();</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                <span class="keywordflow">if</span>( tmp.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> != -1 ) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                    local_dest = tmp;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                    move_without_target = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2ab576821e0d29160d6272e3c6f9faa323">debugmode::DF_MONMOVE</a>, <span class="stringliteral">&quot;%s follows smell using vision&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <span class="keywordflow">if</span>( !move_without_target &amp;&amp; <a class="code" href="classmonster.html#a88c30bfeb57c6d44b965f92265fc16d2">wandf</a> &gt; 0 &amp;&amp; <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> == 0 ) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                <a class="code" href="classmonster.html#a1488f5a618c74a508fb87b82be05ef11">unset_dest</a>();</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a> != <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() ) {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                    local_dest = here.<a class="code" href="classmap.html#a426c21f7244ff80a61685a89e9146fec">getlocal</a>( <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a> );</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                    move_without_target = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2ab576821e0d29160d6272e3c6f9faa323">debugmode::DF_MONMOVE</a>, <span class="stringliteral">&quot;%s follows sound using vision&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#aa58e9ab3e08e72fd37c757b761d2671c">is_wandering</a>() || move_without_target ) {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="keywordflow">while</span>( !<a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.empty() &amp;&amp; <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.front() == <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) {</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.erase( <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.begin() );</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            }</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keyword">const</span> <a class="code" href="structpathfinding__settings.html">pathfinding_settings</a> &amp;pf_settings = <a class="code" href="classmonster.html#a873925c09bec361ffd2363626828a362">get_pathfinding_settings</a>();</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keywordflow">if</span>( pf_settings.<a class="code" href="structpathfinding__settings.html#ad0b14e2ee3fc5bb59d985e98e2fa9504">max_dist</a> &gt;= <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>(), <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() ) &amp;&amp;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                ( <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.empty() || <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.front() ) &gt;= 2 || <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.back() != local_dest ) ) {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <span class="comment">// We need a new path</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#af35316ade396ac63cf5655105a420dbb">can_pathfind</a>() ) {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a> = here.<a class="code" href="classmap.html#acd464679b3bb514e2568ffdb3260ef0c">route</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), local_dest, pf_settings, <a class="code" href="classmonster.html#a12d0f90c38e7463844592281c87dd250">get_path_avoid</a>() );</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.empty() ) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                        <a class="code" href="classmonster.html#a71b5a8e94a71255502dfd413e135d301">increment_pathfinding_cd</a>();</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                    }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a> = here.<a class="code" href="classmap.html#a9fe6f81443a4ae45012d6e664efb74c2">straight_route</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), local_dest );</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.empty() ) {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                        std::unordered_set&lt;tripoint&gt; closed = <a class="code" href="classmonster.html#a12d0f90c38e7463844592281c87dd250">get_path_avoid</a>();</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                        <span class="keywordflow">if</span>( std::any_of( <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.begin(), <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.end(), [&amp;closed]( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp; p ) {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                        return closed.count( p );</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        } ) ) {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                            <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.clear();</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                        }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                    }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.empty() ) {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                    <a class="code" href="classmonster.html#a504851437db082b0c62e50ff48ec08fb">reset_pathfinding_cd</a>();</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="comment">// Try to respect old paths, even if we can&#39;t pathfind at the moment</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.empty() &amp;&amp; <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.back() == local_dest ) {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                destination = <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.front();</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                moved = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                pathed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                <span class="comment">// Straight line forward, probably because we can&#39;t pathfind (well enough)</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                destination = local_dest;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                moved = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    }</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">if</span>( !moved &amp;&amp; <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a7598512ae9ca78a96974d3ca4237b044">mon_flag_SMELLS</a> ) ) {</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="comment">// No sight... or our plans are invalid (e.g. moving through a transparent, but</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="comment">//  solid, square of terrain).  Fall back to smell if we have it.</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <a class="code" href="classmonster.html#a1488f5a618c74a508fb87b82be05ef11">unset_dest</a>();</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <a class="code" href="structtripoint.html">tripoint</a> tmp = <a class="code" href="classmonster.html#ace81cf5d7ddd0385d3cf2e66d4c47ff7">scent_move</a>();</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="keywordflow">if</span>( tmp.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> != -1 ) {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            destination = tmp;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            moved = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2ab576821e0d29160d6272e3c6f9faa323">debugmode::DF_MONMOVE</a>, <span class="stringliteral">&quot;%s follows smell to not use vision&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a88c30bfeb57c6d44b965f92265fc16d2">wandf</a> &gt; 0 &amp;&amp; !moved &amp;&amp; <a class="code" href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">friendly</a> == 0 ) { <span class="comment">// No LOS, no scent, so as a fall-back follow sound</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <a class="code" href="classmonster.html#a1488f5a618c74a508fb87b82be05ef11">unset_dest</a>();</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a> != <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() ) {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            destination = here.<a class="code" href="classmap.html#a426c21f7244ff80a61685a89e9146fec">getlocal</a>( <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a> );</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            moved = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2ab576821e0d29160d6272e3c6f9faa323">debugmode::DF_MONMOVE</a>, <span class="stringliteral">&quot;%s follows sound to not use vision&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="structpoint.html">point</a> new_d( destination.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>() - <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().xy() );</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="comment">// toggle facing direction for sdl flip</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;is_tileset_isometric() ) {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">if</span>( new_d.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> &lt; 0 ) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> = <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758">FacingDirection::LEFT</a>;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( new_d.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> &gt; 0 ) {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            <a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> = <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403">FacingDirection::RIGHT</a>;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        }</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">if</span>( new_d.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> &lt;= 0 &amp;&amp; new_d.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> &lt;= 0 ) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> = <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758">FacingDirection::LEFT</a>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">if</span>( new_d.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> &gt;= 0 &amp;&amp; new_d.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> &gt;= 0 ) {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> = <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403">FacingDirection::RIGHT</a>;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> next_step;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> can_open_doors = <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a0e12efd1ed65a888bff5a5db5faeaf96">mon_flag_CAN_OPEN_DOORS</a> ) &amp;&amp; !<a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>();</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> staggers = <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a0ab20367a507f953bab44113234bd07a">mon_flag_STUMBLES</a> );</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keywordflow">if</span>( moved ) {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="comment">// Implement both avoiding obstacles and staggering.</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        moved = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <span class="keywordtype">float</span> switch_chance = 0.0f;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> can_bash = <a class="code" href="classmonster.html#a7410372f55ca62ae5eda0fcc63b48622">bash_skill</a>() &gt; 0;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        <span class="comment">// This is a float and using trig_dist() because that Does the Right Thing(tm)</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <span class="comment">// in both circular and roguelike distance modes.</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> distance_to_target = <a class="code" href="coordinates_8h.html#aafe19be6ce6f4788aa78a07a71807739">trig_dist</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), destination );</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="structtripoint.html">tripoint</a> &amp;candidate : <a class="code" href="line_8cpp.html#ac3d2ba0a4c40ecc74117e5b9752fac02">squares_closer_to</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), destination ) ) {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="comment">// rare scenario when monster is on the border of the map and it&#39;s goal is outside of the map</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a46608709f68358365d0734b1063fed73">inbounds</a>( candidate ) ) {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            <span class="keywordtype">bool</span> via_ramp = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            <span class="keywordtype">int</span> rampPos = 0;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a4099f16f8e2c4ea80e996db0ea6f4c02">ter_furn_flag::TFLAG_RAMP_UP</a>, candidate ) ) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                via_ramp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                rampPos -= 1;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                candidate.z += 1;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a26a026d844907da147f1350754b5210b">ter_furn_flag::TFLAG_RAMP_DOWN</a>, candidate ) ) {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                via_ramp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                rampPos += 1;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                candidate.z -= 1;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> candidate_abs = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( candidate );</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="keywordflow">if</span>( candidate.z != <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() ) {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                <span class="keywordtype">bool</span> can_z_move = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a3188771064ca49d4798c6a80bfad0fcd">valid_move</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), candidate, <span class="keyword">false</span>, <span class="keyword">true</span>, via_ramp ) ) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                    <span class="comment">// Can&#39;t phase through floor</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    can_z_move = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                <span class="comment">// If we&#39;re trying to go up but can&#39;t fly, check if we can climb. If we can&#39;t, then don&#39;t</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                <span class="comment">// This prevents non-climb/fly enemies running up walls</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                <span class="keywordflow">if</span>( candidate.z &gt; <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() &amp;&amp; !( via_ramp || <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() ) ) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#abca4913777aa7ed67c109de4b667ed54">can_climb</a>() || !here.<a class="code" href="classmap.html#a3e525fc14178c776d0261cce3efec2a0">has_floor_or_support</a>( candidate ) ) {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                        <span class="keywordflow">if</span>( ( !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) ||</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                              !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, candidate ) ) ) {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                            <span class="comment">// Can&#39;t &quot;jump&quot; up a whole z-level</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                            can_z_move = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                        }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                    }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                <span class="comment">// Last chance - we can still do the z-level stair teleport bullshit that isn&#39;t removed yet</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                <span class="comment">// TODO: Remove z-level stair bullshit teleport after aligning all stairs</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                <span class="keywordflow">if</span>( !can_z_move &amp;&amp;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                    <a class="code" href="classCreature.html#aecea7d852ffba499ec12350c95340b9d">posx</a>() / ( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 ) == candidate.x / ( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 ) &amp;&amp;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                    <a class="code" href="classCreature.html#a9f0365208b65ab1c45d23f03f402f491">posy</a>() / ( <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 ) == candidate.y / ( <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 ) ) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                    <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> upper = candidate.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> &gt; <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() ? candidate : <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>();</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                    <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> lower = candidate.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> &gt; <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() ? <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() : candidate;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ab09f2463f4ce060d051439b5535a47e6">ter_furn_flag::TFLAG_GOES_DOWN</a>, upper ) &amp;&amp;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                        here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a589ce1673849a76ea3bf17df3fe84ab3">ter_furn_flag::TFLAG_GOES_UP</a>, lower ) ) {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                        can_z_move = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                <span class="keywordflow">if</span>( !can_z_move ) {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <span class="comment">// A flag to allow non-stumbling critters to stumble when the most direct choice is bad.</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;            <span class="keywordtype">bool</span> bad_choice = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> *target = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( candidate, <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() );</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            <span class="keywordflow">if</span>( target != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() != target-&gt;<a class="code" href="classCreature.html#a3cb42eea32fd7e172dca0e902d1184ed">is_hallucination</a>() &amp;&amp; !target-&gt;<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() ) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                    <span class="comment">// Hallucinations should only be capable of targeting the player or other hallucinations.</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                <span class="keyword">const</span> <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217">Attitude</a> att = <a class="code" href="classmonster.html#a125622587c2069dc4dbbe07943c81336">attitude_to</a>( *target );</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                <span class="keywordflow">if</span>( att == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Attitude::HOSTILE</a> ) {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                    <span class="comment">// When attacking an adjacent enemy, we&#39;re direct.</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                    moved = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                    next_step = candidate_abs;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                <span class="keywordflow">if</span>( att == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Attitude::FRIENDLY</a> &amp;&amp; ( target-&gt;<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() || target-&gt;<a class="code" href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">is_npc</a>() ||</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                                   target-&gt;<a class="code" href="classCreature.html#aec78049b0ee4401d3a4c073663735aad">has_flag</a>( <a class="code" href="mtype_8cpp.html#aa03ff0de8ff0fccbe3aedafcef1c5153">mon_flag_QUEEN</a> ) ) ) {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                    <span class="comment">// Friendly firing the player or an NPC is illegal for gameplay reasons.</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                    <span class="comment">// Monsters should instinctively avoid attacking queens that regenerate their own population.</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a28012e7b03f25df53cd371150ad24916">mon_flag_ATTACKMON</a> ) &amp;&amp; !<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#af882b7fb7b2ad4d4d8a66371e2a5793c">mon_flag_PUSH_MON</a> ) ) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                    <span class="comment">// Bail out if there&#39;s a non-hostile monster in the way and we&#39;re not pushy.</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                <span class="comment">// Friendly fire and pushing are always bad choices - they take a lot of time</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                bad_choice = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <span class="comment">// is there an openable door?</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            <span class="keywordflow">if</span>( can_open_doors &amp;&amp;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                here.<a class="code" href="classmap.html#a9ac1c68c3941554a86bff27bf1ce2389">open_door</a>( *<span class="keyword">this</span>, candidate, !here.<a class="code" href="classmap.html#a3bc75c8b706a54c1575b4460b2f363b1">is_outside</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ), <span class="keyword">true</span> ) ) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                moved = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                next_step = candidate_abs;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            <span class="comment">// Try to shove vehicle out of the way</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <a class="code" href="classmonster.html#ad18dfb6454b3ce4172d476af3a042f4b">shove_vehicle</a>( destination, candidate );</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <span class="comment">// Bail out if we can&#39;t move there and we can&#39;t bash.</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            <span class="keywordflow">if</span>( !pathed &amp;&amp; !<a class="code" href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">can_move_to</a>( candidate ) ) {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                <span class="keywordflow">if</span>( !can_bash ) {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                <span class="comment">// Don&#39;t bash if we&#39;re just tracking a noise.</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#a790b213f8c42018dba14f5358644226f">provocative_sound</a> &amp;&amp; <a class="code" href="classmonster.html#aa58e9ab3e08e72fd37c757b761d2671c">is_wandering</a>() &amp;&amp; destination == here.<a class="code" href="classmap.html#a426c21f7244ff80a61685a89e9146fec">getlocal</a>( <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a> ) ) {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                }</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> estimate = here.<a class="code" href="classmap.html#a6c9fdb474119bafd75efa7c12e0bec1a">bash_rating</a>( <a class="code" href="classmonster.html#a22061ca6aa966283a748d84ce4352fb4">bash_estimate</a>(), candidate );</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                <span class="keywordflow">if</span>( estimate &lt;= 0 ) {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <span class="keywordflow">if</span>( estimate &lt; 5 ) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                    bad_choice = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> progress = distance_to_target - <a class="code" href="coordinates_8h.html#aafe19be6ce6f4788aa78a07a71807739">trig_dist</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">tripoint</a>( candidate.xy(),</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                   candidate.z + rampPos ), destination );</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            <span class="comment">// The x2 makes the first (and most direct) path twice as likely,</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <span class="comment">// since the chance of switching is 1/1, 1/4, 1/6, 1/8</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            switch_chance += progress * 2;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            <span class="comment">// Randomly pick one of the viable squares to move to weighted by distance.</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="keywordflow">if</span>( progress &gt; 0 &amp;&amp; ( !moved || <a class="code" href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a>( progress, switch_chance ) ) ) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                moved = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                next_step = candidate_abs;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                <span class="comment">// If we stumble, pick a random square, otherwise take the first one,</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                <span class="comment">// which is the most direct path.</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                <span class="comment">// Except if the direct path is bad, then check others</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                <span class="comment">// Or if the path is given by pathfinder</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                <span class="keywordflow">if</span>( !staggers &amp;&amp; ( !bad_choice || pathed ) ) {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="comment">// Finished logic section.  By this point, we should have chosen a square to</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="comment">//  move to (moved = true).</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">if</span>( moved ) { <span class="comment">// Actual effects of moving to the square we&#39;ve chosen</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> local_next_step = here.<a class="code" href="classmap.html#a426c21f7244ff80a61685a89e9146fec">getlocal</a>( next_step );</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> did_something =</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            ( !pacified &amp;&amp; <a class="code" href="classmonster.html#a32a4800fc20a7d229c66cce32ce9e417">attack_at</a>( local_next_step ) ) ||</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;            ( !pacified &amp;&amp; can_open_doors &amp;&amp;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;              here.<a class="code" href="classmap.html#a9ac1c68c3941554a86bff27bf1ce2389">open_door</a>( *<span class="keyword">this</span>, local_next_step, !here.<a class="code" href="classmap.html#a3bc75c8b706a54c1575b4460b2f363b1">is_outside</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) ) ) ||</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            ( !pacified &amp;&amp; <a class="code" href="classmonster.html#abfa82509ae31b5201072274dc6b9c407">bash_at</a>( local_next_step ) ) ||</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            ( !pacified &amp;&amp; <a class="code" href="classmonster.html#a1a829284017aa69618d25208a53061d1">push_to</a>( local_next_step, 0, 0 ) ) ||</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            <a class="code" href="classmonster.html#ab3c07bd4cb325287741fa2e561168e56">move_to</a>( local_next_step, <span class="keyword">false</span>, <span class="keyword">false</span>, <a class="code" href="monmove_8cpp.html#aa9166c53ef32fe65a5c624d530a0210c">get_stagger_adjust</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), destination, local_next_step ) );</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">if</span>( !did_something ) {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            <a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -<a class="code" href="classCreature.html#a261dff3caa6aabe255ae9d3eaa94d3de">get_speed</a>() ); <span class="comment">// If we don&#39;t do this, we&#39;ll get infinite loops.</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a> ) &amp;&amp; dragged_foe != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            <span class="keywordflow">if</span>( !dragged_foe-&gt;<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ae326c5e4da7f23bc429d04d215dd7c9d">effect_grabbed</a> ) ) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                dragged_foe = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                <a class="code" href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">remove_effect</a>( <a class="code" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a> );</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( drag_to != <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() &amp;&amp; creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( drag_to ) == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                dragged_foe-&gt;<a class="code" href="classCreature.html#a5e2f65bf9e0412193ebaaf60d02cc0cc">move_to</a>( drag_to );</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <a class="code" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> = 0;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <a class="code" href="classmonster.html#a6adba28c21a8b6e6cc1b81f2f31d1947">stumble</a>();</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.clear();</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    }</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ad5fa326832c0a774d6a775e605f27788">effect_led_by_leash</a> ) ) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>(), player_character.<a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>() ) &gt; 2 ) {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="comment">// Either failed to keep up with the player or moved away</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <a class="code" href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">remove_effect</a>( <a class="code" href="monmove_8cpp.html#ad5fa326832c0a774d6a775e605f27788">effect_led_by_leash</a> );</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;You lose hold of a leash.&quot;</span> ) );</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;}</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"><a class="line" href="classmonster.html#a16052a26adbecf002c5d502660ec7434"> 1334</a></span>&#160;<a class="code" href="classCharacter.html">Character</a> *<a class="code" href="classmonster.html#a16052a26adbecf002c5d502660ec7434">monster::find_dragged_foe</a>()</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;{</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="comment">// Make sure they&#39;re actually dragging someone.</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#ab00d759ebe29170bf2a166dd155bfeb2">dragged_foe_id</a>.<a class="code" href="classcharacter__id.html#a3951155d05523e839d50ea07a8e0b374">is_valid</a>() || !<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a> ) ) {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <a class="code" href="classmonster.html#ab00d759ebe29170bf2a166dd155bfeb2">dragged_foe_id</a> = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4abf21153f2489c6f52bf69def405456ad">character_id</a>();</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="comment">// Dragged critters may die or otherwise become invalid, which is why we look</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="comment">// them up each time. Luckily, monsters dragging critters is relatively rare,</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="comment">// so this check should happen infrequently.</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <a class="code" href="classCharacter.html">Character</a> *dragged_foe = <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;critter_by_id&lt;<a class="code" href="classCharacter.html">Character</a>&gt;( <a class="code" href="classmonster.html#ab00d759ebe29170bf2a166dd155bfeb2">dragged_foe_id</a> );</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordflow">if</span>( dragged_foe == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="comment">// Target no longer valid.</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <a class="code" href="classmonster.html#ab00d759ebe29170bf2a166dd155bfeb2">dragged_foe_id</a> = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4abf21153f2489c6f52bf69def405456ad">character_id</a>();</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <a class="code" href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">remove_effect</a>( <a class="code" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a> );</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordflow">return</span> dragged_foe;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;}</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">// Nursebot surgery code</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"><a class="line" href="classmonster.html#a3078e262a3a130efa9985bfa04a26bd8"> 1357</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#a3078e262a3a130efa9985bfa04a26bd8">monster::nursebot_operate</a>( <a class="code" href="classCharacter.html">Character</a> *dragged_foe )</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;{</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="comment">// No dragged foe, nothing to do.</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="keywordflow">if</span>( dragged_foe == <span class="keyword">nullptr</span> || !<a class="code" href="classmonster.html#a1bfdcc078e39c06a1cf7047803610204">has_dest</a>() ) {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="comment">// Nothing to do if they can&#39;t operate, or they don&#39;t think they&#39;re dragging.</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">if</span>( !( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a3782082ac316cac7f189d089b3b16000">has_special_attack</a>( <span class="stringliteral">&quot;OPERATE&quot;</span> ) &amp;&amp; <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a> ) ) ) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>(), <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() ) == 1 &amp;&amp;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        !here.<a class="code" href="classmap.html#a09ef3e8c2e6664e3ed98d1e1e18a4b4f">has_flag_furn</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a5b189c7326ca1246de45a1579b907d5e">ter_furn_flag::TFLAG_AUTODOC_COUCH</a>, here.<a class="code" href="classmap.html#a426c21f7244ff80a61685a89e9146fec">getlocal</a>( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() ) ) &amp;&amp;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        !<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ab8dd6142a7131d3af944e532002ac9e3">effect_operating</a> ) ) {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <span class="keywordflow">if</span>( dragged_foe-&gt;<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ae326c5e4da7f23bc429d04d215dd7c9d">effect_grabbed</a> ) &amp;&amp; !<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a8bbfe91713ddfaa4c647fa68f9734e34">effect_countdown</a> ) &amp;&amp;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            ( creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() ) == <span class="keyword">nullptr</span> ||</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;              creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() ) == dragged_foe ) ) {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %1$s slowly but firmly puts %2$s down onto the Autodoc couch.&quot;</span> ), <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(),</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                     dragged_foe-&gt;<a class="code" href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">disp_name</a>() );</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            dragged_foe-&gt;<a class="code" href="classCreature.html#a5e2f65bf9e0412193ebaaf60d02cc0cc">move_to</a>( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() );</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            <span class="comment">// There&#39;s still time to get away</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            <a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#a8bbfe91713ddfaa4c647fa68f9734e34">effect_countdown</a>, 2_turns );</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %s produces a syringe full of some translucent liquid.&quot;</span> ), <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() ) != <span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a> ) ) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            <a class="code" href="namespacesounds.html#a6bb79ae1c9c3dcd8c8e0b28c66b0398d">sounds::sound</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 8, <a class="code" href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3ab761780ade49c11f48702cf2b0e3b0cd">sounds::sound_t::electronic_speech</a>,</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                           <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>(</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                               <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;a soft robotic voice say, \&quot;Please step away from the Autodoc, this patient needs immediate care.\&quot;&quot;</span> ) ) );</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            <span class="comment">// TODO: Make it able to push NPC/player</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            <a class="code" href="classmonster.html#a1a829284017aa69618d25208a53061d1">push_to</a>( here.<a class="code" href="classmap.html#a426c21f7244ff80a61685a89e9146fec">getlocal</a>( <a class="code" href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">get_dest</a>() ), 4, 0 );</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        }</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a1ba25d990e8532dd2b0331bfc6cc694c">get_effect_dur</a>( <a class="code" href="monmove_8cpp.html#a8bbfe91713ddfaa4c647fa68f9734e34">effect_countdown</a> ) == 1_turns &amp;&amp; !<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ab8dd6142a7131d3af944e532002ac9e3">effect_operating</a> ) ) {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <span class="keywordflow">if</span>( dragged_foe-&gt;<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ae326c5e4da7f23bc429d04d215dd7c9d">effect_grabbed</a> ) ) {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <span class="keyword">const</span> <a class="code" href="classbionic__collection.html">bionic_collection</a> &amp;collec = *dragged_foe-&gt;<a class="code" href="classCharacter.html#a388bca3ef975bd265c67df45bb280bee">my_bionics</a>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( !collec.empty() );</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> index = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, collec.size() - 1 );</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="keyword">const</span> <a class="code" href="structbionic.html">bionic</a> *<span class="keyword">const</span> target_cbm = &amp;collec[index];</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            <span class="keyword">const</span> <a class="code" href="structbionic.html">bionic</a> &amp;real_target =</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                target_cbm-&gt;<a class="code" href="structbionic.html#ad3b2c3960fdbb6492918ecc8f911e0dd">is_included</a>()</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                ? **dragged_foe-&gt;<a class="code" href="classCharacter.html#af0e2967a36e27b1bb3774cf0eeb51c72">find_bionic_by_uid</a>( target_cbm-&gt;<a class="code" href="structbionic.html#a9255cc84ea78c25ee01fe4aff4de1624">get_parent_uid</a>() )</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                : *target_cbm;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            <span class="comment">//8 intelligence*4 + 8 first aid*4 + 3 computer *3 + 4 electronic*1 = 77</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> adjusted_skill = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( 77 ) - <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( 40 ),</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                                         <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( 77 ) - <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( 77 ) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( 10.0 ) );</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            dragged_foe-&gt;<a class="code" href="classCharacter.html#a597968eba450c923b56a1c9cac1676dc">cancel_activity</a>();</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCharacter.html#a6091baffbbf96adb27c6ab844960b1ff">uninstall_bionic</a>( real_target, *<span class="keyword">this</span>, *dragged_foe, adjusted_skill );</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            <span class="comment">// Remove target grab</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classeffect.html">effect</a> &amp;eff : dragged_foe-&gt;<a class="code" href="classCreature.html#a952f5a3103775159e193c6ee4e60979b">get_effects_with_flag</a>( <a class="code" href="monmove_8cpp.html#ab41f4e77a586e85f347f7151266b9dd5">json_flag_GRAB</a> ) ) {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                dragged_foe-&gt;<a class="code" href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">remove_effect</a>( eff.get_id() );</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            <span class="comment">// And our own grab filters</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classeffect.html">effect</a> &amp;eff : <a class="code" href="classCreature.html#a952f5a3103775159e193c6ee4e60979b">get_effects_with_flag</a>( <a class="code" href="monmove_8cpp.html#a2724a97ce27ac9050939a55314eab590">json_flag_GRAB_FILTER</a> ) ) {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                <a class="code" href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">remove_effect</a>( eff.get_id() );</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            }</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            <a class="code" href="classmonster.html#ab00d759ebe29170bf2a166dd155bfeb2">dragged_foe_id</a> = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4abf21153f2489c6f52bf69def405456ad">character_id</a>();</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        }</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;}</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">// footsteps will determine how loud a monster&#39;s normal movement is</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">// and create a sound in the monsters location when they move</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"><a class="line" href="classmonster.html#ab7f8b49829445e6663e273473841fc22"> 1428</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#ab7f8b49829445e6663e273473841fc22">monster::footsteps</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;{</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#ab0adc4673278e497b75a357040ce2739">made_footstep</a> ) {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <a class="code" href="classmonster.html#ab0adc4673278e497b75a357040ce2739">made_footstep</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> = 6; <span class="comment">// same as player&#39;s footsteps</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() || <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a066bf1be1c6f12b73b46b54dc2c6f40e">mon_flag_SILENTMOVES</a> ) ) {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> = 0;    <span class="comment">// Flying monsters don&#39;t have footsteps!</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#af705eea6e40e12d7866010955602c7b5">digging</a>() ) {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> = 10;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> ) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a>:</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> = 0; <span class="comment">// No sound for the tinies</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aeb5c1399a871211c7e7ed732d15e3a8b">creature_size::small</a>:</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> /= 3;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2a075a3e36a0a52dcbc568c05788e8a713">creature_size::medium</a>:</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aafacdb0a401ccdf6b48551bbc00e8a74">creature_size::large</a>:</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> *= 1.5;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ab7cf27ffe6ea83cdcf8af2ef29de9285">creature_size::huge</a>:</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> *= 2;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a83712a1bfc3dafbb500ba844673a59d8">mon_flag_LOUDMOVES</a> ) ) {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> += 6;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#ab219f3ef959738c3d9f76ab5bfea8f50">mon_flag_QUIETMOVES</a> ) ) {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> -= 3;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a> == 0 ) {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    }</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordtype">int</span> dist = <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( p, <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <a class="code" href="namespacesounds.html#a2cf6eebd3df3764f7004be69b364e930">sounds::add_footstep</a>( p, <a class="code" href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">volume</a>, dist, <span class="keyword">this</span>, <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a3e59522bca2f998bb482d4629f3f18d4">get_footsteps</a>() );</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;}</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"><a class="line" href="classmonster.html#ace81cf5d7ddd0385d3cf2e66d4c47ff7"> 1475</a></span>&#160;<a class="code" href="structtripoint.html">tripoint</a> <a class="code" href="classmonster.html#ace81cf5d7ddd0385d3cf2e66d4c47ff7">monster::scent_move</a>()</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;{</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="comment">// TODO: Remove when scentmap is 3D</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() - <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().get_abs_sub().z() ) &gt; <a class="code" href="scent__map_8h.html#ae37b6acaf47b352000fac854f116c126">SCENT_MAP_Z_REACH</a> ) {</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">return</span> { -1, -1, INT_MIN };</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <a class="code" href="classscent__map.html">scent_map</a> &amp;scents = <a class="code" href="game_8cpp.html#afee362892b161716a3fc614b030a877d">get_scent</a>();</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordtype">bool</span> in_range = scents.<a class="code" href="classscent__map.html#af8194e788fb41147bd4c95dbf09b95fb">inbounds</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">if</span>( !in_range ) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        <span class="keywordflow">return</span> { -1, -1, INT_MIN };</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    }</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="keyword">const</span> std::set&lt;scenttype_id&gt; &amp;tracked_scents = <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a42b480d35fc4dc0428223b76a41c3ecf">scents_tracked</a>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keyword">const</span> std::set&lt;scenttype_id&gt; &amp;ignored_scents = <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a30acba3bb0f18e38d564fe72b7e34f8b">scents_ignored</a>;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    std::vector&lt;tripoint&gt; sdirection;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    std::vector&lt;tripoint&gt; smoves;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordtype">int</span> bestsmell = 10; <span class="comment">// Squares with smell 0 are not eligible targets.</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="keywordtype">int</span> smell_threshold = 200; <span class="comment">// Squares at or above this level are ineligible.</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#aaacb1b1721666f5ed2282384e9a27d77">mon_flag_KEENNOSE</a> ) ) {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        bestsmell = 1;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        smell_threshold = 400;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;player_character = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> fleeing = <a class="code" href="classmonster.html#a0f5047243bc2dc00f32c39b5d0918002">is_fleeing</a>( player_character );</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordtype">int</span> scent_here = scents.<a class="code" href="classscent__map.html#a55c51947e481f387010888565ec7ba7c">get_unsafe</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">if</span>( fleeing ) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        bestsmell = scent_here;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> next( -1, -1, <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() );</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="comment">// Scent is too weak, can&#39;t follow it.</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">if</span>( scent_here == 0 ) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keywordflow">return</span> next;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    }</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">// Check for the scent type being compatible.</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="keyword">const</span> <a class="code" href="classstring__id.html">scenttype_id</a> &amp;type_scent = scents.<a class="code" href="classscent__map.html#a781c9a7c953f40d3027c3e3a36446ff3">get_type</a>();</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordtype">bool</span> right_scent = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">// is the monster tracking this scent</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span>( !tracked_scents.empty() ) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        right_scent = tracked_scents.find( type_scent ) != tracked_scents.end();</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">//is this scent recognised by the monster species</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="keywordflow">if</span>( !type_scent.<a class="code" href="classstring__id.html#ac180a60056901aaf79f5c4b728a257bd">is_empty</a>() ) {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <span class="keyword">const</span> std::set&lt;species_id&gt; &amp;receptive_species = type_scent-&gt;<a class="code" href="classscent__type.html#aa9c81f6208c954f5264ff20e48d4082a">receptive_species</a>;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="keyword">const</span> std::set&lt;species_id&gt; &amp;monster_species = <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#ad2d6c0780216ad8a2999bc4e7ec7822c">species</a>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        std::vector&lt;species_id&gt; v_intersection;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        std::set_intersection( receptive_species.begin(), receptive_species.end(), monster_species.begin(),</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                               monster_species.end(), std::back_inserter( v_intersection ) );</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="keywordflow">if</span>( !v_intersection.empty() ) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            right_scent = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    }</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="comment">// is the monster actually ignoring this scent</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="keywordflow">if</span>( !ignored_scents.empty() &amp;&amp; ( ignored_scents.find( type_scent ) != ignored_scents.end() ) ) {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        right_scent = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">if</span>( !right_scent ) {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <span class="keywordflow">return</span> { -1, -1, INT_MIN };</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> can_bash = <a class="code" href="classmonster.html#a7410372f55ca62ae5eda0fcc63b48622">bash_skill</a>() &gt; 0;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keywordflow">if</span>( !fleeing &amp;&amp; scent_here &gt; smell_threshold ) {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="comment">// Smell too strong to track, wander around</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        sdirection.push_back( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        <span class="comment">// Get direction of scent</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;dest : here.<a class="code" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 1, <a class="code" href="scent__map_8h.html#ae37b6acaf47b352000fac854f116c126">SCENT_MAP_Z_REACH</a> ) ) {</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            <span class="keywordtype">int</span> smell = scents.<a class="code" href="classscent__map.html#a99aff3e6d8963d7f34618216a8448c8c">get</a>( dest );</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; </div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            <span class="keywordflow">if</span>( ( !fleeing &amp;&amp; smell &lt; bestsmell ) || ( fleeing &amp;&amp; smell &gt; bestsmell ) ) {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            <span class="keywordflow">if</span>( ( !fleeing &amp;&amp; smell &gt; bestsmell ) || ( fleeing &amp;&amp; smell &lt; bestsmell ) ) {</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                sdirection.clear();</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                sdirection.push_back( dest );</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                bestsmell = smell;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( !fleeing &amp;&amp; smell == bestsmell ) || ( fleeing &amp;&amp; smell == bestsmell ) ) {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                sdirection.push_back( dest );</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            }</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; </div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> : sdirection ) {</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="comment">// Add some randomness to make creatures zigzag towards the source</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;dest : here.<a class="code" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a>, 1 ) ) {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a3188771064ca49d4798c6a80bfad0fcd">valid_move</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), dest, can_bash, <span class="keyword">true</span> ) &amp;&amp;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                ( <a class="code" href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">can_move_to</a>( dest ) || ( dest == player_character.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) ||</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                  ( can_bash &amp;&amp; here.<a class="code" href="classmap.html#a6c9fdb474119bafd75efa7c12e0bec1a">bash_rating</a>( <a class="code" href="classmonster.html#a22061ca6aa966283a748d84ce4352fb4">bash_estimate</a>(), dest ) &gt; 0 ) ) ) {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                smoves.push_back( dest );</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rng_8h.html#a12244355ee77108f1b08618e9962e4d1">random_entry</a>( smoves, next );</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;}</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; </div>
<div class="line"><a name="l01575"></a><span class="lineno"><a class="line" href="classmonster.html#a98cfa6c825f373b60a0a4021a8dbf750"> 1575</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmonster.html#a98cfa6c825f373b60a0a4021a8dbf750">monster::calc_movecost</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;f, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;t )<span class="keyword"> const</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordtype">int</span> movecost = 0;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> source_cost = here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( f );</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> dest_cost = here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( t );</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="comment">// Digging and flying monsters ignore terrain cost</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() || ( <a class="code" href="classmonster.html#af705eea6e40e12d7866010955602c7b5">digging</a>() &amp;&amp; here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054aaebe86ebda0571101f8d02ab5f2a888c">ter_furn_flag::TFLAG_DIGGABLE</a>, t ) ) ) {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        movecost = 100;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="comment">// Swimming monsters move super fast in water</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a4be04fecf05b13bc290b5b1dcc6b9137">swims</a>() ) {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, f ) ) {</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            movecost += 25;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            movecost += 50 * here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( f );</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, t ) ) {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            movecost += 25;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            movecost += 50 * here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( t );</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a55fd0614c264b7e89a5735270ff6d2c7">can_submerge</a>() ) {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        <span class="comment">// No-breathe monsters have to walk underwater slowly</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, f ) ) {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            movecost += 250;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            movecost += 50 * here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( f );</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, t ) ) {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            movecost += 250;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            movecost += 50 * here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( t );</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        movecost /= 2;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#ab9288bd726bcf264e3626dfbb7a01e25">climbs</a>() ) {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac0ec7541a0f28e104d9c691936512481">ter_furn_flag::TFLAG_CLIMBABLE</a>, f ) ) {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            movecost += 150;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            movecost += 50 * here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( f );</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac0ec7541a0f28e104d9c691936512481">ter_furn_flag::TFLAG_CLIMBABLE</a>, t ) ) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            movecost += 150;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            movecost += 50 * here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( t );</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        movecost /= 2;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        movecost = ( ( 50 * source_cost ) + ( 50 * dest_cost ) ) / 2.0;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordflow">return</span> movecost;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;}</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"><a class="line" href="classmonster.html#ab370bb6801a47533c44b28894f910702"> 1629</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmonster.html#ab370bb6801a47533c44b28894f910702">monster::calc_climb_cost</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;f, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;t )<span class="keyword"> const</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() ) {</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        <span class="keywordflow">return</span> 100;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160; </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#ab9288bd726bcf264e3626dfbb7a01e25">climbs</a>() &amp;&amp; !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054af607730a38ff7975c6724b22881e0e58">ter_furn_flag::TFLAG_NO_FLOOR</a>, t ) ) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> diff = here.<a class="code" href="classmap.html#aa0e6e89f8f4989c540fefe7bbacfd8ce">climb_difficulty</a>( f );</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keywordflow">if</span>( diff &lt;= 10 ) {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            <span class="keywordflow">return</span> 150;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160; </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;}</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment"> * Return points of an area extending 1 tile to either side and</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment"> * (maxdepth) tiles behind basher.</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#ae931fdf83b37ff0d7c8bfd3096fa0b73"> 1650</a></span>&#160;<span class="keyword">static</span> std::vector&lt;tripoint&gt; <a class="code" href="monmove_8cpp.html#ae931fdf83b37ff0d7c8bfd3096fa0b73">get_bashing_zone</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;bashee, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;basher,</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        <span class="keywordtype">int</span> maxdepth )</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;{</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    std::vector&lt;tripoint&gt; <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a>;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a>.push_back( bashee );</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a>.push_back( basher );</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="comment">// Draw a line from the target through the attacker.</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    std::vector&lt;tripoint&gt; path = <a class="code" href="line_8cpp.html#a2bd46cad079efd79854dffc0b97ce94b">continue_line</a>( <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a>, maxdepth );</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">// Remove the target.</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    path.insert( path.begin(), basher );</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    std::vector&lt;tripoint&gt; zone;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">// Go ahead and reserve enough room for all the points since</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="comment">// we know how many it will be.</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    zone.reserve( 3 * maxdepth );</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> previous = bashee;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p : path ) {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        std::vector&lt;point&gt; swath = <a class="code" href="line_8cpp.html#adb1b43fd955b85e0728419840af8a90a">squares_in_direction</a>( previous.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>(), p.xy() );</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;q : swath ) {</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            zone.emplace_back( q, bashee.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> );</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        previous = p;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">return</span> zone;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;}</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"><a class="line" href="classmonster.html#abfa82509ae31b5201072274dc6b9c407"> 1676</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#abfa82509ae31b5201072274dc6b9c407">monster::bash_at</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;{</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordflow">if</span>( p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> != <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() ) {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        <span class="comment">// TODO: Remove this</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="comment">//Hallucinations can&#39;t bash stuff.</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160; </div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="comment">// Don&#39;t bash if a friendly monster is standing there</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <a class="code" href="classmonster.html">monster</a> *target = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classmonster.html">monster</a>&gt;( p );</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">if</span>( target != <span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="classmonster.html#a125622587c2069dc4dbbe07943c81336">attitude_to</a>( *target ) == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Attitude::FRIENDLY</a> ) {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="keywordtype">bool</span> try_bash = !<a class="code" href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">can_move_to</a>( p ) || <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 3 );</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="keywordflow">if</span>( !try_bash ) {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a7410372f55ca62ae5eda0fcc63b48622">bash_skill</a>() &lt;= 0 ) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    }</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; </div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">if</span>( !( here.<a class="code" href="classmap.html#a61c8a24a2bbd44540d799602f0c49c7e">is_bashable_furn</a>( p ) || here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( p ).<a class="code" href="classoptional__vpart__position.html#a01c74b1b54254d2948d47b234ba675b2">obstacle_at_part</a>() ) ) {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="comment">// if the only thing here is road or flat, rarely bash it</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keywordtype">bool</span> flat_ground = here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a097fb4a94381fa8dfe878074bc7244de">ter_furn_flag::TFLAG_ROAD</a>, p ) ||</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                           here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a30e2c1c17c8b07188b9c4cbb80fbdf65">ter_furn_flag::TFLAG_FLAT</a>, p );</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a354aefad19d6e0086aa6160a1f45bb1d">is_bashable_ter</a>( p ) || ( flat_ground &amp;&amp; !<a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 50 ) ) ) {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordtype">int</span> bashskill = <a class="code" href="classmonster.html#a3552d13d872776e2201892e3f6480742">group_bash_skill</a>( p );</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    here.<a class="code" href="classmap.html#aaa8d85d40512cf240c55a050d8952c2f">bash</a>( p, bashskill );</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -<a class="code" href="classCreature.html#a261dff3caa6aabe255ae9d3eaa94d3de">get_speed</a>() );</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;}</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"><a class="line" href="classmonster.html#a22061ca6aa966283a748d84ce4352fb4"> 1719</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmonster.html#a22061ca6aa966283a748d84ce4352fb4">monster::bash_estimate</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="keywordtype">int</span> estimate = <a class="code" href="classmonster.html#a7410372f55ca62ae5eda0fcc63b48622">bash_skill</a>();</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a71cf2330cd9d412b2d82728c88b1fad0">mon_flag_GROUP_BASH</a> ) ) {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="comment">// Right now just give them a boost so they try to bash a lot of stuff.</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="comment">// TODO: base it on number of nearby friendlies.</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        estimate *= 2;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordflow">return</span> estimate;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;}</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"><a class="line" href="classmonster.html#a7410372f55ca62ae5eda0fcc63b48622"> 1730</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmonster.html#a7410372f55ca62ae5eda0fcc63b48622">monster::bash_skill</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#acd6bef5de9f343c6677cc8ae2b48e6fe">bash_skill</a>;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;}</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160; </div>
<div class="line"><a name="l01735"></a><span class="lineno"><a class="line" href="classmonster.html#a3552d13d872776e2201892e3f6480742"> 1735</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmonster.html#a3552d13d872776e2201892e3f6480742">monster::group_bash_skill</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target )</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;{</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a71cf2330cd9d412b2d82728c88b1fad0">mon_flag_GROUP_BASH</a> ) ) {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a7410372f55ca62ae5eda0fcc63b48622">bash_skill</a>();</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordtype">int</span> bashskill = 0;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">// pileup = more bash skill, but only help bashing mob directly in front of target</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> max_helper_depth = 5;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keyword">const</span> std::vector&lt;tripoint&gt; bzone = <a class="code" href="monmove_8cpp.html#ae931fdf83b37ff0d7c8bfd3096fa0b73">get_bashing_zone</a>( target, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), max_helper_depth );</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;candidate : bzone ) {</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="comment">// Drawing this line backwards excludes the target and includes the candidate.</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        std::vector&lt;tripoint&gt; path_to_target = <a class="code" href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a>( target, candidate, 0, 0 );</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <span class="keywordtype">bool</span> connected = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <a class="code" href="classmonster.html">monster</a> *mon = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;in_path : path_to_target ) {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            <span class="comment">// If any point in the line from zombie to target is not a cooperating zombie,</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            <span class="comment">// it can&#39;t contribute.</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            mon = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classmonster.html">monster</a>&gt;( in_path );</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;            <span class="keywordflow">if</span>( !mon ) {</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                connected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;            }</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;            <a class="code" href="classmonster.html">monster</a> &amp;helpermon = *mon;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            <span class="keywordflow">if</span>( !helpermon.<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a71cf2330cd9d412b2d82728c88b1fad0">mon_flag_GROUP_BASH</a> ) || helpermon.<a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                connected = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="keywordflow">if</span>( !connected || !mon ) {</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        <span class="comment">// If we made it here, the last monster checked was the candidate.</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        <a class="code" href="classmonster.html">monster</a> &amp;helpermon = *mon;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="comment">// Contribution falls off rapidly with distance from target.</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        bashskill += helpermon.<a class="code" href="classmonster.html#a7410372f55ca62ae5eda0fcc63b48622">bash_skill</a>() / <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( candidate, target );</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">return</span> bashskill;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;}</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"><a class="line" href="classmonster.html#a32a4800fc20a7d229c66cce32ce9e417"> 1778</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a32a4800fc20a7d229c66cce32ce9e417">monster::attack_at</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;{</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a22a63e16b805987f8321bb4ff63f0273">mon_flag_PACIFIST</a> ) ) {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;player_character = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> sees_player = <a class="code" href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">sees</a>( player_character );</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="comment">// Targeting player location</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="keywordflow">if</span>( p == player_character.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) {</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="keywordflow">if</span>( sees_player ) {</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a712aeab26697f5ede4eab4eacdc71c8a">melee_attack</a>( player_character );</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <span class="comment">// Creature stumbles into a player it cannot see, briefly becoming aware of their location</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classCreature.html#a6410520bceb652ba361502f404fc1005">stumble_invis</a>( player_character );</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        }</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html">monster</a> *mon_ = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classmonster.html">monster</a>&gt;( p, <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) ) {</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <a class="code" href="classmonster.html">monster</a> &amp;mon = *mon_;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        <span class="comment">// Don&#39;t attack yourself.</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        <span class="keywordflow">if</span>( &amp;mon == <span class="keyword">this</span> ) {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        <span class="comment">// With no melee dice, we can&#39;t attack, but we had to process until here</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="comment">// because hallucinations require no melee dice to destroy.</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a561d4830d7f7c613c177f5880c2e15fb">melee_dice</a> &lt;= 0 ) {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217">Creature::Attitude</a> <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a> = <a class="code" href="classmonster.html#a125622587c2069dc4dbbe07943c81336">attitude_to</a>( mon );</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        <span class="comment">// mon_flag_ATTACKMON == hulk behavior, whack everything in your way</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a> == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Attitude::HOSTILE</a> || <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a28012e7b03f25df53cd371150ad24916">mon_flag_ATTACKMON</a> ) ) {</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a712aeab26697f5ede4eab4eacdc71c8a">melee_attack</a>( mon );</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160; </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    }</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <a class="code" href="classnpc.html">npc</a> *<span class="keyword">const</span> guy = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classnpc.html">npc</a>&gt;( p, <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() );</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">if</span>( guy &amp;&amp; <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a561d4830d7f7c613c177f5880c2e15fb">melee_dice</a> &gt; 0 ) {</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        <span class="comment">// For now we&#39;re always attacking NPCs that are getting into our</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <span class="comment">// way. This is consistent with how it worked previously, but</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        <span class="comment">// later on not hitting allied NPCs would be cool.</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        guy-&gt;<a class="code" href="classnpc.html#a965eb2beb1c490bb1b8efef1c07e20d0">on_attacked</a>( *<span class="keyword">this</span> ); <span class="comment">// allow NPC hallucination to be one shot by monsters</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classmonster.html#a712aeab26697f5ede4eab4eacdc71c8a">melee_attack</a>( *guy );</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160; </div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="comment">// Attack last known position despite empty</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#ad6fd62a9ed571c6bf17d577118be3c5a">effect_stumbled_into_invisible</a> ) &amp;&amp;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().has_field_at( p, <a class="code" href="monmove_8cpp.html#a31e2ef0b23e31f445746b9eaabbeb600">field_fd_last_known</a> ) &amp;&amp; !sees_player &amp;&amp;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        <a class="code" href="classmonster.html#a125622587c2069dc4dbbe07943c81336">attitude_to</a>( player_character ) == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Attitude::HOSTILE</a> ) {</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classCreature.html#a3e322a5b9e8f42f840ddffa01ec2787f">attack_air</a>( p );</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="comment">// Nothing to attack.</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;}</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"><a class="line" href="monmove_8cpp.html#a8d60c9f8582084603277543346b965c2"> 1840</a></span>&#160;<span class="keyword">static</span> <a class="code" href="structtripoint.html">tripoint</a> <a class="code" href="monmove_8cpp.html#a8d60c9f8582084603277543346b965c2">find_closest_stair</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;near_this, <span class="keyword">const</span> <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054">ter_furn_flag</a> stair_type )</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;{</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;candidate : <a class="code" href="coordinates_8h.html#a560abf1cd341e88e2f13f454ec2ecc99">closest_points_first</a>( near_this, 10 ) ) {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( stair_type, candidate ) ) {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            <span class="keywordflow">return</span> candidate;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        }</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    }</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">// we didn&#39;t find it</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordflow">return</span> near_this;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;}</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; </div>
<div class="line"><a name="l01852"></a><span class="lineno"><a class="line" href="classmonster.html#ab3c07bd4cb325287741fa2e561168e56"> 1852</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#ab3c07bd4cb325287741fa2e561168e56">monster::move_to</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keywordtype">bool</span> <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a>, <span class="keywordtype">bool</span> step_on_critter,</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">float</span> stagger_adjustment )</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;{</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> on_ground = !<a class="code" href="classmonster.html#af705eea6e40e12d7866010955602c7b5">digging</a>() &amp;&amp; !<a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>();</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160; </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> z_move = p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> != <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a>;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> going_up = p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> &gt; <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a>;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> destination = p;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="comment">// This is stair teleportation hackery.</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="comment">// TODO: Remove this in favor of stair alignment</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <span class="keywordflow">if</span>( going_up ) {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a589ce1673849a76ea3bf17df3fe84ab3">ter_furn_flag::TFLAG_GOES_UP</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) ) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            destination = <a class="code" href="monmove_8cpp.html#a8d60c9f8582084603277543346b965c2">find_closest_stair</a>( p, <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ab09f2463f4ce060d051439b5535a47e6">ter_furn_flag::TFLAG_GOES_DOWN</a> );</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( z_move ) {</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ab09f2463f4ce060d051439b5535a47e6">ter_furn_flag::TFLAG_GOES_DOWN</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) ) {</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;            destination = <a class="code" href="monmove_8cpp.html#a8d60c9f8582084603277543346b965c2">find_closest_stair</a>( p, <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a589ce1673849a76ea3bf17df3fe84ab3">ter_furn_flag::TFLAG_GOES_UP</a> );</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    }</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; </div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( p ).<a class="code" href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">part_with_feature</a>( <a class="code" href="veh__type_8h.html#aa3ff66a8c100c3deb40dfa70f1eb307ea563fb2626cff0acc6c8273fef3e3a8d0">VPFLAG_CARGO</a>, <span class="keyword">true</span> ) &amp;&amp; !<a class="code" href="classmonster.html#a04e580433cf344a504468495ba2d1ee3">monster_move_in_vehicle</a>( p ) ) {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    }</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="comment">// Allows climbing monsters to move on terrain with movecost &lt;= 0</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <a class="code" href="classCreature.html">Creature</a> *critter = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( destination, <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() );</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac0ec7541a0f28e104d9c691936512481">ter_furn_flag::TFLAG_CLIMBABLE</a>, destination ) ) {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">impassable</a>( destination ) &amp;&amp; critter == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() ) {</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                <a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -<a class="code" href="classCreature.html#a261dff3caa6aabe255ae9d3eaa94d3de">get_speed</a>() );</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                <span class="keywordflow">if</span>( get_option&lt;bool&gt;( <span class="stringliteral">&quot;LOG_MONSTER_MOVEMENT&quot;</span> ) ) {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                    <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( *<span class="keyword">this</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %1$s flies over the %2$s.&quot;</span> ), <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(),</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                                            here.<a class="code" href="classmap.html#a09ef3e8c2e6664e3ed98d1e1e18a4b4f">has_flag_furn</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac0ec7541a0f28e104d9c691936512481">ter_furn_flag::TFLAG_CLIMBABLE</a>, p ) ? here.<a class="code" href="classmap.html#a20933e73f539d62c2a10bed22bb9a0c7">furnname</a>( p ) :</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                                            here.<a class="code" href="classmap.html#a51e32639c8df0c90e0743f929bcf2111">tername</a>( p ) );</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                }</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#ab9288bd726bcf264e3626dfbb7a01e25">climbs</a>() ) {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                <a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -<a class="code" href="classCreature.html#a261dff3caa6aabe255ae9d3eaa94d3de">get_speed</a>() * 1.5 );</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                <span class="keywordflow">if</span>( get_option&lt;bool&gt;( <span class="stringliteral">&quot;LOG_MONSTER_MOVEMENT&quot;</span> ) ) {</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                    <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( *<span class="keyword">this</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %1$s climbs over the %2$s.&quot;</span> ), <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(),</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                                            here.<a class="code" href="classmap.html#a09ef3e8c2e6664e3ed98d1e1e18a4b4f">has_flag_furn</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac0ec7541a0f28e104d9c691936512481">ter_furn_flag::TFLAG_CLIMBABLE</a>, p ) ? here.<a class="code" href="classmap.html#a20933e73f539d62c2a10bed22bb9a0c7">furnname</a>( p ) :</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                                            here.<a class="code" href="classmap.html#a51e32639c8df0c90e0743f929bcf2111">tername</a>( p ) );</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                }</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;            }</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        }</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">if</span>( critter != <span class="keyword">nullptr</span> &amp;&amp; !step_on_critter ) {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    }</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160; </div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="comment">// Make sure that we can move there, unless force is true.</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> &amp;&amp; !<a class="code" href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">can_move_to</a>( destination ) ) {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    }</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160; </div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> ) {</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        <span class="comment">// This adjustment is to make it so that monster movement speed relative to the player</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        <span class="comment">// is consistent even if the monster stumbles,</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        <span class="comment">// and the same regardless of the distance measurement mode.</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        <span class="comment">// Note: Keep this as float here or else it will cancel valid moves</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> cost = stagger_adjustment *</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                           <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classmonster.html#ab9288bd726bcf264e3626dfbb7a01e25">climbs</a>() &amp;&amp;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                                               here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054af607730a38ff7975c6724b22881e0e58">ter_furn_flag::TFLAG_NO_FLOOR</a>, p ) ? <a class="code" href="classmonster.html#ab370bb6801a47533c44b28894f910702">calc_climb_cost</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(),</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                                                       destination ) : <a class="code" href="classmonster.html#a98cfa6c825f373b60a0a4021a8dbf750">calc_movecost</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(),</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                                                               destination ) );</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="keywordflow">if</span>( cost &gt; 0.0f ) {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            <a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#ac9196b0cf8d9dd209db9fc00a69a55f6">std::ceil</a>( cost ) ) );</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        }</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    }</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; </div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="comment">//Check for moving into/out of water</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keywordtype">bool</span> was_water = <a class="code" href="classCreature.html#a0a561860988a2692df47476d9a15511e">underwater</a>;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="keywordtype">bool</span> will_be_water =</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        on_ground &amp;&amp; (</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            <span class="comment">// AQUATIC monsters always &quot;swim under&quot; the vehicles, while other swimming monsters are forced to surface</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a10899530fa212da51fd92b98b0cacdb5">mon_flag_AQUATIC</a> ) || ( <a class="code" href="classmonster.html#a55fd0614c264b7e89a5735270ff6d2c7">can_submerge</a>() &amp;&amp; !here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( destination ) )</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        ) &amp;&amp; here.<a class="code" href="classmap.html#ab687d9988b59167571f5476882b24206">is_divable</a>( destination );</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">if</span>( get_option&lt;bool&gt;( <span class="stringliteral">&quot;LOG_MONSTER_MOVEMENT&quot;</span> ) ) {</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="comment">//Birds and other flying creatures flying over the deep water terrain</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="keywordflow">if</span>( was_water &amp;&amp; <a class="code" href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">flies</a>() ) {</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 4 ) ) {</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( *<span class="keyword">this</span>, <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;A %1$s flies over the %2$s!&quot;</span> ),</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                                        <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(), here.<a class="code" href="classmap.html#a51e32639c8df0c90e0743f929bcf2111">tername</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) );</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            }</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( was_water &amp;&amp; !will_be_water ) {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            <span class="comment">// Use more dramatic messages for swimming monsters</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( *<span class="keyword">this</span>, <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a>,</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                                    <span class="comment">//~ Message when a monster emerges from water</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                                    <span class="comment">//~ %1$s: monster name, %2$s: leaps/emerges, %3$s: terrain name</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                                    <a class="code" href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a>( <span class="stringliteral">&quot;monster movement&quot;</span>, <span class="stringliteral">&quot;A %1$s %2$s from the %3$s!&quot;</span> ),</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                                    <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(), <a class="code" href="classmonster.html#a4be04fecf05b13bc290b5b1dcc6b9137">swims</a>() ||</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                                    <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a10899530fa212da51fd92b98b0cacdb5">mon_flag_AQUATIC</a> ) ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;leaps&quot;</span> ) : <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;emerges&quot;</span> ), here.<a class="code" href="classmap.html#a51e32639c8df0c90e0743f929bcf2111">tername</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) );</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !was_water &amp;&amp; will_be_water ) {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( *<span class="keyword">this</span>, <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a>, <a class="code" href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a>( <span class="stringliteral">&quot;monster movement&quot;</span>,</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                                    <span class="comment">//~ Message when a monster enters water</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                                    <span class="comment">//~ %1$s: monster name, %2$s: dives/sinks, %3$s: terrain name</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                                    <span class="stringliteral">&quot;A %1$s %2$s into the %3$s!&quot;</span> ),</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                                    <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(), <a class="code" href="classmonster.html#a4be04fecf05b13bc290b5b1dcc6b9137">swims</a>() ||</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                                    <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a10899530fa212da51fd92b98b0cacdb5">mon_flag_AQUATIC</a> ) ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;dives&quot;</span> ) : <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;sinks&quot;</span> ), here.<a class="code" href="classmap.html#a51e32639c8df0c90e0743f929bcf2111">tername</a>( destination ) );</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        }</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <a class="code" href="classoptional__vpart__position.html">optional_vpart_position</a> vp_orig = here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">if</span>( vp_orig ) {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        vp_orig-&gt;vehicle().invalidate_mass();</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    }</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; </div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <a class="code" href="classCreature.html#ac16dcdb688f6f47c594c98c83528a670">setpos</a>( destination );</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <a class="code" href="classmonster.html#ab7f8b49829445e6663e273473841fc22">footsteps</a>( destination );</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <a class="code" href="classCreature.html#a0a561860988a2692df47476d9a15511e">underwater</a> = will_be_water;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <a class="code" href="classoptional__vpart__position.html">optional_vpart_position</a> vp_dest = here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( destination );</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">if</span>( vp_dest ) {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        vp_dest-&gt;vehicle().invalidate_mass();</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    }</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="comment">//Hallucinations don&#39;t do any of the stuff after this point</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    }</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a03729ff11aa021aad1751ad38ed85c81">ter_furn_flag::TFLAG_UNSTABLE</a>, destination ) &amp;&amp;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        on_ground &amp;&amp; !here.<a class="code" href="classmap.html#a5ee9fe3a08892870a0574b8e1ab4e6b0">has_vehicle_floor</a>( destination ) ) {</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#aa3320a370fe1f7f1cf6e14918ca20358">effect_bouldering</a>, 1_turns, <span class="keyword">true</span> );</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#aa3320a370fe1f7f1cf6e14918ca20358">effect_bouldering</a> ) ) {</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <a class="code" href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">remove_effect</a>( <a class="code" href="monmove_8cpp.html#aa3320a370fe1f7f1cf6e14918ca20358">effect_bouldering</a> );</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a516c0764134cc86b57297811520395f7">has_flag_ter_or_furn</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a069663dd0b045b0a7e5268c906c5790f">ter_furn_flag::TFLAG_NO_SIGHT</a>, destination ) &amp;&amp; on_ground ) {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        <a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#af079f6d5681dabcbc1c4ee804c0ba556">effect_no_sight</a>, 1_turns, <span class="keyword">true</span> );</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#af079f6d5681dabcbc1c4ee804c0ba556">effect_no_sight</a> ) ) {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <a class="code" href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">remove_effect</a>( <a class="code" href="monmove_8cpp.html#af079f6d5681dabcbc1c4ee804c0ba556">effect_no_sight</a> );</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    }</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160; </div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a5ee9fe3a08892870a0574b8e1ab4e6b0">has_vehicle_floor</a>( destination ) ) {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> != <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a> &amp;&amp; on_ground ) {</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> sharp_damage = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 1, 10 );</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> rough_damage = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 1, 2 );</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a28fc0832c9c36a2deaa4f618f42c9c45">ter_furn_flag::TFLAG_SHARP</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) &amp;&amp; !<a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 4 ) &amp;&amp;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                <a class="code" href="classmonster.html#ab55cbaa78e9a77935dfc63e5c292317b">get_armor_type</a>( <a class="code" href="monmove_8cpp.html#aecd517a9e74b5a5a21f0c75f88f50090">damage_cut</a>, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ) ) &lt; sharp_damage &amp;&amp; <a class="code" href="classmonster.html#a2801a2f23fcaf2199b904c8bbf9fcab0">get_hp</a>() &gt; sharp_damage ) {</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                <a class="code" href="classmonster.html#afc6e6f5443145732310dd4901a394b4f">apply_damage</a>( <span class="keyword">nullptr</span>, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ), sharp_damage );</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            }</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ae9b0dbad49c1e68f88ba799b1956684f">ter_furn_flag::TFLAG_ROUGH</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) &amp;&amp; <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 6 ) &amp;&amp;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                <a class="code" href="classmonster.html#ab55cbaa78e9a77935dfc63e5c292317b">get_armor_type</a>( <a class="code" href="monmove_8cpp.html#aecd517a9e74b5a5a21f0c75f88f50090">damage_cut</a>, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ) ) &lt; rough_damage &amp;&amp; <a class="code" href="classmonster.html#a2801a2f23fcaf2199b904c8bbf9fcab0">get_hp</a>() &gt; rough_damage ) {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                <a class="code" href="classmonster.html#afc6e6f5443145732310dd4901a394b4f">apply_damage</a>( <span class="keyword">nullptr</span>, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ), rough_damage );</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            }</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        here.<a class="code" href="classmap.html#ae0dae45aeed1b7221d318c0a36abca5b">creature_on_trap</a>( *<span class="keyword">this</span> );</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#af033816139df1dfa154c27b199b51da6">is_dead</a>() ) {</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="keywordflow">if</span>( !will_be_water &amp;&amp; ( <a class="code" href="classmonster.html#a22e929800e08d5458140ec4dbaad53a5">digs</a>() || <a class="code" href="classmonster.html#a14e16a6d2e0a675a85b8794c8f5114cf">can_dig</a>() ) ) {</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <a class="code" href="classCreature.html#a0a561860988a2692df47476d9a15511e">underwater</a> = here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054aaebe86ebda0571101f8d02ab5f2a888c">ter_furn_flag::TFLAG_DIGGABLE</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="comment">// Digging creatures leave a trail of churned earth</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="comment">// They always leave some on their tile, and larger creatures emit some around themselves as well</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#af705eea6e40e12d7866010955602c7b5">digging</a>() &amp;&amp; here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054aaebe86ebda0571101f8d02ab5f2a888c">ter_furn_flag::TFLAG_DIGGABLE</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) ) {</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <span class="keywordtype">int</span> factor = 0;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="keywordflow">switch</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> ) {</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2a075a3e36a0a52dcbc568c05788e8a713">creature_size::medium</a>:</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                factor = 4;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aafacdb0a401ccdf6b48551bbc00e8a74">creature_size::large</a>:</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                factor = 3;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ab7cf27ffe6ea83cdcf8af2ef29de9285">creature_size::huge</a>:</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                factor = 2;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aac651433a999fb14f71f6754f0199781">creature_size::num_sizes</a>:</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: Invalid Creature size class.&quot;</span> );</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                factor = 4;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        }</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        here.<a class="code" href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">add_field</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="field__type_8cpp.html#a668009f9a173fd4f4be2b601be4a1f63">fd_churned_earth</a>, 2 );</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;dest : here.<a class="code" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 1, 0 ) ) {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054aaebe86ebda0571101f8d02ab5f2a888c">ter_furn_flag::TFLAG_DIGGABLE</a>, dest ) &amp;&amp; <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( factor ) ) {</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                here.<a class="code" href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">add_field</a>( dest, <a class="code" href="field__type_8cpp.html#a668009f9a173fd4f4be2b601be4a1f63">fd_churned_earth</a>, 2 );</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;            }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        }</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">// Acid trail monsters leave... a trail of acid</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a188f898480b93c89a0f5c0763cd8373d">mon_flag_ACIDTRAIL</a> ) ) {</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        here.<a class="code" href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">add_field</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="field__type_8cpp.html#a58c69cd6c8ba46b692c5ca3fbe4f0ae4">fd_acid</a>, 3 );</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    }</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="comment">// Not all acid trail monsters leave as much acid. Every time this monster takes a step, there is a 1/5 chance it will drop a puddle.</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#ab04d901f795e5383be19f9bc78e36a2d">mon_flag_SHORTACIDTRAIL</a> ) ) {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 5 ) ) {</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;            here.<a class="code" href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">add_field</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="field__type_8cpp.html#a58c69cd6c8ba46b692c5ca3fbe4f0ae4">fd_acid</a>, 3 );</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    }</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a758910f241f118e1f1bbe48a2bc41011">mon_flag_SLUDGETRAIL</a> ) ) {</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;sludge_p : here.<a class="code" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 1 ) ) {</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> fstr = 3 - ( <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( sludge_p.x - <a class="code" href="classCreature.html#aecea7d852ffba499ec12350c95340b9d">posx</a>() ) + <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( sludge_p.y - <a class="code" href="classCreature.html#a9f0365208b65ab1c45d23f03f402f491">posy</a>() ) );</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;            <span class="keywordflow">if</span>( fstr &gt;= 2 ) {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                here.<a class="code" href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">add_field</a>( sludge_p, <a class="code" href="field__type_8cpp.html#aef9321274b765b7943ca0412b949b373">fd_sludge</a>, fstr );</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;            }</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        }</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a423bde94101c93a1f67ed5ed8c334a05">mon_flag_SMALLSLUDGETRAIL</a> ) ) {</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 2 ) ) {</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            here.<a class="code" href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">add_field</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="field__type_8cpp.html#aef9321274b765b7943ca0412b949b373">fd_sludge</a>, 1 );</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    }</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="comment">// Don&#39;t leave any kind of liquids on water tiles</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    <span class="keywordflow">if</span>( !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, destination ) ) {</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a976a9bbc5340ce1473ec88e960fb0f4e">mon_flag_DRIPS_NAPALM</a> ) ) {</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 10 ) ) {</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                <span class="comment">// if it has more napalm, drop some and reduce ammo in tank</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa5740a03294bcab8ef209151af709c4c">ammo</a>[<a class="code" href="monmove_8cpp.html#a43d73ec1734433adc005632647aa155c">itype_pressurized_tank</a>] &gt; 0 ) {</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                    here.<a class="code" href="classmap.html#a5579e13088b4ccd9c5a75458919d528a">add_item_or_charges</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc">item</a>( <span class="stringliteral">&quot;napalm&quot;</span>, <a class="code" href="namespacecalendar.html#ae15fcbf1c971589eb49c1a657fb6a580">calendar::turn</a>, 50 ) );</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                    <a class="code" href="classmonster.html#aa5740a03294bcab8ef209151af709c4c">ammo</a>[<a class="code" href="monmove_8cpp.html#a43d73ec1734433adc005632647aa155c">itype_pressurized_tank</a>] -= 50;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                    <span class="comment">// TODO: remove mon_flag_DRIPS_NAPALM flag since no more napalm in tank</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                    <span class="comment">// Not possible for now since flag check is done on type, not individual monster</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                }</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        }</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#af9b7f4b3884e6ac1b61f21cdcc4fdd57">mon_flag_DRIPS_GASOLINE</a> ) ) {</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 5 ) ) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                <span class="comment">// TODO: use same idea that limits napalm dripping</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                here.<a class="code" href="classmap.html#a5579e13088b4ccd9c5a75458919d528a">add_item_or_charges</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc">item</a>( <span class="stringliteral">&quot;gasoline&quot;</span> ) );</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            }</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        }</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    }</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;}</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"><a class="line" href="classmonster.html#a1a829284017aa69618d25208a53061d1"> 2094</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a1a829284017aa69618d25208a53061d1">monster::push_to</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <span class="keywordtype">int</span> boost, <span class="keyword">const</span> <span class="keywordtype">size_t</span> depth )</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;{</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) {</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        <span class="comment">// Don&#39;t let hallucinations push, not even other hallucinations</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    }</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160; </div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#af882b7fb7b2ad4d4d8a66371e2a5793c">mon_flag_PUSH_MON</a> ) || depth &gt; 2 || <a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="monmove_8cpp.html#a6500d7a3ab33f453019cc4e7f55ced72">effect_pushed</a> ) ) {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    }</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="comment">// TODO: Generalize this to Creature</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <a class="code" href="classmonster.html">monster</a> *<span class="keyword">const</span> critter = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classmonster.html">monster</a>&gt;( p );</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keywordflow">if</span>( critter == <span class="keyword">nullptr</span> || critter == <span class="keyword">this</span> ||</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        p == <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() || critter-&gt;<a class="code" href="classmonster.html#a3ff46700c4e8b9527cb331151d7b7c26">movement_impaired</a>() ) {</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    }</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160; </div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">can_move_to</a>( p ) ) {</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    }</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordflow">if</span>( critter-&gt;<a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) {</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        <span class="comment">// Kill the hallu, but return false so that the regular move_to is uses instead</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        critter-&gt;<a class="code" href="classmonster.html#a82ae41773b05af94d4b678cb33bfb329">die</a>( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    }</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="comment">// Stability roll of the pushed critter</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> defend = critter-&gt;<a class="code" href="classmonster.html#a1d2c8b9ef1d6562d8b08c9d89e04b5c9">stability_roll</a>();</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="comment">// Stability roll of the pushing zed</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> = <a class="code" href="classmonster.html#a1d2c8b9ef1d6562d8b08c9d89e04b5c9">stability_roll</a>() + boost;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordflow">if</span>( defend &gt; <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> ) {</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    }</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> movecost_from = 50 * here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( p );</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> movecost_attacker = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( movecost_from, 200 - 10 * ( <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> - defend ) );</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> dir = p - <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>();</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160; </div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="comment">// Mark self as pushed to simplify recursive pushing</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#a6500d7a3ab33f453019cc4e7f55ced72">effect_pushed</a>, 1_turns );</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160; </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; 6; i++ ) {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> d( <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -1, 1 ), <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -1, 1 ) );</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        <span class="keywordflow">if</span>( d.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> == 0 &amp;&amp; d.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> == 0 ) {</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        }</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160; </div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        <span class="comment">// Pushing forward is easier than pushing aside</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> direction_penalty = <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( d.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> - dir.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> ) + <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( d.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> - dir.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> );</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        <span class="keywordflow">if</span>( direction_penalty &gt; 2 ) {</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        }</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160; </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        <a class="code" href="structtripoint.html">tripoint</a> dest( p + d );</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> dest_movecost_from = 50 * here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( dest );</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        <span class="comment">// Pushing into cars/windows etc. is harder</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> movecost_penalty = here.<a class="code" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( dest ) - 2;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        <span class="keywordflow">if</span>( movecost_penalty &lt;= -2 ) {</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;            <span class="comment">// Can&#39;t push into unpassable terrain</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        }</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        <span class="keywordtype">int</span> roll = <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> - ( defend + direction_penalty + movecost_penalty );</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        <span class="keywordflow">if</span>( roll &lt; 0 ) {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        }</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160; </div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        <a class="code" href="classCreature.html">Creature</a> *critter_recur = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( dest );</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;        <span class="keywordflow">if</span>( !( critter_recur == <span class="keyword">nullptr</span> || critter_recur-&gt;<a class="code" href="classCreature.html#a3cb42eea32fd7e172dca0e902d1184ed">is_hallucination</a>() ) ) {</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            <span class="comment">// Try to push recursively</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;            <a class="code" href="classmonster.html">monster</a> *mon_recur = <span class="keyword">dynamic_cast&lt;</span> <a class="code" href="classmonster.html">monster</a> * <span class="keyword">&gt;</span>( critter_recur );</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;            <span class="keywordflow">if</span>( mon_recur == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            }</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            <span class="keywordflow">if</span>( critter-&gt;<a class="code" href="classmonster.html#a1a829284017aa69618d25208a53061d1">push_to</a>( dest, roll, depth + 1 ) ) {</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                <span class="comment">// The tile isn&#39;t necessarily free, need to check</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                <span class="keywordflow">if</span>( !creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( p ) ) {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                    <a class="code" href="classmonster.html#ab3c07bd4cb325287741fa2e561168e56">move_to</a>( p );</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                }</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                <a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -movecost_attacker );</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                <span class="comment">// Don&#39;t knock down a creature that successfully</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                <span class="comment">// pushed another creature, just reduce moves</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                critter-&gt;<a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -dest_movecost_from );</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;            }</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        }</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        critter_recur = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( dest );</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        <span class="keywordflow">if</span>( critter_recur != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            <span class="keywordflow">if</span>( critter_recur-&gt;<a class="code" href="classCreature.html#a3cb42eea32fd7e172dca0e902d1184ed">is_hallucination</a>() ) {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                critter_recur-&gt;<a class="code" href="classCreature.html#a330dad28f732a1cf3af695eedb54877d">die</a>( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            }</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !critter-&gt;<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#af8eb4198f7564379a407e89c13cdd1b7">mon_flag_IMMOBILE</a> ) ) {</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            critter-&gt;<a class="code" href="classCreature.html#ac16dcdb688f6f47c594c98c83528a670">setpos</a>( dest );</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            <a class="code" href="classmonster.html#ab3c07bd4cb325287741fa2e561168e56">move_to</a>( p );</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            <a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -movecost_attacker );</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            critter-&gt;<a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#a08481f62adb6937636ea44b855311037">effect_downed</a>, <a class="code" href="classtime__duration.html#a0f7145f4fc4c09defbaf25f468e4e54a">time_duration::from_turns</a>( movecost_from / 100 + 1 ) );</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        }</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160; </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="comment">// Try to trample over a much weaker zed (or one with worse rolls)</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="comment">// Don&#39;t allow trampling with boost</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordflow">if</span>( boost &gt; 0 || <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> &lt; 2 * defend ) {</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;swap_critters( *critter, *<span class="keyword">this</span> );</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    critter-&gt;<a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">effect_stunned</a>, <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0_turns, 2_turns ) );</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;player_character = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    <span class="comment">// Only print the message when near player or it can get spammy</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( player_character.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) &lt; 4 ) {</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( *critter, <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %1$s tramples %2$s.&quot;</span> ),</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                                <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(), critter-&gt;<a class="code" href="classmonster.html#af3444e4763b1dd53e75c5ea50fd8ba9f">disp_name</a>() );</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -movecost_attacker );</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="keywordflow">if</span>( movecost_from &gt; 100 ) {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        critter-&gt;<a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#a08481f62adb6937636ea44b855311037">effect_downed</a>, <a class="code" href="classtime__duration.html#a0f7145f4fc4c09defbaf25f468e4e54a">time_duration::from_turns</a>( movecost_from / 100 + 1 ) );</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        critter-&gt;<a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -movecost_from );</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;}</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment"> * Stumble in a random direction, but with some caveats.</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"><a class="line" href="classmonster.html#a6adba28c21a8b6e6cc1b81f2f31d1947"> 2233</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#a6adba28c21a8b6e6cc1b81f2f31d1947">monster::stumble</a>()</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;{</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2ab576821e0d29160d6272e3c6f9faa323">debugmode::DF_MONMOVE</a>, <span class="stringliteral">&quot;%s starting monmove::stumble&quot;</span>, <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="comment">// Only move every 10 turns.</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 10 ) ) {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    }</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160; </div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    std::vector&lt;tripoint&gt; valid_stumbles;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    valid_stumbles.reserve( 11 );</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> avoid_water = <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a4c417260415c080a792537389ec1c0fe">mon_flag_NO_BREATHE</a> ) &amp;&amp; !<a class="code" href="classmonster.html#a4be04fecf05b13bc290b5b1dcc6b9137">swims</a>() &amp;&amp;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                             !<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a10899530fa212da51fd92b98b0cacdb5">mon_flag_AQUATIC</a> );</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;dest : here.<a class="code" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 1 ) ) {</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        <span class="keywordflow">if</span>( dest != <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) {</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a26a026d844907da147f1350754b5210b">ter_furn_flag::TFLAG_RAMP_DOWN</a>, dest ) ) {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                valid_stumbles.emplace_back( dest.xy(), dest.z - 1 );</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;            } <span class="keywordflow">else</span>  <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a4099f16f8e2c4ea80e996db0ea6f4c02">ter_furn_flag::TFLAG_RAMP_UP</a>, dest ) ) {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                valid_stumbles.emplace_back( dest.xy(), dest.z + 1 );</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                valid_stumbles.push_back( dest );</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    }</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> <a class="code" href="cube__direction_8h.html#aea62013051f3c8842efa174037dfb5bca6cede1cfde12fc6d88ad1d8b6636a977">below</a>( <a class="code" href="classCreature.html#aecea7d852ffba499ec12350c95340b9d">posx</a>(), <a class="code" href="classCreature.html#a9f0365208b65ab1c45d23f03f402f491">posy</a>(), <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() - 1 );</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a3188771064ca49d4798c6a80bfad0fcd">valid_move</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="cube__direction_8h.html#aea62013051f3c8842efa174037dfb5bca6cede1cfde12fc6d88ad1d8b6636a977">below</a>, <span class="keyword">false</span>, <span class="keyword">true</span> ) ) {</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        valid_stumbles.push_back( <a class="code" href="cube__direction_8h.html#aea62013051f3c8842efa174037dfb5bca6cede1cfde12fc6d88ad1d8b6636a977">below</a> );</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="keywordflow">while</span>( !valid_stumbles.empty() &amp;&amp; !<a class="code" href="classmonster.html#af033816139df1dfa154c27b199b51da6">is_dead</a>() ) {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> dest = <a class="code" href="rng_8h.html#ac634f688b3c7864ab6992939ac7b0a6e">random_entry_removed</a>( valid_stumbles );</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">can_move_to</a>( dest ) &amp;&amp;</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;            <span class="comment">//Stop zombies and other non-breathing monsters wandering INTO water</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;            <span class="comment">//(Unless they can swim/are aquatic)</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;            <span class="comment">//But let them wander OUT of water if they are there.</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            !( avoid_water &amp;&amp;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;               here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, dest ) &amp;&amp;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;               !here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a>, <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) ) &amp;&amp;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;            ( creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( dest, <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) == <span class="keyword">nullptr</span> ) ) {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#ab3c07bd4cb325287741fa2e561168e56">move_to</a>( dest, <span class="keyword">true</span>, <span class="keyword">false</span> ) ) {</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            }</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        }</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    }</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;}</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160; </div>
<div class="line"><a name="l02280"></a><span class="lineno"><a class="line" href="classmonster.html#aa6c57b6cbf413727ea33c467f2bc886b"> 2280</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#aa6c57b6cbf413727ea33c467f2bc886b">monster::knock_back_to</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;to )</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;{</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keywordflow">if</span>( to == <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) {</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">// No effect</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) {</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        <a class="code" href="classmonster.html#a82ae41773b05af94d4b678cb33bfb329">die</a>( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    }</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <span class="keywordtype">bool</span> u_see = <a class="code" href="game_8cpp.html#ab5c977b7e81348725fb7bf09fc64ed95">get_player_view</a>().<a class="code" href="classviewer.html#a204fe140cdc73d2452fa9a390a32ba29">sees</a>( to );</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="comment">// First, see if we hit another monster</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html">monster</a> *<span class="keyword">const</span> z = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classmonster.html">monster</a>&gt;( to ) ) {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <a class="code" href="classmonster.html#afc6e6f5443145732310dd4901a394b4f">apply_damage</a>( z, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( z-&gt;type-&gt;size ) );</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        <a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">effect_stunned</a>, 1_turns );</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> &gt; 1 + z-&gt;type-&gt;size ) {</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            z-&gt;knock_back_from( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ); <span class="comment">// Chain reaction!</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            z-&gt;apply_damage( <span class="keyword">this</span>, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> ) );</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;            z-&gt;add_effect( <a class="code" href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">effect_stunned</a>, 1_turns );</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> &gt; z-&gt;type-&gt;size ) {</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            z-&gt;apply_damage( <span class="keyword">this</span>, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> ) );</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            z-&gt;add_effect( <a class="code" href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">effect_stunned</a>, 1_turns );</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        }</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        z-&gt;check_dead_state();</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        <span class="keywordflow">if</span>( u_see ) {</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %1$s bounces off a %2$s!&quot;</span> ), <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(), z-&gt;name() );</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160; </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    }</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classnpc.html">npc</a> *<span class="keyword">const</span> p = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classnpc.html">npc</a>&gt;( to ) ) {</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        <a class="code" href="classmonster.html#afc6e6f5443145732310dd4901a394b4f">apply_damage</a>( p, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ), 3 );</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">effect_stunned</a>, 1_turns );</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        p-&gt;deal_damage( <span class="keyword">this</span>, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ),</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                        <a class="code" href="structdamage__instance.html">damage_instance</a>( <a class="code" href="make__static_8h.html#ad8ea997925f9b41fffbf138f4c05e09f">STATIC</a>( <a class="code" href="type__id_8h.html#a119965745ae171b731d18a45ec6ee424">damage_type_id</a>( <span class="stringliteral">&quot;bash&quot;</span> ) ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> ) ) );</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        <span class="keywordflow">if</span>( u_see ) {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %1$s bounces off %2$s!&quot;</span> ), <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(), p-&gt;get_name() );</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        }</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160; </div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        p-&gt;check_dead_state();</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    }</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="comment">// If we&#39;re still in the function at this point, we&#39;re actually moving a tile!</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <span class="comment">// die_if_drowning will kill the monster if necessary, but if the deep water</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="comment">// tile is on a vehicle, we should check for swimmers out of water</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classmonster.html#a9118d0de36f4dbb72c28cc0832bba897">die_if_drowning</a>( to ) &amp;&amp; <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a10899530fa212da51fd92b98b0cacdb5">mon_flag_AQUATIC</a> ) ) {</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        <a class="code" href="classmonster.html#a82ae41773b05af94d4b678cb33bfb329">die</a>( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        <span class="keywordflow">if</span>( u_see ) {</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %s flops around and dies!&quot;</span> ), <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>() );</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    }</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160; </div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <span class="comment">// It&#39;s some kind of wall.</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">impassable</a>( to ) ) {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> dam = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">size</a> );</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <a class="code" href="classmonster.html#afc6e6f5443145732310dd4901a394b4f">apply_damage</a>( <span class="keyword">nullptr</span>, <a class="code" href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a>( <span class="stringliteral">&quot;torso&quot;</span> ), dam );</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        <a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">effect_stunned</a>, 2_turns );</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        <span class="keywordflow">if</span>( u_see ) {</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;            <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %1$s bounces off a %2$s and takes %3$d damage.&quot;</span> ), <a class="code" href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">name</a>(),</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                     here.<a class="code" href="classmap.html#ab38205e356b39b5961e0513d45e90170">obstacle_name</a>( to ), dam );</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        }</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// It&#39;s no wall</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        <a class="code" href="classCreature.html#ac16dcdb688f6f47c594c98c83528a670">setpos</a>( to );</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    }</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    <a class="code" href="classCreature.html#a36dcf5a04ddc0cf9fa29c08b7b099158">check_dead_state</a>();</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;}</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment">/* will_reach() is used for determining whether we&#39;ll get to stairs (and</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment"> * potentially other locations of interest).  It is generally permissive.</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment"> * TODO: Pathfinding;</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment">         Make sure that non-smashing monsters won&#39;t &quot;teleport&quot; through windows</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">         Injure monsters if they&#39;re gonna be walking through pits or whatever</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"><a class="line" href="classmonster.html#a73aa45942033a7c02529df8ab4b229af"> 2361</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmonster.html#a73aa45942033a7c02529df8ab4b229af">monster::will_reach</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;p )</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;{</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4">monster_attitude</a> att = <a class="code" href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">attitude</a>( &amp;<a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() );</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="keywordflow">if</span>( att != <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a850d5624fd1d54192310ab8b13f228ee">MATT_FOLLOW</a> &amp;&amp; att != <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a87f44dc6e793f84b2342dafd6460b263">MATT_ATTACK</a> &amp;&amp; att != <a class="code" href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a7284d60cdedff9ecfaaf33b10ba4986b">MATT_FRIEND</a> ) {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    }</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160; </div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a22e929800e08d5458140ec4dbaad53a5">digs</a>() || <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a10899530fa212da51fd92b98b0cacdb5">mon_flag_AQUATIC</a> ) ) {</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    }</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <span class="keywordflow">if</span>( ( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#af8eb4198f7564379a407e89c13cdd1b7">mon_flag_IMMOBILE</a> ) || <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a1ce59be15eeebc2aa195dc5a5cf38358">mon_flag_RIDEABLE_MECH</a> ) ) &amp;&amp;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        ( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().xy() != p ) ) {</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    }</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160; </div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <span class="keyword">auto</span> <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a> = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#acd464679b3bb514e2568ffdb3260ef0c">route</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">tripoint</a>( p, <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() ), <a class="code" href="classmonster.html#a873925c09bec361ffd2363626828a362">get_pathfinding_settings</a>() );</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.empty() ) {</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    }</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#a7598512ae9ca78a96974d3ca4237b044">mon_flag_SMELLS</a> ) &amp;&amp; <a class="code" href="game_8cpp.html#afee362892b161716a3fc614b030a877d">get_scent</a>().<a class="code" href="namespacerotatable__symbols.html#a7d2f855a39674de736a7829423a577f4">get</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) &gt; 0 &amp;&amp;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <a class="code" href="game_8cpp.html#afee362892b161716a3fc614b030a877d">get_scent</a>().<a class="code" href="namespacerotatable__symbols.html#a7d2f855a39674de736a7829423a577f4">get</a>( { p, <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() } ) &gt; <a class="code" href="game_8cpp.html#afee362892b161716a3fc614b030a877d">get_scent</a>().<a class="code" href="classscent__map.html#a99aff3e6d8963d7f34618216a8448c8c">get</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) ) {</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    }</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a1e799308a5bfe0f6c1f3d47a5c10987a">can_hear</a>() &amp;&amp; <a class="code" href="classmonster.html#a88c30bfeb57c6d44b965f92265fc16d2">wandf</a> &gt; 0 &amp;&amp; <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().getlocal( <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a> ).xy(), p ) &lt;= 2 &amp;&amp;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( <a class="code" href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">get_location</a>().xy(), <a class="code" href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">wander_pos</a>.<a class="code" href="classcoords_1_1coord__point.html#a7b5804160d1d0e69a9f2fba098bea723">xy</a>() ) &lt;= <a class="code" href="classmonster.html#a88c30bfeb57c6d44b965f92265fc16d2">wandf</a> ) {</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    }</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#a79c1aef59cccba881fc60e52fb6d8cb9">can_see</a>() &amp;&amp; <a class="code" href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">sees</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">tripoint</a>( p, <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() ) ) ) {</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;}</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"><a class="line" href="classmonster.html#aa411814aee066a5e242f51efe6daec65"> 2399</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmonster.html#aa411814aee066a5e242f51efe6daec65">monster::turns_to_reach</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;p )</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;{</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    <span class="comment">// HACK: This function is a(n old) temporary hack that should soon be removed</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="keyword">auto</span> <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a> = here.<a class="code" href="classmap.html#acd464679b3bb514e2568ffdb3260ef0c">route</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">tripoint</a>( p, <a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() ), <a class="code" href="classmonster.html#a873925c09bec361ffd2363626828a362">get_pathfinding_settings</a>() );</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.empty() ) {</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        <span class="keywordflow">return</span> 999;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    }</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keywordtype">double</span> turns = 0.;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>.size(); i++ ) {</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;next = <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>[i];</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">impassable</a>( next ) ) {</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;            <span class="comment">// No bashing through, it looks stupid when you go back and find</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            <span class="comment">// the doors intact.</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;            <span class="keywordflow">return</span> 999;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( i == 0 ) {</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            turns += <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( <a class="code" href="classmonster.html#a98cfa6c825f373b60a0a4021a8dbf750">calc_movecost</a>( <a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), next ) ) / <a class="code" href="classCreature.html#a261dff3caa6aabe255ae9d3eaa94d3de">get_speed</a>();</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            turns += <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( <a class="code" href="classmonster.html#a98cfa6c825f373b60a0a4021a8dbf750">calc_movecost</a>( <a class="code" href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">path</a>[i - 1], next ) ) / <a class="code" href="classCreature.html#a261dff3caa6aabe255ae9d3eaa94d3de">get_speed</a>();</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    }</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( turns + .9 ); <span class="comment">// Halve (to get turns) and round up</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;}</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02425"></a><span class="lineno"><a class="line" href="classmonster.html#ad18dfb6454b3ce4172d476af3a042f4b"> 2425</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmonster.html#ad18dfb6454b3ce4172d476af3a042f4b">monster::shove_vehicle</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;remote_destination,</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                             <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;nearby_destination )</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;{</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="keywordflow">if</span>( this-&gt;<a class="code" href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">has_flag</a>( <a class="code" href="mtype_8cpp.html#aabb42fd7984b2addbc4580930166b17b">mon_flag_PUSH_VEH</a> ) &amp;&amp; !<a class="code" href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">is_hallucination</a>() ) {</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        <a class="code" href="classoptional__vpart__position.html">optional_vpart_position</a> vp = here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( nearby_destination );</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        <span class="keywordflow">if</span>( vp ) {</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;            <a class="code" href="classvehicle.html">vehicle</a> &amp;veh = vp-&gt;vehicle();</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;            <span class="keyword">const</span> <a class="code" href="classunits_1_1quantity.html">units::mass</a> veh_mass = veh.<a class="code" href="classvehicle.html#a5a7d83716bf73d4b58d265b626872d01">total_mass</a>();</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;            <span class="keywordtype">int</span> shove_moves_minimal = 0;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;            <span class="keywordtype">int</span> shove_veh_mass_moves_factor = 0;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;            <span class="keywordtype">int</span> shove_velocity = 0;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;            <span class="keywordtype">float</span> shove_damage_min = 0.00F;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;            <span class="keywordtype">float</span> shove_damage_max = 0.00F;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;            <span class="keywordflow">switch</span>( this-&gt;<a class="code" href="classmonster.html#ab92cac0ecb2b2062fd4f821b671f86ac">get_size</a>() ) {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a>:</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aeb5c1399a871211c7e7ed732d15e3a8b">creature_size::small</a>:</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2a075a3e36a0a52dcbc568c05788e8a713">creature_size::medium</a>:</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                    <span class="keywordflow">if</span>( veh_mass &lt; 500_kilogram ) {</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                        shove_moves_minimal = 150;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                        shove_veh_mass_moves_factor = 20;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                        shove_velocity = 500;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                        shove_damage_min = 0.00F;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;                        shove_damage_max = 0.01F;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;                    }</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aafacdb0a401ccdf6b48551bbc00e8a74">creature_size::large</a>:</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                    <span class="keywordflow">if</span>( veh_mass &lt; 1000_kilogram ) {</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                        shove_moves_minimal = 100;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                        shove_veh_mass_moves_factor = 8;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                        shove_velocity = 1000;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                        shove_damage_min = 0.00F;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                        shove_damage_max = 0.03F;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                    }</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ab7cf27ffe6ea83cdcf8af2ef29de9285">creature_size::huge</a>:</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                    <span class="keywordflow">if</span>( veh_mass &lt; 2000_kilogram ) {</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                        shove_moves_minimal = 50;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                        shove_veh_mass_moves_factor = 4;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                        shove_velocity = 1500;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                        shove_damage_min = 0.00F;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                        shove_damage_max = 0.05F;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                    }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            }</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;            <span class="keywordflow">if</span>( shove_velocity &gt; 0 ) {</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                <span class="comment">//~ %1$s - monster name, %2$s - vehicle name</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( this-&gt;<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;%1$s shoves %2$s out of their way!&quot;</span> ),</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                                        this-&gt;<a class="code" href="classmonster.html#af3444e4763b1dd53e75c5ea50fd8ba9f">disp_name</a>(),</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                                        veh.<a class="code" href="classvehicle.html#ace5c25f3faffd8848491570cfb89f086">disp_name</a>() );</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                <span class="keywordtype">int</span> shove_moves = shove_veh_mass_moves_factor * veh_mass / 10_kilogram;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                shove_moves = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( shove_moves, shove_moves_minimal );</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                this-&gt;<a class="code" href="classCreature.html#a891bc2d0c564449cb462178317819254">mod_moves</a>( -shove_moves );</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> destination_delta( -nearby_destination + remote_destination );</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> shove_destination( <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( destination_delta.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a>, -1, 1 ),</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                                                  <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( destination_delta.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a>, -1, 1 ),</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                                                  <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( destination_delta.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a>, -1, 1 ) );</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                veh.<a class="code" href="classvehicle.html#a320ca34b5c38568efd801731cef78a35">skidding</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                veh.<a class="code" href="classvehicle.html#a4d83e86fe57ec6126893a68f68c3c304">velocity</a> = shove_velocity;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                <span class="keywordflow">if</span>( shove_destination != <a class="code" href="point_8h.html#a4b1a6bcaa42d2c06ecc3afc63305bfdf">tripoint_zero</a> ) {</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                    <span class="keywordflow">if</span>( shove_destination.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> != 0 ) {</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                        veh.<a class="code" href="classvehicle.html#a416a2bc9ee792663fced3344db322cb8">vertical_velocity</a> = shove_destination.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> &lt; 0 ? -shove_velocity : +shove_velocity;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                    }</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                    here.<a class="code" href="classmap.html#add9128611766f2a8095b0104f0fd7371">move_vehicle</a>( veh, shove_destination, veh.<a class="code" href="classvehicle.html#a8e021d197980bbed36ff3c43962df957">face</a> );</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                }</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                veh.<a class="code" href="classvehicle.html#a8bbdfb41ea75fdc007feab08e2137aa2">move</a> = <a class="code" href="classtileray.html">tileray</a>( destination_delta.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>() );</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                veh.<a class="code" href="classvehicle.html#a8b023391122d88cc354e7fca903cec54">smash</a>( here, shove_damage_min, shove_damage_max, 0.10F );</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;            }</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        }</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    }</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;}</div>
<div class="ttc" id="abehavior_8h_html"><div class="ttname"><a href="behavior_8h.html">behavior.h</a></div></div>
<div class="ttc" id="abionics_8h_html"><div class="ttname"><a href="bionics_8h.html">bionics.h</a></div></div>
<div class="ttc" id="abodypart_8h_html_a426444e2d486ce1ee315d8b8acc86b40"><div class="ttname"><a href="bodypart_8h.html#a426444e2d486ce1ee315d8b8acc86b40">bodypart_id</a></div><div class="ttdeci">int_id&lt; body_part_type &gt; bodypart_id</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00032">bodypart.h:32</a></div></div>
<div class="ttc" id="acached__options_8h_html"><div class="ttname"><a href="cached__options_8h.html">cached_options.h</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_a359120c15f92d54a49fec9de7bcb571f"><div class="ttname"><a href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a></div><div class="ttdeci">bool x_in_y(const time_duration &amp;a, const time_duration &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00784">calendar.cpp:784</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_a4249b6f1d0842211bfe53e5f9e206a10"><div class="ttname"><a href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a></div><div class="ttdeci">time_duration rng(time_duration lo, time_duration hi)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00779">calendar.cpp:779</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_a81656706da6c7486137ad8578c0f523e"><div class="ttname"><a href="calendar_8cpp.html#a81656706da6c7486137ad8578c0f523e">season_of_year</a></div><div class="ttdeci">season_type season_of_year(const time_point &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00810">calendar.cpp:810</a></div></div>
<div class="ttc" id="acalendar_8h_html_a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8"><div class="ttname"><a href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">clipped_unit::season</a></div><div class="ttdeci">@ season</div></div>
<div class="ttc" id="acalendar_8h_html_a5ac915753729cd68b608506d3c63ad1b"><div class="ttname"><a href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1b">season_type</a></div><div class="ttdeci">season_type</div><div class="ttdoc">Real world seasons.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00021">calendar.h:21</a></div></div>
<div class="ttc" id="acalendar_8h_html_a5ac915753729cd68b608506d3c63ad1ba1d8c9db74467f6c2fdad36f154ca6873"><div class="ttname"><a href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1ba1d8c9db74467f6c2fdad36f154ca6873">WINTER</a></div><div class="ttdeci">@ WINTER</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00025">calendar.h:25</a></div></div>
<div class="ttc" id="acalendar_8h_html_a5ac915753729cd68b608506d3c63ad1ba5c29d7e8c16f80d457fa37c9dafab61e"><div class="ttname"><a href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1ba5c29d7e8c16f80d457fa37c9dafab61e">AUTUMN</a></div><div class="ttdeci">@ AUTUMN</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00024">calendar.h:24</a></div></div>
<div class="ttc" id="acalendar_8h_html_a5ac915753729cd68b608506d3c63ad1ba6d813ab9ea240f6c6eeff923ccb680ae"><div class="ttname"><a href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1ba6d813ab9ea240f6c6eeff923ccb680ae">SUMMER</a></div><div class="ttdeci">@ SUMMER</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00023">calendar.h:23</a></div></div>
<div class="ttc" id="acalendar_8h_html_a5ac915753729cd68b608506d3c63ad1ba74ce3137b26cdafc19bdb66d881971fa"><div class="ttname"><a href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1ba74ce3137b26cdafc19bdb66d881971fa">SPRING</a></div><div class="ttdeci">@ SPRING</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00022">calendar.h:22</a></div></div>
<div class="ttc" id="acata__assert_8h_html_abb2ca9fce6a171932c05748ecc5df5bb"><div class="ttname"><a href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a></div><div class="ttdeci">#define cata_assert(expression)</div><div class="ttdef"><b>Definition:</b> <a href="cata__assert_8h_source.html#l00036">cata_assert.h:36</a></div></div>
<div class="ttc" id="acata__utility_8cpp_html_a6a85dc6d2ab7bcb093e77d20fcf171d6"><div class="ttname"><a href="cata__utility_8cpp.html#a6a85dc6d2ab7bcb093e77d20fcf171d6">logarithmic_range</a></div><div class="ttdeci">double logarithmic_range(int min, int max, int pos)</div><div class="ttdoc">Normalized logistic function.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8cpp_source.html#l00166">cata_utility.cpp:166</a></div></div>
<div class="ttc" id="acata__utility_8h_html"><div class="ttname"><a href="cata__utility_8h.html">cata_utility.h</a></div></div>
<div class="ttc" id="acata__utility_8h_html_ad22b4a043b6eb4c2c06f87f83b720b15"><div class="ttname"><a href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a></div><div class="ttdeci">constexpr T clamp(const T &amp;val, const T &amp;min, const T &amp;max)</div><div class="ttdoc">Clamp first argument so that it is no lower than second and no higher than third.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00221">cata_utility.h:221</a></div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">cata_variant_type::tripoint</a></div><div class="ttdeci">@ tripoint</div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">cata_variant_type::point</a></div><div class="ttdeci">@ point</div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4abf21153f2489c6f52bf69def405456ad"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4abf21153f2489c6f52bf69def405456ad">cata_variant_type::character_id</a></div><div class="ttdeci">@ character_id</div></div>
<div class="ttc" id="acharacter_8h_html"><div class="ttname"><a href="character_8h.html">character.h</a></div></div>
<div class="ttc" id="acharacter_8h_html_abaafa6561de05c3b1324214e3048745a"><div class="ttname"><a href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a></div><div class="ttdeci">Character &amp; get_player_character()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13807">game.cpp:13807</a></div></div>
<div class="ttc" id="aclassCharacter_html"><div class="ttname"><a href="classCharacter.html">Character</a></div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00522">character.h:523</a></div></div>
<div class="ttc" id="aclassCharacter_html_a1e1996b6d6fc0a86d917cd155e1656d8"><div class="ttname"><a href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">Character::disp_name</a></div><div class="ttdeci">std::string disp_name(bool possessive=false, bool capitalize_first=false) const override</div><div class="ttdoc">Returns either &quot;you&quot; or the player's name.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00829">character.cpp:829</a></div></div>
<div class="ttc" id="aclassCharacter_html_a388bca3ef975bd265c67df45bb280bee"><div class="ttname"><a href="classCharacter.html#a388bca3ef975bd265c67df45bb280bee">Character::my_bionics</a></div><div class="ttdeci">pimpl&lt; bionic_collection &gt; my_bionics</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02723">character.h:2723</a></div></div>
<div class="ttc" id="aclassCharacter_html_a597968eba450c923b56a1c9cac1676dc"><div class="ttname"><a href="classCharacter.html#a597968eba450c923b56a1c9cac1676dc">Character::cancel_activity</a></div><div class="ttdeci">void cancel_activity()</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l08983">character.cpp:8983</a></div></div>
<div class="ttc" id="aclassCharacter_html_a6091baffbbf96adb27c6ab844960b1ff"><div class="ttname"><a href="classCharacter.html#a6091baffbbf96adb27c6ab844960b1ff">Character::uninstall_bionic</a></div><div class="ttdeci">bool uninstall_bionic(const bionic &amp;bio, Character &amp;installer, bool autodoc=false, int skill_level=-1)</div><div class="ttdoc">Initialize all the values needed to start the operation player_activity.</div><div class="ttdef"><b>Definition:</b> <a href="bionics_8cpp_source.html#l02117">bionics.cpp:2117</a></div></div>
<div class="ttc" id="aclassCharacter_html_a6592c35167738421f3e04ca8808d37db"><div class="ttname"><a href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">Character::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02684">character.h:2684</a></div></div>
<div class="ttc" id="aclassCharacter_html_af0e2967a36e27b1bb3774cf0eeb51c72"><div class="ttname"><a href="classCharacter.html#af0e2967a36e27b1bb3774cf0eeb51c72">Character::find_bionic_by_uid</a></div><div class="ttdeci">std::optional&lt; bionic * &gt; find_bionic_by_uid(bionic_uid bio_uid) const</div><div class="ttdoc">Finds the bionic with specified UID.</div><div class="ttdef"><b>Definition:</b> <a href="bionics_8cpp_source.html#l02810">bionics.cpp:2810</a></div></div>
<div class="ttc" id="aclassCreature_html"><div class="ttname"><a href="classCreature.html">Creature</a></div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00250">creature.h:251</a></div></div>
<div class="ttc" id="aclassCreature_html_a090f59402eea6b1605cbfa5c2b2ac77c"><div class="ttname"><a href="classCreature.html#a090f59402eea6b1605cbfa5c2b2ac77c">Creature::is_immune_field</a></div><div class="ttdeci">virtual bool is_immune_field(const field_type_id &amp;) const</div><div class="ttdoc">Returns true if we are immune to the field type with the given fid.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00573">creature.h:573</a></div></div>
<div class="ttc" id="aclassCreature_html_a0a561860988a2692df47476d9a15511e"><div class="ttname"><a href="classCreature.html#a0a561860988a2692df47476d9a15511e">Creature::underwater</a></div><div class="ttdeci">bool underwater</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00941">creature.h:941</a></div></div>
<div class="ttc" id="aclassCreature_html_a140c55c27932cd7a09befc12d80b9a3c"><div class="ttname"><a href="classCreature.html#a140c55c27932cd7a09befc12d80b9a3c">Creature::hp_percentage</a></div><div class="ttdeci">virtual int hp_percentage() const =0</div></div>
<div class="ttc" id="aclassCreature_html_a1a65722d07102550f16d17ebd79e2743"><div class="ttname"><a href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">Creature::pos</a></div><div class="ttdeci">tripoint pos() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00178">creature.cpp:178</a></div></div>
<div class="ttc" id="aclassCreature_html_a1ba25d990e8532dd2b0331bfc6cc694c"><div class="ttname"><a href="classCreature.html#a1ba25d990e8532dd2b0331bfc6cc694c">Creature::get_effect_dur</a></div><div class="ttdeci">time_duration get_effect_dur(const efftype_id &amp;eff_id, const bodypart_id &amp;bp=bodypart_str_id::NULL_ID()) const</div><div class="ttdoc">Returns the duration of the matching effect.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01863">creature.cpp:1863</a></div></div>
<div class="ttc" id="aclassCreature_html_a1c6d98c5a339561c989ba3e1ca34eeb8"><div class="ttname"><a href="classCreature.html#a1c6d98c5a339561c989ba3e1ca34eeb8">Creature::remove_effect</a></div><div class="ttdeci">bool remove_effect(const efftype_id &amp;eff_id, const bodypart_id &amp;bp)</div><div class="ttdoc">Removes a listed effect.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01722">creature.cpp:1722</a></div></div>
<div class="ttc" id="aclassCreature_html_a21b8fbeb525a28615eec6a6c22beff44"><div class="ttname"><a href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">Creature::facing</a></div><div class="ttdeci">FacingDirection facing</div><div class="ttdoc">return the direction the creature is facing, for sdl horizontal flip</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00303">creature.h:303</a></div></div>
<div class="ttc" id="aclassCreature_html_a261dff3caa6aabe255ae9d3eaa94d3de"><div class="ttname"><a href="classCreature.html#a261dff3caa6aabe255ae9d3eaa94d3de">Creature::get_speed</a></div><div class="ttdeci">virtual int get_speed() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l02138">creature.cpp:2138</a></div></div>
<div class="ttc" id="aclassCreature_html_a26b7c431f85f0b99b888db69318ebdc5"><div class="ttname"><a href="classCreature.html#a26b7c431f85f0b99b888db69318ebdc5">Creature::disp_name</a></div><div class="ttdeci">virtual std::string disp_name(bool possessive=false, bool capitalize_first=false) const =0</div></div>
<div class="ttc" id="aclassCreature_html_a3261de1530798f5b934a71b9a4e17f5b"><div class="ttname"><a href="classCreature.html#a3261de1530798f5b934a71b9a4e17f5b">Creature::get_location</a></div><div class="ttdeci">tripoint_abs_ms get_location() const</div><div class="ttdoc">Returns the location of the creature in map square coordinates (the most detailed coordinate system),...</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l03232">creature.cpp:3232</a></div></div>
<div class="ttc" id="aclassCreature_html_a330dad28f732a1cf3af695eedb54877d"><div class="ttname"><a href="classCreature.html#a330dad28f732a1cf3af695eedb54877d">Creature::die</a></div><div class="ttdeci">virtual void die(Creature *killer)=0</div><div class="ttdoc">Empty function.</div></div>
<div class="ttc" id="aclassCreature_html_a36dcf5a04ddc0cf9fa29c08b7b099158"><div class="ttname"><a href="classCreature.html#a36dcf5a04ddc0cf9fa29c08b7b099158">Creature::check_dead_state</a></div><div class="ttdeci">void check_dead_state()</div><div class="ttdoc">This function checks the creatures is_dead_state and (if true) calls die.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l03067">creature.cpp:3067</a></div></div>
<div class="ttc" id="aclassCreature_html_a3cb42eea32fd7e172dca0e902d1184ed"><div class="ttname"><a href="classCreature.html#a3cb42eea32fd7e172dca0e902d1184ed">Creature::is_hallucination</a></div><div class="ttdeci">virtual bool is_hallucination() const =0</div></div>
<div class="ttc" id="aclassCreature_html_a3e322a5b9e8f42f840ddffa01ec2787f"><div class="ttname"><a href="classCreature.html#a3e322a5b9e8f42f840ddffa01ec2787f">Creature::attack_air</a></div><div class="ttdeci">bool attack_air(const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01415">creature.cpp:1415</a></div></div>
<div class="ttc" id="aclassCreature_html_a5de5f5e0d08deb03b68749608eb360b2"><div class="ttname"><a href="classCreature.html#a5de5f5e0d08deb03b68749608eb360b2">Creature::as_npc</a></div><div class="ttdeci">virtual npc * as_npc()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00286">creature.h:286</a></div></div>
<div class="ttc" id="aclassCreature_html_a5e2f65bf9e0412193ebaaf60d02cc0cc"><div class="ttname"><a href="classCreature.html#a5e2f65bf9e0412193ebaaf60d02cc0cc">Creature::move_to</a></div><div class="ttdeci">void move_to(const tripoint_abs_ms &amp;loc)</div><div class="ttdoc">Moves the creature to the given location and calls the on_move() handler.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00195">creature.cpp:195</a></div></div>
<div class="ttc" id="aclassCreature_html_a5f818f1aa899ba2e2765f327a020a878"><div class="ttname"><a href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">Creature::sees</a></div><div class="ttdeci">bool sees(const Creature &amp;critter) const override</div><div class="ttdoc">The functions check whether this creature can see the target.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00358">creature.cpp:358</a></div></div>
<div class="ttc" id="aclassCreature_html_a6410520bceb652ba361502f404fc1005"><div class="ttname"><a href="classCreature.html#a6410520bceb652ba361502f404fc1005">Creature::stumble_invis</a></div><div class="ttdeci">bool stumble_invis(const Creature &amp;player, bool stumblemsg=true)</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01389">creature.cpp:1389</a></div></div>
<div class="ttc" id="aclassCreature_html_a666022fd3ed772fa109d273c20e8de55"><div class="ttname"><a href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">Creature::add_effect</a></div><div class="ttdeci">void add_effect(const effect &amp;eff, bool force=false, bool deferred=false)</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00604">creature.h:604</a></div></div>
<div class="ttc" id="aclassCreature_html_a6a4c43d66f5a8b50a879d78682b00976"><div class="ttname"><a href="classCreature.html#a6a4c43d66f5a8b50a879d78682b00976">Creature::is_dangerous_fields</a></div><div class="ttdeci">bool is_dangerous_fields(const field &amp;fld) const</div><div class="ttdoc">Returns true if there is a field in the field set that is dangerous to us.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00334">creature.cpp:334</a></div></div>
<div class="ttc" id="aclassCreature_html_a7bf62f4f36b0475f1f39ea27f3beebb0"><div class="ttname"><a href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">Creature::has_effect</a></div><div class="ttdeci">bool has_effect(const efftype_id &amp;eff_id, const bodypart_id &amp;bp) const</div><div class="ttdoc">Check if creature has the matching effect.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01770">creature.cpp:1770</a></div></div>
<div class="ttc" id="aclassCreature_html_a88c28bc08aa3e0d6fa1b187cee97d1c4"><div class="ttname"><a href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">Creature::posz</a></div><div class="ttdeci">int posz() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00317">creature.h:317</a></div></div>
<div class="ttc" id="aclassCreature_html_a891bc2d0c564449cb462178317819254"><div class="ttname"><a href="classCreature.html#a891bc2d0c564449cb462178317819254">Creature::mod_moves</a></div><div class="ttdeci">void mod_moves(int nmoves)</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l02008">creature.cpp:2008</a></div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217">Creature::Attitude</a></div><div class="ttdeci">Attitude</div><div class="ttdoc">Simplified attitude towards any creature: hostile - hate, want to kill, etc.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00352">creature.h:352</a></div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Creature::Attitude::HOSTILE</a></div><div class="ttdeci">@ HOSTILE</div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Creature::Attitude::FRIENDLY</a></div><div class="ttdeci">@ FRIENDLY</div></div>
<div class="ttc" id="aclassCreature_html_a8c5a392caa213bee9581b47e9f0e2052"><div class="ttname"><a href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">Creature::moves</a></div><div class="ttdeci">int moves</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l01193">creature.h:1193</a></div></div>
<div class="ttc" id="aclassCreature_html_a952f5a3103775159e193c6ee4e60979b"><div class="ttname"><a href="classCreature.html#a952f5a3103775159e193c6ee4e60979b">Creature::get_effects_with_flag</a></div><div class="ttdeci">std::vector&lt; std::reference_wrapper&lt; const effect &gt; &gt; get_effects_with_flag(const flag_id &amp;flag) const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01808">creature.cpp:1808</a></div></div>
<div class="ttc" id="aclassCreature_html_a9f0365208b65ab1c45d23f03f402f491"><div class="ttname"><a href="classCreature.html#a9f0365208b65ab1c45d23f03f402f491">Creature::posy</a></div><div class="ttdeci">int posy() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00314">creature.h:314</a></div></div>
<div class="ttc" id="aclassCreature_html_ac16dcdb688f6f47c594c98c83528a670"><div class="ttname"><a href="classCreature.html#ac16dcdb688f6f47c594c98c83528a670">Creature::setpos</a></div><div class="ttdeci">void setpos(const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00188">creature.cpp:188</a></div></div>
<div class="ttc" id="aclassCreature_html_ac209d32cbfd3774af3d5c0500e2fae52"><div class="ttname"><a href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">Creature::is_avatar</a></div><div class="ttdeci">virtual bool is_avatar() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00265">creature.h:265</a></div></div>
<div class="ttc" id="aclassCreature_html_aec78049b0ee4401d3a4c073663735aad"><div class="ttname"><a href="classCreature.html#aec78049b0ee4401d3a4c073663735aad">Creature::has_flag</a></div><div class="ttdeci">virtual bool has_flag(const mon_flag_id &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00752">creature.h:752</a></div></div>
<div class="ttc" id="aclassCreature_html_aecea7d852ffba499ec12350c95340b9d"><div class="ttname"><a href="classCreature.html#aecea7d852ffba499ec12350c95340b9d">Creature::posx</a></div><div class="ttdeci">int posx() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00311">creature.h:311</a></div></div>
<div class="ttc" id="aclassCreature_html_aed84fe52e1335d48d53f482f8a278c87"><div class="ttname"><a href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">Creature::is_npc</a></div><div class="ttdeci">virtual bool is_npc() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00268">creature.h:268</a></div></div>
<div class="ttc" id="aclassCreature_html_af7172e571c5c69240d9f71a01fddf035"><div class="ttname"><a href="classCreature.html#af7172e571c5c69240d9f71a01fddf035">Creature::pos_bub</a></div><div class="ttdeci">tripoint_bub_ms pos_bub() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00183">creature.cpp:183</a></div></div>
<div class="ttc" id="aclassbehavior_1_1monster__oracle__t_html"><div class="ttname"><a href="classbehavior_1_1monster__oracle__t.html">behavior::monster_oracle_t</a></div><div class="ttdef"><b>Definition:</b> <a href="monster__oracle_8h_source.html#l00015">monster_oracle.h:16</a></div></div>
<div class="ttc" id="aclassbehavior_1_1tree_html"><div class="ttname"><a href="classbehavior_1_1tree.html">behavior::tree</a></div><div class="ttdef"><b>Definition:</b> <a href="behavior_8h_source.html#l00044">behavior.h:45</a></div></div>
<div class="ttc" id="aclassbehavior_1_1tree_html_a1bc592e4ec2c37fd3f00388b94de98bb"><div class="ttname"><a href="classbehavior_1_1tree.html#a1bc592e4ec2c37fd3f00388b94de98bb">behavior::tree::tick</a></div><div class="ttdeci">std::string tick(const oracle_t *subject)</div><div class="ttdef"><b>Definition:</b> <a href="behavior_8cpp_source.html#l00088">behavior.cpp:88</a></div></div>
<div class="ttc" id="aclassbehavior_1_1tree_html_a8a804865e2e82225a7e2da417adbd5a4"><div class="ttname"><a href="classbehavior_1_1tree.html#a8a804865e2e82225a7e2da417adbd5a4">behavior::tree::add</a></div><div class="ttdeci">void add(const node_t *new_node)</div><div class="ttdef"><b>Definition:</b> <a href="behavior_8cpp_source.html#l00100">behavior.cpp:100</a></div></div>
<div class="ttc" id="aclassbionic__collection_html"><div class="ttname"><a href="classbionic__collection.html">bionic_collection</a></div><div class="ttdef"><b>Definition:</b> <a href="bionics_8h_source.html#l00266">bionics.h:267</a></div></div>
<div class="ttc" id="aclasscharacter__id_html_a3951155d05523e839d50ea07a8e0b374"><div class="ttname"><a href="classcharacter__id.html#a3951155d05523e839d50ea07a8e0b374">character_id::is_valid</a></div><div class="ttdeci">bool is_valid() const</div><div class="ttdef"><b>Definition:</b> <a href="character__id_8h_source.html#l00017">character_id.h:17</a></div></div>
<div class="ttc" id="aclasscoords_1_1coord__point__mut_html_aa94b8bd33e85ce94a3634e6e27ab0cdd"><div class="ttname"><a href="classcoords_1_1coord__point__mut.html#aa94b8bd33e85ce94a3634e6e27ab0cdd">coords::coord_point_mut::z</a></div><div class="ttdeci">constexpr auto z() const</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00167">coordinates.h:167</a></div></div>
<div class="ttc" id="aclasscoords_1_1coord__point_html"><div class="ttname"><a href="classcoords_1_1coord__point.html">coords::coord_point&lt; tripoint, coords::origin::abs, coords::ms &gt;</a></div></div>
<div class="ttc" id="aclasscoords_1_1coord__point_html_a7b5804160d1d0e69a9f2fba098bea723"><div class="ttname"><a href="classcoords_1_1coord__point.html#a7b5804160d1d0e69a9f2fba098bea723">coords::coord_point::xy</a></div><div class="ttdeci">constexpr auto xy() const</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00273">coordinates.h:273</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html"><div class="ttname"><a href="classcreature__tracker.html">creature_tracker</a></div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8h_source.html#l00024">creature_tracker.h:25</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html_a9790b8a1e05d0c5cff55a8aaeef80d94"><div class="ttname"><a href="classcreature__tracker.html#a9790b8a1e05d0c5cff55a8aaeef80d94">creature_tracker::for_each_reachable</a></div><div class="ttdeci">void for_each_reachable(const Creature &amp;origin, VisitFn &amp;&amp;visit_fn)</div><div class="ttdoc">Visits all reachable creatures using the given functor.</div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8h_source.html#l00218">creature_tracker.h:218</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html_aba3c6663688bcd1806ea685d6961cb72"><div class="ttname"><a href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_tracker::creature_at</a></div><div class="ttdeci">T * creature_at(const tripoint &amp;p, bool allow_hallucination=false)</div><div class="ttdoc">Returns the Creature at the given location.</div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8cpp_source.html#l00303">creature_tracker.cpp:303</a></div></div>
<div class="ttc" id="aclasseffect_html"><div class="ttname"><a href="classeffect.html">effect</a></div><div class="ttdef"><b>Definition:</b> <a href="effect_8h_source.html#l00260">effect.h:261</a></div></div>
<div class="ttc" id="aclassfaction_html"><div class="ttname"><a href="classfaction.html">faction</a></div><div class="ttdef"><b>Definition:</b> <a href="faction_8h_source.html#l00126">faction.h:127</a></div></div>
<div class="ttc" id="aclassfield_html"><div class="ttname"><a href="classfield.html">field</a></div><div class="ttdoc">A variable sized collection of field entries on a given map square.</div><div class="ttdef"><b>Definition:</b> <a href="field_8h_source.html#l00106">field.h:107</a></div></div>
<div class="ttc" id="aclassfield_html_ad45f87597ebb8629628d9f35c238947d"><div class="ttname"><a href="classfield.html#ad45f87597ebb8629628d9f35c238947d">field::find_field</a></div><div class="ttdeci">field_entry * find_field(const field_type_id &amp;field_type_to_find, bool alive_only=true)</div><div class="ttdoc">Returns a field entry corresponding to the field_type_id parameter passed in.</div><div class="ttdef"><b>Definition:</b> <a href="field_8cpp_source.html#l00122">field.cpp:122</a></div></div>
<div class="ttc" id="aclassint__id_html"><div class="ttname"><a href="classint__id.html">int_id&lt; field_type &gt;</a></div></div>
<div class="ttc" id="aclassint__id_html_a4796245d3cd6e0283670698a98d46ae9"><div class="ttname"><a href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">int_id::obj</a></div><div class="ttdeci">const T &amp; obj() const</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00026">ammo_effect.cpp:26</a></div></div>
<div class="ttc" id="aclassmap_html"><div class="ttname"><a href="classmap.html">map</a></div><div class="ttdoc">Manage and cache data about a part of the map.</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00345">map.h:346</a></div></div>
<div class="ttc" id="aclassmap_html_a09ef3e8c2e6664e3ed98d1e1e18a4b4f"><div class="ttname"><a href="classmap.html#a09ef3e8c2e6664e3ed98d1e1e18a4b4f">map::has_flag_furn</a></div><div class="ttdeci">bool has_flag_furn(const std::string &amp;flag, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03112">map.cpp:3112</a></div></div>
<div class="ttc" id="aclassmap_html_a1a80ad5cb3705a2bde8834eb8e4a93bd"><div class="ttname"><a href="classmap.html#a1a80ad5cb3705a2bde8834eb8e4a93bd">map::get_creatures_in_radius</a></div><div class="ttdeci">std::list&lt; Creature * &gt; get_creatures_in_radius(const tripoint &amp;center, size_t radius, size_t radiusz=0) const</div><div class="ttdoc">returns creatures in specified radius</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l10228">map.cpp:10228</a></div></div>
<div class="ttc" id="aclassmap_html_a20933e73f539d62c2a10bed22bb9a0c7"><div class="ttname"><a href="classmap.html#a20933e73f539d62c2a10bed22bb9a0c7">map::furnname</a></div><div class="ttdeci">std::string furnname(const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01888">map.cpp:1888</a></div></div>
<div class="ttc" id="aclassmap_html_a27e22f0999ea03eff18babc48643c568"><div class="ttname"><a href="classmap.html#a27e22f0999ea03eff18babc48643c568">map::has_flag</a></div><div class="ttdeci">bool has_flag(const std::string &amp;flag, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03077">map.cpp:3077</a></div></div>
<div class="ttc" id="aclassmap_html_a30ccb67ed3651d350f2caf214e0b5176"><div class="ttname"><a href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">map::tr_at</a></div><div class="ttdeci">const trap &amp; tr_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06213">map.cpp:6213</a></div></div>
<div class="ttc" id="aclassmap_html_a3188771064ca49d4798c6a80bfad0fcd"><div class="ttname"><a href="classmap.html#a3188771064ca49d4798c6a80bfad0fcd">map::valid_move</a></div><div class="ttdeci">bool valid_move(const tripoint &amp;from, const tripoint &amp;to, bool bash=false, bool flying=false, bool via_ramp=false) const</div><div class="ttdoc">Returns true if a creature could walk from from to to in one step.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02542">map.cpp:2542</a></div></div>
<div class="ttc" id="aclassmap_html_a32a9de57ddea3145ca42e6acfde7f3d6"><div class="ttname"><a href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">map::add_field</a></div><div class="ttdeci">bool add_field(const tripoint &amp;p, const field_type_id &amp;type_id, int intensity=INT_MAX, const time_duration &amp;age=0_turns, bool hit_player=true)</div><div class="ttdoc">Add field entry at point, or set intensity if present.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06563">map.cpp:6563</a></div></div>
<div class="ttc" id="aclassmap_html_a354aefad19d6e0086aa6160a1f45bb1d"><div class="ttname"><a href="classmap.html#a354aefad19d6e0086aa6160a1f45bb1d">map::is_bashable_ter</a></div><div class="ttdeci">bool is_bashable_ter(const tripoint &amp;p, bool allow_floor=false) const</div><div class="ttdoc">Returns true if the terrain at p is bashable.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03260">map.cpp:3260</a></div></div>
<div class="ttc" id="aclassmap_html_a395a729a4b954692cf08d13e1d32f73e"><div class="ttname"><a href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">map::field_at</a></div><div class="ttdeci">const field &amp; field_at(const tripoint &amp;p) const</div><div class="ttdoc">Get the fields that are here.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06379">map.cpp:6379</a></div></div>
<div class="ttc" id="aclassmap_html_a3bc75c8b706a54c1575b4460b2f363b1"><div class="ttname"><a href="classmap.html#a3bc75c8b706a54c1575b4460b2f363b1">map::is_outside</a></div><div class="ttdeci">bool is_outside(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03395">map.cpp:3395</a></div></div>
<div class="ttc" id="aclassmap_html_a3e525fc14178c776d0261cce3efec2a0"><div class="ttname"><a href="classmap.html#a3e525fc14178c776d0261cce3efec2a0">map::has_floor_or_support</a></div><div class="ttdeci">bool has_floor_or_support(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02733">map.cpp:2733</a></div></div>
<div class="ttc" id="aclassmap_html_a426c21f7244ff80a61685a89e9146fec"><div class="ttname"><a href="classmap.html#a426c21f7244ff80a61685a89e9146fec">map::getlocal</a></div><div class="ttdeci">tripoint getlocal(const tripoint &amp;p) const</div><div class="ttdoc">Inverse of getabs.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09635">map.cpp:9635</a></div></div>
<div class="ttc" id="aclassmap_html_a46608709f68358365d0734b1063fed73"><div class="ttname"><a href="classmap.html#a46608709f68358365d0734b1063fed73">map::inbounds</a></div><div class="ttdeci">bool inbounds(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09057">map.cpp:9057</a></div></div>
<div class="ttc" id="aclassmap_html_a49630763b899657bfa7c10586df7d360"><div class="ttname"><a href="classmap.html#a49630763b899657bfa7c10586df7d360">map::clear_path</a></div><div class="ttdeci">bool clear_path(const tripoint &amp;f, const tripoint &amp;t, int range, int cost_min, int cost_max) const</div><div class="ttdoc">Check whether there's a direct line of sight between F and T with the additional movecost restraints.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l07748">map.cpp:7748</a></div></div>
<div class="ttc" id="aclassmap_html_a4f5f812d7e89a998429958573a4c340f"><div class="ttname"><a href="classmap.html#a4f5f812d7e89a998429958573a4c340f">map::points_in_radius</a></div><div class="ttdeci">tripoint_range&lt; tripoint &gt; points_in_radius(const tripoint &amp;center, size_t radius, size_t radiusz=0) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l10109">map.cpp:10109</a></div></div>
<div class="ttc" id="aclassmap_html_a516c0764134cc86b57297811520395f7"><div class="ttname"><a href="classmap.html#a516c0764134cc86b57297811520395f7">map::has_flag_ter_or_furn</a></div><div class="ttdeci">bool has_flag_ter_or_furn(const std::string &amp;flag, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03122">map.cpp:3122</a></div></div>
<div class="ttc" id="aclassmap_html_a5191133cdc235a399330f5e322570401"><div class="ttname"><a href="classmap.html#a5191133cdc235a399330f5e322570401">map::get_inter_level_visibility</a></div><div class="ttdeci">std::bitset&lt; OVERMAP_LAYERS &gt; get_inter_level_visibility(int origin_zlevel) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09397">map.cpp:9397</a></div></div>
<div class="ttc" id="aclassmap_html_a51e32639c8df0c90e0743f929bcf2111"><div class="ttname"><a href="classmap.html#a51e32639c8df0c90e0743f929bcf2111">map::tername</a></div><div class="ttdeci">std::string tername(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02340">map.cpp:2340</a></div></div>
<div class="ttc" id="aclassmap_html_a5579e13088b4ccd9c5a75458919d528a"><div class="ttname"><a href="classmap.html#a5579e13088b4ccd9c5a75458919d528a">map::add_item_or_charges</a></div><div class="ttdeci">item &amp; add_item_or_charges(const tripoint &amp;pos, item obj, bool overflow=true)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l05177">map.cpp:5177</a></div></div>
<div class="ttc" id="aclassmap_html_a5ee9fe3a08892870a0574b8e1ab4e6b0"><div class="ttname"><a href="classmap.html#a5ee9fe3a08892870a0574b8e1ab4e6b0">map::has_vehicle_floor</a></div><div class="ttdeci">bool has_vehicle_floor(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02739">map.cpp:2739</a></div></div>
<div class="ttc" id="aclassmap_html_a61c8a24a2bbd44540d799602f0c49c7e"><div class="ttname"><a href="classmap.html#a61c8a24a2bbd44540d799602f0c49c7e">map::is_bashable_furn</a></div><div class="ttdeci">bool is_bashable_furn(const tripoint &amp;p) const</div><div class="ttdoc">Returns true if the furniture at p is bashable.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03266">map.cpp:3266</a></div></div>
<div class="ttc" id="aclassmap_html_a6c9fdb474119bafd75efa7c12e0bec1a"><div class="ttname"><a href="classmap.html#a6c9fdb474119bafd75efa7c12e0bec1a">map::bash_rating</a></div><div class="ttdeci">int bash_rating(int str, const tripoint &amp;p, bool allow_floor=false) const</div><div class="ttdoc">Returns a success rating from -1 to 10 for a given tile based on a set strength, used for AI movement...</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03304">map.cpp:3304</a></div></div>
<div class="ttc" id="aclassmap_html_a78e0a35a5041e0daf6e7a2a4ec522014"><div class="ttname"><a href="classmap.html#a78e0a35a5041e0daf6e7a2a4ec522014">map::has_floor_or_water</a></div><div class="ttdeci">bool has_floor_or_water(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02703">map.cpp:2703</a></div></div>
<div class="ttc" id="aclassmap_html_a802cc11379d4be61f4e2b13a50f6390e"><div class="ttname"><a href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">map::impassable</a></div><div class="ttdeci">bool impassable(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02462">map.cpp:2462</a></div></div>
<div class="ttc" id="aclassmap_html_a9ac1c68c3941554a86bff27bf1ce2389"><div class="ttname"><a href="classmap.html#a9ac1c68c3941554a86bff27bf1ce2389">map::open_door</a></div><div class="ttdeci">bool open_door(Creature const &amp;u, const tripoint &amp;p, bool inside, bool check_only=false)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l04689">map.cpp:4689</a></div></div>
<div class="ttc" id="aclassmap_html_a9fe6f81443a4ae45012d6e664efb74c2"><div class="ttname"><a href="classmap.html#a9fe6f81443a4ae45012d6e664efb74c2">map::straight_route</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; straight_route(const tripoint &amp;f, const tripoint &amp;t) const</div><div class="ttdef"><b>Definition:</b> <a href="pathfinding_8cpp_source.html#l00167">pathfinding.cpp:167</a></div></div>
<div class="ttc" id="aclassmap_html_aa0e6e89f8f4989c540fefe7bbacfd8ce"><div class="ttname"><a href="classmap.html#aa0e6e89f8f4989c540fefe7bbacfd8ce">map::climb_difficulty</a></div><div class="ttdeci">int climb_difficulty(const tripoint &amp;p) const</div><div class="ttdoc">Checks 3x3 block centered on p for terrain to climb.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02652">map.cpp:2652</a></div></div>
<div class="ttc" id="aclassmap_html_aa487d96256c3d35db7a1bf273156b64a"><div class="ttname"><a href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">map::veh_at</a></div><div class="ttdeci">optional_vpart_position veh_at(const tripoint &amp;p) const</div><div class="ttdoc">Checks if tile is occupied by vehicle and by which part.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01316">map.cpp:1316</a></div></div>
<div class="ttc" id="aclassmap_html_aaa8d85d40512cf240c55a050d8952c2f"><div class="ttname"><a href="classmap.html#aaa8d85d40512cf240c55a050d8952c2f">map::bash</a></div><div class="ttdeci">bash_params bash(const tripoint &amp;p, int str, bool silent=false, bool destroy=false, bool bash_floor=false, const vehicle *bashing_vehicle=nullptr)</div><div class="ttdoc">Returns a pair where first is whether anything was smashed and second is if it was destroyed.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l04292">map.cpp:4292</a></div></div>
<div class="ttc" id="aclassmap_html_ab38205e356b39b5961e0513d45e90170"><div class="ttname"><a href="classmap.html#ab38205e356b39b5961e0513d45e90170">map::obstacle_name</a></div><div class="ttdeci">std::string obstacle_name(const tripoint &amp;p)</div><div class="ttdoc">Returns the name of the obstacle at p that might be blocking movement/projectiles/etc.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01699">map.cpp:1699</a></div></div>
<div class="ttc" id="aclassmap_html_ab687d9988b59167571f5476882b24206"><div class="ttname"><a href="classmap.html#ab687d9988b59167571f5476882b24206">map::is_divable</a></div><div class="ttdeci">bool is_divable(const tripoint &amp;p) const</div><div class="ttdoc">Returns whether or not the terrain at the given location can be dived into (by monsters that can swim...</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03389">map.cpp:3389</a></div></div>
<div class="ttc" id="aclassmap_html_aba8f330c2cc25be0652489b42d8dd530"><div class="ttname"><a href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">map::ter</a></div><div class="ttdeci">ter_id ter(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01922">map.cpp:1922</a></div></div>
<div class="ttc" id="aclassmap_html_abe9e7b93cf8ee15c370ad55c3138c4f6"><div class="ttname"><a href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">map::move_cost</a></div><div class="ttdeci">int move_cost(const tripoint &amp;p, const vehicle *ignored_vehicle=nullptr) const</div><div class="ttdoc">Calculate the cost to move past the tile at p.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02434">map.cpp:2434</a></div></div>
<div class="ttc" id="aclassmap_html_ac868b594b36b6b9bbcb130650fd4f61f"><div class="ttname"><a href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">map::getglobal</a></div><div class="ttdeci">tripoint_abs_ms getglobal(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09625">map.cpp:9625</a></div></div>
<div class="ttc" id="aclassmap_html_acd464679b3bb514e2568ffdb3260ef0c"><div class="ttname"><a href="classmap.html#acd464679b3bb514e2568ffdb3260ef0c">map::route</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; route(const tripoint &amp;f, const tripoint &amp;t, const pathfinding_settings &amp;settings, const std::unordered_set&lt; tripoint &gt; &amp;pre_closed={{ }}) const</div><div class="ttdoc">Calculate the best path using A*.</div><div class="ttdef"><b>Definition:</b> <a href="pathfinding_8cpp_source.html#l00192">pathfinding.cpp:192</a></div></div>
<div class="ttc" id="aclassmap_html_ad11eaa007e285dcfe4c6ffb6f1ce46d3"><div class="ttname"><a href="classmap.html#ad11eaa007e285dcfe4c6ffb6f1ce46d3">map::has_floor</a></div><div class="ttdeci">bool has_floor(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02691">map.cpp:2691</a></div></div>
<div class="ttc" id="aclassmap_html_add9128611766f2a8095b0104f0fd7371"><div class="ttname"><a href="classmap.html#add9128611766f2a8095b0104f0fd7371">map::move_vehicle</a></div><div class="ttdeci">vehicle * move_vehicle(vehicle &amp;veh, const tripoint &amp;dp, const tileray &amp;facing)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00752">map.cpp:752</a></div></div>
<div class="ttc" id="aclassmap_html_ae0dae45aeed1b7221d318c0a36abca5b"><div class="ttname"><a href="classmap.html#ae0dae45aeed1b7221d318c0a36abca5b">map::creature_on_trap</a></div><div class="ttdeci">void creature_on_trap(Creature &amp;critter, bool may_avoid=true) const</div><div class="ttdoc">Apply trap effects to the creature, similar to creature_in_field.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09887">map.cpp:9887</a></div></div>
<div class="ttc" id="aclassmap_html_af0e872a5d0a7bf1e9745aeb18d3b5e44"><div class="ttname"><a href="classmap.html#af0e872a5d0a7bf1e9745aeb18d3b5e44">map::has_flag_ter</a></div><div class="ttdeci">bool has_flag_ter(const std::string &amp;flag, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03107">map.cpp:3107</a></div></div>
<div class="ttc" id="aclassmap_html_af714ce93fc3f45015bdc9cd4d256599f"><div class="ttname"><a href="classmap.html#af714ce93fc3f45015bdc9cd4d256599f">map::find_furnitures_with_flag_in_radius</a></div><div class="ttdeci">std::list&lt; tripoint &gt; find_furnitures_with_flag_in_radius(const tripoint &amp;center, size_t radius, const std::string &amp;flag, size_t radiusz=0) const</div><div class="ttdoc">returns positions of furnitures with matching flag in the specified radius</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l10200">map.cpp:10200</a></div></div>
<div class="ttc" id="aclassmon__special__attack_html"><div class="ttname"><a href="classmon__special__attack.html">mon_special_attack</a></div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00047">monster.h:48</a></div></div>
<div class="ttc" id="aclassmon__special__attack_html_a0f121c831a2ecb77efe06aa048f60e58"><div class="ttname"><a href="classmon__special__attack.html#a0f121c831a2ecb77efe06aa048f60e58">mon_special_attack::cooldown</a></div><div class="ttdeci">int cooldown</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00050">monster.h:50</a></div></div>
<div class="ttc" id="aclassmon__special__attack_html_abbba44d1a5d5d62d696959bab20b8e67"><div class="ttname"><a href="classmon__special__attack.html#abbba44d1a5d5d62d696959bab20b8e67">mon_special_attack::enabled</a></div><div class="ttdeci">bool enabled</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00051">monster.h:51</a></div></div>
<div class="ttc" id="aclassmonster_html"><div class="ttname"><a href="classmonster.html">monster</a></div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00085">monster.h:86</a></div></div>
<div class="ttc" id="aclassmonster_html_a04e580433cf344a504468495ba2d1ee3"><div class="ttname"><a href="classmonster.html#a04e580433cf344a504468495ba2d1ee3">monster::monster_move_in_vehicle</a></div><div class="ttdeci">bool monster_move_in_vehicle(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00135">monmove.cpp:135</a></div></div>
<div class="ttc" id="aclassmonster_html_a0f5047243bc2dc00f32c39b5d0918002"><div class="ttname"><a href="classmonster.html#a0f5047243bc2dc00f32c39b5d0918002">monster::is_fleeing</a></div><div class="ttdeci">bool is_fleeing(Character &amp;u) const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01438">monster.cpp:1438</a></div></div>
<div class="ttc" id="aclassmonster_html_a1045089ac9dd6efe4ce04941f9196398"><div class="ttname"><a href="classmonster.html#a1045089ac9dd6efe4ce04941f9196398">monster::get_dest</a></div><div class="ttdeci">tripoint_abs_ms get_dest() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01375">monster.cpp:1375</a></div></div>
<div class="ttc" id="aclassmonster_html_a125622587c2069dc4dbbe07943c81336"><div class="ttname"><a href="classmonster.html#a125622587c2069dc4dbbe07943c81336">monster::attitude_to</a></div><div class="ttdeci">Attitude attitude_to(const Creature &amp;other) const override</div><div class="ttdoc">Attitude (of this creature) towards another creature.</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01450">monster.cpp:1450</a></div></div>
<div class="ttc" id="aclassmonster_html_a12d0f90c38e7463844592281c87dd250"><div class="ttname"><a href="classmonster.html#a12d0f90c38e7463844592281c87dd250">monster::get_path_avoid</a></div><div class="ttdeci">std::unordered_set&lt; tripoint &gt; get_path_avoid() const override</div><div class="ttdoc">Returns a set of points we do not want to path through.</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l03986">monster.cpp:3986</a></div></div>
<div class="ttc" id="aclassmonster_html_a1488f5a618c74a508fb87b82be05ef11"><div class="ttname"><a href="classmonster.html#a1488f5a618c74a508fb87b82be05ef11">monster::unset_dest</a></div><div class="ttdeci">void unset_dest()</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01388">monster.cpp:1388</a></div></div>
<div class="ttc" id="aclassmonster_html_a14e16a6d2e0a675a85b8794c8f5114cf"><div class="ttname"><a href="classmonster.html#a14e16a6d2e0a675a85b8794c8f5114cf">monster::can_dig</a></div><div class="ttdeci">bool can_dig() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01252">monster.cpp:1252</a></div></div>
<div class="ttc" id="aclassmonster_html_a16052a26adbecf002c5d502660ec7434"><div class="ttname"><a href="classmonster.html#a16052a26adbecf002c5d502660ec7434">monster::find_dragged_foe</a></div><div class="ttdeci">Character * find_dragged_foe()</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01334">monmove.cpp:1334</a></div></div>
<div class="ttc" id="aclassmonster_html_a1a829284017aa69618d25208a53061d1"><div class="ttname"><a href="classmonster.html#a1a829284017aa69618d25208a53061d1">monster::push_to</a></div><div class="ttdeci">bool push_to(const tripoint &amp;p, int boost, size_t depth)</div><div class="ttdoc">Try to push away whatever occupies p, then step in.</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l02094">monmove.cpp:2094</a></div></div>
<div class="ttc" id="aclassmonster_html_a1bfdcc078e39c06a1cf7047803610204"><div class="ttname"><a href="classmonster.html#a1bfdcc078e39c06a1cf7047803610204">monster::has_dest</a></div><div class="ttdeci">bool has_dest() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01370">monster.cpp:1370</a></div></div>
<div class="ttc" id="aclassmonster_html_a1d2c8b9ef1d6562d8b08c9d89e04b5c9"><div class="ttname"><a href="classmonster.html#a1d2c8b9ef1d6562d8b08c9d89e04b5c9">monster::stability_roll</a></div><div class="ttdeci">float stability_roll() const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l02435">monster.cpp:2435</a></div></div>
<div class="ttc" id="aclassmonster_html_a1e799308a5bfe0f6c1f3d47a5c10987a"><div class="ttname"><a href="classmonster.html#a1e799308a5bfe0f6c1f3d47a5c10987a">monster::can_hear</a></div><div class="ttdeci">bool can_hear() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01225">monster.cpp:1225</a></div></div>
<div class="ttc" id="aclassmonster_html_a22061ca6aa966283a748d84ce4352fb4"><div class="ttname"><a href="classmonster.html#a22061ca6aa966283a748d84ce4352fb4">monster::bash_estimate</a></div><div class="ttdeci">int bash_estimate() const</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01719">monmove.cpp:1719</a></div></div>
<div class="ttc" id="aclassmonster_html_a22e929800e08d5458140ec4dbaad53a5"><div class="ttname"><a href="classmonster.html#a22e929800e08d5458140ec4dbaad53a5">monster::digs</a></div><div class="ttdeci">bool digs() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01257">monster.cpp:1257</a></div></div>
<div class="ttc" id="aclassmonster_html_a241bdfccd5d6b2200c0bfd5eca9ce8ab"><div class="ttname"><a href="classmonster.html#a241bdfccd5d6b2200c0bfd5eca9ce8ab">monster::can_move_to</a></div><div class="ttdeci">bool can_move_to(const tripoint &amp;p) const</div><div class="ttdoc">Checks whether we can move to/through p.</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00356">monmove.cpp:356</a></div></div>
<div class="ttc" id="aclassmonster_html_a24bcf1eb9c4beb329036ad01b5f062dd"><div class="ttname"><a href="classmonster.html#a24bcf1eb9c4beb329036ad01b5f062dd">monster::anger_cub_threatened</a></div><div class="ttdeci">void anger_cub_threatened(monster_plan &amp;mon_plan)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00478">monmove.cpp:478</a></div></div>
<div class="ttc" id="aclassmonster_html_a2801a2f23fcaf2199b904c8bbf9fcab0"><div class="ttname"><a href="classmonster.html#a2801a2f23fcaf2199b904c8bbf9fcab0">monster::get_hp</a></div><div class="ttdeci">int get_hp() const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l03748">monster.cpp:3748</a></div></div>
<div class="ttc" id="aclassmonster_html_a28fd163537c2f82c7a733d69c8c8da75"><div class="ttname"><a href="classmonster.html#a28fd163537c2f82c7a733d69c8c8da75">monster::is_pet_follow</a></div><div class="ttdeci">bool is_pet_follow() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01329">monster.cpp:1329</a></div></div>
<div class="ttc" id="aclassmonster_html_a304aeb741c4ac28d879d3951dee4cf30"><div class="ttname"><a href="classmonster.html#a304aeb741c4ac28d879d3951dee4cf30">monster::get_volume</a></div><div class="ttdeci">units::volume get_volume() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l03518">monster.cpp:3518</a></div></div>
<div class="ttc" id="aclassmonster_html_a3078e262a3a130efa9985bfa04a26bd8"><div class="ttname"><a href="classmonster.html#a3078e262a3a130efa9985bfa04a26bd8">monster::nursebot_operate</a></div><div class="ttdeci">void nursebot_operate(Character *dragged_foe)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01357">monmove.cpp:1357</a></div></div>
<div class="ttc" id="aclassmonster_html_a32a4800fc20a7d229c66cce32ce9e417"><div class="ttname"><a href="classmonster.html#a32a4800fc20a7d229c66cce32ce9e417">monster::attack_at</a></div><div class="ttdeci">bool attack_at(const tripoint &amp;p)</div><div class="ttdoc">Attack any enemies at the given location.</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01778">monmove.cpp:1778</a></div></div>
<div class="ttc" id="aclassmonster_html_a3552d13d872776e2201892e3f6480742"><div class="ttname"><a href="classmonster.html#a3552d13d872776e2201892e3f6480742">monster::group_bash_skill</a></div><div class="ttdeci">int group_bash_skill(const tripoint &amp;target)</div><div class="ttdoc">Returns ability of monster and any cooperative helpers to bash the designated target.</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01735">monmove.cpp:1735</a></div></div>
<div class="ttc" id="aclassmonster_html_a3971d4421cdc9f956213c9aef2ff9ae3"><div class="ttname"><a href="classmonster.html#a3971d4421cdc9f956213c9aef2ff9ae3">monster::can_reach_to</a></div><div class="ttdeci">bool can_reach_to(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00330">monmove.cpp:330</a></div></div>
<div class="ttc" id="aclassmonster_html_a3ff46700c4e8b9527cb331151d7b7c26"><div class="ttname"><a href="classmonster.html#a3ff46700c4e8b9527cb331151d7b7c26">monster::movement_impaired</a></div><div class="ttdeci">bool movement_impaired()</div><div class="ttdoc">Returns true if the monster has its movement impaired.</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l02200">monster.cpp:2200</a></div></div>
<div class="ttc" id="aclassmonster_html_a43202b3e829143741862e0f5f1e826a7"><div class="ttname"><a href="classmonster.html#a43202b3e829143741862e0f5f1e826a7">monster::has_flag</a></div><div class="ttdeci">bool has_flag(const mon_flag_id &amp;f) const final</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01202">monster.cpp:1202</a></div></div>
<div class="ttc" id="aclassmonster_html_a463ca0ea362cc5ea7b3b9a808c0de85c"><div class="ttname"><a href="classmonster.html#a463ca0ea362cc5ea7b3b9a808c0de85c">monster::is_immune_field</a></div><div class="ttdeci">bool is_immune_field(const field_type_id &amp;fid) const override</div><div class="ttdoc">Returns true if we are immune to the field type with the given fid.</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00093">monmove.cpp:93</a></div></div>
<div class="ttc" id="aclassmonster_html_a49eaa3645377b9873ceefc3418c34e82"><div class="ttname"><a href="classmonster.html#a49eaa3645377b9873ceefc3418c34e82">monster::anger_hostile_seen</a></div><div class="ttdeci">void anger_hostile_seen(const monster_plan &amp;mon_plan)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00446">monmove.cpp:446</a></div></div>
<div class="ttc" id="aclassmonster_html_a4be04fecf05b13bc290b5b1dcc6b9137"><div class="ttname"><a href="classmonster.html#a4be04fecf05b13bc290b5b1dcc6b9137">monster::swims</a></div><div class="ttdeci">bool swims() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01272">monster.cpp:1272</a></div></div>
<div class="ttc" id="aclassmonster_html_a4e17d0d504a12d9b2e4de3e7a7503fff"><div class="ttname"><a href="classmonster.html#a4e17d0d504a12d9b2e4de3e7a7503fff">monster::friendly</a></div><div class="ttdeci">int friendly</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00539">monster.h:539</a></div></div>
<div class="ttc" id="aclassmonster_html_a504851437db082b0c62e50ff48ec08fb"><div class="ttname"><a href="classmonster.html#a504851437db082b0c62e50ff48ec08fb">monster::reset_pathfinding_cd</a></div><div class="ttdeci">void reset_pathfinding_cd()</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00641">monster.h:641</a></div></div>
<div class="ttc" id="aclassmonster_html_a55fd0614c264b7e89a5735270ff6d2c7"><div class="ttname"><a href="classmonster.html#a55fd0614c264b7e89a5735270ff6d2c7">monster::can_submerge</a></div><div class="ttdeci">bool can_submerge() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01230">monster.cpp:1230</a></div></div>
<div class="ttc" id="aclassmonster_html_a56a49e970812e2317cc67035c33fa96f"><div class="ttname"><a href="classmonster.html#a56a49e970812e2317cc67035c33fa96f">monster::wander_pos</a></div><div class="ttdeci">tripoint_abs_ms wander_pos</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00521">monster.h:521</a></div></div>
<div class="ttc" id="aclassmonster_html_a59dab0b0d7e791038c18d01277393686"><div class="ttname"><a href="classmonster.html#a59dab0b0d7e791038c18d01277393686">monster::set_dest</a></div><div class="ttdeci">void set_dest(const tripoint_abs_ms &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01380">monster.cpp:1380</a></div></div>
<div class="ttc" id="aclassmonster_html_a60ae9c29710c56417f769dea8381becf"><div class="ttname"><a href="classmonster.html#a60ae9c29710c56417f769dea8381becf">monster::reset_special</a></div><div class="ttdeci">void reset_special(const std::string &amp;special_name)</div><div class="ttdoc">Resets a given special to its monster type cooldown value.</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l02586">monster.cpp:2586</a></div></div>
<div class="ttc" id="aclassmonster_html_a6adba28c21a8b6e6cc1b81f2f31d1947"><div class="ttname"><a href="classmonster.html#a6adba28c21a8b6e6cc1b81f2f31d1947">monster::stumble</a></div><div class="ttdeci">void stumble()</div><div class="ttdoc">Stumble in a random direction, but with some caveats.</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l02233">monmove.cpp:2233</a></div></div>
<div class="ttc" id="aclassmonster_html_a6e03e18c6ea5e5adb496634b2bbaea52"><div class="ttname"><a href="classmonster.html#a6e03e18c6ea5e5adb496634b2bbaea52">monster::made_of</a></div><div class="ttdeci">bool made_of(const material_id &amp;m) const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01304">monster.cpp:1304</a></div></div>
<div class="ttc" id="aclassmonster_html_a6f9b80e613e46d2a7ebbb21ea5e11e4c"><div class="ttname"><a href="classmonster.html#a6f9b80e613e46d2a7ebbb21ea5e11e4c">monster::attitude</a></div><div class="ttdeci">monster_attitude attitude(const Character *u=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01496">monster.cpp:1496</a></div></div>
<div class="ttc" id="aclassmonster_html_a70c250ac59c7d91b374dfa5d7b8da66c"><div class="ttname"><a href="classmonster.html#a70c250ac59c7d91b374dfa5d7b8da66c">monster::is_hallucination</a></div><div class="ttdeci">bool is_hallucination() const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l03460">monster.cpp:3460</a></div></div>
<div class="ttc" id="aclassmonster_html_a712aeab26697f5ede4eab4eacdc71c8a"><div class="ttname"><a href="classmonster.html#a712aeab26697f5ede4eab4eacdc71c8a">monster::melee_attack</a></div><div class="ttdeci">bool melee_attack(Creature &amp;target)</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01898">monster.cpp:1898</a></div></div>
<div class="ttc" id="aclassmonster_html_a71b5a8e94a71255502dfd413e135d301"><div class="ttname"><a href="classmonster.html#a71b5a8e94a71255502dfd413e135d301">monster::increment_pathfinding_cd</a></div><div class="ttdeci">void increment_pathfinding_cd()</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00645">monster.h:645</a></div></div>
<div class="ttc" id="aclassmonster_html_a73aa45942033a7c02529df8ab4b229af"><div class="ttname"><a href="classmonster.html#a73aa45942033a7c02529df8ab4b229af">monster::will_reach</a></div><div class="ttdeci">bool will_reach(const point &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l02361">monmove.cpp:2361</a></div></div>
<div class="ttc" id="aclassmonster_html_a740a0ee7c4c9baa7150fc8b0d0e5d237"><div class="ttname"><a href="classmonster.html#a740a0ee7c4c9baa7150fc8b0d0e5d237">monster::anger_mating_season</a></div><div class="ttdeci">void anger_mating_season(const monster_plan &amp;mon_plan)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00465">monmove.cpp:465</a></div></div>
<div class="ttc" id="aclassmonster_html_a7410372f55ca62ae5eda0fcc63b48622"><div class="ttname"><a href="classmonster.html#a7410372f55ca62ae5eda0fcc63b48622">monster::bash_skill</a></div><div class="ttdeci">int bash_skill() const</div><div class="ttdoc">Returns innate monster bash skill, without calculating additional from helpers.</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01730">monmove.cpp:1730</a></div></div>
<div class="ttc" id="aclassmonster_html_a7577aacda4ad32c8ce9e443cceec0a1a"><div class="ttname"><a href="classmonster.html#a7577aacda4ad32c8ce9e443cceec0a1a">monster::plan</a></div><div class="ttdeci">void plan()</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00517">monmove.cpp:517</a></div></div>
<div class="ttc" id="aclassmonster_html_a790b213f8c42018dba14f5358644226f"><div class="ttname"><a href="classmonster.html#a790b213f8c42018dba14f5358644226f">monster::provocative_sound</a></div><div class="ttdeci">bool provocative_sound</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00522">monster.h:522</a></div></div>
<div class="ttc" id="aclassmonster_html_a79c1aef59cccba881fc60e52fb6d8cb9"><div class="ttname"><a href="classmonster.html#a79c1aef59cccba881fc60e52fb6d8cb9">monster::can_see</a></div><div class="ttdeci">bool can_see() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01220">monster.cpp:1220</a></div></div>
<div class="ttc" id="aclassmonster_html_a7b22fe8719e4783fe1896429cedefa8d"><div class="ttname"><a href="classmonster.html#a7b22fe8719e4783fe1896429cedefa8d">monster::anger</a></div><div class="ttdeci">int anger</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00540">monster.h:540</a></div></div>
<div class="ttc" id="aclassmonster_html_a7cb9d9786d11c2c0926d3482d3f51ffe"><div class="ttname"><a href="classmonster.html#a7cb9d9786d11c2c0926d3482d3f51ffe">monster::name</a></div><div class="ttdeci">std::string name(unsigned int quantity=1) const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l00722">monster.cpp:722</a></div></div>
<div class="ttc" id="aclassmonster_html_a7d8135ba3578b7ad43d4e7b5acc9269d"><div class="ttname"><a href="classmonster.html#a7d8135ba3578b7ad43d4e7b5acc9269d">monster::will_move_to</a></div><div class="ttdeci">bool will_move_to(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00193">monmove.cpp:193</a></div></div>
<div class="ttc" id="aclassmonster_html_a82ae41773b05af94d4b678cb33bfb329"><div class="ttname"><a href="classmonster.html#a82ae41773b05af94d4b678cb33bfb329">monster::die</a></div><div class="ttdeci">void die(Creature *killer) override</div><div class="ttdoc">Empty function.</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l02742">monster.cpp:2742</a></div></div>
<div class="ttc" id="aclassmonster_html_a873925c09bec361ffd2363626828a362"><div class="ttname"><a href="classmonster.html#a873925c09bec361ffd2363626828a362">monster::get_pathfinding_settings</a></div><div class="ttdeci">const pathfinding_settings &amp; get_pathfinding_settings() const override</div><div class="ttdoc">Returns settings for pathfinding.</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l03981">monster.cpp:3981</a></div></div>
<div class="ttc" id="aclassmonster_html_a88c30bfeb57c6d44b965f92265fc16d2"><div class="ttname"><a href="classmonster.html#a88c30bfeb57c6d44b965f92265fc16d2">monster::wandf</a></div><div class="ttdeci">int wandf</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00523">monster.h:523</a></div></div>
<div class="ttc" id="aclassmonster_html_a8e30fdb59bcecd8ecb8a609431cb6caf"><div class="ttname"><a href="classmonster.html#a8e30fdb59bcecd8ecb8a609431cb6caf">monster::faction</a></div><div class="ttdeci">mfaction_id faction</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00545">monster.h:545</a></div></div>
<div class="ttc" id="aclassmonster_html_a9118d0de36f4dbb72c28cc0832bba897"><div class="ttname"><a href="classmonster.html#a9118d0de36f4dbb72c28cc0832bba897">monster::die_if_drowning</a></div><div class="ttdeci">bool die_if_drowning(const tripoint &amp;at_pos, int chance=1)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00849">monmove.cpp:849</a></div></div>
<div class="ttc" id="aclassmonster_html_a939eb403e417f4b0c032e827fecc9ab3"><div class="ttname"><a href="classmonster.html#a939eb403e417f4b0c032e827fecc9ab3">monster::special_attacks</a></div><div class="ttdeci">std::map&lt; std::string, mon_special_attack, std::less&lt;&gt; &gt; special_attacks</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00617">monster.h:617</a></div></div>
<div class="ttc" id="aclassmonster_html_a9653c5f9353177ecee5aff0197af2fcc"><div class="ttname"><a href="classmonster.html#a9653c5f9353177ecee5aff0197af2fcc">monster::turns_since_target</a></div><div class="ttdeci">int turns_since_target</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00655">monster.h:655</a></div></div>
<div class="ttc" id="aclassmonster_html_a98cfa6c825f373b60a0a4021a8dbf750"><div class="ttname"><a href="classmonster.html#a98cfa6c825f373b60a0a4021a8dbf750">monster::calc_movecost</a></div><div class="ttdeci">int calc_movecost(const tripoint &amp;f, const tripoint &amp;t) const</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01575">monmove.cpp:1575</a></div></div>
<div class="ttc" id="aclassmonster_html_a9ddaee6769a480c655bdbc09e4086040"><div class="ttname"><a href="classmonster.html#a9ddaee6769a480c655bdbc09e4086040">monster::mating_angry</a></div><div class="ttdeci">bool mating_angry() const</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00501">monmove.cpp:501</a></div></div>
<div class="ttc" id="aclassmonster_html_aa162caeeef96c7c0aecca97871435d71"><div class="ttname"><a href="classmonster.html#aa162caeeef96c7c0aecca97871435d71">monster::path</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; path</div><div class="ttdoc">Found path.</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00632">monster.h:632</a></div></div>
<div class="ttc" id="aclassmonster_html_aa25af680aabcc13beba81f0d5410d2ff"><div class="ttname"><a href="classmonster.html#aa25af680aabcc13beba81f0d5410d2ff">monster::morale</a></div><div class="ttdeci">int morale</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00541">monster.h:541</a></div></div>
<div class="ttc" id="aclassmonster_html_aa30f973bf524ba275ada847f6118b048"><div class="ttname"><a href="classmonster.html#aa30f973bf524ba275ada847f6118b048">monster::type</a></div><div class="ttdeci">const mtype * type</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00550">monster.h:550</a></div></div>
<div class="ttc" id="aclassmonster_html_aa411814aee066a5e242f51efe6daec65"><div class="ttname"><a href="classmonster.html#aa411814aee066a5e242f51efe6daec65">monster::turns_to_reach</a></div><div class="ttdeci">int turns_to_reach(const point &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l02399">monmove.cpp:2399</a></div></div>
<div class="ttc" id="aclassmonster_html_aa5740a03294bcab8ef209151af709c4c"><div class="ttname"><a href="classmonster.html#aa5740a03294bcab8ef209151af709c4c">monster::ammo</a></div><div class="ttdeci">std::map&lt; itype_id, int &gt; ammo</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00582">monster.h:582</a></div></div>
<div class="ttc" id="aclassmonster_html_aa58e9ab3e08e72fd37c757b761d2671c"><div class="ttname"><a href="classmonster.html#aa58e9ab3e08e72fd37c757b761d2671c">monster::is_wandering</a></div><div class="ttdeci">bool is_wandering() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01394">monster.cpp:1394</a></div></div>
<div class="ttc" id="aclassmonster_html_aa6c57b6cbf413727ea33c467f2bc886b"><div class="ttname"><a href="classmonster.html#aa6c57b6cbf413727ea33c467f2bc886b">monster::knock_back_to</a></div><div class="ttdeci">void knock_back_to(const tripoint &amp;to) override</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l02280">monmove.cpp:2280</a></div></div>
<div class="ttc" id="aclassmonster_html_aac5e0ccac0ace79a458f219f8778f223"><div class="ttname"><a href="classmonster.html#aac5e0ccac0ace79a458f219f8778f223">monster::rate_target</a></div><div class="ttdeci">float rate_target(Creature &amp;c, float best, bool smart=false) const</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00361">monmove.cpp:361</a></div></div>
<div class="ttc" id="aclassmonster_html_aaed6da4f001755d7fdd7ea56df8ac44d"><div class="ttname"><a href="classmonster.html#aaed6da4f001755d7fdd7ea56df8ac44d">monster::move_effects</a></div><div class="ttdeci">bool move_effects(bool attacking) override</div><div class="ttdoc">Processes effects which may prevent the monster from moving (bear traps, crushed, etc....</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l02205">monster.cpp:2205</a></div></div>
<div class="ttc" id="aclassmonster_html_ab00d759ebe29170bf2a166dd155bfeb2"><div class="ttname"><a href="classmonster.html#ab00d759ebe29170bf2a166dd155bfeb2">monster::dragged_foe_id</a></div><div class="ttdeci">character_id dragged_foe_id</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00528">monster.h:528</a></div></div>
<div class="ttc" id="aclassmonster_html_ab0adc4673278e497b75a357040ce2739"><div class="ttname"><a href="classmonster.html#ab0adc4673278e497b75a357040ce2739">monster::made_footstep</a></div><div class="ttdeci">bool made_footstep</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00560">monster.h:560</a></div></div>
<div class="ttc" id="aclassmonster_html_ab370bb6801a47533c44b28894f910702"><div class="ttname"><a href="classmonster.html#ab370bb6801a47533c44b28894f910702">monster::calc_climb_cost</a></div><div class="ttdeci">int calc_climb_cost(const tripoint &amp;f, const tripoint &amp;t) const</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01629">monmove.cpp:1629</a></div></div>
<div class="ttc" id="aclassmonster_html_ab3c07bd4cb325287741fa2e561168e56"><div class="ttname"><a href="classmonster.html#ab3c07bd4cb325287741fa2e561168e56">monster::move_to</a></div><div class="ttdeci">bool move_to(const tripoint &amp;p, bool force=false, bool step_on_critter=false, float stagger_adjustment=1.0)</div><div class="ttdoc">Attempt to move to p.</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01852">monmove.cpp:1852</a></div></div>
<div class="ttc" id="aclassmonster_html_ab55cbaa78e9a77935dfc63e5c292317b"><div class="ttname"><a href="classmonster.html#ab55cbaa78e9a77935dfc63e5c292317b">monster::get_armor_type</a></div><div class="ttdeci">int get_armor_type(const damage_type_id &amp;dt, bodypart_id bp) const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l02405">monster.cpp:2405</a></div></div>
<div class="ttc" id="aclassmonster_html_ab7f8b49829445e6663e273473841fc22"><div class="ttname"><a href="classmonster.html#ab7f8b49829445e6663e273473841fc22">monster::footsteps</a></div><div class="ttdeci">void footsteps(const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01428">monmove.cpp:1428</a></div></div>
<div class="ttc" id="aclassmonster_html_ab80f9246aad2b3c22becee9f34dc17d8"><div class="ttname"><a href="classmonster.html#ab80f9246aad2b3c22becee9f34dc17d8">monster::aggro_character</a></div><div class="ttdeci">bool aggro_character</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00572">monster.h:572</a></div></div>
<div class="ttc" id="aclassmonster_html_ab9288bd726bcf264e3626dfbb7a01e25"><div class="ttname"><a href="classmonster.html#ab9288bd726bcf264e3626dfbb7a01e25">monster::climbs</a></div><div class="ttdeci">bool climbs() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01267">monster.cpp:1267</a></div></div>
<div class="ttc" id="aclassmonster_html_ab92cac0ecb2b2062fd4f821b671f86ac"><div class="ttname"><a href="classmonster.html#ab92cac0ecb2b2062fd4f821b671f86ac">monster::get_size</a></div><div class="ttdeci">creature_size get_size() const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l03503">monster.cpp:3503</a></div></div>
<div class="ttc" id="aclassmonster_html_abca4913777aa7ed67c109de4b667ed54"><div class="ttname"><a href="classmonster.html#abca4913777aa7ed67c109de4b667ed54">monster::can_climb</a></div><div class="ttdeci">bool can_climb() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01242">monster.cpp:1242</a></div></div>
<div class="ttc" id="aclassmonster_html_abeb3743ffee119ce1507af082bb5a0e0"><div class="ttname"><a href="classmonster.html#abeb3743ffee119ce1507af082bb5a0e0">monster::next_patrol_point</a></div><div class="ttdeci">int next_patrol_point</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00652">monster.h:652</a></div></div>
<div class="ttc" id="aclassmonster_html_abfa82509ae31b5201072274dc6b9c407"><div class="ttname"><a href="classmonster.html#abfa82509ae31b5201072274dc6b9c407">monster::bash_at</a></div><div class="ttdeci">bool bash_at(const tripoint &amp;p)</div><div class="ttdoc">Try to smash/bash/destroy your way through the terrain at p.</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01676">monmove.cpp:1676</a></div></div>
<div class="ttc" id="aclassmonster_html_ac0c29edb1633fd1090a0a5ff3efa3fe3"><div class="ttname"><a href="classmonster.html#ac0c29edb1633fd1090a0a5ff3efa3fe3">monster::know_danger_at</a></div><div class="ttdeci">bool know_danger_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00237">monmove.cpp:237</a></div></div>
<div class="ttc" id="aclassmonster_html_ac654df3156626ea7e474365b5fd0056e"><div class="ttname"><a href="classmonster.html#ac654df3156626ea7e474365b5fd0056e">monster::can_drown</a></div><div class="ttdeci">bool can_drown() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01236">monster.cpp:1236</a></div></div>
<div class="ttc" id="aclassmonster_html_ace81cf5d7ddd0385d3cf2e66d4c47ff7"><div class="ttname"><a href="classmonster.html#ace81cf5d7ddd0385d3cf2e66d4c47ff7">monster::scent_move</a></div><div class="ttdeci">tripoint scent_move()</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01475">monmove.cpp:1475</a></div></div>
<div class="ttc" id="aclassmonster_html_ad0f32b1f18afffaa98c73767eb059ec9"><div class="ttname"><a href="classmonster.html#ad0f32b1f18afffaa98c73767eb059ec9">monster::has_intelligence</a></div><div class="ttdeci">bool has_intelligence() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01334">monster.cpp:1334</a></div></div>
<div class="ttc" id="aclassmonster_html_ad18dfb6454b3ce4172d476af3a042f4b"><div class="ttname"><a href="classmonster.html#ad18dfb6454b3ce4172d476af3a042f4b">monster::shove_vehicle</a></div><div class="ttdeci">void shove_vehicle(const tripoint &amp;remote_destination, const tripoint &amp;nearby_destination)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l02425">monmove.cpp:2425</a></div></div>
<div class="ttc" id="aclassmonster_html_adbc2b2a9fe75356ff70d4c6ec64eb0b5"><div class="ttname"><a href="classmonster.html#adbc2b2a9fe75356ff70d4c6ec64eb0b5">monster::move</a></div><div class="ttdeci">void move()</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00865">monmove.cpp:865</a></div></div>
<div class="ttc" id="aclassmonster_html_ae4ddfd29306c2e768f545aed901be3f9"><div class="ttname"><a href="classmonster.html#ae4ddfd29306c2e768f545aed901be3f9">monster::patrol_route</a></div><div class="ttdeci">std::vector&lt; tripoint_abs_ms &gt; patrol_route</div><div class="ttdoc">patrol points for monsters that can pathfind and have a patrol route!</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00651">monster.h:651</a></div></div>
<div class="ttc" id="aclassmonster_html_aedaf54c4048d596420fae0d32bb1f586"><div class="ttname"><a href="classmonster.html#aedaf54c4048d596420fae0d32bb1f586">monster::flies</a></div><div class="ttdeci">bool flies() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01262">monster.cpp:1262</a></div></div>
<div class="ttc" id="aclassmonster_html_aee5ef0428af50c1c78fd68d8c92c98a5"><div class="ttname"><a href="classmonster.html#aee5ef0428af50c1c78fd68d8c92c98a5">monster::is_aquatic_danger</a></div><div class="ttdeci">bool is_aquatic_danger(const tripoint &amp;at_pos) const</div><div class="ttdoc">Returns true if the given square presents a possibility of drowning for the monster: it's deep water,...</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00841">monmove.cpp:841</a></div></div>
<div class="ttc" id="aclassmonster_html_af033816139df1dfa154c27b199b51da6"><div class="ttname"><a href="classmonster.html#af033816139df1dfa154c27b199b51da6">monster::is_dead</a></div><div class="ttdeci">bool is_dead() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l03580">monster.cpp:3580</a></div></div>
<div class="ttc" id="aclassmonster_html_af3444e4763b1dd53e75c5ea50fd8ba9f"><div class="ttname"><a href="classmonster.html#af3444e4763b1dd53e75c5ea50fd8ba9f">monster::disp_name</a></div><div class="ttdeci">std::string disp_name(bool possessive=false, bool capitalize_first=false) const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l00775">monster.cpp:775</a></div></div>
<div class="ttc" id="aclassmonster_html_af35316ade396ac63cf5655105a420dbb"><div class="ttname"><a href="classmonster.html#af35316ade396ac63cf5655105a420dbb">monster::can_pathfind</a></div><div class="ttdeci">bool can_pathfind() const</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00638">monster.h:638</a></div></div>
<div class="ttc" id="aclassmonster_html_af705eea6e40e12d7866010955602c7b5"><div class="ttname"><a href="classmonster.html#af705eea6e40e12d7866010955602c7b5">monster::digging</a></div><div class="ttdeci">bool digging() const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01247">monster.cpp:1247</a></div></div>
<div class="ttc" id="aclassmonster_html_afc6e6f5443145732310dd4901a394b4f"><div class="ttname"><a href="classmonster.html#afc6e6f5443145732310dd4901a394b4f">monster::apply_damage</a></div><div class="ttdeci">void apply_damage(Creature *source, bodypart_id bp, int dam, bool bypass_med=false) override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l02169">monster.cpp:2169</a></div></div>
<div class="ttc" id="aclassnpc_html"><div class="ttname"><a href="classnpc.html">npc</a></div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00791">npc.h:792</a></div></div>
<div class="ttc" id="aclassnpc_html_a965eb2beb1c490bb1b8efef1c07e20d0"><div class="ttname"><a href="classnpc.html#a965eb2beb1c490bb1b8efef1c07e20d0">npc::on_attacked</a></div><div class="ttdeci">void on_attacked(const Creature &amp;attacker)</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l01650">npc.cpp:1650</a></div></div>
<div class="ttc" id="aclassoptional__vpart__position_html"><div class="ttname"><a href="classoptional__vpart__position.html">optional_vpart_position</a></div><div class="ttdoc">Simple wrapper to forward functions that may return a std::optional to vpart_position.</div><div class="ttdef"><b>Definition:</b> <a href="vpart__position_8h_source.html#l00124">vpart_position.h:125</a></div></div>
<div class="ttc" id="aclassoptional__vpart__position_html_a01c74b1b54254d2948d47b234ba675b2"><div class="ttname"><a href="classoptional__vpart__position.html#a01c74b1b54254d2948d47b234ba675b2">optional_vpart_position::obstacle_at_part</a></div><div class="ttdeci">std::optional&lt; vpart_reference &gt; obstacle_at_part() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l02727">vehicle.cpp:2727</a></div></div>
<div class="ttc" id="aclassoptional__vpart__position_html_a4c78451e42e97753079ecd2a54c7143d"><div class="ttname"><a href="classoptional__vpart__position.html#a4c78451e42e97753079ecd2a54c7143d">optional_vpart_position::part_with_feature</a></div><div class="ttdeci">std::optional&lt; vpart_reference &gt; part_with_feature(const std::string &amp;f, bool unbroken) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l02698">vehicle.cpp:2698</a></div></div>
<div class="ttc" id="aclassscent__map_html"><div class="ttname"><a href="classscent__map.html">scent_map</a></div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8h_source.html#l00044">scent_map.h:45</a></div></div>
<div class="ttc" id="aclassscent__map_html_a55c51947e481f387010888565ec7ba7c"><div class="ttname"><a href="classscent__map.html#a55c51947e481f387010888565ec7ba7c">scent_map::get_unsafe</a></div><div class="ttdeci">int get_unsafe(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8cpp_source.html#l00117">scent_map.cpp:117</a></div></div>
<div class="ttc" id="aclassscent__map_html_a781c9a7c953f40d3027c3e3a36446ff3"><div class="ttname"><a href="classscent__map.html#a781c9a7c953f40d3027c3e3a36446ff3">scent_map::get_type</a></div><div class="ttdeci">scenttype_id get_type() const</div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8cpp_source.html#l00122">scent_map.cpp:122</a></div></div>
<div class="ttc" id="aclassscent__map_html_a99aff3e6d8963d7f34618216a8448c8c"><div class="ttname"><a href="classscent__map.html#a99aff3e6d8963d7f34618216a8448c8c">scent_map::get</a></div><div class="ttdeci">int get(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8cpp_source.html#l00095">scent_map.cpp:95</a></div></div>
<div class="ttc" id="aclassscent__map_html_af8194e788fb41147bd4c95dbf09b95fb"><div class="ttname"><a href="classscent__map.html#af8194e788fb41147bd4c95dbf09b95fb">scent_map::inbounds</a></div><div class="ttdeci">bool inbounds(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8cpp_source.html#l00136">scent_map.cpp:136</a></div></div>
<div class="ttc" id="aclassscent__type_html_aa9c81f6208c954f5264ff20e48d4082a"><div class="ttname"><a href="classscent__type.html#aa9c81f6208c954f5264ff20e48d4082a">scent_type::receptive_species</a></div><div class="ttdeci">std::set&lt; species_id &gt; receptive_species</div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8h_source.html#l00040">scent_map.h:40</a></div></div>
<div class="ttc" id="aclassstring__id_html"><div class="ttname"><a href="classstring__id.html">string_id&lt; damage_type &gt;</a></div></div>
<div class="ttc" id="aclassstring__id_html_ac180a60056901aaf79f5c4b728a257bd"><div class="ttname"><a href="classstring__id.html#ac180a60056901aaf79f5c4b728a257bd">string_id::is_empty</a></div><div class="ttdeci">bool is_empty() const</div><div class="ttdoc">Returns whether this id is empty.</div><div class="ttdef"><b>Definition:</b> <a href="string__id_8h_source.html#l00303">string_id.h:303</a></div></div>
<div class="ttc" id="aclasstileray_html"><div class="ttname"><a href="classtileray.html">tileray</a></div><div class="ttdef"><b>Definition:</b> <a href="tileray_8h_source.html#l00028">tileray.h:29</a></div></div>
<div class="ttc" id="aclasstime__duration_html_a0f7145f4fc4c09defbaf25f468e4e54a"><div class="ttname"><a href="classtime__duration.html#a0f7145f4fc4c09defbaf25f468e4e54a">time_duration::from_turns</a></div><div class="ttdeci">static constexpr time_duration from_turns(const T t)</div><div class="ttdoc">Named constructors to get a duration representing a multiple of the named time units.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00221">calendar.h:221</a></div></div>
<div class="ttc" id="aclassunits_1_1quantity_html"><div class="ttname"><a href="classunits_1_1quantity.html">units::quantity</a></div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00028">units.h:29</a></div></div>
<div class="ttc" id="aclassvehicle__stack_html"><div class="ttname"><a href="classvehicle__stack.html">vehicle_stack</a></div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00173">vehicle.h:174</a></div></div>
<div class="ttc" id="aclassvehicle_html"><div class="ttname"><a href="classvehicle.html">vehicle</a></div><div class="ttdoc">A vehicle as a whole with all its components.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00801">vehicle.h:802</a></div></div>
<div class="ttc" id="aclassvehicle_html_a1f80b26dc4684734f1a903605f3cd4a3"><div class="ttname"><a href="classvehicle.html#a1f80b26dc4684734f1a903605f3cd4a3">vehicle::vehicle</a></div><div class="ttdeci">vehicle(const vproto_id &amp;proto_id)</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l00214">vehicle.cpp:214</a></div></div>
<div class="ttc" id="aclassvehicle_html_a320ca34b5c38568efd801731cef78a35"><div class="ttname"><a href="classvehicle.html#a320ca34b5c38568efd801731cef78a35">vehicle::skidding</a></div><div class="ttdeci">bool skidding</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l02363">vehicle.h:2363</a></div></div>
<div class="ttc" id="aclassvehicle_html_a38ba5bdc99241568c83ada974ed73e07"><div class="ttname"><a href="classvehicle.html#a38ba5bdc99241568c83ada974ed73e07">vehicle::get_parts_at</a></div><div class="ttdeci">std::vector&lt; vehicle_part * &gt; get_parts_at(const tripoint &amp;pos, const std::string &amp;flag, part_status_flag condition)</div><div class="ttdoc">Get all enabled, available, unbroken vehicle parts at specified position.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l02855">vehicle.cpp:2855</a></div></div>
<div class="ttc" id="aclassvehicle_html_a416a2bc9ee792663fced3344db322cb8"><div class="ttname"><a href="classvehicle.html#a416a2bc9ee792663fced3344db322cb8">vehicle::vertical_velocity</a></div><div class="ttdeci">int vertical_velocity</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l02286">vehicle.h:2286</a></div></div>
<div class="ttc" id="aclassvehicle_html_a4d83e86fe57ec6126893a68f68c3c304"><div class="ttname"><a href="classvehicle.html#a4d83e86fe57ec6126893a68f68c3c304">vehicle::velocity</a></div><div class="ttdeci">int velocity</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l02276">vehicle.h:2276</a></div></div>
<div class="ttc" id="aclassvehicle_html_a5a7d83716bf73d4b58d265b626872d01"><div class="ttname"><a href="classvehicle.html#a5a7d83716bf73d4b58d265b626872d01">vehicle::total_mass</a></div><div class="ttdeci">units::mass total_mass() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l03472">vehicle.cpp:3472</a></div></div>
<div class="ttc" id="aclassvehicle_html_a8b023391122d88cc354e7fca903cec54"><div class="ttname"><a href="classvehicle.html#a8b023391122d88cc354e7fca903cec54">vehicle::smash</a></div><div class="ttdeci">void smash(map &amp;m, float hp_percent_loss_min=0.1f, float hp_percent_loss_max=1.2f, float percent_of_parts_to_affect=1.0f, point damage_origin=point_zero, float damage_size=0)</div><div class="ttdoc">Smashes up a vehicle that has already been placed; used for generating very damaged vehicles.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l00863">vehicle.cpp:863</a></div></div>
<div class="ttc" id="aclassvehicle_html_a8bbdfb41ea75fdc007feab08e2137aa2"><div class="ttname"><a href="classvehicle.html#a8bbdfb41ea75fdc007feab08e2137aa2">vehicle::move</a></div><div class="ttdeci">tileray move</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l02314">vehicle.h:2314</a></div></div>
<div class="ttc" id="aclassvehicle_html_a8d856b434f959359bf729b5b390e6278"><div class="ttname"><a href="classvehicle.html#a8d856b434f959359bf729b5b390e6278">vehicle::get_monster</a></div><div class="ttdeci">monster * get_monster(int p) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l03412">vehicle.cpp:3412</a></div></div>
<div class="ttc" id="aclassvehicle_html_a8e021d197980bbed36ff3c43962df957"><div class="ttname"><a href="classvehicle.html#a8e021d197980bbed36ff3c43962df957">vehicle::face</a></div><div class="ttdeci">tileray face</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l02312">vehicle.h:2312</a></div></div>
<div class="ttc" id="aclassvehicle_html_abbc4051229bf116dfd03c53dcc4a0765"><div class="ttname"><a href="classvehicle.html#abbc4051229bf116dfd03c53dcc4a0765">vehicle::get_items</a></div><div class="ttdeci">vehicle_stack get_items(const vehicle_part &amp;vp) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l05922">vehicle.cpp:5922</a></div></div>
<div class="ttc" id="aclassvehicle_html_ace5c25f3faffd8848491570cfb89f086"><div class="ttname"><a href="classvehicle.html#ace5c25f3faffd8848491570cfb89f086">vehicle::disp_name</a></div><div class="ttdeci">std::string disp_name() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__display_8cpp_source.html#l00032">vehicle_display.cpp:32</a></div></div>
<div class="ttc" id="aclassvehicle_html_aec9a1faa6740b681867d48878e37d7bb"><div class="ttname"><a href="classvehicle.html#aec9a1faa6740b681867d48878e37d7bb">vehicle::is_moving</a></div><div class="ttdeci">bool is_moving() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l03728">vehicle.cpp:3728</a></div></div>
<div class="ttc" id="aclassvehicle_html_afccaeaa8277a4fbfc2c596682bf8b2d1"><div class="ttname"><a href="classvehicle.html#afccaeaa8277a4fbfc2c596682bf8b2d1">vehicle::enclosed_at</a></div><div class="ttdeci">bool enclosed_at(const tripoint &amp;pos)</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l07067">vehicle.cpp:7067</a></div></div>
<div class="ttc" id="aclassviewer_html_a204fe140cdc73d2452fa9a390a32ba29"><div class="ttname"><a href="classviewer.html#a204fe140cdc73d2452fa9a390a32ba29">viewer::sees</a></div><div class="ttdeci">virtual bool sees(const tripoint &amp;target, bool is_avatar=false, int range_mod=0) const =0</div></div>
<div class="ttc" id="acolony_8h_html"><div class="ttname"><a href="colony_8h.html">colony.h</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a31847b31c6ef002e9d16afd7fd0005e3"><div class="ttname"><a href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a></div><div class="ttdeci">std::vector&lt; coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &amp;&amp;RhsInBounds &gt; &gt; line_to(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00798">coordinates.h:798</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a560abf1cd341e88e2f13f454ec2ecc99"><div class="ttname"><a href="coordinates_8h.html#a560abf1cd341e88e2f13f454ec2ecc99">closest_points_first</a></div><div class="ttdeci">std::vector&lt; coords::coord_point&lt; Point, Origin, Scale &gt; &gt; closest_points_first(const coords::coord_point&lt; Point, Origin, Scale &gt; &amp;loc, int min_dist, int max_dist)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00848">coordinates.h:848</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a8e2cbab6dac12095f06b4cff66857fbb"><div class="ttname"><a href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a></div><div class="ttdeci">int rl_dist(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00769">coordinates.h:769</a></div></div>
<div class="ttc" id="acoordinates_8h_html_aafe19be6ce6f4788aa78a07a71807739"><div class="ttname"><a href="coordinates_8h.html#aafe19be6ce6f4788aa78a07a71807739">trig_dist</a></div><div class="ttdeci">int trig_dist(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00762">coordinates.h:762</a></div></div>
<div class="ttc" id="acreature_8h_html_a4b73e33b57ae387dc418906492d5f998"><div class="ttname"><a href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a></div><div class="ttdeci">bool force</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00241">creature.h:241</a></div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2">creature_size</a></div><div class="ttdeci">creature_size</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00068">creature.h:68</a></div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2a075a3e36a0a52dcbc568c05788e8a713"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2a075a3e36a0a52dcbc568c05788e8a713">creature_size::medium</a></div><div class="ttdeci">@ medium</div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2aac651433a999fb14f71f6754f0199781"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aac651433a999fb14f71f6754f0199781">creature_size::num_sizes</a></div><div class="ttdeci">@ num_sizes</div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2aafacdb0a401ccdf6b48551bbc00e8a74"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aafacdb0a401ccdf6b48551bbc00e8a74">creature_size::large</a></div><div class="ttdeci">@ large</div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2ab7cf27ffe6ea83cdcf8af2ef29de9285"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ab7cf27ffe6ea83cdcf8af2ef29de9285">creature_size::huge</a></div><div class="ttdeci">@ huge</div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a></div><div class="ttdeci">@ tiny</div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2aeb5c1399a871211c7e7ed732d15e3a8b"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aeb5c1399a871211c7e7ed732d15e3a8b">creature_size::small</a></div><div class="ttdeci">@ small</div></div>
<div class="ttc" id="acreature_8h_html_ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403"><div class="ttname"><a href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403">FacingDirection::RIGHT</a></div><div class="ttdeci">@ RIGHT</div></div>
<div class="ttc" id="acreature_8h_html_ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758"><div class="ttname"><a href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758">FacingDirection::LEFT</a></div><div class="ttdeci">@ LEFT</div></div>
<div class="ttc" id="acreature__tracker_8h_html"><div class="ttname"><a href="creature__tracker_8h.html">creature_tracker.h</a></div></div>
<div class="ttc" id="acreature__tracker_8h_html_a16f631f70e72b53e590770670fb301fb"><div class="ttname"><a href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a></div><div class="ttdeci">creature_tracker &amp; get_creature_tracker()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13827">game.cpp:13827</a></div></div>
<div class="ttc" id="acube__direction_8h_html_aea62013051f3c8842efa174037dfb5bca55a9d6aa251e3c334db4ab4055a4a004"><div class="ttname"><a href="cube__direction_8h.html#aea62013051f3c8842efa174037dfb5bca55a9d6aa251e3c334db4ab4055a4a004">cube_direction::above</a></div><div class="ttdeci">@ above</div></div>
<div class="ttc" id="acube__direction_8h_html_aea62013051f3c8842efa174037dfb5bca6cede1cfde12fc6d88ad1d8b6636a977"><div class="ttname"><a href="cube__direction_8h.html#aea62013051f3c8842efa174037dfb5bca6cede1cfde12fc6d88ad1d8b6636a977">cube_direction::below</a></div><div class="ttdeci">@ below</div></div>
<div class="ttc" id="adebug_8h_html"><div class="ttname"><a href="debug_8h.html">debug.h</a></div></div>
<div class="ttc" id="adebug_8h_html_a87e509562277a7ada3a75330d00cb445"><div class="ttname"><a href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a></div><div class="ttdeci">#define debugmsg(...)</div><div class="ttdoc">Debug message of level D_ERROR and class D_MAIN, also includes the source file name and line,...</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00069">debug.h:69</a></div></div>
<div class="ttc" id="adialogue_8h_html_abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8"><div class="ttname"><a href="dialogue_8h.html#abfef6960b077f40e23bc00055370cc71a0639a24a99be1d60fe688dd938b7eca8">action</a></div><div class="ttdeci">@ action</div><div class="ttdef"><b>Definition:</b> <a href="dialogue_8h_source.html#l00044">dialogue.h:43</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a></div><div class="ttdeci">@ m_info</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00352">enums.h:352</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a></div><div class="ttdeci">@ m_bad</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00348">enums.h:348</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a></div><div class="ttdeci">@ m_warning</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00351">enums.h:351</a></div></div>
<div class="ttc" id="afield_8h_html"><div class="ttname"><a href="field_8h.html">field.h</a></div></div>
<div class="ttc" id="afield__type_8cpp_html_a0090428c1f6724209c133c6b04b037cd"><div class="ttname"><a href="field__type_8cpp.html#a0090428c1f6724209c133c6b04b037cd">fd_fire</a></div><div class="ttdeci">const field_type_str_id fd_fire(&quot;fd_fire&quot;)</div></div>
<div class="ttc" id="afield__type_8cpp_html_a58c69cd6c8ba46b692c5ca3fbe4f0ae4"><div class="ttname"><a href="field__type_8cpp.html#a58c69cd6c8ba46b692c5ca3fbe4f0ae4">fd_acid</a></div><div class="ttdeci">const field_type_str_id fd_acid(&quot;fd_acid&quot;)</div></div>
<div class="ttc" id="afield__type_8cpp_html_a668009f9a173fd4f4be2b601be4a1f63"><div class="ttname"><a href="field__type_8cpp.html#a668009f9a173fd4f4be2b601be4a1f63">fd_churned_earth</a></div><div class="ttdeci">const field_type_str_id fd_churned_earth(&quot;fd_churned_earth&quot;)</div></div>
<div class="ttc" id="afield__type_8cpp_html_a7a3a035b9879e1ed52992d9857556f77"><div class="ttname"><a href="field__type_8cpp.html#a7a3a035b9879e1ed52992d9857556f77">fd_insecticidal_gas</a></div><div class="ttdeci">const field_type_str_id fd_insecticidal_gas(&quot;fd_insecticidal_gas&quot;)</div></div>
<div class="ttc" id="afield__type_8cpp_html_aa82146db3e3f637cba0882a8d666a6c7"><div class="ttname"><a href="field__type_8cpp.html#aa82146db3e3f637cba0882a8d666a6c7">fd_fungicidal_gas</a></div><div class="ttdeci">const field_type_str_id fd_fungicidal_gas(&quot;fd_fungicidal_gas&quot;)</div></div>
<div class="ttc" id="afield__type_8cpp_html_acd17fbab1a93c90c8748a2b0777027fa"><div class="ttname"><a href="field__type_8cpp.html#acd17fbab1a93c90c8748a2b0777027fa">fd_web</a></div><div class="ttdeci">const field_type_str_id fd_web(&quot;fd_web&quot;)</div></div>
<div class="ttc" id="afield__type_8cpp_html_acf26086090a59755ffe2d5cfd795fbee"><div class="ttname"><a href="field__type_8cpp.html#acf26086090a59755ffe2d5cfd795fbee">fd_fungal_haze</a></div><div class="ttdeci">const field_type_str_id fd_fungal_haze(&quot;fd_fungal_haze&quot;)</div></div>
<div class="ttc" id="afield__type_8cpp_html_ad5aa18f66a9c4810d561e84a2c316f03"><div class="ttname"><a href="field__type_8cpp.html#ad5aa18f66a9c4810d561e84a2c316f03">fd_sap</a></div><div class="ttdeci">const field_type_str_id fd_sap(&quot;fd_sap&quot;)</div></div>
<div class="ttc" id="afield__type_8cpp_html_aef9321274b765b7943ca0412b949b373"><div class="ttname"><a href="field__type_8cpp.html#aef9321274b765b7943ca0412b949b373">fd_sludge</a></div><div class="ttdeci">const field_type_str_id fd_sludge(&quot;fd_sludge&quot;)</div></div>
<div class="ttc" id="afield__type_8cpp_html_af0e4bb585d388fc8d4ad9ac76f52d340"><div class="ttname"><a href="field__type_8cpp.html#af0e4bb585d388fc8d4ad9ac76f52d340">fd_electricity</a></div><div class="ttdeci">const field_type_str_id fd_electricity(&quot;fd_electricity&quot;)</div></div>
<div class="ttc" id="afield__type_8h_html"><div class="ttname"><a href="field__type_8h.html">field_type.h</a></div></div>
<div class="ttc" id="agame_8cpp_html_ab5c977b7e81348725fb7bf09fc64ed95"><div class="ttname"><a href="game_8cpp.html#ab5c977b7e81348725fb7bf09fc64ed95">get_player_view</a></div><div class="ttdeci">viewer &amp; get_player_view()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13812">game.cpp:13812</a></div></div>
<div class="ttc" id="agame_8cpp_html_abeb98e93502d73818b4a73fabe191bc1"><div class="ttname"><a href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a></div><div class="ttdeci">std::unique_ptr&lt; game &gt; g</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l00382">game.cpp:382</a></div></div>
<div class="ttc" id="agame_8cpp_html_afa1063326b0c16b43c6f3dc8c3df403d"><div class="ttname"><a href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a></div><div class="ttdeci">map &amp; get_map()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13822">game.cpp:13822</a></div></div>
<div class="ttc" id="agame_8cpp_html_afee362892b161716a3fc614b030a877d"><div class="ttname"><a href="game_8cpp.html#afee362892b161716a3fc614b030a877d">get_scent</a></div><div class="ttdeci">scent_map &amp; get_scent()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13851">game.cpp:13851</a></div></div>
<div class="ttc" id="agame_8h_html"><div class="ttname"><a href="game_8h.html">game.h</a></div></div>
<div class="ttc" id="agame__constants_8h_html"><div class="ttname"><a href="game__constants_8h.html">game_constants.h</a></div></div>
<div class="ttc" id="agame__constants_8h_html_a3984a9476d1edc78e4e7b886a08d4d4b"><div class="ttname"><a href="game__constants_8h.html#a3984a9476d1edc78e4e7b886a08d4d4b">OVERMAP_HEIGHT</a></div><div class="ttdeci">constexpr int OVERMAP_HEIGHT</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00075">game_constants.h:75</a></div></div>
<div class="ttc" id="agame__constants_8h_html_a39fd8a829e3dc412646663066dbdb54c"><div class="ttname"><a href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a></div><div class="ttdeci">constexpr int SEEX</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00042">game_constants.h:42</a></div></div>
<div class="ttc" id="agame__constants_8h_html_a4cfa35de359af17f7bc6c2a424339eb5"><div class="ttname"><a href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a></div><div class="ttdeci">constexpr int SEEY</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00043">game_constants.h:43</a></div></div>
<div class="ttc" id="agame__constants_8h_html_aad0eacfa516a8f7e005674027d7640fe"><div class="ttname"><a href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a></div><div class="ttdeci">constexpr int OVERMAP_DEPTH</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00073">game_constants.h:73</a></div></div>
<div class="ttc" id="aline_8cpp_html_a2bd46cad079efd79854dffc0b97ce94b"><div class="ttname"><a href="line_8cpp.html#a2bd46cad079efd79854dffc0b97ce94b">continue_line</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; continue_line(const std::vector&lt; tripoint &gt; &amp;line, const int distance)</div><div class="ttdef"><b>Definition:</b> <a href="line_8cpp_source.html#l00380">line.cpp:380</a></div></div>
<div class="ttc" id="aline_8cpp_html_a40b9d88f6d95e646490329d0071ec931"><div class="ttname"><a href="line_8cpp.html#a40b9d88f6d95e646490329d0071ec931">trigdist</a></div><div class="ttdeci">bool trigdist</div><div class="ttdef"><b>Definition:</b> <a href="line_8cpp_source.html#l00018">line.cpp:18</a></div></div>
<div class="ttc" id="aline_8cpp_html_ac3d2ba0a4c40ecc74117e5b9752fac02"><div class="ttname"><a href="line_8cpp.html#ac3d2ba0a4c40ecc74117e5b9752fac02">squares_closer_to</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; squares_closer_to(const tripoint &amp;from, const tripoint &amp;to)</div><div class="ttdef"><b>Definition:</b> <a href="line_8cpp_source.html#l00659">line.cpp:659</a></div></div>
<div class="ttc" id="aline_8cpp_html_adb1b43fd955b85e0728419840af8a90a"><div class="ttname"><a href="line_8cpp.html#adb1b43fd955b85e0728419840af8a90a">squares_in_direction</a></div><div class="ttdeci">std::vector&lt; point &gt; squares_in_direction(const point &amp;p1, const point &amp;p2)</div><div class="ttdef"><b>Definition:</b> <a href="line_8cpp_source.html#l00696">line.cpp:696</a></div></div>
<div class="ttc" id="aline_8h_html"><div class="ttname"><a href="line_8h.html">line.h</a></div></div>
<div class="ttc" id="aline_8h_html_a3621d2006812bd84f3ed6999b38f90a3"><div class="ttname"><a href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a></div><div class="ttdeci">direction</div><div class="ttdef"><b>Definition:</b> <a href="line_8h_source.html#l00042">line.h:42</a></div></div>
<div class="ttc" id="aline_8h_html_ab7e2c307c51b94809057c788b81afbba"><div class="ttname"><a href="line_8h.html#ab7e2c307c51b94809057c788b81afbba">rl_dist_fast</a></div><div class="ttdeci">FastDistanceApproximation rl_dist_fast(const tripoint &amp;loc1, const tripoint &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="line_8h_source.html#l00237">line.h:237</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a6753ecfe87da659675b18c2f81d6ec12"><div class="ttname"><a href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a></div><div class="ttdeci">static constexpr double c</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01568">magic.cpp:1568</a></div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc">spell_target::item</a></div><div class="ttdeci">@ item</div></div>
<div class="ttc" id="amake__static_8h_html"><div class="ttname"><a href="make__static_8h.html">make_static.h</a></div></div>
<div class="ttc" id="amake__static_8h_html_ad8ea997925f9b41fffbf138f4c05e09f"><div class="ttname"><a href="make__static_8h.html#ad8ea997925f9b41fffbf138f4c05e09f">STATIC</a></div><div class="ttdeci">#define STATIC(expr)</div><div class="ttdoc">The purpose of this macro is to provide a concise syntax for creation of inline literals (std::string...</div><div class="ttdef"><b>Definition:</b> <a href="make__static_8h_source.html#l00031">make_static.h:31</a></div></div>
<div class="ttc" id="amap_8h_html"><div class="ttname"><a href="map_8h.html">map.h</a></div></div>
<div class="ttc" id="amap__iterator_8h_html"><div class="ttname"><a href="map__iterator_8h.html">map_iterator.h</a></div></div>
<div class="ttc" id="amapdata_8h_html"><div class="ttname"><a href="mapdata_8h.html">mapdata.h</a></div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054">ter_furn_flag</a></div><div class="ttdeci">ter_furn_flag</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00202">mapdata.h:202</a></div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a03729ff11aa021aad1751ad38ed85c81"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a03729ff11aa021aad1751ad38ed85c81">ter_furn_flag::TFLAG_UNSTABLE</a></div><div class="ttdeci">@ TFLAG_UNSTABLE</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a069663dd0b045b0a7e5268c906c5790f"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a069663dd0b045b0a7e5268c906c5790f">ter_furn_flag::TFLAG_NO_SIGHT</a></div><div class="ttdeci">@ TFLAG_NO_SIGHT</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a097fb4a94381fa8dfe878074bc7244de"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a097fb4a94381fa8dfe878074bc7244de">ter_furn_flag::TFLAG_ROAD</a></div><div class="ttdeci">@ TFLAG_ROAD</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a1fc389d4c9efd3d3954eb2b1557c895b">ter_furn_flag::TFLAG_SWIMMABLE</a></div><div class="ttdeci">@ TFLAG_SWIMMABLE</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a26a026d844907da147f1350754b5210b"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a26a026d844907da147f1350754b5210b">ter_furn_flag::TFLAG_RAMP_DOWN</a></div><div class="ttdeci">@ TFLAG_RAMP_DOWN</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a28fc0832c9c36a2deaa4f618f42c9c45"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a28fc0832c9c36a2deaa4f618f42c9c45">ter_furn_flag::TFLAG_SHARP</a></div><div class="ttdeci">@ TFLAG_SHARP</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a30e2c1c17c8b07188b9c4cbb80fbdf65"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a30e2c1c17c8b07188b9c4cbb80fbdf65">ter_furn_flag::TFLAG_FLAT</a></div><div class="ttdeci">@ TFLAG_FLAT</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a3c02a3fdfed55eb397855458954edb4d"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a3c02a3fdfed55eb397855458954edb4d">ter_furn_flag::TFLAG_BURROWABLE</a></div><div class="ttdeci">@ TFLAG_BURROWABLE</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a4099f16f8e2c4ea80e996db0ea6f4c02"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a4099f16f8e2c4ea80e996db0ea6f4c02">ter_furn_flag::TFLAG_RAMP_UP</a></div><div class="ttdeci">@ TFLAG_RAMP_UP</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a589ce1673849a76ea3bf17df3fe84ab3"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a589ce1673849a76ea3bf17df3fe84ab3">ter_furn_flag::TFLAG_GOES_UP</a></div><div class="ttdeci">@ TFLAG_GOES_UP</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a5b189c7326ca1246de45a1579b907d5e"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a5b189c7326ca1246de45a1579b907d5e">ter_furn_flag::TFLAG_AUTODOC_COUCH</a></div><div class="ttdeci">@ TFLAG_AUTODOC_COUCH</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a7518f40a34b4cbfbc922c4888af267cc"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a7518f40a34b4cbfbc922c4888af267cc">ter_furn_flag::TFLAG_LIQUID</a></div><div class="ttdeci">@ TFLAG_LIQUID</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054aaebe86ebda0571101f8d02ab5f2a888c"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054aaebe86ebda0571101f8d02ab5f2a888c">ter_furn_flag::TFLAG_DIGGABLE</a></div><div class="ttdeci">@ TFLAG_DIGGABLE</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054ab09f2463f4ce060d051439b5535a47e6"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ab09f2463f4ce060d051439b5535a47e6">ter_furn_flag::TFLAG_GOES_DOWN</a></div><div class="ttdeci">@ TFLAG_GOES_DOWN</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054ab6eeca58f1d5eff47e105ee3c132539f"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ab6eeca58f1d5eff47e105ee3c132539f">ter_furn_flag::TFLAG_SMALL_PASSAGE</a></div><div class="ttdeci">@ TFLAG_SMALL_PASSAGE</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054ac0ec7541a0f28e104d9c691936512481"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac0ec7541a0f28e104d9c691936512481">ter_furn_flag::TFLAG_CLIMBABLE</a></div><div class="ttdeci">@ TFLAG_CLIMBABLE</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054ac6e19e1c41724be67b2bff2870539ca1"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac6e19e1c41724be67b2bff2870539ca1">ter_furn_flag::TFLAG_DEEP_WATER</a></div><div class="ttdeci">@ TFLAG_DEEP_WATER</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054ae9b0dbad49c1e68f88ba799b1956684f"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ae9b0dbad49c1e68f88ba799b1956684f">ter_furn_flag::TFLAG_ROUGH</a></div><div class="ttdeci">@ TFLAG_ROUGH</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054af607730a38ff7975c6724b22881e0e58"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054af607730a38ff7975c6724b22881e0e58">ter_furn_flag::TFLAG_NO_FLOOR</a></div><div class="ttdeci">@ TFLAG_NO_FLOOR</div></div>
<div class="ttc" id="amath__parser__func_8h_html_a24f6ac6e06720c7cdf972a6083847132"><div class="ttname"><a href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">abs</a></div><div class="ttdeci">double abs(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00030">math_parser_func.h:30</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a9009aa9e5eb1323238ebddffd8e1aedf"><div class="ttname"><a href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">max</a></div><div class="ttdeci">double max(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00035">math_parser_func.h:35</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a993dede52d23a9a3d15b01a342391ef4"><div class="ttname"><a href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">min</a></div><div class="ttdeci">double min(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00043">math_parser_func.h:43</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_ac9196b0cf8d9dd209db9fc00a69a55f6"><div class="ttname"><a href="math__parser__func_8h.html#ac9196b0cf8d9dd209db9fc00a69a55f6">ceil</a></div><div class="ttdeci">double ceil(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00100">math_parser_func.h:100</a></div></div>
<div class="ttc" id="amattack__common_8h_html"><div class="ttname"><a href="mattack__common_8h.html">mattack_common.h</a></div></div>
<div class="ttc" id="amemory__fast_8h_html"><div class="ttname"><a href="memory__fast_8h.html">memory_fast.h</a></div></div>
<div class="ttc" id="amessages_8cpp_html_a3ea1aed1d11cd410cce07fb5be7aa34f"><div class="ttname"><a href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a></div><div class="ttdeci">void add_msg_if_player_sees(const tripoint &amp;target, std::string msg)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8cpp_source.html#l01007">messages.cpp:1007</a></div></div>
<div class="ttc" id="amessages_8cpp_html_a54489326fc37823819c5105addfa27f2"><div class="ttname"><a href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a></div><div class="ttdeci">void add_msg(std::string msg)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8cpp_source.html#l00997">messages.cpp:997</a></div></div>
<div class="ttc" id="amessages_8h_html"><div class="ttname"><a href="messages_8h.html">messages.h</a></div></div>
<div class="ttc" id="amessages_8h_html_ab6590bda29b082a7282bcc1a9cc8f02a"><div class="ttname"><a href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a></div><div class="ttdeci">#define add_msg_debug(type,...)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8h_source.html#l00177">messages.h:177</a></div></div>
<div class="ttc" id="amonfaction_8h_html"><div class="ttname"><a href="monfaction_8h.html">monfaction.h</a></div></div>
<div class="ttc" id="amonfaction_8h_html_ac5f72a9f6d69d1d5c271af54b16f9ab0"><div class="ttname"><a href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0">mf_attitude</a></div><div class="ttdeci">mf_attitude</div><div class="ttdef"><b>Definition:</b> <a href="monfaction_8h_source.html#l00020">monfaction.h:20</a></div></div>
<div class="ttc" id="amonfaction_8h_html_ac5f72a9f6d69d1d5c271af54b16f9ab0a23a2d35aee5d2497bcb11e15f7d7c586"><div class="ttname"><a href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0a23a2d35aee5d2497bcb11e15f7d7c586">MFA_NEUTRAL</a></div><div class="ttdeci">@ MFA_NEUTRAL</div><div class="ttdef"><b>Definition:</b> <a href="monfaction_8h_source.html#l00022">monfaction.h:22</a></div></div>
<div class="ttc" id="amonfaction_8h_html_ac5f72a9f6d69d1d5c271af54b16f9ab0a80fd3bb623381aa87ca80a3d035d3867"><div class="ttname"><a href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0a80fd3bb623381aa87ca80a3d035d3867">MFA_HATE</a></div><div class="ttdeci">@ MFA_HATE</div><div class="ttdef"><b>Definition:</b> <a href="monfaction_8h_source.html#l00024">monfaction.h:24</a></div></div>
<div class="ttc" id="amonfaction_8h_html_ac5f72a9f6d69d1d5c271af54b16f9ab0a8baef7717ecdcd96e64dca04ab2b4c97"><div class="ttname"><a href="monfaction_8h.html#ac5f72a9f6d69d1d5c271af54b16f9ab0a8baef7717ecdcd96e64dca04ab2b4c97">MFA_FRIENDLY</a></div><div class="ttdeci">@ MFA_FRIENDLY</div><div class="ttdef"><b>Definition:</b> <a href="monfaction_8h_source.html#l00023">monfaction.h:23</a></div></div>
<div class="ttc" id="amonmove_8cpp_html_a08481f62adb6937636ea44b855311037"><div class="ttname"><a href="monmove_8cpp.html#a08481f62adb6937636ea44b855311037">effect_downed</a></div><div class="ttdeci">static const efftype_id effect_downed(&quot;downed&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a2724a97ce27ac9050939a55314eab590"><div class="ttname"><a href="monmove_8cpp.html#a2724a97ce27ac9050939a55314eab590">json_flag_GRAB_FILTER</a></div><div class="ttdeci">static const flag_id json_flag_GRAB_FILTER(&quot;GRAB_FILTER&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a31e2ef0b23e31f445746b9eaabbeb600"><div class="ttname"><a href="monmove_8cpp.html#a31e2ef0b23e31f445746b9eaabbeb600">field_fd_last_known</a></div><div class="ttdeci">static const field_type_str_id field_fd_last_known(&quot;fd_last_known&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a3c9d7c1da038730a8cc36cb559d1bbd8"><div class="ttname"><a href="monmove_8cpp.html#a3c9d7c1da038730a8cc36cb559d1bbd8">z_is_valid</a></div><div class="ttdeci">static bool z_is_valid(int z)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00130">monmove.cpp:130</a></div></div>
<div class="ttc" id="amonmove_8cpp_html_a43d73ec1734433adc005632647aa155c"><div class="ttname"><a href="monmove_8cpp.html#a43d73ec1734433adc005632647aa155c">itype_pressurized_tank</a></div><div class="ttdeci">static const itype_id itype_pressurized_tank(&quot;pressurized_tank&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a4720d4449171de19328e9e2adc8ba622"><div class="ttname"><a href="monmove_8cpp.html#a4720d4449171de19328e9e2adc8ba622">effect_cramped_space</a></div><div class="ttdeci">static const efftype_id effect_cramped_space(&quot;cramped_space&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a5b54905268cad0ebc1a842a9594b0e65"><div class="ttname"><a href="monmove_8cpp.html#a5b54905268cad0ebc1a842a9594b0e65">ter_t_pit_spiked</a></div><div class="ttdeci">static const ter_str_id ter_t_pit_spiked(&quot;t_pit_spiked&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a6500d7a3ab33f453019cc4e7f55ced72"><div class="ttname"><a href="monmove_8cpp.html#a6500d7a3ab33f453019cc4e7f55ced72">effect_pushed</a></div><div class="ttdeci">static const efftype_id effect_pushed(&quot;pushed&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a692b3825de327022efb956655bf5e441"><div class="ttname"><a href="monmove_8cpp.html#a692b3825de327022efb956655bf5e441">effect_dragging</a></div><div class="ttdeci">static const efftype_id effect_dragging(&quot;dragging&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a6d062e430202ce21974bf3fb492002bf"><div class="ttname"><a href="monmove_8cpp.html#a6d062e430202ce21974bf3fb492002bf">species_ZOMBIE</a></div><div class="ttdeci">static const species_id species_ZOMBIE(&quot;ZOMBIE&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a7697771dc47ecaeff36785ff20c9aa33"><div class="ttname"><a href="monmove_8cpp.html#a7697771dc47ecaeff36785ff20c9aa33">effect_harnessed</a></div><div class="ttdeci">static const efftype_id effect_harnessed(&quot;harnessed&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a79654cfc6f07462199ec3f5da9e49c83"><div class="ttname"><a href="monmove_8cpp.html#a79654cfc6f07462199ec3f5da9e49c83">effect_pacified</a></div><div class="ttdeci">static const efftype_id effect_pacified(&quot;pacified&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a7a66d8a18b4c357a9ec56e2c6aca1d80"><div class="ttname"><a href="monmove_8cpp.html#a7a66d8a18b4c357a9ec56e2c6aca1d80">material_iflesh</a></div><div class="ttdeci">static const material_id material_iflesh(&quot;iflesh&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a8bbfe91713ddfaa4c647fa68f9734e34"><div class="ttname"><a href="monmove_8cpp.html#a8bbfe91713ddfaa4c647fa68f9734e34">effect_countdown</a></div><div class="ttdeci">static const efftype_id effect_countdown(&quot;countdown&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_a8d60c9f8582084603277543346b965c2"><div class="ttname"><a href="monmove_8cpp.html#a8d60c9f8582084603277543346b965c2">find_closest_stair</a></div><div class="ttdeci">static tripoint find_closest_stair(const tripoint &amp;near_this, const ter_furn_flag stair_type)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01840">monmove.cpp:1840</a></div></div>
<div class="ttc" id="amonmove_8cpp_html_a924fe96bf3dd9ac954c9925fdd5b6901"><div class="ttname"><a href="monmove_8cpp.html#a924fe96bf3dd9ac954c9925fdd5b6901">effect_docile</a></div><div class="ttdeci">static const efftype_id effect_docile(&quot;docile&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_aa3320a370fe1f7f1cf6e14918ca20358"><div class="ttname"><a href="monmove_8cpp.html#aa3320a370fe1f7f1cf6e14918ca20358">effect_bouldering</a></div><div class="ttdeci">static const efftype_id effect_bouldering(&quot;bouldering&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_aa9166c53ef32fe65a5c624d530a0210c"><div class="ttname"><a href="monmove_8cpp.html#aa9166c53ef32fe65a5c624d530a0210c">get_stagger_adjust</a></div><div class="ttdeci">static float get_stagger_adjust(const tripoint &amp;source, const tripoint &amp;destination, const tripoint &amp;next_step)</div><div class="ttdoc">Method to make monster movement speed consistent in the face of staggering behavior and differing dis...</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00825">monmove.cpp:825</a></div></div>
<div class="ttc" id="amonmove_8cpp_html_aaa258c5465ca70ec4568914f0975902c"><div class="ttname"><a href="monmove_8cpp.html#aaa258c5465ca70ec4568914f0975902c">ter_t_pit</a></div><div class="ttdeci">static const ter_str_id ter_t_pit(&quot;t_pit&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_ab41f4e77a586e85f347f7151266b9dd5"><div class="ttname"><a href="monmove_8cpp.html#ab41f4e77a586e85f347f7151266b9dd5">json_flag_GRAB</a></div><div class="ttdeci">static const flag_id json_flag_GRAB(&quot;GRAB&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_ab8dd6142a7131d3af944e532002ac9e3"><div class="ttname"><a href="monmove_8cpp.html#ab8dd6142a7131d3af944e532002ac9e3">effect_operating</a></div><div class="ttdeci">static const efftype_id effect_operating(&quot;operating&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_abd49233bc2fac36e7e5fd2ba24dcac17"><div class="ttname"><a href="monmove_8cpp.html#abd49233bc2fac36e7e5fd2ba24dcac17">ter_t_pit_glass</a></div><div class="ttdeci">static const ter_str_id ter_t_pit_glass(&quot;t_pit_glass&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_ad1df0ca2944a94c3ad796e8baada33ae"><div class="ttname"><a href="monmove_8cpp.html#ad1df0ca2944a94c3ad796e8baada33ae">effect_stunned</a></div><div class="ttdeci">static const efftype_id effect_stunned(&quot;stunned&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_ad5fa326832c0a774d6a775e605f27788"><div class="ttname"><a href="monmove_8cpp.html#ad5fa326832c0a774d6a775e605f27788">effect_led_by_leash</a></div><div class="ttdeci">static const efftype_id effect_led_by_leash(&quot;led_by_leash&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_ad6fd62a9ed571c6bf17d577118be3c5a"><div class="ttname"><a href="monmove_8cpp.html#ad6fd62a9ed571c6bf17d577118be3c5a">effect_stumbled_into_invisible</a></div><div class="ttdeci">static const efftype_id effect_stumbled_into_invisible(&quot;stumbled_into_invisible&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_ada6977f9f2935b5c864914ed26ba70be"><div class="ttname"><a href="monmove_8cpp.html#ada6977f9f2935b5c864914ed26ba70be">ter_t_lava</a></div><div class="ttdeci">static const ter_str_id ter_t_lava(&quot;t_lava&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_adcaf70773541073a0d4cdfce4b857bf7"><div class="ttname"><a href="monmove_8cpp.html#adcaf70773541073a0d4cdfce4b857bf7">effect_psi_stunned</a></div><div class="ttdeci">static const efftype_id effect_psi_stunned(&quot;psi_stunned&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_ae326c5e4da7f23bc429d04d215dd7c9d"><div class="ttname"><a href="monmove_8cpp.html#ae326c5e4da7f23bc429d04d215dd7c9d">effect_grabbed</a></div><div class="ttdeci">static const efftype_id effect_grabbed(&quot;grabbed&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_ae4aecc728b6b9084078aaa79046ce038"><div class="ttname"><a href="monmove_8cpp.html#ae4aecc728b6b9084078aaa79046ce038">species_FUNGUS</a></div><div class="ttdeci">static const species_id species_FUNGUS(&quot;FUNGUS&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_ae931fdf83b37ff0d7c8bfd3096fa0b73"><div class="ttname"><a href="monmove_8cpp.html#ae931fdf83b37ff0d7c8bfd3096fa0b73">get_bashing_zone</a></div><div class="ttdeci">static std::vector&lt; tripoint &gt; get_bashing_zone(const tripoint &amp;bashee, const tripoint &amp;basher, int maxdepth)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l01650">monmove.cpp:1650</a></div></div>
<div class="ttc" id="amonmove_8cpp_html_aecd517a9e74b5a5a21f0c75f88f50090"><div class="ttname"><a href="monmove_8cpp.html#aecd517a9e74b5a5a21f0c75f88f50090">damage_cut</a></div><div class="ttdeci">static const damage_type_id damage_cut(&quot;cut&quot;)</div></div>
<div class="ttc" id="amonmove_8cpp_html_af079f6d5681dabcbc1c4ee804c0ba556"><div class="ttname"><a href="monmove_8cpp.html#af079f6d5681dabcbc1c4ee804c0ba556">effect_no_sight</a></div><div class="ttdeci">static const efftype_id effect_no_sight(&quot;no_sight&quot;)</div></div>
<div class="ttc" id="amonster_8h_html"><div class="ttname"><a href="monster_8h.html">monster.h</a></div></div>
<div class="ttc" id="amonster_8h_html_aac044bb92427fa3cd80c3c945ba7ecd4"><div class="ttname"><a href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4">monster_attitude</a></div><div class="ttdeci">monster_attitude</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00057">monster.h:57</a></div></div>
<div class="ttc" id="amonster_8h_html_aac044bb92427fa3cd80c3c945ba7ecd4a1c6426f1f830743448b46e8e2aa068b4"><div class="ttname"><a href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a1c6426f1f830743448b46e8e2aa068b4">MATT_FLEE</a></div><div class="ttdeci">@ MATT_FLEE</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00061">monster.h:61</a></div></div>
<div class="ttc" id="amonster_8h_html_aac044bb92427fa3cd80c3c945ba7ecd4a7284d60cdedff9ecfaaf33b10ba4986b"><div class="ttname"><a href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a7284d60cdedff9ecfaaf33b10ba4986b">MATT_FRIEND</a></div><div class="ttdeci">@ MATT_FRIEND</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00059">monster.h:59</a></div></div>
<div class="ttc" id="amonster_8h_html_aac044bb92427fa3cd80c3c945ba7ecd4a850d5624fd1d54192310ab8b13f228ee"><div class="ttname"><a href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a850d5624fd1d54192310ab8b13f228ee">MATT_FOLLOW</a></div><div class="ttdeci">@ MATT_FOLLOW</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00063">monster.h:63</a></div></div>
<div class="ttc" id="amonster_8h_html_aac044bb92427fa3cd80c3c945ba7ecd4a87f44dc6e793f84b2342dafd6460b263"><div class="ttname"><a href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4a87f44dc6e793f84b2342dafd6460b263">MATT_ATTACK</a></div><div class="ttdeci">@ MATT_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00064">monster.h:64</a></div></div>
<div class="ttc" id="amonster_8h_html_aac044bb92427fa3cd80c3c945ba7ecd4aa81d19ea97def3730dddfc9451b53de5"><div class="ttname"><a href="monster_8h.html#aac044bb92427fa3cd80c3c945ba7ecd4aa81d19ea97def3730dddfc9451b53de5">MATT_IGNORE</a></div><div class="ttdeci">@ MATT_IGNORE</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00062">monster.h:62</a></div></div>
<div class="ttc" id="amonster__oracle_8h_html"><div class="ttname"><a href="monster__oracle_8h.html">monster_oracle.h</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a0170802dff38a9711cf97c353826eeb7"><div class="ttname"><a href="mtype_8cpp.html#a0170802dff38a9711cf97c353826eeb7">mon_flag_SMALL_HIDER</a></div><div class="ttdeci">mon_flag_id mon_flag_SMALL_HIDER</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00150">mtype.cpp:150</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a066bf1be1c6f12b73b46b54dc2c6f40e"><div class="ttname"><a href="mtype_8cpp.html#a066bf1be1c6f12b73b46b54dc2c6f40e">mon_flag_SILENTMOVES</a></div><div class="ttdeci">mon_flag_id mon_flag_SILENTMOVES</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00146">mtype.cpp:146</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a0ab20367a507f953bab44113234bd07a"><div class="ttname"><a href="mtype_8cpp.html#a0ab20367a507f953bab44113234bd07a">mon_flag_STUMBLES</a></div><div class="ttdeci">mon_flag_id mon_flag_STUMBLES</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00152">mtype.cpp:152</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a0e12efd1ed65a888bff5a5db5faeaf96"><div class="ttname"><a href="mtype_8cpp.html#a0e12efd1ed65a888bff5a5db5faeaf96">mon_flag_CAN_OPEN_DOORS</a></div><div class="ttdeci">mon_flag_id mon_flag_CAN_OPEN_DOORS</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00061">mtype.cpp:61</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a0f90cef22d42e0b8c911e8d289e1a10e"><div class="ttname"><a href="mtype_8cpp.html#a0f90cef22d42e0b8c911e8d289e1a10e">mon_flag_SEES</a></div><div class="ttdeci">mon_flag_id mon_flag_SEES</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00143">mtype.cpp:143</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a10899530fa212da51fd92b98b0cacdb5"><div class="ttname"><a href="mtype_8cpp.html#a10899530fa212da51fd92b98b0cacdb5">mon_flag_AQUATIC</a></div><div class="ttdeci">mon_flag_id mon_flag_AQUATIC</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00048">mtype.cpp:48</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a188f898480b93c89a0f5c0763cd8373d"><div class="ttname"><a href="mtype_8cpp.html#a188f898480b93c89a0f5c0763cd8373d">mon_flag_ACIDTRAIL</a></div><div class="ttdeci">mon_flag_id mon_flag_ACIDTRAIL</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00042">mtype.cpp:42</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a1a2c96cda209ef35238ac3e040c62aa9"><div class="ttname"><a href="mtype_8cpp.html#a1a2c96cda209ef35238ac3e040c62aa9">mon_flag_ELECTRIC</a></div><div class="ttdeci">mon_flag_id mon_flag_ELECTRIC</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00078">mtype.cpp:78</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a1ce59be15eeebc2aa195dc5a5cf38358"><div class="ttname"><a href="mtype_8cpp.html#a1ce59be15eeebc2aa195dc5a5cf38358">mon_flag_RIDEABLE_MECH</a></div><div class="ttdeci">mon_flag_id mon_flag_RIDEABLE_MECH</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00142">mtype.cpp:142</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a22a63e16b805987f8321bb4ff63f0273"><div class="ttname"><a href="mtype_8cpp.html#a22a63e16b805987f8321bb4ff63f0273">mon_flag_PACIFIST</a></div><div class="ttdeci">mon_flag_id mon_flag_PACIFIST</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00120">mtype.cpp:120</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a28012e7b03f25df53cd371150ad24916"><div class="ttname"><a href="mtype_8cpp.html#a28012e7b03f25df53cd371150ad24916">mon_flag_ATTACKMON</a></div><div class="ttdeci">mon_flag_id mon_flag_ATTACKMON</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00050">mtype.cpp:50</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a2c060d4d5caf177589dd0545f9f8d9ef"><div class="ttname"><a href="mtype_8cpp.html#a2c060d4d5caf177589dd0545f9f8d9ef">mon_flag_SWARMS</a></div><div class="ttdeci">mon_flag_id mon_flag_SWARMS</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00155">mtype.cpp:155</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a2d34a5d2b22293f92d8166e654529ccc"><div class="ttname"><a href="mtype_8cpp.html#a2d34a5d2b22293f92d8166e654529ccc">mon_flag_WEBWALK</a></div><div class="ttdeci">mon_flag_id mon_flag_WEBWALK</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00162">mtype.cpp:162</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a2fcb130b1992859d4c1fe76f4f4da006"><div class="ttname"><a href="mtype_8cpp.html#a2fcb130b1992859d4c1fe76f4f4da006">mon_flag_GROUP_MORALE</a></div><div class="ttdeci">mon_flag_id mon_flag_GROUP_MORALE</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00090">mtype.cpp:90</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a3f693ccabdc6659dd60b5e230107766c"><div class="ttname"><a href="mtype_8cpp.html#a3f693ccabdc6659dd60b5e230107766c">mon_flag_ACIDPROOF</a></div><div class="ttdeci">mon_flag_id mon_flag_ACIDPROOF</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00041">mtype.cpp:41</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a423bde94101c93a1f67ed5ed8c334a05"><div class="ttname"><a href="mtype_8cpp.html#a423bde94101c93a1f67ed5ed8c334a05">mon_flag_SMALLSLUDGETRAIL</a></div><div class="ttdeci">mon_flag_id mon_flag_SMALLSLUDGETRAIL</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00149">mtype.cpp:149</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a4c417260415c080a792537389ec1c0fe"><div class="ttname"><a href="mtype_8cpp.html#a4c417260415c080a792537389ec1c0fe">mon_flag_NO_BREATHE</a></div><div class="ttdeci">mon_flag_id mon_flag_NO_BREATHE</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00116">mtype.cpp:116</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a71cf2330cd9d412b2d82728c88b1fad0"><div class="ttname"><a href="mtype_8cpp.html#a71cf2330cd9d412b2d82728c88b1fad0">mon_flag_GROUP_BASH</a></div><div class="ttdeci">mon_flag_id mon_flag_GROUP_BASH</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00089">mtype.cpp:89</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a758910f241f118e1f1bbe48a2bc41011"><div class="ttname"><a href="mtype_8cpp.html#a758910f241f118e1f1bbe48a2bc41011">mon_flag_SLUDGETRAIL</a></div><div class="ttdeci">mon_flag_id mon_flag_SLUDGETRAIL</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00148">mtype.cpp:148</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a7598512ae9ca78a96974d3ca4237b044"><div class="ttname"><a href="mtype_8cpp.html#a7598512ae9ca78a96974d3ca4237b044">mon_flag_SMELLS</a></div><div class="ttdeci">mon_flag_id mon_flag_SMELLS</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00151">mtype.cpp:151</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a83712a1bfc3dafbb500ba844673a59d8"><div class="ttname"><a href="mtype_8cpp.html#a83712a1bfc3dafbb500ba844673a59d8">mon_flag_LOUDMOVES</a></div><div class="ttdeci">mon_flag_id mon_flag_LOUDMOVES</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00106">mtype.cpp:106</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a908bb60a3a9133ca7e129be4e6bc3e1a"><div class="ttname"><a href="mtype_8cpp.html#a908bb60a3a9133ca7e129be4e6bc3e1a">mon_flag_INSECTICIDEPROOF</a></div><div class="ttdeci">mon_flag_id mon_flag_INSECTICIDEPROOF</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00102">mtype.cpp:102</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a953954e2c6d4fac0741d4a57c41610eb"><div class="ttname"><a href="mtype_8cpp.html#a953954e2c6d4fac0741d4a57c41610eb">mon_flag_PATH_AVOID_DANGER_2</a></div><div class="ttdeci">mon_flag_id mon_flag_PATH_AVOID_DANGER_2</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00123">mtype.cpp:123</a></div></div>
<div class="ttc" id="amtype_8cpp_html_a976a9bbc5340ce1473ec88e960fb0f4e"><div class="ttname"><a href="mtype_8cpp.html#a976a9bbc5340ce1473ec88e960fb0f4e">mon_flag_DRIPS_NAPALM</a></div><div class="ttdeci">mon_flag_id mon_flag_DRIPS_NAPALM</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00075">mtype.cpp:75</a></div></div>
<div class="ttc" id="amtype_8cpp_html_aa03ff0de8ff0fccbe3aedafcef1c5153"><div class="ttname"><a href="mtype_8cpp.html#aa03ff0de8ff0fccbe3aedafcef1c5153">mon_flag_QUEEN</a></div><div class="ttdeci">mon_flag_id mon_flag_QUEEN</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00136">mtype.cpp:136</a></div></div>
<div class="ttc" id="amtype_8cpp_html_aaacb1b1721666f5ed2282384e9a27d77"><div class="ttname"><a href="mtype_8cpp.html#aaacb1b1721666f5ed2282384e9a27d77">mon_flag_KEENNOSE</a></div><div class="ttdeci">mon_flag_id mon_flag_KEENNOSE</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00104">mtype.cpp:104</a></div></div>
<div class="ttc" id="amtype_8cpp_html_aabb42fd7984b2addbc4580930166b17b"><div class="ttname"><a href="mtype_8cpp.html#aabb42fd7984b2addbc4580930166b17b">mon_flag_PUSH_VEH</a></div><div class="ttdeci">mon_flag_id mon_flag_PUSH_VEH</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00135">mtype.cpp:135</a></div></div>
<div class="ttc" id="amtype_8cpp_html_aaed6bfffb6b455a66dc66a4792cabefc"><div class="ttname"><a href="mtype_8cpp.html#aaed6bfffb6b455a66dc66a4792cabefc">mon_flag_PATH_AVOID_FIRE</a></div><div class="ttdeci">mon_flag_id mon_flag_PATH_AVOID_FIRE</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00125">mtype.cpp:125</a></div></div>
<div class="ttc" id="amtype_8cpp_html_ab04d901f795e5383be19f9bc78e36a2d"><div class="ttname"><a href="mtype_8cpp.html#ab04d901f795e5383be19f9bc78e36a2d">mon_flag_SHORTACIDTRAIL</a></div><div class="ttdeci">mon_flag_id mon_flag_SHORTACIDTRAIL</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00144">mtype.cpp:144</a></div></div>
<div class="ttc" id="amtype_8cpp_html_ab0b72a092cc048de39170eb7efa37b0a"><div class="ttname"><a href="mtype_8cpp.html#ab0b72a092cc048de39170eb7efa37b0a">mon_flag_PATH_AVOID_DANGER_1</a></div><div class="ttdeci">mon_flag_id mon_flag_PATH_AVOID_DANGER_1</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00122">mtype.cpp:122</a></div></div>
<div class="ttc" id="amtype_8cpp_html_ab219f3ef959738c3d9f76ab5bfea8f50"><div class="ttname"><a href="mtype_8cpp.html#ab219f3ef959738c3d9f76ab5bfea8f50">mon_flag_QUIETMOVES</a></div><div class="ttdeci">mon_flag_id mon_flag_QUIETMOVES</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00138">mtype.cpp:138</a></div></div>
<div class="ttc" id="amtype_8cpp_html_ac15b344ef0a6c63960a6b7c042b0ce94"><div class="ttname"><a href="mtype_8cpp.html#ac15b344ef0a6c63960a6b7c042b0ce94">mon_flag_SUNDEATH</a></div><div class="ttdeci">mon_flag_id mon_flag_SUNDEATH</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00154">mtype.cpp:154</a></div></div>
<div class="ttc" id="amtype_8cpp_html_ac5e2cd69bddcec0fbb472df3e6991c40"><div class="ttname"><a href="mtype_8cpp.html#ac5e2cd69bddcec0fbb472df3e6991c40">mon_flag_PATH_AVOID_FALL</a></div><div class="ttdeci">mon_flag_id mon_flag_PATH_AVOID_FALL</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00124">mtype.cpp:124</a></div></div>
<div class="ttc" id="amtype_8cpp_html_ad6a17cb01971e10f58414cf964a400e2"><div class="ttname"><a href="mtype_8cpp.html#ad6a17cb01971e10f58414cf964a400e2">mon_flag_KEEP_DISTANCE</a></div><div class="ttdeci">mon_flag_id mon_flag_KEEP_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00105">mtype.cpp:105</a></div></div>
<div class="ttc" id="amtype_8cpp_html_af5bf953ca6152f2de9c886eaa7389d6a"><div class="ttname"><a href="mtype_8cpp.html#af5bf953ca6152f2de9c886eaa7389d6a">mon_flag_FIREPROOF</a></div><div class="ttdeci">mon_flag_id mon_flag_FIREPROOF</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00083">mtype.cpp:83</a></div></div>
<div class="ttc" id="amtype_8cpp_html_af87d0e11009031a09f917068f8cc0357"><div class="ttname"><a href="mtype_8cpp.html#af87d0e11009031a09f917068f8cc0357">mon_flag_PLASTIC</a></div><div class="ttdeci">mon_flag_id mon_flag_PLASTIC</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00131">mtype.cpp:131</a></div></div>
<div class="ttc" id="amtype_8cpp_html_af882b7fb7b2ad4d4d8a66371e2a5793c"><div class="ttname"><a href="mtype_8cpp.html#af882b7fb7b2ad4d4d8a66371e2a5793c">mon_flag_PUSH_MON</a></div><div class="ttdeci">mon_flag_id mon_flag_PUSH_MON</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00134">mtype.cpp:134</a></div></div>
<div class="ttc" id="amtype_8cpp_html_af88ca13a69fcf00093e7f86b5d55bfbd"><div class="ttname"><a href="mtype_8cpp.html#af88ca13a69fcf00093e7f86b5d55bfbd">mon_flag_PRIORITIZE_TARGETS</a></div><div class="ttdeci">mon_flag_id mon_flag_PRIORITIZE_TARGETS</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00133">mtype.cpp:133</a></div></div>
<div class="ttc" id="amtype_8cpp_html_af8eb4198f7564379a407e89c13cdd1b7"><div class="ttname"><a href="mtype_8cpp.html#af8eb4198f7564379a407e89c13cdd1b7">mon_flag_IMMOBILE</a></div><div class="ttdeci">mon_flag_id mon_flag_IMMOBILE</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00101">mtype.cpp:101</a></div></div>
<div class="ttc" id="amtype_8cpp_html_af9b7f4b3884e6ac1b61f21cdcc4fdd57"><div class="ttname"><a href="mtype_8cpp.html#af9b7f4b3884e6ac1b61f21cdcc4fdd57">mon_flag_DRIPS_GASOLINE</a></div><div class="ttdeci">mon_flag_id mon_flag_DRIPS_GASOLINE</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00074">mtype.cpp:74</a></div></div>
<div class="ttc" id="amtype_8h_html"><div class="ttname"><a href="mtype_8h.html">mtype.h</a></div></div>
<div class="ttc" id="amtype_8h_html_a3bf0d3734009dbabe39a0d9fad3a5913"><div class="ttname"><a href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913">mon_trigger</a></div><div class="ttdeci">mon_trigger</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00045">mtype.h:45</a></div></div>
<div class="ttc" id="amtype_8h_html_a3bf0d3734009dbabe39a0d9fad3a5913a27586a1b07947ccc76f2f5407d486fb6"><div class="ttname"><a href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913a27586a1b07947ccc76f2f5407d486fb6">mon_trigger::HOSTILE_SEEN</a></div><div class="ttdeci">@ HOSTILE_SEEN</div></div>
<div class="ttc" id="amtype_8h_html_a3bf0d3734009dbabe39a0d9fad3a5913a442d4420890764901db368467c4ca9ec"><div class="ttname"><a href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913a442d4420890764901db368467c4ca9ec">mon_trigger::MATING_SEASON</a></div><div class="ttdeci">@ MATING_SEASON</div></div>
<div class="ttc" id="amtype_8h_html_a3bf0d3734009dbabe39a0d9fad3a5913a527ecba2efe7da593d8f2938d448e600"><div class="ttname"><a href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913a527ecba2efe7da593d8f2938d448e600">mon_trigger::HOSTILE_CLOSE</a></div><div class="ttdeci">@ HOSTILE_CLOSE</div></div>
<div class="ttc" id="amtype_8h_html_a3bf0d3734009dbabe39a0d9fad3a5913ae3f28a00a012a9d0a71c597defad1398"><div class="ttname"><a href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913ae3f28a00a012a9d0a71c597defad1398">mon_trigger::HOSTILE_WEAK</a></div><div class="ttdeci">@ HOSTILE_WEAK</div></div>
<div class="ttc" id="amtype_8h_html_a3bf0d3734009dbabe39a0d9fad3a5913af9730b9c048c70f6f9293baf0ea2ce0f"><div class="ttname"><a href="mtype_8h.html#a3bf0d3734009dbabe39a0d9fad3a5913af9730b9c048c70f6f9293baf0ea2ce0f">mon_trigger::PLAYER_NEAR_BABY</a></div><div class="ttdeci">@ PLAYER_NEAR_BABY</div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02item__tname_8cpp_03_html_a1ff93bf21a97272ada4556de4422fb80"><div class="ttname"><a href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a1ff93bf21a97272ada4556de4422fb80">anonymous_namespace{item_tname.cpp}::contents</a></div><div class="ttdeci">std::string contents(item const &amp;it, unsigned int, segment_bitset const &amp;segments)</div><div class="ttdef"><b>Definition:</b> <a href="item__tname_8cpp_source.html#l00216">item_tname.cpp:216</a></div></div>
<div class="ttc" id="anamespacecalendar_html_ae15fcbf1c971589eb49c1a657fb6a580"><div class="ttname"><a href="namespacecalendar.html#ae15fcbf1c971589eb49c1a657fb6a580">calendar::turn</a></div><div class="ttdeci">time_point turn</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00038">calendar.cpp:38</a></div></div>
<div class="ttc" id="anamespacedebugmode_html_ac654a55a1b56b11554103f87859968f2a06b26a3d79dd171e505cf88e89ede5bb"><div class="ttname"><a href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2a06b26a3d79dd171e505cf88e89ede5bb">debugmode::DF_MATTACK</a></div><div class="ttdeci">@ DF_MATTACK</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00262">debug.h:262</a></div></div>
<div class="ttc" id="anamespacedebugmode_html_ac654a55a1b56b11554103f87859968f2ab576821e0d29160d6272e3c6f9faa323"><div class="ttname"><a href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2ab576821e0d29160d6272e3c6f9faa323">debugmode::DF_MONMOVE</a></div><div class="ttdeci">@ DF_MONMOVE</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00264">debug.h:264</a></div></div>
<div class="ttc" id="anamespacedebugmode_html_ac654a55a1b56b11554103f87859968f2af89f1588bb30d81d64b742d34658db06"><div class="ttname"><a href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af89f1588bb30d81d64b742d34658db06">debugmode::DF_MONSTER</a></div><div class="ttdeci">@ DF_MONSTER</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00265">debug.h:265</a></div></div>
<div class="ttc" id="anamespaceom__direction_html_af97f9dbddaa758278662da3478826c61"><div class="ttname"><a href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">om_direction::size</a></div><div class="ttdeci">const size_t size</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00066">omdata.h:66</a></div></div>
<div class="ttc" id="anamespacerotatable__symbols_html_a7d2f855a39674de736a7829423a577f4"><div class="ttname"><a href="namespacerotatable__symbols.html#a7d2f855a39674de736a7829423a577f4">rotatable_symbols::get</a></div><div class="ttdeci">uint32_t get(const uint32_t &amp;symbol, int n)</div><div class="ttdef"><b>Definition:</b> <a href="rotatable__symbols_8cpp_source.html#l00091">rotatable_symbols.cpp:91</a></div></div>
<div class="ttc" id="anamespacesounds_html_a2cf6eebd3df3764f7004be69b364e930"><div class="ttname"><a href="namespacesounds.html#a2cf6eebd3df3764f7004be69b364e930">sounds::add_footstep</a></div><div class="ttdeci">void add_footstep(const tripoint &amp;p, int volume, int distance, monster *source, const std::string &amp;footstep)</div><div class="ttdoc">Creates a list of coordinates at which to draw footsteps.</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8cpp_source.html#l00358">sounds.cpp:358</a></div></div>
<div class="ttc" id="anamespacesounds_html_a6bb79ae1c9c3dcd8c8e0b28c66b0398d"><div class="ttname"><a href="namespacesounds.html#a6bb79ae1c9c3dcd8c8e0b28c66b0398d">sounds::sound</a></div><div class="ttdeci">void sound(const tripoint &amp;p, int vol, sound_t category, const std::string &amp;description, bool ambient=false, const std::string &amp;id=&quot;&quot;, const std::string &amp;variant=&quot;default&quot;)</div><div class="ttdoc">Sound at (p) of intensity (vol)</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8cpp_source.html#l00318">sounds.cpp:318</a></div></div>
<div class="ttc" id="anamespacesounds_html_af6b3d144906d9ccfda6824fb87e46aa3ab761780ade49c11f48702cf2b0e3b0cd"><div class="ttname"><a href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3ab761780ade49c11f48702cf2b0e3b0cd">sounds::sound_t::electronic_speech</a></div><div class="ttdeci">@ electronic_speech</div></div>
<div class="ttc" id="anamespacespell__effect_html_acfe36e6436b9cc2e3060fc5541bded22"><div class="ttname"><a href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">spell_effect::attack</a></div><div class="ttdeci">void attack(const spell &amp;sp, Creature &amp;caster, const tripoint &amp;epicenter)</div><div class="ttdef"><b>Definition:</b> <a href="magic__spell__effect_8cpp_source.html#l00581">magic_spell_effect.cpp:581</a></div></div>
<div class="ttc" id="anamespaceunits_html_a5d16607c866588620acb381e7dbbf0a6"><div class="ttname"><a href="namespaceunits.html#a5d16607c866588620acb381e7dbbf0a6">units::volume</a></div><div class="ttdeci">quantity&lt; int, volume_in_milliliter_tag &gt; volume</div><div class="ttdef"><b>Definition:</b> <a href="units__fwd_8h_source.html#l00017">units_fwd.h:17</a></div></div>
<div class="ttc" id="anamespaceunits_html_aafd2a8bd44b71ecc20b880db8071ad53"><div class="ttname"><a href="namespaceunits.html#aafd2a8bd44b71ecc20b880db8071ad53">units::power</a></div><div class="ttdeci">quantity&lt; std::int64_t, power_in_milliwatt_tag &gt; power</div><div class="ttdef"><b>Definition:</b> <a href="units__fwd_8h_source.html#l00057">units_fwd.h:57</a></div></div>
<div class="ttc" id="anpc_8h_html"><div class="ttname"><a href="npc_8h.html">npc.h</a></div></div>
<div class="ttc" id="aomdata_8h_html_a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf"><div class="ttname"><a href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">oter_travel_cost_type::other</a></div><div class="ttdeci">@ other</div></div>
<div class="ttc" id="aoptions_8h_html"><div class="ttname"><a href="options_8h.html">options.h</a></div></div>
<div class="ttc" id="apathfinding_8h_html"><div class="ttname"><a href="pathfinding_8h.html">pathfinding.h</a></div></div>
<div class="ttc" id="apimpl_8h_html"><div class="ttname"><a href="pimpl_8h.html">pimpl.h</a></div></div>
<div class="ttc" id="apoint_8h_html_a4b1a6bcaa42d2c06ecc3afc63305bfdf"><div class="ttname"><a href="point_8h.html#a4b1a6bcaa42d2c06ecc3afc63305bfdf">tripoint_zero</a></div><div class="ttdeci">constexpr tripoint tripoint_zero</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00250">point.h:250</a></div></div>
<div class="ttc" id="arng_8cpp_html_aad28bdad07401a34ecf9912708f8b750"><div class="ttname"><a href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a></div><div class="ttdeci">bool one_in(int chance)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00108">rng.cpp:108</a></div></div>
<div class="ttc" id="arng_8h_html"><div class="ttname"><a href="rng_8h.html">rng.h</a></div></div>
<div class="ttc" id="arng_8h_html_a12244355ee77108f1b08618e9962e4d1"><div class="ttname"><a href="rng_8h.html#a12244355ee77108f1b08618e9962e4d1">random_entry</a></div><div class="ttdeci">V random_entry(const C &amp;container, D default_value)</div><div class="ttdoc">Returns a random entry in the container.</div><div class="ttdef"><b>Definition:</b> <a href="rng_8h_source.html#l00104">rng.h:104</a></div></div>
<div class="ttc" id="arng_8h_html_ac634f688b3c7864ab6992939ac7b0a6e"><div class="ttname"><a href="rng_8h.html#ac634f688b3c7864ab6992939ac7b0a6e">random_entry_removed</a></div><div class="ttdeci">V random_entry_removed(C &amp;container)</div><div class="ttdoc">Returns a random entry in the container and removes it from the container.</div><div class="ttdef"><b>Definition:</b> <a href="rng_8h_source.html#l00186">rng.h:186</a></div></div>
<div class="ttc" id="ascent__map_8h_html"><div class="ttname"><a href="scent__map_8h.html">scent_map.h</a></div></div>
<div class="ttc" id="ascent__map_8h_html_ae37b6acaf47b352000fac854f116c126"><div class="ttname"><a href="scent__map_8h.html#ae37b6acaf47b352000fac854f116c126">SCENT_MAP_Z_REACH</a></div><div class="ttdeci">constexpr int SCENT_MAP_Z_REACH</div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8h_source.html#l00019">scent_map.h:19</a></div></div>
<div class="ttc" id="asounds_8h_html"><div class="ttname"><a href="sounds_8h.html">sounds.h</a></div></div>
<div class="ttc" id="astring__formatter_8h_html"><div class="ttname"><a href="string__formatter_8h.html">string_formatter.h</a></div></div>
<div class="ttc" id="astring__formatter_8h_html_a8964099387da2f95396c67566bafce3d"><div class="ttname"><a href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a></div><div class="ttdeci">std::string string_format(std::string_view format, Args &amp;&amp;...args)</div><div class="ttdoc">Simple wrapper over string_formatter::parse.</div><div class="ttdef"><b>Definition:</b> <a href="string__formatter_8h_source.html#l00417">string_formatter.h:417</a></div></div>
<div class="ttc" id="astructFastDistanceApproximation_html"><div class="ttname"><a href="structFastDistanceApproximation.html">FastDistanceApproximation</a></div><div class="ttdoc">Helper type for the return value of dist_fast().</div><div class="ttdef"><b>Definition:</b> <a href="line_8h_source.html#l00198">line.h:198</a></div></div>
<div class="ttc" id="astructbionic_html"><div class="ttname"><a href="structbionic.html">bionic</a></div><div class="ttdef"><b>Definition:</b> <a href="bionics_8h_source.html#l00198">bionics.h:198</a></div></div>
<div class="ttc" id="astructbionic_html_a9255cc84ea78c25ee01fe4aff4de1624"><div class="ttname"><a href="structbionic.html#a9255cc84ea78c25ee01fe4aff4de1624">bionic::get_parent_uid</a></div><div class="ttdeci">bionic_uid get_parent_uid() const</div><div class="ttdef"><b>Definition:</b> <a href="bionics_8cpp_source.html#l03478">bionics.cpp:3478</a></div></div>
<div class="ttc" id="astructbionic_html_ad3b2c3960fdbb6492918ecc8f911e0dd"><div class="ttname"><a href="structbionic.html#ad3b2c3960fdbb6492918ecc8f911e0dd">bionic::is_included</a></div><div class="ttdeci">bool is_included() const</div><div class="ttdef"><b>Definition:</b> <a href="bionics_8cpp_source.html#l03473">bionics.cpp:3473</a></div></div>
<div class="ttc" id="astructdamage__instance_html"><div class="ttname"><a href="structdamage__instance.html">damage_instance</a></div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00132">damage.h:132</a></div></div>
<div class="ttc" id="astructfield__type_html"><div class="ttname"><a href="structfield__type.html">field_type</a></div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00182">field_type.h:182</a></div></div>
<div class="ttc" id="astructfield__type_html_a40a71f7f1d1c5cfccd86817061665c96"><div class="ttname"><a href="structfield__type.html#a40a71f7f1d1c5cfccd86817061665c96">field_type::immune_mtypes</a></div><div class="ttdeci">std::set&lt; mtype_id &gt; immune_mtypes</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00216">field_type.h:216</a></div></div>
<div class="ttc" id="astructfield__type_html_a5b08ae2a01c1e82e7cb22785d735d5e9"><div class="ttname"><a href="structfield__type.html#a5b08ae2a01c1e82e7cb22785d735d5e9">field_type::has_elec</a></div><div class="ttdeci">bool has_elec</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00207">field_type.h:207</a></div></div>
<div class="ttc" id="astructfield__type_html_a7654ad7f889130a671e526c96f230ce6"><div class="ttname"><a href="structfield__type.html#a7654ad7f889130a671e526c96f230ce6">field_type::has_acid</a></div><div class="ttdeci">bool has_acid</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00206">field_type.h:206</a></div></div>
<div class="ttc" id="astructfield__type_html_a945df8e3828398e06dddfe503b742df5"><div class="ttname"><a href="structfield__type.html#a945df8e3828398e06dddfe503b742df5">field_type::has_fume</a></div><div class="ttdeci">bool has_fume</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00208">field_type.h:208</a></div></div>
<div class="ttc" id="astructfield__type_html_ab660a14996c8441bdf8f3cfa6da475af"><div class="ttname"><a href="structfield__type.html#ab660a14996c8441bdf8f3cfa6da475af">field_type::has_fire</a></div><div class="ttdeci">bool has_fire</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00205">field_type.h:205</a></div></div>
<div class="ttc" id="astructmonster__plan_html"><div class="ttname"><a href="structmonster__plan.html">monster_plan</a></div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00395">monmove.cpp:395</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a0d87f33e302029e20d9d2f6fea2be80f"><div class="ttname"><a href="structmonster__plan.html#a0d87f33e302029e20d9d2f6fea2be80f">monster_plan::target</a></div><div class="ttdeci">Creature * target</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00423">monmove.cpp:423</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a1f17c727f34c6eb024312137cb3f5166"><div class="ttname"><a href="structmonster__plan.html#a1f17c727f34c6eb024312137cb3f5166">monster_plan::group_morale</a></div><div class="ttdeci">bool group_morale</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00410">monmove.cpp:410</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a41b0d322391808422149e02a678e0956"><div class="ttname"><a href="structmonster__plan.html#a41b0d322391808422149e02a678e0956">monster_plan::smart_planning</a></div><div class="ttdeci">bool smart_planning</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00399">monmove.cpp:399</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a482740ef6a3e3f3c5d216b8aa7f320f1"><div class="ttname"><a href="structmonster__plan.html#a482740ef6a3e3f3c5d216b8aa7f320f1">monster_plan::max_sight_range</a></div><div class="ttdeci">int max_sight_range</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00416">monmove.cpp:416</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a4f34314c218249a6e771e55d75a0bf4a"><div class="ttname"><a href="structmonster__plan.html#a4f34314c218249a6e771e55d75a0bf4a">monster_plan::angers_hostile_weak</a></div><div class="ttdeci">const bool angers_hostile_weak</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00404">monmove.cpp:404</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a609da64a368f08449b8238be8c02061a"><div class="ttname"><a href="structmonster__plan.html#a609da64a368f08449b8238be8c02061a">monster_plan::fears_hostile_weak</a></div><div class="ttdeci">const bool fears_hostile_weak</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00405">monmove.cpp:405</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a63d61ba991776c05f55c08877e74267f"><div class="ttname"><a href="structmonster__plan.html#a63d61ba991776c05f55c08877e74267f">monster_plan::fleeing</a></div><div class="ttdeci">bool fleeing</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00401">monmove.cpp:401</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a6444e8d3c4e0096116a65058474a21cc"><div class="ttname"><a href="structmonster__plan.html#a6444e8d3c4e0096116a65058474a21cc">monster_plan::dist</a></div><div class="ttdeci">float dist</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00414">monmove.cpp:414</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a783d4b87496b39a7cb483e717a7d18c3"><div class="ttname"><a href="structmonster__plan.html#a783d4b87496b39a7cb483e717a7d18c3">monster_plan::placate_hostile_weak</a></div><div class="ttdeci">const bool placate_hostile_weak</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00406">monmove.cpp:406</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a835410f0d4159d27640aaf03c0292386"><div class="ttname"><a href="structmonster__plan.html#a835410f0d4159d27640aaf03c0292386">monster_plan::docile</a></div><div class="ttdeci">bool docile</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00402">monmove.cpp:402</a></div></div>
<div class="ttc" id="astructmonster__plan_html_a91d261c73a3c6d8907cd55fae4ee7d0c"><div class="ttname"><a href="structmonster__plan.html#a91d261c73a3c6d8907cd55fae4ee7d0c">monster_plan::fears_hostile_seen</a></div><div class="ttdeci">const int fears_hostile_seen</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00421">monmove.cpp:421</a></div></div>
<div class="ttc" id="astructmonster__plan_html_aa4b2629a9c4c573b7374d3b795778ba6"><div class="ttname"><a href="structmonster__plan.html#aa4b2629a9c4c573b7374d3b795778ba6">monster_plan::angers_hostile_near</a></div><div class="ttdeci">const int angers_hostile_near</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00407">monmove.cpp:407</a></div></div>
<div class="ttc" id="astructmonster__plan_html_abcea26b7607ff796e19216edc7e93704"><div class="ttname"><a href="structmonster__plan.html#abcea26b7607ff796e19216edc7e93704">monster_plan::angers_mating_season</a></div><div class="ttdeci">const int angers_mating_season</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00418">monmove.cpp:418</a></div></div>
<div class="ttc" id="astructmonster__plan_html_abf476a1550b7942fa59da7341fdb8b63"><div class="ttname"><a href="structmonster__plan.html#abf476a1550b7942fa59da7341fdb8b63">monster_plan::angers_hostile_seen</a></div><div class="ttdeci">const int angers_hostile_seen</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00408">monmove.cpp:408</a></div></div>
<div class="ttc" id="astructmonster__plan_html_ac66e19d4c63eed0cffa0ce69e9cefe8e"><div class="ttname"><a href="structmonster__plan.html#ac66e19d4c63eed0cffa0ce69e9cefe8e">monster_plan::swarms</a></div><div class="ttdeci">bool swarms</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00411">monmove.cpp:411</a></div></div>
<div class="ttc" id="astructmonster__plan_html_ac871cff53ad2f8665c63741965b4486d"><div class="ttname"><a href="structmonster__plan.html#ac871cff53ad2f8665c63741965b4486d">monster_plan::monster_plan</a></div><div class="ttdeci">monster_plan(const monster &amp;mon)</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00426">monmove.cpp:426</a></div></div>
<div class="ttc" id="astructmonster__plan_html_ae2852d3e6a37badd21ccc50874fe09d1"><div class="ttname"><a href="structmonster__plan.html#ae2852d3e6a37badd21ccc50874fe09d1">monster_plan::fears_hostile_near</a></div><div class="ttdeci">const int fears_hostile_near</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00420">monmove.cpp:420</a></div></div>
<div class="ttc" id="astructmonster__plan_html_afa25ba895f2547a4d20822e7fdc50cec"><div class="ttname"><a href="structmonster__plan.html#afa25ba895f2547a4d20822e7fdc50cec">monster_plan::angers_cub_threatened</a></div><div class="ttdeci">const int angers_cub_threatened</div><div class="ttdef"><b>Definition:</b> <a href="monmove_8cpp_source.html#l00419">monmove.cpp:419</a></div></div>
<div class="ttc" id="astructmtype_html_a30acba3bb0f18e38d564fe72b7e34f8b"><div class="ttname"><a href="structmtype.html#a30acba3bb0f18e38d564fe72b7e34f8b">mtype::scents_ignored</a></div><div class="ttdeci">std::set&lt; scenttype_id &gt; scents_ignored</div><div class="ttdoc">Types of scent tracked by this mtype.</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00369">mtype.h:369</a></div></div>
<div class="ttc" id="astructmtype_html_a3782082ac316cac7f189d089b3b16000"><div class="ttname"><a href="structmtype.html#a3782082ac316cac7f189d089b3b16000">mtype::has_special_attack</a></div><div class="ttdeci">bool has_special_attack(const std::string &amp;attack_name) const</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00335">mtype.cpp:335</a></div></div>
<div class="ttc" id="astructmtype_html_a3e1904385c3aeb343021eea90b466b19"><div class="ttname"><a href="structmtype.html#a3e1904385c3aeb343021eea90b466b19">mtype::vision_day</a></div><div class="ttdeci">int vision_day</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00458">mtype.h:458</a></div></div>
<div class="ttc" id="astructmtype_html_a3e59522bca2f998bb482d4629f3f18d4"><div class="ttname"><a href="structmtype.html#a3e59522bca2f998bb482d4629f3f18d4">mtype::get_footsteps</a></div><div class="ttdeci">std::string get_footsteps() const</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00513">mtype.cpp:513</a></div></div>
<div class="ttc" id="astructmtype_html_a42b480d35fc4dc0428223b76a41c3ecf"><div class="ttname"><a href="structmtype.html#a42b480d35fc4dc0428223b76a41c3ecf">mtype::scents_tracked</a></div><div class="ttdeci">std::set&lt; scenttype_id &gt; scents_tracked</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00368">mtype.h:368</a></div></div>
<div class="ttc" id="astructmtype_html_a51ec342d71717bb513f0158198b12840"><div class="ttname"><a href="structmtype.html#a51ec342d71717bb513f0158198b12840">mtype::in_species</a></div><div class="ttdeci">bool in_species(const species_id &amp;spec) const</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00385">mtype.cpp:385</a></div></div>
<div class="ttc" id="astructmtype_html_a541f9bf8c2e84856ea34db43f88991b3"><div class="ttname"><a href="structmtype.html#a541f9bf8c2e84856ea34db43f88991b3">mtype::bodytype</a></div><div class="ttdeci">bodytype_id bodytype</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00355">mtype.h:355</a></div></div>
<div class="ttc" id="astructmtype_html_a561d4830d7f7c613c177f5880c2e15fb"><div class="ttname"><a href="structmtype.html#a561d4830d7f7c613c177f5880c2e15fb">mtype::melee_dice</a></div><div class="ttdeci">int melee_dice</div><div class="ttdoc">melee hit skill, 20 is superhuman hitting abilities</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00430">mtype.h:430</a></div></div>
<div class="ttc" id="astructmtype_html_a60dea81cdc4c627313e540831d311b5a"><div class="ttname"><a href="structmtype.html#a60dea81cdc4c627313e540831d311b5a">mtype::id</a></div><div class="ttdeci">mtype_id id</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00301">mtype.h:301</a></div></div>
<div class="ttc" id="astructmtype_html_a8a889ba3d1d6eb87ca31ce8999c9e6d0"><div class="ttname"><a href="structmtype.html#a8a889ba3d1d6eb87ca31ce8999c9e6d0">mtype::morale</a></div><div class="ttdeci">int morale</div><div class="ttdoc">chance will attack [-100,100]</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00416">mtype.h:416</a></div></div>
<div class="ttc" id="astructmtype_html_a9636bf314611b06345f1a78b4e88e8ae"><div class="ttname"><a href="structmtype.html#a9636bf314611b06345f1a78b4e88e8ae">mtype::baby_flags</a></div><div class="ttdeci">std::vector&lt; std::string &gt; baby_flags</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00350">mtype.h:350</a></div></div>
<div class="ttc" id="astructmtype_html_aa03998a1de174a26778a0d6384d55b89"><div class="ttname"><a href="structmtype.html#aa03998a1de174a26778a0d6384d55b89">mtype::size</a></div><div class="ttdeci">creature_size size</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00407">mtype.h:407</a></div></div>
<div class="ttc" id="astructmtype_html_ac3d685da5268a2d00d8b8bd14eea54c2"><div class="ttname"><a href="structmtype.html#ac3d685da5268a2d00d8b8bd14eea54c2">mtype::baby_monster</a></div><div class="ttdeci">mtype_id baby_monster</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00314">mtype.h:314</a></div></div>
<div class="ttc" id="astructmtype_html_acd6bef5de9f343c6677cc8ae2b48e6fe"><div class="ttname"><a href="structmtype.html#acd6bef5de9f343c6677cc8ae2b48e6fe">mtype::bash_skill</a></div><div class="ttdeci">int bash_skill</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00463">mtype.h:463</a></div></div>
<div class="ttc" id="astructmtype_html_ad2d6c0780216ad8a2999bc4e7ec7822c"><div class="ttname"><a href="structmtype.html#ad2d6c0780216ad8a2999bc4e7ec7822c">mtype::species</a></div><div class="ttdeci">std::set&lt; species_id &gt; species</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00362">mtype.h:362</a></div></div>
<div class="ttc" id="astructmtype_html_ad3d8be7cacb7cd0a19b2c187c9e1ac26"><div class="ttname"><a href="structmtype.html#ad3d8be7cacb7cd0a19b2c187c9e1ac26">mtype::special_attacks</a></div><div class="ttdeci">std::map&lt; std::string, mtype_special_attack &gt; special_attacks</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00378">mtype.h:378</a></div></div>
<div class="ttc" id="astructmtype_html_adba404a1bab62eccbe6a9720cae88c42"><div class="ttname"><a href="structmtype.html#adba404a1bab62eccbe6a9720cae88c42">mtype::get_goals</a></div><div class="ttdeci">const behavior::node_t * get_goals() const</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00531">mtype.cpp:531</a></div></div>
<div class="ttc" id="astructmtype_html_af37c4d88f49584515720ebd0d9542114"><div class="ttname"><a href="structmtype.html#af37c4d88f49584515720ebd0d9542114">mtype::vision_night</a></div><div class="ttdeci">int vision_night</div><div class="ttdoc">vision range in bright light</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00459">mtype.h:459</a></div></div>
<div class="ttc" id="astructmtype_html_afb696f9fd6734d41999a056ac3924475"><div class="ttname"><a href="structmtype.html#afb696f9fd6734d41999a056ac3924475">mtype::tracking_distance</a></div><div class="ttdeci">int tracking_distance</div><div class="ttdoc">how many times it has eaten</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00421">mtype.h:421</a></div></div>
<div class="ttc" id="astructpathfinding__settings_html"><div class="ttname"><a href="structpathfinding__settings.html">pathfinding_settings</a></div><div class="ttdef"><b>Definition:</b> <a href="pathfinding_8h_source.html#l00052">pathfinding.h:52</a></div></div>
<div class="ttc" id="astructpathfinding__settings_html_ab888f81c3ce0d4f691e9f8619cf31328"><div class="ttname"><a href="structpathfinding__settings.html#ab888f81c3ce0d4f691e9f8619cf31328">pathfinding_settings::avoid_sharp</a></div><div class="ttdeci">bool avoid_sharp</div><div class="ttdef"><b>Definition:</b> <a href="pathfinding_8h_source.html#l00067">pathfinding.h:67</a></div></div>
<div class="ttc" id="astructpathfinding__settings_html_acba070ceb6ae16b9c3991a1d2814d4c8"><div class="ttname"><a href="structpathfinding__settings.html#acba070ceb6ae16b9c3991a1d2814d4c8">pathfinding_settings::avoid_traps</a></div><div class="ttdeci">bool avoid_traps</div><div class="ttdef"><b>Definition:</b> <a href="pathfinding_8h_source.html#l00064">pathfinding.h:64</a></div></div>
<div class="ttc" id="astructpathfinding__settings_html_ad0b14e2ee3fc5bb59d985e98e2fa9504"><div class="ttname"><a href="structpathfinding__settings.html#ad0b14e2ee3fc5bb59d985e98e2fa9504">pathfinding_settings::max_dist</a></div><div class="ttdeci">int max_dist</div><div class="ttdef"><b>Definition:</b> <a href="pathfinding_8h_source.html#l00054">pathfinding.h:54</a></div></div>
<div class="ttc" id="astructpoint_html"><div class="ttname"><a href="structpoint.html">point</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00020">point.h:20</a></div></div>
<div class="ttc" id="astructpoint_html_a9a82ca9504acabb1e30569f89c805471"><div class="ttname"><a href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">point::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00024">point.h:24</a></div></div>
<div class="ttc" id="astructpoint_html_ad679b07fb69d55f5ad454d0f1f2891d5"><div class="ttname"><a href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">point::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00023">point.h:23</a></div></div>
<div class="ttc" id="astructtrap_html"><div class="ttname"><a href="structtrap.html">trap</a></div><div class="ttdoc">Some traps aren't actually traps in the usual sense of the word.</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00109">trap.h:109</a></div></div>
<div class="ttc" id="astructtrap_html_adc8f59b97597d373f7cb0bbcf061e794"><div class="ttname"><a href="structtrap.html#adc8f59b97597d373f7cb0bbcf061e794">trap::is_benign</a></div><div class="ttdeci">bool is_benign() const</div><div class="ttdoc">If true, this is not really a trap and there won't be any safety queries before stepping onto it (e....</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00221">trap.h:221</a></div></div>
<div class="ttc" id="astructtripoint_html"><div class="ttname"><a href="structtripoint.html">tripoint</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00129">point.h:129</a></div></div>
<div class="ttc" id="astructtripoint_html_a89f6c0a16e2bfd7ce4f1f1d20404c4d7"><div class="ttname"><a href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">tripoint::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00133">point.h:133</a></div></div>
<div class="ttc" id="astructtripoint_html_ac944c0e329b5eba2602f7a52f66bbbb9"><div class="ttname"><a href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">tripoint::z</a></div><div class="ttdeci">int z</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00134">point.h:134</a></div></div>
<div class="ttc" id="astructtripoint_html_accc0725c936dbebb2486f969f39e2e5f"><div class="ttname"><a href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">tripoint::xy</a></div><div class="ttdeci">constexpr point xy() const</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00202">point.h:202</a></div></div>
<div class="ttc" id="astructtripoint_html_affdc0d5b75024cbfacd208a495def3dc"><div class="ttname"><a href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">tripoint::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00132">point.h:132</a></div></div>
<div class="ttc" id="astructvehicle__part_html"><div class="ttname"><a href="structvehicle__part.html">vehicle_part</a></div><div class="ttdoc">Structure, describing vehicle part (i.e., wheel, seat)</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00254">vehicle.h:254</a></div></div>
<div class="ttc" id="asubmap_8h_html"><div class="ttname"><a href="submap_8h.html">submap.h</a></div></div>
<div class="ttc" id="atileray_8h_html"><div class="ttname"><a href="tileray_8h.html">tileray.h</a></div></div>
<div class="ttc" id="atranslations_8h_html"><div class="ttname"><a href="translations_8h.html">translations.h</a></div></div>
<div class="ttc" id="atranslations_8h_html_a46bdf4dff9d320938561cade1c9a5f7e"><div class="ttname"><a href="translations_8h.html#a46bdf4dff9d320938561cade1c9a5f7e">pgettext</a></div><div class="ttdeci">#define pgettext(STRING1, STRING2)</div><div class="ttdef"><b>Definition:</b> <a href="translations_8h_source.html#l00092">translations.h:92</a></div></div>
<div class="ttc" id="atranslations_8h_html_ab92bb4161a6308b302d283816975c3a6"><div class="ttname"><a href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a></div><div class="ttdeci">#define _(STRING)</div><div class="ttdef"><b>Definition:</b> <a href="translations_8h_source.html#l00089">translations.h:89</a></div></div>
<div class="ttc" id="atrap_8h_html"><div class="ttname"><a href="trap_8h.html">trap.h</a></div></div>
<div class="ttc" id="atype__id_8h_html_a0de4f7de7b6dc7d13c525e8a5e0eb615"><div class="ttname"><a href="type__id_8h.html#a0de4f7de7b6dc7d13c525e8a5e0eb615">mfaction_str_id</a></div><div class="ttdeci">string_id&lt; monfaction &gt; mfaction_str_id</div><div class="ttdef"><b>Definition:</b> <a href="type__id_8h_source.html#l00161">type_id.h:161</a></div></div>
<div class="ttc" id="atype__id_8h_html_a119965745ae171b731d18a45ec6ee424"><div class="ttname"><a href="type__id_8h.html#a119965745ae171b731d18a45ec6ee424">damage_type_id</a></div><div class="ttdeci">string_id&lt; damage_type &gt; damage_type_id</div><div class="ttdef"><b>Definition:</b> <a href="type__id_8h_source.html#l00071">type_id.h:71</a></div></div>
<div class="ttc" id="aunits_8h_html"><div class="ttname"><a href="units_8h.html">units.h</a></div></div>
<div class="ttc" id="aveh__type_8h_html"><div class="ttname"><a href="veh__type_8h.html">veh_type.h</a></div></div>
<div class="ttc" id="aveh__type_8h_html_aa3ff66a8c100c3deb40dfa70f1eb307ea563fb2626cff0acc6c8273fef3e3a8d0"><div class="ttname"><a href="veh__type_8h.html#aa3ff66a8c100c3deb40dfa70f1eb307ea563fb2626cff0acc6c8273fef3e3a8d0">VPFLAG_CARGO</a></div><div class="ttdeci">@ VPFLAG_CARGO</div><div class="ttdef"><b>Definition:</b> <a href="veh__type_8h_source.html#l00094">veh_type.h:94</a></div></div>
<div class="ttc" id="avehicle_8h_html"><div class="ttname"><a href="vehicle_8h.html">vehicle.h</a></div></div>
<div class="ttc" id="avehicle_8h_html_ad9a221cee9ae7a69d6f09d4de701f02ca100b8cad7cf2a56f6df78f171f97a1ec"><div class="ttname"><a href="vehicle_8h.html#ad9a221cee9ae7a69d6f09d4de701f02ca100b8cad7cf2a56f6df78f171f97a1ec">part_status_flag::any</a></div><div class="ttdeci">@ any</div></div>
<div class="ttc" id="aviewer_8h_html"><div class="ttname"><a href="viewer_8h.html">viewer.h</a></div></div>
<div class="ttc" id="avpart__position_8h_html"><div class="ttname"><a href="vpart__position_8h.html">vpart_position.h</a></div></div>
<div class="ttc" id="awidget_8h_html_ac9c40e0d5ffae2a9e10019da79b7983fadc27c0e30cacf9b64bc66bc26f09c89a"><div class="ttname"><a href="widget_8h.html#ac9c40e0d5ffae2a9e10019da79b7983fadc27c0e30cacf9b64bc66bc26f09c89a">widget_var::mood</a></div><div class="ttdeci">@ mood</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 7 2024 08:48:30 for Cataclysm DDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
