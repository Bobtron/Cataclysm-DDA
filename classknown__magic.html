<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm DDA: known_magic Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm DDA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classknown__magic-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">known_magic Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="magic_8h_source.html">magic.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2e9d576a3710bfe2534471e630df5bb7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a2e9d576a3710bfe2534471e630df5bb7">known_magic</a> ()</td></tr>
<tr class="separator:a2e9d576a3710bfe2534471e630df5bb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39b5a4fcc441be1ebdaba7bcbb22fffa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">learn_spell</a> (const std::string &amp;sp, <a class="el" href="classCharacter.html">Character</a> &amp;guy, bool <a class="el" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a>=false)</td></tr>
<tr class="separator:a39b5a4fcc441be1ebdaba7bcbb22fffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeab7b087a69b633b0ae61509ca5e0d48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#aeab7b087a69b633b0ae61509ca5e0d48">learn_spell</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp, <a class="el" href="classCharacter.html">Character</a> &amp;guy, bool <a class="el" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a>=false)</td></tr>
<tr class="separator:aeab7b087a69b633b0ae61509ca5e0d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dc8309c014c9d2698826bdb8883cd39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a7dc8309c014c9d2698826bdb8883cd39">learn_spell</a> (const <a class="el" href="classspell__type.html">spell_type</a> *sp, <a class="el" href="classCharacter.html">Character</a> &amp;guy, bool <a class="el" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a>=false)</td></tr>
<tr class="separator:a7dc8309c014c9d2698826bdb8883cd39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51f338d00a8e83a453e33766b5a05bd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6">forget_spell</a> (const std::string &amp;sp)</td></tr>
<tr class="separator:a51f338d00a8e83a453e33766b5a05bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad23426154495b1a395dc6309ce47c6cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#ad23426154495b1a395dc6309ce47c6cc">forget_spell</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp)</td></tr>
<tr class="separator:ad23426154495b1a395dc6309ce47c6cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a800de0f2bcb32e309629216f85456e31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a800de0f2bcb32e309629216f85456e31">set_spell_level</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;, int, const <a class="el" href="classCharacter.html">Character</a> *)</td></tr>
<tr class="separator:a800de0f2bcb32e309629216f85456e31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90fcfdbfe3d0dd04780ff2d8e672a1ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a90fcfdbfe3d0dd04780ff2d8e672a1ef">set_spell_exp</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;, int, const <a class="el" href="classCharacter.html">Character</a> *)</td></tr>
<tr class="separator:a90fcfdbfe3d0dd04780ff2d8e672a1ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ec46640014cc1ea785a7db001203b37"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a3ec46640014cc1ea785a7db001203b37">time_to_learn_spell</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;guy, const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp) const</td></tr>
<tr class="separator:a3ec46640014cc1ea785a7db001203b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad425ea60cd0b564225bddfd3afd7e40c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#ad425ea60cd0b564225bddfd3afd7e40c">time_to_learn_spell</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;guy, const std::string &amp;str) const</td></tr>
<tr class="separator:ad425ea60cd0b564225bddfd3afd7e40c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4bdf834ec136179f6755e4566435b61"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#ad4bdf834ec136179f6755e4566435b61">can_learn_spell</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;guy, const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp) const</td></tr>
<tr class="separator:ad4bdf834ec136179f6755e4566435b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af808c41802489957df2f33a5e3e381c7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#af808c41802489957df2f33a5e3e381c7">knows_spell</a> (const std::string &amp;sp) const</td></tr>
<tr class="separator:af808c41802489957df2f33a5e3e381c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8921c5cb6ecfcb2ad0f76a54f516070b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a8921c5cb6ecfcb2ad0f76a54f516070b">knows_spell</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp) const</td></tr>
<tr class="separator:a8921c5cb6ecfcb2ad0f76a54f516070b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d5ecb476afb7f4a131ee82f223e44e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a> () const</td></tr>
<tr class="separator:a67d5ecb476afb7f4a131ee82f223e44e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab05f99ea584c7bec9ab34369e14369f0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">spells</a> () const</td></tr>
<tr class="separator:ab05f99ea584c7bec9ab34369e14369f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c3dca5ebcd118303a6be29a38a73ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classspell.html">spell</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">get_spell</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp)</td></tr>
<tr class="separator:a86c3dca5ebcd118303a6be29a38a73ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98a91b2ff64d726c4d54f04a3fee000e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a98a91b2ff64d726c4d54f04a3fee000e">select_spell</a> (<a class="el" href="classCharacter.html">Character</a> &amp;guy)</td></tr>
<tr class="separator:a98a91b2ff64d726c4d54f04a3fee000e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af47da2a24159ff7852576b1db2e30eab"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classspell.html">spell</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a> ()</td></tr>
<tr class="separator:af47da2a24159ff7852576b1db2e30eab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afae34b16f3a80bc74ab70ad176b2a70e"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a>, <a class="el" href="classspell.html">spell</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#afae34b16f3a80bc74ab70ad176b2a70e">get_spellbook</a> ()</td></tr>
<tr class="separator:afae34b16f3a80bc74ab70ad176b2a70e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe4bbf2ea0bcb6c32349b7a54640b6c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#afe4bbf2ea0bcb6c32349b7a54640b6c5">available_mana</a> () const</td></tr>
<tr class="separator:afe4bbf2ea0bcb6c32349b7a54640b6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1d54e77049ce1b9ed9d20a559ae0a38"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#af1d54e77049ce1b9ed9d20a559ae0a38">max_mana</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;guy) const</td></tr>
<tr class="separator:af1d54e77049ce1b9ed9d20a559ae0a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae44e12a998ae53c5d487828d83165168"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#ae44e12a998ae53c5d487828d83165168">mod_mana</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;guy, int add_mana)</td></tr>
<tr class="separator:ae44e12a998ae53c5d487828d83165168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed71b588441f7580d8f3bf9d27a7eb9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#aeed71b588441f7580d8f3bf9d27a7eb9">set_mana</a> (int new_mana)</td></tr>
<tr class="separator:aeed71b588441f7580d8f3bf9d27a7eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f18d965190b820f8b2b91170a899580"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a3f18d965190b820f8b2b91170a899580">update_mana</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;guy, float turns)</td></tr>
<tr class="separator:a3f18d965190b820f8b2b91170a899580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba521f548900ab333a4b13884baa2c6d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#aba521f548900ab333a4b13884baa2c6d">has_enough_energy</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;guy, const <a class="el" href="classspell.html">spell</a> &amp;sp) const</td></tr>
<tr class="separator:aba521f548900ab333a4b13884baa2c6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0373cb48f63ed992b40057b8e30d7e7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a0373cb48f63ed992b40057b8e30d7e7c">clear_opens_spellbook_data</a> ()</td></tr>
<tr class="separator:a0373cb48f63ed992b40057b8e30d7e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9085db0eed27ce45061cdc575ea9b6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#ab9085db0eed27ce45061cdc575ea9b6e">evaluate_opens_spellbook_data</a> ()</td></tr>
<tr class="separator:ab9085db0eed27ce45061cdc575ea9b6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadc9db2d8635c2b6e6e28f14bf689cd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#aadc9db2d8635c2b6e6e28f14bf689cd1">on_mutation_gain</a> (const <a class="el" href="type__id_8h.html#a44aa01c09faf1c1723400eb9075a1f4d">trait_id</a> &amp;mid, <a class="el" href="classCharacter.html">Character</a> &amp;guy)</td></tr>
<tr class="separator:aadc9db2d8635c2b6e6e28f14bf689cd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8492a7babf0a12769b76bff2e61e0098"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a8492a7babf0a12769b76bff2e61e0098">on_mutation_loss</a> (const <a class="el" href="type__id_8h.html#a44aa01c09faf1c1723400eb9075a1f4d">trait_id</a> &amp;mid)</td></tr>
<tr class="separator:a8492a7babf0a12769b76bff2e61e0098"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8acd3edf4541649cd1b1ee21124dd0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#af8acd3edf4541649cd1b1ee21124dd0a">serialize</a> (<a class="el" href="classJsonOut.html">JsonOut</a> &amp;json) const</td></tr>
<tr class="separator:af8acd3edf4541649cd1b1ee21124dd0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9438df7eceda90e40f98f3d6a1f38147"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a9438df7eceda90e40f98f3d6a1f38147">deserialize</a> (const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;data)</td></tr>
<tr class="separator:a9438df7eceda90e40f98f3d6a1f38147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1adf916c9f70a561c9475f40c94259f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#ad1adf916c9f70a561c9475f40c94259f">set_invlet</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp, int invlet, const std::set&lt; int &gt; &amp;used_invlets)</td></tr>
<tr class="separator:ad1adf916c9f70a561c9475f40c94259f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c29f4c065729517316b825e410641df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a9c29f4c065729517316b825e410641df">rem_invlet</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp)</td></tr>
<tr class="separator:a9c29f4c065729517316b825e410641df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bb52cad9c545b82cd57eb1d45dc09a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a0bb52cad9c545b82cd57eb1d45dc09a0">toggle_favorite</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp)</td></tr>
<tr class="separator:a0bb52cad9c545b82cd57eb1d45dc09a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01400dc46a0d3fd5ee23bc8be16f0a55"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a01400dc46a0d3fd5ee23bc8be16f0a55">is_favorite</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp)</td></tr>
<tr class="separator:a01400dc46a0d3fd5ee23bc8be16f0a55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a8feaad1d7a7ecbb054556ef48e4599c6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a8feaad1d7a7ecbb054556ef48e4599c6">casting_ignore</a> = false</td></tr>
<tr class="separator:a8feaad1d7a7ecbb054556ef48e4599c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3556aef7b10779c8854c6983c215ac0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#ad3556aef7b10779c8854c6983c215ac0">caster_level_adjustment</a></td></tr>
<tr class="separator:ad3556aef7b10779c8854c6983c215ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ec7fa9b848fb3e139f1b9d7b6f4cb40"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a>, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">caster_level_adjustment_by_spell</a></td></tr>
<tr class="separator:a8ec7fa9b848fb3e139f1b9d7b6f4cb40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dafae5436ced5d37e293d92c1bacd57"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="type__id_8h.html#a44aa01c09faf1c1723400eb9075a1f4d">trait_id</a>, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a1dafae5436ced5d37e293d92c1bacd57">caster_level_adjustment_by_school</a></td></tr>
<tr class="separator:a1dafae5436ced5d37e293d92c1bacd57"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:adb9da4817cfdc19624a8674d4cc16fea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#adb9da4817cfdc19624a8674d4cc16fea">get_spellname_max_width</a> ()</td></tr>
<tr class="separator:adb9da4817cfdc19624a8674d4cc16fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c16301084172b5bd459c257af9c002"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a92c16301084172b5bd459c257af9c002">get_invlet</a> (const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;sp, std::set&lt; int &gt; &amp;used_invlets)</td></tr>
<tr class="separator:a92c16301084172b5bd459c257af9c002"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af94169b33d6d2cd59d75efac9f92c570"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a>, <a class="el" href="classspell.html">spell</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a></td></tr>
<tr class="separator:af94169b33d6d2cd59d75efac9f92c570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb326bf0885177b20fd45f26a6d68ad"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a>, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a></td></tr>
<tr class="separator:abdb326bf0885177b20fd45f26a6d68ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b997dd1160faca05064fad5c845e8f"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a></td></tr>
<tr class="separator:af3b997dd1160faca05064fad5c845e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e2bc1600c4888fb87cc14508f0111c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">mana_base</a> = 0</td></tr>
<tr class="separator:a2e2bc1600c4888fb87cc14508f0111c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7545cd34ae575060a438e9a6486762e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> = 0</td></tr>
<tr class="separator:a7545cd34ae575060a438e9a6486762e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00645">645</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2e9d576a3710bfe2534471e630df5bb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9d576a3710bfe2534471e630df5bb7">&#9670;&nbsp;</a></span>known_magic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">known_magic::known_magic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l01917">1917</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;{</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <a class="code" href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">mana_base</a> = 1000;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> = <a class="code" href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">mana_base</a>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_a2e2bc1600c4888fb87cc14508f0111c3"><div class="ttname"><a href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">known_magic::mana_base</a></div><div class="ttdeci">int mana_base</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00655">magic.h:655</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a7545cd34ae575060a438e9a6486762e6"><div class="ttname"><a href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">known_magic::mana</a></div><div class="ttdeci">int mana</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00657">magic.h:657</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00657">mana</a>, and <a class="el" href="magic_8h_source.html#l00655">mana_base</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afe4bbf2ea0bcb6c32349b7a54640b6c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe4bbf2ea0bcb6c32349b7a54640b6c5">&#9670;&nbsp;</a></span>available_mana()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int known_magic::available_mana </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02136">2136</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;{</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a>;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00657">mana</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02185">has_enough_energy()</a>.</p>

</div>
</div>
<a id="ad4bdf834ec136179f6755e4566435b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4bdf834ec136179f6755e4566435b61">&#9670;&nbsp;</a></span>can_learn_spell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool known_magic::can_learn_spell </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02104">2104</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;{</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keyword">const</span> <a class="code" href="classspell__type.html">spell_type</a> &amp;sp_t = sp.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>();</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="keywordflow">if</span>( sp_t.<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ) {</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="keywordflow">if</span>( sp_t.<a class="code" href="classspell__type.html#a74d93ff32c5d02d21548e7164e39b7f1">spell_tags</a>[<a class="code" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba32c2090ece9876c90fa493fc4054151a">spell_flag::MUST_HAVE_CLASS_TO_LEARN</a>] ) {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( sp_t.<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="keywordflow">return</span> !guy.<a class="code" href="classCharacter.html#a809f85bef6731c16373600ad9f97dad7">has_opposite_trait</a>( sp_t.<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    }</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;}</div>
<div class="ttc" id="aclassCharacter_html_a809f85bef6731c16373600ad9f97dad7"><div class="ttname"><a href="classCharacter.html#a809f85bef6731c16373600ad9f97dad7">Character::has_opposite_trait</a></div><div class="ttdeci">bool has_opposite_trait(const trait_id &amp;flag) const</div><div class="ttdoc">Returns true if the player has a trait which cancels the entered trait.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10039">character.cpp:10039</a></div></div>
<div class="ttc" id="aclassCharacter_html_af06dd97724f4f05df782e7a4b4f9cfe1"><div class="ttname"><a href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">Character::has_trait</a></div><div class="ttdeci">bool has_trait(const trait_id &amp;b) const override</div><div class="ttdoc">Returns true if the player has the entered trait.</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8cpp_source.html#l00111">mutation.cpp:111</a></div></div>
<div class="ttc" id="aclassspell__type_html"><div class="ttname"><a href="classspell__type.html">spell_type</a></div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00197">magic.h:198</a></div></div>
<div class="ttc" id="aclassspell__type_html_a74d93ff32c5d02d21548e7164e39b7f1"><div class="ttname"><a href="classspell__type.html#a74d93ff32c5d02d21548e7164e39b7f1">spell_type::spell_tags</a></div><div class="ttdeci">enum_bitset&lt; spell_flag &gt; spell_tags</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00359">magic.h:359</a></div></div>
<div class="ttc" id="aclassspell__type_html_a77a45ea3e4de418a9fbe8849be99d27c"><div class="ttname"><a href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_type::spell_class</a></div><div class="ttdeci">trait_id spell_class</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00321">magic.h:321</a></div></div>
<div class="ttc" id="aclassstring__id_html_a4796245d3cd6e0283670698a98d46ae9"><div class="ttname"><a href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">string_id::obj</a></div><div class="ttdeci">const T &amp; obj() const</div><div class="ttdoc">Returns the actual object this id refers to.</div><div class="ttdef"><b>Definition:</b> <a href="achievement_8cpp_source.html#l00071">achievement.cpp:71</a></div></div>
<div class="ttc" id="amagic_8cpp_html_ad4dc12b16a8db4bc3a0debd31fa0ca5d"><div class="ttname"><a href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a></div><div class="ttdeci">static const trait_id trait_NONE(&quot;NONE&quot;)</div></div>
<div class="ttc" id="amagic_8h_html_a8c5adb88f821564363888cbe773f197ba32c2090ece9876c90fa493fc4054151a"><div class="ttname"><a href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba32c2090ece9876c90fa493fc4054151a">spell_flag::MUST_HAVE_CLASS_TO_LEARN</a></div><div class="ttdeci">@ MUST_HAVE_CLASS_TO_LEARN</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character_8cpp_source.html#l10039">Character::has_opposite_trait()</a>, <a class="el" href="mutation_8cpp_source.html#l00111">Character::has_trait()</a>, <a class="el" href="magic_8h.html#a8c5adb88f821564363888cbe773f197ba32c2090ece9876c90fa493fc4054151a">MUST_HAVE_CLASS_TO_LEARN</a>, <a class="el" href="achievement_8cpp_source.html#l00071">string_id&lt; T &gt;::obj()</a>, <a class="el" href="magic_8h_source.html#l00321">spell_type::spell_class</a>, <a class="el" href="magic_8h_source.html#l00359">spell_type::spell_tags</a>, and <a class="el" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l01987">learn_spell()</a>.</p>

</div>
</div>
<a id="a0373cb48f63ed992b40057b8e30d7e7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0373cb48f63ed992b40057b8e30d7e7c">&#9670;&nbsp;</a></span>clear_opens_spellbook_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::clear_opens_spellbook_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02209">2209</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;{</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <a class="code" href="classknown__magic.html#ad3556aef7b10779c8854c6983c215ac0">caster_level_adjustment</a> = 0;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <a class="code" href="classknown__magic.html#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">caster_level_adjustment_by_spell</a>.clear();</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <a class="code" href="classknown__magic.html#a1dafae5436ced5d37e293d92c1bacd57">caster_level_adjustment_by_school</a>.clear();</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classspell.html">spell</a> *sp : <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>() ) {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        sp-&gt;clear_temp_adjustments();</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_a1dafae5436ced5d37e293d92c1bacd57"><div class="ttname"><a href="classknown__magic.html#a1dafae5436ced5d37e293d92c1bacd57">known_magic::caster_level_adjustment_by_school</a></div><div class="ttdeci">std::map&lt; trait_id, double &gt; caster_level_adjustment_by_school</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00714">magic.h:714</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a8ec7fa9b848fb3e139f1b9d7b6f4cb40"><div class="ttname"><a href="classknown__magic.html#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">known_magic::caster_level_adjustment_by_spell</a></div><div class="ttdeci">std::map&lt; spell_id, double &gt; caster_level_adjustment_by_spell</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00713">magic.h:713</a></div></div>
<div class="ttc" id="aclassknown__magic_html_ad3556aef7b10779c8854c6983c215ac0"><div class="ttname"><a href="classknown__magic.html#ad3556aef7b10779c8854c6983c215ac0">known_magic::caster_level_adjustment</a></div><div class="ttdeci">double caster_level_adjustment</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00712">magic.h:712</a></div></div>
<div class="ttc" id="aclassknown__magic_html_af47da2a24159ff7852576b1db2e30eab"><div class="ttname"><a href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">known_magic::get_spells</a></div><div class="ttdeci">std::vector&lt; spell * &gt; get_spells()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02126">magic.cpp:2126</a></div></div>
<div class="ttc" id="aclassspell_html"><div class="ttname"><a href="classspell.html">spell</a></div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00421">magic.h:422</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00712">caster_level_adjustment</a>, <a class="el" href="magic_8h_source.html#l00714">caster_level_adjustment_by_school</a>, <a class="el" href="magic_8h_source.html#l00713">caster_level_adjustment_by_spell</a>, and <a class="el" href="magic_8cpp_source.html#l02126">get_spells()</a>.</p>

</div>
</div>
<a id="a9438df7eceda90e40f98f3d6a1f38147"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9438df7eceda90e40f98f3d6a1f38147">&#9670;&nbsp;</a></span>deserialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::deserialize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l01944">1944</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;{</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    data.<a class="code" href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">read</a>( <span class="stringliteral">&quot;mana&quot;</span>, <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> );</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classJsonObject.html">JsonObject</a> jo : data.<a class="code" href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">get_array</a>( <span class="stringliteral">&quot;spellbook&quot;</span> ) ) {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        std::string <span class="keywordtype">id</span> = jo.get_string( <span class="stringliteral">&quot;id&quot;</span> );</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <a class="code" href="classstring__id.html">spell_id</a> sp = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="keywordtype">int</span> xp = jo.get_int( <span class="stringliteral">&quot;xp&quot;</span> );</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>[sp].set_exp( xp );</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.emplace( sp, <a class="code" href="classspell.html">spell</a>( sp, xp ) );</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        }</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    data.<a class="code" href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">read</a>( <span class="stringliteral">&quot;invlets&quot;</span>, <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a> );</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    data.<a class="code" href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">read</a>( <span class="stringliteral">&quot;favorites&quot;</span>, <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a> );</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;}</div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">cata_variant_type::spell_id</a></div><div class="ttdeci">@ spell_id</div></div>
<div class="ttc" id="aclassJsonObject_html"><div class="ttname"><a href="classJsonObject.html">JsonObject</a></div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00526">flexbuffer_json.h:527</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a8517ac783372bd0bf149ab8e5f7aae18"><div class="ttname"><a href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">JsonObject::read</a></div><div class="ttdeci">bool read(std::string_view name, T &amp;t, bool throw_on_error=true) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l01059">flexbuffer_json-inl.h:1059</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a88142edb1dd9ea1e7a96c7a99cd70896"><div class="ttname"><a href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">JsonObject::get_array</a></div><div class="ttdeci">JsonArray get_array(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00855">flexbuffer_json-inl.h:855</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a67d5ecb476afb7f4a131ee82f223e44e"><div class="ttname"><a href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">known_magic::knows_spell</a></div><div class="ttdeci">bool knows_spell() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01972">magic.cpp:1972</a></div></div>
<div class="ttc" id="aclassknown__magic_html_abdb326bf0885177b20fd45f26a6d68ad"><div class="ttname"><a href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">known_magic::invlets</a></div><div class="ttdeci">std::map&lt; spell_id, int &gt; invlets</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00651">magic.h:651</a></div></div>
<div class="ttc" id="aclassknown__magic_html_af3b997dd1160faca05064fad5c845e8f"><div class="ttname"><a href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">known_magic::favorites</a></div><div class="ttdeci">std::unordered_set&lt; spell_id &gt; favorites</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00653">magic.h:653</a></div></div>
<div class="ttc" id="aclassknown__magic_html_af94169b33d6d2cd59d75efac9f92c570"><div class="ttname"><a href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">known_magic::spellbook</a></div><div class="ttdeci">std::map&lt; spell_id, spell &gt; spellbook</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00649">magic.h:649</a></div></div>
<div class="ttc" id="aclassstring__id_html"><div class="ttname"><a href="classstring__id.html">string_id&lt; spell_type &gt;</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00653">favorites</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l00855">JsonObject::get_array()</a>, <a class="el" href="magic_8h_source.html#l00651">invlets</a>, <a class="el" href="magic_8cpp_source.html#l01972">knows_spell()</a>, <a class="el" href="magic_8h_source.html#l00657">mana</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l01059">JsonObject::read()</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>, and <a class="el" href="magic_8h_source.html#l00649">spellbook</a>.</p>

</div>
</div>
<a id="ab9085db0eed27ce45061cdc575ea9b6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9085db0eed27ce45061cdc575ea9b6e">&#9670;&nbsp;</a></span>evaluate_opens_spellbook_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::evaluate_opens_spellbook_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02219">2219</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;{</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classspell.html">spell</a> *sp : <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>() ) {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="keywordtype">double</span> raw_level_adjust = <a class="code" href="classknown__magic.html#ad3556aef7b10779c8854c6983c215ac0">caster_level_adjustment</a>;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        std::map&lt;trait_id, double&gt;::iterator school_it =</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            <a class="code" href="classknown__magic.html#a1dafae5436ced5d37e293d92c1bacd57">caster_level_adjustment_by_school</a>.find( sp-&gt;spell_class() );</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <span class="keywordflow">if</span>( school_it != <a class="code" href="classknown__magic.html#a1dafae5436ced5d37e293d92c1bacd57">caster_level_adjustment_by_school</a>.end() ) {</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            raw_level_adjust += school_it-&gt;second;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        }</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        std::map&lt;spell_id, double&gt;::iterator spell_it =</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            <a class="code" href="classknown__magic.html#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">caster_level_adjustment_by_spell</a>.find( sp-&gt;id() );</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        <span class="keywordflow">if</span>( spell_it != <a class="code" href="classknown__magic.html#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">caster_level_adjustment_by_spell</a>.end() ) {</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            raw_level_adjust += spell_it-&gt;second;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        }</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        <span class="keywordtype">int</span> final_level = <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( sp-&gt;get_level() + <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( raw_level_adjust ), 0,</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                                 sp-&gt;get_max_level( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() ) );</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        sp-&gt;set_temp_level_adjustment( final_level - sp-&gt;get_level() );</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;}</div>
<div class="ttc" id="acata__utility_8h_html_ad22b4a043b6eb4c2c06f87f83b720b15"><div class="ttname"><a href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a></div><div class="ttdeci">constexpr T clamp(const T &amp;val, const T &amp;min, const T &amp;max)</div><div class="ttdoc">Clamp first argument so that it is no lower than second and no higher than third.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00221">cata_utility.h:221</a></div></div>
<div class="ttc" id="acharacter_8h_html_abaafa6561de05c3b1324214e3048745a"><div class="ttname"><a href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a></div><div class="ttdeci">Character &amp; get_player_character()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13807">game.cpp:13807</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00712">caster_level_adjustment</a>, <a class="el" href="magic_8h_source.html#l00714">caster_level_adjustment_by_school</a>, <a class="el" href="magic_8h_source.html#l00713">caster_level_adjustment_by_spell</a>, <a class="el" href="cata__utility_8h_source.html#l00221">clamp()</a>, <a class="el" href="game_8cpp_source.html#l13807">get_player_character()</a>, and <a class="el" href="magic_8cpp_source.html#l02126">get_spells()</a>.</p>

</div>
</div>
<a id="ad23426154495b1a395dc6309ce47c6cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad23426154495b1a395dc6309ce47c6cc">&#9670;&nbsp;</a></span>forget_spell() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::forget_spell </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02047">2047</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;{</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Can&#39;t forget a spell you don&#39;t know!&quot;</span> );</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;All knowledge of %s leaves you.&quot;</span> ), sp-&gt;<a class="code" href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">name</a> );</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="comment">// TODO: add parameter for owner of known_magic for this function</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">event_type::character_forgets_spell</a>&gt;( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.erase( sp );</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;}</div>
<div class="ttc" id="aclassCharacter_html_adb54bdcb284abb66b6be99c8ae225065"><div class="ttname"><a href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">Character::getID</a></div><div class="ttdeci">character_id getID() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00652">character.cpp:652</a></div></div>
<div class="ttc" id="aclassevent__bus_html_ab753616a3a663185377ac52560068194"><div class="ttname"><a href="classevent__bus.html#ab753616a3a663185377ac52560068194">event_bus::send</a></div><div class="ttdeci">void send(const cata::event &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="event__bus_8cpp_source.html#l00072">event_bus.cpp:72</a></div></div>
<div class="ttc" id="aclassspell__type_html_a27241a7d092889a2be195551797dfbf8"><div class="ttname"><a href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">spell_type::id</a></div><div class="ttdeci">spell_id id</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00205">magic.h:205</a></div></div>
<div class="ttc" id="aclassspell__type_html_adcac4bcd0931ffd34281a9eed747d93c"><div class="ttname"><a href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">spell_type::name</a></div><div class="ttdeci">translation name</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00210">magic.h:210</a></div></div>
<div class="ttc" id="adebug_8h_html_a87e509562277a7ada3a75330d00cb445"><div class="ttname"><a href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a></div><div class="ttdeci">#define debugmsg(...)</div><div class="ttdoc">Debug message of level D_ERROR and class D_MAIN, also includes the source file name and line,...</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00069">debug.h:69</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a></div><div class="ttdeci">@ m_bad</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00348">enums.h:348</a></div></div>
<div class="ttc" id="aevent_8h_html_a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9"><div class="ttname"><a href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">event_type::character_forgets_spell</a></div><div class="ttdeci">@ character_forgets_spell</div></div>
<div class="ttc" id="aevent__bus_8h_html_a4f760194b9225ccf92a1419748def636"><div class="ttname"><a href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a></div><div class="ttdeci">event_bus &amp; get_event_bus()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13832">game.cpp:13832</a></div></div>
<div class="ttc" id="amessages_8cpp_html_a54489326fc37823819c5105addfa27f2"><div class="ttname"><a href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a></div><div class="ttdeci">void add_msg(std::string msg)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8cpp_source.html#l00997">messages.cpp:997</a></div></div>
<div class="ttc" id="atranslations_8h_html_ab92bb4161a6308b302d283816975c3a6"><div class="ttname"><a href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a></div><div class="ttdeci">#define _(STRING)</div><div class="ttdef"><b>Definition:</b> <a href="translations_8h_source.html#l00089">translations.h:89</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00089">_</a>, <a class="el" href="messages_8cpp_source.html#l00997">add_msg()</a>, <a class="el" href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">character_forgets_spell</a>, <a class="el" href="debug_8h_source.html#l00069">debugmsg</a>, <a class="el" href="game_8cpp_source.html#l13832">get_event_bus()</a>, <a class="el" href="game_8cpp_source.html#l13807">get_player_character()</a>, <a class="el" href="character_8cpp_source.html#l00652">Character::getID()</a>, <a class="el" href="magic_8h_source.html#l00205">spell_type::id</a>, <a class="el" href="magic_8cpp_source.html#l01972">knows_spell()</a>, <a class="el" href="enums_8h_source.html#l00348">m_bad</a>, <a class="el" href="magic_8h_source.html#l00210">spell_type::name</a>, <a class="el" href="event__bus_8cpp_source.html#l00072">event_bus::send()</a>, and <a class="el" href="magic_8h_source.html#l00649">spellbook</a>.</p>

</div>
</div>
<a id="a51f338d00a8e83a453e33766b5a05bd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51f338d00a8e83a453e33766b5a05bd6">&#9670;&nbsp;</a></span>forget_spell() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::forget_spell </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>sp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02042">2042</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;{</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <a class="code" href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6">forget_spell</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( sp ) );</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_a51f338d00a8e83a453e33766b5a05bd6"><div class="ttname"><a href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6">known_magic::forget_spell</a></div><div class="ttdeci">void forget_spell(const std::string &amp;sp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02042">magic.cpp:2042</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02828">on_mutation_loss()</a>.</p>

</div>
</div>
<a id="a92c16301084172b5bd459c257af9c002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92c16301084172b5bd459c257af9c002">&#9670;&nbsp;</a></span>get_invlet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int known_magic::get_invlet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>used_invlets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02707">2707</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;{</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <span class="keyword">auto</span> found = <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a>.find( sp );</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="keywordflow">if</span>( found != <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a>.end() ) {</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        <span class="keywordflow">return</span> found-&gt;second;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    }</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const spell_id, int&gt; &amp;invlet_pair : <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a> ) {</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        used_invlets.emplace( invlet_pair.second );</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    }</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = <span class="charliteral">&#39;a&#39;</span>; i &lt;= <span class="charliteral">&#39;z&#39;</span>; i++ ) {</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        <span class="keywordflow">if</span>( used_invlets.count( i ) == 0 ) {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            used_invlets.emplace( i );</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;            <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    }</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = <span class="charliteral">&#39;A&#39;</span>; i &lt;= <span class="charliteral">&#39;Z&#39;</span>; i++ ) {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        <span class="keywordflow">if</span>( used_invlets.count( i ) == 0 ) {</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            used_invlets.emplace( i );</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        }</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    }</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = <span class="charliteral">&#39;!&#39;</span>; i &lt;= <span class="charliteral">&#39;-&#39;</span>; i++ ) {</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;        <span class="keywordflow">if</span>( used_invlets.count( i ) == 0 ) {</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            used_invlets.emplace( i );</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        }</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00651">invlets</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02737">select_spell()</a>.</p>

</div>
</div>
<a id="a86c3dca5ebcd118303a6be29a38a73ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86c3dca5ebcd118303a6be29a38a73ea">&#9670;&nbsp;</a></span>get_spell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classspell.html">spell</a> &amp; known_magic::get_spell </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02117">2117</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;{</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: Tried to get unknown spell&quot;</span> );</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    }</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <a class="code" href="classspell.html">spell</a> &amp;temp_spell = <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>[ sp ];</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="keywordflow">return</span> temp_spell;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="debug_8h_source.html#l00069">debugmsg</a>, <a class="el" href="magic_8cpp_source.html#l01972">knows_spell()</a>, and <a class="el" href="magic_8h_source.html#l00649">spellbook</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02817">on_mutation_gain()</a>, <a class="el" href="magic_8cpp_source.html#l02079">set_spell_exp()</a>, and <a class="el" href="magic_8cpp_source.html#l02059">set_spell_level()</a>.</p>

</div>
</div>
<a id="afae34b16f3a80bc74ab70ad176b2a70e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afae34b16f3a80bc74ab70ad176b2a70e">&#9670;&nbsp;</a></span>get_spellbook()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a>, <a class="el" href="classspell.html">spell</a>&gt;&amp; known_magic::get_spellbook </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00690">690</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                                 {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00649">spellbook</a>.</p>

</div>
</div>
<a id="adb9da4817cfdc19624a8674d4cc16fea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb9da4817cfdc19624a8674d4cc16fea">&#9670;&nbsp;</a></span>get_spellname_max_width()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int known_magic::get_spellname_max_width </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02253">2253</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;{</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keywordtype">int</span> width = 0;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> *sp : <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>() ) {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        width = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( width, <a class="code" href="catacharset_8cpp.html#af20ee33da59ccceb9f4c14005c0bbe80">utf8_width</a>( sp-&gt;name() ) );</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keywordflow">return</span> width;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;}</div>
<div class="ttc" id="acatacharset_8cpp_html_af20ee33da59ccceb9f4c14005c0bbe80"><div class="ttname"><a href="catacharset_8cpp.html#af20ee33da59ccceb9f4c14005c0bbe80">utf8_width</a></div><div class="ttdeci">int utf8_width(const std::string_view s, const bool ignore_tags)</div><div class="ttdef"><b>Definition:</b> <a href="catacharset_8cpp_source.html#l00104">catacharset.cpp:104</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a9009aa9e5eb1323238ebddffd8e1aedf"><div class="ttname"><a href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">max</a></div><div class="ttdeci">double max(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00035">math_parser_func.h:35</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8cpp_source.html#l02126">get_spells()</a>, <a class="el" href="math__parser__func_8h_source.html#l00035">max()</a>, and <a class="el" href="catacharset_8cpp_source.html#l00104">utf8_width()</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02737">select_spell()</a>.</p>

</div>
</div>
<a id="af47da2a24159ff7852576b1db2e30eab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af47da2a24159ff7852576b1db2e30eab">&#9670;&nbsp;</a></span>get_spells()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classspell.html">spell</a> * &gt; known_magic::get_spells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02126">2126</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;{</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    std::vector&lt;spell *&gt; <a class="code" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">spells</a>;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <a class="code" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">spells</a>.reserve( <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.size() );</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;spell_pair : <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a> ) {</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        <a class="code" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">spells</a>.emplace_back( &amp;spell_pair.second );</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    }</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">spells</a>;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_ab05f99ea584c7bec9ab34369e14369f0"><div class="ttname"><a href="classknown__magic.html#ab05f99ea584c7bec9ab34369e14369f0">known_magic::spells</a></div><div class="ttdeci">std::vector&lt; spell_id &gt; spells() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02174">magic.cpp:2174</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00649">spellbook</a>, and <a class="el" href="magic_8cpp_source.html#l02174">spells()</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02209">clear_opens_spellbook_data()</a>, <a class="el" href="magic_8cpp_source.html#l02219">evaluate_opens_spellbook_data()</a>, <a class="el" href="magic_8cpp_source.html#l02253">get_spellname_max_width()</a>, <a class="el" href="magic_8cpp_source.html#l02828">on_mutation_loss()</a>, and <a class="el" href="magic_8cpp_source.html#l02737">select_spell()</a>.</p>

</div>
</div>
<a id="aba521f548900ab333a4b13884baa2c6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba521f548900ab333a4b13884baa2c6d">&#9670;&nbsp;</a></span>has_enough_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool known_magic::has_enough_energy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classspell.html">spell</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02185">2185</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;{</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keywordtype">int</span> cost = sp.<a class="code" href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924">energy_cost</a>( guy );</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keywordflow">switch</span>( sp.<a class="code" href="classspell.html#a593232b1e5fc4c81d536724d40322efd">energy_source</a>() ) {</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f">magic_energy_type::mana</a>:</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#afe4bbf2ea0bcb6c32349b7a54640b6c5">available_mana</a>() &gt;= cost;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d">magic_energy_type::bionic</a>:</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#add22510ff2fa20a662868b4dd86e030e">get_power_level</a>() &gt;= <a class="code" href="namespaceunits.html#a9a9f862b2cd8fb3133a67b8bf927b017">units::from_kilojoule</a>( <span class="keyword">static_cast&lt;</span>std::int64_t<span class="keyword">&gt;</span>( cost ) );</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">magic_energy_type::stamina</a>:</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#a0ffe14df559cee6e9b5d02f5b214d009">get_stamina</a>() &gt;= cost;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a>:</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const bodypart_str_id, bodypart&gt; &amp;elem : guy.<a class="code" href="classCreature.html#ac4dbde454c86b3296f53681c60612974">get_body</a>() ) {</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                <span class="keywordflow">if</span>( elem.second.get_hp_cur() &gt; cost ) {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            }</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8">magic_energy_type::none</a>:</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    }</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;}</div>
<div class="ttc" id="aclassCharacter_html_a0ffe14df559cee6e9b5d02f5b214d009"><div class="ttname"><a href="classCharacter.html#a0ffe14df559cee6e9b5d02f5b214d009">Character::get_stamina</a></div><div class="ttdeci">int get_stamina() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l06806">character.cpp:6806</a></div></div>
<div class="ttc" id="aclassCharacter_html_add22510ff2fa20a662868b4dd86e030e"><div class="ttname"><a href="classCharacter.html#add22510ff2fa20a662868b4dd86e030e">Character::get_power_level</a></div><div class="ttdeci">units::energy get_power_level() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l02824">character.cpp:2824</a></div></div>
<div class="ttc" id="aclassCreature_html_ac4dbde454c86b3296f53681c60612974"><div class="ttname"><a href="classCreature.html#ac4dbde454c86b3296f53681c60612974">Creature::get_body</a></div><div class="ttdeci">const std::map&lt; bodypart_str_id, bodypart &gt; &amp; get_body() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l02167">creature.cpp:2167</a></div></div>
<div class="ttc" id="aclassknown__magic_html_afe4bbf2ea0bcb6c32349b7a54640b6c5"><div class="ttname"><a href="classknown__magic.html#afe4bbf2ea0bcb6c32349b7a54640b6c5">known_magic::available_mana</a></div><div class="ttdeci">int available_mana() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02136">magic.cpp:2136</a></div></div>
<div class="ttc" id="aclassspell_html_a4ddf2ffd71f86bc2ca2ebca259071924"><div class="ttname"><a href="classspell.html#a4ddf2ffd71f86bc2ca2ebca259071924">spell::energy_cost</a></div><div class="ttdeci">int energy_cost(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01040">magic.cpp:1040</a></div></div>
<div class="ttc" id="aclassspell_html_a593232b1e5fc4c81d536724d40322efd"><div class="ttname"><a href="classspell.html#a593232b1e5fc4c81d536724d40322efd">spell::energy_source</a></div><div class="ttdeci">magic_energy_type energy_source() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01459">magic.cpp:1459</a></div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8">magic_energy_type::none</a></div><div class="ttdeci">@ none</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f">magic_energy_type::mana</a></div><div class="ttdeci">@ mana</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d">magic_energy_type::bionic</a></div><div class="ttdeci">@ bionic</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">magic_energy_type::stamina</a></div><div class="ttdeci">@ stamina</div></div>
<div class="ttc" id="amagic_8h_html_aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025"><div class="ttname"><a href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">magic_energy_type::hp</a></div><div class="ttdeci">@ hp</div></div>
<div class="ttc" id="anamespaceunits_html_a9a9f862b2cd8fb3133a67b8bf927b017"><div class="ttname"><a href="namespaceunits.html#a9a9f862b2cd8fb3133a67b8bf927b017">units::from_kilojoule</a></div><div class="ttdeci">constexpr quantity&lt; value_type, energy_in_millijoule_tag &gt; from_kilojoule(const value_type v)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00555">units.h:555</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8cpp_source.html#l02136">available_mana()</a>, <a class="el" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aa6acf03e06c9aa4b52e754089a17a13d">bionic</a>, <a class="el" href="magic_8cpp_source.html#l01040">spell::energy_cost()</a>, <a class="el" href="magic_8cpp_source.html#l01459">spell::energy_source()</a>, <a class="el" href="units_8h_source.html#l00555">units::from_kilojoule()</a>, <a class="el" href="creature_8cpp_source.html#l02167">Creature::get_body()</a>, <a class="el" href="character_8cpp_source.html#l02824">Character::get_power_level()</a>, <a class="el" href="character_8cpp_source.html#l06806">Character::get_stamina()</a>, <a class="el" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1ad2ccda10db94c2b5d51beed10484c025">hp</a>, <a class="el" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a582fc884d6299814fbd4f12c1f9ae70f">mana</a>, <a class="el" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1a334c4a4c42fdb79d7ebc3e73b517e6f8">none</a>, and <a class="el" href="magic_8h.html#aecee704c18d07f266d2b907c070bd7a1aae3d27c3f9334ce5e3a9806605151cae">stamina</a>.</p>

</div>
</div>
<a id="a01400dc46a0d3fd5ee23bc8be16f0a55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01400dc46a0d3fd5ee23bc8be16f0a55">&#9670;&nbsp;</a></span>is_favorite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool known_magic::is_favorite </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02702">2702</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;{</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.count( sp ) &gt; 0;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00653">favorites</a>.</p>

</div>
</div>
<a id="a67d5ecb476afb7f4a131ee82f223e44e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d5ecb476afb7f4a131ee82f223e44e">&#9670;&nbsp;</a></span>knows_spell() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool known_magic::knows_spell </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l01972">1972</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;{</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">return</span> !<a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.empty();</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00649">spellbook</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l01944">deserialize()</a>, <a class="el" href="magic_8cpp_source.html#l02047">forget_spell()</a>, <a class="el" href="magic_8cpp_source.html#l02117">get_spell()</a>, <a class="el" href="magic_8cpp_source.html#l01962">knows_spell()</a>, <a class="el" href="magic_8cpp_source.html#l02079">set_spell_exp()</a>, and <a class="el" href="magic_8cpp_source.html#l02059">set_spell_level()</a>.</p>

</div>
</div>
<a id="a8921c5cb6ecfcb2ad0f76a54f516070b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8921c5cb6ecfcb2ad0f76a54f516070b">&#9670;&nbsp;</a></span>knows_spell() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool known_magic::knows_spell </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l01967">1967</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;{</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.count( sp ) == 1;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00649">spellbook</a>.</p>

</div>
</div>
<a id="af808c41802489957df2f33a5e3e381c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af808c41802489957df2f33a5e3e381c7">&#9670;&nbsp;</a></span>knows_spell() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool known_magic::knows_spell </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>sp</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l01962">1962</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;{</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( sp ) );</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8cpp_source.html#l01972">knows_spell()</a>, and <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>.</p>

</div>
</div>
<a id="aeab7b087a69b633b0ae61509ca5e0d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeab7b087a69b633b0ae61509ca5e0d48">&#9670;&nbsp;</a></span>learn_spell() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::learn_spell </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l01982">1982</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;{</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <a class="code" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">learn_spell</a>( &amp;sp.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>(), guy, <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> );</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_a39b5a4fcc441be1ebdaba7bcbb22fffa"><div class="ttname"><a href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">known_magic::learn_spell</a></div><div class="ttdeci">void learn_spell(const std::string &amp;sp, Character &amp;guy, bool force=false)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01977">magic.cpp:1977</a></div></div>
<div class="ttc" id="acreature_8h_html_a4b73e33b57ae387dc418906492d5f998"><div class="ttname"><a href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a></div><div class="ttdeci">bool force</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00241">creature.h:241</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="creature_8h_source.html#l00241">force</a>, <a class="el" href="magic_8cpp_source.html#l01977">learn_spell()</a>, and <a class="el" href="achievement_8cpp_source.html#l00071">string_id&lt; T &gt;::obj()</a>.</p>

</div>
</div>
<a id="a7dc8309c014c9d2698826bdb8883cd39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dc8309c014c9d2698826bdb8883cd39">&#9670;&nbsp;</a></span>learn_spell() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::learn_spell </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classspell__type.html">spell_type</a> *&#160;</td>
          <td class="paramname"><em>sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l01987">1987</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;{</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="keywordflow">if</span>( !sp-&gt;<a class="code" href="classspell__type.html#ab9b1f0c5e1c6127b4bb37b371ff09e92">is_valid</a>() ) {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Tried to learn invalid spell&quot;</span> );</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keywordflow">if</span>( guy.<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;knows_spell( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> ) ) {</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="comment">// you already know the spell</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <a class="code" href="classspell.html">spell</a> temp_spell( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="keywordflow">if</span>( !temp_spell.is_valid() ) {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Tried to learn invalid spell&quot;</span> );</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> &amp;&amp; sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> != <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ) {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classknown__magic.html#ad4bdf834ec136179f6755e4566435b61">can_learn_spell</a>( guy, sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> ) &amp;&amp; !guy.<a class="code" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> ) ) {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            std::string trait_cancel;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">trait_id</a> &amp;<a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a> : sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a> ) {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a> == sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.back() &amp;&amp;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                    sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.back() != sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.front() ) {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                    trait_cancel = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;%s and %s&quot;</span> ), trait_cancel, <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a>-&gt;name() );</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a> == sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.front() ) {</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                    trait_cancel = <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a>-&gt;name();</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                    <span class="keywordflow">if</span>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.size() == 1 ) {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                        trait_cancel = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s: %s&quot;</span>, trait_cancel, <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a>-&gt;desc() );</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                    }</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                    trait_cancel = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;%s, %s&quot;</span> ), trait_cancel, <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a>-&gt;name() );</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                }</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a> == sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">cancels</a>.back() ) {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                    trait_cancel += <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                }</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            }</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            <span class="keywordflow">if</span>( !guy.<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() || <a class="code" href="output_8cpp.html#ab62599a77867b8f416669b92f60f4900">query_yn</a>(</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                    <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Learning this spell will make you a\n\n%s: %s\n\nand lock you out of\n\n%s\n\nContinue?&quot;</span> ),</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                    sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a2805339d7f40d83fbfb0846cca44761c">name</a>(), sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>-&gt;<a class="code" href="structmutation__branch.html#a67f764c2a0612a360980e59a5e4fef21">desc</a>(), trait_cancel ) ) {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                guy.<a class="code" href="classCharacter.html#a9256aa3e6577c96e4a19eb23d8810ca6">set_mutation</a>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                guy.<a class="code" href="classCharacter.html#a4609d68fa1977aefed931d2a51afa52b">on_mutation_gain</a>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                guy.<a class="code" href="classCharacter.html#af0503012f1ff927cbb5ad126e39cb103">add_msg_if_player</a>( sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a>.<a class="code" href="classstring__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmutation__branch.html#a67f764c2a0612a360980e59a5e4fef21">desc</a>() );</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            }</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        }</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> || <a class="code" href="classknown__magic.html#ad4bdf834ec136179f6755e4566435b61">can_learn_spell</a>( guy, sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> ) ) {</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.emplace( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a>, temp_spell );</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">event_type::character_learns_spell</a>&gt;( guy.<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        guy.<a class="code" href="classCharacter.html#ac81e06f5fbbb42c673f235a6f37d9d4b">add_msg_player_or_npc</a>( <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10">m_good</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;You learned %s!&quot;</span> ), <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;&lt;npcname&gt; learned %s!&quot;</span> ), sp-&gt;<a class="code" href="classspell__type.html#adcac4bcd0931ffd34281a9eed747d93c">name</a> );</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        guy.<a class="code" href="classCharacter.html#ac81e06f5fbbb42c673f235a6f37d9d4b">add_msg_player_or_npc</a>( <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;You can&#39;t learn this spell.&quot;</span> ),</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                                   <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;&lt;npcname&gt; can&#39;t learn this spell.&quot;</span> ) );</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;}</div>
<div class="ttc" id="aclassCharacter_html_a4609d68fa1977aefed931d2a51afa52b"><div class="ttname"><a href="classCharacter.html#a4609d68fa1977aefed931d2a51afa52b">Character::on_mutation_gain</a></div><div class="ttdeci">void on_mutation_gain(const trait_id &amp;mid)</div><div class="ttdoc">Called when a mutation is gained.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10010">character.cpp:10010</a></div></div>
<div class="ttc" id="aclassCharacter_html_a9256aa3e6577c96e4a19eb23d8810ca6"><div class="ttname"><a href="classCharacter.html#a9256aa3e6577c96e4a19eb23d8810ca6">Character::set_mutation</a></div><div class="ttdeci">void set_mutation(const trait_id &amp;, const mutation_variant *=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8cpp_source.html#l00283">mutation.cpp:283</a></div></div>
<div class="ttc" id="aclassCharacter_html_ac81e06f5fbbb42c673f235a6f37d9d4b"><div class="ttname"><a href="classCharacter.html#ac81e06f5fbbb42c673f235a6f37d9d4b">Character::add_msg_player_or_npc</a></div><div class="ttdeci">void add_msg_player_or_npc(const std::string &amp;player_msg, const std::string &amp;npc_str) const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00861">character.cpp:861</a></div></div>
<div class="ttc" id="aclassCharacter_html_af0503012f1ff927cbb5ad126e39cb103"><div class="ttname"><a href="classCharacter.html#af0503012f1ff927cbb5ad126e39cb103">Character::add_msg_if_player</a></div><div class="ttdeci">void add_msg_if_player(const std::string &amp;msg) const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00856">character.cpp:856</a></div></div>
<div class="ttc" id="aclassCharacter_html_af2ff32cce5f17bcf04be958121abe524"><div class="ttname"><a href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">Character::magic</a></div><div class="ttdeci">pimpl&lt; known_magic &gt; magic</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02485">character.h:2485</a></div></div>
<div class="ttc" id="aclassCreature_html_ac209d32cbfd3774af3d5c0500e2fae52"><div class="ttname"><a href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">Creature::is_avatar</a></div><div class="ttdeci">virtual bool is_avatar() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00265">creature.h:265</a></div></div>
<div class="ttc" id="aclassknown__magic_html_ad4bdf834ec136179f6755e4566435b61"><div class="ttname"><a href="classknown__magic.html#ad4bdf834ec136179f6755e4566435b61">known_magic::can_learn_spell</a></div><div class="ttdeci">bool can_learn_spell(const Character &amp;guy, const spell_id &amp;sp) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02104">magic.cpp:2104</a></div></div>
<div class="ttc" id="aclassspell__type_html_ab9b1f0c5e1c6127b4bb37b371ff09e92"><div class="ttname"><a href="classspell__type.html#ab9b1f0c5e1c6127b4bb37b371ff09e92">spell_type::is_valid</a></div><div class="ttdeci">bool is_valid() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l00644">magic.cpp:644</a></div></div>
<div class="ttc" id="acraft__command_8h_html_a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402"><div class="ttname"><a href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">usage_from::cancel</a></div><div class="ttdeci">@ cancel</div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10">m_good</a></div><div class="ttdeci">@ m_good</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00347">enums.h:347</a></div></div>
<div class="ttc" id="aevent_8h_html_a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098"><div class="ttname"><a href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">event_type::character_learns_spell</a></div><div class="ttdeci">@ character_learns_spell</div></div>
<div class="ttc" id="aoutput_8cpp_html_ab62599a77867b8f416669b92f60f4900"><div class="ttname"><a href="output_8cpp.html#ab62599a77867b8f416669b92f60f4900">query_yn</a></div><div class="ttdeci">bool query_yn(const std::string &amp;text)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00811">output.cpp:811</a></div></div>
<div class="ttc" id="astring__formatter_8h_html_a8964099387da2f95396c67566bafce3d"><div class="ttname"><a href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a></div><div class="ttdeci">std::string string_format(std::string_view format, Args &amp;&amp;...args)</div><div class="ttdoc">Simple wrapper over string_formatter::parse.</div><div class="ttdef"><b>Definition:</b> <a href="string__formatter_8h_source.html#l00417">string_formatter.h:417</a></div></div>
<div class="ttc" id="astructmutation__branch_html_a2805339d7f40d83fbfb0846cca44761c"><div class="ttname"><a href="structmutation__branch.html#a2805339d7f40d83fbfb0846cca44761c">mutation_branch::name</a></div><div class="ttdeci">std::string name(const std::string &amp;variant=&quot;&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="mutation__data_8cpp_source.html#l00579">mutation_data.cpp:579</a></div></div>
<div class="ttc" id="astructmutation__branch_html_a47e84e29e1d8622962a99479ef99bf0f"><div class="ttname"><a href="structmutation__branch.html#a47e84e29e1d8622962a99479ef99bf0f">mutation_branch::cancels</a></div><div class="ttdeci">std::vector&lt; trait_id &gt; cancels</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8h_source.html#l00324">mutation.h:324</a></div></div>
<div class="ttc" id="astructmutation__branch_html_a67f764c2a0612a360980e59a5e4fef21"><div class="ttname"><a href="structmutation__branch.html#a67f764c2a0612a360980e59a5e4fef21">mutation_branch::desc</a></div><div class="ttdeci">std::string desc(const std::string &amp;variant=&quot;&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="mutation__data_8cpp_source.html#l00589">mutation_data.cpp:589</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00089">_</a>, <a class="el" href="character_8cpp_source.html#l00856">Character::add_msg_if_player()</a>, <a class="el" href="character_8cpp_source.html#l00861">Character::add_msg_player_or_npc()</a>, <a class="el" href="magic_8cpp_source.html#l02104">can_learn_spell()</a>, <a class="el" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa10aec35353f9c4096a71c38654c3d402">cancel</a>, <a class="el" href="mutation_8h_source.html#l00324">mutation_branch::cancels</a>, <a class="el" href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">character_learns_spell</a>, <a class="el" href="debug_8h_source.html#l00069">debugmsg</a>, <a class="el" href="mutation__data_8cpp_source.html#l00589">mutation_branch::desc()</a>, <a class="el" href="creature_8h_source.html#l00241">force</a>, <a class="el" href="game_8cpp_source.html#l13832">get_event_bus()</a>, <a class="el" href="character_8cpp_source.html#l00652">Character::getID()</a>, <a class="el" href="mutation_8cpp_source.html#l00111">Character::has_trait()</a>, <a class="el" href="magic_8h_source.html#l00205">spell_type::id</a>, <a class="el" href="creature_8h_source.html#l00265">Creature::is_avatar()</a>, <a class="el" href="magic_8cpp_source.html#l00644">spell_type::is_valid()</a>, <a class="el" href="magic_8cpp_source.html#l01395">spell::is_valid()</a>, <a class="el" href="enums_8h_source.html#l00348">m_bad</a>, <a class="el" href="enums_8h_source.html#l00347">m_good</a>, <a class="el" href="character_8h_source.html#l02485">Character::magic</a>, <a class="el" href="magic_8h_source.html#l00210">spell_type::name</a>, <a class="el" href="mutation__data_8cpp_source.html#l00579">mutation_branch::name()</a>, <a class="el" href="achievement_8cpp_source.html#l00071">string_id&lt; T &gt;::obj()</a>, <a class="el" href="character_8cpp_source.html#l10010">Character::on_mutation_gain()</a>, <a class="el" href="output_8cpp_source.html#l00811">query_yn()</a>, <a class="el" href="event__bus_8cpp_source.html#l00072">event_bus::send()</a>, <a class="el" href="mutation_8cpp_source.html#l00283">Character::set_mutation()</a>, <a class="el" href="magic_8h_source.html#l00321">spell_type::spell_class</a>, <a class="el" href="magic_8h_source.html#l00649">spellbook</a>, <a class="el" href="string__formatter_8h_source.html#l00417">string_format()</a>, and <a class="el" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a>.</p>

</div>
</div>
<a id="a39b5a4fcc441be1ebdaba7bcbb22fffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39b5a4fcc441be1ebdaba7bcbb22fffa">&#9670;&nbsp;</a></span>learn_spell() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::learn_spell </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l01977">1977</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;{</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <a class="code" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">learn_spell</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( sp ), guy, <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> );</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="creature_8h_source.html#l00241">force</a>, and <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l01982">learn_spell()</a>, and <a class="el" href="magic_8cpp_source.html#l02817">on_mutation_gain()</a>.</p>

</div>
</div>
<a id="af1d54e77049ce1b9ed9d20a559ae0a38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1d54e77049ce1b9ed9d20a559ae0a38">&#9670;&nbsp;</a></span>max_mana()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int known_magic::max_mana </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02151">2151</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;{</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> int_bonus = ( ( 0.2f + guy.<a class="code" href="classCharacter.html#a588d5cc1d729490552fe03b006685ae5">get_int</a>() * 0.1f ) - 1.0f ) * <a class="code" href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">mana_base</a>;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="keywordtype">int</span> penalty_calc = <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( std::max&lt;int64_t&gt;( 0,</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                                   <a class="code" href="namespaceunits.html#a7f3948de70e78d68af74fb3d119cf176">units::to_kilojoule</a>( guy.<a class="code" href="classCharacter.html#add22510ff2fa20a662868b4dd86e030e">get_power_level</a>() ) ) );</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> bionic_penalty = guy.<a class="code" href="classCharacter.html#add870e576ff59aa6943af286576219e9">enchantment_cache</a>-&gt;modify_value(</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                                   <a class="code" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a6d2912cc5d535f00c9c7405dcd9f25d3">enchant_vals::mod::BIONIC_MANA_PENALTY</a>, penalty_calc );</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> unaugmented_mana = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0.0f,</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                                   ( <a class="code" href="classknown__magic.html#a2e2bc1600c4888fb87cc14508f0111c3">mana_base</a> + int_bonus ) - bionic_penalty );</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#a18fed39d4de0f6d75af204da88833098">calculate_by_enchantment</a>( unaugmented_mana, <a class="code" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998ab808652fb6f0bf7ede1ba2cdaf1f8b84">enchant_vals::mod::MAX_MANA</a>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;}</div>
<div class="ttc" id="aclassCharacter_html_a18fed39d4de0f6d75af204da88833098"><div class="ttname"><a href="classCharacter.html#a18fed39d4de0f6d75af204da88833098">Character::calculate_by_enchantment</a></div><div class="ttdeci">double calculate_by_enchantment(double modify, enchant_vals::mod value, bool round_output=false) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l07807">character.cpp:7807</a></div></div>
<div class="ttc" id="aclassCharacter_html_a588d5cc1d729490552fe03b006685ae5"><div class="ttname"><a href="classCharacter.html#a588d5cc1d729490552fe03b006685ae5">Character::get_int</a></div><div class="ttdeci">int get_int() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l04139">character.cpp:4139</a></div></div>
<div class="ttc" id="aclassCharacter_html_add870e576ff59aa6943af286576219e9"><div class="ttname"><a href="classCharacter.html#add870e576ff59aa6943af286576219e9">Character::enchantment_cache</a></div><div class="ttdeci">pimpl&lt; enchant_cache &gt; enchantment_cache</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l04105">character.h:4105</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a5834219bcffc7118c95b395b8cdeec20"><div class="ttname"><a href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">round</a></div><div class="ttdeci">double round(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00110">math_parser_func.h:110</a></div></div>
<div class="ttc" id="anamespaceenchant__vals_html_acd6a6ebb27f9ecb82b3bce1d3aef2998a6d2912cc5d535f00c9c7405dcd9f25d3"><div class="ttname"><a href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a6d2912cc5d535f00c9c7405dcd9f25d3">enchant_vals::mod::BIONIC_MANA_PENALTY</a></div><div class="ttdeci">@ BIONIC_MANA_PENALTY</div></div>
<div class="ttc" id="anamespaceenchant__vals_html_acd6a6ebb27f9ecb82b3bce1d3aef2998ab808652fb6f0bf7ede1ba2cdaf1f8b84"><div class="ttname"><a href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998ab808652fb6f0bf7ede1ba2cdaf1f8b84">enchant_vals::mod::MAX_MANA</a></div><div class="ttdeci">@ MAX_MANA</div></div>
<div class="ttc" id="anamespaceunits_html_a7f3948de70e78d68af74fb3d119cf176"><div class="ttname"><a href="namespaceunits.html#a7f3948de70e78d68af74fb3d119cf176">units::to_kilojoule</a></div><div class="ttdeci">constexpr value_type to_kilojoule(const quantity&lt; value_type, energy_in_millijoule_tag &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00578">units.h:578</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a6d2912cc5d535f00c9c7405dcd9f25d3">enchant_vals::BIONIC_MANA_PENALTY</a>, <a class="el" href="character_8cpp_source.html#l07807">Character::calculate_by_enchantment()</a>, <a class="el" href="character_8h_source.html#l04105">Character::enchantment_cache</a>, <a class="el" href="character_8cpp_source.html#l04139">Character::get_int()</a>, <a class="el" href="character_8cpp_source.html#l02824">Character::get_power_level()</a>, <a class="el" href="magic_8h_source.html#l00655">mana_base</a>, <a class="el" href="math__parser__func_8h_source.html#l00035">max()</a>, <a class="el" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998ab808652fb6f0bf7ede1ba2cdaf1f8b84">enchant_vals::MAX_MANA</a>, <a class="el" href="math__parser__func_8h_source.html#l00110">round()</a>, and <a class="el" href="units_8h_source.html#l00578">units::to_kilojoule()</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02146">mod_mana()</a>, and <a class="el" href="magic_8cpp_source.html#l02165">update_mana()</a>.</p>

</div>
</div>
<a id="ae44e12a998ae53c5d487828d83165168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae44e12a998ae53c5d487828d83165168">&#9670;&nbsp;</a></span>mod_mana()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::mod_mana </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>add_mana</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02146">2146</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;{</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <a class="code" href="classknown__magic.html#aeed71b588441f7580d8f3bf9d27a7eb9">set_mana</a>( <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> + add_mana, 0, <a class="code" href="classknown__magic.html#af1d54e77049ce1b9ed9d20a559ae0a38">max_mana</a>( guy ) ) );</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_aeed71b588441f7580d8f3bf9d27a7eb9"><div class="ttname"><a href="classknown__magic.html#aeed71b588441f7580d8f3bf9d27a7eb9">known_magic::set_mana</a></div><div class="ttdeci">void set_mana(int new_mana)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02141">magic.cpp:2141</a></div></div>
<div class="ttc" id="aclassknown__magic_html_af1d54e77049ce1b9ed9d20a559ae0a38"><div class="ttname"><a href="classknown__magic.html#af1d54e77049ce1b9ed9d20a559ae0a38">known_magic::max_mana</a></div><div class="ttdeci">int max_mana(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02151">magic.cpp:2151</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cata__utility_8h_source.html#l00221">clamp()</a>, <a class="el" href="magic_8h_source.html#l00657">mana</a>, <a class="el" href="magic_8cpp_source.html#l02151">max_mana()</a>, and <a class="el" href="magic_8cpp_source.html#l02141">set_mana()</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02165">update_mana()</a>.</p>

</div>
</div>
<a id="aadc9db2d8635c2b6e6e28f14bf689cd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadc9db2d8635c2b6e6e28f14bf689cd1">&#9670;&nbsp;</a></span>on_mutation_gain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::on_mutation_gain </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a44aa01c09faf1c1723400eb9075a1f4d">trait_id</a> &amp;&#160;</td>
          <td class="paramname"><em>mid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02817">2817</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;{</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const spell_id, int&gt; &amp;sp : mid-&gt;<a class="code" href="structmutation__branch.html#a7c0ff24a9aac03207154197f7f6fa789">spells_learned</a> ) {</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        <a class="code" href="classknown__magic.html#a39b5a4fcc441be1ebdaba7bcbb22fffa">learn_spell</a>( sp.first, guy, <span class="keyword">true</span> );</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;        <a class="code" href="classspell.html">spell</a> &amp;temp_sp = <a class="code" href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">get_spell</a>( sp.first );</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> level = 0; level &lt; sp.second; level++ ) {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;            temp_sp.<a class="code" href="classspell.html#a682544edebcf289a96fc4fcd812890c8">gain_level</a>( guy );</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;        }</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    }</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_a86c3dca5ebcd118303a6be29a38a73ea"><div class="ttname"><a href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">known_magic::get_spell</a></div><div class="ttdeci">spell &amp; get_spell(const spell_id &amp;sp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02117">magic.cpp:2117</a></div></div>
<div class="ttc" id="aclassspell_html_a682544edebcf289a96fc4fcd812890c8"><div class="ttname"><a href="classspell.html#a682544edebcf289a96fc4fcd812890c8">spell::gain_level</a></div><div class="ttdeci">void gain_level(const Character &amp;guy)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01005">magic.cpp:1005</a></div></div>
<div class="ttc" id="astructmutation__branch_html_a7c0ff24a9aac03207154197f7f6fa789"><div class="ttname"><a href="structmutation__branch.html#a7c0ff24a9aac03207154197f7f6fa789">mutation_branch::spells_learned</a></div><div class="ttdeci">std::map&lt; spell_id, int &gt; spells_learned</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8h_source.html#l00271">mutation.h:271</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8cpp_source.html#l01005">spell::gain_level()</a>, <a class="el" href="magic_8cpp_source.html#l02117">get_spell()</a>, <a class="el" href="magic_8cpp_source.html#l01977">learn_spell()</a>, and <a class="el" href="mutation_8h_source.html#l00271">mutation_branch::spells_learned</a>.</p>

</div>
</div>
<a id="a8492a7babf0a12769b76bff2e61e0098"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8492a7babf0a12769b76bff2e61e0098">&#9670;&nbsp;</a></span>on_mutation_loss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::on_mutation_loss </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a44aa01c09faf1c1723400eb9075a1f4d">trait_id</a> &amp;&#160;</td>
          <td class="paramname"><em>mid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02828">2828</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;{</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    std::vector&lt;spell_id&gt; spells_to_forget;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> *sp : <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>() ) {</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        <span class="keywordflow">if</span>( sp-&gt;is_spell_class( mid ) ) {</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;            spells_to_forget.emplace_back( sp-&gt;id() );</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        }</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    }</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classstring__id.html">spell_id</a> &amp;sp_id : spells_to_forget ) {</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        <a class="code" href="classknown__magic.html#a51f338d00a8e83a453e33766b5a05bd6">forget_spell</a>( sp_id );</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    }</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8cpp_source.html#l02042">forget_spell()</a>, and <a class="el" href="magic_8cpp_source.html#l02126">get_spells()</a>.</p>

</div>
</div>
<a id="a9c29f4c065729517316b825e410641df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c29f4c065729517316b825e410641df">&#9670;&nbsp;</a></span>rem_invlet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::rem_invlet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02688">2688</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;{</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a>.erase( sp );</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00651">invlets</a>.</p>

</div>
</div>
<a id="a98a91b2ff64d726c4d54f04a3fee000e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98a91b2ff64d726c4d54f04a3fee000e">&#9670;&nbsp;</a></span>select_spell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int known_magic::select_spell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02737">2737</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;{</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="comment">// max width of spell names</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> max_spell_name_length = <a class="code" href="classknown__magic.html#adb9da4817cfdc19624a8674d4cc16fea">get_spellname_max_width</a>();</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    std::vector&lt;spell *&gt; known_spells = <a class="code" href="classknown__magic.html#af47da2a24159ff7852576b1db2e30eab">get_spells</a>();</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160; </div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <a class="code" href="classuilist.html">uilist</a> spell_menu;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a7d03ff2194b5dc30035d88d77108f6a4">w_height_setup</a> = [&amp;]() -&gt; <span class="keywordtype">int</span> {</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( known_spells.size() ), 24, <a class="code" href="output_8cpp.html#a567a63be8cb70cc3eb47bf8affced8e5">TERMY</a> * 9 / 10 );</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    };</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> calc_width = []() -&gt; <span class="keywordtype">int</span> {</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 80, <a class="code" href="output_8cpp.html#a000abea6447dfafd5f9b787aa6753609">TERMX</a> * 3 / 8 );</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    };</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a5dac54c98fae0ec2bc4b0ac75c9fcd57">w_width_setup</a> = calc_width;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a790be01eb1b3db027e262729e5e95aae">pad_right_setup</a> = [&amp;]() -&gt; <span class="keywordtype">int</span> {</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        <span class="keywordflow">return</span> calc_width() - max_spell_name_length - 5;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    };</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a53ff5990a6abb4e7da837db31afea4b8">title</a> = <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Choose a Spell&quot;</span> );</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a3d9259dd0d2627c4768fb4a17cddf3b6">input_category</a> = <span class="stringliteral">&quot;SPELL_MENU&quot;</span>;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;CHOOSE_INVLET&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;CAST_IGNORE&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;SCROLL_UP_SPELL_MENU&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;SCROLL_DOWN_SPELL_MENU&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">additional_actions</a>.emplace_back( <span class="stringliteral">&quot;SCROLL_FAVORITE&quot;</span>, <a class="code" href="classtranslation.html">translation</a>() );</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    spell_menu.<a class="code" href="classuilist.html#ae4ae08b4f010935825c956ea705065aa">hilight_disabled</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <a class="code" href="classspellcasting__callback.html">spellcasting_callback</a> cb( known_spells, <a class="code" href="classknown__magic.html#a8feaad1d7a7ecbb054556ef48e4599c6">casting_ignore</a> );</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    spell_menu.<a class="code" href="classuilist.html#ad4f5806d1d8ab3de3af8e3285faf47d6">callback</a> = &amp;cb;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a96c497ff6d2c333effba75839fdccede">add_category</a>( <span class="stringliteral">&quot;all&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;All&quot;</span> ) );</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    spell_menu.<a class="code" href="classuilist.html#a96c497ff6d2c333effba75839fdccede">add_category</a>( <span class="stringliteral">&quot;favorites&quot;</span>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Favorites&quot;</span> ) );</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160; </div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    std::vector&lt;std::pair&lt;std::string, std::string&gt;&gt; categories;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classspell.html">spell</a> *s : known_spells ) {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        <span class="keywordflow">if</span>( s-&gt;can_cast( guy ) &amp;&amp; ( s-&gt;spell_class().is_valid() || s-&gt;spell_class() == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ) ) {</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            <span class="keyword">const</span> std::string spell_class_name = s-&gt;spell_class() == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ? <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Classless&quot;</span> ) :</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                                                 s-&gt;spell_class().obj().<a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a>();</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;            categories.emplace_back( s-&gt;spell_class().str(), spell_class_name );</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;            std::sort( categories.begin(), categories.end(), []( <span class="keyword">const</span> std::pair&lt;std::string, std::string&gt; &amp;<a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>,</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;            <span class="keyword">const</span> std::pair&lt;std::string, std::string&gt; &amp;<a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> ) {</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                return localized_compare( a.second, b.second );</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            } );</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> itr = std::unique( categories.begin(), categories.end() );</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            categories.erase( itr, categories.end() );</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        }</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    }</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="keywordflow">for</span>( std::pair&lt;std::string, std::string&gt; &amp;cat : categories ) {</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        spell_menu.<a class="code" href="classuilist.html#a96c497ff6d2c333effba75839fdccede">add_category</a>( cat.first, cat.second );</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    }</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160; </div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    spell_menu.<a class="code" href="classuilist.html#add589714bd51df0cbac9b947403004c1">set_category_filter</a>( [&amp;guy, known_spells]( <span class="keyword">const</span> <a class="code" href="structuilist__entry.html">uilist_entry</a> &amp; entry,</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <span class="keyword">const</span> std::string &amp; key )-&gt;<span class="keywordtype">bool</span> {</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        <span class="keywordflow">if</span>( key == <span class="stringliteral">&quot;all&quot;</span> )</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        {</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( key == <span class="stringliteral">&quot;favorites&quot;</span> )</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        {</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;            <span class="keywordflow">return</span> guy.<a class="code" href="classCharacter.html#af2ff32cce5f17bcf04be958121abe524">magic</a>-&gt;is_favorite( known_spells[entry.<a class="code" href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">retval</a>]-&gt;id() );</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        }</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <span class="keywordflow">return</span> ( known_spells[entry.<a class="code" href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">retval</a>]-&gt;spell_class().is_valid() || known_spells[entry.<a class="code" href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">retval</a>]-&gt;spell_class() == <a class="code" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a> ) &amp;&amp; known_spells[entry.<a class="code" href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">retval</a>]-&gt;spell_class().str() == key;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    } );</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.empty() ) {</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        spell_menu.<a class="code" href="classuilist.html#a9c00fd7c5cdfee33072eca7d816a4e62">set_category</a>( <span class="stringliteral">&quot;favorites&quot;</span> );</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        spell_menu.<a class="code" href="classuilist.html#a9c00fd7c5cdfee33072eca7d816a4e62">set_category</a>( <span class="stringliteral">&quot;all&quot;</span> );</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    }</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160; </div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    std::set&lt;int&gt; used_invlets{ cb.reserved_invlets };</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160; </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; known_spells.size(); i++ ) {</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        spell_menu.<a class="code" href="classuilist.html#a18fd9765355d9e418bc2c399048e0645">addentry</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( i ), known_spells[i]-&gt;can_cast( guy ),</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                             <a class="code" href="classknown__magic.html#a92c16301084172b5bd459c257af9c002">get_invlet</a>( known_spells[i]-&gt;<span class="keywordtype">id</span>(), used_invlets ), known_spells[i]-&gt;<a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a>() );</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    }</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <a class="code" href="magic_8cpp.html#a59eae2fd66ff3b9691a4cacfabbd0f3b">reflesh_favorite</a>( &amp;spell_menu, known_spells );</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160; </div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    spell_menu.<a class="code" href="group__UI.html#ga7604af7545244003f0a52ac87ce37979">query</a>();</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160; </div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <a class="code" href="classknown__magic.html#a8feaad1d7a7ecbb054556ef48e4599c6">casting_ignore</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="classspellcasting__callback.html">spellcasting_callback</a> *<span class="keyword">&gt;</span>( spell_menu.<a class="code" href="classuilist.html#ad4f5806d1d8ab3de3af8e3285faf47d6">callback</a> )-&gt;<a class="code" href="classknown__magic.html#a8feaad1d7a7ecbb054556ef48e4599c6">casting_ignore</a>;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; </div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    <span class="keywordflow">return</span> spell_menu.<a class="code" href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">ret</a>;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_a8feaad1d7a7ecbb054556ef48e4599c6"><div class="ttname"><a href="classknown__magic.html#a8feaad1d7a7ecbb054556ef48e4599c6">known_magic::casting_ignore</a></div><div class="ttdeci">bool casting_ignore</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00661">magic.h:661</a></div></div>
<div class="ttc" id="aclassknown__magic_html_a92c16301084172b5bd459c257af9c002"><div class="ttname"><a href="classknown__magic.html#a92c16301084172b5bd459c257af9c002">known_magic::get_invlet</a></div><div class="ttdeci">int get_invlet(const spell_id &amp;sp, std::set&lt; int &gt; &amp;used_invlets)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02707">magic.cpp:2707</a></div></div>
<div class="ttc" id="aclassknown__magic_html_adb9da4817cfdc19624a8674d4cc16fea"><div class="ttname"><a href="classknown__magic.html#adb9da4817cfdc19624a8674d4cc16fea">known_magic::get_spellname_max_width</a></div><div class="ttdeci">int get_spellname_max_width()</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02253">magic.cpp:2253</a></div></div>
<div class="ttc" id="aclassspellcasting__callback_html"><div class="ttname"><a href="classspellcasting__callback.html">spellcasting_callback</a></div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02292">magic.cpp:2293</a></div></div>
<div class="ttc" id="aclasstranslation_html"><div class="ttname"><a href="classtranslation.html">translation</a></div><div class="ttdoc">Class for storing translation context and raw string for deferred translation.</div><div class="ttdef"><b>Definition:</b> <a href="translation_8h_source.html#l00017">translation.h:18</a></div></div>
<div class="ttc" id="aclassuilist_html"><div class="ttname"><a href="classuilist.html">uilist</a></div><div class="ttdoc">uilist: scrolling vertical list menu</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00231">ui.h:232</a></div></div>
<div class="ttc" id="aclassuilist_html_a0baa34622db6972a59d47d478bfd21d6"><div class="ttname"><a href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">uilist::ret</a></div><div class="ttdeci">int ret</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00525">ui.h:525</a></div></div>
<div class="ttc" id="aclassuilist_html_a18fd9765355d9e418bc2c399048e0645"><div class="ttname"><a href="classuilist.html#a18fd9765355d9e418bc2c399048e0645">uilist::addentry</a></div><div class="ttdeci">void addentry(const std::string &amp;txt)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01210">ui.cpp:1210</a></div></div>
<div class="ttc" id="aclassuilist_html_a3d9259dd0d2627c4768fb4a17cddf3b6"><div class="ttname"><a href="classuilist.html#a3d9259dd0d2627c4768fb4a17cddf3b6">uilist::input_category</a></div><div class="ttdeci">std::string input_category</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00424">ui.h:424</a></div></div>
<div class="ttc" id="aclassuilist_html_a53ff5990a6abb4e7da837db31afea4b8"><div class="ttname"><a href="classuilist.html#a53ff5990a6abb4e7da837db31afea4b8">uilist::title</a></div><div class="ttdeci">std::string title</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00418">ui.h:418</a></div></div>
<div class="ttc" id="aclassuilist_html_a5dac54c98fae0ec2bc4b0ac75c9fcd57"><div class="ttname"><a href="classuilist.html#a5dac54c98fae0ec2bc4b0ac75c9fcd57">uilist::w_width_setup</a></div><div class="ttdeci">size_scalar w_width_setup</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00438">ui.h:438</a></div></div>
<div class="ttc" id="aclassuilist_html_a790be01eb1b3db027e262729e5e95aae"><div class="ttname"><a href="classuilist.html#a790be01eb1b3db027e262729e5e95aae">uilist::pad_right_setup</a></div><div class="ttdeci">size_scalar pad_right_setup</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00444">ui.h:444</a></div></div>
<div class="ttc" id="aclassuilist_html_a7d03ff2194b5dc30035d88d77108f6a4"><div class="ttname"><a href="classuilist.html#a7d03ff2194b5dc30035d88d77108f6a4">uilist::w_height_setup</a></div><div class="ttdeci">size_scalar w_height_setup</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00439">ui.h:439</a></div></div>
<div class="ttc" id="aclassuilist_html_a96c497ff6d2c333effba75839fdccede"><div class="ttname"><a href="classuilist.html#a96c497ff6d2c333effba75839fdccede">uilist::add_category</a></div><div class="ttdeci">void add_category(const std::string &amp;key, const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01269">ui.cpp:1269</a></div></div>
<div class="ttc" id="aclassuilist_html_a9b6f96a3e12c8b35fe79a2b3e4605d5c"><div class="ttname"><a href="classuilist.html#a9b6f96a3e12c8b35fe79a2b3e4605d5c">uilist::additional_actions</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; std::string, translation &gt; &gt; additional_actions</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00425">ui.h:425</a></div></div>
<div class="ttc" id="aclassuilist_html_a9c00fd7c5cdfee33072eca7d816a4e62"><div class="ttname"><a href="classuilist.html#a9c00fd7c5cdfee33072eca7d816a4e62">uilist::set_category</a></div><div class="ttdeci">void set_category(const std::string &amp;key)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01274">ui.cpp:1274</a></div></div>
<div class="ttc" id="aclassuilist_html_ad4f5806d1d8ab3de3af8e3285faf47d6"><div class="ttname"><a href="classuilist.html#ad4f5806d1d8ab3de3af8e3285faf47d6">uilist::callback</a></div><div class="ttdeci">uilist_callback * callback</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00434">ui.h:434</a></div></div>
<div class="ttc" id="aclassuilist_html_add589714bd51df0cbac9b947403004c1"><div class="ttname"><a href="classuilist.html#add589714bd51df0cbac9b947403004c1">uilist::set_category_filter</a></div><div class="ttdeci">void set_category_filter(const std::function&lt; bool(const uilist_entry &amp;, const std::string &amp;)&gt; &amp;fun)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01283">ui.cpp:1283</a></div></div>
<div class="ttc" id="aclassuilist_html_ae4ae08b4f010935825c956ea705065aa"><div class="ttname"><a href="classuilist.html#ae4ae08b4f010935825c956ea705065aa">uilist::hilight_disabled</a></div><div class="ttdeci">bool hilight_disabled</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00467">ui.h:467</a></div></div>
<div class="ttc" id="agroup__UI_html_ga7604af7545244003f0a52ac87ce37979"><div class="ttname"><a href="group__UI.html#ga7604af7545244003f0a52ac87ce37979">uilist::query</a></div><div class="ttdeci">void query(bool loop=true, int timeout=-1)</div><div class="ttdoc">Handle input and update display.</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l01032">ui.cpp:1032</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">static constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01566">magic.cpp:1566</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a59eae2fd66ff3b9691a4cacfabbd0f3b"><div class="ttname"><a href="magic_8cpp.html#a59eae2fd66ff3b9691a4cacfabbd0f3b">reflesh_favorite</a></div><div class="ttdeci">static void reflesh_favorite(uilist *menu, std::vector&lt; spell * &gt; known_spells)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02279">magic.cpp:2279</a></div></div>
<div class="ttc" id="amagic_8cpp_html_aa93a189fb7bbbf87be54bcc7bd11bb6f"><div class="ttname"><a href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a></div><div class="ttdeci">static constexpr double b</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01567">magic.cpp:1567</a></div></div>
<div class="ttc" id="anamespaceom__direction_html_a8ba958ccfad28c0a5572a04dd1428f32"><div class="ttname"><a href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">om_direction::name</a></div><div class="ttdeci">std::string name(type dir)</div><div class="ttdoc">Get Human readable name of a direction.</div><div class="ttdef"><b>Definition:</b> <a href="overmap_8cpp_source.html#l06412">overmap.cpp:6412</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a000abea6447dfafd5f9b787aa6753609"><div class="ttname"><a href="output_8cpp.html#a000abea6447dfafd5f9b787aa6753609">TERMX</a></div><div class="ttdeci">int TERMX</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00049">output.cpp:49</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a567a63be8cb70cc3eb47bf8affced8e5"><div class="ttname"><a href="output_8cpp.html#a567a63be8cb70cc3eb47bf8affced8e5">TERMY</a></div><div class="ttdeci">int TERMY</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00050">output.cpp:50</a></div></div>
<div class="ttc" id="astructuilist__entry_html"><div class="ttname"><a href="structuilist__entry.html">uilist_entry</a></div><div class="ttdoc">uilist_entry: entry line for uilist</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00059">ui.h:59</a></div></div>
<div class="ttc" id="astructuilist__entry_html_aeca572914ac103f183d3e22dacf7978d"><div class="ttname"><a href="structuilist__entry.html#aeca572914ac103f183d3e22dacf7978d">uilist_entry::retval</a></div><div class="ttdeci">int retval</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00060">ui.h:60</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00089">_</a>, <a class="el" href="magic_8cpp_source.html#l01566">a</a>, <a class="el" href="ui_8cpp_source.html#l01269">uilist::add_category()</a>, <a class="el" href="ui_8cpp_source.html#l01210">uilist::addentry()</a>, <a class="el" href="ui_8h_source.html#l00425">uilist::additional_actions</a>, <a class="el" href="magic_8cpp_source.html#l01567">b</a>, <a class="el" href="ui_8h_source.html#l00434">uilist::callback</a>, <a class="el" href="magic_8h_source.html#l00661">casting_ignore</a>, <a class="el" href="cata__utility_8h_source.html#l00221">clamp()</a>, <a class="el" href="magic_8h_source.html#l00653">favorites</a>, <a class="el" href="magic_8cpp_source.html#l02707">get_invlet()</a>, <a class="el" href="magic_8cpp_source.html#l02253">get_spellname_max_width()</a>, <a class="el" href="magic_8cpp_source.html#l02126">get_spells()</a>, <a class="el" href="ui_8h_source.html#l00467">uilist::hilight_disabled</a>, <a class="el" href="ui_8h_source.html#l00424">uilist::input_category</a>, <a class="el" href="character_8h_source.html#l02485">Character::magic</a>, <a class="el" href="math__parser__func_8h_source.html#l00035">max()</a>, <a class="el" href="overmap_8cpp_source.html#l06412">om_direction::name()</a>, <a class="el" href="ui_8h_source.html#l00444">uilist::pad_right_setup</a>, <a class="el" href="ui_8cpp_source.html#l01032">uilist::query()</a>, <a class="el" href="magic_8cpp_source.html#l02279">reflesh_favorite()</a>, <a class="el" href="magic_8cpp_source.html#l02303">spellcasting_callback::reserved_invlets</a>, <a class="el" href="ui_8h_source.html#l00525">uilist::ret</a>, <a class="el" href="ui_8h_source.html#l00060">uilist_entry::retval</a>, <a class="el" href="ui_8cpp_source.html#l01274">uilist::set_category()</a>, <a class="el" href="ui_8cpp_source.html#l01283">uilist::set_category_filter()</a>, <a class="el" href="output_8cpp_source.html#l00049">TERMX</a>, <a class="el" href="output_8cpp_source.html#l00050">TERMY</a>, <a class="el" href="ui_8h_source.html#l00418">uilist::title</a>, <a class="el" href="magic_8cpp.html#ad4dc12b16a8db4bc3a0debd31fa0ca5d">trait_NONE</a>, <a class="el" href="ui_8h_source.html#l00439">uilist::w_height_setup</a>, and <a class="el" href="ui_8h_source.html#l00438">uilist::w_width_setup</a>.</p>

</div>
</div>
<a id="af8acd3edf4541649cd1b1ee21124dd0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8acd3edf4541649cd1b1ee21124dd0a">&#9670;&nbsp;</a></span>serialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::serialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classJsonOut.html">JsonOut</a> &amp;&#160;</td>
          <td class="paramname"><em>json</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l01923">1923</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;{</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    json.<a class="code" href="classJsonOut.html#a4756f9a569adbfc60de127f7c335d82f">start_object</a>();</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;mana&quot;</span>, <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> );</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; </div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;spellbook&quot;</span> );</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    json.<a class="code" href="classJsonOut.html#a4550e2036b904c4d4a90e440dd41c684">start_array</a>();</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;pair : <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a> ) {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        json.<a class="code" href="classJsonOut.html#a4756f9a569adbfc60de127f7c335d82f">start_object</a>();</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;id&quot;</span>, pair.second.id() );</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;xp&quot;</span>, pair.second.xp() );</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        json.<a class="code" href="classJsonOut.html#aa38d37840ed6ba168b78a43570e98681">end_object</a>();</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    }</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    json.<a class="code" href="classJsonOut.html#a44cdd853d4c6913b37caa9f0131eeff2">end_array</a>();</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;invlets&quot;</span>, <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a> );</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    json.<a class="code" href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">member</a>( <span class="stringliteral">&quot;favorites&quot;</span>, <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a> );</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    json.<a class="code" href="classJsonOut.html#aa38d37840ed6ba168b78a43570e98681">end_object</a>();</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;}</div>
<div class="ttc" id="aclassJsonOut_html_a44cdd853d4c6913b37caa9f0131eeff2"><div class="ttname"><a href="classJsonOut.html#a44cdd853d4c6913b37caa9f0131eeff2">JsonOut::end_array</a></div><div class="ttdeci">void end_array()</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02346">json.cpp:2346</a></div></div>
<div class="ttc" id="aclassJsonOut_html_a4550e2036b904c4d4a90e440dd41c684"><div class="ttname"><a href="classJsonOut.html#a4550e2036b904c4d4a90e440dd41c684">JsonOut::start_array</a></div><div class="ttdeci">void start_array(bool wrap=false)</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02335">json.cpp:2335</a></div></div>
<div class="ttc" id="aclassJsonOut_html_a4756f9a569adbfc60de127f7c335d82f"><div class="ttname"><a href="classJsonOut.html#a4756f9a569adbfc60de127f7c335d82f">JsonOut::start_object</a></div><div class="ttdeci">void start_object(bool wrap=false)</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02316">json.cpp:2316</a></div></div>
<div class="ttc" id="aclassJsonOut_html_aa38d37840ed6ba168b78a43570e98681"><div class="ttname"><a href="classJsonOut.html#aa38d37840ed6ba168b78a43570e98681">JsonOut::end_object</a></div><div class="ttdeci">void end_object()</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02327">json.cpp:2327</a></div></div>
<div class="ttc" id="aclassJsonOut_html_afb935698620b87ff71b01e7763004de1"><div class="ttname"><a href="classJsonOut.html#afb935698620b87ff71b01e7763004de1">JsonOut::member</a></div><div class="ttdeci">void member(std::string_view name)</div><div class="ttdef"><b>Definition:</b> <a href="json_8cpp_source.html#l02422">json.cpp:2422</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="json_8cpp_source.html#l02346">JsonOut::end_array()</a>, <a class="el" href="json_8cpp_source.html#l02327">JsonOut::end_object()</a>, <a class="el" href="magic_8h_source.html#l00653">favorites</a>, <a class="el" href="magic_8h_source.html#l00651">invlets</a>, <a class="el" href="magic_8h_source.html#l00657">mana</a>, <a class="el" href="json_8cpp_source.html#l02422">JsonOut::member()</a>, <a class="el" href="magic_8h_source.html#l00649">spellbook</a>, <a class="el" href="json_8cpp_source.html#l02335">JsonOut::start_array()</a>, and <a class="el" href="json_8cpp_source.html#l02316">JsonOut::start_object()</a>.</p>

</div>
</div>
<a id="ad1adf916c9f70a561c9475f40c94259f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1adf916c9f70a561c9475f40c94259f">&#9670;&nbsp;</a></span>set_invlet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool known_magic::set_invlet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>invlet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>used_invlets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02679">2679</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;{</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">if</span>( used_invlets.count( invlet ) &gt; 0 ) {</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;    }</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    <a class="code" href="classknown__magic.html#abdb326bf0885177b20fd45f26a6d68ad">invlets</a>[sp] = invlet;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00651">invlets</a>.</p>

</div>
</div>
<a id="aeed71b588441f7580d8f3bf9d27a7eb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed71b588441f7580d8f3bf9d27a7eb9">&#9670;&nbsp;</a></span>set_mana()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::set_mana </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_mana</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02141">2141</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;{</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <a class="code" href="classknown__magic.html#a7545cd34ae575060a438e9a6486762e6">mana</a> = new_mana;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00657">mana</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02146">mod_mana()</a>.</p>

</div>
</div>
<a id="a90fcfdbfe3d0dd04780ff2d8e672a1ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90fcfdbfe3d0dd04780ff2d8e672a1ef">&#9670;&nbsp;</a></span>set_spell_exp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::set_spell_exp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_exp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> *&#160;</td>
          <td class="paramname"><em>guy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02079">2079</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;{</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <a class="code" href="classspell.html">spell</a> temp_spell( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        <span class="keywordflow">if</span>( new_exp &gt;= 0 ) {</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            temp_spell.set_exp( new_exp );</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.emplace( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a>, <a class="code" href="classspell.html">spell</a>( temp_spell ) );</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">event_type::character_learns_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        }</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="keywordflow">if</span>( new_exp &gt;= 0 ) {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            <a class="code" href="classspell.html">spell</a> &amp;temp_sp = <a class="code" href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">get_spell</a>( sp );</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            <span class="keywordtype">int</span> old_level = temp_sp.<a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>();</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            temp_sp.<a class="code" href="classspell.html#add2c742d2996e6c81ab5b70b081544d9">set_exp</a>( new_exp );</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            <span class="keywordflow">if</span>( guy-&gt;<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() &amp;&amp; old_level != temp_sp.<a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>() ) {</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a15d9350620fdb06df8ad3d5410d8d54f">event_type::player_levels_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a>, temp_sp.<a class="code" href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">get_level</a>(),</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                        sp-&gt;<a class="code" href="classspell__type.html#a77a45ea3e4de418a9fbe8849be99d27c">spell_class</a> );</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">event_type::character_forgets_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.erase( sp );</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        }</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    }</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;}</div>
<div class="ttc" id="aclassspell_html_a006cfd33c15f732b2463eda1ae0686cc"><div class="ttname"><a href="classspell.html#a006cfd33c15f732b2463eda1ae0686cc">spell::get_level</a></div><div class="ttdeci">int get_level() const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01570">magic.cpp:1570</a></div></div>
<div class="ttc" id="aclassspell_html_add2c742d2996e6c81ab5b70b081544d9"><div class="ttname"><a href="classspell.html#add2c742d2996e6c81ab5b70b081544d9">spell::set_exp</a></div><div class="ttdeci">void set_exp(int nxp)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01332">magic.cpp:1332</a></div></div>
<div class="ttc" id="aevent_8h_html_a333a7721472705fe444b24f107f9a731a15d9350620fdb06df8ad3d5410d8d54f"><div class="ttname"><a href="event_8h.html#a333a7721472705fe444b24f107f9a731a15d9350620fdb06df8ad3d5410d8d54f">event_type::player_levels_spell</a></div><div class="ttdeci">@ player_levels_spell</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">character_forgets_spell</a>, <a class="el" href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">character_learns_spell</a>, <a class="el" href="game_8cpp_source.html#l13832">get_event_bus()</a>, <a class="el" href="magic_8cpp_source.html#l01570">spell::get_level()</a>, <a class="el" href="magic_8cpp_source.html#l02117">get_spell()</a>, <a class="el" href="character_8cpp_source.html#l00652">Character::getID()</a>, <a class="el" href="magic_8h_source.html#l00205">spell_type::id</a>, <a class="el" href="creature_8h_source.html#l00265">Creature::is_avatar()</a>, <a class="el" href="magic_8cpp_source.html#l01972">knows_spell()</a>, <a class="el" href="event_8h.html#a333a7721472705fe444b24f107f9a731a15d9350620fdb06df8ad3d5410d8d54f">player_levels_spell</a>, <a class="el" href="event__bus_8cpp_source.html#l00072">event_bus::send()</a>, <a class="el" href="magic_8cpp_source.html#l01332">spell::set_exp()</a>, <a class="el" href="magic_8h_source.html#l00321">spell_type::spell_class</a>, and <a class="el" href="magic_8h_source.html#l00649">spellbook</a>.</p>

</div>
</div>
<a id="a800de0f2bcb32e309629216f85456e31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a800de0f2bcb32e309629216f85456e31">&#9670;&nbsp;</a></span>set_spell_level()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::set_spell_level </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>new_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> *&#160;</td>
          <td class="paramname"><em>guy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02059">2059</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;{</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <a class="code" href="classspell.html">spell</a> temp_spell( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classknown__magic.html#a67d5ecb476afb7f4a131ee82f223e44e">knows_spell</a>( sp ) ) {</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        <span class="keywordflow">if</span>( new_level &gt;= 0 ) {</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            temp_spell.set_level( *guy, new_level );</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.emplace( sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a>, <a class="code" href="classspell.html">spell</a>( temp_spell ) );</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">event_type::character_learns_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="keywordflow">if</span>( new_level &gt;= 0 ) {</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;            <a class="code" href="classspell.html">spell</a> &amp;temp_sp = <a class="code" href="classknown__magic.html#a86c3dca5ebcd118303a6be29a38a73ea">get_spell</a>( sp );</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            temp_sp.<a class="code" href="classspell.html#a21f5450a0454bf54ca779f62fada69b6">set_level</a>( *guy, new_level );</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            <a class="code" href="event__bus_8h.html#a4f760194b9225ccf92a1419748def636">get_event_bus</a>().<a class="code" href="classevent__bus.html#ab753616a3a663185377ac52560068194">send</a>&lt;<a class="code" href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">event_type::character_forgets_spell</a>&gt;( guy-&gt;<a class="code" href="classCharacter.html#adb54bdcb284abb66b6be99c8ae225065">getID</a>(), sp-&gt;<a class="code" href="classspell__type.html#a27241a7d092889a2be195551797dfbf8">id</a> );</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;            <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.erase( sp );</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        }</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;}</div>
<div class="ttc" id="aclassspell_html_a21f5450a0454bf54ca779f62fada69b6"><div class="ttname"><a href="classspell.html#a21f5450a0454bf54ca779f62fada69b6">spell::set_level</a></div><div class="ttdeci">void set_level(const Character &amp;guy, int nlevel)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01020">magic.cpp:1020</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="event_8h.html#a333a7721472705fe444b24f107f9a731a9d2ddf1e8962d5c46b2cf726d2d2b6e9">character_forgets_spell</a>, <a class="el" href="event_8h.html#a333a7721472705fe444b24f107f9a731ab7ecf72d0811e43c56d86fb716351098">character_learns_spell</a>, <a class="el" href="game_8cpp_source.html#l13832">get_event_bus()</a>, <a class="el" href="magic_8cpp_source.html#l02117">get_spell()</a>, <a class="el" href="character_8cpp_source.html#l00652">Character::getID()</a>, <a class="el" href="magic_8h_source.html#l00205">spell_type::id</a>, <a class="el" href="magic_8cpp_source.html#l01972">knows_spell()</a>, <a class="el" href="event__bus_8cpp_source.html#l00072">event_bus::send()</a>, <a class="el" href="magic_8cpp_source.html#l01020">spell::set_level()</a>, and <a class="el" href="magic_8h_source.html#l00649">spellbook</a>.</p>

</div>
</div>
<a id="ab05f99ea584c7bec9ab34369e14369f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab05f99ea584c7bec9ab34369e14369f0">&#9670;&nbsp;</a></span>spells()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &gt; known_magic::spells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02174">2174</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;{</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    std::vector&lt;spell_id&gt; spell_ids;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    spell_ids.reserve( <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a>.size() );</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const spell_id, spell&gt; &amp;pair : <a class="code" href="classknown__magic.html#af94169b33d6d2cd59d75efac9f92c570">spellbook</a> ) {</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        spell_ids.emplace_back( pair.first );</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordflow">return</span> spell_ids;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00649">spellbook</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02126">get_spells()</a>.</p>

</div>
</div>
<a id="a3ec46640014cc1ea785a7db001203b37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ec46640014cc1ea785a7db001203b37">&#9670;&nbsp;</a></span>time_to_learn_spell() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int known_magic::time_to_learn_spell </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02244">2244</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;{</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <a class="code" href="structdialogue.html">dialogue</a> d( <a class="code" href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a>( guy ), <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> base_time = to_moves&lt;int&gt;( 30_minutes );</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> int_modifier = ( guy.<a class="code" href="classCharacter.html#a588d5cc1d729490552fe03b006685ae5">get_int</a>() - 8.0 ) / 8.0;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> skill_modifier = guy.<a class="code" href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">get_skill_level</a>( sp-&gt;<a class="code" href="classspell__type.html#abd2cfd23c656755b0f887064683d9e13">skill</a> ) / 10.0;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordflow">return</span> base_time * ( 1.0 + sp-&gt;<a class="code" href="classspell__type.html#a960a7f198bd614a7c048405d7d120f61">difficulty</a>.<a class="code" href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">evaluate</a>( d ) / ( 1.0 + int_modifier + skill_modifier ) );</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;}</div>
<div class="ttc" id="aavatar_8cpp_html_a75dcf1534079311161f26d7250306379"><div class="ttname"><a href="avatar_8cpp.html#a75dcf1534079311161f26d7250306379">get_talker_for</a></div><div class="ttdeci">std::unique_ptr&lt; talker &gt; get_talker_for(avatar &amp;me)</div><div class="ttdef"><b>Definition:</b> <a href="avatar_8cpp_source.html#l01795">avatar.cpp:1795</a></div></div>
<div class="ttc" id="aclassCharacter_html_a93a3570e884214ba5c0eb3cdf1af75cc"><div class="ttname"><a href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">Character::get_skill_level</a></div><div class="ttdeci">float get_skill_level(const skill_id &amp;ident) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03428">character.cpp:3428</a></div></div>
<div class="ttc" id="aclassspell__type_html_a960a7f198bd614a7c048405d7d120f61"><div class="ttname"><a href="classspell__type.html#a960a7f198bd614a7c048405d7d120f61">spell_type::difficulty</a></div><div class="ttdeci">dbl_or_var difficulty</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00324">magic.h:324</a></div></div>
<div class="ttc" id="aclassspell__type_html_abd2cfd23c656755b0f887064683d9e13"><div class="ttname"><a href="classspell__type.html#abd2cfd23c656755b0f887064683d9e13">spell_type::skill</a></div><div class="ttdeci">skill_id skill</div><div class="ttdef"><b>Definition:</b> <a href="magic_8h_source.html#l00217">magic.h:217</a></div></div>
<div class="ttc" id="astructdbl__or__var_html_ab65089e65e8bcff8239572030573c540"><div class="ttname"><a href="structdbl__or__var.html#ab65089e65e8bcff8239572030573c540">dbl_or_var::evaluate</a></div><div class="ttdeci">double evaluate(dialogue &amp;d) const</div><div class="ttdef"><b>Definition:</b> <a href="dialogue__helpers_8cpp_source.html#l00191">dialogue_helpers.cpp:191</a></div></div>
<div class="ttc" id="astructdialogue_html"><div class="ttname"><a href="structdialogue.html">dialogue</a></div><div class="ttdef"><b>Definition:</b> <a href="dialogue_8h_source.html#l00184">dialogue.h:184</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00324">spell_type::difficulty</a>, <a class="el" href="dialogue__helpers_8cpp_source.html#l00191">dbl_or_var::evaluate()</a>, <a class="el" href="character_8cpp_source.html#l04139">Character::get_int()</a>, <a class="el" href="character_8cpp_source.html#l03428">Character::get_skill_level()</a>, <a class="el" href="avatar_8cpp_source.html#l01795">get_talker_for()</a>, and <a class="el" href="magic_8h_source.html#l00217">spell_type::skill</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02239">time_to_learn_spell()</a>.</p>

</div>
</div>
<a id="ad425ea60cd0b564225bddfd3afd7e40c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad425ea60cd0b564225bddfd3afd7e40c">&#9670;&nbsp;</a></span>time_to_learn_spell() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int known_magic::time_to_learn_spell </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02239">2239</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;{</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classknown__magic.html#a3ec46640014cc1ea785a7db001203b37">time_to_learn_spell</a>( guy, <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>( str ) );</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_a3ec46640014cc1ea785a7db001203b37"><div class="ttname"><a href="classknown__magic.html#a3ec46640014cc1ea785a7db001203b37">known_magic::time_to_learn_spell</a></div><div class="ttdeci">int time_to_learn_spell(const Character &amp;guy, const spell_id &amp;sp) const</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02244">magic.cpp:2244</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a26fc65fa85c36140553bad2b5359989f">spell_id</a>, and <a class="el" href="magic_8cpp_source.html#l02244">time_to_learn_spell()</a>.</p>

</div>
</div>
<a id="a0bb52cad9c545b82cd57eb1d45dc09a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bb52cad9c545b82cd57eb1d45dc09a0">&#9670;&nbsp;</a></span>toggle_favorite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::toggle_favorite </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a> &amp;&#160;</td>
          <td class="paramname"><em>sp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02693">2693</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;{</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.count( sp ) &gt; 0 ) {</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.erase( sp );</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <a class="code" href="classknown__magic.html#af3b997dd1160faca05064fad5c845e8f">favorites</a>.emplace( sp );</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8h_source.html#l00653">favorites</a>.</p>

</div>
</div>
<a id="a3f18d965190b820f8b2b91170a899580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f18d965190b820f8b2b91170a899580">&#9670;&nbsp;</a></span>update_mana()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void known_magic::update_mana </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>guy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>turns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8cpp_source.html#l02165">2165</a> of file <a class="el" href="magic_8cpp_source.html">magic.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;{</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="comment">// mana should replenish in 8 hours.</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> full_replenish = to_turns&lt;double&gt;( 8_hours );</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ratio = turns / full_replenish;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <a class="code" href="classknown__magic.html#ae44e12a998ae53c5d487828d83165168">mod_mana</a>( guy, <a class="code" href="math__parser__func_8h.html#a204ca52ef1b97d079c45e1cb6407f73b">std::floor</a>( ratio * guy.<a class="code" href="classCharacter.html#a18fed39d4de0f6d75af204da88833098">calculate_by_enchantment</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( <a class="code" href="classknown__magic.html#af1d54e77049ce1b9ed9d20a559ae0a38">max_mana</a>(</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                                   guy ) ), <a class="code" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a886de14f24b5a2f60b4e4a88d0a95834">enchant_vals::mod::REGEN_MANA</a> ) ) );</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;}</div>
<div class="ttc" id="aclassknown__magic_html_ae44e12a998ae53c5d487828d83165168"><div class="ttname"><a href="classknown__magic.html#ae44e12a998ae53c5d487828d83165168">known_magic::mod_mana</a></div><div class="ttdeci">void mod_mana(const Character &amp;guy, int add_mana)</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l02146">magic.cpp:2146</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a204ca52ef1b97d079c45e1cb6407f73b"><div class="ttname"><a href="math__parser__func_8h.html#a204ca52ef1b97d079c45e1cb6407f73b">floor</a></div><div class="ttdeci">double floor(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00095">math_parser_func.h:95</a></div></div>
<div class="ttc" id="anamespaceenchant__vals_html_acd6a6ebb27f9ecb82b3bce1d3aef2998a886de14f24b5a2f60b4e4a88d0a95834"><div class="ttname"><a href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a886de14f24b5a2f60b4e4a88d0a95834">enchant_vals::mod::REGEN_MANA</a></div><div class="ttdeci">@ REGEN_MANA</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character_8cpp_source.html#l07807">Character::calculate_by_enchantment()</a>, <a class="el" href="math__parser__func_8h_source.html#l00095">floor()</a>, <a class="el" href="magic_8cpp_source.html#l02151">max_mana()</a>, <a class="el" href="magic_8cpp_source.html#l02146">mod_mana()</a>, and <a class="el" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998a886de14f24b5a2f60b4e4a88d0a95834">enchant_vals::REGEN_MANA</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad3556aef7b10779c8854c6983c215ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3556aef7b10779c8854c6983c215ac0">&#9670;&nbsp;</a></span>caster_level_adjustment</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double known_magic::caster_level_adjustment</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00712">712</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02209">clear_opens_spellbook_data()</a>, and <a class="el" href="magic_8cpp_source.html#l02219">evaluate_opens_spellbook_data()</a>.</p>

</div>
</div>
<a id="a1dafae5436ced5d37e293d92c1bacd57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dafae5436ced5d37e293d92c1bacd57">&#9670;&nbsp;</a></span>caster_level_adjustment_by_school</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="type__id_8h.html#a44aa01c09faf1c1723400eb9075a1f4d">trait_id</a>, double&gt; known_magic::caster_level_adjustment_by_school</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00714">714</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02209">clear_opens_spellbook_data()</a>, and <a class="el" href="magic_8cpp_source.html#l02219">evaluate_opens_spellbook_data()</a>.</p>

</div>
</div>
<a id="a8ec7fa9b848fb3e139f1b9d7b6f4cb40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ec7fa9b848fb3e139f1b9d7b6f4cb40">&#9670;&nbsp;</a></span>caster_level_adjustment_by_spell</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a>, double&gt; known_magic::caster_level_adjustment_by_spell</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00713">713</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02209">clear_opens_spellbook_data()</a>, and <a class="el" href="magic_8cpp_source.html#l02219">evaluate_opens_spellbook_data()</a>.</p>

</div>
</div>
<a id="a8feaad1d7a7ecbb054556ef48e4599c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8feaad1d7a7ecbb054556ef48e4599c6">&#9670;&nbsp;</a></span>casting_ignore</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool known_magic::casting_ignore = false</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00661">661</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02737">select_spell()</a>.</p>

</div>
</div>
<a id="af3b997dd1160faca05064fad5c845e8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3b997dd1160faca05064fad5c845e8f">&#9670;&nbsp;</a></span>favorites</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;<a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a>&gt; known_magic::favorites</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00653">653</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l01944">deserialize()</a>, <a class="el" href="magic_8cpp_source.html#l02702">is_favorite()</a>, <a class="el" href="magic_8cpp_source.html#l02737">select_spell()</a>, <a class="el" href="magic_8cpp_source.html#l01923">serialize()</a>, and <a class="el" href="magic_8cpp_source.html#l02693">toggle_favorite()</a>.</p>

</div>
</div>
<a id="abdb326bf0885177b20fd45f26a6d68ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdb326bf0885177b20fd45f26a6d68ad">&#9670;&nbsp;</a></span>invlets</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a>, int&gt; known_magic::invlets</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00651">651</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l01944">deserialize()</a>, <a class="el" href="magic_8cpp_source.html#l02707">get_invlet()</a>, <a class="el" href="magic_8cpp_source.html#l02688">rem_invlet()</a>, <a class="el" href="magic_8cpp_source.html#l01923">serialize()</a>, and <a class="el" href="magic_8cpp_source.html#l02679">set_invlet()</a>.</p>

</div>
</div>
<a id="a7545cd34ae575060a438e9a6486762e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7545cd34ae575060a438e9a6486762e6">&#9670;&nbsp;</a></span>mana</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int known_magic::mana = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00657">657</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l02136">available_mana()</a>, <a class="el" href="magic_8cpp_source.html#l01944">deserialize()</a>, <a class="el" href="magic_8cpp_source.html#l01917">known_magic()</a>, <a class="el" href="magic_8cpp_source.html#l02146">mod_mana()</a>, <a class="el" href="magic_8cpp_source.html#l01923">serialize()</a>, and <a class="el" href="magic_8cpp_source.html#l02141">set_mana()</a>.</p>

</div>
</div>
<a id="a2e2bc1600c4888fb87cc14508f0111c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e2bc1600c4888fb87cc14508f0111c3">&#9670;&nbsp;</a></span>mana_base</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int known_magic::mana_base = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00655">655</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l01917">known_magic()</a>, and <a class="el" href="magic_8cpp_source.html#l02151">max_mana()</a>.</p>

</div>
</div>
<a id="af94169b33d6d2cd59d75efac9f92c570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af94169b33d6d2cd59d75efac9f92c570">&#9670;&nbsp;</a></span>spellbook</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="type__id_8h.html#a50c51ecb994fe99b3be7adf3873d9b34">spell_id</a>, <a class="el" href="classspell.html">spell</a>&gt; known_magic::spellbook</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magic_8h_source.html#l00649">649</a> of file <a class="el" href="magic_8h_source.html">magic.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="magic_8cpp_source.html#l01944">deserialize()</a>, <a class="el" href="magic_8cpp_source.html#l02047">forget_spell()</a>, <a class="el" href="magic_8cpp_source.html#l02117">get_spell()</a>, <a class="el" href="magic_8h_source.html#l00690">get_spellbook()</a>, <a class="el" href="magic_8cpp_source.html#l02126">get_spells()</a>, <a class="el" href="magic_8cpp_source.html#l01967">knows_spell()</a>, <a class="el" href="magic_8cpp_source.html#l01987">learn_spell()</a>, <a class="el" href="magic_8cpp_source.html#l01923">serialize()</a>, <a class="el" href="magic_8cpp_source.html#l02079">set_spell_exp()</a>, <a class="el" href="magic_8cpp_source.html#l02059">set_spell_level()</a>, and <a class="el" href="magic_8cpp_source.html#l02174">spells()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="magic_8h_source.html">magic.h</a></li>
<li>src/<a class="el" href="magic_8cpp_source.html">magic.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 7 2024 08:48:40 for Cataclysm DDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
