<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm DDA: npc_attack_melee Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm DDA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classnpc__attack__melee-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">npc_attack_melee Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="npc__attack_8h_source.html">npc_attack.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for npc_attack_melee:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classnpc__attack__melee.png" usemap="#npc_5Fattack_5Fmelee_map" alt=""/>
  <map id="npc_5Fattack_5Fmelee_map" name="npc_5Fattack_5Fmelee_map">
<area href="classnpc__attack.html" alt="npc_attack" shape="rect" coords="0,0,113,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acbc8786b88effa054e5946a3a1c4f3b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack__melee.html#acbc8786b88effa054e5946a3a1c4f3b5">npc_attack_melee</a> (<a class="el" href="classitem.html">item</a> &amp;<a class="el" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a>)</td></tr>
<tr class="separator:acbc8786b88effa054e5946a3a1c4f3b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6ce082ab3a0d9ca0fbba0f89b7d5898"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnpc__attack__rating.html">npc_attack_rating</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack__melee.html#ac6ce082ab3a0d9ca0fbba0f89b7d5898">evaluate</a> (const <a class="el" href="classnpc.html">npc</a> &amp;source, const <a class="el" href="classCreature.html">Creature</a> *target) const override</td></tr>
<tr class="memdesc:ac6ce082ab3a0d9ca0fbba0f89b7d5898"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters: source - the npc making the attack target - the desired target of the npc.  <a href="classnpc__attack__melee.html#ac6ce082ab3a0d9ca0fbba0f89b7d5898">More...</a><br /></td></tr>
<tr class="separator:ac6ce082ab3a0d9ca0fbba0f89b7d5898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a289b2ae24588a38ba722943aff2dcd71"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classnpc__attack__rating.html">npc_attack_rating</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack__melee.html#a289b2ae24588a38ba722943aff2dcd71">all_evaluations</a> (const <a class="el" href="classnpc.html">npc</a> &amp;source, const <a class="el" href="classCreature.html">Creature</a> *target) const override</td></tr>
<tr class="memdesc:a289b2ae24588a38ba722943aff2dcd71"><td class="mdescLeft">&#160;</td><td class="mdescRight">For debug information.  <a href="classnpc__attack__melee.html#a289b2ae24588a38ba722943aff2dcd71">More...</a><br /></td></tr>
<tr class="separator:a289b2ae24588a38ba722943aff2dcd71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a960da06c55a68653051dae71a5b27788"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack__melee.html#a960da06c55a68653051dae71a5b27788">use</a> (<a class="el" href="classnpc.html">npc</a> &amp;source, const <a class="el" href="structtripoint.html">tripoint</a> &amp;<a class="el" href="calendar_8cpp.html#a6fe65b9e39049b6d361709241a23d1b6">location</a>) const override</td></tr>
<tr class="separator:a960da06c55a68653051dae71a5b27788"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classnpc__attack"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classnpc__attack')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classnpc__attack.html">npc_attack</a></td></tr>
<tr class="memitem:a79e6c09c4a31c06d20a37c3d73c91393 inherit pub_methods_classnpc__attack"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack.html#a79e6c09c4a31c06d20a37c3d73c91393">~npc_attack</a> ()=default</td></tr>
<tr class="separator:a79e6c09c4a31c06d20a37c3d73c91393 inherit pub_methods_classnpc__attack"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a80f04209fafc00417102cae88a6afb40"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtripoint__range.html">tripoint_range</a>&lt; <a class="el" href="structtripoint.html">tripoint</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack__melee.html#a80f04209fafc00417102cae88a6afb40">targetable_points</a> (const <a class="el" href="classnpc.html">npc</a> &amp;source) const</td></tr>
<tr class="separator:a80f04209fafc00417102cae88a6afb40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bb4dfa023735b9eb932314a28fb0005"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack__melee.html#a6bb4dfa023735b9eb932314a28fb0005">can_use</a> (const <a class="el" href="classnpc.html">npc</a> &amp;source) const</td></tr>
<tr class="separator:a6bb4dfa023735b9eb932314a28fb0005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ffa54d95190789cce294c34b0b7f1b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack__melee.html#ab4ffa54d95190789cce294c34b0b7f1b">base_time_penalty</a> (const <a class="el" href="classnpc.html">npc</a> &amp;source) const</td></tr>
<tr class="separator:ab4ffa54d95190789cce294c34b0b7f1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a565c8968196b3f30fd29d8018d950d73"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classnpc__attack__rating.html">npc_attack_rating</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack__melee.html#a565c8968196b3f30fd29d8018d950d73">evaluate_critter</a> (const <a class="el" href="classnpc.html">npc</a> &amp;source, const <a class="el" href="classCreature.html">Creature</a> *target, <a class="el" href="classCreature.html">Creature</a> *critter) const</td></tr>
<tr class="separator:a565c8968196b3f30fd29d8018d950d73"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a570226904885a084905699089c535a60"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classitem.html">item</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a></td></tr>
<tr class="separator:a570226904885a084905699089c535a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="npc__attack_8h_source.html#l00079">79</a> of file <a class="el" href="npc__attack_8h_source.html">npc_attack.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="acbc8786b88effa054e5946a3a1c4f3b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbc8786b88effa054e5946a3a1c4f3b5">&#9670;&nbsp;</a></span>npc_attack_melee()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">npc_attack_melee::npc_attack_melee </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>weapon</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npc__attack_8h_source.html#l00083">83</a> of file <a class="el" href="npc__attack_8h_source.html">npc_attack.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;: <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a>( <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a> ) {}</div>
<div class="ttc" id="aclassnpc__attack__melee_html_a570226904885a084905699089c535a60"><div class="ttname"><a href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">npc_attack_melee::weapon</a></div><div class="ttdeci">item &amp; weapon</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8h_source.html#l00081">npc_attack.h:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a289b2ae24588a38ba722943aff2dcd71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a289b2ae24588a38ba722943aff2dcd71">&#9670;&nbsp;</a></span>all_evaluations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classnpc__attack__rating.html">npc_attack_rating</a> &gt; npc_attack_melee::all_evaluations </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCreature.html">Creature</a> *&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>For debug information. </p>
<p>returns all evaluated effectivenesses. This is abstracted out in <a class="el" href="classnpc__attack__melee.html#ac6ce082ab3a0d9ca0fbba0f89b7d5898" title="Parameters: source - the npc making the attack target - the desired target of the npc.">evaluate()</a> as it's faster to not use a container </p>

<p>Implements <a class="el" href="classnpc__attack.html#ae2d11078eaafaeb34853a3b7622a065a">npc_attack</a>.</p>

<p class="definition">Definition at line <a class="el" href="npc__attack_8cpp_source.html#l00357">357</a> of file <a class="el" href="npc__attack_8cpp_source.html">npc_attack.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;{</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    std::vector&lt;npc_attack_rating&gt; effectiveness;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classnpc__attack__melee.html#a6bb4dfa023735b9eb932314a28fb0005">can_use</a>( source ) ) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">return</span> effectiveness;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> time_penalty = <a class="code" href="classnpc__attack__melee.html#ab4ffa54d95190789cce294c34b0b7f1b">base_time_penalty</a>( source );</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;targetable_point : <a class="code" href="classnpc__attack__melee.html#a80f04209fafc00417102cae88a6afb40">targetable_points</a>( source ) ) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classCreature.html">Creature</a> *critter = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( targetable_point ) ) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">if</span>( source.<a class="code" href="classnpc.html#a06abd7ca2094ae40ba3aa9dbd53311e4">attitude_to</a>( *critter ) != <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Creature::Attitude::HOSTILE</a> ) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="comment">// no point in swinging a sword at a friendly!</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <a class="code" href="classnpc__attack__rating.html">npc_attack_rating</a> effectiveness_at_point = <a class="code" href="classnpc__attack__melee.html#a565c8968196b3f30fd29d8018d950d73">evaluate_critter</a>( source, target, critter );</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            effectiveness_at_point -= time_penalty;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            effectiveness.push_back( effectiveness_at_point );</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">return</span> effectiveness;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div>
<div class="ttc" id="aclassCreature_html"><div class="ttname"><a href="classCreature.html">Creature</a></div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00250">creature.h:251</a></div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Creature::Attitude::HOSTILE</a></div><div class="ttdeci">@ HOSTILE</div></div>
<div class="ttc" id="aclasscreature__tracker_html"><div class="ttname"><a href="classcreature__tracker.html">creature_tracker</a></div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8h_source.html#l00024">creature_tracker.h:25</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html_aba3c6663688bcd1806ea685d6961cb72"><div class="ttname"><a href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_tracker::creature_at</a></div><div class="ttdeci">T * creature_at(const tripoint &amp;p, bool allow_hallucination=false)</div><div class="ttdoc">Returns the Creature at the given location.</div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8cpp_source.html#l00303">creature_tracker.cpp:303</a></div></div>
<div class="ttc" id="aclassnpc__attack__melee_html_a565c8968196b3f30fd29d8018d950d73"><div class="ttname"><a href="classnpc__attack__melee.html#a565c8968196b3f30fd29d8018d950d73">npc_attack_melee::evaluate_critter</a></div><div class="ttdeci">npc_attack_rating evaluate_critter(const npc &amp;source, const Creature *target, Creature *critter) const</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00391">npc_attack.cpp:391</a></div></div>
<div class="ttc" id="aclassnpc__attack__melee_html_a6bb4dfa023735b9eb932314a28fb0005"><div class="ttname"><a href="classnpc__attack__melee.html#a6bb4dfa023735b9eb932314a28fb0005">npc_attack_melee::can_use</a></div><div class="ttdeci">bool can_use(const npc &amp;source) const</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00380">npc_attack.cpp:380</a></div></div>
<div class="ttc" id="aclassnpc__attack__melee_html_a80f04209fafc00417102cae88a6afb40"><div class="ttname"><a href="classnpc__attack__melee.html#a80f04209fafc00417102cae88a6afb40">npc_attack_melee::targetable_points</a></div><div class="ttdeci">tripoint_range&lt; tripoint &gt; targetable_points(const npc &amp;source) const</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00327">npc_attack.cpp:327</a></div></div>
<div class="ttc" id="aclassnpc__attack__melee_html_ab4ffa54d95190789cce294c34b0b7f1b"><div class="ttname"><a href="classnpc__attack__melee.html#ab4ffa54d95190789cce294c34b0b7f1b">npc_attack_melee::base_time_penalty</a></div><div class="ttdeci">int base_time_penalty(const npc &amp;source) const</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00386">npc_attack.cpp:386</a></div></div>
<div class="ttc" id="aclassnpc__attack__rating_html"><div class="ttname"><a href="classnpc__attack__rating.html">npc_attack_rating</a></div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8h_source.html#l00017">npc_attack.h:18</a></div></div>
<div class="ttc" id="aclassnpc_html_a06abd7ca2094ae40ba3aa9dbd53311e4"><div class="ttname"><a href="classnpc.html#a06abd7ca2094ae40ba3aa9dbd53311e4">npc::attitude_to</a></div><div class="ttdeci">Attitude attitude_to(const Creature &amp;other) const override</div><div class="ttdoc">Attitude (of this creature) towards another creature.</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l02386">npc.cpp:2386</a></div></div>
<div class="ttc" id="acreature__tracker_8h_html_a16f631f70e72b53e590770670fb301fb"><div class="ttname"><a href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a></div><div class="ttdeci">creature_tracker &amp; get_creature_tracker()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13827">game.cpp:13827</a></div></div>
<div class="ttc" id="astructtripoint_html"><div class="ttname"><a href="structtripoint.html">tripoint</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00129">point.h:129</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="npc_8cpp_source.html#l02386">npc::attitude_to()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00386">base_time_penalty()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00380">can_use()</a>, <a class="el" href="creature__tracker_8cpp_source.html#l00303">creature_tracker::creature_at()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00391">evaluate_critter()</a>, <a class="el" href="game_8cpp_source.html#l13827">get_creature_tracker()</a>, <a class="el" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Creature::HOSTILE</a>, and <a class="el" href="npc__attack_8cpp_source.html#l00327">targetable_points()</a>.</p>

</div>
</div>
<a id="ab4ffa54d95190789cce294c34b0b7f1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ffa54d95190789cce294c34b0b7f1b">&#9670;&nbsp;</a></span>base_time_penalty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int npc_attack_melee::base_time_penalty </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npc__attack_8cpp_source.html#l00386">386</a> of file <a class="el" href="npc__attack_8cpp_source.html">npc_attack.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> source.<a class="code" href="classCharacter.html#a81864eee5b75943bd4222b696117a52a">is_wielding</a>( <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a> ) ? 0 : <a class="code" href="namespacenpc__attack__constants.html#a6b25d6f0d31608cf9f20796008064af1">npc_attack_constants::base_time_penalty</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="ttc" id="aclassCharacter_html_a81864eee5b75943bd4222b696117a52a"><div class="ttname"><a href="classCharacter.html#a81864eee5b75943bd4222b696117a52a">Character::is_wielding</a></div><div class="ttdeci">bool is_wielding(const item &amp;target) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03319">character.cpp:3319</a></div></div>
<div class="ttc" id="anamespacenpc__attack__constants_html_a6b25d6f0d31608cf9f20796008064af1"><div class="ttname"><a href="namespacenpc__attack__constants.html#a6b25d6f0d31608cf9f20796008064af1">npc_attack_constants::base_time_penalty</a></div><div class="ttdeci">static const int base_time_penalty</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00031">npc_attack.cpp:31</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="npc__attack_8cpp_source.html#l00031">npc_attack_constants::base_time_penalty</a>, <a class="el" href="character_8cpp_source.html#l03319">Character::is_wielding()</a>, and <a class="el" href="npc__attack_8h_source.html#l00081">weapon</a>.</p>

<p class="reference">Referenced by <a class="el" href="npc__attack_8cpp_source.html#l00357">all_evaluations()</a>, and <a class="el" href="npc__attack_8cpp_source.html#l00332">evaluate()</a>.</p>

</div>
</div>
<a id="a6bb4dfa023735b9eb932314a28fb0005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb4dfa023735b9eb932314a28fb0005">&#9670;&nbsp;</a></span>can_use()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool npc_attack_melee::can_use </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npc__attack_8cpp_source.html#l00380">380</a> of file <a class="el" href="npc__attack_8cpp_source.html">npc_attack.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">// can&#39;t attack with something you can&#39;t wield</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">return</span> source.<a class="code" href="classCharacter.html#a81864eee5b75943bd4222b696117a52a">is_wielding</a>( <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a> ) || source.<a class="code" href="classCharacter.html#a28e314b50dae2c237a0675ed748aaf1d">can_wield</a>( <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a> ).<a class="code" href="classret__val__common.html#a933807b816264e791e488ed5e7abb1c3">success</a>();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="ttc" id="aclassCharacter_html_a28e314b50dae2c237a0675ed748aaf1d"><div class="ttname"><a href="classCharacter.html#a28e314b50dae2c237a0675ed748aaf1d">Character::can_wield</a></div><div class="ttdeci">ret_val&lt; void &gt; can_wield(const item &amp;it) const</div><div class="ttdoc">Check player capable of wielding an item.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l07836">character.cpp:7836</a></div></div>
<div class="ttc" id="aclassret__val__common_html_a933807b816264e791e488ed5e7abb1c3"><div class="ttname"><a href="classret__val__common.html#a933807b816264e791e488ed5e7abb1c3">ret_val_common::success</a></div><div class="ttdeci">bool success() const</div><div class="ttdef"><b>Definition:</b> <a href="ret__val_8h_source.html#l00013">ret_val.h:13</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character_8cpp_source.html#l07836">Character::can_wield()</a>, <a class="el" href="character_8cpp_source.html#l03319">Character::is_wielding()</a>, <a class="el" href="ret__val_8h_source.html#l00013">ret_val_common::success()</a>, and <a class="el" href="npc__attack_8h_source.html#l00081">weapon</a>.</p>

<p class="reference">Referenced by <a class="el" href="npc__attack_8cpp_source.html#l00357">all_evaluations()</a>, and <a class="el" href="npc__attack_8cpp_source.html#l00332">evaluate()</a>.</p>

</div>
</div>
<a id="ac6ce082ab3a0d9ca0fbba0f89b7d5898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6ce082ab3a0d9ca0fbba0f89b7d5898">&#9670;&nbsp;</a></span>evaluate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnpc__attack__rating.html">npc_attack_rating</a> npc_attack_melee::evaluate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCreature.html">Creature</a> *&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parameters: source - the npc making the attack target - the desired target of the npc. </p>
<p>valued at 100% </p>

<p>Implements <a class="el" href="classnpc__attack.html#a15a52f9295999dd95800c31c2b2fb348">npc_attack</a>.</p>

<p class="definition">Definition at line <a class="el" href="npc__attack_8cpp_source.html#l00332">332</a> of file <a class="el" href="npc__attack_8cpp_source.html">npc_attack.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="classnpc__attack__rating.html">npc_attack_rating</a> effectiveness( std::nullopt, source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="classnpc__attack__melee.html#a6bb4dfa023735b9eb932314a28fb0005">can_use</a>( source ) ) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">return</span> effectiveness;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> time_penalty = <a class="code" href="classnpc__attack__melee.html#ab4ffa54d95190789cce294c34b0b7f1b">base_time_penalty</a>( source );</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;targetable_point : <a class="code" href="classnpc__attack__melee.html#a80f04209fafc00417102cae88a6afb40">targetable_points</a>( source ) ) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classCreature.html">Creature</a> *critter = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( targetable_point ) ) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">if</span>( source.<a class="code" href="classnpc.html#a06abd7ca2094ae40ba3aa9dbd53311e4">attitude_to</a>( *critter ) != <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Creature::Attitude::HOSTILE</a> ) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="comment">// no point in swinging a sword at a friendly!</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <a class="code" href="classnpc__attack__rating.html">npc_attack_rating</a> effectiveness_at_point = <a class="code" href="classnpc__attack__melee.html#a565c8968196b3f30fd29d8018d950d73">evaluate_critter</a>( source, target, critter );</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            effectiveness_at_point -= time_penalty;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">if</span>( effectiveness_at_point &gt; effectiveness ) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                effectiveness = effectiveness_at_point;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> effectiveness;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;}</div>
<div class="ttc" id="aclassCreature_html_a1a65722d07102550f16d17ebd79e2743"><div class="ttname"><a href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">Creature::pos</a></div><div class="ttdeci">tripoint pos() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00178">creature.cpp:178</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="npc_8cpp_source.html#l02386">npc::attitude_to()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00386">base_time_penalty()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00380">can_use()</a>, <a class="el" href="creature__tracker_8cpp_source.html#l00303">creature_tracker::creature_at()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00391">evaluate_critter()</a>, <a class="el" href="game_8cpp_source.html#l13827">get_creature_tracker()</a>, <a class="el" href="classCreature.html#a8a475630b3289c468bd06cf114008217a10794171f9c3f68753d26303cfec9747">Creature::HOSTILE</a>, <a class="el" href="creature_8cpp_source.html#l00178">Creature::pos()</a>, and <a class="el" href="npc__attack_8cpp_source.html#l00327">targetable_points()</a>.</p>

</div>
</div>
<a id="a565c8968196b3f30fd29d8018d950d73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a565c8968196b3f30fd29d8018d950d73">&#9670;&nbsp;</a></span>evaluate_critter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classnpc__attack__rating.html">npc_attack_rating</a> npc_attack_melee::evaluate_critter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCreature.html">Creature</a> *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCreature.html">Creature</a> *&#160;</td>
          <td class="paramname"><em>critter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npc__attack_8cpp_source.html#l00391">391</a> of file <a class="el" href="npc__attack_8cpp_source.html">npc_attack.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">if</span>( !critter ) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classnpc__attack__rating.html">npc_attack_rating</a>{};</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// TODO: Give bashing weapons a better</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// rating against armored targets</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">double</span> damage{ <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a>.<a class="code" href="classitem.html#a1eabd9cf88a2b7c1cbdd8b8ec28b002d">base_damage_melee</a>().<a class="code" href="structdamage__instance.html#a96f6f6d008ed8744ce549cefcfec3951">total_damage</a>() };</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    damage *= 100.0 / <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a>.<a class="code" href="classitem.html#a5ac32d5d8193f5fad10893881f53cb1c">attack_time</a>( source );</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> reach_range{ <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a>.<a class="code" href="classitem.html#a04985a2b99688b687432463fb2f0a853">reach_range</a>( source ) };</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> distance_to_me = <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), critter-&gt;<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) - reach_range, 0, 10 );</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// Multiplier of 0.5f to 1.5f based on distance</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> distance_multiplier = 1.5f - distance_to_me * 0.1f;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">double</span> potential = damage * distance_multiplier;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span>( damage &gt;= critter-&gt;<a class="code" href="classCreature.html#a94737d93f30cee269b2df71478ee29fd">get_hp</a>() ) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        potential *= <a class="code" href="namespacenpc__attack__constants.html#acf8fbc6417cc09d51e92b9c2503a4a7d">npc_attack_constants::kill_modifier</a>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span>( target &amp;&amp; target-&gt;<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() == critter-&gt;<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        potential *= <a class="code" href="namespacenpc__attack__constants.html#a164d1e4ebf0a8843c8f0c0dc8c425921">npc_attack_constants::target_modifier</a>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classnpc__attack__rating.html">npc_attack_rating</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( potential ) ), critter-&gt;<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() );</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div>
<div class="ttc" id="acata__utility_8h_html_ad22b4a043b6eb4c2c06f87f83b720b15"><div class="ttname"><a href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a></div><div class="ttdeci">constexpr T clamp(const T &amp;val, const T &amp;min, const T &amp;max)</div><div class="ttdoc">Clamp first argument so that it is no lower than second and no higher than third.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00221">cata_utility.h:221</a></div></div>
<div class="ttc" id="aclassCreature_html_a94737d93f30cee269b2df71478ee29fd"><div class="ttname"><a href="classCreature.html#a94737d93f30cee269b2df71478ee29fd">Creature::get_hp</a></div><div class="ttdeci">virtual int get_hp(const bodypart_id &amp;bp) const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l02748">creature.cpp:2748</a></div></div>
<div class="ttc" id="aclassitem_html_a04985a2b99688b687432463fb2f0a853"><div class="ttname"><a href="classitem.html#a04985a2b99688b687432463fb2f0a853">item::reach_range</a></div><div class="ttdeci">int reach_range(const Character &amp;guy) const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07509">item.cpp:7509</a></div></div>
<div class="ttc" id="aclassitem_html_a1eabd9cf88a2b7c1cbdd8b8ec28b002d"><div class="ttname"><a href="classitem.html#a1eabd9cf88a2b7c1cbdd8b8ec28b002d">item::base_damage_melee</a></div><div class="ttdeci">damage_instance base_damage_melee() const</div><div class="ttdoc">All damage types this item deals when used in melee (no skill modifiers etc.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07489">item.cpp:7489</a></div></div>
<div class="ttc" id="aclassitem_html_a5ac32d5d8193f5fad10893881f53cb1c"><div class="ttname"><a href="classitem.html#a5ac32d5d8193f5fad10893881f53cb1c">item::attack_time</a></div><div class="ttdeci">int attack_time(const Character &amp;you) const</div><div class="ttdoc">Base number of moves (Creature::moves) that a single melee attack with this items takes.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07444">item.cpp:7444</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a8e2cbab6dac12095f06b4cff66857fbb"><div class="ttname"><a href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a></div><div class="ttdeci">int rl_dist(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00769">coordinates.h:769</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a5834219bcffc7118c95b395b8cdeec20"><div class="ttname"><a href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">round</a></div><div class="ttdeci">double round(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00110">math_parser_func.h:110</a></div></div>
<div class="ttc" id="anamespacenpc__attack__constants_html_a164d1e4ebf0a8843c8f0c0dc8c425921"><div class="ttname"><a href="namespacenpc__attack__constants.html#a164d1e4ebf0a8843c8f0c0dc8c425921">npc_attack_constants::target_modifier</a></div><div class="ttdeci">static const float target_modifier</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00026">npc_attack.cpp:26</a></div></div>
<div class="ttc" id="anamespacenpc__attack__constants_html_acf8fbc6417cc09d51e92b9c2503a4a7d"><div class="ttname"><a href="namespacenpc__attack__constants.html#acf8fbc6417cc09d51e92b9c2503a4a7d">npc_attack_constants::kill_modifier</a></div><div class="ttdeci">static const float kill_modifier</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00028">npc_attack.cpp:28</a></div></div>
<div class="ttc" id="astructdamage__instance_html_a96f6f6d008ed8744ce549cefcfec3951"><div class="ttname"><a href="structdamage__instance.html#a96f6f6d008ed8744ce549cefcfec3951">damage_instance::total_damage</a></div><div class="ttdeci">float total_damage() const</div><div class="ttdef"><b>Definition:</b> <a href="damage_8cpp_source.html#l00372">damage.cpp:372</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="item_8cpp_source.html#l07444">item::attack_time()</a>, <a class="el" href="item_8cpp_source.html#l07489">item::base_damage_melee()</a>, <a class="el" href="cata__utility_8h_source.html#l00221">clamp()</a>, <a class="el" href="creature_8cpp_source.html#l02748">Creature::get_hp()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00028">npc_attack_constants::kill_modifier</a>, <a class="el" href="creature_8cpp_source.html#l00178">Creature::pos()</a>, <a class="el" href="item_8cpp_source.html#l07509">item::reach_range()</a>, <a class="el" href="coordinates_8h_source.html#l00769">rl_dist()</a>, <a class="el" href="math__parser__func_8h_source.html#l00110">round()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00026">npc_attack_constants::target_modifier</a>, <a class="el" href="damage_8cpp_source.html#l00372">damage_instance::total_damage()</a>, and <a class="el" href="npc__attack_8h_source.html#l00081">weapon</a>.</p>

<p class="reference">Referenced by <a class="el" href="npc__attack_8cpp_source.html#l00357">all_evaluations()</a>, and <a class="el" href="npc__attack_8cpp_source.html#l00332">evaluate()</a>.</p>

</div>
</div>
<a id="a80f04209fafc00417102cae88a6afb40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80f04209fafc00417102cae88a6afb40">&#9670;&nbsp;</a></span>targetable_points()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtripoint__range.html">tripoint_range</a>&lt; <a class="el" href="structtripoint.html">tripoint</a> &gt; npc_attack_melee::targetable_points </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npc__attack_8cpp_source.html#l00327">327</a> of file <a class="el" href="npc__attack_8cpp_source.html">npc_attack.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), 8 );</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="ttc" id="aclassmap_html_a4f5f812d7e89a998429958573a4c340f"><div class="ttname"><a href="classmap.html#a4f5f812d7e89a998429958573a4c340f">map::points_in_radius</a></div><div class="ttdeci">tripoint_range&lt; tripoint &gt; points_in_radius(const tripoint &amp;center, size_t radius, size_t radiusz=0) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l10109">map.cpp:10109</a></div></div>
<div class="ttc" id="agame_8cpp_html_afa1063326b0c16b43c6f3dc8c3df403d"><div class="ttname"><a href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a></div><div class="ttdeci">map &amp; get_map()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13822">game.cpp:13822</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="game_8cpp_source.html#l13822">get_map()</a>, <a class="el" href="map_8cpp_source.html#l10109">map::points_in_radius()</a>, and <a class="el" href="creature_8cpp_source.html#l00178">Creature::pos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="npc__attack_8cpp_source.html#l00357">all_evaluations()</a>, and <a class="el" href="npc__attack_8cpp_source.html#l00332">evaluate()</a>.</p>

</div>
</div>
<a id="a960da06c55a68653051dae71a5b27788"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a960da06c55a68653051dae71a5b27788">&#9670;&nbsp;</a></span>use()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void npc_attack_melee::use </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtripoint.html">tripoint</a> &amp;&#160;</td>
          <td class="paramname"><em>location</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classnpc__attack.html#a827aea07109ee56ed738943d685ae28a">npc_attack</a>.</p>

<p class="definition">Definition at line <a class="el" href="npc__attack_8cpp_source.html#l00232">232</a> of file <a class="el" href="npc__attack_8cpp_source.html">npc_attack.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span>( !source.<a class="code" href="classCharacter.html#a81864eee5b75943bd4222b696117a52a">is_wielding</a>( <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a> ) ) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span>( !source.<a class="code" href="classnpc.html#a251cafb769b1d8ec4585deb3b50aaafd">wield</a>( <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a> ) ) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: npc tried to equip a weapon it couldn&#39;t wield&quot;</span> );</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classCreature.html">Creature</a> *critter = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( <a class="code" href="calendar_8cpp.html#a6fe65b9e39049b6d361709241a23d1b6">location</a> );</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span>( !critter ) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;ERROR: npc tried to attack null critter&quot;</span> );</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordtype">int</span> target_distance = <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="calendar_8cpp.html#a6fe65b9e39049b6d361709241a23d1b6">location</a> );</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span>( !source.<a class="code" href="classCreature.html#a50742ba2b2e90cf50327ea90c8d636dd">is_adjacent</a>( critter, <span class="keyword">true</span> ) ) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">if</span>( target_distance &lt;= <a class="code" href="classnpc__attack__melee.html#a570226904885a084905699089c535a60">weapon</a>.<a class="code" href="classitem.html#a04985a2b99688b687432463fb2f0a853">reach_range</a>( source ) ) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af23f8ccb0fd99b8a3db9e9223a5714a2">debugmode::debug_filter::DF_NPC</a>, <span class="stringliteral">&quot;%s is attempting a reach attack&quot;</span>,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                           source.<a class="code" href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">disp_name</a>() );</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="comment">// check for friendlies in the line of fire</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            std::vector&lt;tripoint&gt; path = <a class="code" href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a>( source.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), <a class="code" href="calendar_8cpp.html#a6fe65b9e39049b6d361709241a23d1b6">location</a> );</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            path.pop_back(); <span class="comment">// Last point is the target</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordtype">bool</span> can_attack = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;path_point : path ) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <a class="code" href="classCreature.html">Creature</a> *inter = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( path_point );</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">if</span>( inter != <span class="keyword">nullptr</span> &amp;&amp; source.<a class="code" href="classnpc.html#a06abd7ca2094ae40ba3aa9dbd53311e4">attitude_to</a>( *inter ) == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Creature::Attitude::FRIENDLY</a> ) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af23f8ccb0fd99b8a3db9e9223a5714a2">debugmode::debug_filter::DF_NPC</a>, <span class="stringliteral">&quot;%s aborted a reach attack; ally in the way&quot;</span>,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                   source.<a class="code" href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">disp_name</a>() );</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                    can_attack = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">if</span>( can_attack ) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                source.<a class="code" href="classCharacter.html#a408e887059da5e9a0b1bfd7672ff392d">reach_attack</a>( <a class="code" href="calendar_8cpp.html#a6fe65b9e39049b6d361709241a23d1b6">location</a> );</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="npc__attack_8cpp.html#abfd59081a5c7ac3f3898ca76a384255e">can_move_melee</a>( source ) ) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                source.<a class="code" href="classnpc.html#a4fea1fd042a9225b685b012eec8697ba">avoid_friendly_fire</a>();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                source.<a class="code" href="classnpc.html#abfc3752f6d8399151f22e5514a37c479">look_for_player</a>( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() );</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            source.<a class="code" href="classnpc.html#a19b1f35fba77c40af8f65dcc16b9a373">update_path</a>( <a class="code" href="calendar_8cpp.html#a6fe65b9e39049b6d361709241a23d1b6">location</a> );</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">if</span>( source.<a class="code" href="classnpc.html#a18c08c8cf5be52dd8e4016b8e371fb73">path</a>.size() &gt; 1 ) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keywordtype">bool</span> clear_path = <a class="code" href="npc__attack_8cpp.html#abfd59081a5c7ac3f3898ca76a384255e">can_move_melee</a>( source );</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keywordflow">if</span>( clear_path &amp;&amp; source.<a class="code" href="classnpc.html#a9fd28cfcf0b96db41e54ba6c2387ba8d">mem_combat</a>.<a class="code" href="structnpc__combat__memory__cache.html#a81a2b9ca2aaa184c61d0c005f079c758">formation_distance</a> == -1 ) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    source.<a class="code" href="classnpc.html#a827ea43a24174972a2453c9bf62bf55c">move_to_next</a>();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2aa80ba6bdf706a3ad1f7450f71465cd7e">debugmode::DF_NPC_MOVEAI</a>,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                   <span class="stringliteral">&quot;&lt;color_light_gray&gt;%s has no nearby ranged allies.  Going for attack.&lt;/color&gt;&quot;</span>, source.<a class="code" href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">name</a> );</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( clear_path &amp;&amp; source.<a class="code" href="classnpc.html#a9fd28cfcf0b96db41e54ba6c2387ba8d">mem_combat</a>.<a class="code" href="structnpc__combat__memory__cache.html#a81a2b9ca2aaa184c61d0c005f079c758">formation_distance</a> &gt; target_distance ) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    source.<a class="code" href="classnpc.html#a827ea43a24174972a2453c9bf62bf55c">move_to_next</a>();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2aa80ba6bdf706a3ad1f7450f71465cd7e">debugmode::DF_NPC_MOVEAI</a>,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                   <span class="stringliteral">&quot;&lt;color_light_gray&gt;%s is at least %i away from ranged allies, enemy within %i.  Going for attack.&lt;/color&gt;&quot;</span>,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                   source.<a class="code" href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">name</a>, source.<a class="code" href="classnpc.html#a9fd28cfcf0b96db41e54ba6c2387ba8d">mem_combat</a>.<a class="code" href="structnpc__combat__memory__cache.html#a81a2b9ca2aaa184c61d0c005f079c758">formation_distance</a>, target_distance );</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( clear_path &amp;&amp;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                           source.<a class="code" href="classnpc.html#a9fd28cfcf0b96db41e54ba6c2387ba8d">mem_combat</a>.<a class="code" href="structnpc__combat__memory__cache.html#a81a2b9ca2aaa184c61d0c005f079c758">formation_distance</a> &gt; source.<a class="code" href="classnpc.html#afe1edc39389e8051509a1f346dec437a">closest_enemy_to_friendly_distance</a>() ) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    source.<a class="code" href="classnpc.html#a827ea43a24174972a2453c9bf62bf55c">move_to_next</a>();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    <span class="comment">//add_msg_debug( debugmode::DF_NPC_MOVEAI,</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    <span class="comment">//               &quot;&lt;color_light_gray&gt;%s is at least %i away from allies, enemy within %i of ally.  Going for attack.&lt;/color&gt;&quot;,</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    <span class="comment">//               source.name, source.mem_combat.formation_distance, source.closest_enemy_to_friendly_distance() );</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( source.<a class="code" href="classnpc.html#a9fd28cfcf0b96db41e54ba6c2387ba8d">mem_combat</a>.<a class="code" href="structnpc__combat__memory__cache.html#a81a2b9ca2aaa184c61d0c005f079c758">formation_distance</a> &lt;= source.<a class="code" href="classnpc.html#a9fd28cfcf0b96db41e54ba6c2387ba8d">mem_combat</a>.<a class="code" href="structnpc__combat__memory__cache.html#a458f36d8f86be518856dfaf972acb8cf">engagement_distance</a> ) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2aa80ba6bdf706a3ad1f7450f71465cd7e">debugmode::DF_NPC_MOVEAI</a>,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                   <span class="stringliteral">&quot;&lt;color_light_gray&gt;%s can&#39;t path to melee target, and is staying close to ranged allies.  Stay in place.&lt;/color&gt;&quot;</span>,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                   source.<a class="code" href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">name</a> );</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    source.<a class="code" href="classnpc.html#aa66ea634e85fda5b9964025922499524">move_pause</a>();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2aa80ba6bdf706a3ad1f7450f71465cd7e">debugmode::DF_NPC_MOVEAI</a>,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                   <span class="stringliteral">&quot;&lt;color_light_gray&gt;%s can&#39;t path to melee target, and is not staying close to ranged allies.  Get close to player.&lt;/color&gt;&quot;</span>,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                   source.<a class="code" href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">name</a> );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    source.<a class="code" href="classnpc.html#abfc3752f6d8399151f22e5514a37c479">look_for_player</a>( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() );</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( source.<a class="code" href="classnpc.html#a18c08c8cf5be52dd8e4016b8e371fb73">path</a>.size() == 1 ) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="keywordflow">if</span>( critter != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                    <span class="keywordflow">if</span>( source.<a class="code" href="classnpc.html#a03d847cc01fcfd290871893e9418d2f0">can_use_offensive_cbm</a>() ) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                        source.<a class="code" href="classnpc.html#a00c66c9875847030710d6c619a178168">activate_bionic_by_id</a>( <a class="code" href="npc__attack_8cpp.html#a4424b509877ff458aa661c2b49a99dda">bio_hydraulics</a> );</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af23f8ccb0fd99b8a3db9e9223a5714a2">debugmode::debug_filter::DF_NPC</a>, <span class="stringliteral">&quot;%s is attempting a melee attack&quot;</span>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                   source.<a class="code" href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">disp_name</a>() );</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    source.<a class="code" href="classCharacter.html#a22c61a1b7ab6ae71a3cac5f92bca2fd5">melee_attack</a>( *critter, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                source.<a class="code" href="classnpc.html#abfc3752f6d8399151f22e5514a37c479">look_for_player</a>( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() );</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( source.<a class="code" href="classnpc.html#a9fd28cfcf0b96db41e54ba6c2387ba8d">mem_combat</a>.<a class="code" href="structnpc__combat__memory__cache.html#a81a2b9ca2aaa184c61d0c005f079c758">formation_distance</a> != -1 &amp;&amp;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;               source.<a class="code" href="classnpc.html#a9fd28cfcf0b96db41e54ba6c2387ba8d">mem_combat</a>.<a class="code" href="structnpc__combat__memory__cache.html#a81a2b9ca2aaa184c61d0c005f079c758">formation_distance</a> &lt;= target_distance &amp;&amp;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;               <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -10, 10 ) &gt; source.<a class="code" href="classnpc.html#a21a2c9d7a8bebc596239365fb6aff1c5">personality</a>.<a class="code" href="structnpc__personality.html#aecf2fbbc5fcbda416d381dc0bde6e18c">aggression</a> ) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2aa80ba6bdf706a3ad1f7450f71465cd7e">debugmode::DF_NPC_MOVEAI</a>,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                       <span class="stringliteral">&quot;&lt;color_light_gray&gt;%s decided to fall back to formation with allies.&lt;/color&gt;&quot;</span>, source.<a class="code" href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">name</a> );</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        source.<a class="code" href="classnpc.html#abfc3752f6d8399151f22e5514a37c479">look_for_player</a>( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() );</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// may wish to add a break here to see if target is out of formation with allies, and consider running back.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af23f8ccb0fd99b8a3db9e9223a5714a2">debugmode::debug_filter::DF_NPC</a>, <span class="stringliteral">&quot;%s is attempting a melee attack&quot;</span>,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                       source.<a class="code" href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">disp_name</a>() );</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        source.<a class="code" href="classCharacter.html#a22c61a1b7ab6ae71a3cac5f92bca2fd5">melee_attack</a>( *critter, <span class="keyword">true</span> );</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div>
<div class="ttc" id="acalendar_8cpp_html_a4249b6f1d0842211bfe53e5f9e206a10"><div class="ttname"><a href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a></div><div class="ttdeci">time_duration rng(time_duration lo, time_duration hi)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00779">calendar.cpp:779</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_a6fe65b9e39049b6d361709241a23d1b6"><div class="ttname"><a href="calendar_8cpp.html#a6fe65b9e39049b6d361709241a23d1b6">location</a></div><div class="ttdeci">static lat_long location</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00034">calendar.cpp:34</a></div></div>
<div class="ttc" id="acharacter_8h_html_abaafa6561de05c3b1324214e3048745a"><div class="ttname"><a href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a></div><div class="ttdeci">Character &amp; get_player_character()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13807">game.cpp:13807</a></div></div>
<div class="ttc" id="aclassCharacter_html_a1e1996b6d6fc0a86d917cd155e1656d8"><div class="ttname"><a href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">Character::disp_name</a></div><div class="ttdeci">std::string disp_name(bool possessive=false, bool capitalize_first=false) const override</div><div class="ttdoc">Returns either &quot;you&quot; or the player's name.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00829">character.cpp:829</a></div></div>
<div class="ttc" id="aclassCharacter_html_a22c61a1b7ab6ae71a3cac5f92bca2fd5"><div class="ttname"><a href="classCharacter.html#a22c61a1b7ab6ae71a3cac5f92bca2fd5">Character::melee_attack</a></div><div class="ttdeci">bool melee_attack(Creature &amp;t, bool allow_special, const matec_id &amp;force_technique, bool allow_unarmed=true, int forced_movecost=-1)</div><div class="ttdoc">Sets up a melee attack and handles melee attack function calls.</div><div class="ttdef"><b>Definition:</b> <a href="melee_8cpp_source.html#l00563">melee.cpp:563</a></div></div>
<div class="ttc" id="aclassCharacter_html_a408e887059da5e9a0b1bfd7672ff392d"><div class="ttname"><a href="classCharacter.html#a408e887059da5e9a0b1bfd7672ff392d">Character::reach_attack</a></div><div class="ttdeci">void reach_attack(const tripoint &amp;p, int forced_movecost=-1)</div><div class="ttdoc">Handles reach melee attacks.</div><div class="ttdef"><b>Definition:</b> <a href="melee_8cpp_source.html#l01012">melee.cpp:1012</a></div></div>
<div class="ttc" id="aclassCharacter_html_a6592c35167738421f3e04ca8808d37db"><div class="ttname"><a href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">Character::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02684">character.h:2684</a></div></div>
<div class="ttc" id="aclassCreature_html_a50742ba2b2e90cf50327ea90c8d636dd"><div class="ttname"><a href="classCreature.html#a50742ba2b2e90cf50327ea90c8d636dd">Creature::is_adjacent</a></div><div class="ttdeci">bool is_adjacent(const Creature *target, bool allow_z_levels) const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00722">creature.cpp:722</a></div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Creature::Attitude::FRIENDLY</a></div><div class="ttdeci">@ FRIENDLY</div></div>
<div class="ttc" id="aclassnpc_html_a00c66c9875847030710d6c619a178168"><div class="ttname"><a href="classnpc.html#a00c66c9875847030710d6c619a178168">npc::activate_bionic_by_id</a></div><div class="ttdeci">bool activate_bionic_by_id(const bionic_id &amp;cbm_id, bool eff_only=false)</div><div class="ttdef"><b>Definition:</b> <a href="npcmove_8cpp_source.html#l02234">npcmove.cpp:2234</a></div></div>
<div class="ttc" id="aclassnpc_html_a03d847cc01fcfd290871893e9418d2f0"><div class="ttname"><a href="classnpc.html#a03d847cc01fcfd290871893e9418d2f0">npc::can_use_offensive_cbm</a></div><div class="ttdeci">bool can_use_offensive_cbm() const</div><div class="ttdef"><b>Definition:</b> <a href="npcmove_8cpp_source.html#l02293">npcmove.cpp:2293</a></div></div>
<div class="ttc" id="aclassnpc_html_a18c08c8cf5be52dd8e4016b8e371fb73"><div class="ttname"><a href="classnpc.html#a18c08c8cf5be52dd8e4016b8e371fb73">npc::path</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; path</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l01390">npc.h:1390</a></div></div>
<div class="ttc" id="aclassnpc_html_a19b1f35fba77c40af8f65dcc16b9a373"><div class="ttname"><a href="classnpc.html#a19b1f35fba77c40af8f65dcc16b9a373">npc::update_path</a></div><div class="ttdeci">bool update_path(const tripoint &amp;p, bool no_bashing=false, bool force=true)</div><div class="ttdoc">Tries to find path to p.</div><div class="ttdef"><b>Definition:</b> <a href="npcmove_8cpp_source.html#l02811">npcmove.cpp:2811</a></div></div>
<div class="ttc" id="aclassnpc_html_a21a2c9d7a8bebc596239365fb6aff1c5"><div class="ttname"><a href="classnpc.html#a21a2c9d7a8bebc596239365fb6aff1c5">npc::personality</a></div><div class="ttdeci">npc_personality personality</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l01402">npc.h:1402</a></div></div>
<div class="ttc" id="aclassnpc_html_a251cafb769b1d8ec4585deb3b50aaafd"><div class="ttname"><a href="classnpc.html#a251cafb769b1d8ec4585deb3b50aaafd">npc::wield</a></div><div class="ttdeci">bool wield(item &amp;it) override</div><div class="ttdoc">Removes currently wielded item (if any) and replaces it with the target item.</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l01327">npc.cpp:1327</a></div></div>
<div class="ttc" id="aclassnpc_html_a4fea1fd042a9225b685b012eec8697ba"><div class="ttname"><a href="classnpc.html#a4fea1fd042a9225b685b012eec8697ba">npc::avoid_friendly_fire</a></div><div class="ttdeci">void avoid_friendly_fire()</div><div class="ttdef"><b>Definition:</b> <a href="npcmove_8cpp_source.html#l03167">npcmove.cpp:3167</a></div></div>
<div class="ttc" id="aclassnpc_html_a827ea43a24174972a2453c9bf62bf55c"><div class="ttname"><a href="classnpc.html#a827ea43a24174972a2453c9bf62bf55c">npc::move_to_next</a></div><div class="ttdeci">void move_to_next()</div><div class="ttdef"><b>Definition:</b> <a href="npcmove_8cpp_source.html#l03148">npcmove.cpp:3148</a></div></div>
<div class="ttc" id="aclassnpc_html_a9fd28cfcf0b96db41e54ba6c2387ba8d"><div class="ttname"><a href="classnpc.html#a9fd28cfcf0b96db41e54ba6c2387ba8d">npc::mem_combat</a></div><div class="ttdeci">npc_combat_memory_cache mem_combat</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l01404">npc.h:1404</a></div></div>
<div class="ttc" id="aclassnpc_html_aa66ea634e85fda5b9964025922499524"><div class="ttname"><a href="classnpc.html#aa66ea634e85fda5b9964025922499524">npc::move_pause</a></div><div class="ttdeci">void move_pause()</div><div class="ttdef"><b>Definition:</b> <a href="npcmove_8cpp_source.html#l03372">npcmove.cpp:3372</a></div></div>
<div class="ttc" id="aclassnpc_html_abfc3752f6d8399151f22e5514a37c479"><div class="ttname"><a href="classnpc.html#abfc3752f6d8399151f22e5514a37c479">npc::look_for_player</a></div><div class="ttdeci">void look_for_player(const Character &amp;sought)</div><div class="ttdef"><b>Definition:</b> <a href="npcmove_8cpp_source.html#l04743">npcmove.cpp:4743</a></div></div>
<div class="ttc" id="aclassnpc_html_afe1edc39389e8051509a1f346dec437a"><div class="ttname"><a href="classnpc.html#afe1edc39389e8051509a1f346dec437a">npc::closest_enemy_to_friendly_distance</a></div><div class="ttdeci">std::optional&lt; int &gt; closest_enemy_to_friendly_distance() const</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l02949">npc.cpp:2949</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a31847b31c6ef002e9d16afd7fd0005e3"><div class="ttname"><a href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a></div><div class="ttdeci">std::vector&lt; coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &amp;&amp;RhsInBounds &gt; &gt; line_to(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00798">coordinates.h:798</a></div></div>
<div class="ttc" id="adebug_8h_html_a87e509562277a7ada3a75330d00cb445"><div class="ttname"><a href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a></div><div class="ttdeci">#define debugmsg(...)</div><div class="ttdoc">Debug message of level D_ERROR and class D_MAIN, also includes the source file name and line,...</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00069">debug.h:69</a></div></div>
<div class="ttc" id="amessages_8h_html_ab6590bda29b082a7282bcc1a9cc8f02a"><div class="ttname"><a href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a></div><div class="ttdeci">#define add_msg_debug(type,...)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8h_source.html#l00177">messages.h:177</a></div></div>
<div class="ttc" id="anamespacedebugmode_html_ac654a55a1b56b11554103f87859968f2aa80ba6bdf706a3ad1f7450f71465cd7e"><div class="ttname"><a href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2aa80ba6bdf706a3ad1f7450f71465cd7e">debugmode::DF_NPC_MOVEAI</a></div><div class="ttdeci">@ DF_NPC_MOVEAI</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00270">debug.h:270</a></div></div>
<div class="ttc" id="anamespacedebugmode_html_ac654a55a1b56b11554103f87859968f2af23f8ccb0fd99b8a3db9e9223a5714a2"><div class="ttname"><a href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2af23f8ccb0fd99b8a3db9e9223a5714a2">debugmode::DF_NPC</a></div><div class="ttdeci">@ DF_NPC</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00267">debug.h:267</a></div></div>
<div class="ttc" id="anpc__attack_8cpp_html_a4424b509877ff458aa661c2b49a99dda"><div class="ttname"><a href="npc__attack_8cpp.html#a4424b509877ff458aa661c2b49a99dda">bio_hydraulics</a></div><div class="ttdeci">static const bionic_id bio_hydraulics(&quot;bio_hydraulics&quot;)</div></div>
<div class="ttc" id="anpc__attack_8cpp_html_abfd59081a5c7ac3f3898ca76a384255e"><div class="ttname"><a href="npc__attack_8cpp.html#abfd59081a5c7ac3f3898ca76a384255e">can_move_melee</a></div><div class="ttdeci">static bool can_move_melee(const npc &amp;source)</div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8cpp_source.html#l00059">npc_attack.cpp:59</a></div></div>
<div class="ttc" id="astructnpc__combat__memory__cache_html_a458f36d8f86be518856dfaf972acb8cf"><div class="ttname"><a href="structnpc__combat__memory__cache.html#a458f36d8f86be518856dfaf972acb8cf">npc_combat_memory_cache::engagement_distance</a></div><div class="ttdeci">int engagement_distance</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00613">npc.h:613</a></div></div>
<div class="ttc" id="astructnpc__combat__memory__cache_html_a81a2b9ca2aaa184c61d0c005f079c758"><div class="ttname"><a href="structnpc__combat__memory__cache.html#a81a2b9ca2aaa184c61d0c005f079c758">npc_combat_memory_cache::formation_distance</a></div><div class="ttdeci">int formation_distance</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00612">npc.h:612</a></div></div>
<div class="ttc" id="astructnpc__personality_html_aecf2fbbc5fcbda416d381dc0bde6e18c"><div class="ttname"><a href="structnpc__personality.html#aecf2fbbc5fcbda416d381dc0bde6e18c">npc_personality::aggression</a></div><div class="ttdeci">int8_t aggression</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00217">npc.h:217</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="npcmove_8cpp_source.html#l02234">npc::activate_bionic_by_id()</a>, <a class="el" href="messages_8h_source.html#l00177">add_msg_debug</a>, <a class="el" href="npc_8h_source.html#l00217">npc_personality::aggression</a>, <a class="el" href="npc_8cpp_source.html#l02386">npc::attitude_to()</a>, <a class="el" href="npcmove_8cpp_source.html#l03167">npc::avoid_friendly_fire()</a>, <a class="el" href="npc__attack_8cpp.html#a4424b509877ff458aa661c2b49a99dda">bio_hydraulics</a>, <a class="el" href="npc__attack_8cpp_source.html#l00059">can_move_melee()</a>, <a class="el" href="npcmove_8cpp_source.html#l02293">npc::can_use_offensive_cbm()</a>, <a class="el" href="npc_8cpp_source.html#l02949">npc::closest_enemy_to_friendly_distance()</a>, <a class="el" href="creature__tracker_8cpp_source.html#l00303">creature_tracker::creature_at()</a>, <a class="el" href="debug_8h_source.html#l00069">debugmsg</a>, <a class="el" href="debug_8h_source.html#l00267">debugmode::DF_NPC</a>, <a class="el" href="debug_8h_source.html#l00270">debugmode::DF_NPC_MOVEAI</a>, <a class="el" href="character_8cpp_source.html#l00829">Character::disp_name()</a>, <a class="el" href="npc_8h_source.html#l00613">npc_combat_memory_cache::engagement_distance</a>, <a class="el" href="npc_8h_source.html#l00612">npc_combat_memory_cache::formation_distance</a>, <a class="el" href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Creature::FRIENDLY</a>, <a class="el" href="game_8cpp_source.html#l13827">get_creature_tracker()</a>, <a class="el" href="game_8cpp_source.html#l13807">get_player_character()</a>, <a class="el" href="creature_8cpp_source.html#l00722">Creature::is_adjacent()</a>, <a class="el" href="character_8cpp_source.html#l03319">Character::is_wielding()</a>, <a class="el" href="coordinates_8h_source.html#l00798">line_to()</a>, <a class="el" href="calendar_8cpp_source.html#l00034">location</a>, <a class="el" href="npcmove_8cpp_source.html#l04743">npc::look_for_player()</a>, <a class="el" href="melee_8cpp_source.html#l00563">Character::melee_attack()</a>, <a class="el" href="npc_8h_source.html#l01404">npc::mem_combat</a>, <a class="el" href="npcmove_8cpp_source.html#l03372">npc::move_pause()</a>, <a class="el" href="npcmove_8cpp_source.html#l03148">npc::move_to_next()</a>, <a class="el" href="character_8h_source.html#l02684">Character::name</a>, <a class="el" href="npc_8h_source.html#l01390">npc::path</a>, <a class="el" href="npc_8h_source.html#l01402">npc::personality</a>, <a class="el" href="creature_8cpp_source.html#l00178">Creature::pos()</a>, <a class="el" href="melee_8cpp_source.html#l01012">Character::reach_attack()</a>, <a class="el" href="item_8cpp_source.html#l07509">item::reach_range()</a>, <a class="el" href="coordinates_8h_source.html#l00769">rl_dist()</a>, <a class="el" href="calendar_8cpp_source.html#l00779">rng()</a>, <a class="el" href="npcmove_8cpp_source.html#l02811">npc::update_path()</a>, <a class="el" href="npc__attack_8h_source.html#l00081">weapon</a>, and <a class="el" href="npc_8cpp_source.html#l01327">npc::wield()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a570226904885a084905699089c535a60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a570226904885a084905699089c535a60">&#9670;&nbsp;</a></span>weapon</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classitem.html">item</a>&amp; npc_attack_melee::weapon</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npc__attack_8h_source.html#l00081">81</a> of file <a class="el" href="npc__attack_8h_source.html">npc_attack.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="npc__attack_8cpp_source.html#l00386">base_time_penalty()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00380">can_use()</a>, <a class="el" href="npc__attack_8cpp_source.html#l00391">evaluate_critter()</a>, and <a class="el" href="npc__attack_8cpp_source.html#l00232">use()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="npc__attack_8h_source.html">npc_attack.h</a></li>
<li>src/<a class="el" href="npc__attack_8cpp_source.html">npc_attack.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 7 2024 08:48:42 for Cataclysm DDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
