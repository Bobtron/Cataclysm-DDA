<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm DDA: src/mapgen_functions.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm DDA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mapgen_functions.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;functional&gt;</code><br />
<code>#include &lt;iosfwd&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;utility&gt;</code><br />
<code>#include &quot;<a class="el" href="coordinates_8h_source.html">coordinates.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mapdata_8h_source.html">mapdata.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="type__id_8h_source.html">type_id.h</a>&quot;</code><br />
</div>
<p><a href="mapgen__functions_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a11e88a2a1297344330dc4f7d0408d866"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a11e88a2a1297344330dc4f7d0408d866">CATA_SRC_MAPGEN_FUNCTIONS_H</a></td></tr>
<tr class="separator:a11e88a2a1297344330dc4f7d0408d866"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ab0ed42b7c5bb43e11b1b7ced2fdd03f9"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#ab0ed42b7c5bb43e11b1b7ced2fdd03f9">mapgen_update_func</a> = std::function&lt; void(const <a class="el" href="coordinates_8h.html#a383a8345c0282c087ef788e4421c3ded">tripoint_abs_omt</a> &amp;map_pos3, <a class="el" href="classmission.html">mission</a> *miss)&gt;</td></tr>
<tr class="separator:ab0ed42b7c5bb43e11b1b7ced2fdd03f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73687d35da888e19cd484c335a681dc6"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a73687d35da888e19cd484c335a681dc6">building_gen_pointer</a> = void(*)(<a class="el" href="classmapgendata.html">mapgendata</a> &amp;)</td></tr>
<tr class="separator:a73687d35da888e19cd484c335a681dc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a60321e5661fe285e032f87708c5430f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structtripoint.html">tripoint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a60321e5661fe285e032f87708c5430f6">rotate_point</a> (const <a class="el" href="structtripoint.html">tripoint</a> &amp;p, int rotations)</td></tr>
<tr class="memdesc:a60321e5661fe285e032f87708c5430f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the coordinates of a rotated point.  <a href="mapgen__functions_8h.html#a60321e5661fe285e032f87708c5430f6">More...</a><br /></td></tr>
<tr class="separator:a60321e5661fe285e032f87708c5430f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a146716d39d89c98b5df834873f3d38a2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a146716d39d89c98b5df834873f3d38a2">terrain_type_to_nesw_array</a> (<a class="el" href="type__id_8h.html#a08d4e395b54ad28c93af412ee36e00a1">oter_id</a> terrain_type, <a class="el" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7af1f713c9e000f5d3f280adbd124df4f5">std::array</a>&lt; bool, 4 &gt; &amp;<a class="el" href="structarray.html">array</a>)</td></tr>
<tr class="separator:a146716d39d89c98b5df834873f3d38a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74546f1aee2b8192f7565f61fc4bba9d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mapgen_8h.html#a73687d35da888e19cd484c335a681dc6">building_gen_pointer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a74546f1aee2b8192f7565f61fc4bba9d">get_mapgen_cfunction</a> (const <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4ab45cffe084dd3d20d928bee85e7b0f21">std::string</a> &amp;ident)</td></tr>
<tr class="separator:a74546f1aee2b8192f7565f61fc4bba9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95520fe8c1789811c051e5ff7458e468"><td class="memItemLeft" align="right" valign="top"><a class="el" href="map__memory_8h.html#a35072a9fdd9a8d25da4e647a63d1c445">ter_str_id</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a95520fe8c1789811c051e5ff7458e468">grass_or_dirt</a> ()</td></tr>
<tr class="separator:a95520fe8c1789811c051e5ff7458e468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e631bfc1a2400667a6b63e2a5e3c544"><td class="memItemLeft" align="right" valign="top"><a class="el" href="map__memory_8h.html#a35072a9fdd9a8d25da4e647a63d1c445">ter_str_id</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a8e631bfc1a2400667a6b63e2a5e3c544">clay_or_sand</a> ()</td></tr>
<tr class="separator:a8e631bfc1a2400667a6b63e2a5e3c544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb4c2c9ab474f9f0076b44b63b279702"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#acb4c2c9ab474f9f0076b44b63b279702">mapgen_forest</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:acb4c2c9ab474f9f0076b44b63b279702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa918dabddaa2fcbb36f06bf1a8fecd2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#afa918dabddaa2fcbb36f06bf1a8fecd2">mapgen_river_center</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:afa918dabddaa2fcbb36f06bf1a8fecd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87774fae3295ac0f5b165215dee6bfdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a87774fae3295ac0f5b165215dee6bfdd">mapgen_river_curved_not</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:a87774fae3295ac0f5b165215dee6bfdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e34d4074d63b3fa672567dd4d372fb2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a6e34d4074d63b3fa672567dd4d372fb2">mapgen_river_straight</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:a6e34d4074d63b3fa672567dd4d372fb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc6c2781c3ff3c218aecbb41400bb59f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#abc6c2781c3ff3c218aecbb41400bb59f">mapgen_river_curved</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:abc6c2781c3ff3c218aecbb41400bb59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71e1e72a0d703b77f39f4375450b27a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#ac71e1e72a0d703b77f39f4375450b27a">mapgen_rock_partial</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:ac71e1e72a0d703b77f39f4375450b27a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb62dfd957ef2cc7dca9e1d74facc88a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#adb62dfd957ef2cc7dca9e1d74facc88a">mapgen_subway</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:adb62dfd957ef2cc7dca9e1d74facc88a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f58f1cefca5a7566b20e27d4e84fdb1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a9f58f1cefca5a7566b20e27d4e84fdb1">mapgen_lake_shore</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:a9f58f1cefca5a7566b20e27d4e84fdb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77592a40715f66ad7064925d5ec46cec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a77592a40715f66ad7064925d5ec46cec">mapgen_ocean_shore</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:a77592a40715f66ad7064925d5ec46cec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef253441ce417e2f2c708fdfa47ccb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a2ef253441ce417e2f2c708fdfa47ccb5">mapgen_ravine_edge</a> (<a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:a2ef253441ce417e2f2c708fdfa47ccb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45cbd0e902d3cb4e2d757f1c72cf3330"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a45cbd0e902d3cb4e2d757f1c72cf3330">mremove_trap</a> (<a class="el" href="classmap.html">map</a> *m, const <a class="el" href="coordinates_8h.html#a38e880e550bb0688dea9353138da8683">tripoint_bub_ms</a> &amp;, <a class="el" href="type__id_8h.html#a6a456b8f9aeb28a96e3976548a6cb0dc">trap_id</a> type)</td></tr>
<tr class="separator:a45cbd0e902d3cb4e2d757f1c72cf3330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a731242541747c0bce021145aee350c1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a731242541747c0bce021145aee350c1d">mtrap_set</a> (<a class="el" href="classmap.html">map</a> *m, const <a class="el" href="coordinates_8h.html#a38e880e550bb0688dea9353138da8683">tripoint_bub_ms</a> &amp;, <a class="el" href="type__id_8h.html#a6a456b8f9aeb28a96e3976548a6cb0dc">trap_id</a> type, bool avoid_creatures=false)</td></tr>
<tr class="separator:a731242541747c0bce021145aee350c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c1d85aa44746188e5792e2cf02fe726"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a1c1d85aa44746188e5792e2cf02fe726">mtrap_set</a> (<a class="el" href="classtinymap.html">tinymap</a> *m, const <a class="el" href="structpoint.html">point</a> &amp;, <a class="el" href="type__id_8h.html#a6a456b8f9aeb28a96e3976548a6cb0dc">trap_id</a> type, bool avoid_creatures=false)</td></tr>
<tr class="separator:a1c1d85aa44746188e5792e2cf02fe726"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fd29a805402de80c27818c66a6f696b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a4fd29a805402de80c27818c66a6f696b">madd_field</a> (<a class="el" href="classmap.html">map</a> *m, const <a class="el" href="structpoint.html">point</a> &amp;, <a class="el" href="type__id_8h.html#a2a56520b7eef7294fc98230cb883c9d2">field_type_id</a> type, int <a class="el" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a>)</td></tr>
<tr class="separator:a4fd29a805402de80c27818c66a6f696b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7deb23cf27a0fdbc9648640a065903b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#aa7deb23cf27a0fdbc9648640a065903b">mremove_fields</a> (<a class="el" href="classmap.html">map</a> *m, const <a class="el" href="coordinates_8h.html#a38e880e550bb0688dea9353138da8683">tripoint_bub_ms</a> &amp;)</td></tr>
<tr class="separator:aa7deb23cf27a0fdbc9648640a065903b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaeee6da5de683a160e3bd7fbb979965"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mapgen__functions_8h.html#ab0ed42b7c5bb43e11b1b7ced2fdd03f9">mapgen_update_func</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#afaeee6da5de683a160e3bd7fbb979965">add_mapgen_update_func</a> (const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;jo, bool &amp;defer)</td></tr>
<tr class="separator:afaeee6da5de683a160e3bd7fbb979965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79159f605db2f16f348a91425330f08e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a79159f605db2f16f348a91425330f08e">run_mapgen_update_func</a> (const <a class="el" href="type__id_8h.html#a9703e9c28f208c9af0bee38564a5df0b">update_mapgen_id</a> &amp;, const <a class="el" href="coordinates_8h.html#a383a8345c0282c087ef788e4421c3ded">tripoint_abs_omt</a> &amp;omt_pos, const <a class="el" href="structmapgen__arguments.html">mapgen_arguments</a> &amp;, <a class="el" href="classmission.html">mission</a> *miss=nullptr, bool cancel_on_collision=true, bool mirror_horizontal=false, bool mirror_vertical=false, int rotation=0)</td></tr>
<tr class="separator:a79159f605db2f16f348a91425330f08e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72af74c4151f983cbe05413f209b40d5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a72af74c4151f983cbe05413f209b40d5">run_mapgen_update_func</a> (const <a class="el" href="type__id_8h.html#a9703e9c28f208c9af0bee38564a5df0b">update_mapgen_id</a> &amp;, <a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat, bool cancel_on_collision=true)</td></tr>
<tr class="separator:a72af74c4151f983cbe05413f209b40d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf02364d2ef67b23aa27bca2018bc5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a6cf02364d2ef67b23aa27bca2018bc5d">set_queued_points</a> ()</td></tr>
<tr class="separator:a6cf02364d2ef67b23aa27bca2018bc5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b9b565ea11e5c8e001c687c7133811"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#ae8b9b565ea11e5c8e001c687c7133811">run_mapgen_func</a> (const <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4ab45cffe084dd3d20d928bee85e7b0f21">std::string</a> &amp;mapgen_id, <a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:ae8b9b565ea11e5c8e001c687c7133811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f043a26f6795bdf1cdffc73134bce33"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a3f043a26f6795bdf1cdffc73134bce33">apply_construction_marker</a> (const <a class="el" href="type__id_8h.html#a9703e9c28f208c9af0bee38564a5df0b">update_mapgen_id</a> &amp;<a class="el" href="type__id_8h.html#a9703e9c28f208c9af0bee38564a5df0b">update_mapgen_id</a>, const <a class="el" href="coordinates_8h.html#a383a8345c0282c087ef788e4421c3ded">tripoint_abs_omt</a> &amp;omt_pos, const <a class="el" href="structmapgen__arguments.html">mapgen_arguments</a> &amp;args, bool mirror_horizontal, bool mirror_vertical, int rotation, bool <a class="el" href="editmap_8cpp.html#a72802814692d37fcc7aa5e915e011996">apply</a>)</td></tr>
<tr class="separator:a3f043a26f6795bdf1cdffc73134bce33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda68a91c396965da678b3b1f9964426"><td class="memItemLeft" align="right" valign="top">std::pair&lt; <a class="el" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa1d78dc8ed51214e518b5114fe24490ae">std::map</a>&lt; <a class="el" href="type__id_8h.html#a52570fdf9996c7b72d444f8020a741e8">ter_id</a>, int &gt;, <a class="el" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa1d78dc8ed51214e518b5114fe24490ae">std::map</a>&lt; <a class="el" href="type__id_8h.html#a6bc1468ac54b6176b517879f5f77564e">furn_id</a>, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#acda68a91c396965da678b3b1f9964426">get_changed_ids_from_update</a> (const <a class="el" href="type__id_8h.html#a9703e9c28f208c9af0bee38564a5df0b">update_mapgen_id</a> &amp;, const <a class="el" href="structmapgen__arguments.html">mapgen_arguments</a> &amp;, <a class="el" href="type__id_8h.html#a52570fdf9996c7b72d444f8020a741e8">ter_id</a> const &amp;base_ter=<a class="el" href="map__memory_8h.html#a35072a9fdd9a8d25da4e647a63d1c445">ter_str_id</a>(&quot;t_dirt&quot;).id())</td></tr>
<tr class="separator:acda68a91c396965da678b3b1f9964426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad48393641d017a324e4bae968c095a72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmapgen__parameters.html">mapgen_parameters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#ad48393641d017a324e4bae968c095a72">get_map_special_params</a> (const <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4ab45cffe084dd3d20d928bee85e7b0f21">std::string</a> &amp;mapgen_id)</td></tr>
<tr class="separator:ad48393641d017a324e4bae968c095a72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aee6c75824502694d57dbf8487d35f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mapgen__functions_8h.html#a5aee6c75824502694d57dbf8487d35f1">resolve_regional_terrain_and_furniture</a> (const <a class="el" href="classmapgendata.html">mapgendata</a> &amp;dat)</td></tr>
<tr class="separator:a5aee6c75824502694d57dbf8487d35f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a11e88a2a1297344330dc4f7d0408d866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11e88a2a1297344330dc4f7d0408d866">&#9670;&nbsp;</a></span>CATA_SRC_MAPGEN_FUNCTIONS_H</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CATA_SRC_MAPGEN_FUNCTIONS_H</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8h_source.html#l00003">3</a> of file <a class="el" href="mapgen__functions_8h_source.html">mapgen_functions.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a73687d35da888e19cd484c335a681dc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73687d35da888e19cd484c335a681dc6">&#9670;&nbsp;</a></span>building_gen_pointer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="mapgen_8h.html#a73687d35da888e19cd484c335a681dc6">building_gen_pointer</a> =  void ( * )( <a class="el" href="classmapgendata.html">mapgendata</a> &amp; )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8h_source.html#l00034">34</a> of file <a class="el" href="mapgen__functions_8h_source.html">mapgen_functions.h</a>.</p>

</div>
</div>
<a id="ab0ed42b7c5bb43e11b1b7ced2fdd03f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0ed42b7c5bb43e11b1b7ced2fdd03f9">&#9670;&nbsp;</a></span>mapgen_update_func</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="mapgen__functions_8h.html#ab0ed42b7c5bb43e11b1b7ced2fdd03f9">mapgen_update_func</a> =  std::function&lt;void( const <a class="el" href="coordinates_8h.html#a383a8345c0282c087ef788e4421c3ded">tripoint_abs_omt</a> &amp;map_pos3, <a class="el" href="classmission.html">mission</a> *miss )&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8h_source.html#l00023">23</a> of file <a class="el" href="mapgen__functions_8h_source.html">mapgen_functions.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afaeee6da5de683a160e3bd7fbb979965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afaeee6da5de683a160e3bd7fbb979965">&#9670;&nbsp;</a></span>add_mapgen_update_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mapgen__functions_8h.html#ab0ed42b7c5bb43e11b1b7ced2fdd03f9">mapgen_update_func</a> add_mapgen_update_func </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;&#160;</td>
          <td class="paramname"><em>jo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>defer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l07898">7898</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;{</div>
<div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;    <span class="keywordflow">if</span>( jo.<a class="code" href="classJsonObject.html#ac8dd6467300eb62e7ce842c3d99c083e">has_string</a>( <span class="stringliteral">&quot;mapgen_update_id&quot;</span> ) ) {</div>
<div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;        <span class="keyword">const</span> <a class="code" href="classstring__id.html">update_mapgen_id</a> mapgen_update_id{ jo.<a class="code" href="classJsonObject.html#a1abb3808bb2a992716d5ef6f27a32b3c">get_string</a>( <span class="stringliteral">&quot;mapgen_update_id&quot;</span> ) };</div>
<div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> update_function = [mapgen_update_id]( <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_omt</a> &amp; omt_pos,</div>
<div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;        <a class="code" href="classmission.html">mission</a> * miss ) {</div>
<div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;            <a class="code" href="mapgen_8cpp.html#a6a25dca035599e6f281495d39d0768a6">run_mapgen_update_func</a>( mapgen_update_id, omt_pos, {}, miss, false );</div>
<div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;        };</div>
<div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;        <span class="keywordflow">return</span> update_function;</div>
<div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;    }</div>
<div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160; </div>
<div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;    <a class="code" href="classupdate__mapgen__function__json.html">update_mapgen_function_json</a> json_data( {},</div>
<div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;                                           <span class="stringliteral">&quot;unknown object in add_mapgen_update_func&quot;</span> );</div>
<div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;    <a class="code" href="namespacemapgen__defer.html#ab55b5d5d45624b191489bb2628afbc7f">mapgen_defer::defer</a> = <a class="code" href="namespacemapgen__defer.html#ab55b5d5d45624b191489bb2628afbc7f">defer</a>;</div>
<div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;    <span class="keywordflow">if</span>( !json_data.setup_update( jo ) ) {</div>
<div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> null_function = []( <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_omt</a> &amp;, <a class="code" href="classmission.html">mission</a> * ) {</div>
<div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;        };</div>
<div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;        <span class="keywordflow">return</span> null_function;</div>
<div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;    }</div>
<div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> update_function = [json_data]( <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_omt</a> &amp; omt_pos, <a class="code" href="classmission.html">mission</a> * miss ) {</div>
<div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;        json_data.update_map( omt_pos, {}, <a class="code" href="coordinates_8h.html#a9b033e645beea804e02a982600b4a7ae">tripoint_rel_ms</a>( <a class="code" href="point_8h.html#a4b1a6bcaa42d2c06ecc3afc63305bfdf">tripoint_zero</a> ), miss );</div>
<div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;    };</div>
<div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;    <a class="code" href="namespacemapgen__defer.html#ab55b5d5d45624b191489bb2628afbc7f">defer</a> = <a class="code" href="namespacemapgen__defer.html#ab55b5d5d45624b191489bb2628afbc7f">mapgen_defer::defer</a>;</div>
<div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;    <a class="code" href="namespacemapgen__defer.html#ac7abbde97374a05af2e7077ba9955ed1">mapgen_defer::jsi</a> = <a class="code" href="classJsonObject.html">JsonObject</a>();</div>
<div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;    <span class="keywordflow">return</span> update_function;</div>
<div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;}</div>
<div class="ttc" id="aclassJsonObject_html"><div class="ttname"><a href="classJsonObject.html">JsonObject</a></div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00526">flexbuffer_json.h:527</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a1abb3808bb2a992716d5ef6f27a32b3c"><div class="ttname"><a href="classJsonObject.html#a1abb3808bb2a992716d5ef6f27a32b3c">JsonObject::get_string</a></div><div class="ttdeci">std::string get_string(const std::string &amp;key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00813">flexbuffer_json-inl.h:813</a></div></div>
<div class="ttc" id="aclassJsonObject_html_ac8dd6467300eb62e7ce842c3d99c083e"><div class="ttname"><a href="classJsonObject.html#ac8dd6467300eb62e7ce842c3d99c083e">JsonObject::has_string</a></div><div class="ttdeci">bool has_string(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00972">flexbuffer_json-inl.h:972</a></div></div>
<div class="ttc" id="aclasscoords_1_1coord__point_html"><div class="ttname"><a href="classcoords_1_1coord__point.html">coords::coord_point&lt; tripoint, coords::origin::abs, coords::omt &gt;</a></div></div>
<div class="ttc" id="aclassmission_html"><div class="ttname"><a href="classmission.html">mission</a></div><div class="ttdef"><b>Definition:</b> <a href="mission_8h_source.html#l00272">mission.h:273</a></div></div>
<div class="ttc" id="aclassstring__id_html"><div class="ttname"><a href="classstring__id.html">string_id&lt; update_mapgen &gt;</a></div></div>
<div class="ttc" id="aclassupdate__mapgen__function__json_html"><div class="ttname"><a href="classupdate__mapgen__function__json.html">update_mapgen_function_json</a></div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00516">mapgen.h:517</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a9b033e645beea804e02a982600b4a7ae"><div class="ttname"><a href="coordinates_8h.html#a9b033e645beea804e02a982600b4a7ae">tripoint_rel_ms</a></div><div class="ttdeci">coords::coord_point&lt; tripoint, coords::origin::relative, coords::ms &gt; tripoint_rel_ms</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00711">coordinates.h:711</a></div></div>
<div class="ttc" id="amapgen_8cpp_html_a6a25dca035599e6f281495d39d0768a6"><div class="ttname"><a href="mapgen_8cpp.html#a6a25dca035599e6f281495d39d0768a6">run_mapgen_update_func</a></div><div class="ttdeci">bool run_mapgen_update_func(const update_mapgen_id &amp;update_mapgen_id, const tripoint_abs_omt &amp;omt_pos, const mapgen_arguments &amp;args, mission *miss, bool cancel_on_collision, bool mirror_horizontal, bool mirror_vertical, int rotation)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l07925">mapgen.cpp:7925</a></div></div>
<div class="ttc" id="anamespacemapgen__defer_html_ab55b5d5d45624b191489bb2628afbc7f"><div class="ttname"><a href="namespacemapgen__defer.html#ab55b5d5d45624b191489bb2628afbc7f">mapgen_defer::defer</a></div><div class="ttdeci">static bool defer</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l00633">mapgen.cpp:633</a></div></div>
<div class="ttc" id="anamespacemapgen__defer_html_ac7abbde97374a05af2e7077ba9955ed1"><div class="ttname"><a href="namespacemapgen__defer.html#ac7abbde97374a05af2e7077ba9955ed1">mapgen_defer::jsi</a></div><div class="ttdeci">static JsonObject jsi</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l00634">mapgen.cpp:634</a></div></div>
<div class="ttc" id="apoint_8h_html_a4b1a6bcaa42d2c06ecc3afc63305bfdf"><div class="ttname"><a href="point_8h.html#a4b1a6bcaa42d2c06ecc3afc63305bfdf">tripoint_zero</a></div><div class="ttdeci">constexpr tripoint tripoint_zero</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00250">point.h:250</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l00633">mapgen_defer::defer</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l00813">JsonObject::get_string()</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l00972">JsonObject::has_string()</a>, <a class="el" href="mapgen_8cpp_source.html#l00634">mapgen_defer::jsi</a>, <a class="el" href="mapgen_8cpp_source.html#l07925">run_mapgen_update_func()</a>, and <a class="el" href="point_8h_source.html#l00250">tripoint_zero</a>.</p>

<p class="reference">Referenced by <a class="el" href="mission__util_8cpp_source.html#l00473">mission_util::set_update_mapgen()</a>.</p>

</div>
</div>
<a id="a3f043a26f6795bdf1cdffc73134bce33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f043a26f6795bdf1cdffc73134bce33">&#9670;&nbsp;</a></span>apply_construction_marker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool apply_construction_marker </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a9703e9c28f208c9af0bee38564a5df0b">update_mapgen_id</a> &amp;&#160;</td>
          <td class="paramname"><em>update_mapgen_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="coordinates_8h.html#a383a8345c0282c087ef788e4421c3ded">tripoint_abs_omt</a> &amp;&#160;</td>
          <td class="paramname"><em>omt_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmapgen__arguments.html">mapgen_arguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>mirror_horizontal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>mirror_vertical</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rotation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>apply</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l07960">7960</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;{</div>
<div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160; </div>
<div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> update_function = <a class="code" href="mapgen_8cpp.html#a67da18577384b9fb7798532356539bf1">update_mapgens</a>.find( <a class="code" href="classstring__id.html">update_mapgen_id</a> );</div>
<div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160; </div>
<div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;    <span class="keywordflow">if</span>( update_function == <a class="code" href="mapgen_8cpp.html#a67da18577384b9fb7798532356539bf1">update_mapgens</a>.end() || update_function-&gt;second.funcs().empty() ) {</div>
<div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;    }</div>
<div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160; </div>
<div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;    <a class="code" href="classfake__map.html">fake_map</a> tmp_map( <a class="code" href="mapgen_8cpp.html#afa18c8c17b0b33f364c72c636824686f">ter_t_grass</a> );</div>
<div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160; </div>
<div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;    <a class="code" href="classmapgendata.html">mapgendata</a> base_fake_md( *tmp_map.cast_to_map(), <a class="code" href="classmapgendata.html#adbc3404e427c8c1c8a4d05c8c78f3234">mapgendata::dummy_settings</a> );</div>
<div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;    <a class="code" href="classmapgendata.html">mapgendata</a> fake_md( base_fake_md, args );</div>
<div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;    fake_md.skip = { <a class="code" href="mapgen_8h.html#afdd0a1598dc015b56a1b46d51da2b06ea26f94136f5db8afd4e9df1e512f7fdc5">mapgen_phase::zones</a> };</div>
<div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160; </div>
<div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;    std::unique_ptr&lt;tinymap&gt; p_update_tmap = std::make_unique&lt;tinymap&gt;();</div>
<div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;    <a class="code" href="classtinymap.html">tinymap</a> &amp;update_tmap = *p_update_tmap;</div>
<div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160; </div>
<div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;    update_tmap.<a class="code" href="classtinymap.html#a7f913ba5d8facdb8c3d6b759593095fc">load</a>( omt_pos, <span class="keyword">true</span> );</div>
<div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;    update_tmap.<a class="code" href="classtinymap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 4 - rotation );</div>
<div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;    update_tmap.<a class="code" href="classtinymap.html#a6252ed435531bcc76b87c82b3c28fcb4">mirror</a>( mirror_horizontal, mirror_vertical );</div>
<div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160; </div>
<div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;    {</div>
<div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;        <span class="comment">// Make sure rot goes out of scope and its destructor restores the map before the</span></div>
<div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;        <span class="comment">// &quot;outer scope&quot; mirroring/rotation is undone. It&#39;s unlikely inherent map rotation will</span></div>
<div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160;        <span class="comment">// be present at the same time as construction rotation/mirroring is, but better safe than sorry.</span></div>
<div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160; </div>
<div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;        <a class="code" href="classmapgendata.html">mapgendata</a> md_base( omt_pos, *update_tmap.<a class="code" href="classtinymap.html#ae74ab9b6833566b0df22e2c132dfae8a">cast_to_map</a>(), 0.0f, <a class="code" href="namespacecalendar.html#a0b28c598688bb85fbe9619baa7edf24b">calendar::start_of_cataclysm</a>,</div>
<div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;                            <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160;        <a class="code" href="classmapgendata.html">mapgendata</a> md( md_base, args );</div>
<div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160; </div>
<div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;        <a class="code" href="classrotation__guard.html">rotation_guard</a> rot( md );</div>
<div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160; </div>
<div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;        <span class="keywordflow">if</span>( update_function-&gt;second.funcs()[0]-&gt;update_map( fake_md ) ) {</div>
<div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> : tmp_map.points_on_zlevel( <a class="code" href="classfake__map.html#a039322bf77b1321e9b4cf1c499b35a2b">fake_map::fake_map_z</a> ) ) {</div>
<div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;                <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> level_pos = <a class="code" href="structtripoint.html">tripoint</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.xy(), omt_pos.<a class="code" href="classcoords_1_1coord__point__mut.html#aa94b8bd33e85ce94a3634e6e27ab0cdd">z</a>() );</div>
<div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;                <span class="keywordflow">if</span>( tmp_map.ter( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) != <a class="code" href="mapgen_8cpp.html#afa18c8c17b0b33f364c72c636824686f">ter_t_grass</a> || tmp_map.has_furn( level_pos ) ) {</div>
<div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;                    <span class="keywordflow">if</span>( <a class="code" href="editmap_8cpp.html#a72802814692d37fcc7aa5e915e011996">apply</a> ) {</div>
<div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;                        update_tmap.<a class="code" href="classtinymap.html#aaf3320a2ef9fc2085cb1ddf8e4af5390">add_field</a>( level_pos, <a class="code" href="field__type_8cpp.html#a13ce6c55cbe23b25eb4516e42be659da">fd_construction_site</a>, 1, <a class="code" href="classtime__duration.html#a0f7145f4fc4c09defbaf25f468e4e54a">time_duration::from_turns</a>( 0 ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;                        update_tmap.<a class="code" href="classtinymap.html#a033a34805abc13b13923c65c9ec2f2ae">delete_field</a>( level_pos, <a class="code" href="field__type_8cpp.html#a13ce6c55cbe23b25eb4516e42be659da">fd_construction_site</a> );</div>
<div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;                    }</div>
<div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;                }</div>
<div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;            }</div>
<div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;        }</div>
<div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;    }</div>
<div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160; </div>
<div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;    update_tmap.<a class="code" href="classtinymap.html#a6252ed435531bcc76b87c82b3c28fcb4">mirror</a>( mirror_horizontal, mirror_vertical );</div>
<div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;    update_tmap.<a class="code" href="classtinymap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( rotation );</div>
<div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160; </div>
<div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;}</div>
<div class="ttc" id="aclasscoords_1_1coord__point__mut_html_aa94b8bd33e85ce94a3634e6e27ab0cdd"><div class="ttname"><a href="classcoords_1_1coord__point__mut.html#aa94b8bd33e85ce94a3634e6e27ab0cdd">coords::coord_point_mut::z</a></div><div class="ttdeci">constexpr auto z() const</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00167">coordinates.h:167</a></div></div>
<div class="ttc" id="aclassfake__map_html"><div class="ttname"><a href="classfake__map.html">fake_map</a></div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02693">map.h:2694</a></div></div>
<div class="ttc" id="aclassfake__map_html_a039322bf77b1321e9b4cf1c499b35a2b"><div class="ttname"><a href="classfake__map.html#a039322bf77b1321e9b4cf1c499b35a2b">fake_map::fake_map_z</a></div><div class="ttdeci">static constexpr int fake_map_z</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02700">map.h:2700</a></div></div>
<div class="ttc" id="aclassmapgendata_html"><div class="ttname"><a href="classmapgendata.html">mapgendata</a></div><div class="ttdoc">Contains various information regarding the individual mapgen instance (generating a specific part of ...</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00101">mapgendata.h:102</a></div></div>
<div class="ttc" id="aclassmapgendata_html_adbc3404e427c8c1c8a4d05c8c78f3234"><div class="ttname"><a href="classmapgendata.html#adbc3404e427c8c1c8a4d05c8c78f3234">mapgendata::dummy_settings</a></div><div class="ttdeci">static constexpr dummy_settings_t dummy_settings</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00137">mapgendata.h:137</a></div></div>
<div class="ttc" id="aclassrotation__guard_html"><div class="ttname"><a href="classrotation__guard.html">rotation_guard</a></div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l07863">mapgen.cpp:7864</a></div></div>
<div class="ttc" id="aclasstime__duration_html_a0f7145f4fc4c09defbaf25f468e4e54a"><div class="ttname"><a href="classtime__duration.html#a0f7145f4fc4c09defbaf25f468e4e54a">time_duration::from_turns</a></div><div class="ttdeci">static constexpr time_duration from_turns(const T t)</div><div class="ttdoc">Named constructors to get a duration representing a multiple of the named time units.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00221">calendar.h:221</a></div></div>
<div class="ttc" id="aclasstinymap_html"><div class="ttname"><a href="classtinymap.html">tinymap</a></div><div class="ttdoc">Tinymap is a small version of the map which covers a single overmap terrain (OMT) tile,...</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02422">map.h:2423</a></div></div>
<div class="ttc" id="aclasstinymap_html_a033a34805abc13b13923c65c9ec2f2ae"><div class="ttname"><a href="classtinymap.html#a033a34805abc13b13923c65c9ec2f2ae">tinymap::delete_field</a></div><div class="ttdeci">void delete_field(const tripoint &amp;p, const field_type_id &amp;field_to_remove)</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02608">map.h:2608</a></div></div>
<div class="ttc" id="aclasstinymap_html_a37268cf3dfc2a32e85a40c2a7266dfc9"><div class="ttname"><a href="classtinymap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">tinymap::rotate</a></div><div class="ttdeci">void rotate(int turns, bool setpos_safe=false)</div><div class="ttdoc">Rotates this map, and all of its contents, by the specified multiple of 90 degrees.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l01920">mapgen.cpp:6948</a></div></div>
<div class="ttc" id="aclasstinymap_html_a6252ed435531bcc76b87c82b3c28fcb4"><div class="ttname"><a href="classtinymap.html#a6252ed435531bcc76b87c82b3c28fcb4">tinymap::mirror</a></div><div class="ttdeci">void mirror(bool mirror_horizontal, bool mirror_vertical)</div><div class="ttdoc">Mirrors this map, and all of its contents along with all its contents in the directions specified.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l01933">mapgen.cpp:7099</a></div></div>
<div class="ttc" id="aclasstinymap_html_a7f913ba5d8facdb8c3d6b759593095fc"><div class="ttname"><a href="classtinymap.html#a7f913ba5d8facdb8c3d6b759593095fc">tinymap::load</a></div><div class="ttdeci">void load(const tripoint_abs_omt &amp;w, bool update_vehicles, bool pump_events=false)</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02447">map.h:2447</a></div></div>
<div class="ttc" id="aclasstinymap_html_aaf3320a2ef9fc2085cb1ddf8e4af5390"><div class="ttname"><a href="classtinymap.html#aaf3320a2ef9fc2085cb1ddf8e4af5390">tinymap::add_field</a></div><div class="ttdeci">bool add_field(const tripoint &amp;p, const field_type_id &amp;type_id, int intensity=INT_MAX, const time_duration &amp;age=0_turns, bool hit_player=true)</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02600">map.h:2600</a></div></div>
<div class="ttc" id="aclasstinymap_html_ae74ab9b6833566b0df22e2c132dfae8a"><div class="ttname"><a href="classtinymap.html#ae74ab9b6833566b0df22e2c132dfae8a">tinymap::cast_to_map</a></div><div class="ttdeci">map * cast_to_map()</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02442">map.h:2442</a></div></div>
<div class="ttc" id="aeditmap_8cpp_html_a72802814692d37fcc7aa5e915e011996"><div class="ttname"><a href="editmap_8cpp.html#a72802814692d37fcc7aa5e915e011996">apply</a></div><div class="ttdeci">static void apply(const T_t &amp;t, shapetype editshape, const tripoint &amp;target, const tripoint &amp;origin, const std::vector&lt; tripoint &gt; &amp;target_list)</div></div>
<div class="ttc" id="afield__type_8cpp_html_a13ce6c55cbe23b25eb4516e42be659da"><div class="ttname"><a href="field__type_8cpp.html#a13ce6c55cbe23b25eb4516e42be659da">fd_construction_site</a></div><div class="ttdeci">const field_type_str_id fd_construction_site(&quot;fd_construction_site&quot;)</div></div>
<div class="ttc" id="amapgen_8cpp_html_a67da18577384b9fb7798532356539bf1"><div class="ttname"><a href="mapgen_8cpp.html#a67da18577384b9fb7798532356539bf1">update_mapgens</a></div><div class="ttdeci">std::map&lt; update_mapgen_id, update_mapgen &gt; update_mapgens</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l00530">mapgen.cpp:530</a></div></div>
<div class="ttc" id="amapgen_8cpp_html_afa18c8c17b0b33f364c72c636824686f"><div class="ttname"><a href="mapgen_8cpp.html#afa18c8c17b0b33f364c72c636824686f">ter_t_grass</a></div><div class="ttdeci">static const ter_str_id ter_t_grass(&quot;t_grass&quot;)</div></div>
<div class="ttc" id="amapgen_8h_html_afdd0a1598dc015b56a1b46d51da2b06ea26f94136f5db8afd4e9df1e512f7fdc5"><div class="ttname"><a href="mapgen_8h.html#afdd0a1598dc015b56a1b46d51da2b06ea26f94136f5db8afd4e9df1e512f7fdc5">mapgen_phase::zones</a></div><div class="ttdeci">@ zones</div></div>
<div class="ttc" id="anamespacecalendar_html_a0b28c598688bb85fbe9619baa7edf24b"><div class="ttname"><a href="namespacecalendar.html#a0b28c598688bb85fbe9619baa7edf24b">calendar::start_of_cataclysm</a></div><div class="ttdeci">time_point start_of_cataclysm</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00036">calendar.cpp:36</a></div></div>
<div class="ttc" id="anamespacemath__opers_html_a2f0118617735cc810b9d76d62bd182f6"><div class="ttname"><a href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">math_opers::pos</a></div><div class="ttdeci">constexpr double pos(double, double r)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__impl_8h_source.html#l00203">math_parser_impl.h:203</a></div></div>
<div class="ttc" id="astructtripoint_html"><div class="ttname"><a href="structtripoint.html">tripoint</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00129">point.h:129</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="map_8h_source.html#l02600">tinymap::add_field()</a>, <a class="el" href="editmap_8cpp.html#a72802814692d37fcc7aa5e915e011996">apply()</a>, <a class="el" href="map_8h_source.html#l02442">tinymap::cast_to_map()</a>, <a class="el" href="map_8h_source.html#l02608">tinymap::delete_field()</a>, <a class="el" href="mapgendata_8h_source.html#l00137">mapgendata::dummy_settings</a>, <a class="el" href="map_8h_source.html#l02700">fake_map::fake_map_z</a>, <a class="el" href="field__type_8cpp.html#a13ce6c55cbe23b25eb4516e42be659da">fd_construction_site</a>, <a class="el" href="calendar_8h_source.html#l00221">time_duration::from_turns()</a>, <a class="el" href="map_8h_source.html#l02504">tinymap::has_furn()</a>, <a class="el" href="map_8h_source.html#l02447">tinymap::load()</a>, <a class="el" href="mapgen_8cpp_source.html#l07099">tinymap::mirror()</a>, <a class="el" href="map_8cpp_source.html#l09089">tinymap::points_on_zlevel()</a>, <a class="el" href="math__parser__impl_8h_source.html#l00203">math_opers::pos()</a>, <a class="el" href="mapgen_8cpp_source.html#l06948">tinymap::rotate()</a>, <a class="el" href="mapgendata_8h_source.html#l00144">mapgendata::skip</a>, <a class="el" href="calendar_8cpp_source.html#l00036">calendar::start_of_cataclysm</a>, <a class="el" href="map_8h_source.html#l02471">tinymap::ter()</a>, <a class="el" href="mapgen_8cpp.html#afa18c8c17b0b33f364c72c636824686f">ter_t_grass</a>, <a class="el" href="mapgen_8cpp_source.html#l00530">update_mapgens</a>, <a class="el" href="coordinates_8h_source.html#l00167">coords::coord_point_mut&lt; Point, Subpoint, InBounds &gt;::z()</a>, and <a class="el" href="mapgen_8h.html#afdd0a1598dc015b56a1b46d51da2b06ea26f94136f5db8afd4e9df1e512f7fdc5">zones</a>.</p>

<p class="reference">Referenced by <a class="el" href="faction__camp_8cpp_source.html#l02755">apply_fortifications()</a>, <a class="el" href="faction__camp_8cpp_source.html#l03114">basecamp::common_salt_water_pipe_construction()</a>, <a class="el" href="faction__camp_8cpp_source.html#l04151">basecamp::salt_water_pipe_return()</a>, <a class="el" href="faction__camp_8cpp_source.html#l04060">basecamp::salt_water_pipe_swamp_return()</a>, <a class="el" href="faction__camp_8cpp_source.html#l02084">basecamp::start_upgrade()</a>, and <a class="el" href="faction__camp_8cpp_source.html#l03875">basecamp::upgrade_return()</a>.</p>

</div>
</div>
<a id="a8e631bfc1a2400667a6b63e2a5e3c544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e631bfc1a2400667a6b63e2a5e3c544">&#9670;&nbsp;</a></span>clay_or_sand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="map__memory_8h.html#a35072a9fdd9a8d25da4e647a63d1c445">ter_str_id</a> clay_or_sand </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00146">146</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 16 ) ) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="mapgen__functions_8cpp.html#aa97140c8aea2d1d10175fc60f47ff47c">ter_t_sand</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mapgen__functions_8cpp.html#a8df064af5f1ba517cc858bf39b5da275">ter_t_clay</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="ttc" id="amapgen__functions_8cpp_html_a8df064af5f1ba517cc858bf39b5da275"><div class="ttname"><a href="mapgen__functions_8cpp.html#a8df064af5f1ba517cc858bf39b5da275">ter_t_clay</a></div><div class="ttdeci">static const ter_str_id ter_t_clay(&quot;t_clay&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_aa97140c8aea2d1d10175fc60f47ff47c"><div class="ttname"><a href="mapgen__functions_8cpp.html#aa97140c8aea2d1d10175fc60f47ff47c">ter_t_sand</a></div><div class="ttdeci">static const ter_str_id ter_t_sand(&quot;t_sand&quot;)</div></div>
<div class="ttc" id="arng_8cpp_html_aad28bdad07401a34ecf9912708f8b750"><div class="ttname"><a href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a></div><div class="ttdeci">bool one_in(int chance)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00108">rng.cpp:108</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="rng_8cpp_source.html#l00108">one_in()</a>, <a class="el" href="mapgen__functions_8cpp.html#a8df064af5f1ba517cc858bf39b5da275">ter_t_clay</a>, and <a class="el" href="mapgen__functions_8cpp.html#aa97140c8aea2d1d10175fc60f47ff47c">ter_t_sand</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00626">mapgen_river_curved()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00566">mapgen_river_curved_not()</a>, and <a class="el" href="mapgen__functions_8cpp_source.html#l00600">mapgen_river_straight()</a>.</p>

</div>
</div>
<a id="acda68a91c396965da678b3b1f9964426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda68a91c396965da678b3b1f9964426">&#9670;&nbsp;</a></span>get_changed_ids_from_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt;<a class="el" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa1d78dc8ed51214e518b5114fe24490ae">std::map</a>&lt;<a class="el" href="type__id_8h.html#a52570fdf9996c7b72d444f8020a741e8">ter_id</a>, int&gt;, <a class="el" href="craft__command_8h.html#a78e9fef1fc6aaee4239b8fa5cc3cd21fa1d78dc8ed51214e518b5114fe24490ae">std::map</a>&lt;<a class="el" href="type__id_8h.html#a6bc1468ac54b6176b517879f5f77564e">furn_id</a>, int&gt; &gt; get_changed_ids_from_update </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a9703e9c28f208c9af0bee38564a5df0b">update_mapgen_id</a> &amp;&#160;</td>
          <td class="paramname"><em>update_mapgen_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmapgen__arguments.html">mapgen_arguments</a> &amp;&#160;</td>
          <td class="paramname"><em>mapgen_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type__id_8h.html#a52570fdf9996c7b72d444f8020a741e8">ter_id</a> const &amp;&#160;</td>
          <td class="paramname"><em>base_ter</em> = <code><a class="el" href="map__memory_8h.html#a35072a9fdd9a8d25da4e647a63d1c445">ter_str_id</a>(&quot;t_dirt&quot;).id()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l08016">8016</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;{</div>
<div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;    std::map&lt;ter_id, int&gt; <a class="code" href="namespaceanonymous__namespace_02overmap_8cpp_03.html#a0e39b8214ad67bb4521e0cb23b6b690b">terrains</a>;</div>
<div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;    std::map&lt;furn_id, int&gt; furnitures;</div>
<div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160; </div>
<div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> update_function = <a class="code" href="mapgen_8cpp.html#a67da18577384b9fb7798532356539bf1">update_mapgens</a>.find( <a class="code" href="classstring__id.html">update_mapgen_id</a> );</div>
<div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160; </div>
<div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160;    <span class="keywordflow">if</span>( update_function == <a class="code" href="mapgen_8cpp.html#a67da18577384b9fb7798532356539bf1">update_mapgens</a>.end() || update_function-&gt;second.funcs().empty() ) {</div>
<div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;        <span class="keywordflow">return</span> std::make_pair( <a class="code" href="namespaceanonymous__namespace_02overmap_8cpp_03.html#a0e39b8214ad67bb4521e0cb23b6b690b">terrains</a>, furnitures );</div>
<div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;    }</div>
<div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160; </div>
<div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;    <a class="code" href="classfake__map.html">fake_map</a> tmp_map( base_ter );</div>
<div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160; </div>
<div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;    <a class="code" href="classmapgendata.html">mapgendata</a> base_fake_md( *tmp_map.cast_to_map(), <a class="code" href="classmapgendata.html#adbc3404e427c8c1c8a4d05c8c78f3234">mapgendata::dummy_settings</a> );</div>
<div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;    <a class="code" href="classmapgendata.html">mapgendata</a> fake_md( base_fake_md, mapgen_args );</div>
<div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;    fake_md.skip = { <a class="code" href="mapgen_8h.html#afdd0a1598dc015b56a1b46d51da2b06ea26f94136f5db8afd4e9df1e512f7fdc5">mapgen_phase::zones</a> };</div>
<div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160; </div>
<div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;    <span class="keywordflow">if</span>( update_function-&gt;second.funcs()[0]-&gt;update_map( fake_md ) ) {</div>
<div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> : tmp_map.points_on_zlevel( <a class="code" href="classfake__map.html#a039322bf77b1321e9b4cf1c499b35a2b">fake_map::fake_map_z</a> ) ) {</div>
<div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;            <a class="code" href="classint__id.html">ter_id</a> ter_at_pos = tmp_map.ter( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;            <span class="keywordflow">if</span>( ter_at_pos != base_ter ) {</div>
<div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;                <a class="code" href="namespaceanonymous__namespace_02overmap_8cpp_03.html#a0e39b8214ad67bb4521e0cb23b6b690b">terrains</a>[ter_at_pos] += 1;</div>
<div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;            }</div>
<div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;            <span class="keywordflow">if</span>( tmp_map.has_furn( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) ) {</div>
<div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;                <a class="code" href="classint__id.html">furn_id</a> furn_at_pos = tmp_map.furn( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;                furnitures[furn_at_pos] += 1;</div>
<div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;            }</div>
<div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;        }</div>
<div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;    }</div>
<div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;    <span class="keywordflow">return</span> std::make_pair( <a class="code" href="namespaceanonymous__namespace_02overmap_8cpp_03.html#a0e39b8214ad67bb4521e0cb23b6b690b">terrains</a>, furnitures );</div>
<div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;}</div>
<div class="ttc" id="aclassint__id_html"><div class="ttname"><a href="classint__id.html">int_id&lt; ter_t &gt;</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02overmap_8cpp_03_html_a0e39b8214ad67bb4521e0cb23b6b690b"><div class="ttname"><a href="namespaceanonymous__namespace_02overmap_8cpp_03.html#a0e39b8214ad67bb4521e0cb23b6b690b">anonymous_namespace{overmap.cpp}::terrains</a></div><div class="ttdeci">generic_factory&lt; oter_t &gt; terrains(&quot;overmap terrain&quot;)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="map_8h_source.html#l02442">tinymap::cast_to_map()</a>, <a class="el" href="mapgendata_8h_source.html#l00137">mapgendata::dummy_settings</a>, <a class="el" href="map_8h_source.html#l02700">fake_map::fake_map_z</a>, <a class="el" href="map_8h_source.html#l02495">tinymap::furn()</a>, <a class="el" href="map_8h_source.html#l02504">tinymap::has_furn()</a>, <a class="el" href="map_8cpp_source.html#l09089">tinymap::points_on_zlevel()</a>, <a class="el" href="math__parser__impl_8h_source.html#l00203">math_opers::pos()</a>, <a class="el" href="mapgendata_8h_source.html#l00144">mapgendata::skip</a>, <a class="el" href="map_8h_source.html#l02471">tinymap::ter()</a>, <a class="el" href="namespaceanonymous__namespace_02overmap_8cpp_03.html#a0e39b8214ad67bb4521e0cb23b6b690b">anonymous_namespace{overmap.cpp}::terrains</a>, <a class="el" href="mapgen_8cpp_source.html#l00530">update_mapgens</a>, and <a class="el" href="mapgen_8h.html#afdd0a1598dc015b56a1b46d51da2b06ea26f94136f5db8afd4e9df1e512f7fdc5">zones</a>.</p>

<p class="reference">Referenced by <a class="el" href="recipe_8cpp_source.html#l00473">calculate_all_blueprint_reqs()</a>, and <a class="el" href="recipe_8cpp_source.html#l01412">recipe::check_blueprint_requirements()</a>.</p>

</div>
</div>
<a id="ad48393641d017a324e4bae968c095a72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad48393641d017a324e4bae968c095a72">&#9670;&nbsp;</a></span>get_map_special_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmapgen__parameters.html">mapgen_parameters</a> get_map_special_params </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4ab45cffe084dd3d20d928bee85e7b0f21">std::string</a> &amp;&#160;</td>
          <td class="paramname"><em>mapgen_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l08055">8055</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;{</div>
<div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mapgen_8cpp.html#af6cc2c9dd319faeca5143d10b2e2304a">oter_mapgen</a>.<a class="code" href="classmapgen__factory.html#ab5da1f23f2fce07722786fc6f7bb492f">get_map_special_params</a>( mapgen_id );</div>
<div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;}</div>
<div class="ttc" id="aclassmapgen__factory_html_ab5da1f23f2fce07722786fc6f7bb492f"><div class="ttname"><a href="classmapgen__factory.html#ab5da1f23f2fce07722786fc6f7bb492f">mapgen_factory::get_map_special_params</a></div><div class="ttdeci">mapgen_parameters get_map_special_params(const std::string &amp;key) const</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l00516">mapgen.cpp:516</a></div></div>
<div class="ttc" id="amapgen_8cpp_html_af6cc2c9dd319faeca5143d10b2e2304a"><div class="ttname"><a href="mapgen_8cpp.html#af6cc2c9dd319faeca5143d10b2e2304a">oter_mapgen</a></div><div class="ttdeci">static mapgen_factory oter_mapgen</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l00527">mapgen.cpp:527</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l00516">mapgen_factory::get_map_special_params()</a>, and <a class="el" href="mapgen_8cpp_source.html#l00527">oter_mapgen</a>.</p>

<p class="reference">Referenced by <a class="el" href="overmap_8cpp_source.html#l01267">fixed_overmap_special_data::finalize_mapgen_parameters()</a>, and <a class="el" href="overmap_8cpp_source.html#l02440">mutable_overmap_special_data::finalize_mapgen_parameters()</a>.</p>

</div>
</div>
<a id="a74546f1aee2b8192f7565f61fc4bba9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74546f1aee2b8192f7565f61fc4bba9d">&#9670;&nbsp;</a></span>get_mapgen_cfunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mapgen_8h.html#a73687d35da888e19cd484c335a681dc6">building_gen_pointer</a> get_mapgen_cfunction </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4ab45cffe084dd3d20d928bee85e7b0f21">std::string</a> &amp;&#160;</td>
          <td class="paramname"><em>ident</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00111">111</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> std::map&lt;std::string, building_gen_pointer&gt; pointers = { {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            { <span class="stringliteral">&quot;forest&quot;</span>,           &amp;<a class="code" href="mapgen__functions_8cpp.html#acb4c2c9ab474f9f0076b44b63b279702">mapgen_forest</a> },</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            { <span class="stringliteral">&quot;river_center&quot;</span>, &amp;<a class="code" href="mapgen__functions_8cpp.html#afa918dabddaa2fcbb36f06bf1a8fecd2">mapgen_river_center</a> },</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            { <span class="stringliteral">&quot;river_curved_not&quot;</span>, &amp;<a class="code" href="mapgen__functions_8cpp.html#a87774fae3295ac0f5b165215dee6bfdd">mapgen_river_curved_not</a> },</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            { <span class="stringliteral">&quot;river_straight&quot;</span>,   &amp;<a class="code" href="mapgen__functions_8cpp.html#a6e34d4074d63b3fa672567dd4d372fb2">mapgen_river_straight</a> },</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            { <span class="stringliteral">&quot;river_curved&quot;</span>,     &amp;<a class="code" href="mapgen__functions_8cpp.html#abc6c2781c3ff3c218aecbb41400bb59f">mapgen_river_curved</a> },</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="comment">// Old rock behavior, only used around slime pits</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            { <span class="stringliteral">&quot;rock&quot;</span>, &amp;<a class="code" href="mapgen__functions_8cpp.html#ac71e1e72a0d703b77f39f4375450b27a">mapgen_rock_partial</a> },</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            { <span class="stringliteral">&quot;subway_straight&quot;</span>,    &amp;<a class="code" href="mapgen__functions_8cpp.html#adb62dfd957ef2cc7dca9e1d74facc88a">mapgen_subway</a> },</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            { <span class="stringliteral">&quot;subway_curved&quot;</span>,      &amp;<a class="code" href="mapgen__functions_8cpp.html#adb62dfd957ef2cc7dca9e1d74facc88a">mapgen_subway</a> },</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="comment">// TODO: Add a dedicated dead-end function. For now it copies the straight section above.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            { <span class="stringliteral">&quot;subway_end&quot;</span>,         &amp;<a class="code" href="mapgen__functions_8cpp.html#adb62dfd957ef2cc7dca9e1d74facc88a">mapgen_subway</a> },</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            { <span class="stringliteral">&quot;subway_tee&quot;</span>,         &amp;<a class="code" href="mapgen__functions_8cpp.html#adb62dfd957ef2cc7dca9e1d74facc88a">mapgen_subway</a> },</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            { <span class="stringliteral">&quot;subway_four_way&quot;</span>,    &amp;<a class="code" href="mapgen__functions_8cpp.html#adb62dfd957ef2cc7dca9e1d74facc88a">mapgen_subway</a> },</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            { <span class="stringliteral">&quot;lake_shore&quot;</span>, &amp;<a class="code" href="mapgen__functions_8cpp.html#a9f58f1cefca5a7566b20e27d4e84fdb1">mapgen_lake_shore</a> },</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            { <span class="stringliteral">&quot;ocean_shore&quot;</span>, &amp;<a class="code" href="mapgen__functions_8cpp.html#a77592a40715f66ad7064925d5ec46cec">mapgen_ocean_shore</a> },</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            { <span class="stringliteral">&quot;ravine_edge&quot;</span>, &amp;<a class="code" href="mapgen__functions_8cpp.html#a2ef253441ce417e2f2c708fdfa47ccb5">mapgen_ravine_edge</a> },</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    };</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> iter = pointers.find( ident );</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">return</span> iter == pointers.end() ? nullptr : iter-&gt;second;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="ttc" id="amapgen__functions_8cpp_html_a2ef253441ce417e2f2c708fdfa47ccb5"><div class="ttname"><a href="mapgen__functions_8cpp.html#a2ef253441ce417e2f2c708fdfa47ccb5">mapgen_ravine_edge</a></div><div class="ttdeci">void mapgen_ravine_edge(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l02070">mapgen_functions.cpp:2070</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a6e34d4074d63b3fa672567dd4d372fb2"><div class="ttname"><a href="mapgen__functions_8cpp.html#a6e34d4074d63b3fa672567dd4d372fb2">mapgen_river_straight</a></div><div class="ttdeci">void mapgen_river_straight(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00600">mapgen_functions.cpp:600</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a77592a40715f66ad7064925d5ec46cec"><div class="ttname"><a href="mapgen__functions_8cpp.html#a77592a40715f66ad7064925d5ec46cec">mapgen_ocean_shore</a></div><div class="ttdeci">void mapgen_ocean_shore(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l01604">mapgen_functions.cpp:1604</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a87774fae3295ac0f5b165215dee6bfdd"><div class="ttname"><a href="mapgen__functions_8cpp.html#a87774fae3295ac0f5b165215dee6bfdd">mapgen_river_curved_not</a></div><div class="ttdeci">void mapgen_river_curved_not(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00566">mapgen_functions.cpp:566</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a9f58f1cefca5a7566b20e27d4e84fdb1"><div class="ttname"><a href="mapgen__functions_8cpp.html#a9f58f1cefca5a7566b20e27d4e84fdb1">mapgen_lake_shore</a></div><div class="ttdeci">void mapgen_lake_shore(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l01142">mapgen_functions.cpp:1142</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_abc6c2781c3ff3c218aecbb41400bb59f"><div class="ttname"><a href="mapgen__functions_8cpp.html#abc6c2781c3ff3c218aecbb41400bb59f">mapgen_river_curved</a></div><div class="ttdeci">void mapgen_river_curved(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00626">mapgen_functions.cpp:626</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_ac71e1e72a0d703b77f39f4375450b27a"><div class="ttname"><a href="mapgen__functions_8cpp.html#ac71e1e72a0d703b77f39f4375450b27a">mapgen_rock_partial</a></div><div class="ttdeci">void mapgen_rock_partial(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00661">mapgen_functions.cpp:661</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_acb4c2c9ab474f9f0076b44b63b279702"><div class="ttname"><a href="mapgen__functions_8cpp.html#acb4c2c9ab474f9f0076b44b63b279702">mapgen_forest</a></div><div class="ttdeci">void mapgen_forest(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00683">mapgen_functions.cpp:683</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_adb62dfd957ef2cc7dca9e1d74facc88a"><div class="ttname"><a href="mapgen__functions_8cpp.html#adb62dfd957ef2cc7dca9e1d74facc88a">mapgen_subway</a></div><div class="ttdeci">void mapgen_subway(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00197">mapgen_functions.cpp:197</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_afa918dabddaa2fcbb36f06bf1a8fecd2"><div class="ttname"><a href="mapgen__functions_8cpp.html#afa918dabddaa2fcbb36f06bf1a8fecd2">mapgen_river_center</a></div><div class="ttdeci">void mapgen_river_center(mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00561">mapgen_functions.cpp:561</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen__functions_8cpp_source.html#l00683">mapgen_forest()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l01142">mapgen_lake_shore()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l01604">mapgen_ocean_shore()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l02070">mapgen_ravine_edge()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00561">mapgen_river_center()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00626">mapgen_river_curved()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00566">mapgen_river_curved_not()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00600">mapgen_river_straight()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00661">mapgen_rock_partial()</a>, and <a class="el" href="mapgen__functions_8cpp_source.html#l00197">mapgen_subway()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l00650">load_mapgen_function()</a>, and <a class="el" href="mapgen_8cpp_source.html#l08060">register_mapgen_function()</a>.</p>

</div>
</div>
<a id="a95520fe8c1789811c051e5ff7458e468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95520fe8c1789811c051e5ff7458e468">&#9670;&nbsp;</a></span>grass_or_dirt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="map__memory_8h.html#a35072a9fdd9a8d25da4e647a63d1c445">ter_str_id</a> grass_or_dirt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00138">138</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 4 ) ) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="mapgen__functions_8cpp.html#afa18c8c17b0b33f364c72c636824686f">ter_t_grass</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mapgen__functions_8cpp.html#a39faa1c7d3f986d7dd89f347f4e2f43f">ter_t_dirt</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div>
<div class="ttc" id="amapgen__functions_8cpp_html_a39faa1c7d3f986d7dd89f347f4e2f43f"><div class="ttname"><a href="mapgen__functions_8cpp.html#a39faa1c7d3f986d7dd89f347f4e2f43f">ter_t_dirt</a></div><div class="ttdeci">static const ter_str_id ter_t_dirt(&quot;t_dirt&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_afa18c8c17b0b33f364c72c636824686f"><div class="ttname"><a href="mapgen__functions_8cpp.html#afa18c8c17b0b33f364c72c636824686f">ter_t_grass</a></div><div class="ttdeci">static const ter_str_id ter_t_grass(&quot;t_grass&quot;)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="rng_8cpp_source.html#l00108">one_in()</a>, <a class="el" href="mapgen__functions_8cpp.html#a39faa1c7d3f986d7dd89f347f4e2f43f">ter_t_dirt</a>, and <a class="el" href="mapgen__functions_8cpp.html#afa18c8c17b0b33f364c72c636824686f">ter_t_grass</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00626">mapgen_river_curved()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00566">mapgen_river_curved_not()</a>, and <a class="el" href="mapgen__functions_8cpp_source.html#l00600">mapgen_river_straight()</a>.</p>

</div>
</div>
<a id="a4fd29a805402de80c27818c66a6f696b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fd29a805402de80c27818c66a6f696b">&#9670;&nbsp;</a></span>madd_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void madd_field </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmap.html">map</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpoint.html">point</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type__id_8h.html#a2a56520b7eef7294fc98230cb883c9d2">field_type_id</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>intensity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l02197">2197</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;{</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> actual_location( p, m-&gt;<a class="code" href="classmap.html#ab2a7030c1e990957e11ae52b58ad7056">get_abs_sub</a>().<a class="code" href="classcoords_1_1coord__point__mut.html#aa94b8bd33e85ce94a3634e6e27ab0cdd">z</a>() );</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    m-&gt;<a class="code" href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">add_field</a>( actual_location, type, <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a>, 0_turns );</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;}</div>
<div class="ttc" id="aclassmap_html_a32a9de57ddea3145ca42e6acfde7f3d6"><div class="ttname"><a href="classmap.html#a32a9de57ddea3145ca42e6acfde7f3d6">map::add_field</a></div><div class="ttdeci">bool add_field(const tripoint &amp;p, const field_type_id &amp;type_id, int intensity=INT_MAX, const time_duration &amp;age=0_turns, bool hit_player=true)</div><div class="ttdoc">Add field entry at point, or set intensity if present.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06563">map.cpp:6563</a></div></div>
<div class="ttc" id="aclassmap_html_ab2a7030c1e990957e11ae52b58ad7056"><div class="ttname"><a href="classmap.html#ab2a7030c1e990957e11ae52b58ad7056">map::get_abs_sub</a></div><div class="ttdeci">tripoint_abs_sm get_abs_sub() const</div><div class="ttdoc">return abs_sub</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09663">map.cpp:9663</a></div></div>
<div class="ttc" id="acreature_8h_html_a299ec0c42ccc5a2d79d1739428ac3210"><div class="ttname"><a href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a></div><div class="ttdeci">int intensity</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00240">creature.h:240</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="map_8cpp_source.html#l06563">map::add_field()</a>, <a class="el" href="map_8cpp_source.html#l09663">map::get_abs_sub()</a>, <a class="el" href="creature_8h_source.html#l00240">intensity</a>, <a class="el" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a599dcce2998a6b40b1e38e8c6006cb0a">type</a>, and <a class="el" href="coordinates_8h_source.html#l00167">coords::coord_point_mut&lt; Point, Subpoint, InBounds &gt;::z()</a>.</p>

</div>
</div>
<a id="acb4c2c9ab474f9f0076b44b63b279702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb4c2c9ab474f9f0076b44b63b279702">&#9670;&nbsp;</a></span>mapgen_forest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_forest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines the density of natural features in <code>ot</code>.</p>
<p>If there is no defind biome for <code>ot</code>, returns a sparsity factor of 0. It's possible to specify biomes in the forest regional settings that are not rendered by this forest map gen method, in order to control how terrains are blended together (e.g. specify roads with an equal biome to forests so that forests don't fade out as they transition to roads).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ot</td><td>The type of terrain to determine the sparseness of. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A discrete scale of the density of natural features occurring in <code>ot</code>.</dd></dl>
<p>Modifies border weights to conform to biome conditions along corners.</p>
<p>Ensures that adjacent forest_mapgen() dependent terrains do not generate outcroppings into continuous biomes that they are mutually adjacent to, focusing on details provided for a corner of the map.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ccw</td><td>The forest biome counter-clockwise of the evaluated corner. </td></tr>
    <tr><td class="paramname">corner</td><td>The forest biome in the evaluated corner (i.e. NW, NE, SW, or SE). </td></tr>
    <tr><td class="paramname">cw</td><td>The forest biome clockwise of the evaluated corner. </td></tr>
    <tr><td class="paramname">ccw_weight</td><td>The relative impact of the counterclockwise biome on generation. </td></tr>
    <tr><td class="paramname">cw_weight</td><td>The relative impact of the clockwise biome on generation. </td></tr>
    <tr><td class="paramname">self_weight</td><td>The relative impact of the original biome on generation.</td></tr>
  </table>
  </dd>
</dl>
<p>Prevents the generation of outcroppings from biomes across contiguous adjacencies.</p>
<p>Ensures that adjacent forest_mapgen() dependent terrains do not generate outcroppings into continuous biomes that they are mutually adjacent to, checking weights in each corner.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cardinal_four_weights</td><td>The relative impacts of the cardinally adjacent biomes on generation. </td></tr>
    <tr><td class="paramname">p</td><td>the point in the terrain being weighted from the cardinally adjacent biomes.</td></tr>
  </table>
  </dd>
</dl>
<p>Calculates a weighted proximity of a point to the perimeter in each cardinal direction.</p>
<p>Format is that defined in dir(), i.e. clockwise starting from north.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The point to evaluate the weights of adjacent directions on. </td></tr>
    <tr><td class="paramname">scaling_factor</td><td>The scaling factor to apply to the weights. </td></tr>
    <tr><td class="paramname">weights</td><td>A 4 element array of floats to store the output in, dat.dir() order. </td></tr>
    <tr><td class="paramname">root_depth_offset</td><td>an offset to apply to the already-generated perimeter_depth </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The sum of all of the weights written to <code>weights</code>.</dd></dl>
<p>Determines the groundcover that should be placed at a furniture-less point in a forest.</p>
<p>Similar to the get_feathered_feature lambda with a different weighting algorithm, which favors the biome of this terrain over that of adjacent ones by fixed margin. Only selects groundcover, rather than biome-appropriate furniture.</p>
<dl class="section return"><dt>Returns</dt><dd>The groundcover to be placed at the specified point in the forest.</dd></dl>
<p>Determines the feature that should be placed at a point in the forest.</p>
<p>Determines the position of <code>p</code> relative to the calculated perimeter, and from this picks an item from a weighted feature pool in the involved biomes. In the case of corners,</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>the point to check to place a feature at.</td></tr>
  </table>
  </dd>
</dl>
<p>Attempt, randomly, to place a terrain dependent furniture.</p>
<p>For example, f_cattails on t_water_sh. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tid</td><td>The terrain to place a dependent feature on. </td></tr>
    <tr><td class="paramname">p</td><td>The point to place the dependent feature, if one is selected.</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00683">683</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;{</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="classmap.html">map</a> *<span class="keyword">const</span> m = &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">// perimeter_size is a useful shorthand that should not be changed:</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> perimeter_size = <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 4 + <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 4;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="comment">// The following constexpr terms would do well to be json-ized.</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// The average mid-way point between the forest and its adjacent biomes:</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> average_depth = 5 * <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> / 12;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// The average number of complete oscillations which should occur in the biome border per map-tile:</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> average_extra_critical_points = 1;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// The intensity of the oscillations along forest borders:</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> biome_transition_abruptness = 1;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// The standard deviation of the lengthwise distribution of the oscillations:</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> border_deviation = 3;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">// Higher values = more pronounced curves, obscures seams:</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">float</span> border_curviness = 2;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">// The standard deviation of the depthwise distribution of the oscillations&#39; peaks:</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">float</span> depth_deviation = 1;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">// Scalar for the amount of space to add between the groundcover and feature margins:</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> groundcover_margin = average_depth / 2;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// Scaling factor to apply to the weighting of the self-terrain over adjacent ones:</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">float</span> self_scalar = 3.;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">// Adjacency factor is used to weight the frequency of a feature</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// being placed by the relative density of the current terrain to its</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">// neighbors. For example, a forest_thick surrounded by forest_thick on</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// all sides can be much more dense than a forest_water surrounded by</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">// fields on all sides.</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">// &quot;Sparsity Factor&quot; is a misnomer carried over from JSON; the value reflects</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">// the density of the terrain, not the sparsity.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">    * Determines the density of natural features in \p ot.</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">    * If there is no defind biome for \p ot, returns a sparsity factor</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">    * of 0. It&#39;s possible to specify biomes in the forest regional settings</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">    * that are not rendered by this forest map gen method, in order to control</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">    * how terrains are blended together (e.g. specify roads with an equal</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">    * biome to forests so that forests don&#39;t fade out as they transition to roads).</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">    * @param ot The type of terrain to determine the sparseness of.</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">    * @return A discrete scale of the density of natural features occurring in \p ot.</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> get_sparseness_adjacency_factor = [&amp;dat]( <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> &amp; ot ) {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> biome = dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">forest_composition</a>.<a class="code" href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">biomes</a>.find( ot-&gt;get_type_id() );</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">if</span>( biome == dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">forest_composition</a>.<a class="code" href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">biomes</a>.end() ) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">return</span> biome-&gt;second.sparseness_adjacency_factor;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    };</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keyword">const</span> <a class="code" href="structter__furn__id.html">ter_furn_id</a> no_ter_furn = <a class="code" href="structter__furn__id.html">ter_furn_id</a>();</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">// Calculate the maximum possible sparseness factor (density) for the region.</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordtype">int</span> max_factor = 0;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span>( !dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">forest_composition</a>.<a class="code" href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">biomes</a>.empty() ) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        std::vector&lt;int&gt; factors;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        factors.reserve( dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">forest_composition</a>.<a class="code" href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">biomes</a>.size() );</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> : dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">forest_composition</a>.<a class="code" href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">biomes</a> ) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            factors.push_back( <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a>.second.sparseness_adjacency_factor );</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        max_factor = *max_element( std::begin( factors ), <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">std::end</a>( factors ) );</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// Get the sparseness factor (density) for this and adjacent terrain.</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> factor = get_sparseness_adjacency_factor( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() );</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 4; i++ ) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        dat.<a class="code" href="classmapgendata.html#a144323497893ffc2d1279e3c7ff47f64">dir</a>( i ) = get_sparseness_adjacency_factor( dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a>[i] );</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// The index of the following structures are defined in dat.dir():</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">// (0,0)     NORTH</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">//      ---------------</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">//      | 7  | 0 | 4  |</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="comment">//      |----|---|----|</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">// WEST | 3  |   | 1  |  EAST</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="comment">//      |----|---|----|</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">//      | 6  | 2 | 5  |</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">//      ---------------</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">//           SOUTH      (SEEX * 2, SEEY * 2)</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// In order to feather (blend) this overmap tile with adjacent ones, the general composition thereof must be known.</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// This can be calculated once from dat.t_nesw, and stored here:</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    std::array&lt;const forest_biome *, 8&gt; adjacent_biomes;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> d = 0; d &lt;= 7; d++ ) {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keyword">auto</span> lookup = dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">forest_composition</a>.<a class="code" href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">biomes</a>.find( dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a>[d]-&gt;get_type_id() );</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">if</span>( lookup != dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">forest_composition</a>.<a class="code" href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">biomes</a>.end() ) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            adjacent_biomes[d] = &amp;( lookup-&gt;second );</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            adjacent_biomes[d] = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// Keep track of the &quot;true perimeter&quot; of the biome. It has a curve to make it seem natural.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">// The depth of the perimeter at each border of the forest being generated:</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    std::array&lt;int, 8&gt; border_depth;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> bd_x = 0; bd_x &lt; 2; bd_x++ ) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> bd_y = 0; bd_y &lt; 2; bd_y++ ) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="comment">// Use the corners of the overmap tiles as hash seeds.</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <a class="code" href="structpoint.html">point</a> global_corner = m-&gt;<a class="code" href="classmap.html#a501f3a1d449ac022f1b36b99da653e94">getabs</a>( <a class="code" href="structpoint.html">point</a>( bd_x * <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2, bd_y * <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 ) );</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            uint32_t net_hash = std::hash&lt;uint32_t&gt; {}( global_corner.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> ) ^ ( std::hash&lt;int&gt; {}( global_corner.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> )</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                &lt;&lt; 1 );</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            uint32_t h_hash = net_hash;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            uint32_t v_hash = std::hash&lt;uint32_t&gt; {}( net_hash );</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="keywordtype">float</span> h_unit_hash = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( h_hash ) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( UINT32_MAX );</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordtype">float</span> v_unit_hash = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( v_hash ) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( UINT32_MAX );</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="comment">// Apply the box-muller transform to produce a gaussian distribution with the desired mean and deviation.</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keywordtype">float</span> mag = depth_deviation * <a class="code" href="math__parser__func_8h.html#aeb3bbc4ec861ea58cbfca028920e4cc6">std::sqrt</a>( -2. * <a class="code" href="math__parser__func_8h.html#a6a96e281ee5bf1967d26afebe837ad48">log</a>( h_unit_hash ) );</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <span class="keywordtype">int</span> h_norm_transform = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( mag * <a class="code" href="math__parser__func_8h.html#aa178d72bf03c69677934a8c977f3b850">std::cos</a>(</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                                       2 * <a class="code" href="math__defines_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * v_unit_hash ) + average_depth ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( INT32_MIN ),</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                   <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( INT32_MAX ) ) );</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keywordtype">int</span> v_norm_transform = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( mag * <a class="code" href="math__parser__func_8h.html#a3d9f495ca19a6110e624fc1d0ed3da74">std::sin</a>(</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                       2 * <a class="code" href="math__defines_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * v_unit_hash ) + average_depth ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( INT32_MIN ),</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                                   <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( INT32_MAX ) ) );</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <span class="keywordtype">int</span> corner_index = bd_x ? 1 + bd_y : 3 * bd_y; <span class="comment">// Counterclockwise labeling.</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            border_depth[corner_index] = <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( h_norm_transform );</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            border_depth[corner_index + 4] = <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( v_norm_transform );</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">// Indicies of border_depth accessible by dat.dir() nomenclature, [h_idx 0..4 : v_idx 0..4]:</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keyword">static</span> constexpr std::array&lt;int, 8&gt; edge_corner_mappings = {0, 5, 3, 4, 1, 6, 2, 7};</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">// Now, generate a curve along the border of the biome, which will be used to calculate each cardinally</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">// adjacent biome&#39;s relative impact.</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">// Format: [ SEEX * 2 (North) : SEEY * 2 (East) : SEEX * 2 (South) : SEEX * 2 (West) ] (order from dat.dir())</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    std::array&lt;int, perimeter_size&gt; perimeter_depth;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a> = 0; <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a> &lt; 4; <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>++ ) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordtype">int</span> perimeter_depth_offset = ( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 ) * ( ( <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a> + 1 ) / 2 ) + ( <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 ) * ( <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a> / 2 );</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordtype">int</span> edge_length = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a> % 2 == 0 ? <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 : <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordtype">int</span> interediary_crit_point_count = <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="rng_8cpp.html#a074df23c91b5843596dcb25fd9a9d4dc">rng_normal</a>( 0, average_extra_critical_points * 2 ) );</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordtype">int</span> *critical_point_displacements = <span class="keyword">new</span> <span class="keywordtype">int</span>[interediary_crit_point_count + 2];</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keywordtype">int</span> *critical_point_depths = <span class="keyword">new</span> <span class="keywordtype">int</span>[interediary_crit_point_count + 2];</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        critical_point_displacements[0] = 0;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        critical_point_displacements[interediary_crit_point_count + 1] =</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            edge_length; <span class="comment">// first coordinate of next overmap location</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        critical_point_depths[0] = border_depth[edge_corner_mappings[<a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>]];</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        critical_point_depths[interediary_crit_point_count + 1] = border_depth[edge_corner_mappings[<a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a> +</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                4]];</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="comment">// Generate critical points in-order displacement-wise.</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> ci = 1; ci &lt; interediary_crit_point_count + 1; ci++ ) {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            critical_point_displacements[ci] = clamp&lt;int&gt;( <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="rng_8cpp.html#a3a6a7e6245951426223e02f989bdd6a4">normal_roll</a>(</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                                                   <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                                           edge_length * ( ci - 1 ) ) / ( interediary_crit_point_count + 2 ), border_deviation ) ) ) ), 1,</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                                               edge_length - 2 );</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            critical_point_depths[ci] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">abs</a>( <a class="code" href="rng_8cpp.html#a3a6a7e6245951426223e02f989bdd6a4">normal_roll</a>( average_depth,</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                                        depth_deviation ) ) ) );</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="comment">// Ensure order by swapping:</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keywordflow">if</span>( critical_point_displacements[ci] &lt; critical_point_displacements[ci - 1] ) {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <span class="keywordtype">int</span> buffer = critical_point_displacements[ci];</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                critical_point_displacements[ci] = critical_point_displacements[ci - 1];</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                critical_point_displacements[ci - 1] = buffer;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="comment">// By only considering the left and right two points, transitioning the curve across map borders becomes unnoticable.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordtype">int</span> ubidx = 1; <span class="comment">// Upper bound index</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> step = 0; step &lt; edge_length; step++ ) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="keywordflow">while</span>( step &gt; critical_point_displacements[ubidx] ) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <span class="keywordflow">if</span>( ++ubidx &gt; interediary_crit_point_count + 1 ) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    <span class="comment">// Should never happen, but good future proofing.</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                    ubidx = interediary_crit_point_count + 1;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordtype">float</span> w_left = std::pow( <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( critical_point_displacements[ubidx - 1] - step ) + 1,</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                     -border_curviness );</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <span class="keywordtype">float</span> w_right = std::pow( <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( critical_point_displacements[ubidx] - step ) + 1,</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                      -border_curviness );</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            perimeter_depth[perimeter_depth_offset + step] = <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">std::round</a>( ( w_left * critical_point_depths[ubidx</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                    - 1]</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                    + w_right * critical_point_depths[ubidx] ) / ( w_left + w_right ) );</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordflow">if</span>( perimeter_depth[perimeter_depth_offset + step] &lt; 1 ) {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                perimeter_depth[perimeter_depth_offset + step] =</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    1;    <span class="comment">// Clamp depth to within the overmap tile. Makes math pretty.</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keyword">delete</span>[] critical_point_displacements;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keyword">delete</span>[] critical_point_depths;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// Get the current biome definition for this terrain.</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> current_biome_def_it = dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">forest_composition</a>.<a class="code" href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">biomes</a>.find(</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                          dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>()-&gt;<a class="code" href="structoter__t.html#ab1638475c8650985ec100f0bc7fcafe7">get_type_id</a>() );</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">// If there is no biome definition for this terrain, fill in with the region&#39;s default ground cover</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">// and bail--nothing more to be done. Should not continue with terrain feathering if there is</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="comment">// nothing to feather into. Generally, this should never happen.</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">if</span>( current_biome_def_it == dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">forest_composition</a>.<a class="code" href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">biomes</a>.end() ) {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        dat.<a class="code" href="classmapgendata.html#a6f10a37ad3dfd21c36ce4526ee7d4054">fill_groundcover</a>();</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="structforest__biome.html">forest_biome</a> self_biome = current_biome_def_it-&gt;second;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">    * Modifies border weights to conform to biome conditions along corners.</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">    * Ensures that adjacent forest_mapgen() dependent terrains do not generate outcroppings into</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">    * continuous biomes that they are mutually adjacent to, focusing on details provided for a</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">    * corner of the map.</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">    * @param ccw The forest biome counter-clockwise of the evaluated corner.</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">    * @param corner The forest biome in the evaluated corner (i.e. NW, NE, SW, or SE).</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">    * @param cw The forest biome clockwise of the evaluated corner.</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">    * @param ccw_weight The relative impact of the counterclockwise biome on generation.</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">    * @param cw_weight The relative impact of the clockwise biome on generation.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">    * @param self_weight The relative impact of the original biome on generation.</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> unify_continuous_border = [&amp;self_biome]( <span class="keyword">const</span> <a class="code" href="structforest__biome.html">forest_biome</a> * ccw,</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="structforest__biome.html">forest_biome</a> * <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>, <span class="keyword">const</span> <a class="code" href="structforest__biome.html">forest_biome</a> * cw, <span class="keywordtype">float</span> * ccw_weight, <span class="keywordtype">float</span> * cw_weight,</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordtype">float</span> * self_weight ) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">if</span>( ccw != cw ) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">if</span>( ccw == <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a> &amp;&amp; cw == &amp;self_biome ) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                *cw_weight = *cw_weight / ( *self_weight + *cw_weight );</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                *self_weight = *self_weight - *cw_weight;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( cw == <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a> &amp;&amp; ccw == &amp;self_biome ) {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                *ccw_weight = *ccw_weight / ( *self_weight + *ccw_weight );</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                *self_weight = *self_weight - *cw_weight;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            }</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    };</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">    * Prevents the generation of outcroppings from biomes across contiguous adjacencies.</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">    * Ensures that adjacent forest_mapgen() dependent terrains do not generate outcroppings into</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">    * continuous biomes that they are mutually adjacent to, checking weights in each corner.</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">    * @param cardinal_four_weights The relative impacts of the cardinally adjacent biomes on generation.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">    * @param p the point in the terrain being weighted from the cardinally adjacent biomes.</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> unify_all_borders = [&amp;unify_continuous_border,</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                    &amp;adjacent_biomes]( std::array&lt;float, 4&gt; &amp;cardinal_four_weights, <span class="keywordtype">float</span> * self_weight,</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; p ) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="comment">// Refer to dat.dir() convention.</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordflow">if</span>( p.x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> ) {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <span class="keywordflow">if</span>( p.y &lt; <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> ) {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                unify_continuous_border( adjacent_biomes[3], adjacent_biomes[7], adjacent_biomes[0],</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                         <span class="comment">// NOLINTNEXTLINE(readability-container-data-pointer)</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                                         &amp;cardinal_four_weights[3], &amp;cardinal_four_weights[0], self_weight );</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="comment">// NOLINTNEXTLINE(readability-container-data-pointer)</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                unify_continuous_border( adjacent_biomes[0], adjacent_biomes[4], adjacent_biomes[1],</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                         &amp;cardinal_four_weights[0], &amp;cardinal_four_weights[1], self_weight );</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <span class="keywordflow">if</span>( p.y &lt; <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> ) {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                unify_continuous_border( adjacent_biomes[1], adjacent_biomes[5], adjacent_biomes[2],</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                                         &amp;cardinal_four_weights[1], &amp;cardinal_four_weights[2], self_weight );</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                unify_continuous_border( adjacent_biomes[2], adjacent_biomes[6], adjacent_biomes[3],</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                                         &amp;cardinal_four_weights[2], &amp;cardinal_four_weights[3], self_weight );</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    };</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">    * Calculates a weighted proximity of a point to the perimeter in each cardinal direction.</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">    * Format is that defined in dir(), i.e. clockwise starting from north.</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">    * @param p The point to evaluate the weights of adjacent directions on.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">    * @param scaling_factor The scaling factor to apply to the weights.</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">    * @param weights A 4 element array of floats to store the output in, dat.dir() order.</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">    * @param root_depth_offset an offset to apply to the already-generated perimeter_depth</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">    * @return The sum of all of the weights written to \p weights.</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> nesw_weights = [&amp;perimeter_depth, &amp;adjacent_biomes]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; p,</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordtype">float</span> scaling_factor, std::array&lt;float, 4&gt; &amp;weights, <span class="keywordtype">float</span> root_depth_offset = 0. ) {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keywordtype">float</span> net_weight = 0.;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        std::array&lt;float, 4&gt; perimeter_depths;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        std::array&lt;int, 4&gt; point_depths;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        point_depths[0] = p.y;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        point_depths[1] = <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - p.x - 1;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        point_depths[2] = <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - p.y - 1;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        point_depths[3] = p.x;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        perimeter_depths[0] = std::max&lt;int&gt;( perimeter_depth[p.x] + root_depth_offset, 1 );</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        perimeter_depths[1] = std::max&lt;int&gt;( perimeter_depth[<a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 + p.y] + root_depth_offset, 1 );</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        perimeter_depths[2] = std::max&lt;int&gt;( perimeter_depth[<a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 + <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 + p.x] + root_depth_offset,</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                                             1 );</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        perimeter_depths[3] = std::max&lt;int&gt;( perimeter_depth[<a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 4 + <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 + p.y] + root_depth_offset,</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                             1 );</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> wi = 0; wi &lt; 4; wi++ ) {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <span class="keywordflow">if</span>( adjacent_biomes[wi] == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                <span class="comment">// Biome-less terrain does not feather on its side, but biome-owning terrain is presumed to.</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="comment">// In order to account for this, the border of the map generation function must be determined</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="comment">// to correspond either to the half-way point between biomes or the end-point of the transition.</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                weights[wi] = std::pow( <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( perimeter_depths[wi] ) / ( point_depths[wi] + 1 ),</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                                        biome_transition_abruptness ) * scaling_factor;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                net_weight += weights[wi];</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                weights[wi] = std::pow( <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>( perimeter_depths[wi] ) / ( point_depths[wi] + 1 ),</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                        biome_transition_abruptness ) * scaling_factor / std::pow( <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                                ( perimeter_depths[wi] ),</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                                biome_transition_abruptness );</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                net_weight += weights[wi];</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">return</span> net_weight;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    };</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">    * Determines the groundcover that should be placed at a furniture-less point in a forest.</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">    * Similar to the get_feathered_feature lambda with a different weighting algorithm,</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">    * which favors the biome of this terrain over that of adjacent ones by fixed margin.</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">    * Only selects groundcover, rather than biome-appropriate furniture.</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">    * @return The groundcover to be placed at the specified point in the forest.</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> get_feathered_groundcover = [&amp;max_factor, &amp;factor, &amp;self_biome,</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                 &amp;adjacent_biomes, &amp;nesw_weights, &amp;unify_all_borders, &amp;dat]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; p ) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        std::array&lt;float, 4&gt; adj_weights;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keywordtype">float</span> net_weight = nesw_weights( p, factor, adj_weights, -groundcover_margin );</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordtype">float</span> self_weight = self_scalar;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        unify_all_borders( adj_weights, &amp;self_weight, p );</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> no_dir = -1;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> empty = -2;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <a class="code" href="structweighted__float__list.html">weighted_float_list&lt;const int&gt;</a> direction_pool;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( 0, adj_weights[0] );</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( 1, adj_weights[1] );</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( 2, adj_weights[2] );</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( 3, adj_weights[3] );</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( no_dir, self_weight );</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( empty, ( net_weight + self_weight ) * max_factor -</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                            ( adj_weights[0] * dat.<a class="code" href="classmapgendata.html#ae0820543796bc3c1db0bd582cc2d5743">n_fac</a> + adj_weights[1] * dat.<a class="code" href="classmapgendata.html#a17b51f75810c137564192069a2926e86">e_fac</a> + adj_weights[2] * dat.<a class="code" href="classmapgendata.html#a92f91552ebe7d57b72249428b168afdc">s_fac</a> +</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                              adj_weights[3] * dat.<a class="code" href="classmapgendata.html#a16e876c44700029fc57964f06faed843">w_fac</a> + self_weight * factor ) );</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> feather_selection = *direction_pool.<a class="code" href="structweighted__list.html#aa2eb002d2ec795a0aab91178a93d05ba">pick</a>();</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">switch</span>( feather_selection ) {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordflow">case</span> no_dir:</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                <span class="keywordflow">return</span> *self_biome.groundcover.pick();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            <span class="keywordflow">case</span> empty:</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                <span class="keywordflow">return</span> *dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a71bd1cf5d47797847624483f5bb20263">default_groundcover</a>.pick();</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                <span class="keywordflow">if</span>( adjacent_biomes[feather_selection] != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classint__id.html">ter_id</a> *cover = adjacent_biomes[feather_selection]-&gt;groundcover.pick();</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                    <span class="keywordflow">if</span>( cover ) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        <span class="keywordflow">return</span> *cover;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                    }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                    <span class="comment">// Adjacent biome has no groundcover, use the region default.</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                    <span class="keywordflow">return</span> *dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a71bd1cf5d47797847624483f5bb20263">default_groundcover</a>.pick();</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                    <span class="keywordflow">return</span> *dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a71bd1cf5d47797847624483f5bb20263">default_groundcover</a>.pick();</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    };</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">    * Determines the feature that should be placed at a point in the forest.</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">    * Determines the position of \p p relative to the calculated perimeter,</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">    * and from this picks an item from a weighted feature pool in the involved</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">    * biomes.</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">    * In the case of corners,</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">    * @param p the point to check to place a feature at.</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> get_feathered_feature = [&amp;no_ter_furn, &amp;max_factor, &amp;factor, &amp;self_biome,</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                                      &amp;adjacent_biomes, &amp;nesw_weights, &amp;get_feathered_groundcover, &amp;unify_all_borders,</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                  &amp;dat]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; p ) {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        std::array&lt;float, 4&gt; adj_weights;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordtype">float</span> net_weight = nesw_weights( p, factor, adj_weights );</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="keywordtype">float</span> self_weight = self_scalar;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        unify_all_borders( adj_weights, &amp;self_weight, p );</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="comment">// Pool together all of the biomes which the target point might constitute.</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <a class="code" href="structweighted__float__list.html">weighted_float_list&lt;const int&gt;</a></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        direction_pool; <span class="comment">// Style guidelines say use int, but it is necessary for this weighting algorithm.</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">// Two special cases: default and sparsity:</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> no_dir = -1;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> empty = -2;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( 0, adj_weights[0] );</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( 1, adj_weights[1] );</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( 2, adj_weights[2] );</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( 3, adj_weights[3] );</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( no_dir, self_weight );</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        direction_pool.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( empty, ( net_weight + self_weight )* max_factor -</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                            ( adj_weights[0] * dat.<a class="code" href="classmapgendata.html#ae0820543796bc3c1db0bd582cc2d5743">n_fac</a> + adj_weights[1] * dat.<a class="code" href="classmapgendata.html#a17b51f75810c137564192069a2926e86">e_fac</a> + adj_weights[2] * dat.<a class="code" href="classmapgendata.html#a92f91552ebe7d57b72249428b168afdc">s_fac</a> +</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                              adj_weights[3] * dat.<a class="code" href="classmapgendata.html#a16e876c44700029fc57964f06faed843">w_fac</a> + self_weight * factor ) );</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="comment">// Pick from the direction pool, and calculate + return the appropriate terrain:</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <a class="code" href="structter__furn__id.html">ter_furn_id</a> <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a>;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> feather_selection = *direction_pool.<a class="code" href="structweighted__list.html#aa2eb002d2ec795a0aab91178a93d05ba">pick</a>();</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="keywordflow">switch</span>( feather_selection ) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            <span class="keywordflow">case</span> no_dir:</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a> = self_biome.pick();</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keywordflow">case</span> empty:</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a> = no_ter_furn;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                <span class="keywordflow">if</span>( adjacent_biomes[feather_selection] != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                    <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a> = adjacent_biomes[feather_selection]-&gt;pick();</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a> = no_ter_furn;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a>.ter == no_ter_furn.<a class="code" href="structter__furn__id.html#a0e4c9b3cbcad5dea11c882c58bf9caaf">ter</a> ) {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a>.ter = get_feathered_groundcover( p );</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    };</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">    * Attempt, randomly, to place a terrain dependent furniture.</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">    * For example, f_cattails on t_water_sh.</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">    * @param tid: The terrain to place a dependent feature on.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">    * @param p: The point to place the dependent feature, if one is selected.</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> set_terrain_dependent_furniture =</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    [&amp;self_biome, &amp;m]( <span class="keyword">const</span> <a class="code" href="classint__id.html">ter_id</a> &amp; tid, <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; p ) {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> terrain_dependent_furniture_it = self_biome.terrain_dependent_furniture.find(</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                    tid );</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">if</span>( terrain_dependent_furniture_it == self_biome.terrain_dependent_furniture.end() ) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <span class="comment">// No terrain dependent furnitures for this terrain.</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="keyword">const</span> <a class="code" href="structforest__biome__terrain__dependent__furniture.html">forest_biome_terrain_dependent_furniture</a> tdf = terrain_dependent_furniture_it-&gt;second;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keywordflow">if</span>( tdf.<a class="code" href="structforest__biome__terrain__dependent__furniture.html#aa264e5b223541bacba4ae29057999d34">furniture</a>.get_weight() &lt;= 0 ) {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <span class="comment">// We&#39;ve got furnitures, but their weight is 0 or less.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( tdf.<a class="code" href="structforest__biome__terrain__dependent__furniture.html#aae3e68ad43c98e9a1d86fdf1b18571c7">chance</a> ) ) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="comment">// Pick a furniture and set it on the map right now.</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="keyword">const</span> <a class="code" href="classint__id.html">furn_id</a> *fid = tdf.<a class="code" href="structforest__biome__terrain__dependent__furniture.html#aa264e5b223541bacba4ae29057999d34">furniture</a>.pick();</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            m-&gt;<a class="code" href="classmap.html#a410a8dcd3e1ee0e87da584bf878d6f83">furn_set</a>( p, *fid );</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    };</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="comment">// For each location within this overmap terrain,</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="comment">// Lay groundcover, place a feature, and place terrain dependent furniture.</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; x++ ) {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> y = 0; y &lt; <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2; y++ ) {</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <span class="keyword">const</span> <a class="code" href="structter__furn__id.html">ter_furn_id</a> <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a> = get_feathered_feature( <a class="code" href="structpoint.html">point</a>( x, y ) );</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="structpoint.html">point</a>( x, y ), <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a>.ter );</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            m-&gt;<a class="code" href="classmap.html#a410a8dcd3e1ee0e87da584bf878d6f83">furn_set</a>( <a class="code" href="structpoint.html">point</a>( x, y ), <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a>.furn );</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            set_terrain_dependent_furniture( <a class="code" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a>.ter, <a class="code" href="structpoint.html">point</a>( x, y ) );</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="comment">// Place items on this terrain as defined in the biome.</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; self_biome.item_spawn_iterations; i++ ) {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        m-&gt;<a class="code" href="classmap.html#ab13252e80a967e4dba887fbbdef9ec64">place_items</a>( self_biome.item_group, self_biome.item_group_chance,</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                        <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>, <a class="code" href="structpoint.html">point</a>( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1, <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - 1 ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>(), <span class="keyword">true</span>, dat.<a class="code" href="classmapgendata.html#ad5592102dc5b5037f6b7b324b3e466fb">when</a>() );</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;}</div>
<div class="ttc" id="acata__utility_8h_html_ad22b4a043b6eb4c2c06f87f83b720b15"><div class="ttname"><a href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a></div><div class="ttdeci">constexpr T clamp(const T &amp;val, const T &amp;min, const T &amp;max)</div><div class="ttdoc">Clamp first argument so that it is no lower than second and no higher than third.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00221">cata_utility.h:221</a></div></div>
<div class="ttc" id="aclassmap_html"><div class="ttname"><a href="classmap.html">map</a></div><div class="ttdoc">Manage and cache data about a part of the map.</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00345">map.h:346</a></div></div>
<div class="ttc" id="aclassmap_html_a410a8dcd3e1ee0e87da584bf878d6f83"><div class="ttname"><a href="classmap.html#a410a8dcd3e1ee0e87da584bf878d6f83">map::furn_set</a></div><div class="ttdeci">bool furn_set(const tripoint &amp;p, const furn_id &amp;new_furniture, bool furn_reset=false, bool avoid_creatures=false)</div><div class="ttdoc">furn_reset should be true if new_furniture is being set to f_null when the player is grab-moving furn...</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01743">map.cpp:1743</a></div></div>
<div class="ttc" id="aclassmap_html_a501f3a1d449ac022f1b36b99da653e94"><div class="ttname"><a href="classmap.html#a501f3a1d449ac022f1b36b99da653e94">map::getabs</a></div><div class="ttdeci">tripoint getabs(const tripoint &amp;p) const</div><div class="ttdoc">Translates local (to this map) coordinates of a square to global absolute coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09614">map.cpp:9614</a></div></div>
<div class="ttc" id="aclassmap_html_a59bdb65280e5e1461469b0e1275c402e"><div class="ttname"><a href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">map::ter_set</a></div><div class="ttdeci">bool ter_set(const tripoint &amp;p, const ter_id &amp;new_terrain, bool avoid_creatures=false)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02226">map.cpp:2226</a></div></div>
<div class="ttc" id="aclassmap_html_ab13252e80a967e4dba887fbbdef9ec64"><div class="ttname"><a href="classmap.html#ab13252e80a967e4dba887fbbdef9ec64">map::place_items</a></div><div class="ttdeci">std::vector&lt; item * &gt; place_items(const item_group_id &amp;group_id, int chance, const tripoint &amp;p1, const tripoint &amp;p2, bool ongrass, const time_point &amp;turn, int magazine=0, int ammo=0, const std::string &amp;faction=&quot;&quot;)</div><div class="ttdoc">Place items from item group in the rectangle f - t.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l06558">mapgen.cpp:6558</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a144323497893ffc2d1279e3c7ff47f64"><div class="ttname"><a href="classmapgendata.html#a144323497893ffc2d1279e3c7ff47f64">mapgendata::dir</a></div><div class="ttdeci">int &amp; dir(int dir_in)</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8cpp_source.html#l00195">mapgendata.cpp:195</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a16e876c44700029fc57964f06faed843"><div class="ttname"><a href="classmapgendata.html#a16e876c44700029fc57964f06faed843">mapgendata::w_fac</a></div><div class="ttdeci">int w_fac</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00119">mapgendata.h:119</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a17b51f75810c137564192069a2926e86"><div class="ttname"><a href="classmapgendata.html#a17b51f75810c137564192069a2926e86">mapgendata::e_fac</a></div><div class="ttdeci">int e_fac</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00117">mapgendata.h:117</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a3564d6b7611cb87409b7c64c01b7a97d"><div class="ttname"><a href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">mapgendata::t_nesw</a></div><div class="ttdeci">std::array&lt; oter_id, 8 &gt; t_nesw</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00114">mapgendata.h:114</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a64e9d6458060cfff6881553dcfb68bf5"><div class="ttname"><a href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">mapgendata::terrain_type</a></div><div class="ttdeci">const oter_id &amp; terrain_type() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00172">mapgendata.h:172</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a6f10a37ad3dfd21c36ce4526ee7d4054"><div class="ttname"><a href="classmapgendata.html#a6f10a37ad3dfd21c36ce4526ee7d4054">mapgendata::fill_groundcover</a></div><div class="ttdeci">void fill_groundcover() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8cpp_source.html#l00226">mapgendata.cpp:226</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a72a8a7458a69c04a9f80e980713ccd5e"><div class="ttname"><a href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">mapgendata::region</a></div><div class="ttdeci">const regional_settings &amp; region</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00130">mapgendata.h:130</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a7d9e28b073b22b2391e6d3972fd6aa12"><div class="ttname"><a href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">mapgendata::m</a></div><div class="ttdeci">map &amp; m</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00132">mapgendata.h:132</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a8b23644fccfcc73e7f06a6fc3cb61d3f"><div class="ttname"><a href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">mapgendata::zlevel</a></div><div class="ttdeci">int zlevel() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00184">mapgendata.h:184</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a92f91552ebe7d57b72249428b168afdc"><div class="ttname"><a href="classmapgendata.html#a92f91552ebe7d57b72249428b168afdc">mapgendata::s_fac</a></div><div class="ttdeci">int s_fac</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00118">mapgendata.h:118</a></div></div>
<div class="ttc" id="aclassmapgendata_html_ad5592102dc5b5037f6b7b324b3e466fb"><div class="ttname"><a href="classmapgendata.html#ad5592102dc5b5037f6b7b324b3e466fb">mapgendata::when</a></div><div class="ttdeci">const time_point &amp; when() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00178">mapgendata.h:178</a></div></div>
<div class="ttc" id="aclassmapgendata_html_ae0820543796bc3c1db0bd582cc2d5743"><div class="ttname"><a href="classmapgendata.html#ae0820543796bc3c1db0bd582cc2d5743">mapgendata::n_fac</a></div><div class="ttdeci">int n_fac</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00116">mapgendata.h:116</a></div></div>
<div class="ttc" id="aeditmap_8cpp_html_a14e7362458bb23f8c57511c0d71d3c22"><div class="ttname"><a href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature</a></div><div class="ttdeci">static T_id feature(const tripoint &amp;p)</div></div>
<div class="ttc" id="aenums_8h_html_a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28"><div class="ttname"><a href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a></div><div class="ttdeci">@ edge</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00412">enums.h:412</a></div></div>
<div class="ttc" id="aenums_8h_html_a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834"><div class="ttname"><a href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a></div><div class="ttdeci">@ corner</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00411">enums.h:411</a></div></div>
<div class="ttc" id="agame__constants_8h_html_a39fd8a829e3dc412646663066dbdb54c"><div class="ttname"><a href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a></div><div class="ttdeci">constexpr int SEEX</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00042">game_constants.h:42</a></div></div>
<div class="ttc" id="agame__constants_8h_html_a4cfa35de359af17f7bc6c2a424339eb5"><div class="ttname"><a href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a></div><div class="ttdeci">constexpr int SEEY</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00043">game_constants.h:43</a></div></div>
<div class="ttc" id="amagic_8cpp_html_aa93a189fb7bbbf87be54bcc7bd11bb6f"><div class="ttname"><a href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a></div><div class="ttdeci">static constexpr double b</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01567">magic.cpp:1567</a></div></div>
<div class="ttc" id="amath__defines_8h_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="math__defines_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="math__defines_8h_source.html#l00023">math_defines.h:23</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a24f6ac6e06720c7cdf972a6083847132"><div class="ttname"><a href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">abs</a></div><div class="ttdeci">double abs(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00030">math_parser_func.h:30</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a3d9f495ca19a6110e624fc1d0ed3da74"><div class="ttname"><a href="math__parser__func_8h.html#a3d9f495ca19a6110e624fc1d0ed3da74">sin</a></div><div class="ttdeci">double sin(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00071">math_parser_func.h:71</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a5834219bcffc7118c95b395b8cdeec20"><div class="ttname"><a href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">round</a></div><div class="ttdeci">double round(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00110">math_parser_func.h:110</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a6a96e281ee5bf1967d26afebe837ad48"><div class="ttname"><a href="math__parser__func_8h.html#a6a96e281ee5bf1967d26afebe837ad48">log</a></div><div class="ttdeci">double log(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00066">math_parser_func.h:66</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_aa178d72bf03c69677934a8c977f3b850"><div class="ttname"><a href="math__parser__func_8h.html#aa178d72bf03c69677934a8c977f3b850">cos</a></div><div class="ttdeci">double cos(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00076">math_parser_func.h:76</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_aeb3bbc4ec861ea58cbfca028920e4cc6"><div class="ttname"><a href="math__parser__func_8h.html#aeb3bbc4ec861ea58cbfca028920e4cc6">sqrt</a></div><div class="ttdeci">double sqrt(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00061">math_parser_func.h:61</a></div></div>
<div class="ttc" id="anamespacekeycode_html_a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac"><div class="ttname"><a href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">keycode::end</a></div><div class="ttdeci">@ end</div><div class="ttdef"><b>Definition:</b> <a href="input_8h_source.html#l00095">input.h:95</a></div></div>
<div class="ttc" id="apoint_8h_html_a0ee2195dcb488ae55fbf4316f5011172"><div class="ttname"><a href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a></div><div class="ttdeci">constexpr point point_zero</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00251">point.h:251</a></div></div>
<div class="ttc" id="arng_8cpp_html_a074df23c91b5843596dcb25fd9a9d4dc"><div class="ttname"><a href="rng_8cpp.html#a074df23c91b5843596dcb25fd9a9d4dc">rng_normal</a></div><div class="ttdeci">double rng_normal(double lo, double hi)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00178">rng.cpp:178</a></div></div>
<div class="ttc" id="arng_8cpp_html_a3a6a7e6245951426223e02f989bdd6a4"><div class="ttname"><a href="rng_8cpp.html#a3a6a7e6245951426223e02f989bdd6a4">normal_roll</a></div><div class="ttdeci">double normal_roll(double mean, double stddev)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00078">rng.cpp:78</a></div></div>
<div class="ttc" id="astructforest__biome__terrain__dependent__furniture_html"><div class="ttname"><a href="structforest__biome__terrain__dependent__furniture.html">forest_biome_terrain_dependent_furniture</a></div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00122">regional_settings.h:122</a></div></div>
<div class="ttc" id="astructforest__biome__terrain__dependent__furniture_html_aa264e5b223541bacba4ae29057999d34"><div class="ttname"><a href="structforest__biome__terrain__dependent__furniture.html#aa264e5b223541bacba4ae29057999d34">forest_biome_terrain_dependent_furniture::furniture</a></div><div class="ttdeci">weighted_int_list&lt; furn_id &gt; furniture</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00124">regional_settings.h:124</a></div></div>
<div class="ttc" id="astructforest__biome__terrain__dependent__furniture_html_aae3e68ad43c98e9a1d86fdf1b18571c7"><div class="ttname"><a href="structforest__biome__terrain__dependent__furniture.html#aae3e68ad43c98e9a1d86fdf1b18571c7">forest_biome_terrain_dependent_furniture::chance</a></div><div class="ttdeci">int chance</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00125">regional_settings.h:125</a></div></div>
<div class="ttc" id="astructforest__biome_html"><div class="ttname"><a href="structforest__biome.html">forest_biome</a></div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00132">regional_settings.h:132</a></div></div>
<div class="ttc" id="astructforest__mapgen__settings_html_ab6eedcedaf6a964d6539c38d123ed144"><div class="ttname"><a href="structforest__mapgen__settings.html#ab6eedcedaf6a964d6539c38d123ed144">forest_mapgen_settings::biomes</a></div><div class="ttdeci">std::map&lt; oter_type_id, forest_biome &gt; biomes</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00155">regional_settings.h:155</a></div></div>
<div class="ttc" id="astructoter__t_html_ab1638475c8650985ec100f0bc7fcafe7"><div class="ttname"><a href="structoter__t.html#ab1638475c8650985ec100f0bc7fcafe7">oter_t::get_type_id</a></div><div class="ttdeci">const string_id&lt; oter_type_t &gt; &amp; get_type_id() const</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00323">omdata.h:323</a></div></div>
<div class="ttc" id="astructpoint_html"><div class="ttname"><a href="structpoint.html">point</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00020">point.h:20</a></div></div>
<div class="ttc" id="astructpoint_html_a9a82ca9504acabb1e30569f89c805471"><div class="ttname"><a href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">point::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00024">point.h:24</a></div></div>
<div class="ttc" id="astructpoint_html_ad679b07fb69d55f5ad454d0f1f2891d5"><div class="ttname"><a href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">point::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00023">point.h:23</a></div></div>
<div class="ttc" id="astructregional__settings_html_a71bd1cf5d47797847624483f5bb20263"><div class="ttname"><a href="structregional__settings.html#a71bd1cf5d47797847624483f5bb20263">regional_settings::default_groundcover</a></div><div class="ttdeci">weighted_int_list&lt; ter_id &gt; default_groundcover</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00278">regional_settings.h:278</a></div></div>
<div class="ttc" id="astructregional__settings_html_a75b62d1743b484b28b26fc79330bfce9"><div class="ttname"><a href="structregional__settings.html#a75b62d1743b484b28b26fc79330bfce9">regional_settings::forest_composition</a></div><div class="ttdeci">forest_mapgen_settings forest_composition</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00282">regional_settings.h:282</a></div></div>
<div class="ttc" id="astructter__furn__id_html"><div class="ttname"><a href="structter__furn__id.html">ter_furn_id</a></div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00082">regional_settings.h:82</a></div></div>
<div class="ttc" id="astructter__furn__id_html_a0e4c9b3cbcad5dea11c882c58bf9caaf"><div class="ttname"><a href="structter__furn__id.html#a0e4c9b3cbcad5dea11c882c58bf9caaf">ter_furn_id::ter</a></div><div class="ttdeci">ter_id ter</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00083">regional_settings.h:83</a></div></div>
<div class="ttc" id="astructweighted__float__list_html"><div class="ttname"><a href="structweighted__float__list.html">weighted_float_list</a></div><div class="ttdef"><b>Definition:</b> <a href="weighted__list_8h_source.html#l00271">weighted_list.h:271</a></div></div>
<div class="ttc" id="astructweighted__list_html_aa2eb002d2ec795a0aab91178a93d05ba"><div class="ttname"><a href="structweighted__list.html#aa2eb002d2ec795a0aab91178a93d05ba">weighted_list::pick</a></div><div class="ttdeci">const T * pick(unsigned int randi) const</div><div class="ttdoc">This will return a pointer to an object from the list randomly selected and biased by weight.</div><div class="ttdef"><b>Definition:</b> <a href="weighted__list_8h_source.html#l00113">weighted_list.h:113</a></div></div>
<div class="ttc" id="astructweighted__list_html_ad960be5e22f6aaa4eb01af592a9476f5"><div class="ttname"><a href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">weighted_list::add</a></div><div class="ttdeci">T * add(const T &amp;obj, const W &amp;weight)</div><div class="ttdoc">This will add a new object to the weighted list.</div><div class="ttdef"><b>Definition:</b> <a href="weighted__list_8h_source.html#l00040">weighted_list.h:40</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="math__parser__func_8h_source.html#l00030">abs()</a>, <a class="el" href="weighted__list_8h_source.html#l00040">weighted_list&lt; W, T &gt;::add()</a>, <a class="el" href="magic_8cpp_source.html#l01567">b</a>, <a class="el" href="regional__settings_8h_source.html#l00155">forest_mapgen_settings::biomes</a>, <a class="el" href="regional__settings_8h_source.html#l00125">forest_biome_terrain_dependent_furniture::chance</a>, <a class="el" href="cata__utility_8h_source.html#l00221">clamp()</a>, <a class="el" href="enums_8h_source.html#l00411">corner</a>, <a class="el" href="math__parser__func_8h_source.html#l00076">cos()</a>, <a class="el" href="regional__settings_8h_source.html#l00278">regional_settings::default_groundcover</a>, <a class="el" href="mapgendata_8cpp_source.html#l00195">mapgendata::dir()</a>, <a class="el" href="mapgendata_8h_source.html#l00117">mapgendata::e_fac</a>, <a class="el" href="enums_8h_source.html#l00412">edge</a>, <a class="el" href="input_8h_source.html#l00095">keycode::end</a>, <a class="el" href="editmap_8cpp.html#a14e7362458bb23f8c57511c0d71d3c22">feature()</a>, <a class="el" href="mapgendata_8cpp_source.html#l00226">mapgendata::fill_groundcover()</a>, <a class="el" href="regional__settings_8h_source.html#l00282">regional_settings::forest_composition</a>, <a class="el" href="map_8cpp_source.html#l01743">map::furn_set()</a>, <a class="el" href="regional__settings_8h_source.html#l00124">forest_biome_terrain_dependent_furniture::furniture</a>, <a class="el" href="omdata_8h_source.html#l00323">oter_t::get_type_id()</a>, <a class="el" href="map_8cpp_source.html#l09614">map::getabs()</a>, <a class="el" href="regional__settings_8h_source.html#l00136">forest_biome::groundcover</a>, <a class="el" href="regional__settings_8h_source.html#l00143">forest_biome::item_group</a>, <a class="el" href="regional__settings_8h_source.html#l00141">forest_biome::item_group_chance</a>, <a class="el" href="regional__settings_8h_source.html#l00142">forest_biome::item_spawn_iterations</a>, <a class="el" href="math__parser__func_8h_source.html#l00066">log()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="math__defines_8h_source.html#l00023">M_PI</a>, <a class="el" href="mapgendata_8h_source.html#l00116">mapgendata::n_fac</a>, <a class="el" href="rng_8cpp_source.html#l00078">normal_roll()</a>, <a class="el" href="rng_8cpp_source.html#l00108">one_in()</a>, <a class="el" href="regional__settings_8cpp_source.html#l00884">forest_biome::pick()</a>, <a class="el" href="weighted__list_8h_source.html#l00113">weighted_list&lt; W, T &gt;::pick()</a>, <a class="el" href="mapgen_8cpp_source.html#l06558">map::place_items()</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>, <a class="el" href="point_8h_source.html#l00251">point_zero</a>, <a class="el" href="mapgendata_8h_source.html#l00130">mapgendata::region</a>, <a class="el" href="rng_8cpp_source.html#l00178">rng_normal()</a>, <a class="el" href="math__parser__func_8h_source.html#l00110">round()</a>, <a class="el" href="mapgendata_8h_source.html#l00118">mapgendata::s_fac</a>, <a class="el" href="game__constants_8h_source.html#l00042">SEEX</a>, <a class="el" href="game__constants_8h_source.html#l00043">SEEY</a>, <a class="el" href="math__parser__func_8h_source.html#l00071">sin()</a>, <a class="el" href="math__parser__func_8h_source.html#l00061">sqrt()</a>, <a class="el" href="mapgendata_8h_source.html#l00114">mapgendata::t_nesw</a>, <a class="el" href="regional__settings_8h_source.html#l00083">ter_furn_id::ter</a>, <a class="el" href="map_8cpp_source.html#l02226">map::ter_set()</a>, <a class="el" href="regional__settings_8h_source.html#l00139">forest_biome::terrain_dependent_furniture</a>, <a class="el" href="mapgendata_8h_source.html#l00172">mapgendata::terrain_type()</a>, <a class="el" href="mapgendata_8h_source.html#l00119">mapgendata::w_fac</a>, <a class="el" href="mapgendata_8h_source.html#l00178">mapgendata::when()</a>, <a class="el" href="point_8h_source.html#l00023">point::x</a>, <a class="el" href="point_8h_source.html#l00024">point::y</a>, and <a class="el" href="mapgendata_8h_source.html#l00184">mapgendata::zlevel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l01142">mapgen_lake_shore()</a>, and <a class="el" href="mapgen__functions_8cpp_source.html#l01604">mapgen_ocean_shore()</a>.</p>

</div>
</div>
<a id="a9f58f1cefca5a7566b20e27d4e84fdb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f58f1cefca5a7566b20e27d4e84fdb1">&#9670;&nbsp;</a></span>mapgen_lake_shore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_lake_shore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l01142">1142</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;{</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <a class="code" href="classmap.html">map</a> *<span class="keyword">const</span> m = &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="comment">// Our lake shores may &quot;extend&quot; adjacent terrain, if the adjacent types are defined as being</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="comment">// extendable in our regional settings. What this effectively means is that if the lake shore is</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">// adjacent to one of these, e.g. a forest, then rather than the lake shore simply having the</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">// region&#39;s default groundcover for the land parts of the terrain, instead we run the mapgen</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="comment">// for this location as if it were the adjacent terrain, and then carve our water out of it as</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">// per usual. I think it looks a lot nicer, e.g. in the case of a forest, to have the trees and</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="comment">// ground clutter of the forest abutting the water rather than simply some empty ground.</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">// To accomplish this extension, we simply count up the adjacent terrains that are in the</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">// defined extendable terrain setting, choose the most common one, and then run its mapgen.</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">// NOTE: Presently this treats ocean and lake shore as identical.  Some, but not all, of the</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">// ocean checks should eventually be refactored into mapgen_ocean_shore.</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordtype">bool</span> did_extend_adjacent_terrain = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">if</span>( !dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a7645168dff87b72ed0f06b070a38d6e7">shore_extendable_overmap_terrain</a>.empty() ) {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        std::map&lt;oter_id, int&gt; adjacent_type_count;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="classint__id.html">oter_id</a> &amp;adjacent : dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a> ) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            <span class="comment">// Define the terrain we&#39;ll look for a match on.</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <a class="code" href="classint__id.html">oter_id</a> match = adjacent;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="comment">// Check if this terrain has an alias to something we actually will extend, and if so, use it.</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structshore__extendable__overmap__terrain__alias.html">shore_extendable_overmap_terrain_alias</a> &amp;alias :</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                 dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a540e356b80469076dbf4cda69d03ccb4">shore_extendable_overmap_terrain_aliases</a> ) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="overmap_8cpp.html#aa1967e14c4ef0be6b81c5405dae79281">is_ot_match</a>( alias.<a class="code" href="structshore__extendable__overmap__terrain__alias.html#ab969bed63d3506cedb5419508093fd72">overmap_terrain</a>, adjacent, alias.<a class="code" href="structshore__extendable__overmap__terrain__alias.html#a062f722019a340016cff54fb20b4b54d">match_type</a> ) ) {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                    match = alias.<a class="code" href="structshore__extendable__overmap__terrain__alias.html#aaefacbfb63b47f8e47f710af2c7f6171">alias</a>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            <span class="keywordflow">if</span>( std::find( dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a7645168dff87b72ed0f06b070a38d6e7">shore_extendable_overmap_terrain</a>.begin(),</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                           dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a7645168dff87b72ed0f06b070a38d6e7">shore_extendable_overmap_terrain</a>.end(),</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                           match ) != dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a7645168dff87b72ed0f06b070a38d6e7">shore_extendable_overmap_terrain</a>.end() ) {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                adjacent_type_count[match] += 1;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">if</span>( !adjacent_type_count.empty() ) {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> most_common_adjacent = std::max_element( std::begin( adjacent_type_count ),</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                                              <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">std::end</a>( adjacent_type_count ), []( <span class="keyword">const</span> std::pair&lt;oter_id, int&gt; &amp;p1,</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <span class="keyword">const</span> std::pair&lt;oter_id, int&gt; &amp;p2 ) {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                <span class="keywordflow">return</span> p1.second &lt; p2.second;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            } );</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            <a class="code" href="classmapgendata.html">mapgendata</a> forest_mapgen_dat( dat, most_common_adjacent-&gt;first );</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <a class="code" href="mapgen__functions_8cpp.html#acb4c2c9ab474f9f0076b44b63b279702">mapgen_forest</a>( forest_mapgen_dat );</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            did_extend_adjacent_terrain = <a class="code" href="mapgen_8cpp.html#ae8b9b565ea11e5c8e001c687c7133811">run_mapgen_func</a>( most_common_adjacent-&gt;first.id().str(),</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                                          forest_mapgen_dat );</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            <span class="comment">// One fun side effect of running another mapgen here is that it may have placed items in locations</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            <span class="comment">// that we&#39;re later going to turn into water. Let&#39;s just remove all items.</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;            <span class="keywordflow">if</span>( did_extend_adjacent_terrain ) {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; x++ ) {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> y = 0; y &lt; <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2; y++ ) {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                        m-&gt;<a class="code" href="classmap.html#a9b1c092685c43287d5db23156f3f337e">i_clear</a>( <a class="code" href="structpoint.html">point</a>( x, y ) );</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                    }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">// If we didn&#39;t extend an adjacent terrain, then just fill this entire location with the default</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="comment">// groundcover for the region.</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">if</span>( !did_extend_adjacent_terrain ) {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        dat.<a class="code" href="classmapgendata.html#a6f10a37ad3dfd21c36ce4526ee7d4054">fill_groundcover</a>();</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> river_center = <a class="code" href="mapgen__functions_8cpp.html#a1bb505fdd896ac7af2b4119bd6c8a69a">oter_river_center</a>.<a class="code" href="classstring__id.html#aa3cde2bfb58efa9621289c0a70d24c5a">id</a>();</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keyword">auto</span> is_lake = [&amp;]( <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> &amp; <a class="code" href="classint__id.html#a09d4f824b2540da7e682d10cdf324081">id</a> ) {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="comment">// We want to consider river_center as a lake as well, so that the confluence of a</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="comment">// river and a lake is a continuous water body.</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">id</span>.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structoter__t.html#a5c4aa1d93a0e1ddbd6fe8be77631ddbe">is_lake</a>() || <span class="keywordtype">id</span> == river_center;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    };</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> is_shore = [&amp;]( <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> &amp; <a class="code" href="classint__id.html#a09d4f824b2540da7e682d10cdf324081">id</a> ) {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">id</span>.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structoter__t.html#adb17be308671c9a4603a4e2e005e7b9d">is_lake_shore</a>();</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    };</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> is_river_bank = [&amp;]( <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> &amp; <a class="code" href="classint__id.html#a09d4f824b2540da7e682d10cdf324081">id</a> ) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">id</span> != river_center &amp;&amp; <span class="keywordtype">id</span>.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structoter__t.html#a84cc529cda04022d6b73cb2aa0ac39a1">is_river</a>();</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    };</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> n_lake  = is_lake( dat.<a class="code" href="classmapgendata.html#a77f8d2160aa8085cd3290c76a1cbc006">north</a>() );</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> e_lake  = is_lake( dat.<a class="code" href="classmapgendata.html#ad6b2ee9260b740a0a6e7309f247461c2">east</a>() );</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> s_lake  = is_lake( dat.<a class="code" href="classmapgendata.html#ac5b6942a9bd85224bb92dd7ba7c3aae2">south</a>() );</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> w_lake  = is_lake( dat.<a class="code" href="classmapgendata.html#aedd4dfcadcd552678e0da25788952122">west</a>() );</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> nw_lake = is_lake( dat.<a class="code" href="classmapgendata.html#ad4feab749e2ffdc8192a282e92b22679">nwest</a>() );</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> ne_lake = is_lake( dat.<a class="code" href="classmapgendata.html#a4865c3c00376457470d1d4c989c79fb4">neast</a>() );</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> se_lake = is_lake( dat.<a class="code" href="classmapgendata.html#af9c8749f33060b01bccec09cf66f0631">seast</a>() );</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> sw_lake = is_lake( dat.<a class="code" href="classmapgendata.html#ac629cfa2439709898c4cb1b2f5946e44">swest</a>() );</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">// If we don&#39;t have any adjacent lakes, then we don&#39;t need to worry about a shoreline,</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">// and are done at this point.</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> no_adjacent_water = !n_lake &amp;&amp; !e_lake &amp;&amp; !s_lake &amp;&amp; !w_lake &amp;&amp; !nw_lake &amp;&amp; !ne_lake &amp;&amp;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                   !se_lake &amp;&amp; !sw_lake;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">if</span>( no_adjacent_water ) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="comment">// I&#39;m pretty unhappy with this block of if statements that follows, but got frustrated/sidetracked</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">// in finding a more elegant solution. This is functional, but improvements that maintain the result</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">// are welcome. The basic gist is as follows:</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="comment">// Given our current location and the 8 adjacent locations, we classify them all as lake, lake shore,</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="comment">// river bank, or something else that we don&#39;t care about. We then create a polygon with four points,</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="comment">// one in each corner of our location. Then, based on the permutations of possible adjacent location</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="comment">// types, we manipulate the four points of our polygon to generate the rough outline of our shore. The</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="comment">// area inside the polygon will retain our ground we generated, while the area outside will get turned</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">// into the shoreline with shallow and deep water.</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="comment">// For example, if we have forests to the west, the lake to the east, and more shore north and south of</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">// us, like this...</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="comment">//     | F   | S   | L   |</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="comment">//     | F   | S   | L   |</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">//     | F   | S   | L   |</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="comment">// ...then what we want to do with our polygon is push our eastern points to the west. If the north location</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="comment">// were instead a continuation of the lake, with a commensurate shoreline like this...</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="comment">//     | S   | L   | L   |</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="comment">//     | S   | S   | L   |</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="comment">//     | F   | S   | L   |</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="comment">// ...then we still need to push our eastern points to the west, but we also need to push our northern</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">// points south, and since we don&#39;t want such a blocky shoreline at our corners, we also want to</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">// push the north-eastern point even further south-west.</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="comment">// Things get even more complicated when we transition into a river bank--they have their own style of</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="comment">// mapgen, and while things don&#39;t have to be seamless, I did want the lake shores to fairly smoothly</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="comment">// transition into them, so if we have a river bank adjacent like this...</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">//     | F   | R   | L   |</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="comment">//     | F   | S   | L   |</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="comment">//     | F   | S   | L   |</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">//     | --- | --- | --- |</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">// ...then we need to push our adjacent corners in even more for a good transition.</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="comment">// At the end of all this, we&#39;ll have our basic four point polygon that we&#39;ll then inspect and use</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="comment">// to create the line-segments that will form our shoreline, but more on in a bit.</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> n_shore = is_shore( dat.<a class="code" href="classmapgendata.html#a77f8d2160aa8085cd3290c76a1cbc006">north</a>() );</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> e_shore = is_shore( dat.<a class="code" href="classmapgendata.html#ad6b2ee9260b740a0a6e7309f247461c2">east</a>() );</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> s_shore = is_shore( dat.<a class="code" href="classmapgendata.html#ac5b6942a9bd85224bb92dd7ba7c3aae2">south</a>() );</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> w_shore = is_shore( dat.<a class="code" href="classmapgendata.html#aedd4dfcadcd552678e0da25788952122">west</a>() );</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> n_river_bank = is_river_bank( dat.<a class="code" href="classmapgendata.html#a77f8d2160aa8085cd3290c76a1cbc006">north</a>() );</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> e_river_bank = is_river_bank( dat.<a class="code" href="classmapgendata.html#ad6b2ee9260b740a0a6e7309f247461c2">east</a>() );</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> s_river_bank = is_river_bank( dat.<a class="code" href="classmapgendata.html#ac5b6942a9bd85224bb92dd7ba7c3aae2">south</a>() );</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> w_river_bank = is_river_bank( dat.<a class="code" href="classmapgendata.html#aedd4dfcadcd552678e0da25788952122">west</a>() );</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="comment">// This is length we end up pushing things about by as a baseline.</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> sector_length = <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 / 3;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">// Define the corners of the map. These won&#39;t change.</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structpoint.html">point</a> nw_corner{};</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structpoint.html">point</a> ne_corner( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1, 0 );</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structpoint.html">point</a> se_corner( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1, <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - 1 );</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structpoint.html">point</a> sw_corner( 0, <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - 1 );</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160; </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">// Define the four points that make up our polygon that we&#39;ll later pull line segments from for</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="comment">// the actual shoreline.</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <a class="code" href="structpoint.html">point</a> nw = nw_corner;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <a class="code" href="structpoint.html">point</a> ne = ne_corner;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <a class="code" href="structpoint.html">point</a> se = se_corner;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <a class="code" href="structpoint.html">point</a> sw = sw_corner;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    std::vector&lt;std::vector&lt;point&gt;&gt; line_segments;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">// This section is about pushing the straight N, S, E, or W borders inward when adjacent to an actual lake.</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">if</span>( n_lake ) {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        nw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        ne.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordflow">if</span>( s_lake ) {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        sw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        se.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">if</span>( w_lake ) {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        nw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        sw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="keywordflow">if</span>( e_lake ) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        ne.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        se.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="comment">// This section is about pushing the corners inward when adjacent to a lake that curves into a river bank.</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordflow">if</span>( n_river_bank ) {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <span class="keywordflow">if</span>( w_lake &amp;&amp; nw_lake ) {</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            nw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <span class="keywordflow">if</span>( e_lake &amp;&amp; ne_lake ) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            ne.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        }</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">if</span>( e_river_bank ) {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordflow">if</span>( s_lake &amp;&amp; se_lake ) {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            se.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <span class="keywordflow">if</span>( n_lake &amp;&amp; ne_lake ) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            ne.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordflow">if</span>( s_river_bank ) {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keywordflow">if</span>( w_lake &amp;&amp; sw_lake ) {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            sw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        }</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <span class="keywordflow">if</span>( e_lake &amp;&amp; se_lake ) {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            se.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordflow">if</span>( w_river_bank ) {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <span class="keywordflow">if</span>( s_lake &amp;&amp; sw_lake ) {</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            sw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <span class="keywordflow">if</span>( n_lake &amp;&amp; nw_lake ) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            nw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="comment">// This section is about pushing the corners inward when we&#39;ve got a lake in the corner that</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">// either has lake adjacent to it and us, or more shore adjacent to it and us. Note that in the</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">// case of having two shores adjacent, we end up adding a new line segment that isn&#39;t part of</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">// our original set--we end up cutting the corner off our polygonal box.</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">if</span>( nw_lake ) {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keywordflow">if</span>( n_lake &amp;&amp; w_lake ) {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            nw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length / 2;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            nw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length / 2;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( n_shore || n_river_bank ) &amp;&amp; ( w_shore || w_river_bank ) ) {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            <a class="code" href="structpoint.html">point</a> n = nw_corner;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            <a class="code" href="structpoint.html">point</a> w = nw_corner;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            n.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length * ( n_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;            w.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length * ( w_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            n.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += n_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            w.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += w_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            <span class="keywordflow">if</span>( w_river_bank ) {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                line_segments.push_back( { sw, w } );</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            }</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            <span class="keywordflow">if</span>( n_river_bank ) {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                line_segments.push_back( { n, ne } );</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;            line_segments.push_back( { n, w } );</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">if</span>( ne_lake ) {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="keywordflow">if</span>( n_lake &amp;&amp; e_lake ) {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            ne.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length / 2;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            ne.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length / 2;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( n_shore || n_river_bank ) &amp;&amp; ( e_shore || e_river_bank ) ) {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            <a class="code" href="structpoint.html">point</a> n = ne_corner;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <a class="code" href="structpoint.html">point</a> e = ne_corner;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            n.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length * ( n_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            e.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length * ( e_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            n.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += n_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            e.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= e_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160; </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            <span class="keywordflow">if</span>( e_river_bank ) {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                line_segments.push_back( { se, e } );</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <span class="keywordflow">if</span>( n_river_bank ) {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                line_segments.push_back( { n, nw } );</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            line_segments.push_back( { n, e } );</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">if</span>( sw_lake ) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">if</span>( s_lake &amp;&amp; w_lake ) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            sw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length / 2;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            sw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length / 2;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( s_shore || s_river_bank ) &amp;&amp; ( w_shore || w_river_bank ) ) {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            <a class="code" href="structpoint.html">point</a> s = sw_corner;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            <a class="code" href="structpoint.html">point</a> w = sw_corner;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160; </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            s.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length * ( s_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            w.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length * ( w_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            s.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= s_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            w.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += w_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            <span class="keywordflow">if</span>( w_river_bank ) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                line_segments.push_back( { nw, w } );</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            <span class="keywordflow">if</span>( s_river_bank ) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                line_segments.push_back( { s, se } );</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            line_segments.push_back( { s, w } );</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    }</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">if</span>( se_lake ) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="keywordflow">if</span>( s_lake &amp;&amp; e_lake ) {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            se.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length / 2;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            se.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length / 2;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( s_shore || s_river_bank ) &amp;&amp; ( e_shore || e_river_bank ) ) {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <a class="code" href="structpoint.html">point</a> s = se_corner;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            <a class="code" href="structpoint.html">point</a> e = se_corner;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            s.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length * ( s_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            e.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length * ( e_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            s.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= s_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            e.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= e_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <span class="keywordflow">if</span>( e_river_bank ) {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                line_segments.push_back( { ne, e } );</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            <span class="keywordflow">if</span>( s_river_bank ) {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                line_segments.push_back( { s, sw } );</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            line_segments.push_back( { s, e } );</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    }</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">// Ok, all of the fiddling with the polygon corners is done.</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">// At this point we&#39;ve got four points that make up four line segments that started out</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">// at the map boundaries, but have subsequently been perturbed by the adjacent terrains.</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="comment">// Let&#39;s look at them and see which ones differ from their original state and should</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">// form our shoreline.</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordflow">if</span>( nw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != nw_corner.y || ne.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != ne_corner.y ) {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        line_segments.push_back( { nw, ne } );</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    }</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span>( ne.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != ne_corner.x || se.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != se_corner.x ) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        line_segments.push_back( { ne, se } );</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">if</span>( se.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != se_corner.y || sw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != sw_corner.y ) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        line_segments.push_back( { se, sw } );</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    }</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="keywordflow">if</span>( sw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != sw_corner.x || nw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != nw_corner.x ) {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        line_segments.push_back( { sw, nw } );</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160; </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structinclusive__rectangle.html">inclusive_rectangle&lt;point&gt;</a> map_boundaries( nw_corner, se_corner );</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">// This will draw our shallow water coastline from the &quot;from&quot; point to the &quot;to&quot; point.</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">// It buffers the points a bit for a thicker line. It also clears any furniture that might</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="comment">// be in the location as a result of our extending adjacent mapgen.</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> draw_shallow_water = [&amp;]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; from, <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; to ) {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        std::vector&lt;point&gt; points = <a class="code" href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a>( from, to );</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="structpoint.html">point</a> &amp;p : points ) {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;<a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> : <a class="code" href="coordinates_8h.html#a560abf1cd341e88e2f13f454ec2ecc99">closest_points_first</a>( p, 1 ) ) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                <span class="keywordflow">if</span>( !map_boundaries.contains( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> ) ) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                <span class="comment">// Use t_null for now instead of t_water_sh, because sometimes our extended terrain</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                <span class="comment">// has put down a t_water_sh, and we need to be able to flood-fill over that.</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a>, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>() );</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                m-&gt;<a class="code" href="classmap.html#a410a8dcd3e1ee0e87da584bf878d6f83">furn_set</a>( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a>, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() );</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    };</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">// Given two points, return a point that is midway between the two points and then</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="comment">// jittered by a random amount in proportion to the length of the line segment.</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> jittered_midpoint = [&amp;]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; from, <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; to ) {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> jitter = <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( from, to ) / 4;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> <a class="code" href="coordinates_8h.html#a3daf91bb096de1a1a004b1668a3ee53b">midpoint</a>( ( from.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> + to.x ) / 2 + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -jitter, jitter ),</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                              ( from.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> + to.y ) / 2 + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -jitter, jitter ) );</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coordinates_8h.html#a3daf91bb096de1a1a004b1668a3ee53b">midpoint</a>;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    };</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="comment">// For each of our valid shoreline line segments, generate a slightly more interesting</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="comment">// set of line segments by splitting the line into four segments with jittered</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="comment">// midpoints, and then draw shallow water for four each of those.</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;ls : line_segments ) {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> mp1 = jittered_midpoint( ls[0], ls[1] );</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> mp2 = jittered_midpoint( ls[0], mp1 );</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> <a class="code" href="namespacemusic.html#a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0">mp3</a> = jittered_midpoint( mp1, ls[1] );</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        draw_shallow_water( ls[0], mp2 );</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        draw_shallow_water( mp2, mp1 );</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        draw_shallow_water( mp1, <a class="code" href="namespacemusic.html#a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0">mp3</a> );</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        draw_shallow_water( <a class="code" href="namespacemusic.html#a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0">mp3</a>, ls[1] );</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="comment">// Now that we&#39;ve done our ground mapgen and laid down a contiguous shoreline of shallow water,</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="comment">// we&#39;ll floodfill the sections adjacent to the lake with deep water. As before, we also clear</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">// out any furniture that we placed by the extended mapgen.</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    std::unordered_set&lt;point&gt; visited;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> should_fill = [&amp;]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; p ) {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <span class="keywordflow">if</span>( !map_boundaries.contains( p ) ) {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="keywordflow">return</span> m-&gt;<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( p ) != <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>();</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    };</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> fill_deep_water = [&amp;]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; starting_point ) {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        std::vector&lt;point&gt; water_points = <a class="code" href="namespaceff.html#a19eb008b6f3397b3fcfb01914b1be6c1">ff::point_flood_fill_4_connected</a>( starting_point, visited,</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                                          should_fill );</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="structpoint.html">point</a> &amp;wp : water_points ) {</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( wp, <a class="code" href="mapgen__functions_8cpp.html#af6c40bc0b28ed4a025fc4141b5499887">ter_t_water_dp</a> );</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            m-&gt;<a class="code" href="classmap.html#a410a8dcd3e1ee0e87da584bf878d6f83">furn_set</a>( wp, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() );</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        }</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    };</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="comment">// We&#39;ll flood fill from the four corners, using the corner if any of the locations</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="comment">// adjacent to it were a lake.</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keywordflow">if</span>( n_lake || nw_lake || w_lake ) {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        fill_deep_water( nw_corner );</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordflow">if</span>( s_lake || sw_lake || w_lake ) {</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        fill_deep_water( sw_corner );</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordflow">if</span>( n_lake || ne_lake || e_lake ) {</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        fill_deep_water( ne_corner );</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    }</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">if</span>( s_lake || se_lake || e_lake ) {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        fill_deep_water( se_corner );</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">// We previously placed our shallow water but actually did a t_null instead to make sure that we didn&#39;t</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="comment">// pick up shallow water from our extended terrain. Now turn those nulls into t_water_sh.</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    m-&gt;<a class="code" href="classmap.html#a16c42a0494cf948a154567bc43571f90">translate</a>( <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>(), <a class="code" href="mapgen__functions_8cpp.html#a636bd6f4127c7232559e88f63ec2f86d">ter_t_water_sh</a> );</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;}</div>
<div class="ttc" id="acalendar_8cpp_html_a4249b6f1d0842211bfe53e5f9e206a10"><div class="ttname"><a href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a></div><div class="ttdeci">time_duration rng(time_duration lo, time_duration hi)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00779">calendar.cpp:779</a></div></div>
<div class="ttc" id="aclassint__id_html_a09d4f824b2540da7e682d10cdf324081"><div class="ttname"><a href="classint__id.html#a09d4f824b2540da7e682d10cdf324081">int_id::id</a></div><div class="ttdeci">const string_id&lt; ammo_effect &gt; &amp; id() const</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00033">ammo_effect.cpp:33</a></div></div>
<div class="ttc" id="aclassint__id_html_a4796245d3cd6e0283670698a98d46ae9"><div class="ttname"><a href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">int_id::obj</a></div><div class="ttdeci">const T &amp; obj() const</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00026">ammo_effect.cpp:26</a></div></div>
<div class="ttc" id="aclassmap_html_a16c42a0494cf948a154567bc43571f90"><div class="ttname"><a href="classmap.html#a16c42a0494cf948a154567bc43571f90">map::translate</a></div><div class="ttdeci">void translate(const ter_id &amp;from, const ter_id &amp;to)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l04751">map.cpp:4751</a></div></div>
<div class="ttc" id="aclassmap_html_a9b1c092685c43287d5db23156f3f337e"><div class="ttname"><a href="classmap.html#a9b1c092685c43287d5db23156f3f337e">map::i_clear</a></div><div class="ttdeci">void i_clear(const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l05030">map.cpp:5030</a></div></div>
<div class="ttc" id="aclassmap_html_aba8f330c2cc25be0652489b42d8dd530"><div class="ttname"><a href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">map::ter</a></div><div class="ttdeci">ter_id ter(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01922">map.cpp:1922</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a4865c3c00376457470d1d4c989c79fb4"><div class="ttname"><a href="classmapgendata.html#a4865c3c00376457470d1d4c989c79fb4">mapgendata::neast</a></div><div class="ttdeci">const oter_id &amp; neast() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00207">mapgendata.h:207</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a77f8d2160aa8085cd3290c76a1cbc006"><div class="ttname"><a href="classmapgendata.html#a77f8d2160aa8085cd3290c76a1cbc006">mapgendata::north</a></div><div class="ttdeci">const oter_id &amp; north() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00195">mapgendata.h:195</a></div></div>
<div class="ttc" id="aclassmapgendata_html_ac5b6942a9bd85224bb92dd7ba7c3aae2"><div class="ttname"><a href="classmapgendata.html#ac5b6942a9bd85224bb92dd7ba7c3aae2">mapgendata::south</a></div><div class="ttdeci">const oter_id &amp; south() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00201">mapgendata.h:201</a></div></div>
<div class="ttc" id="aclassmapgendata_html_ac629cfa2439709898c4cb1b2f5946e44"><div class="ttname"><a href="classmapgendata.html#ac629cfa2439709898c4cb1b2f5946e44">mapgendata::swest</a></div><div class="ttdeci">const oter_id &amp; swest() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00213">mapgendata.h:213</a></div></div>
<div class="ttc" id="aclassmapgendata_html_ad4feab749e2ffdc8192a282e92b22679"><div class="ttname"><a href="classmapgendata.html#ad4feab749e2ffdc8192a282e92b22679">mapgendata::nwest</a></div><div class="ttdeci">const oter_id &amp; nwest() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00216">mapgendata.h:216</a></div></div>
<div class="ttc" id="aclassmapgendata_html_ad6b2ee9260b740a0a6e7309f247461c2"><div class="ttname"><a href="classmapgendata.html#ad6b2ee9260b740a0a6e7309f247461c2">mapgendata::east</a></div><div class="ttdeci">const oter_id &amp; east() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00198">mapgendata.h:198</a></div></div>
<div class="ttc" id="aclassmapgendata_html_aedd4dfcadcd552678e0da25788952122"><div class="ttname"><a href="classmapgendata.html#aedd4dfcadcd552678e0da25788952122">mapgendata::west</a></div><div class="ttdeci">const oter_id &amp; west() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00204">mapgendata.h:204</a></div></div>
<div class="ttc" id="aclassmapgendata_html_af9c8749f33060b01bccec09cf66f0631"><div class="ttname"><a href="classmapgendata.html#af9c8749f33060b01bccec09cf66f0631">mapgendata::seast</a></div><div class="ttdeci">const oter_id &amp; seast() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8h_source.html#l00210">mapgendata.h:210</a></div></div>
<div class="ttc" id="aclassstring__id_html_a1b2100ed077789ba45aaf5081791b36c"><div class="ttname"><a href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">string_id&lt; ter_t &gt;::NULL_ID</a></div><div class="ttdeci">static const string_id&lt; ter_t &gt; &amp; NULL_ID()</div><div class="ttdoc">Returns a null id whose string_id&lt;T&gt;::is_null() must always return true.</div></div>
<div class="ttc" id="aclassstring__id_html_aa3cde2bfb58efa9621289c0a70d24c5a"><div class="ttname"><a href="classstring__id.html#aa3cde2bfb58efa9621289c0a70d24c5a">string_id::id</a></div><div class="ttdeci">int_id&lt; T &gt; id() const</div><div class="ttdoc">Translate the string based it to the matching integer based id.</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00054">ammo_effect.cpp:54</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a31847b31c6ef002e9d16afd7fd0005e3"><div class="ttname"><a href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a></div><div class="ttdeci">std::vector&lt; coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &amp;&amp;RhsInBounds &gt; &gt; line_to(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00798">coordinates.h:798</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a3daf91bb096de1a1a004b1668a3ee53b"><div class="ttname"><a href="coordinates_8h.html#a3daf91bb096de1a1a004b1668a3ee53b">midpoint</a></div><div class="ttdeci">coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &amp;&amp;RhsInBounds &gt; midpoint(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00813">coordinates.h:813</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a560abf1cd341e88e2f13f454ec2ecc99"><div class="ttname"><a href="coordinates_8h.html#a560abf1cd341e88e2f13f454ec2ecc99">closest_points_first</a></div><div class="ttdeci">std::vector&lt; coords::coord_point&lt; Point, Origin, Scale &gt; &gt; closest_points_first(const coords::coord_point&lt; Point, Origin, Scale &gt; &amp;loc, int min_dist, int max_dist)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00848">coordinates.h:848</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a8e2cbab6dac12095f06b4cff66857fbb"><div class="ttname"><a href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a></div><div class="ttdeci">int rl_dist(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00769">coordinates.h:769</a></div></div>
<div class="ttc" id="acreature_8h_html_ac54f8023b2f6c4c85f60252cf47cc28d"><div class="ttname"><a href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a></div><div class="ttdeci">bodypart_id bp</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00238">creature.h:238</a></div></div>
<div class="ttc" id="amapgen_8cpp_html_ae8b9b565ea11e5c8e001c687c7133811"><div class="ttname"><a href="mapgen_8cpp.html#ae8b9b565ea11e5c8e001c687c7133811">run_mapgen_func</a></div><div class="ttdeci">bool run_mapgen_func(const std::string &amp;mapgen_id, mapgendata &amp;dat)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l08050">mapgen.cpp:8050</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a1bb505fdd896ac7af2b4119bd6c8a69a"><div class="ttname"><a href="mapgen__functions_8cpp.html#a1bb505fdd896ac7af2b4119bd6c8a69a">oter_river_center</a></div><div class="ttdeci">static const oter_str_id oter_river_center(&quot;river_center&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a636bd6f4127c7232559e88f63ec2f86d"><div class="ttname"><a href="mapgen__functions_8cpp.html#a636bd6f4127c7232559e88f63ec2f86d">ter_t_water_sh</a></div><div class="ttdeci">static const ter_str_id ter_t_water_sh(&quot;t_water_sh&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_af6c40bc0b28ed4a025fc4141b5499887"><div class="ttname"><a href="mapgen__functions_8cpp.html#af6c40bc0b28ed4a025fc4141b5499887">ter_t_water_dp</a></div><div class="ttdeci">static const ter_str_id ter_t_water_dp(&quot;t_water_dp&quot;)</div></div>
<div class="ttc" id="anamespaceff_html_a19eb008b6f3397b3fcfb01914b1be6c1"><div class="ttname"><a href="namespaceff.html#a19eb008b6f3397b3fcfb01914b1be6c1">ff::point_flood_fill_4_connected</a></div><div class="ttdeci">std::vector&lt; Point &gt; point_flood_fill_4_connected(const Point &amp;starting_point, std::unordered_set&lt; Point &gt; &amp;visited, UnaryPredicate predicate)</div><div class="ttdoc">Given a starting point, flood fill out to the 4-connected points, applying the provided predicate to ...</div><div class="ttdef"><b>Definition:</b> <a href="flood__fill_8h_source.html#l00026">flood_fill.h:26</a></div></div>
<div class="ttc" id="anamespacemusic_html_a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0"><div class="ttname"><a href="namespacemusic.html#a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0">music::mp3</a></div><div class="ttdeci">@ mp3</div><div class="ttdef"><b>Definition:</b> <a href="music_8h_source.html#l00011">music.h:11</a></div></div>
<div class="ttc" id="aovermap_8cpp_html_aa1967e14c4ef0be6b81c5405dae79281"><div class="ttname"><a href="overmap_8cpp.html#aa1967e14c4ef0be6b81c5405dae79281">is_ot_match</a></div><div class="ttdeci">bool is_ot_match(const std::string &amp;name, const oter_id &amp;oter, const ot_match_type match_type)</div><div class="ttdoc">Determine if the provided name is a match with the provided overmap terrain based on the specified ma...</div><div class="ttdef"><b>Definition:</b> <a href="overmap_8cpp_source.html#l00594">overmap.cpp:594</a></div></div>
<div class="ttc" id="astructinclusive__rectangle_html"><div class="ttname"><a href="structinclusive__rectangle.html">inclusive_rectangle&lt; point &gt;</a></div></div>
<div class="ttc" id="astructoter__t_html_a5c4aa1d93a0e1ddbd6fe8be77631ddbe"><div class="ttname"><a href="structoter__t.html#a5c4aa1d93a0e1ddbd6fe8be77631ddbe">oter_t::is_lake</a></div><div class="ttdeci">bool is_lake() const</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00423">omdata.h:423</a></div></div>
<div class="ttc" id="astructoter__t_html_a84cc529cda04022d6b73cb2aa0ac39a1"><div class="ttname"><a href="structoter__t.html#a84cc529cda04022d6b73cb2aa0ac39a1">oter_t::is_river</a></div><div class="ttdeci">bool is_river() const</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00409">omdata.h:409</a></div></div>
<div class="ttc" id="astructoter__t_html_adb17be308671c9a4603a4e2e005e7b9d"><div class="ttname"><a href="structoter__t.html#adb17be308671c9a4603a4e2e005e7b9d">oter_t::is_lake_shore</a></div><div class="ttdeci">bool is_lake_shore() const</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00427">omdata.h:427</a></div></div>
<div class="ttc" id="astructovermap__lake__settings_html_a540e356b80469076dbf4cda69d03ccb4"><div class="ttname"><a href="structovermap__lake__settings.html#a540e356b80469076dbf4cda69d03ccb4">overmap_lake_settings::shore_extendable_overmap_terrain_aliases</a></div><div class="ttdeci">std::vector&lt; shore_extendable_overmap_terrain_alias &gt; shore_extendable_overmap_terrain_aliases</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00208">regional_settings.h:208</a></div></div>
<div class="ttc" id="astructovermap__lake__settings_html_a7645168dff87b72ed0f06b070a38d6e7"><div class="ttname"><a href="structovermap__lake__settings.html#a7645168dff87b72ed0f06b070a38d6e7">overmap_lake_settings::shore_extendable_overmap_terrain</a></div><div class="ttdeci">std::vector&lt; oter_id &gt; shore_extendable_overmap_terrain</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00207">regional_settings.h:207</a></div></div>
<div class="ttc" id="astructregional__settings_html_a73bbc9611b377c0cde485049614832db"><div class="ttname"><a href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">regional_settings::overmap_lake</a></div><div class="ttdeci">overmap_lake_settings overmap_lake</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00287">regional_settings.h:287</a></div></div>
<div class="ttc" id="astructshore__extendable__overmap__terrain__alias_html"><div class="ttname"><a href="structshore__extendable__overmap__terrain__alias.html">shore_extendable_overmap_terrain_alias</a></div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00196">regional_settings.h:196</a></div></div>
<div class="ttc" id="astructshore__extendable__overmap__terrain__alias_html_a062f722019a340016cff54fb20b4b54d"><div class="ttname"><a href="structshore__extendable__overmap__terrain__alias.html#a062f722019a340016cff54fb20b4b54d">shore_extendable_overmap_terrain_alias::match_type</a></div><div class="ttdeci">ot_match_type match_type</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00198">regional_settings.h:198</a></div></div>
<div class="ttc" id="astructshore__extendable__overmap__terrain__alias_html_aaefacbfb63b47f8e47f710af2c7f6171"><div class="ttname"><a href="structshore__extendable__overmap__terrain__alias.html#aaefacbfb63b47f8e47f710af2c7f6171">shore_extendable_overmap_terrain_alias::alias</a></div><div class="ttdeci">oter_str_id alias</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00199">regional_settings.h:199</a></div></div>
<div class="ttc" id="astructshore__extendable__overmap__terrain__alias_html_ab969bed63d3506cedb5419508093fd72"><div class="ttname"><a href="structshore__extendable__overmap__terrain__alias.html#ab969bed63d3506cedb5419508093fd72">shore_extendable_overmap_terrain_alias::overmap_terrain</a></div><div class="ttdeci">std::string overmap_terrain</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00197">regional_settings.h:197</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="regional__settings_8h_source.html#l00199">shore_extendable_overmap_terrain_alias::alias</a>, <a class="el" href="creature_8h_source.html#l00238">bp</a>, <a class="el" href="coordinates_8h_source.html#l00848">closest_points_first()</a>, <a class="el" href="mapgendata_8h_source.html#l00198">mapgendata::east()</a>, <a class="el" href="input_8h_source.html#l00095">keycode::end</a>, <a class="el" href="mapgendata_8cpp_source.html#l00226">mapgendata::fill_groundcover()</a>, <a class="el" href="map_8cpp_source.html#l01743">map::furn_set()</a>, <a class="el" href="map_8cpp_source.html#l05030">map::i_clear()</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00033">int_id&lt; T &gt;::id()</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00054">string_id&lt; T &gt;::id()</a>, <a class="el" href="omdata_8h_source.html#l00423">oter_t::is_lake()</a>, <a class="el" href="omdata_8h_source.html#l00427">oter_t::is_lake_shore()</a>, <a class="el" href="overmap_8cpp_source.html#l00594">is_ot_match()</a>, <a class="el" href="omdata_8h_source.html#l00409">oter_t::is_river()</a>, <a class="el" href="coordinates_8h_source.html#l00798">line_to()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00683">mapgen_forest()</a>, <a class="el" href="regional__settings_8h_source.html#l00198">shore_extendable_overmap_terrain_alias::match_type</a>, <a class="el" href="coordinates_8h_source.html#l00813">midpoint()</a>, <a class="el" href="music_8h_source.html#l00011">music::mp3</a>, <a class="el" href="mapgendata_8h_source.html#l00207">mapgendata::neast()</a>, <a class="el" href="mapgendata_8h_source.html#l00195">mapgendata::north()</a>, <a class="el" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">string_id&lt; ter_t &gt;::NULL_ID()</a>, <a class="el" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">string_id&lt; furn_t &gt;::NULL_ID()</a>, <a class="el" href="mapgendata_8h_source.html#l00216">mapgendata::nwest()</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00026">int_id&lt; T &gt;::obj()</a>, <a class="el" href="mapgen__functions_8cpp.html#a1bb505fdd896ac7af2b4119bd6c8a69a">oter_river_center</a>, <a class="el" href="regional__settings_8h_source.html#l00287">regional_settings::overmap_lake</a>, <a class="el" href="regional__settings_8h_source.html#l00197">shore_extendable_overmap_terrain_alias::overmap_terrain</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>, <a class="el" href="flood__fill_8h_source.html#l00026">ff::point_flood_fill_4_connected()</a>, <a class="el" href="mapgendata_8h_source.html#l00130">mapgendata::region</a>, <a class="el" href="coordinates_8h_source.html#l00769">rl_dist()</a>, <a class="el" href="calendar_8cpp_source.html#l00779">rng()</a>, <a class="el" href="mapgen_8cpp_source.html#l08050">run_mapgen_func()</a>, <a class="el" href="mapgendata_8h_source.html#l00210">mapgendata::seast()</a>, <a class="el" href="game__constants_8h_source.html#l00042">SEEX</a>, <a class="el" href="game__constants_8h_source.html#l00043">SEEY</a>, <a class="el" href="regional__settings_8h_source.html#l00207">overmap_lake_settings::shore_extendable_overmap_terrain</a>, <a class="el" href="regional__settings_8h_source.html#l00208">overmap_lake_settings::shore_extendable_overmap_terrain_aliases</a>, <a class="el" href="mapgendata_8h_source.html#l00201">mapgendata::south()</a>, <a class="el" href="mapgendata_8h_source.html#l00213">mapgendata::swest()</a>, <a class="el" href="mapgendata_8h_source.html#l00114">mapgendata::t_nesw</a>, <a class="el" href="map_8cpp_source.html#l01922">map::ter()</a>, <a class="el" href="map_8cpp_source.html#l02226">map::ter_set()</a>, <a class="el" href="mapgen__functions_8cpp.html#af6c40bc0b28ed4a025fc4141b5499887">ter_t_water_dp</a>, <a class="el" href="mapgen__functions_8cpp.html#a636bd6f4127c7232559e88f63ec2f86d">ter_t_water_sh</a>, <a class="el" href="map_8cpp_source.html#l04751">map::translate()</a>, <a class="el" href="mapgendata_8h_source.html#l00204">mapgendata::west()</a>, <a class="el" href="point_8h_source.html#l00023">point::x</a>, and <a class="el" href="point_8h_source.html#l00024">point::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>.</p>

</div>
</div>
<a id="a77592a40715f66ad7064925d5ec46cec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77592a40715f66ad7064925d5ec46cec">&#9670;&nbsp;</a></span>mapgen_ocean_shore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_ocean_shore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l01604">1604</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;{</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <a class="code" href="classmap.html">map</a> *<span class="keyword">const</span> m = &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="comment">// This is the same as lake shore but saltier.</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">// Read documetation above</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordtype">bool</span> did_extend_adjacent_terrain = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordflow">if</span>( !dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a7645168dff87b72ed0f06b070a38d6e7">shore_extendable_overmap_terrain</a>.empty() ) {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        std::map&lt;oter_id, int&gt; adjacent_type_count;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="classint__id.html">oter_id</a> &amp;adjacent : dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a> ) {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            <span class="comment">// Define the terrain we&#39;ll look for a match on.</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            <a class="code" href="classint__id.html">oter_id</a> match = adjacent;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="comment">// Check if this terrain has an alias to something we actually will extend, and if so, use it.</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="comment">// for now, these are the same as lake. They may need to be changed eventually.</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structshore__extendable__overmap__terrain__alias.html">shore_extendable_overmap_terrain_alias</a> &amp;alias :</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                 dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a540e356b80469076dbf4cda69d03ccb4">shore_extendable_overmap_terrain_aliases</a> ) {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="overmap_8cpp.html#aa1967e14c4ef0be6b81c5405dae79281">is_ot_match</a>( alias.<a class="code" href="structshore__extendable__overmap__terrain__alias.html#ab969bed63d3506cedb5419508093fd72">overmap_terrain</a>, adjacent, alias.<a class="code" href="structshore__extendable__overmap__terrain__alias.html#a062f722019a340016cff54fb20b4b54d">match_type</a> ) ) {</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                    match = alias.<a class="code" href="structshore__extendable__overmap__terrain__alias.html#aaefacbfb63b47f8e47f710af2c7f6171">alias</a>;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            <span class="keywordflow">if</span>( std::find( dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a7645168dff87b72ed0f06b070a38d6e7">shore_extendable_overmap_terrain</a>.begin(),</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                           dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a7645168dff87b72ed0f06b070a38d6e7">shore_extendable_overmap_terrain</a>.end(),</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                           match ) != dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73bbc9611b377c0cde485049614832db">overmap_lake</a>.<a class="code" href="structovermap__lake__settings.html#a7645168dff87b72ed0f06b070a38d6e7">shore_extendable_overmap_terrain</a>.end() ) {</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                adjacent_type_count[match] += 1;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            }</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordflow">if</span>( !adjacent_type_count.empty() ) {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> most_common_adjacent = std::max_element( std::begin( adjacent_type_count ),</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                                              <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">std::end</a>( adjacent_type_count ), []( <span class="keyword">const</span> std::pair&lt;oter_id, int&gt; &amp;p1,</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            <span class="keyword">const</span> std::pair&lt;oter_id, int&gt; &amp;p2 ) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                <span class="keywordflow">return</span> p1.second &lt; p2.second;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            } );</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            <a class="code" href="classmapgendata.html">mapgendata</a> forest_mapgen_dat( dat, most_common_adjacent-&gt;first );</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <a class="code" href="mapgen__functions_8cpp.html#acb4c2c9ab474f9f0076b44b63b279702">mapgen_forest</a>( forest_mapgen_dat );</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            did_extend_adjacent_terrain = <a class="code" href="mapgen_8cpp.html#ae8b9b565ea11e5c8e001c687c7133811">run_mapgen_func</a>( most_common_adjacent-&gt;first.id().str(),</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                                          forest_mapgen_dat );</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160; </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;            <span class="comment">// One fun side effect of running another mapgen here is that it may have placed items in locations</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            <span class="comment">// that we&#39;re later going to turn into water. Let&#39;s just remove all items.</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            <span class="keywordflow">if</span>( did_extend_adjacent_terrain ) {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; x++ ) {</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> y = 0; y &lt; <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2; y++ ) {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                        m-&gt;<a class="code" href="classmap.html#a9b1c092685c43287d5db23156f3f337e">i_clear</a>( <a class="code" href="structpoint.html">point</a>( x, y ) );</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                    }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                }</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            }</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="comment">// If we didn&#39;t extend an adjacent terrain, then just fill this entire location with the default</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">// groundcover for the region.</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">if</span>( !did_extend_adjacent_terrain ) {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        dat.<a class="code" href="classmapgendata.html#a6f10a37ad3dfd21c36ce4526ee7d4054">fill_groundcover</a>();</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    }</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> river_center = <a class="code" href="mapgen__functions_8cpp.html#a1bb505fdd896ac7af2b4119bd6c8a69a">oter_river_center</a>.<a class="code" href="classstring__id.html#aa3cde2bfb58efa9621289c0a70d24c5a">id</a>();</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; </div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keyword">auto</span> <a class="code" href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a> = [&amp;]( <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> &amp; <a class="code" href="classint__id.html#a09d4f824b2540da7e682d10cdf324081">id</a> ) {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <span class="comment">// We want to consider river_center as well.</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">id</span>.obj().is_ocean() || <span class="keywordtype">id</span> == river_center;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    };</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160; </div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> is_shore = [&amp;]( <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> &amp; <a class="code" href="classint__id.html#a09d4f824b2540da7e682d10cdf324081">id</a> ) {</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">id</span>.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structoter__t.html#ac5cb06f9de495f3d3bf6496b26514ea7">is_ocean_shore</a>();</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    };</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> is_river_bank = [&amp;]( <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> &amp; <a class="code" href="classint__id.html#a09d4f824b2540da7e682d10cdf324081">id</a> ) {</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">id</span> != river_center &amp;&amp; <span class="keywordtype">id</span>.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structoter__t.html#a84cc529cda04022d6b73cb2aa0ac39a1">is_river</a>();</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    };</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span>  n_ocean  = <a class="code" href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a>( dat.<a class="code" href="classmapgendata.html#a77f8d2160aa8085cd3290c76a1cbc006">north</a>() );</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span>  e_ocean  = <a class="code" href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a>( dat.<a class="code" href="classmapgendata.html#ad6b2ee9260b740a0a6e7309f247461c2">east</a>() );</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span>  s_ocean  = <a class="code" href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a>( dat.<a class="code" href="classmapgendata.html#ac5b6942a9bd85224bb92dd7ba7c3aae2">south</a>() );</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span>  w_ocean  = <a class="code" href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a>( dat.<a class="code" href="classmapgendata.html#aedd4dfcadcd552678e0da25788952122">west</a>() );</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> nw_ocean = <a class="code" href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a>( dat.<a class="code" href="classmapgendata.html#ad4feab749e2ffdc8192a282e92b22679">nwest</a>() );</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> ne_ocean = <a class="code" href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a>( dat.<a class="code" href="classmapgendata.html#a4865c3c00376457470d1d4c989c79fb4">neast</a>() );</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> se_ocean = <a class="code" href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a>( dat.<a class="code" href="classmapgendata.html#af9c8749f33060b01bccec09cf66f0631">seast</a>() );</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> sw_ocean = <a class="code" href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a>( dat.<a class="code" href="classmapgendata.html#ac629cfa2439709898c4cb1b2f5946e44">swest</a>() );</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">// If we don&#39;t have any adjacent ocean, then we don&#39;t need to worry about a shoreline,</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="comment">// and are done at this point.</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> no_adjacent_water = !n_ocean &amp;&amp; !e_ocean &amp;&amp; !s_ocean &amp;&amp; !w_ocean &amp;&amp; !nw_ocean &amp;&amp;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                                   !ne_ocean &amp;&amp;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                                   !se_ocean &amp;&amp; !sw_ocean;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordflow">if</span>( no_adjacent_water ) {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160; </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="comment">// See detail above in lake version</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> n_shore = is_shore( dat.<a class="code" href="classmapgendata.html#a77f8d2160aa8085cd3290c76a1cbc006">north</a>() );</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> e_shore = is_shore( dat.<a class="code" href="classmapgendata.html#ad6b2ee9260b740a0a6e7309f247461c2">east</a>() );</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> s_shore = is_shore( dat.<a class="code" href="classmapgendata.html#ac5b6942a9bd85224bb92dd7ba7c3aae2">south</a>() );</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> w_shore = is_shore( dat.<a class="code" href="classmapgendata.html#aedd4dfcadcd552678e0da25788952122">west</a>() );</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; </div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> n_river_bank = is_river_bank( dat.<a class="code" href="classmapgendata.html#a77f8d2160aa8085cd3290c76a1cbc006">north</a>() );</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> e_river_bank = is_river_bank( dat.<a class="code" href="classmapgendata.html#ad6b2ee9260b740a0a6e7309f247461c2">east</a>() );</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> s_river_bank = is_river_bank( dat.<a class="code" href="classmapgendata.html#ac5b6942a9bd85224bb92dd7ba7c3aae2">south</a>() );</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> w_river_bank = is_river_bank( dat.<a class="code" href="classmapgendata.html#aedd4dfcadcd552678e0da25788952122">west</a>() );</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="comment">// This is length we end up pushing things about by as a baseline.</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> sector_length = <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> - 1;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="comment">// Define the corners of the map. These won&#39;t change.</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structpoint.html">point</a> nw_corner{};</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structpoint.html">point</a> ne_corner( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1, 0 );</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structpoint.html">point</a> se_corner( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1, <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - 1 );</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structpoint.html">point</a> sw_corner( 0, <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - 1 );</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="comment">// Define the four points that make up our polygon that we&#39;ll later pull line segments from for</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="comment">// the actual shoreline.</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <a class="code" href="structpoint.html">point</a> nw = nw_corner;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <a class="code" href="structpoint.html">point</a> ne = ne_corner;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <a class="code" href="structpoint.html">point</a> se = se_corner;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <a class="code" href="structpoint.html">point</a> sw = sw_corner;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    std::vector&lt;std::vector&lt;point&gt;&gt; line_segments;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordtype">int</span> ns_direction_adjust = 0;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordtype">int</span> ew_direction_adjust = 0;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordtype">int</span> sand_margin = dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a16924917b27fd59cfd7138087f4640c4">overmap_ocean</a>.<a class="code" href="structovermap__ocean__settings.html#a8bc37e6aae676719bda690000c4b2cf7">sandy_beach_width</a> / 2;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="comment">// This section is about pushing the straight N, S, E, or W borders inward when adjacent to an actual ocean.</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordflow">if</span>( n_ocean ) {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        nw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        ne.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160; </div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordflow">if</span>( s_ocean ) {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        sw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        se.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">if</span>( w_ocean ) {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        nw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        sw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160; </div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="keywordflow">if</span>( e_ocean ) {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        ne.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        se.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="keywordflow">if</span>( n_river_bank ) {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <span class="keywordflow">if</span>( w_ocean &amp;&amp; nw_ocean ) {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;            nw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        }</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        <span class="keywordflow">if</span>( e_ocean &amp;&amp; ne_ocean ) {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;            ne.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        }</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160; </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordflow">if</span>( e_river_bank ) {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <span class="keywordflow">if</span>( s_ocean &amp;&amp; se_ocean ) {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            se.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        }</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160; </div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        <span class="keywordflow">if</span>( n_ocean &amp;&amp; ne_ocean ) {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            ne.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    }</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">if</span>( s_river_bank ) {</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        <span class="keywordflow">if</span>( w_ocean &amp;&amp; sw_ocean ) {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            sw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        }</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160; </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <span class="keywordflow">if</span>( e_ocean &amp;&amp; se_ocean ) {</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            se.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        }</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    }</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">if</span>( w_river_bank ) {</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        <span class="keywordflow">if</span>( s_ocean &amp;&amp; sw_ocean ) {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            sw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <span class="keywordflow">if</span>( n_ocean &amp;&amp; nw_ocean ) {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            nw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keywordflow">if</span>( nw_ocean ) {</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        <span class="keywordflow">if</span>( n_ocean &amp;&amp; w_ocean ) {</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            nw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length / 2;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            nw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length / 2;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( n_shore || n_river_bank ) &amp;&amp; ( w_shore || w_river_bank ) ) {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            <a class="code" href="structpoint.html">point</a> n = nw_corner;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            <a class="code" href="structpoint.html">point</a> w = nw_corner;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            n.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length * ( n_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            w.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length * ( w_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            n.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += n_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            w.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += w_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160; </div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            <span class="keywordflow">if</span>( w_river_bank ) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                line_segments.push_back( { sw, w } );</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                ns_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                ew_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            }</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="keywordflow">if</span>( n_river_bank ) {</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                line_segments.push_back( { n, ne } );</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                ns_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                ew_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            }</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            line_segments.push_back( { n, w } );</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            ns_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            ew_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        }</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    }</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">if</span>( ne_ocean ) {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordflow">if</span>( n_ocean &amp;&amp; e_ocean ) {</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            ne.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length / 2;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            ne.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length / 2;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( n_shore || n_river_bank ) &amp;&amp; ( e_shore || e_river_bank ) ) {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            <a class="code" href="structpoint.html">point</a> n = ne_corner;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            <a class="code" href="structpoint.html">point</a> e = ne_corner;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160; </div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            n.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length * ( n_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            e.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += sector_length * ( e_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            n.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += n_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            e.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= e_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160; </div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            <span class="keywordflow">if</span>( e_river_bank ) {</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                line_segments.push_back( { se, e } );</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                ns_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                ew_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            <span class="keywordflow">if</span>( n_river_bank ) {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                line_segments.push_back( { n, nw } );</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                ns_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                ew_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            line_segments.push_back( { n, e } );</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            ns_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            ew_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        }</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">if</span>( sw_ocean ) {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordflow">if</span>( s_ocean &amp;&amp; w_ocean ) {</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            sw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length / 2;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            sw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length / 2;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( s_shore || s_river_bank ) &amp;&amp; ( w_shore || w_river_bank ) ) {</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;            <a class="code" href="structpoint.html">point</a> s = sw_corner;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            <a class="code" href="structpoint.html">point</a> w = sw_corner;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            s.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += sector_length * ( s_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            w.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length * ( w_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            s.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= s_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            w.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += w_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            <span class="keywordflow">if</span>( w_river_bank ) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                line_segments.push_back( { nw, w } );</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                ns_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                ew_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            <span class="keywordflow">if</span>( s_river_bank ) {</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                line_segments.push_back( { s, se } );</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                ns_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                ew_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;            }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            line_segments.push_back( { s, w } );</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            ns_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            ew_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        }</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    }</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="keywordflow">if</span>( se_ocean ) {</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        <span class="keywordflow">if</span>( s_ocean &amp;&amp; e_ocean ) {</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            se.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length / 2;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            se.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length / 2;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ( s_shore || s_river_bank ) &amp;&amp; ( e_shore || e_river_bank ) ) {</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            <a class="code" href="structpoint.html">point</a> s = se_corner;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;            <a class="code" href="structpoint.html">point</a> e = se_corner;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            s.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= sector_length * ( s_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            e.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= sector_length * ( e_river_bank ? 2 : 1 );</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;            s.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> -= s_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            e.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> -= e_river_bank ? sector_length / 2 : 0;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160; </div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            <span class="keywordflow">if</span>( e_river_bank ) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                line_segments.push_back( { ne, e } );</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                ns_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                ew_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;            <span class="keywordflow">if</span>( s_river_bank ) {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                line_segments.push_back( { s, sw } );</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                ns_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                ew_direction_adjust -= sand_margin;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;            }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;            line_segments.push_back( { s, e } );</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            ns_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;            ew_direction_adjust += sand_margin;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        }</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    }</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160; </div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="comment">// Ok, all of the fiddling with the polygon corners is done.</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="comment">// At this point we&#39;ve got four points that make up four line segments that started out</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="comment">// at the map boundaries, but have subsequently been perturbed by the adjacent terrains.</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="comment">// Let&#39;s look at them and see which ones differ from their original state and should</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="comment">// form our shoreline.</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; </div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">if</span>( nw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != nw_corner.y || ne.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != ne_corner.y ) {</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        ns_direction_adjust -= sand_margin * 2;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        line_segments.push_back( { nw, ne } );</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    }</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="keywordflow">if</span>( ne.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != ne_corner.x || se.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != se_corner.x ) {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        ew_direction_adjust += sand_margin * 2;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        line_segments.push_back( { ne, se } );</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    }</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="keywordflow">if</span>( se.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != se_corner.y || sw.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != sw_corner.y ) {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        ns_direction_adjust += sand_margin * 2;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        line_segments.push_back( { se, sw } );</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    }</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160; </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keywordflow">if</span>( sw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != sw_corner.x || nw.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != nw_corner.x ) {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        ew_direction_adjust -= sand_margin * 2;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        line_segments.push_back( { sw, nw } );</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    }</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keyword">static</span> constexpr <a class="code" href="structinclusive__rectangle.html">inclusive_rectangle&lt;point&gt;</a> map_boundaries( nw_corner, se_corner );</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; </div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="comment">// This will draw our shallow water coastline from the &quot;from&quot; point to the &quot;to&quot; point.</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <span class="comment">// It buffers the points a bit for a thicker line. It also clears any furniture that might</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="comment">// be in the location as a result of our extending adjacent mapgen.</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> draw_shallow_water = [&amp;]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; from, <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; to ) {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <a class="code" href="structpoint.html">point</a> from_mod = from;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <a class="code" href="structpoint.html">point</a> to_mod = to;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        <span class="keywordflow">if</span>( from.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != 0 &amp;&amp; from.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> != <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1 ) {</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;            from_mod.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += ew_direction_adjust;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        }</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">if</span>( from.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != 0 &amp;&amp; from.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> != <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1 ) {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            from_mod.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += ns_direction_adjust;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <span class="keywordflow">if</span>( to.x != 0 &amp;&amp; to.x != <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1 ) {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            to_mod.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> += ew_direction_adjust;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        <span class="keywordflow">if</span>( to.y != 0 &amp;&amp; to.y != <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1 ) {</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            to_mod.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> += ns_direction_adjust;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        std::vector&lt;point&gt; points = <a class="code" href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a>( from_mod, to_mod );</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="structpoint.html">point</a> &amp;p : points ) {</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;<a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> : <a class="code" href="coordinates_8h.html#a560abf1cd341e88e2f13f454ec2ecc99">closest_points_first</a>( p, sand_margin ) ) {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                <span class="keywordflow">if</span>( !map_boundaries.contains( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> ) ) {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a>, <a class="code" href="mapgen__functions_8cpp.html#af9572ad0e586784329a08d370b0791fd">ter_t_swater_sh</a> );</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                m-&gt;<a class="code" href="classmap.html#a410a8dcd3e1ee0e87da584bf878d6f83">furn_set</a>( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a>, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() );</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    };</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="comment">// This will draw our sandy beach coastline from the &quot;from&quot; point to the &quot;to&quot; point.</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> draw_sand = [&amp;]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; from, <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; to ) {</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        std::vector&lt;point&gt; points = <a class="code" href="coordinates_8h.html#a31847b31c6ef002e9d16afd7fd0005e3">line_to</a>( from, to );</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="structpoint.html">point</a> &amp;p : points ) {</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;<a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> : <a class="code" href="coordinates_8h.html#a560abf1cd341e88e2f13f454ec2ecc99">closest_points_first</a>( p, sand_margin ) ) {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                <span class="keywordflow">if</span>( !map_boundaries.contains( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> ) ) {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                }</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                <span class="comment">// Use t_null for now instead of t_sand, because sometimes our extended terrain</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                <span class="comment">// has put down a t_sand, and we need to be able to flood-fill over that.</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a>, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>() );</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                m-&gt;<a class="code" href="classmap.html#a410a8dcd3e1ee0e87da584bf878d6f83">furn_set</a>( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a>, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() );</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;<a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> : <a class="code" href="coordinates_8h.html#a560abf1cd341e88e2f13f454ec2ecc99">closest_points_first</a>( p, sand_margin + 1 ) ) {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                <span class="keywordflow">if</span>( !map_boundaries.contains( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> ) ) {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                }</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                <span class="keywordflow">if</span>( m-&gt;<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a> ) == <a class="code" href="mapgen__functions_8cpp.html#af9572ad0e586784329a08d370b0791fd">ter_t_swater_sh</a> ) {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                    m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="creature_8h.html#ac54f8023b2f6c4c85f60252cf47cc28d">bp</a>, <a class="code" href="mapgen__functions_8cpp.html#a7e01f9a852c43d17e67474c5e0728191">ter_t_swater_surf</a> );</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                }</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    };</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">// Given two points, return a point that is midway between the two points and then</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="comment">// jittered by a random amount in proportion to the length of the line segment.</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> jittered_midpoint = [&amp;]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; from, <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; to ) {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> jitter = <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( from, to ) / 5;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> <a class="code" href="coordinates_8h.html#a3daf91bb096de1a1a004b1668a3ee53b">midpoint</a>( ( from.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> + to.x ) / 2 + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -jitter, jitter ),</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                              ( from.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> + to.y ) / 2 + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -jitter, jitter ) );</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="coordinates_8h.html#a3daf91bb096de1a1a004b1668a3ee53b">midpoint</a>;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    };</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160; </div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="comment">// For each of our valid shoreline line segments, generate a slightly more interesting</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="comment">// set of line segments by splitting the line into four segments with jittered</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="comment">// midpoints.</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="comment">// Draw water after the sand to make sure we don&#39;t get too much sand.  Everyone hates sand,</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="comment">// it&#39;s coarse and - you know what, never mind.</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;ls : line_segments ) {</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> mp1 = jittered_midpoint( ls[0], ls[1] );</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> mp2 = jittered_midpoint( ls[0], mp1 );</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> <a class="code" href="namespacemusic.html#a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0">mp3</a> = jittered_midpoint( mp1, ls[1] );</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        draw_shallow_water( ls[0], mp2 );</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        draw_shallow_water( mp2, mp1 );</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        draw_shallow_water( mp1, <a class="code" href="namespacemusic.html#a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0">mp3</a> );</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        draw_shallow_water( <a class="code" href="namespacemusic.html#a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0">mp3</a>, ls[1] );</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        draw_sand( ls[0], mp2 );</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        draw_sand( mp2, mp1 );</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        draw_sand( mp1, <a class="code" href="namespacemusic.html#a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0">mp3</a> );</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        draw_sand( <a class="code" href="namespacemusic.html#a9c32fc77ff4a8513eb6beec268d48e12ae63a134939869944941b8ece8b4cb3c0">mp3</a>, ls[1] );</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    }</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160; </div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="comment">// Now that we&#39;ve done our ground mapgen and laid down a contiguous shoreline of shallow water,</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="comment">// we&#39;ll floodfill the sections adjacent to the ocean with deep water. As before, we also clear</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="comment">// out any furniture that we placed by the extended mapgen.</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    std::unordered_set&lt;point&gt; visited;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> should_fill = [&amp;]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; p ) {</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        <span class="keywordflow">if</span>( !map_boundaries.contains( p ) ) {</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        }</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        <span class="keywordflow">return</span> m-&gt;<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( p ) != <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>() &amp;&amp; m-&gt;<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( p ) != <a class="code" href="mapgen__functions_8cpp.html#af9572ad0e586784329a08d370b0791fd">ter_t_swater_sh</a>  &amp;&amp;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;               m-&gt;<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( p ) != <a class="code" href="mapgen__functions_8cpp.html#a7e01f9a852c43d17e67474c5e0728191">ter_t_swater_surf</a>;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    };</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> fill_deep_water = [&amp;]( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp; starting_point ) {</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        std::vector&lt;point&gt; water_points = <a class="code" href="namespaceff.html#a19eb008b6f3397b3fcfb01914b1be6c1">ff::point_flood_fill_4_connected</a>( starting_point, visited,</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                                          should_fill );</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="structpoint.html">point</a> &amp;wp : water_points ) {</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( wp, <a class="code" href="mapgen__functions_8cpp.html#a789ade9dc8f6e04d9156c11440a4bf1c">ter_t_swater_dp</a> );</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;            m-&gt;<a class="code" href="classmap.html#a410a8dcd3e1ee0e87da584bf878d6f83">furn_set</a>( wp, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() );</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        }</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    };</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="comment">// We&#39;ll flood fill from the four corners, using the corner if any of the locations</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="comment">// adjacent to it were a ocean.</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">if</span>( n_ocean || nw_ocean || w_ocean ) {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        fill_deep_water( nw_corner );</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160; </div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">if</span>( s_ocean || sw_ocean || w_ocean ) {</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        fill_deep_water( sw_corner );</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    }</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; </div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="keywordflow">if</span>( n_ocean || ne_ocean || e_ocean ) {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        fill_deep_water( ne_corner );</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    }</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160; </div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    <span class="keywordflow">if</span>( s_ocean || se_ocean || e_ocean ) {</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        fill_deep_water( se_corner );</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="comment">// We previously placed our sand but actually did a t_null instead to make sure that we didn&#39;t</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="comment">// pick up sand from our extended terrain. Now turn those nulls into t_sand.</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    m-&gt;<a class="code" href="classmap.html#a16c42a0494cf948a154567bc43571f90">translate</a>( <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>(), <a class="code" href="mapgen__functions_8cpp.html#aa97140c8aea2d1d10175fc60f47ff47c">ter_t_sand</a> );</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;}</div>
<div class="ttc" id="amapgen__functions_8cpp_html_a789ade9dc8f6e04d9156c11440a4bf1c"><div class="ttname"><a href="mapgen__functions_8cpp.html#a789ade9dc8f6e04d9156c11440a4bf1c">ter_t_swater_dp</a></div><div class="ttdeci">static const ter_str_id ter_t_swater_dp(&quot;t_swater_dp&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a7e01f9a852c43d17e67474c5e0728191"><div class="ttname"><a href="mapgen__functions_8cpp.html#a7e01f9a852c43d17e67474c5e0728191">ter_t_swater_surf</a></div><div class="ttdeci">static const ter_str_id ter_t_swater_surf(&quot;t_swater_surf&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_af9572ad0e586784329a08d370b0791fd"><div class="ttname"><a href="mapgen__functions_8cpp.html#af9572ad0e586784329a08d370b0791fd">ter_t_swater_sh</a></div><div class="ttdeci">static const ter_str_id ter_t_swater_sh(&quot;t_swater_sh&quot;)</div></div>
<div class="ttc" id="aovermap_8cpp_html_a075cb8698779c2a87733379e669479ef"><div class="ttname"><a href="overmap_8cpp.html#a075cb8698779c2a87733379e669479ef">is_ocean</a></div><div class="ttdeci">bool is_ocean(const oter_id &amp;ter)</div><div class="ttdef"><b>Definition:</b> <a href="overmap_8cpp_source.html#l00589">overmap.cpp:589</a></div></div>
<div class="ttc" id="astructoter__t_html_ac5cb06f9de495f3d3bf6496b26514ea7"><div class="ttname"><a href="structoter__t.html#ac5cb06f9de495f3d3bf6496b26514ea7">oter_t::is_ocean_shore</a></div><div class="ttdeci">bool is_ocean_shore() const</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00435">omdata.h:435</a></div></div>
<div class="ttc" id="astructovermap__ocean__settings_html_a8bc37e6aae676719bda690000c4b2cf7"><div class="ttname"><a href="structovermap__ocean__settings.html#a8bc37e6aae676719bda690000c4b2cf7">overmap_ocean_settings::sandy_beach_width</a></div><div class="ttdeci">int sandy_beach_width</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00222">regional_settings.h:222</a></div></div>
<div class="ttc" id="astructregional__settings_html_a16924917b27fd59cfd7138087f4640c4"><div class="ttname"><a href="structregional__settings.html#a16924917b27fd59cfd7138087f4640c4">regional_settings::overmap_ocean</a></div><div class="ttdeci">overmap_ocean_settings overmap_ocean</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00288">regional_settings.h:288</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="regional__settings_8h_source.html#l00199">shore_extendable_overmap_terrain_alias::alias</a>, <a class="el" href="creature_8h_source.html#l00238">bp</a>, <a class="el" href="coordinates_8h_source.html#l00848">closest_points_first()</a>, <a class="el" href="mapgendata_8h_source.html#l00198">mapgendata::east()</a>, <a class="el" href="input_8h_source.html#l00095">keycode::end</a>, <a class="el" href="mapgendata_8cpp_source.html#l00226">mapgendata::fill_groundcover()</a>, <a class="el" href="map_8cpp_source.html#l01743">map::furn_set()</a>, <a class="el" href="map_8cpp_source.html#l05030">map::i_clear()</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00033">int_id&lt; T &gt;::id()</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00054">string_id&lt; T &gt;::id()</a>, <a class="el" href="overmap_8cpp_source.html#l00589">is_ocean()</a>, <a class="el" href="omdata_8h_source.html#l00435">oter_t::is_ocean_shore()</a>, <a class="el" href="overmap_8cpp_source.html#l00594">is_ot_match()</a>, <a class="el" href="omdata_8h_source.html#l00409">oter_t::is_river()</a>, <a class="el" href="coordinates_8h_source.html#l00798">line_to()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00683">mapgen_forest()</a>, <a class="el" href="regional__settings_8h_source.html#l00198">shore_extendable_overmap_terrain_alias::match_type</a>, <a class="el" href="coordinates_8h_source.html#l00813">midpoint()</a>, <a class="el" href="music_8h_source.html#l00011">music::mp3</a>, <a class="el" href="mapgendata_8h_source.html#l00207">mapgendata::neast()</a>, <a class="el" href="mapgendata_8h_source.html#l00195">mapgendata::north()</a>, <a class="el" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">string_id&lt; ter_t &gt;::NULL_ID()</a>, <a class="el" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">string_id&lt; furn_t &gt;::NULL_ID()</a>, <a class="el" href="mapgendata_8h_source.html#l00216">mapgendata::nwest()</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00026">int_id&lt; T &gt;::obj()</a>, <a class="el" href="mapgen__functions_8cpp.html#a1bb505fdd896ac7af2b4119bd6c8a69a">oter_river_center</a>, <a class="el" href="regional__settings_8h_source.html#l00287">regional_settings::overmap_lake</a>, <a class="el" href="regional__settings_8h_source.html#l00288">regional_settings::overmap_ocean</a>, <a class="el" href="regional__settings_8h_source.html#l00197">shore_extendable_overmap_terrain_alias::overmap_terrain</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>, <a class="el" href="flood__fill_8h_source.html#l00026">ff::point_flood_fill_4_connected()</a>, <a class="el" href="mapgendata_8h_source.html#l00130">mapgendata::region</a>, <a class="el" href="coordinates_8h_source.html#l00769">rl_dist()</a>, <a class="el" href="calendar_8cpp_source.html#l00779">rng()</a>, <a class="el" href="mapgen_8cpp_source.html#l08050">run_mapgen_func()</a>, <a class="el" href="regional__settings_8h_source.html#l00222">overmap_ocean_settings::sandy_beach_width</a>, <a class="el" href="mapgendata_8h_source.html#l00210">mapgendata::seast()</a>, <a class="el" href="game__constants_8h_source.html#l00042">SEEX</a>, <a class="el" href="game__constants_8h_source.html#l00043">SEEY</a>, <a class="el" href="regional__settings_8h_source.html#l00207">overmap_lake_settings::shore_extendable_overmap_terrain</a>, <a class="el" href="regional__settings_8h_source.html#l00208">overmap_lake_settings::shore_extendable_overmap_terrain_aliases</a>, <a class="el" href="mapgendata_8h_source.html#l00201">mapgendata::south()</a>, <a class="el" href="mapgendata_8h_source.html#l00213">mapgendata::swest()</a>, <a class="el" href="mapgendata_8h_source.html#l00114">mapgendata::t_nesw</a>, <a class="el" href="map_8cpp_source.html#l01922">map::ter()</a>, <a class="el" href="map_8cpp_source.html#l02226">map::ter_set()</a>, <a class="el" href="mapgen__functions_8cpp.html#aa97140c8aea2d1d10175fc60f47ff47c">ter_t_sand</a>, <a class="el" href="mapgen__functions_8cpp.html#a789ade9dc8f6e04d9156c11440a4bf1c">ter_t_swater_dp</a>, <a class="el" href="mapgen__functions_8cpp.html#af9572ad0e586784329a08d370b0791fd">ter_t_swater_sh</a>, <a class="el" href="mapgen__functions_8cpp.html#a7e01f9a852c43d17e67474c5e0728191">ter_t_swater_surf</a>, <a class="el" href="map_8cpp_source.html#l04751">map::translate()</a>, <a class="el" href="mapgendata_8h_source.html#l00204">mapgendata::west()</a>, <a class="el" href="point_8h_source.html#l00023">point::x</a>, and <a class="el" href="point_8h_source.html#l00024">point::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>.</p>

</div>
</div>
<a id="a2ef253441ce417e2f2c708fdfa47ccb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ef253441ce417e2f2c708fdfa47ccb5">&#9670;&nbsp;</a></span>mapgen_ravine_edge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_ravine_edge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l02070">2070</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;{</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <a class="code" href="classmap.html">map</a> *<span class="keyword">const</span> m = &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="comment">// A solid chunk of z layer appropriate wall or floor is first generated to carve the cliffside off from</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() == 0 ) {</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        dat.<a class="code" href="classmapgendata.html#a6f10a37ad3dfd21c36ce4526ee7d4054">fill_groundcover</a>();</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <a class="code" href="mapgen_8cpp.html#ae8b9b565ea11e5c8e001c687c7133811">run_mapgen_func</a>( dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a819dc946a27048f1a9b6dc8697545832">default_oter</a>[ <a class="code" href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a> + dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() ].id()-&gt;get_mapgen_id(),</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                         dat );</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    }</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> is_ravine = [&amp;]( <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> &amp; <a class="code" href="classint__id.html#a09d4f824b2540da7e682d10cdf324081">id</a> ) {</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">id</span>.obj().is_ravine();</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    };</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> is_ravine_edge = [&amp;]( <span class="keyword">const</span> <a class="code" href="classint__id.html">oter_id</a> &amp; <a class="code" href="classint__id.html#a09d4f824b2540da7e682d10cdf324081">id</a> ) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">id</span>.obj().is_ravine_edge();</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    };</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="comment">// Since this terrain is directionless, we look at its immediate neighbors to determine whether a straight</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="comment">// or curved ravine edge should be generated. And to then apply the correct rotation.</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> n_ravine  = is_ravine( dat.<a class="code" href="classmapgendata.html#a77f8d2160aa8085cd3290c76a1cbc006">north</a>() );</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> e_ravine  = is_ravine( dat.<a class="code" href="classmapgendata.html#ad6b2ee9260b740a0a6e7309f247461c2">east</a>() );</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> s_ravine  = is_ravine( dat.<a class="code" href="classmapgendata.html#ac5b6942a9bd85224bb92dd7ba7c3aae2">south</a>() );</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> w_ravine  = is_ravine( dat.<a class="code" href="classmapgendata.html#aedd4dfcadcd552678e0da25788952122">west</a>() );</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> nw_ravine = is_ravine( dat.<a class="code" href="classmapgendata.html#ad4feab749e2ffdc8192a282e92b22679">nwest</a>() );</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> ne_ravine = is_ravine( dat.<a class="code" href="classmapgendata.html#a4865c3c00376457470d1d4c989c79fb4">neast</a>() );</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> se_ravine = is_ravine( dat.<a class="code" href="classmapgendata.html#af9c8749f33060b01bccec09cf66f0631">seast</a>() );</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> n_ravine_edge = is_ravine_edge( dat.<a class="code" href="classmapgendata.html#a77f8d2160aa8085cd3290c76a1cbc006">north</a>() );</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> e_ravine_edge = is_ravine_edge( dat.<a class="code" href="classmapgendata.html#ad6b2ee9260b740a0a6e7309f247461c2">east</a>() );</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> s_ravine_edge = is_ravine_edge( dat.<a class="code" href="classmapgendata.html#ac5b6942a9bd85224bb92dd7ba7c3aae2">south</a>() );</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> w_ravine_edge = is_ravine_edge( dat.<a class="code" href="classmapgendata.html#aedd4dfcadcd552678e0da25788952122">west</a>() );</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> any_orthogonal_ravine = [&amp;]() {</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <span class="keywordflow">return</span> n_ravine || s_ravine || w_ravine || e_ravine;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    };</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160; </div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> straight = ( ( n_ravine_edge &amp;&amp; s_ravine_edge ) || ( e_ravine_edge &amp;&amp;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                            w_ravine_edge ) ) &amp;&amp; any_orthogonal_ravine();</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> interior_corner = !straight &amp;&amp; !any_orthogonal_ravine();</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> exterior_corner = !straight &amp;&amp; any_orthogonal_ravine();</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="comment">//With that done, we generate the maps.</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keywordflow">if</span>( straight ) {</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; x++ ) {</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            <span class="keywordtype">int</span> ground_edge = 12 + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 1, 3 );</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>( m, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>(), <a class="code" href="structpoint.html">point</a>( x, ++ground_edge ), <a class="code" href="structpoint.html">point</a>( x, <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() );</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        <span class="keywordflow">if</span>( w_ravine ) {</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 1 );</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        }</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        <span class="keywordflow">if</span>( n_ravine ) {</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 2 );</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        }</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        <span class="keywordflow">if</span>( e_ravine ) {</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 3 );</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        }</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( interior_corner ) {</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; x++ ) {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            <span class="keywordtype">int</span> ground_edge = 12 + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 1, 3 ) + x;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>( m, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>(), <a class="code" href="structpoint.html">point</a>( x, ++ground_edge ), <a class="code" href="structpoint.html">point</a>( x, <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() );</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        }</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        <span class="keywordflow">if</span>( nw_ravine ) {</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 1 );</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        <span class="keywordflow">if</span>( ne_ravine ) {</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 2 );</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        <span class="keywordflow">if</span>( se_ravine ) {</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 3 );</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        }</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( exterior_corner ) {</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; x++ ) {</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            <span class="keywordtype">int</span> ground_edge =  12  + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 1, 3 ) - x;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;            <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>( m, <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>(), <a class="code" href="structpoint.html">point</a>( x, --ground_edge ), <a class="code" href="structpoint.html">point</a>( x, <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - 1 ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() );</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        }</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        <span class="keywordflow">if</span>( w_ravine &amp;&amp; s_ravine ) {</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;            m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 1 );</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        }</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        <span class="keywordflow">if</span>( w_ravine &amp;&amp; n_ravine ) {</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;            m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 2 );</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        }</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        <span class="keywordflow">if</span>( e_ravine &amp;&amp; n_ravine ) {</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 3 );</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        }</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="comment">// The placed t_null terrains are converted into the regional groundcover in the ravine&#39;s bottom level,</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="comment">// in the other levels they are converted into open air to generate the cliffside.</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() == dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#acbcb9b43efaa94d2ddecec7bae83337f">overmap_ravine</a>.<a class="code" href="structovermap__ravine__settings.html#ae50867857aa373c811ee62f40dc48720">ravine_depth</a> ) {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        m-&gt;<a class="code" href="classmap.html#a16c42a0494cf948a154567bc43571f90">translate</a>( <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>(), dat.<a class="code" href="classmapgendata.html#a92ab7060627e7a336592cb54d1d01ee8">groundcover</a>() );</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        m-&gt;<a class="code" href="classmap.html#a16c42a0494cf948a154567bc43571f90">translate</a>( <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>(), <a class="code" href="mapgen__functions_8cpp.html#a890df1b49c21f9d28da3859d98e147a3">ter_t_open_air</a> );</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;}</div>
<div class="ttc" id="aclassmap_html_a37268cf3dfc2a32e85a40c2a7266dfc9"><div class="ttname"><a href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">map::rotate</a></div><div class="ttdeci">void rotate(int turns, bool setpos_safe=false)</div><div class="ttdoc">Rotates this map, and all of its contents, by the specified multiple of 90 degrees.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l06948">mapgen.cpp:6948</a></div></div>
<div class="ttc" id="aclassmapgendata_html_a92ab7060627e7a336592cb54d1d01ee8"><div class="ttname"><a href="classmapgendata.html#a92ab7060627e7a336592cb54d1d01ee8">mapgendata::groundcover</a></div><div class="ttdeci">ter_id groundcover() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgendata_8cpp_source.html#l00247">mapgendata.cpp:247</a></div></div>
<div class="ttc" id="agame__constants_8h_html_aad0eacfa516a8f7e005674027d7640fe"><div class="ttname"><a href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a></div><div class="ttdeci">constexpr int OVERMAP_DEPTH</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00073">game_constants.h:73</a></div></div>
<div class="ttc" id="amapgen_8cpp_html_a4f3a5fd278254d867d914ad5953679e2"><div class="ttname"><a href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a></div><div class="ttdeci">void line(map *m, const ter_id &amp;type, const point &amp;p1, const point &amp;p2, int z)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l07721">mapgen.cpp:7721</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a890df1b49c21f9d28da3859d98e147a3"><div class="ttname"><a href="mapgen__functions_8cpp.html#a890df1b49c21f9d28da3859d98e147a3">ter_t_open_air</a></div><div class="ttdeci">static const ter_str_id ter_t_open_air(&quot;t_open_air&quot;)</div></div>
<div class="ttc" id="astructovermap__ravine__settings_html_ae50867857aa373c811ee62f40dc48720"><div class="ttname"><a href="structovermap__ravine__settings.html#ae50867857aa373c811ee62f40dc48720">overmap_ravine_settings::ravine_depth</a></div><div class="ttdeci">int ravine_depth</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00230">regional_settings.h:230</a></div></div>
<div class="ttc" id="astructregional__settings_html_a819dc946a27048f1a9b6dc8697545832"><div class="ttname"><a href="structregional__settings.html#a819dc946a27048f1a9b6dc8697545832">regional_settings::default_oter</a></div><div class="ttdeci">std::array&lt; oter_str_id, OVERMAP_LAYERS &gt; default_oter</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00276">regional_settings.h:276</a></div></div>
<div class="ttc" id="astructregional__settings_html_acbcb9b43efaa94d2ddecec7bae83337f"><div class="ttname"><a href="structregional__settings.html#acbcb9b43efaa94d2ddecec7bae83337f">regional_settings::overmap_ravine</a></div><div class="ttdeci">overmap_ravine_settings overmap_ravine</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00289">regional_settings.h:289</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="regional__settings_8h_source.html#l00276">regional_settings::default_oter</a>, <a class="el" href="mapgendata_8h_source.html#l00198">mapgendata::east()</a>, <a class="el" href="mapgendata_8cpp_source.html#l00226">mapgendata::fill_groundcover()</a>, <a class="el" href="mapgendata_8cpp_source.html#l00247">mapgendata::groundcover()</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00033">int_id&lt; T &gt;::id()</a>, <a class="el" href="mapgen_8cpp_source.html#l07721">line()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="mapgendata_8h_source.html#l00207">mapgendata::neast()</a>, <a class="el" href="mapgendata_8h_source.html#l00195">mapgendata::north()</a>, <a class="el" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">string_id&lt; ter_t &gt;::NULL_ID()</a>, <a class="el" href="mapgendata_8h_source.html#l00216">mapgendata::nwest()</a>, <a class="el" href="game__constants_8h_source.html#l00073">OVERMAP_DEPTH</a>, <a class="el" href="regional__settings_8h_source.html#l00289">regional_settings::overmap_ravine</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>, <a class="el" href="regional__settings_8h_source.html#l00230">overmap_ravine_settings::ravine_depth</a>, <a class="el" href="mapgendata_8h_source.html#l00130">mapgendata::region</a>, <a class="el" href="calendar_8cpp_source.html#l00779">rng()</a>, <a class="el" href="mapgen_8cpp_source.html#l06948">map::rotate()</a>, <a class="el" href="mapgen_8cpp_source.html#l08050">run_mapgen_func()</a>, <a class="el" href="mapgendata_8h_source.html#l00210">mapgendata::seast()</a>, <a class="el" href="game__constants_8h_source.html#l00042">SEEX</a>, <a class="el" href="game__constants_8h_source.html#l00043">SEEY</a>, <a class="el" href="mapgendata_8h_source.html#l00201">mapgendata::south()</a>, <a class="el" href="mapgen__functions_8cpp.html#a890df1b49c21f9d28da3859d98e147a3">ter_t_open_air</a>, <a class="el" href="map_8cpp_source.html#l04751">map::translate()</a>, <a class="el" href="mapgendata_8h_source.html#l00204">mapgendata::west()</a>, and <a class="el" href="mapgendata_8h_source.html#l00184">mapgendata::zlevel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>.</p>

</div>
</div>
<a id="afa918dabddaa2fcbb36f06bf1a8fecd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa918dabddaa2fcbb36f06bf1a8fecd2">&#9670;&nbsp;</a></span>mapgen_river_center()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_river_center </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00561">561</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;{</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="mapgen_8cpp.html#a6a6c1c2cab0b9c4e15ae70232af1ba5d">fill_background</a>( &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>, <a class="code" href="mapgen__functions_8cpp.html#ae3b8ccdea0cbc3481d7a5317f478dab7">ter_t_water_moving_dp</a> );</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div>
<div class="ttc" id="amapgen_8cpp_html_a6a6c1c2cab0b9c4e15ae70232af1ba5d"><div class="ttname"><a href="mapgen_8cpp.html#a6a6c1c2cab0b9c4e15ae70232af1ba5d">fill_background</a></div><div class="ttdeci">void fill_background(map *m, const ter_id &amp;type)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l07737">mapgen.cpp:7737</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_ae3b8ccdea0cbc3481d7a5317f478dab7"><div class="ttname"><a href="mapgen__functions_8cpp.html#ae3b8ccdea0cbc3481d7a5317f478dab7">ter_t_water_moving_dp</a></div><div class="ttdeci">static const ter_str_id ter_t_water_moving_dp(&quot;t_water_moving_dp&quot;)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l07737">fill_background()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, and <a class="el" href="mapgen__functions_8cpp.html#ae3b8ccdea0cbc3481d7a5317f478dab7">ter_t_water_moving_dp</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>.</p>

</div>
</div>
<a id="abc6c2781c3ff3c218aecbb41400bb59f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6c2781c3ff3c218aecbb41400bb59f">&#9670;&nbsp;</a></span>mapgen_river_curved()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_river_curved </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00626">626</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;{</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="classmap.html">map</a> *<span class="keyword">const</span> m = &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="mapgen_8cpp.html#a6a6c1c2cab0b9c4e15ae70232af1ba5d">fill_background</a>( m, <a class="code" href="mapgen__functions_8cpp.html#ae3b8ccdea0cbc3481d7a5317f478dab7">ter_t_water_moving_dp</a> );</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">// NE corner deep, other corners are shallow.  do 2 passes: one x, one y</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; x++ ) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordtype">int</span> ground_edge = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 1, 3 );</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keywordtype">int</span> shallow_edge = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 4, 6 );</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>( m, <a class="code" href="mapgen__functions_8cpp.html#a95520fe8c1789811c051e5ff7458e468">grass_or_dirt</a>(), <a class="code" href="structpoint.html">point</a>( x, 0 ), <a class="code" href="structpoint.html">point</a>( x, ground_edge ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() );</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 25 ) ) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="structpoint.html">point</a>( x, ++ground_edge ), <a class="code" href="mapgen__functions_8cpp.html#a8e631bfc1a2400667a6b63e2a5e3c544">clay_or_sand</a>() );</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>( m, <a class="code" href="mapgen__functions_8cpp.html#af097424b82a24d6919e9739b3e2d25ec">ter_t_water_moving_sh</a>, <a class="code" href="structpoint.html">point</a>( x, ++ground_edge ), <a class="code" href="structpoint.html">point</a>( x, shallow_edge ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() );</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> y = 0; y &lt; <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2; y++ ) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordtype">int</span> ground_edge = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 19, 21 );</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordtype">int</span> shallow_edge = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 16, 18 );</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>( m, <a class="code" href="mapgen__functions_8cpp.html#a95520fe8c1789811c051e5ff7458e468">grass_or_dirt</a>(), <a class="code" href="structpoint.html">point</a>( ground_edge, y ), <a class="code" href="structpoint.html">point</a>( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1, y ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() );</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 25 ) ) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="structpoint.html">point</a>( --ground_edge, y ), <a class="code" href="mapgen__functions_8cpp.html#a8e631bfc1a2400667a6b63e2a5e3c544">clay_or_sand</a>() );</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>( m, <a class="code" href="mapgen__functions_8cpp.html#af097424b82a24d6919e9739b3e2d25ec">ter_t_water_moving_sh</a>, <a class="code" href="structpoint.html">point</a>( shallow_edge, y ), <a class="code" href="structpoint.html">point</a>( --ground_edge, y ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() );</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() == <a class="code" href="mapgen__functions_8cpp.html#a312bee7d057076984f015c2a30fb7bc5">oter_river_se</a> ) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 1 );</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() == <a class="code" href="mapgen__functions_8cpp.html#adba7d8ed529d3400b441be49fa4a2dd7">oter_river_sw</a> ) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 2 );</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() == <a class="code" href="mapgen__functions_8cpp.html#a2d6a432ee816dd48fe3cc8cc8a5cc5fb">oter_river_nw</a> ) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 3 );</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;}</div>
<div class="ttc" id="amapgen__functions_8cpp_html_a2d6a432ee816dd48fe3cc8cc8a5cc5fb"><div class="ttname"><a href="mapgen__functions_8cpp.html#a2d6a432ee816dd48fe3cc8cc8a5cc5fb">oter_river_nw</a></div><div class="ttdeci">static const oter_str_id oter_river_nw(&quot;river_nw&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a312bee7d057076984f015c2a30fb7bc5"><div class="ttname"><a href="mapgen__functions_8cpp.html#a312bee7d057076984f015c2a30fb7bc5">oter_river_se</a></div><div class="ttdeci">static const oter_str_id oter_river_se(&quot;river_se&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a8e631bfc1a2400667a6b63e2a5e3c544"><div class="ttname"><a href="mapgen__functions_8cpp.html#a8e631bfc1a2400667a6b63e2a5e3c544">clay_or_sand</a></div><div class="ttdeci">ter_str_id clay_or_sand()</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00146">mapgen_functions.cpp:146</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a95520fe8c1789811c051e5ff7458e468"><div class="ttname"><a href="mapgen__functions_8cpp.html#a95520fe8c1789811c051e5ff7458e468">grass_or_dirt</a></div><div class="ttdeci">ter_str_id grass_or_dirt()</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00138">mapgen_functions.cpp:138</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_adba7d8ed529d3400b441be49fa4a2dd7"><div class="ttname"><a href="mapgen__functions_8cpp.html#adba7d8ed529d3400b441be49fa4a2dd7">oter_river_sw</a></div><div class="ttdeci">static const oter_str_id oter_river_sw(&quot;river_sw&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_af097424b82a24d6919e9739b3e2d25ec"><div class="ttname"><a href="mapgen__functions_8cpp.html#af097424b82a24d6919e9739b3e2d25ec">ter_t_water_moving_sh</a></div><div class="ttdeci">static const ter_str_id ter_t_water_moving_sh(&quot;t_water_moving_sh&quot;)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen__functions_8cpp_source.html#l00146">clay_or_sand()</a>, <a class="el" href="mapgen_8cpp_source.html#l07737">fill_background()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00138">grass_or_dirt()</a>, <a class="el" href="mapgen_8cpp_source.html#l07721">line()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="rng_8cpp_source.html#l00108">one_in()</a>, <a class="el" href="mapgen__functions_8cpp.html#a2d6a432ee816dd48fe3cc8cc8a5cc5fb">oter_river_nw</a>, <a class="el" href="mapgen__functions_8cpp.html#a312bee7d057076984f015c2a30fb7bc5">oter_river_se</a>, <a class="el" href="mapgen__functions_8cpp.html#adba7d8ed529d3400b441be49fa4a2dd7">oter_river_sw</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>, <a class="el" href="calendar_8cpp_source.html#l00779">rng()</a>, <a class="el" href="mapgen_8cpp_source.html#l06948">map::rotate()</a>, <a class="el" href="game__constants_8h_source.html#l00042">SEEX</a>, <a class="el" href="game__constants_8h_source.html#l00043">SEEY</a>, <a class="el" href="map_8cpp_source.html#l02226">map::ter_set()</a>, <a class="el" href="mapgen__functions_8cpp.html#ae3b8ccdea0cbc3481d7a5317f478dab7">ter_t_water_moving_dp</a>, <a class="el" href="mapgen__functions_8cpp.html#af097424b82a24d6919e9739b3e2d25ec">ter_t_water_moving_sh</a>, <a class="el" href="mapgendata_8h_source.html#l00172">mapgendata::terrain_type()</a>, and <a class="el" href="mapgendata_8h_source.html#l00184">mapgendata::zlevel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>.</p>

</div>
</div>
<a id="a87774fae3295ac0f5b165215dee6bfdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87774fae3295ac0f5b165215dee6bfdd">&#9670;&nbsp;</a></span>mapgen_river_curved_not()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_river_curved_not </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00566">566</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;{</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <a class="code" href="classmap.html">map</a> *<span class="keyword">const</span> m = &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="mapgen_8cpp.html#a6a6c1c2cab0b9c4e15ae70232af1ba5d">fill_background</a>( m, <a class="code" href="mapgen__functions_8cpp.html#ae3b8ccdea0cbc3481d7a5317f478dab7">ter_t_water_moving_dp</a> );</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// this is not_ne, so deep on all sides except ne corner, which is shallow</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">// shallow is 20,0, 23,4</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordtype">int</span> north_edge = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 16, 18 );</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordtype">int</span> east_edge = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 4, 8 );</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = north_edge; x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; x++ ) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> y = 0; y &lt; east_edge; y++ ) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordtype">int</span> circle_edge = ( ( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - x ) * ( <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - x ) ) + ( y * y );</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="keywordflow">if</span>( circle_edge &lt;= 8 ) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="structpoint.html">point</a>( x, y ), <a class="code" href="mapgen__functions_8cpp.html#a95520fe8c1789811c051e5ff7458e468">grass_or_dirt</a>() );</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="keywordflow">if</span>( circle_edge == 9 &amp;&amp; <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 25 ) ) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="structpoint.html">point</a>( x, y ), <a class="code" href="mapgen__functions_8cpp.html#a8e631bfc1a2400667a6b63e2a5e3c544">clay_or_sand</a>() );</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( circle_edge &lt;= 36 ) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="structpoint.html">point</a>( x, y ), <a class="code" href="mapgen__functions_8cpp.html#af097424b82a24d6919e9739b3e2d25ec">ter_t_water_moving_sh</a> );</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() == <a class="code" href="mapgen__functions_8cpp.html#ac65bf400a20ab8fcfd180953fa1bfbe9">oter_river_c_not_se</a> ) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 1 );</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() == <a class="code" href="mapgen__functions_8cpp.html#a31016f9d492cc2ce68098795c7036d21">oter_river_c_not_sw</a> ) {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 2 );</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() == <a class="code" href="mapgen__functions_8cpp.html#aae905086f900644dd691273de06eabe0">oter_river_c_not_nw</a> ) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 3 );</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;}</div>
<div class="ttc" id="amapgen__functions_8cpp_html_a31016f9d492cc2ce68098795c7036d21"><div class="ttname"><a href="mapgen__functions_8cpp.html#a31016f9d492cc2ce68098795c7036d21">oter_river_c_not_sw</a></div><div class="ttdeci">static const oter_str_id oter_river_c_not_sw(&quot;river_c_not_sw&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_aae905086f900644dd691273de06eabe0"><div class="ttname"><a href="mapgen__functions_8cpp.html#aae905086f900644dd691273de06eabe0">oter_river_c_not_nw</a></div><div class="ttdeci">static const oter_str_id oter_river_c_not_nw(&quot;river_c_not_nw&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_ac65bf400a20ab8fcfd180953fa1bfbe9"><div class="ttname"><a href="mapgen__functions_8cpp.html#ac65bf400a20ab8fcfd180953fa1bfbe9">oter_river_c_not_se</a></div><div class="ttdeci">static const oter_str_id oter_river_c_not_se(&quot;river_c_not_se&quot;)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen__functions_8cpp_source.html#l00146">clay_or_sand()</a>, <a class="el" href="mapgen_8cpp_source.html#l07737">fill_background()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00138">grass_or_dirt()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="rng_8cpp_source.html#l00108">one_in()</a>, <a class="el" href="mapgen__functions_8cpp.html#aae905086f900644dd691273de06eabe0">oter_river_c_not_nw</a>, <a class="el" href="mapgen__functions_8cpp.html#ac65bf400a20ab8fcfd180953fa1bfbe9">oter_river_c_not_se</a>, <a class="el" href="mapgen__functions_8cpp.html#a31016f9d492cc2ce68098795c7036d21">oter_river_c_not_sw</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>, <a class="el" href="calendar_8cpp_source.html#l00779">rng()</a>, <a class="el" href="mapgen_8cpp_source.html#l06948">map::rotate()</a>, <a class="el" href="game__constants_8h_source.html#l00042">SEEX</a>, <a class="el" href="map_8cpp_source.html#l02226">map::ter_set()</a>, <a class="el" href="mapgen__functions_8cpp.html#ae3b8ccdea0cbc3481d7a5317f478dab7">ter_t_water_moving_dp</a>, <a class="el" href="mapgen__functions_8cpp.html#af097424b82a24d6919e9739b3e2d25ec">ter_t_water_moving_sh</a>, and <a class="el" href="mapgendata_8h_source.html#l00172">mapgendata::terrain_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>.</p>

</div>
</div>
<a id="a6e34d4074d63b3fa672567dd4d372fb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e34d4074d63b3fa672567dd4d372fb2">&#9670;&nbsp;</a></span>mapgen_river_straight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_river_straight </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00600">600</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;{</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <a class="code" href="classmap.html">map</a> *<span class="keyword">const</span> m = &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <a class="code" href="mapgen_8cpp.html#a6a6c1c2cab0b9c4e15ae70232af1ba5d">fill_background</a>( m, <a class="code" href="mapgen__functions_8cpp.html#ae3b8ccdea0cbc3481d7a5317f478dab7">ter_t_water_moving_dp</a> );</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; x++ ) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordtype">int</span> ground_edge = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 1, 3 );</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordtype">int</span> shallow_edge = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 4, 6 );</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>( m, <a class="code" href="mapgen__functions_8cpp.html#a95520fe8c1789811c051e5ff7458e468">grass_or_dirt</a>(), <a class="code" href="structpoint.html">point</a>( x, 0 ), <a class="code" href="structpoint.html">point</a>( x, ground_edge ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() );</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 25 ) ) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="structpoint.html">point</a>( x, ++ground_edge ), <a class="code" href="mapgen__functions_8cpp.html#a8e631bfc1a2400667a6b63e2a5e3c544">clay_or_sand</a>() );</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <a class="code" href="mapgen_8cpp.html#a4f3a5fd278254d867d914ad5953679e2">line</a>( m, <a class="code" href="mapgen__functions_8cpp.html#af097424b82a24d6919e9739b3e2d25ec">ter_t_water_moving_sh</a>, <a class="code" href="structpoint.html">point</a>( x, ++ground_edge ), <a class="code" href="structpoint.html">point</a>( x, shallow_edge ), dat.<a class="code" href="classmapgendata.html#a8b23644fccfcc73e7f06a6fc3cb61d3f">zlevel</a>() );</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() == <a class="code" href="mapgen__functions_8cpp.html#a9cc7bb895224c783ed6ba8767f5240f7">oter_river_east</a> ) {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 1 );</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() == <a class="code" href="mapgen__functions_8cpp.html#a9240de1efd2f0344db734b8ab487e6d9">oter_river_south</a> ) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 2 );</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>() == <a class="code" href="mapgen__functions_8cpp.html#af524b90f1c1f98378450b52effdba4a5">oter_river_west</a> ) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( 3 );</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;}</div>
<div class="ttc" id="amapgen__functions_8cpp_html_a9240de1efd2f0344db734b8ab487e6d9"><div class="ttname"><a href="mapgen__functions_8cpp.html#a9240de1efd2f0344db734b8ab487e6d9">oter_river_south</a></div><div class="ttdeci">static const oter_str_id oter_river_south(&quot;river_south&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a9cc7bb895224c783ed6ba8767f5240f7"><div class="ttname"><a href="mapgen__functions_8cpp.html#a9cc7bb895224c783ed6ba8767f5240f7">oter_river_east</a></div><div class="ttdeci">static const oter_str_id oter_river_east(&quot;river_east&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_af524b90f1c1f98378450b52effdba4a5"><div class="ttname"><a href="mapgen__functions_8cpp.html#af524b90f1c1f98378450b52effdba4a5">oter_river_west</a></div><div class="ttdeci">static const oter_str_id oter_river_west(&quot;river_west&quot;)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen__functions_8cpp_source.html#l00146">clay_or_sand()</a>, <a class="el" href="mapgen_8cpp_source.html#l07737">fill_background()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00138">grass_or_dirt()</a>, <a class="el" href="mapgen_8cpp_source.html#l07721">line()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="rng_8cpp_source.html#l00108">one_in()</a>, <a class="el" href="mapgen__functions_8cpp.html#a9cc7bb895224c783ed6ba8767f5240f7">oter_river_east</a>, <a class="el" href="mapgen__functions_8cpp.html#a9240de1efd2f0344db734b8ab487e6d9">oter_river_south</a>, <a class="el" href="mapgen__functions_8cpp.html#af524b90f1c1f98378450b52effdba4a5">oter_river_west</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>, <a class="el" href="calendar_8cpp_source.html#l00779">rng()</a>, <a class="el" href="mapgen_8cpp_source.html#l06948">map::rotate()</a>, <a class="el" href="game__constants_8h_source.html#l00042">SEEX</a>, <a class="el" href="map_8cpp_source.html#l02226">map::ter_set()</a>, <a class="el" href="mapgen__functions_8cpp.html#ae3b8ccdea0cbc3481d7a5317f478dab7">ter_t_water_moving_dp</a>, <a class="el" href="mapgen__functions_8cpp.html#af097424b82a24d6919e9739b3e2d25ec">ter_t_water_moving_sh</a>, <a class="el" href="mapgendata_8h_source.html#l00172">mapgendata::terrain_type()</a>, and <a class="el" href="mapgendata_8h_source.html#l00184">mapgendata::zlevel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>.</p>

</div>
</div>
<a id="ac71e1e72a0d703b77f39f4375450b27a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac71e1e72a0d703b77f39f4375450b27a">&#9670;&nbsp;</a></span>mapgen_rock_partial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_rock_partial </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00661">661</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="classmap.html">map</a> *<span class="keyword">const</span> m = &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="mapgen_8cpp.html#a6a6c1c2cab0b9c4e15ae70232af1ba5d">fill_background</a>( m, <a class="code" href="mapgen__functions_8cpp.html#aeee647df1decb170ca7434caf7c83bcb">ter_t_rock</a> );</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 4; i++ ) {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a>[i] == <a class="code" href="mapgen__functions_8cpp.html#ad9a73277b7bffdaf7466ad1538e577e0">oter_slimepit</a> || dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a>[i] == <a class="code" href="mapgen__functions_8cpp.html#ad213be7b64e8e8f1fb3fc5b95b33d915">oter_slimepit_down</a> ) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            dat.<a class="code" href="classmapgendata.html#a144323497893ffc2d1279e3c7ff47f64">dir</a>( i ) = 6;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            dat.<a class="code" href="classmapgendata.html#a144323497893ffc2d1279e3c7ff47f64">dir</a>( i ) = 0;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2; i++ ) {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2; j++ ) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, dat.<a class="code" href="classmapgendata.html#ae0820543796bc3c1db0bd582cc2d5743">n_fac</a> ) &gt; j || <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, dat.<a class="code" href="classmapgendata.html#a92f91552ebe7d57b72249428b168afdc">s_fac</a> ) &gt; <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - 1 - j ||</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, dat.<a class="code" href="classmapgendata.html#a16e876c44700029fc57964f06faed843">w_fac</a> ) &gt; i || <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, dat.<a class="code" href="classmapgendata.html#a17b51f75810c137564192069a2926e86">e_fac</a> ) &gt; <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1 - i ) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                m-&gt;<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( <a class="code" href="structpoint.html">point</a>( i, j ), <a class="code" href="mapgen__functions_8cpp.html#aac746a69fccdce55c55a9fe973501393">ter_t_rock_floor</a> );</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;}</div>
<div class="ttc" id="amapgen__functions_8cpp_html_aac746a69fccdce55c55a9fe973501393"><div class="ttname"><a href="mapgen__functions_8cpp.html#aac746a69fccdce55c55a9fe973501393">ter_t_rock_floor</a></div><div class="ttdeci">static const ter_str_id ter_t_rock_floor(&quot;t_rock_floor&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_ad213be7b64e8e8f1fb3fc5b95b33d915"><div class="ttname"><a href="mapgen__functions_8cpp.html#ad213be7b64e8e8f1fb3fc5b95b33d915">oter_slimepit_down</a></div><div class="ttdeci">static const oter_str_id oter_slimepit_down(&quot;slimepit_down&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_ad9a73277b7bffdaf7466ad1538e577e0"><div class="ttname"><a href="mapgen__functions_8cpp.html#ad9a73277b7bffdaf7466ad1538e577e0">oter_slimepit</a></div><div class="ttdeci">static const oter_str_id oter_slimepit(&quot;slimepit&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_aeee647df1decb170ca7434caf7c83bcb"><div class="ttname"><a href="mapgen__functions_8cpp.html#aeee647df1decb170ca7434caf7c83bcb">ter_t_rock</a></div><div class="ttdeci">static const ter_str_id ter_t_rock(&quot;t_rock&quot;)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgendata_8cpp_source.html#l00195">mapgendata::dir()</a>, <a class="el" href="mapgendata_8h_source.html#l00117">mapgendata::e_fac</a>, <a class="el" href="mapgen_8cpp_source.html#l07737">fill_background()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="mapgendata_8h_source.html#l00116">mapgendata::n_fac</a>, <a class="el" href="mapgen__functions_8cpp.html#ad9a73277b7bffdaf7466ad1538e577e0">oter_slimepit</a>, <a class="el" href="mapgen__functions_8cpp.html#ad213be7b64e8e8f1fb3fc5b95b33d915">oter_slimepit_down</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>, <a class="el" href="calendar_8cpp_source.html#l00779">rng()</a>, <a class="el" href="mapgendata_8h_source.html#l00118">mapgendata::s_fac</a>, <a class="el" href="game__constants_8h_source.html#l00042">SEEX</a>, <a class="el" href="game__constants_8h_source.html#l00043">SEEY</a>, <a class="el" href="mapgendata_8h_source.html#l00114">mapgendata::t_nesw</a>, <a class="el" href="map_8cpp_source.html#l02226">map::ter_set()</a>, <a class="el" href="mapgen__functions_8cpp.html#aeee647df1decb170ca7434caf7c83bcb">ter_t_rock</a>, <a class="el" href="mapgen__functions_8cpp.html#aac746a69fccdce55c55a9fe973501393">ter_t_rock_floor</a>, and <a class="el" href="mapgendata_8h_source.html#l00119">mapgendata::w_fac</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>.</p>

</div>
</div>
<a id="adb62dfd957ef2cc7dca9e1d74facc88a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb62dfd957ef2cc7dca9e1d74facc88a">&#9670;&nbsp;</a></span>mapgen_subway()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_subway </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00197">197</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="classmap.html">map</a> *<span class="keyword">const</span> m = &amp;dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// start by filling the whole map with grass/dirt/etc</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    dat.<a class="code" href="classmapgendata.html#a6f10a37ad3dfd21c36ce4526ee7d4054">fill_groundcover</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// which of the cardinal directions get subway?</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    std::array&lt;bool, 4&gt; subway_nesw = {};</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">int</span> num_dirs = <a class="code" href="mapgen__functions_8cpp.html#a146716d39d89c98b5df834873f3d38a2">terrain_type_to_nesw_array</a>( dat.<a class="code" href="classmapgendata.html#a64e9d6458060cfff6881553dcfb68bf5">terrain_type</a>(), subway_nesw );</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// N E S W</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dir = 0; dir &lt; 4; dir++ ) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a>[dir]-&gt;has_flag( <a class="code" href="omdata_8h.html#ac214d1ec2c5c346a2ba8d8805839d08dadd856e0db491c8764a855dc9eb123021">oter_flags::subway_connection</a> ) &amp;&amp; !subway_nesw[dir] ) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            num_dirs++;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            subway_nesw[dir] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// which way should our subway curve, based on neighbor subway?</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    std::array&lt;int, 4&gt; curvedir_nesw = {};</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// N E S W</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dir = 0; dir &lt; 4; dir++ ) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">if</span>( !subway_nesw[dir] ) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a>[dir]-&gt;get_type_id().str() != <span class="stringliteral">&quot;subway&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            !dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a>[dir]-&gt;has_flag( <a class="code" href="omdata_8h.html#ac214d1ec2c5c346a2ba8d8805839d08dadd856e0db491c8764a855dc9eb123021">oter_flags::subway_connection</a> ) ) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">// n_* contain details about the neighbor being considered</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        std::array&lt;bool, 4&gt; n_subway_nesw = {};</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="comment">// TODO: figure out how to call this function without creating a new oter_id object</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordtype">int</span> n_num_dirs = <a class="code" href="mapgen__functions_8cpp.html#a146716d39d89c98b5df834873f3d38a2">terrain_type_to_nesw_array</a>( dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a>[dir], n_subway_nesw );</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dir = 0; dir &lt; 4; dir++ ) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">if</span>( dat.<a class="code" href="classmapgendata.html#a3564d6b7611cb87409b7c64c01b7a97d">t_nesw</a>[dir]-&gt;has_flag( <a class="code" href="omdata_8h.html#ac214d1ec2c5c346a2ba8d8805839d08dadd856e0db491c8764a855dc9eb123021">oter_flags::subway_connection</a> ) &amp;&amp; !n_subway_nesw[dir] ) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                n_num_dirs++;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                n_subway_nesw[dir] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="comment">// if 2-way neighbor has a subway facing us</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">if</span>( n_num_dirs == 2 &amp;&amp; n_subway_nesw[( dir + 2 ) % 4] ) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="comment">// curve towards the direction the neighbor turns</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="comment">// our subway curves counterclockwise</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">if</span>( n_subway_nesw[( dir - 1 + 4 ) % 4] ) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                curvedir_nesw[dir]--;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="comment">// our subway curves clockwise</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span>( n_subway_nesw[( dir + 1 ) % 4] ) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                curvedir_nesw[dir]++;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// calculate how far to rotate the map so we can work with just one orientation</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// also keep track of diagonal subway</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">int</span> rot = 0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">bool</span> diag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// TODO: reduce amount of logical/conditional constructs here</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">switch</span>( num_dirs ) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="comment">// 4-way intersection</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">// tee</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="comment">// E/S/W, rotate 180 degrees</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">if</span>( !subway_nesw[0] ) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                rot = 2;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="comment">// N/S/W, rotate 270 degrees</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">if</span>( !subway_nesw[1] ) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                rot = 3;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">// N/E/S, rotate  90 degrees</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">if</span>( !subway_nesw[3] ) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                rot = 1;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="comment">// N/E/W, don&#39;t rotate</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="comment">// straight or diagonal</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="comment">// E/W, rotate  90 degrees</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="keywordflow">if</span>( subway_nesw[1] &amp;&amp; subway_nesw[3] ) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                rot = 1;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">// E/S, rotate  90 degrees</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">if</span>( subway_nesw[1] &amp;&amp; subway_nesw[2] ) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                rot = 1;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                diag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="comment">// S/W, rotate 180 degrees</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">if</span>( subway_nesw[2] &amp;&amp; subway_nesw[3] ) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                rot = 2;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                diag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="comment">// W/N, rotate 270 degrees</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">if</span>( subway_nesw[3] &amp;&amp; subway_nesw[0] ) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                rot = 3;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                diag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="comment">// N/E, don&#39;t rotate</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordflow">if</span>( subway_nesw[0] &amp;&amp; subway_nesw[1] ) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                diag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">break</span>;                                                                  <span class="comment">// N/S, don&#39;t rotate</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="comment">// dead end</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="comment">// E, rotate  90 degrees</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">if</span>( subway_nesw[1] ) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                rot = 1;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="comment">// S, rotate 180 degrees</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordflow">if</span>( subway_nesw[2] ) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                rot = 2;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="comment">// W, rotate 270 degrees</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">if</span>( subway_nesw[3] ) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                rot = 3;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="comment">// N, don&#39;t rotate</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// rotate the arrays left by rot steps</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="mapgen__functions_8cpp.html#a05a087b5368e72aff95bb62b38402a91">nesw_array_rotate</a>( subway_nesw, rot );</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="mapgen__functions_8cpp.html#a05a087b5368e72aff95bb62b38402a91">nesw_array_rotate</a>( curvedir_nesw, rot );</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// now we have only these shapes: &#39;   |   &#39;-   -&#39;-   -|-</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">switch</span>( num_dirs ) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="comment">// 4-way intersection</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <a class="code" href="namespacemapf.html#a28eaa6a3088c736e6ccf70c00109651e">mapf::formatted_set_simple</a>( m, <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                        <span class="stringliteral">&quot;..^/D^^/D^....^D/^^D/^..\n&quot;</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                        <span class="stringliteral">&quot;.^/DX^/DX......XD/^XD/^.\n&quot;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                        <span class="stringliteral">&quot;^/D^X/D^X......X^D/X^D/^\n&quot;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                        <span class="stringliteral">&quot;/D^^XD^.X......X.^DX^^D/\n&quot;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                        <span class="stringliteral">&quot;DXXDDXXXXXXXXXXXXXXDDXXD\n&quot;</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                        <span class="stringliteral">&quot;^^/DX^^^X^^^^^^X^^^XD/^^\n&quot;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                        <span class="stringliteral">&quot;^/D^X^^^X^^^^^^X^^^X^D/^\n&quot;</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                        <span class="stringliteral">&quot;/D^^X^^^X^^^^^^X^^^X^^D/\n&quot;</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                        <span class="stringliteral">&quot;DXXXXXXXXXXXXXXXXXXXXXXD\n&quot;</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                        <span class="stringliteral">&quot;^^^^X^^^X^^^^^^X^^^X^^^^\n&quot;</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                        <span class="stringliteral">&quot;^^^^X^^^X^^^^^^X^^^X^^^^\n&quot;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                        <span class="stringliteral">&quot;DXXXXXXXXXXXXXXXXXXXXXXD\n&quot;</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                        <span class="stringliteral">&quot;/D^^X^^^X^^^^^^X^^^X^^D/\n&quot;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                        <span class="stringliteral">&quot;^/D^X^^^X^^^^^^X^^^X^D/^\n&quot;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                        <span class="stringliteral">&quot;^^/DX^^^X^^^^^^X^^^XD/^^\n&quot;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                        <span class="stringliteral">&quot;DXXDDXXXXXXXXXXXXXXDDDDD\n&quot;</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                        <span class="stringliteral">&quot;/D^^XD^.X......X.^DX^^D/\n&quot;</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                        <span class="stringliteral">&quot;^/D^X/D^X......X^D/X^D/^\n&quot;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                        <span class="stringliteral">&quot;.^/DX^/DX......XD/^XD/^.\n&quot;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                        <span class="stringliteral">&quot;..^/D^^/D^....^D/^^D/^..&quot;</span>,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                        <a class="code" href="namespacemapf.html#a01909fd3228e5196be23ef383ac585ae">mapf::ter_bind</a>( <span class="stringliteral">&quot;. # ^ / D X&quot;</span>,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aac746a69fccdce55c55a9fe973501393">ter_t_rock_floor</a>,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aeee647df1decb170ca7434caf7c83bcb">ter_t_rock</a>,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aa6be504da4482ef65dadf38670fd8536">ter_t_railroad_rubble</a>,</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a7f4e37414045ea38805e144f0c65b9c9">ter_t_railroad_tie_d</a>,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a2b1001e2c98f6d01672d44effe359206">ter_t_railroad_track_d</a>,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a60bd1bf2b5e243b4029ecc6d0ad45a77">ter_t_railroad_track</a> ),</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                        <a class="code" href="namespacemapf.html#adffad886fac4b454202b6fe0d8fa8a0f">mapf::furn_bind</a>( <span class="stringliteral">&quot;. # ^ / D X&quot;</span>,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() ) );</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="comment">// tee</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <a class="code" href="namespacemapf.html#a28eaa6a3088c736e6ccf70c00109651e">mapf::formatted_set_simple</a>( m, <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                        <span class="stringliteral">&quot;..^/D^^/D^...^/D^^/D^...\n&quot;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                        <span class="stringliteral">&quot;.^/D^^/D^...^/D^^/D^....\n&quot;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                        <span class="stringliteral">&quot;^/D^^/D^...^/D^^/D^.....\n&quot;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                        <span class="stringliteral">&quot;/D^^/D^^^^^/D^^/D^^^^^^^\n&quot;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                        <span class="stringliteral">&quot;DXXXDXXXXXXDXXXDXXXXXXXX\n&quot;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                        <span class="stringliteral">&quot;^^/D^^^^^^^^^/D^^^^^^^^^\n&quot;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                                        <span class="stringliteral">&quot;^/D^^^^^^^^^/D^^^^^^^^^^\n&quot;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                        <span class="stringliteral">&quot;/D^^^^^^^^^/D^^^^^^^^^^^\n&quot;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                        <span class="stringliteral">&quot;DXXXXXXDXXXDXXXXXXXXXXXX\n&quot;</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                        <span class="stringliteral">&quot;^^^^^/D^^/D^^^^^^^^^^^^^\n&quot;</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                        <span class="stringliteral">&quot;...^/D^^/D^.............\n&quot;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                        <span class="stringliteral">&quot;..^/D^^/D^..............\n&quot;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                        <span class="stringliteral">&quot;.^/D^^/D^...............\n&quot;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                        <span class="stringliteral">&quot;^/D^^/D^................\n&quot;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                        <span class="stringliteral">&quot;/D^^/D^^^^|^^|^^|^^|^^|^\n&quot;</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                        <span class="stringliteral">&quot;DXXXDXXXXXxXXxXXxXXxXXxX\n&quot;</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                        <span class="stringliteral">&quot;^^/D^^^^^^|^^|^^|^^|^^|^\n&quot;</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                        <span class="stringliteral">&quot;^/D^^^^^^^|^^|^^|^^|^^|^\n&quot;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                        <span class="stringliteral">&quot;/D^^^^^^^^|^^|^^|^^|^^|^\n&quot;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                        <span class="stringliteral">&quot;DXXXXXXXXXxXXxXXxXXxXXxX\n&quot;</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                        <span class="stringliteral">&quot;^^^^^^^^^^|^^|^^|^^|^^|^\n&quot;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                        <span class="stringliteral">&quot;........................\n&quot;</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                        <span class="stringliteral">&quot;........................\n&quot;</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                        <span class="stringliteral">&quot;........................&quot;</span>,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                        <a class="code" href="namespacemapf.html#a01909fd3228e5196be23ef383ac585ae">mapf::ter_bind</a>( <span class="stringliteral">&quot;. # ^ | X x / D&quot;</span>,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aac746a69fccdce55c55a9fe973501393">ter_t_rock_floor</a>,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aeee647df1decb170ca7434caf7c83bcb">ter_t_rock</a>,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aa6be504da4482ef65dadf38670fd8536">ter_t_railroad_rubble</a>,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#ae0e9f1a03cf7405258aff98588605c78">ter_t_railroad_tie</a>,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a60bd1bf2b5e243b4029ecc6d0ad45a77">ter_t_railroad_track</a>,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aebb3a0e0c704955010dad05317b036bf">ter_t_railroad_track_on_tie</a>,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a7f4e37414045ea38805e144f0c65b9c9">ter_t_railroad_tie_d</a>,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a2b1001e2c98f6d01672d44effe359206">ter_t_railroad_track_d</a> ),</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                        <a class="code" href="namespacemapf.html#adffad886fac4b454202b6fe0d8fa8a0f">mapf::furn_bind</a>( <span class="stringliteral">&quot;. # ^ | X x / D&quot;</span>,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() ) );</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="comment">// straight or diagonal</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="keywordflow">if</span>( diag ) { <span class="comment">// diagonal subway get drawn differently from all other types</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <a class="code" href="namespacemapf.html#a28eaa6a3088c736e6ccf70c00109651e">mapf::formatted_set_simple</a>( m, <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                            <span class="stringliteral">&quot;...^DD^^DD^...^DD^^DD^..\n&quot;</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                            <span class="stringliteral">&quot;....^DD^^DD^...^DD^^DD^.\n&quot;</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                            <span class="stringliteral">&quot;.....^DD^^DD^...^DD^^DD^\n&quot;</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                            <span class="stringliteral">&quot;......^DD^^DD^...^DD^^DD\n&quot;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                            <span class="stringliteral">&quot;.......^DD^^DD^...^DD^^D\n&quot;</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                            <span class="stringliteral">&quot;#.......^DD^^DD^...^DD^^\n&quot;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                            <span class="stringliteral">&quot;##.......^DD^^DD^...^DD^\n&quot;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                            <span class="stringliteral">&quot;###.......^DD^^DD^...^DD\n&quot;</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                            <span class="stringliteral">&quot;####.......^DD^^DD^...^D\n&quot;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                            <span class="stringliteral">&quot;#####.......^DD^^DD^...^\n&quot;</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                            <span class="stringliteral">&quot;######.......^DD^^DD^...\n&quot;</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                            <span class="stringliteral">&quot;#######.......^DD^^DD^..\n&quot;</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                            <span class="stringliteral">&quot;########.......^DD^^DD^.\n&quot;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                            <span class="stringliteral">&quot;#########.......^DD^^DD^\n&quot;</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                            <span class="stringliteral">&quot;##########.......^DD^^DD\n&quot;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                            <span class="stringliteral">&quot;###########.......^DD^^D\n&quot;</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                            <span class="stringliteral">&quot;############.......^DD^^\n&quot;</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                            <span class="stringliteral">&quot;#############.......^DD^\n&quot;</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                            <span class="stringliteral">&quot;##############.......^DD\n&quot;</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                            <span class="stringliteral">&quot;###############.......^D\n&quot;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                            <span class="stringliteral">&quot;################.......^\n&quot;</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                            <span class="stringliteral">&quot;#################.......\n&quot;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                            <span class="stringliteral">&quot;##################......\n&quot;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                            <span class="stringliteral">&quot;###################.....&quot;</span>,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                            <a class="code" href="namespacemapf.html#a01909fd3228e5196be23ef383ac585ae">mapf::ter_bind</a>( <span class="stringliteral">&quot;. # ^ D&quot;</span>,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#aac746a69fccdce55c55a9fe973501393">ter_t_rock_floor</a>,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#aeee647df1decb170ca7434caf7c83bcb">ter_t_rock</a>,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#aa6be504da4482ef65dadf38670fd8536">ter_t_railroad_rubble</a>,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#a2b1001e2c98f6d01672d44effe359206">ter_t_railroad_track_d</a> ),</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                            <a class="code" href="namespacemapf.html#adffad886fac4b454202b6fe0d8fa8a0f">mapf::furn_bind</a>( <span class="stringliteral">&quot;. # ^ D&quot;</span>,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() ) );</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// normal subway drawing</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <a class="code" href="namespacemapf.html#a28eaa6a3088c736e6ccf70c00109651e">mapf::formatted_set_simple</a>( m, <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                            <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                            <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                            <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                            <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                            <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                            <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                            <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                            <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                            <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...&quot;</span>,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                            <a class="code" href="namespacemapf.html#a01909fd3228e5196be23ef383ac585ae">mapf::ter_bind</a>( <span class="stringliteral">&quot;. # ^ - X x&quot;</span>,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#aac746a69fccdce55c55a9fe973501393">ter_t_rock_floor</a>,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#aeee647df1decb170ca7434caf7c83bcb">ter_t_rock</a>,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#aa6be504da4482ef65dadf38670fd8536">ter_t_railroad_rubble</a>,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#ae0e9f1a03cf7405258aff98588605c78">ter_t_railroad_tie</a>,</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#a60bd1bf2b5e243b4029ecc6d0ad45a77">ter_t_railroad_track</a>,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                                    <a class="code" href="mapgen__functions_8cpp.html#aebb3a0e0c704955010dad05317b036bf">ter_t_railroad_track_on_tie</a> ),</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                            <a class="code" href="namespacemapf.html#adffad886fac4b454202b6fe0d8fa8a0f">mapf::furn_bind</a>( <span class="stringliteral">&quot;. # ^ - X x&quot;</span>,</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                                    <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() ) );</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="comment">// dead end</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <a class="code" href="namespacemapf.html#a28eaa6a3088c736e6ccf70c00109651e">mapf::formatted_set_simple</a>( m, <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^..../D^^/D^...\n&quot;</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                        <span class="stringliteral">&quot;...-x---x-.../DX^/DX^...\n&quot;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^../D^X/D^X^...\n&quot;</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^./D.^XD^^X^...\n&quot;</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^/D../D^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X/D../DX^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^XD../D^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                        <span class="stringliteral">&quot;...^X^^/D^./D.-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                        <span class="stringliteral">&quot;...^X^/DX^/D..^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                        <span class="stringliteral">&quot;...^X/D^X/D...^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                        <span class="stringliteral">&quot;...^XD^^XD....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                                        <span class="stringliteral">&quot;...^D^^^D^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                        <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                        <span class="stringliteral">&quot;...-x---x-....-x---x-...\n&quot;</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                        <span class="stringliteral">&quot;...^X^^^X^....^X^^^X^...\n&quot;</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                        <span class="stringliteral">&quot;...^S^^^S^....^S^^^S^...\n&quot;</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                        <span class="stringliteral">&quot;...^^^^^^^....^^^^^^^...\n&quot;</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                        <span class="stringliteral">&quot;#......................#\n&quot;</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                        <span class="stringliteral">&quot;##....................##\n&quot;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                        <span class="stringliteral">&quot;########################&quot;</span>,</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                        <a class="code" href="namespacemapf.html#a01909fd3228e5196be23ef383ac585ae">mapf::ter_bind</a>( <span class="stringliteral">&quot;. # S ^ - / D X x&quot;</span>,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aac746a69fccdce55c55a9fe973501393">ter_t_rock_floor</a>,</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aeee647df1decb170ca7434caf7c83bcb">ter_t_rock</a>,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a82cc93844b3e2ce684dbc07db1e125ba">ter_t_buffer_stop</a>,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aa6be504da4482ef65dadf38670fd8536">ter_t_railroad_rubble</a>,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#ae0e9f1a03cf7405258aff98588605c78">ter_t_railroad_tie</a>,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a7f4e37414045ea38805e144f0c65b9c9">ter_t_railroad_tie_d</a>,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a2b1001e2c98f6d01672d44effe359206">ter_t_railroad_track_d</a>,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#a60bd1bf2b5e243b4029ecc6d0ad45a77">ter_t_railroad_track</a>,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                                <a class="code" href="mapgen__functions_8cpp.html#aebb3a0e0c704955010dad05317b036bf">ter_t_railroad_track_on_tie</a> ),</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                        <a class="code" href="namespacemapf.html#adffad886fac4b454202b6fe0d8fa8a0f">mapf::furn_bind</a>( <span class="stringliteral">&quot;. # S ^ - / D X x&quot;</span>,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>(),</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                                <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>() ) );</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <a class="code" href="classVehicleSpawn.html#ac75480caa91442d3fe53db22fbed8301">VehicleSpawn::apply</a>( <a class="code" href="mapgen__functions_8cpp.html#ae3c272367ff9c06f99efa185092484d0">VehicleSpawn_default_subway_deadend</a>, *m, <span class="stringliteral">&quot;subway&quot;</span> );</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// finally, unrotate the map</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    m-&gt;<a class="code" href="classmap.html#a37268cf3dfc2a32e85a40c2a7266dfc9">rotate</a>( rot );</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="ttc" id="aclassVehicleSpawn_html_ac75480caa91442d3fe53db22fbed8301"><div class="ttname"><a href="classVehicleSpawn.html#ac75480caa91442d3fe53db22fbed8301">VehicleSpawn::apply</a></div><div class="ttdeci">void apply(map &amp;m, const std::string &amp;terrain_name) const</div><div class="ttdoc">This will invoke the vehicle spawn on the map.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__group_8cpp_source.html#l00209">vehicle_group.cpp:209</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a05a087b5368e72aff95bb62b38402a91"><div class="ttname"><a href="mapgen__functions_8cpp.html#a05a087b5368e72aff95bb62b38402a91">nesw_array_rotate</a></div><div class="ttdeci">void nesw_array_rotate(std::array&lt; T, N &gt; &amp;array, size_t dist)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00167">mapgen_functions.cpp:167</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a146716d39d89c98b5df834873f3d38a2"><div class="ttname"><a href="mapgen__functions_8cpp.html#a146716d39d89c98b5df834873f3d38a2">terrain_type_to_nesw_array</a></div><div class="ttdeci">int terrain_type_to_nesw_array(oter_id terrain_type, std::array&lt; bool, 4 &gt; &amp;array)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__functions_8cpp_source.html#l00154">mapgen_functions.cpp:154</a></div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a2b1001e2c98f6d01672d44effe359206"><div class="ttname"><a href="mapgen__functions_8cpp.html#a2b1001e2c98f6d01672d44effe359206">ter_t_railroad_track_d</a></div><div class="ttdeci">static const ter_str_id ter_t_railroad_track_d(&quot;t_railroad_track_d&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a60bd1bf2b5e243b4029ecc6d0ad45a77"><div class="ttname"><a href="mapgen__functions_8cpp.html#a60bd1bf2b5e243b4029ecc6d0ad45a77">ter_t_railroad_track</a></div><div class="ttdeci">static const ter_str_id ter_t_railroad_track(&quot;t_railroad_track&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a7f4e37414045ea38805e144f0c65b9c9"><div class="ttname"><a href="mapgen__functions_8cpp.html#a7f4e37414045ea38805e144f0c65b9c9">ter_t_railroad_tie_d</a></div><div class="ttdeci">static const ter_str_id ter_t_railroad_tie_d(&quot;t_railroad_tie_d&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_a82cc93844b3e2ce684dbc07db1e125ba"><div class="ttname"><a href="mapgen__functions_8cpp.html#a82cc93844b3e2ce684dbc07db1e125ba">ter_t_buffer_stop</a></div><div class="ttdeci">static const ter_str_id ter_t_buffer_stop(&quot;t_buffer_stop&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_aa6be504da4482ef65dadf38670fd8536"><div class="ttname"><a href="mapgen__functions_8cpp.html#aa6be504da4482ef65dadf38670fd8536">ter_t_railroad_rubble</a></div><div class="ttdeci">static const ter_str_id ter_t_railroad_rubble(&quot;t_railroad_rubble&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_ae0e9f1a03cf7405258aff98588605c78"><div class="ttname"><a href="mapgen__functions_8cpp.html#ae0e9f1a03cf7405258aff98588605c78">ter_t_railroad_tie</a></div><div class="ttdeci">static const ter_str_id ter_t_railroad_tie(&quot;t_railroad_tie&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_ae3c272367ff9c06f99efa185092484d0"><div class="ttname"><a href="mapgen__functions_8cpp.html#ae3c272367ff9c06f99efa185092484d0">VehicleSpawn_default_subway_deadend</a></div><div class="ttdeci">static const vspawn_id VehicleSpawn_default_subway_deadend(&quot;default_subway_deadend&quot;)</div></div>
<div class="ttc" id="amapgen__functions_8cpp_html_aebb3a0e0c704955010dad05317b036bf"><div class="ttname"><a href="mapgen__functions_8cpp.html#aebb3a0e0c704955010dad05317b036bf">ter_t_railroad_track_on_tie</a></div><div class="ttdeci">static const ter_str_id ter_t_railroad_track_on_tie(&quot;t_railroad_track_on_tie&quot;)</div></div>
<div class="ttc" id="anamespacemapf_html_a01909fd3228e5196be23ef383ac585ae"><div class="ttname"><a href="namespacemapf.html#a01909fd3228e5196be23ef383ac585ae">mapf::ter_bind</a></div><div class="ttdeci">format_effect&lt; ter_id &gt; ter_bind(const char(&amp;characters)[N], Args... ids)</div><div class="ttdoc">The functions create a mapping of characters to ids, usable with formatted_set_simple.</div><div class="ttdef"><b>Definition:</b> <a href="mapgenformat_8h_source.html#l00067">mapgenformat.h:67</a></div></div>
<div class="ttc" id="anamespacemapf_html_a28eaa6a3088c736e6ccf70c00109651e"><div class="ttname"><a href="namespacemapf.html#a28eaa6a3088c736e6ccf70c00109651e">mapf::formatted_set_simple</a></div><div class="ttdeci">void formatted_set_simple(map *m, const point &amp;start, const char *cstr, const format_effect&lt; ter_id &gt; &amp;ter_b, const format_effect&lt; furn_id &gt; &amp;furn_b)</div><div class="ttdoc">Set terrain and furniture on the supplied map.</div><div class="ttdef"><b>Definition:</b> <a href="mapgenformat_8cpp_source.html#l00014">mapgenformat.cpp:14</a></div></div>
<div class="ttc" id="anamespacemapf_html_adffad886fac4b454202b6fe0d8fa8a0f"><div class="ttname"><a href="namespacemapf.html#adffad886fac4b454202b6fe0d8fa8a0f">mapf::furn_bind</a></div><div class="ttdeci">format_effect&lt; furn_id &gt; furn_bind(const char(&amp;characters)[N], Args... ids)</div><div class="ttdef"><b>Definition:</b> <a href="mapgenformat_8h_source.html#l00078">mapgenformat.h:78</a></div></div>
<div class="ttc" id="aomdata_8h_html_ac214d1ec2c5c346a2ba8d8805839d08dadd856e0db491c8764a855dc9eb123021"><div class="ttname"><a href="omdata_8h.html#ac214d1ec2c5c346a2ba8d8805839d08dadd856e0db491c8764a855dc9eb123021">oter_flags::subway_connection</a></div><div class="ttdeci">@ subway_connection</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle__group_8cpp_source.html#l00209">VehicleSpawn::apply()</a>, <a class="el" href="mapgendata_8cpp_source.html#l00226">mapgendata::fill_groundcover()</a>, <a class="el" href="mapgenformat_8cpp_source.html#l00014">mapf::formatted_set_simple()</a>, <a class="el" href="mapgenformat_8h_source.html#l00078">mapf::furn_bind()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00167">nesw_array_rotate()</a>, <a class="el" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">string_id&lt; furn_t &gt;::NULL_ID()</a>, <a class="el" href="point_8h_source.html#l00251">point_zero</a>, <a class="el" href="mapgen_8cpp_source.html#l06948">map::rotate()</a>, <a class="el" href="omdata_8h.html#ac214d1ec2c5c346a2ba8d8805839d08dadd856e0db491c8764a855dc9eb123021">subway_connection</a>, <a class="el" href="mapgendata_8h_source.html#l00114">mapgendata::t_nesw</a>, <a class="el" href="mapgenformat_8h_source.html#l00067">mapf::ter_bind()</a>, <a class="el" href="mapgen__functions_8cpp.html#a82cc93844b3e2ce684dbc07db1e125ba">ter_t_buffer_stop</a>, <a class="el" href="mapgen__functions_8cpp.html#aa6be504da4482ef65dadf38670fd8536">ter_t_railroad_rubble</a>, <a class="el" href="mapgen__functions_8cpp.html#ae0e9f1a03cf7405258aff98588605c78">ter_t_railroad_tie</a>, <a class="el" href="mapgen__functions_8cpp.html#a7f4e37414045ea38805e144f0c65b9c9">ter_t_railroad_tie_d</a>, <a class="el" href="mapgen__functions_8cpp.html#a60bd1bf2b5e243b4029ecc6d0ad45a77">ter_t_railroad_track</a>, <a class="el" href="mapgen__functions_8cpp.html#a2b1001e2c98f6d01672d44effe359206">ter_t_railroad_track_d</a>, <a class="el" href="mapgen__functions_8cpp.html#aebb3a0e0c704955010dad05317b036bf">ter_t_railroad_track_on_tie</a>, <a class="el" href="mapgen__functions_8cpp.html#aeee647df1decb170ca7434caf7c83bcb">ter_t_rock</a>, <a class="el" href="mapgen__functions_8cpp.html#aac746a69fccdce55c55a9fe973501393">ter_t_rock_floor</a>, <a class="el" href="mapgendata_8h_source.html#l00172">mapgendata::terrain_type()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l00154">terrain_type_to_nesw_array()</a>, and <a class="el" href="mapgen__functions_8cpp.html#ae3c272367ff9c06f99efa185092484d0">VehicleSpawn_default_subway_deadend</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00111">get_mapgen_cfunction()</a>.</p>

</div>
</div>
<a id="aa7deb23cf27a0fdbc9648640a065903b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7deb23cf27a0fdbc9648640a065903b">&#9670;&nbsp;</a></span>mremove_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mremove_fields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmap.html">map</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="coordinates_8h.html#a38e880e550bb0688dea9353138da8683">tripoint_bub_ms</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l02203">2203</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;{</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    m-&gt;<a class="code" href="classmap.html#a9e5076a8f60e24d70bdba8cd6c8f1c07">clear_fields</a>( p.<a class="code" href="classcoords_1_1coord__point__mut.html#a5a5454f4ce144b5b3a84c2698a54ab8c">raw</a>() );</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;}</div>
<div class="ttc" id="aclasscoords_1_1coord__point__mut_html_a5a5454f4ce144b5b3a84c2698a54ab8c"><div class="ttname"><a href="classcoords_1_1coord__point__mut.html#a5a5454f4ce144b5b3a84c2698a54ab8c">coords::coord_point_mut::raw</a></div><div class="ttdeci">constexpr const Point &amp; raw() const</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00157">coordinates.h:157</a></div></div>
<div class="ttc" id="aclassmap_html_a9e5076a8f60e24d70bdba8cd6c8f1c07"><div class="ttname"><a href="classmap.html#a9e5076a8f60e24d70bdba8cd6c8f1c07">map::clear_fields</a></div><div class="ttdeci">friend void clear_fields(int zlevel)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classmap.html#a9e5076a8f60e24d70bdba8cd6c8f1c07">map::clear_fields</a>, and <a class="el" href="coordinates_8h_source.html#l00157">coords::coord_point_mut&lt; Point, Subpoint, InBounds &gt;::raw()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04861">jmapgen_setmap::apply()</a>.</p>

</div>
</div>
<a id="a45cbd0e902d3cb4e2d757f1c72cf3330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45cbd0e902d3cb4e2d757f1c72cf3330">&#9670;&nbsp;</a></span>mremove_trap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mremove_trap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmap.html">map</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="coordinates_8h.html#a38e880e550bb0688dea9353138da8683">tripoint_bub_ms</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type__id_8h.html#a6a456b8f9aeb28a96e3976548a6cb0dc">trap_id</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l02165">2165</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;{</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__id.html">trap_id</a> trap_at_loc = m-&gt;<a class="code" href="classmap.html#ac3badcb7b80602246664fa3671a840ba">maptile_at</a>( p ).<a class="code" href="classmaptile__impl.html#a6846725f7159102a4606e15a993f9803">get_trap</a>().<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>();</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="keywordflow">if</span>( type == <a class="code" href="trap_8cpp.html#a7b8e40eb2b50e3841e2d9f2d0531226a">tr_null</a> || trap_at_loc == type ) {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        m-&gt;<a class="code" href="classmap.html#ae6be5b2b977897215861971bf64fb502">remove_trap</a>( p );</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    }</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;}</div>
<div class="ttc" id="aclassint__id_html_a88b1e0c550f4d6f36cac7a73feca7f01"><div class="ttname"><a href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">int_id::id</a></div><div class="ttdeci">const string_id&lt; T &gt; &amp; id() const</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00033">ammo_effect.cpp:33</a></div></div>
<div class="ttc" id="aclassmap_html_ac3badcb7b80602246664fa3671a840ba"><div class="ttname"><a href="classmap.html#ac3badcb7b80602246664fa3671a840ba">map::maptile_at</a></div><div class="ttdeci">const_maptile maptile_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00386">map.cpp:386</a></div></div>
<div class="ttc" id="aclassmap_html_ae6be5b2b977897215861971bf64fb502"><div class="ttname"><a href="classmap.html#ae6be5b2b977897215861971bf64fb502">map::remove_trap</a></div><div class="ttdeci">void remove_trap(const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06338">map.cpp:6338</a></div></div>
<div class="ttc" id="aclassmaptile__impl_html_a6846725f7159102a4606e15a993f9803"><div class="ttname"><a href="classmaptile__impl.html#a6846725f7159102a4606e15a993f9803">maptile_impl::get_trap</a></div><div class="ttdeci">trap_id get_trap() const</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00356">submap.h:356</a></div></div>
<div class="ttc" id="atrap_8cpp_html_a7b8e40eb2b50e3841e2d9f2d0531226a"><div class="ttname"><a href="trap_8cpp.html#a7b8e40eb2b50e3841e2d9f2d0531226a">tr_null</a></div><div class="ttdeci">trap_id tr_null</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00421">trap.cpp:421</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="submap_8h_source.html#l00356">maptile_impl&lt; Submap &gt;::get_trap()</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00033">int_id&lt; T &gt;::id()</a>, <a class="el" href="map_8cpp_source.html#l00386">map::maptile_at()</a>, <a class="el" href="map_8cpp_source.html#l06338">map::remove_trap()</a>, <a class="el" href="trap_8cpp_source.html#l00421">tr_null</a>, and <a class="el" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a599dcce2998a6b40b1e38e8c6006cb0a">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04861">jmapgen_setmap::apply()</a>, and <a class="el" href="mapgen_8cpp_source.html#l07195">science_room()</a>.</p>

</div>
</div>
<a id="a731242541747c0bce021145aee350c1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a731242541747c0bce021145aee350c1d">&#9670;&nbsp;</a></span>mtrap_set() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mtrap_set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmap.html">map</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="coordinates_8h.html#a38e880e550bb0688dea9353138da8683">tripoint_bub_ms</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type__id_8h.html#a6a456b8f9aeb28a96e3976548a6cb0dc">trap_id</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>avoid_creatures</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l02173">2173</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;{</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="keywordflow">if</span>( avoid_creatures ) {</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;        <a class="code" href="classCreature.html">Creature</a> *<a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( <a class="code" href="coordinates_8h.html#a25195af12949fae51d496c1fbd549871">tripoint_abs_ms</a>( m-&gt;<a class="code" href="classmap.html#a501f3a1d449ac022f1b36b99da653e94">getabs</a>( p ) ), <span class="keyword">true</span> );</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> ) {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        }</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    m-&gt;<a class="code" href="classmap.html#ade82e480520c05f5a4e8917df19cef8c">trap_set</a>( p, type );</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;}</div>
<div class="ttc" id="aclassCreature_html"><div class="ttname"><a href="classCreature.html">Creature</a></div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00250">creature.h:251</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html_aba3c6663688bcd1806ea685d6961cb72"><div class="ttname"><a href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_tracker::creature_at</a></div><div class="ttdeci">T * creature_at(const tripoint &amp;p, bool allow_hallucination=false)</div><div class="ttdoc">Returns the Creature at the given location.</div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8cpp_source.html#l00303">creature_tracker.cpp:303</a></div></div>
<div class="ttc" id="aclassmap_html_ade82e480520c05f5a4e8917df19cef8c"><div class="ttname"><a href="classmap.html#ade82e480520c05f5a4e8917df19cef8c">map::trap_set</a></div><div class="ttdeci">void trap_set(const tripoint &amp;p, const trap_id &amp;type)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06297">map.cpp:6297</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a25195af12949fae51d496c1fbd549871"><div class="ttname"><a href="coordinates_8h.html#a25195af12949fae51d496c1fbd549871">tripoint_abs_ms</a></div><div class="ttdeci">coords::coord_point&lt; tripoint, coords::origin::abs, coords::ms &gt; tripoint_abs_ms</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00712">coordinates.h:712</a></div></div>
<div class="ttc" id="acreature__tracker_8h_html_a16f631f70e72b53e590770670fb301fb"><div class="ttname"><a href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a></div><div class="ttdeci">creature_tracker &amp; get_creature_tracker()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13827">game.cpp:13827</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a6753ecfe87da659675b18c2f81d6ec12"><div class="ttname"><a href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a></div><div class="ttdeci">static constexpr double c</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01568">magic.cpp:1568</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="jmapgen__flags_8h.html#ae580790d9b9186f509578ba362a167faabd0775f5dee4bffc6da50a20c1b9fbf5">avoid_creatures</a>, <a class="el" href="magic_8cpp_source.html#l01568">c</a>, <a class="el" href="creature__tracker_8cpp_source.html#l00303">creature_tracker::creature_at()</a>, <a class="el" href="game_8cpp_source.html#l13827">get_creature_tracker()</a>, <a class="el" href="map_8cpp_source.html#l09614">map::getabs()</a>, <a class="el" href="map_8cpp_source.html#l06297">map::trap_set()</a>, and <a class="el" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a599dcce2998a6b40b1e38e8c6006cb0a">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04861">jmapgen_setmap::apply()</a>, <a class="el" href="mapgen_8cpp_source.html#l07570">map::create_anomaly()</a>, <a class="el" href="mapgen_8cpp_source.html#l05389">map::draw_lab()</a>, <a class="el" href="map__extras_8cpp_source.html#l00456">MapExtras::place_trap_if_clear()</a>, and <a class="el" href="mapgen_8cpp_source.html#l07195">science_room()</a>.</p>

</div>
</div>
<a id="a1c1d85aa44746188e5792e2cf02fe726"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c1d85aa44746188e5792e2cf02fe726">&#9670;&nbsp;</a></span>mtrap_set() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mtrap_set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtinymap.html">tinymap</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpoint.html">point</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="type__id_8h.html#a6a456b8f9aeb28a96e3976548a6cb0dc">trap_id</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>avoid_creatures</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l02184">2184</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;{</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keywordflow">if</span>( avoid_creatures ) {</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        <a class="code" href="classCreature.html">Creature</a> *<a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( <a class="code" href="coordinates_8h.html#a25195af12949fae51d496c1fbd549871">tripoint_abs_ms</a>( m-&gt;<a class="code" href="classtinymap.html#a726fb8eaca25dc57dd2219e8cec728de">getabs</a>( <a class="code" href="structtripoint.html">tripoint</a>( p,</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                      m-&gt;<a class="code" href="classtinymap.html#a35c31a2ab009ea1dcbd5d8cddd0ecdb7">get_abs_sub</a>().<a class="code" href="classcoords_1_1coord__point__mut.html#aa94b8bd33e85ce94a3634e6e27ab0cdd">z</a>() ) ) ), <span class="keyword">true</span> );</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> ) {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    }</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> actual_location( p, m-&gt;<a class="code" href="classtinymap.html#a35c31a2ab009ea1dcbd5d8cddd0ecdb7">get_abs_sub</a>().<a class="code" href="classcoords_1_1coord__point__mut.html#aa94b8bd33e85ce94a3634e6e27ab0cdd">z</a>() );</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    m-&gt;<a class="code" href="classtinymap.html#a31312fe9c985616fc64e97dc4d986045">trap_set</a>( actual_location, type );</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;}</div>
<div class="ttc" id="aclasstinymap_html_a31312fe9c985616fc64e97dc4d986045"><div class="ttname"><a href="classtinymap.html#a31312fe9c985616fc64e97dc4d986045">tinymap::trap_set</a></div><div class="ttdeci">void trap_set(const tripoint &amp;p, const trap_id &amp;type)</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02629">map.h:2629</a></div></div>
<div class="ttc" id="aclasstinymap_html_a35c31a2ab009ea1dcbd5d8cddd0ecdb7"><div class="ttname"><a href="classtinymap.html#a35c31a2ab009ea1dcbd5d8cddd0ecdb7">tinymap::get_abs_sub</a></div><div class="ttdeci">tripoint_abs_sm get_abs_sub() const</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02666">map.h:2666</a></div></div>
<div class="ttc" id="aclasstinymap_html_a726fb8eaca25dc57dd2219e8cec728de"><div class="ttname"><a href="classtinymap.html#a726fb8eaca25dc57dd2219e8cec728de">tinymap::getabs</a></div><div class="ttdeci">tripoint getabs(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l02669">map.h:2669</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="jmapgen__flags_8h.html#ae580790d9b9186f509578ba362a167faabd0775f5dee4bffc6da50a20c1b9fbf5">avoid_creatures</a>, <a class="el" href="magic_8cpp_source.html#l01568">c</a>, <a class="el" href="creature__tracker_8cpp_source.html#l00303">creature_tracker::creature_at()</a>, <a class="el" href="map_8h_source.html#l02666">tinymap::get_abs_sub()</a>, <a class="el" href="game_8cpp_source.html#l13827">get_creature_tracker()</a>, <a class="el" href="map_8h_source.html#l02669">tinymap::getabs()</a>, <a class="el" href="map_8h_source.html#l02629">tinymap::trap_set()</a>, <a class="el" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a599dcce2998a6b40b1e38e8c6006cb0a">type</a>, and <a class="el" href="coordinates_8h_source.html#l00167">coords::coord_point_mut&lt; Point, Subpoint, InBounds &gt;::z()</a>.</p>

</div>
</div>
<a id="a5aee6c75824502694d57dbf8487d35f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aee6c75824502694d57dbf8487d35f1">&#9670;&nbsp;</a></span>resolve_regional_terrain_and_furniture()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resolve_regional_terrain_and_furniture </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l02208">2208</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;{</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p : dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>.<a class="code" href="classmap.html#a61d83c54adde6e54f8abf5a2b6834ea1">points_on_zlevel</a>() ) {</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <span class="keyword">const</span> <a class="code" href="classint__id.html">ter_id</a> tid_before = dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>.<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( p );</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        <span class="keyword">const</span> <a class="code" href="classint__id.html">ter_id</a> tid_after = dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73f1bde81ec92a66d047c8f010a5bb53">region_terrain_and_furniture</a>.<a class="code" href="structregion__terrain__and__furniture__settings.html#a26b7ce81d7999c7f150fdaf3853df0e8">resolve</a>( tid_before );</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="keywordflow">if</span>( tid_after != tid_before ) {</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>.<a class="code" href="classmap.html#a59bdb65280e5e1461469b0e1275c402e">ter_set</a>( p, tid_after );</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        }</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        <span class="keyword">const</span> <a class="code" href="classint__id.html">furn_id</a> fid_before = dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>.<a class="code" href="classmap.html#af55e014aab791bbe4c8630361c1311dd">furn</a>( p );</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        <span class="keyword">const</span> <a class="code" href="classint__id.html">furn_id</a> fid_after = dat.<a class="code" href="classmapgendata.html#a72a8a7458a69c04a9f80e980713ccd5e">region</a>.<a class="code" href="structregional__settings.html#a73f1bde81ec92a66d047c8f010a5bb53">region_terrain_and_furniture</a>.<a class="code" href="structregion__terrain__and__furniture__settings.html#a26b7ce81d7999c7f150fdaf3853df0e8">resolve</a>( fid_before );</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        <span class="keywordflow">if</span>( fid_after != fid_before ) {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            dat.<a class="code" href="classmapgendata.html#a7d9e28b073b22b2391e6d3972fd6aa12">m</a>.<a class="code" href="classmap.html#a410a8dcd3e1ee0e87da584bf878d6f83">furn_set</a>( p, fid_after );</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    }</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;}</div>
<div class="ttc" id="aclassmap_html_a61d83c54adde6e54f8abf5a2b6834ea1"><div class="ttname"><a href="classmap.html#a61d83c54adde6e54f8abf5a2b6834ea1">map::points_on_zlevel</a></div><div class="ttdeci">tripoint_range&lt; tripoint &gt; points_on_zlevel() const</div><div class="ttdoc">Yields a range of all points that are contained in the map and have the z-level of this map (abs_sub)...</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l10143">map.cpp:10143</a></div></div>
<div class="ttc" id="aclassmap_html_af55e014aab791bbe4c8630361c1311dd"><div class="ttname"><a href="classmap.html#af55e014aab791bbe4c8630361c1311dd">map::furn</a></div><div class="ttdeci">furn_id furn(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01722">map.cpp:1722</a></div></div>
<div class="ttc" id="astructregion__terrain__and__furniture__settings_html_a26b7ce81d7999c7f150fdaf3853df0e8"><div class="ttname"><a href="structregion__terrain__and__furniture__settings.html#a26b7ce81d7999c7f150fdaf3853df0e8">region_terrain_and_furniture_settings::resolve</a></div><div class="ttdeci">ter_id resolve(const ter_id &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8cpp_source.html#l01023">regional_settings.cpp:1023</a></div></div>
<div class="ttc" id="astructregional__settings_html_a73f1bde81ec92a66d047c8f010a5bb53"><div class="ttname"><a href="structregional__settings.html#a73f1bde81ec92a66d047c8f010a5bb53">regional_settings::region_terrain_and_furniture</a></div><div class="ttdeci">region_terrain_and_furniture_settings region_terrain_and_furniture</div><div class="ttdef"><b>Definition:</b> <a href="regional__settings_8h_source.html#l00291">regional_settings.h:291</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="map_8cpp_source.html#l01722">map::furn()</a>, <a class="el" href="map_8cpp_source.html#l01743">map::furn_set()</a>, <a class="el" href="mapgendata_8h_source.html#l00132">mapgendata::m</a>, <a class="el" href="map_8cpp_source.html#l10143">map::points_on_zlevel()</a>, <a class="el" href="mapgendata_8h_source.html#l00130">mapgendata::region</a>, <a class="el" href="regional__settings_8h_source.html#l00291">regional_settings::region_terrain_and_furniture</a>, <a class="el" href="regional__settings_8cpp_source.html#l01023">region_terrain_and_furniture_settings::resolve()</a>, <a class="el" href="map_8cpp_source.html#l01922">map::ter()</a>, and <a class="el" href="map_8cpp_source.html#l02226">map::ter_set()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l05305">jmapgen_objects::apply()</a>, <a class="el" href="mapgen_8cpp_source.html#l05174">apply_mapgen_in_phases()</a>, and <a class="el" href="mapgen_8cpp_source.html#l05355">map::draw_map()</a>.</p>

</div>
</div>
<a id="a60321e5661fe285e032f87708c5430f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60321e5661fe285e032f87708c5430f6">&#9670;&nbsp;</a></span>rotate_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structtripoint.html">tripoint</a> rotate_point </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtripoint.html">tripoint</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rotations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the coordinates of a rotated point. </p>
<p>Should match the <code>mapgen_*</code> rotation. </p>

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00079">79</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span>( p.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> &lt; 0 || p.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> &gt;= <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 ||</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        p.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> &lt; 0 || p.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> &gt;= <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 ) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Point out of range: %d,%d,%d&quot;</span>, p.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a>, p.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a>, p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="comment">// Mapgen is vulnerable, don&#39;t supply invalid points, debugmsg is enough</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structtripoint.html">tripoint</a>( 0, 0, p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> );</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    rotations = rotations % 4;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = p;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">switch</span>( rotations ) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.x = p.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.y = <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1 - p.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.x = <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> * 2 - 1 - p.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.y = <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - 1 - p.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.x = <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> * 2 - 1 - p.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.y = p.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="ttc" id="adebug_8h_html_a87e509562277a7ada3a75330d00cb445"><div class="ttname"><a href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a></div><div class="ttdeci">#define debugmsg(...)</div><div class="ttdoc">Debug message of level D_ERROR and class D_MAIN, also includes the source file name and line,...</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00069">debug.h:69</a></div></div>
<div class="ttc" id="anamespacecata_1_1hash64__detail_html_a5ca825db6fd06946302c60daa97333e4"><div class="ttname"><a href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">cata::hash64_detail::ret</a></div><div class="ttdeci">T ret</div><div class="ttdef"><b>Definition:</b> <a href="hash__utils_8h_source.html#l00097">hash_utils.h:97</a></div></div>
<div class="ttc" id="astructtripoint_html_a89f6c0a16e2bfd7ce4f1f1d20404c4d7"><div class="ttname"><a href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">tripoint::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00133">point.h:133</a></div></div>
<div class="ttc" id="astructtripoint_html_ac944c0e329b5eba2602f7a52f66bbbb9"><div class="ttname"><a href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">tripoint::z</a></div><div class="ttdeci">int z</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00134">point.h:134</a></div></div>
<div class="ttc" id="astructtripoint_html_affdc0d5b75024cbfacd208a495def3dc"><div class="ttname"><a href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">tripoint::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00132">point.h:132</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="debug_8h_source.html#l00069">debugmsg</a>, <a class="el" href="hash__utils_8h_source.html#l00097">cata::hash64_detail::ret</a>, <a class="el" href="game__constants_8h_source.html#l00042">SEEX</a>, <a class="el" href="game__constants_8h_source.html#l00043">SEEY</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">tripoint</a>, <a class="el" href="point_8h_source.html#l00132">tripoint::x</a>, <a class="el" href="point_8h_source.html#l00133">tripoint::y</a>, and <a class="el" href="point_8h_source.html#l00134">tripoint::z</a>.</p>

<p class="reference">Referenced by <a class="el" href="submap_8cpp_source.html#l00197">submap::rotate()</a>.</p>

</div>
</div>
<a id="ae8b9b565ea11e5c8e001c687c7133811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8b9b565ea11e5c8e001c687c7133811">&#9670;&nbsp;</a></span>run_mapgen_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool run_mapgen_func </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4ab45cffe084dd3d20d928bee85e7b0f21">std::string</a> &amp;&#160;</td>
          <td class="paramname"><em>mapgen_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l08050">8050</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;{</div>
<div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mapgen_8cpp.html#af6cc2c9dd319faeca5143d10b2e2304a">oter_mapgen</a>.<a class="code" href="classmapgen__factory.html#ad531b5329d5fe45eb33cb5644be51410">generate</a>( dat, mapgen_id );</div>
<div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;}</div>
<div class="ttc" id="aclassmapgen__factory_html_ad531b5329d5fe45eb33cb5644be51410"><div class="ttname"><a href="classmapgen__factory.html#ad531b5329d5fe45eb33cb5644be51410">mapgen_factory::generate</a></div><div class="ttdeci">bool generate(mapgendata &amp;dat, const std::string &amp;key, const int hardcoded_weight=0)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l00508">mapgen.cpp:508</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l00508">mapgen_factory::generate()</a>, and <a class="el" href="mapgen_8cpp_source.html#l00527">oter_mapgen</a>.</p>

<p class="reference">Referenced by <a class="el" href="map__extras_8cpp_source.html#l02188">MapExtras::apply_function()</a>, <a class="el" href="mapgen_8cpp_source.html#l05355">map::draw_map()</a>, <a class="el" href="faction__camp_8cpp_source.html#l03547">farm_action()</a>, <a class="el" href="mapgen_8cpp_source.html#l05214">mapgen_function_json::generate()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l01142">mapgen_lake_shore()</a>, <a class="el" href="mapgen__functions_8cpp_source.html#l01604">mapgen_ocean_shore()</a>, and <a class="el" href="mapgen__functions_8cpp_source.html#l02070">mapgen_ravine_edge()</a>.</p>

</div>
</div>
<a id="a79159f605db2f16f348a91425330f08e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79159f605db2f16f348a91425330f08e">&#9670;&nbsp;</a></span>run_mapgen_update_func() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool run_mapgen_update_func </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a9703e9c28f208c9af0bee38564a5df0b">update_mapgen_id</a> &amp;&#160;</td>
          <td class="paramname"><em>update_mapgen_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="coordinates_8h.html#a383a8345c0282c087ef788e4421c3ded">tripoint_abs_omt</a> &amp;&#160;</td>
          <td class="paramname"><em>omt_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmapgen__arguments.html">mapgen_arguments</a> &amp;&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmission.html">mission</a> *&#160;</td>
          <td class="paramname"><em>miss</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cancel_on_collision</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>mirror_horizontal</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>mirror_vertical</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rotation</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l07925">7925</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;{</div>
<div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> update_function = <a class="code" href="mapgen_8cpp.html#a67da18577384b9fb7798532356539bf1">update_mapgens</a>.find( <a class="code" href="classstring__id.html">update_mapgen_id</a> );</div>
<div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160; </div>
<div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;    <span class="keywordflow">if</span>( update_function == <a class="code" href="mapgen_8cpp.html#a67da18577384b9fb7798532356539bf1">update_mapgens</a>.end() || update_function-&gt;second.funcs().empty() ) {</div>
<div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;    }</div>
<div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;    <span class="keywordflow">return</span> update_function-&gt;second.funcs()[0]-&gt;update_map(</div>
<div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;               omt_pos, args, <a class="code" href="coordinates_8h.html#a9b033e645beea804e02a982600b4a7ae">tripoint_rel_ms</a>( <a class="code" href="point_8h.html#a4b1a6bcaa42d2c06ecc3afc63305bfdf">tripoint_zero</a> ), miss, cancel_on_collision, mirror_horizontal,</div>
<div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;               mirror_vertical, rotation );</div>
<div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="point_8h_source.html#l00250">tripoint_zero</a>, and <a class="el" href="mapgen_8cpp_source.html#l00530">update_mapgens</a>.</p>

<p class="reference">Referenced by <a class="el" href="timed__event_8cpp_source.html#l00102">timed_event::actualize()</a>, <a class="el" href="mapgen_8cpp_source.html#l07898">add_mapgen_update_func()</a>, <a class="el" href="iexamine__actors_8cpp_source.html#l00127">cardreader_examine_actor::apply()</a>, <a class="el" href="faction__camp_8cpp_source.html#l02755">apply_fortifications()</a>, <a class="el" href="map__extras_8cpp_source.html#l02188">MapExtras::apply_function()</a>, <a class="el" href="npctalk_8cpp_source.html#l03839">talk_effect_fun::anonymous_namespace{npctalk.cpp}::f_mapgen_update()</a>, <a class="el" href="trapfunc_8cpp_source.html#l01516">trapfunc::map_regen()</a>, <a class="el" href="faction__camp_8cpp_source.html#l04151">basecamp::salt_water_pipe_return()</a>, <a class="el" href="faction__camp_8cpp_source.html#l04060">basecamp::salt_water_pipe_swamp_return()</a>, <a class="el" href="faction__camp_8cpp_source.html#l00702">talk_function::start_camp()</a>, <a class="el" href="faction__camp_8cpp_source.html#l04502">basecamp::survey_return()</a>, and <a class="el" href="faction__camp_8cpp_source.html#l03875">basecamp::upgrade_return()</a>.</p>

</div>
</div>
<a id="a72af74c4151f983cbe05413f209b40d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72af74c4151f983cbe05413f209b40d5">&#9670;&nbsp;</a></span>run_mapgen_update_func() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool run_mapgen_update_func </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a9703e9c28f208c9af0bee38564a5df0b">update_mapgen_id</a> &amp;&#160;</td>
          <td class="paramname"><em>update_mapgen_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmapgendata.html">mapgendata</a> &amp;&#160;</td>
          <td class="paramname"><em>dat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cancel_on_collision</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l07940">7940</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;{</div>
<div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> update_function = <a class="code" href="mapgen_8cpp.html#a67da18577384b9fb7798532356539bf1">update_mapgens</a>.find( <a class="code" href="classstring__id.html">update_mapgen_id</a> );</div>
<div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;    <span class="keywordflow">if</span>( update_function == <a class="code" href="mapgen_8cpp.html#a67da18577384b9fb7798532356539bf1">update_mapgens</a>.end() || update_function-&gt;second.funcs().empty() ) {</div>
<div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;    }</div>
<div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;    <span class="keywordflow">return</span> update_function-&gt;second.funcs()[0]-&gt;update_map( dat, <a class="code" href="coordinates_8h.html#a9b033e645beea804e02a982600b4a7ae">tripoint_rel_ms</a>( <a class="code" href="point_8h.html#a4b1a6bcaa42d2c06ecc3afc63305bfdf">tripoint_zero</a> ),</div>
<div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;            cancel_on_collision );</div>
<div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="point_8h_source.html#l00250">tripoint_zero</a>, and <a class="el" href="mapgen_8cpp_source.html#l00530">update_mapgens</a>.</p>

</div>
</div>
<a id="a6cf02364d2ef67b23aa27bca2018bc5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf02364d2ef67b23aa27bca2018bc5d">&#9670;&nbsp;</a></span>set_queued_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_queued_points </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l07951">7951</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;{</div>
<div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;    <a class="code" href="classglobal__variables.html">global_variables</a> &amp;globvars = <a class="code" href="game_8cpp.html#ae5b4e6350cbe490780fbee966121b896">get_globals</a>();</div>
<div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;    <span class="keywordflow">for</span>( std::pair&lt;const std::string, tripoint_abs_ms&gt; &amp;queued_point : <a class="code" href="mapgen_8cpp.html#a0a78c0600aeb5e313005b490628df966">queued_points</a> ) {</div>
<div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;        globvars.<a class="code" href="classglobal__variables.html#af11cdada1509958b65ed6bba025908bb">set_global_value</a>( <span class="stringliteral">&quot;npctalk_var_&quot;</span> + queued_point.first, queued_point.second.to_string() );</div>
<div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;    }</div>
<div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;    <a class="code" href="mapgen_8cpp.html#a0a78c0600aeb5e313005b490628df966">queued_points</a>.clear();</div>
<div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;}</div>
<div class="ttc" id="aclassglobal__variables_html"><div class="ttname"><a href="classglobal__variables.html">global_variables</a></div><div class="ttdef"><b>Definition:</b> <a href="global__vars_8h_source.html#l00019">global_vars.h:20</a></div></div>
<div class="ttc" id="aclassglobal__variables_html_af11cdada1509958b65ed6bba025908bb"><div class="ttname"><a href="classglobal__variables.html#af11cdada1509958b65ed6bba025908bb">global_variables::set_global_value</a></div><div class="ttdeci">void set_global_value(const std::string &amp;key, const std::string &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="global__vars_8h_source.html#l00023">global_vars.h:23</a></div></div>
<div class="ttc" id="agame_8cpp_html_ae5b4e6350cbe490780fbee966121b896"><div class="ttname"><a href="game_8cpp.html#ae5b4e6350cbe490780fbee966121b896">get_globals</a></div><div class="ttdeci">global_variables &amp; get_globals()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13871">game.cpp:13871</a></div></div>
<div class="ttc" id="amapgen_8cpp_html_a0a78c0600aeb5e313005b490628df966"><div class="ttname"><a href="mapgen_8cpp.html#a0a78c0600aeb5e313005b490628df966">queued_points</a></div><div class="ttdeci">static std::unordered_map&lt; std::string, tripoint_abs_ms &gt; queued_points</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l00531">mapgen.cpp:531</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="game_8cpp_source.html#l13871">get_globals()</a>, <a class="el" href="mapgen_8cpp_source.html#l00531">queued_points</a>, and <a class="el" href="global__vars_8h_source.html#l00023">global_variables::set_global_value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="timed__event_8cpp_source.html#l00102">timed_event::actualize()</a>, <a class="el" href="iexamine__actors_8cpp_source.html#l00127">cardreader_examine_actor::apply()</a>, <a class="el" href="npctalk_8cpp_source.html#l03839">talk_effect_fun::anonymous_namespace{npctalk.cpp}::f_mapgen_update()</a>, <a class="el" href="mapgen_8cpp_source.html#l05214">mapgen_function_json::generate()</a>, and <a class="el" href="trapfunc_8cpp_source.html#l01516">trapfunc::map_regen()</a>.</p>

</div>
</div>
<a id="a146716d39d89c98b5df834873f3d38a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a146716d39d89c98b5df834873f3d38a2">&#9670;&nbsp;</a></span>terrain_type_to_nesw_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int terrain_type_to_nesw_array </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="type__id_8h.html#a08d4e395b54ad28c93af412ee36e00a1">oter_id</a>&#160;</td>
          <td class="paramname"><em>terrain_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7af1f713c9e000f5d3f280adbd124df4f5">std::array</a>&lt; bool, 4 &gt; &amp;&#160;</td>
          <td class="paramname"><em>array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen__functions_8cpp_source.html#l00154">154</a> of file <a class="el" href="mapgen__functions_8cpp_source.html">mapgen_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// count and mark which directions the road goes</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">const</span> <a class="code" href="structoter__t.html">oter_t</a> &amp;oter( *terrain_type );</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">int</span> num_dirs = 0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="namespaceom__direction.html#a3f3a3bf2c5af33fc8036734d1ba70b7c">om_direction::type</a> dir : <a class="code" href="namespaceom__direction.html#a27cad92b0d05637eb934f1a7f3424e41">om_direction::all</a> ) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        num_dirs += ( <a class="code" href="structarray.html">array</a>[<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( dir )] = oter.has_connection( dir ) );</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> num_dirs;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="ttc" id="anamespaceom__direction_html_a27cad92b0d05637eb934f1a7f3424e41"><div class="ttname"><a href="namespaceom__direction.html#a27cad92b0d05637eb934f1a7f3424e41">om_direction::all</a></div><div class="ttdeci">const std::array&lt; type, 4 &gt; all</div><div class="ttdoc">For the purposes of iteration.</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00065">omdata.h:65</a></div></div>
<div class="ttc" id="anamespaceom__direction_html_a3f3a3bf2c5af33fc8036734d1ba70b7c"><div class="ttname"><a href="namespaceom__direction.html#a3f3a3bf2c5af33fc8036734d1ba70b7c">om_direction::type</a></div><div class="ttdeci">type</div><div class="ttdoc">Basic enum for directions.</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00054">omdata.h:54</a></div></div>
<div class="ttc" id="astructarray_html"><div class="ttname"><a href="structarray.html">array</a></div><div class="ttdef"><b>Definition:</b> <a href="math__parser__impl_8h_source.html#l00123">math_parser_impl.h:123</a></div></div>
<div class="ttc" id="astructoter__t_html"><div class="ttname"><a href="structoter__t.html">oter_t</a></div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00310">omdata.h:310</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="omdata_8h_source.html#l00065">om_direction::all</a>, and <a class="el" href="overmap_8cpp_source.html#l00973">oter_t::has_connection()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen__functions_8cpp_source.html#l00197">mapgen_subway()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 7 2024 08:48:34 for Cataclysm DDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
