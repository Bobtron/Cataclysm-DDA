<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm DDA: src/ballistics.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm DDA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ballistics.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ballistics_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ballistics_8h.html">ballistics.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="calendar_8h.html">calendar.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="character_8h.html">character.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="creature_8h.html">creature.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="creature__tracker_8h.html">creature_tracker.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="damage_8h.html">damage.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="debug_8h.html">debug.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="dispersion_8h.html">dispersion.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="enums_8h.html">enums.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="explosion_8h.html">explosion.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="game_8h.html">game.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="item_8h.html">item.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="itype_8h.html">itype.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="line_8h.html">line.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="make__static_8h.html">make_static.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map_8h.html">map.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mapdata_8h.html">mapdata.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="messages_8h.html">messages.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="monster_8h.html">monster.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="npc_8h.html">npc.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="options_8h.html">options.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="point_8h.html">point.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="projectile_8h.html">projectile.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rng_8h.html">rng.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sounds_8h.html">sounds.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="translations_8h.html">translations.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="trap_8h.html">trap.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="type__id_8h.html">type_id.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="units_8h.html">units.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vpart__position_8h.html">vpart_position.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="ballistics_8cpp.html#aa3f7307ad230ecea38f95a4ff0b8ee05">   41</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="ballistics_8cpp.html#aa3f7307ad230ecea38f95a4ff0b8ee05">effect_bounced</a>( <span class="stringliteral">&quot;bounced&quot;</span> );</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="ballistics_8cpp.html#ac84f8a6ceee506b63a55de6327558230">   43</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">itype_id</a> <a class="code" href="ballistics_8cpp.html#ac84f8a6ceee506b63a55de6327558230">itype_glass_shard</a>( <span class="stringliteral">&quot;glass_shard&quot;</span> );</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="ballistics_8cpp.html#aff212e96c8be59a183e8b9fb955379a2">   45</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">json_character_flag</a> <a class="code" href="ballistics_8cpp.html#aff212e96c8be59a183e8b9fb955379a2">json_flag_HARDTOHIT</a>( <span class="stringliteral">&quot;HARDTOHIT&quot;</span> );</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="ballistics_8cpp.html#a2ed3afd8aecc72079ebd5b8697380e8f">   47</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="ballistics_8cpp.html#a2ed3afd8aecc72079ebd5b8697380e8f">drop_or_embed_projectile</a>( <span class="keyword">const</span> <a class="code" href="structdealt__projectile__attack.html">dealt_projectile_attack</a> &amp;<a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> )</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keyword">const</span> <a class="code" href="structprojectile.html">projectile</a> &amp;proj = <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.proj;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keyword">const</span> <a class="code" href="classitem.html">item</a> &amp;drop_item = proj.<a class="code" href="structprojectile.html#a370f9c2a4b37c7ed526f9d2fd1442328">get_drop</a>();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;effects = proj.<a class="code" href="structprojectile.html#a4536010a51aee3302d749f2eb4dcaf35">proj_effects</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span>( drop_item.<a class="code" href="classitem.html#a4d5555082454b3cb192f59a70838c891">is_null</a>() ) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;pt = <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.end_point;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span>( effects.count( <span class="stringliteral">&quot;SHATTER_SELF&quot;</span> ) ) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment">// Drop the contents, not the thrown item</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( pt, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %s shatters!&quot;</span> ), drop_item.<a class="code" href="classitem.html#a30837987c08ac5daf3b1e377e0ecaa21">tname</a>() );</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">// copies the drop item to spill the contents</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="classitem.html">item</a>( drop_item ).<a class="code" href="classitem.html#a2ea9b8df7dba40fc847f51563285f5aa">spill_contents</a>( pt );</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">// TODO: Non-glass breaking</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">// TODO: Wine glass breaking vs. entire sheet of glass breaking</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="namespacesounds.html#a6bb79ae1c9c3dcd8c8e0b28c66b0398d">sounds::sound</a>( pt, 16, <a class="code" href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3ac222ae0d4e9c59bd254b72521b9e74ed">sounds::sound_t::combat</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;glass breaking!&quot;</span> ), <span class="keyword">false</span>, <span class="stringliteral">&quot;bullet_hit&quot;</span>,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                       <span class="stringliteral">&quot;hit_glass&quot;</span> );</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keyword">const</span> <a class="code" href="classunits_1_1quantity.html">units::mass</a> shard_mass = <a class="code" href="ballistics_8cpp.html#ac84f8a6ceee506b63a55de6327558230">itype_glass_shard</a>-&gt;<a class="code" href="structitype.html#a4ecb806dae208ff275b4aa50ffcd3902">weight</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> max_nb_of_shards = <a class="code" href="math__parser__func_8h.html#a204ca52ef1b97d079c45e1cb6407f73b">floor</a>( <a class="code" href="namespaceunits.html#a8306911daadc1a4d7a7b46e9786f4a4c">to_gram</a>( drop_item.<a class="code" href="classitem.html#ac1d2c4c33b8a499812f3437cb2fad742">type</a>-&gt;<a class="code" href="structitype.html#a4ecb806dae208ff275b4aa50ffcd3902">weight</a> ) / <a class="code" href="namespaceunits.html#a8306911daadc1a4d7a7b46e9786f4a4c">to_gram</a>( shard_mass ) );</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="comment">//between half and max_nb_of_shards-1 will be usable</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nb_of_dropped_shard = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0, <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( max_nb_of_shards / 2, max_nb_of_shards - 1 ) );</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="comment">//feel free to remove this msg_debug</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="comment">/*add_msg_debug( &quot;Shattered %s dropped %i shards out of a max of %i, based on mass %i g&quot;,</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">                       drop_item.tname(), nb_of_dropped_shard, max_nb_of_shards - 1, to_gram( drop_item.type-&gt;weight ) );*/</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; nb_of_dropped_shard; ++i ) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <a class="code" href="classitem.html">item</a> shard( <span class="stringliteral">&quot;glass_shard&quot;</span> );</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="comment">//actual dropping of shards</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#a5579e13088b4ccd9c5a75458919d528a">add_item_or_charges</a>( pt, shard );</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span>( effects.count( <span class="stringliteral">&quot;BURST&quot;</span> ) ) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="comment">// Drop the contents, not the thrown item</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( pt, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %s bursts!&quot;</span> ), drop_item.<a class="code" href="classitem.html#a30837987c08ac5daf3b1e377e0ecaa21">tname</a>() );</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">// copies the drop item to spill the contents</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="classitem.html">item</a>( drop_item ).<a class="code" href="classitem.html#a2ea9b8df7dba40fc847f51563285f5aa">spill_contents</a>( pt );</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="comment">// TODO: Sound</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Copy the item</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="classitem.html">item</a> dropped_item = drop_item;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="classmonster.html">monster</a> *mon = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmonster.html">monster</a> *<span class="keyword">&gt;</span>( <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.hit_critter );</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// We can only embed in monsters</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">bool</span> mon_there = mon != <span class="keyword">nullptr</span> &amp;&amp; !mon-&gt;<a class="code" href="classmonster.html#a7a6be5e2dd4d5b14d1b9ccb61b1b4f6d">is_dead_state</a>();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// And if we actually want to embed</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">bool</span> embed = mon_there &amp;&amp; effects.count( <span class="stringliteral">&quot;NO_EMBED&quot;</span> ) == 0 &amp;&amp; effects.count( <span class="stringliteral">&quot;TANGLE&quot;</span> ) == 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Don&#39;t embed in small creatures</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span>( embed ) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keyword">const</span> <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2">creature_size</a> critter_size = mon-&gt;<a class="code" href="classmonster.html#ab92cac0ecb2b2062fd4f821b671f86ac">get_size</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">const</span> <a class="code" href="classunits_1_1quantity.html">units::volume</a> vol = dropped_item.<a class="code" href="classitem.html#a686df014e8aa8bc4637883802d05f935">volume</a>();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        embed = embed &amp;&amp; ( critter_size &gt; <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a> || vol &lt; 250_ml );</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        embed = embed &amp;&amp; ( critter_size &gt; <a class="code" href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aeb5c1399a871211c7e7ed732d15e3a8b">creature_size::small</a> || vol &lt; 500_ml );</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">// And if we deal enough damage</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">// Item volume bumps up the required damage too</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">// FIXME: Hardcoded damage types</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        embed = embed &amp;&amp;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                ( <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.dealt_dam.type_damage( <a class="code" href="make__static_8h.html#ad8ea997925f9b41fffbf138f4c05e09f">STATIC</a>( <a class="code" href="type__id_8h.html#a119965745ae171b731d18a45ec6ee424">damage_type_id</a>( <span class="stringliteral">&quot;cut&quot;</span> ) ) ) / 2 ) +</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.dealt_dam.type_damage( <a class="code" href="make__static_8h.html#ad8ea997925f9b41fffbf138f4c05e09f">STATIC</a>( <a class="code" href="type__id_8h.html#a119965745ae171b731d18a45ec6ee424">damage_type_id</a>( <span class="stringliteral">&quot;stab&quot;</span> ) ) ) &gt;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.dealt_dam.type_damage( <a class="code" href="make__static_8h.html#ad8ea997925f9b41fffbf138f4c05e09f">STATIC</a>( <a class="code" href="type__id_8h.html#a119965745ae171b731d18a45ec6ee424">damage_type_id</a>( <span class="stringliteral">&quot;bash&quot;</span> ) ) ) +</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                vol * 3 / 250_ml + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, 5 );</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span>( embed ) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        mon-&gt;<a class="code" href="classmonster.html#a6a50c1ca1b7405a717c95bac530e9e07">add_item</a>( dropped_item );</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a>( pt, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The %1$s embeds in %2$s!&quot;</span> ),</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                dropped_item.<a class="code" href="classitem.html#a30837987c08ac5daf3b1e377e0ecaa21">tname</a>(), mon-&gt;<a class="code" href="classmonster.html#af3444e4763b1dd53e75c5ea50fd8ba9f">disp_name</a>() );</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordtype">bool</span> do_drop = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">// monsters that are able to be tied up will store the item another way</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// see monexamine.cpp tie_or_untie()</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// if they aren&#39;t friendly they will try and break out of the net/bolas/lasso</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// players and NPCs just get the downed effect, and item is dropped.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">// TODO: storing the item on player until they recover from downed</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span>( effects.count( <span class="stringliteral">&quot;TANGLE&quot;</span> ) &amp;&amp; mon_there ) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            do_drop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span>( effects.count( <span class="stringliteral">&quot;ACT_ON_RANGED_HIT&quot;</span> ) ) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="comment">// Don&#39;t drop if it exploded</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            do_drop = !dropped_item.<a class="code" href="classitem.html#ac8356682e1760d4b4d4f62353eeb9ba9">activate_thrown</a>( <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.end_point );</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">if</span>( do_drop ) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            here.<a class="code" href="classmap.html#a5579e13088b4ccd9c5a75458919d528a">add_item_or_charges</a>( <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.end_point, dropped_item );</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">if</span>( effects.count( <span class="stringliteral">&quot;HEAVY_HIT&quot;</span> ) ) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a7518f40a34b4cbfbc922c4888af267cc">ter_furn_flag::TFLAG_LIQUID</a>, pt ) ) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <a class="code" href="namespacesounds.html#a6bb79ae1c9c3dcd8c8e0b28c66b0398d">sounds::sound</a>( pt, 10, <a class="code" href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3ac222ae0d4e9c59bd254b72521b9e74ed">sounds::sound_t::combat</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;splash!&quot;</span> ), <span class="keyword">false</span>, <span class="stringliteral">&quot;bullet_hit&quot;</span>, <span class="stringliteral">&quot;hit_water&quot;</span> );</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                <a class="code" href="namespacesounds.html#a6bb79ae1c9c3dcd8c8e0b28c66b0398d">sounds::sound</a>( pt, 8, <a class="code" href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3ac222ae0d4e9c59bd254b72521b9e74ed">sounds::sound_t::combat</a>, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;thud.&quot;</span> ), <span class="keyword">false</span>, <span class="stringliteral">&quot;bullet_hit&quot;</span>, <span class="stringliteral">&quot;hit_wall&quot;</span> );</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtrap.html">trap</a> &amp;tr = here.<a class="code" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( pt );</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span>( tr.<a class="code" href="structtrap.html#aa7bc509c6fa1aec956f63ec03980e593">triggered_by_item</a>( dropped_item ) ) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            tr.<a class="code" href="structtrap.html#a7a862026cc04677a44a7d945c786edd0">trigger</a>( pt, dropped_item );</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="ballistics_8cpp.html#af96b03314ba7a36b8a04b9ee5bacb7f9">  162</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> <a class="code" href="ballistics_8cpp.html#af96b03314ba7a36b8a04b9ee5bacb7f9">blood_trail_len</a>( <span class="keywordtype">int</span> damage )</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span>( damage &gt; 50 ) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( damage &gt; 20 ) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( damage &gt; 0 ) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="ballistics_8cpp.html#acb706f9463b8dfb5ddc91164229d3652">  174</a></span>&#160;<a class="code" href="structprojectile__attack__aim.html">projectile_attack_aim</a> <a class="code" href="ballistics_8cpp.html#acb706f9463b8dfb5ddc91164229d3652">projectile_attack_roll</a>( <span class="keyword">const</span> <a class="code" href="classdispersion__sources.html">dispersion_sources</a> &amp;dispersion, <span class="keywordtype">double</span> range,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordtype">double</span> target_size )</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="structprojectile__attack__aim.html">projectile_attack_aim</a> aim;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// dispersion is a measure of the dispersion of shots due to the gun + shooter characteristics</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// i.e. it is independent of any particular shot</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// shot_dispersion is the actual dispersion for this particular shot, i.e.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// the error angle between where the shot was aimed and where this one actually went</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// NB: some cases pass dispersion == 0 for a &quot;never misses&quot; shot e.g. bio_magnet,</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    aim.<a class="code" href="structprojectile__attack__aim.html#a14a4264cb4cba8ae7fed2b02ecef56f4">dispersion</a> = dispersion.<a class="code" href="classdispersion__sources.html#acaee96ee2b8a0c87b6fb5a9e2d4285d9">roll</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// an isosceles triangle is formed by the intended and actual target tiles</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    aim.<a class="code" href="structprojectile__attack__aim.html#a9b41c3c133bd09fadd1eedc38d6eec28">missed_by_tiles</a> = <a class="code" href="line_8cpp.html#a755929144f419e0be862e2a7a87b6ab7">iso_tangent</a>( range, <a class="code" href="namespaceunits.html#ae3cb4452221bae58dc798b8fc5865007">units::from_arcmin</a>( aim.<a class="code" href="structprojectile__attack__aim.html#a14a4264cb4cba8ae7fed2b02ecef56f4">dispersion</a> ) );</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// fraction we missed a monster target by (0.0 = perfect hit, 1.0 = miss)</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span>( target_size &gt; 0.0 ) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        aim.<a class="code" href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">missed_by</a> = <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( 1.0, aim.<a class="code" href="structprojectile__attack__aim.html#a9b41c3c133bd09fadd1eedc38d6eec28">missed_by_tiles</a> / target_size );</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="comment">// Special case 0 size targets, just to be safe from 0.0/0.0 NaNs</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        aim.<a class="code" href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">missed_by</a> = 1.0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">return</span> aim;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="ballistics_8cpp.html#a3090f41e3e1093c0ac85ed679237a6df">  201</a></span>&#160;<a class="code" href="structdealt__projectile__attack.html">dealt_projectile_attack</a> <a class="code" href="ballistics_8cpp.html#a3090f41e3e1093c0ac85ed679237a6df">projectile_attack</a>( <span class="keyword">const</span> <a class="code" href="structprojectile.html">projectile</a> &amp;proj_arg, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;source,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;target_arg, <span class="keyword">const</span> <a class="code" href="classdispersion__sources.html">dispersion_sources</a> &amp;dispersion, <a class="code" href="classCreature.html">Creature</a> *<a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a>,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keyword">const</span> <a class="code" href="classvehicle.html">vehicle</a> *in_veh, <span class="keyword">const</span> <a class="code" href="structweakpoint__attack.html">weakpoint_attack</a> &amp;wp_attack, <span class="keywordtype">bool</span> first )</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> do_animation = first &amp;&amp; get_option&lt;bool&gt;( <span class="stringliteral">&quot;ANIMATION_PROJECTILES&quot;</span> );</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">double</span> range = <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source, target_arg );</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classCreature.html">Creature</a> *target_critter = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( target_arg );</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">double</span> target_size = target_critter != <span class="keyword">nullptr</span> ?</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                         target_critter-&gt;<a class="code" href="classCreature.html#a1c8ea56d06ff96a720201c46a40969aa">ranged_target_size</a>() :</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                         here.<a class="code" href="classmap.html#a34187b9eff71461437403611d0d122a7">ranged_target_size</a>( target_arg );</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="structprojectile__attack__aim.html">projectile_attack_aim</a> aim = <a class="code" href="ballistics_8cpp.html#acb706f9463b8dfb5ddc91164229d3652">projectile_attack_roll</a>( dispersion, range, target_size );</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span>( target_critter &amp;&amp; target_critter-&gt;<a class="code" href="classCreature.html#a55d12f92d62a7c89c44b466d7e7cb00d">as_character</a>() &amp;&amp;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        target_critter-&gt;<a class="code" href="classCreature.html#a55d12f92d62a7c89c44b466d7e7cb00d">as_character</a>()-&gt;<a class="code" href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">has_flag</a>( <a class="code" href="ballistics_8cpp.html#aff212e96c8be59a183e8b9fb955379a2">json_flag_HARDTOHIT</a> ) ) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="structprojectile__attack__aim.html">projectile_attack_aim</a> lucky_aim = <a class="code" href="ballistics_8cpp.html#acb706f9463b8dfb5ddc91164229d3652">projectile_attack_roll</a>( dispersion, range, target_size );</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">// if the target&#39;s lucky they&#39;re more likely to be missed</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span>( lucky_aim.<a class="code" href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">missed_by</a> &gt; aim.<a class="code" href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">missed_by</a> ) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            aim = lucky_aim;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// TODO: move to-hit roll back in here</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="structdealt__projectile__attack.html">dealt_projectile_attack</a> <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        proj_arg, <span class="keyword">nullptr</span>, <a class="code" href="structdealt__damage__instance.html">dealt_damage_instance</a>(), source, aim.<a class="code" href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">missed_by</a></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    };</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// No suicidal shots</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span>( source == target_arg ) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Projectile_attack targeted own square.&quot;</span> );</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="structprojectile.html">projectile</a> &amp;proj = <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.proj;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;proj_effects = proj.<a class="code" href="structprojectile.html#a4536010a51aee3302d749f2eb4dcaf35">proj_effects</a>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> stream = proj_effects.count( <span class="stringliteral">&quot;STREAM&quot;</span> ) &gt; 0 ||</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        proj_effects.count( <span class="stringliteral">&quot;STREAM_TINY&quot;</span> ) &gt; 0 ||</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                        proj_effects.count( <span class="stringliteral">&quot;STREAM_BIG&quot;</span> ) &gt; 0 ||</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                        proj_effects.count( <span class="stringliteral">&quot;JET&quot;</span> ) &gt; 0;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> bullet = stream ? <span class="charliteral">&#39;#&#39;</span> : <span class="charliteral">&#39;*&#39;</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> no_item_damage = proj_effects.count( <span class="stringliteral">&quot;NO_ITEM_DAMAGE&quot;</span> ) &gt; 0;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> do_draw_line = proj_effects.count( <span class="stringliteral">&quot;DRAW_AS_LINE&quot;</span> ) &gt; 0;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> null_source = proj_effects.count( <span class="stringliteral">&quot;NULL_SOURCE&quot;</span> ) &gt; 0;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// Determines whether it can penetrate obstacles</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_bullet = proj_arg.<a class="code" href="structprojectile.html#aa2af53bce63feecb719ef1edba54689e">speed</a> &gt;= 200 &amp;&amp; !proj_effects.count( <span class="stringliteral">&quot;NO_PENETRATE_OBSTACLES&quot;</span> );</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// If we were targeting a tile rather than a monster, don&#39;t overshoot</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// Unless the target was a wall, then we are aiming high enough to overshoot</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> no_overshoot = proj_effects.count( <span class="stringliteral">&quot;NO_OVERSHOOT&quot;</span> ) ||</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                              ( creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( target_arg ) == <span class="keyword">nullptr</span> &amp;&amp; here.<a class="code" href="classmap.html#af563dc2397e71a053569cb45c6bb7e77">passable</a>( target_arg ) );</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">double</span> extend_to_range = no_overshoot ? range : proj_arg.<a class="code" href="structprojectile.html#a312bc9a78fe7a5fdefb44e3755154db3">range</a>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> target = target_arg;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    std::vector&lt;tripoint&gt; <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span>( aim.<a class="code" href="structprojectile__attack__aim.html#a9b41c3c133bd09fadd1eedc38d6eec28">missed_by_tiles</a> &gt;= 1.0 ) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment">// We missed enough to target a different tile</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordtype">double</span> dx = target_arg.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> - source.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordtype">double</span> dy = target_arg.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> - source.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="classunits_1_1quantity.html">units::angle</a> rad = <a class="code" href="namespaceunits.html#a69513b1c48b5d7da935832d5d25b2e11">units::atan2</a>( dy, dx );</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">// cap wild misses at +/- 30 degrees</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="classunits_1_1quantity.html">units::angle</a> dispersion_angle =</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( <a class="code" href="namespaceunits.html#ae3cb4452221bae58dc798b8fc5865007">units::from_arcmin</a>( aim.<a class="code" href="structprojectile__attack__aim.html#a14a4264cb4cba8ae7fed2b02ecef56f4">dispersion</a> ), 30_degrees );</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        rad += ( <a class="code" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 2 ) ? 1 : -1 ) * dispersion_angle;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// TODO: This should also represent the miss on z axis</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> offset = std::min&lt;int&gt;( range, <a class="code" href="math__parser__func_8h.html#aeb3bbc4ec861ea58cbfca028920e4cc6">std::sqrt</a>( aim.<a class="code" href="structprojectile__attack__aim.html#a9b41c3c133bd09fadd1eedc38d6eec28">missed_by_tiles</a> ) );</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordtype">int</span> new_range = no_overshoot ?</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                        range + <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( -offset, offset ) :</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                        <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( range - offset, proj_arg.<a class="code" href="structprojectile.html#a312bc9a78fe7a5fdefb44e3755154db3">range</a> );</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        new_range = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( new_range, 1 );</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        target.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> = source.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> + <a class="code" href="rng_8cpp.html#acd19ae79e3590a99c9eaf0389318b686">roll_remainder</a>( new_range * <a class="code" href="math__parser__func_8h.html#aa178d72bf03c69677934a8c977f3b850">cos</a>( rad ) );</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        target.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> = source.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> + <a class="code" href="rng_8cpp.html#acd19ae79e3590a99c9eaf0389318b686">roll_remainder</a>( new_range * <a class="code" href="math__parser__func_8h.html#a3d9f495ca19a6110e624fc1d0ed3da74">sin</a>( rad ) );</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">if</span>( target == source ) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            target.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> = source.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> + <a class="code" href="enums_8h.html#a89bed42d8e3efcd44570febc837f088e">sgn</a>( dx );</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            target.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> = source.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> + <a class="code" href="enums_8h.html#a89bed42d8e3efcd44570febc837f088e">sgn</a>( dy );</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="comment">// Don&#39;t extend range further, miss here can mean hitting the ground near the target</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        range = <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source, target );</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        extend_to_range = range;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span>( first ) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <a class="code" href="namespacesfx.html#a8fa2bb887ac81392fb686cc4079b5d5a">sfx::play_variant_sound</a>( <span class="stringliteral">&quot;bullet_hit&quot;</span>, <span class="stringliteral">&quot;hit_wall&quot;</span>, <a class="code" href="namespacesfx.html#a1f138eaa92db132e81ce591751c512cc">sfx::get_heard_volume</a>( target ),</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                     <a class="code" href="namespacesfx.html#aa186eb63210729f73d7c76dcda527ff5">sfx::get_heard_angle</a>( target ) );</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">// TODO: Z dispersion</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">//Use find clear path to draw the trajectory with optimal initial tile offsets.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a> = here.<a class="code" href="classmap.html#a0f73359be972a030063b4e84f770275e">find_clear_path</a>( source, target );</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a>( <a class="code" href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2a0280ceb7e7edc880f2d9625ea9852dd9">debugmode::DF_BALLISTIC</a>,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                   <span class="stringliteral">&quot;missed_by_tiles: %.2f; missed_by: %.2f; target (orig/hit): %d,%d,%d/%d,%d,%d&quot;</span>,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                   aim.<a class="code" href="structprojectile__attack__aim.html#a9b41c3c133bd09fadd1eedc38d6eec28">missed_by_tiles</a>, aim.<a class="code" href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">missed_by</a>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                   target_arg.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a>, target_arg.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a>, target_arg.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                   target.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a>, target.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a>, target.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> );</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// Trace the trajectory, doing damage in order</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> &amp;tp = <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.end_point;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> prev_point = source;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// Add the first point to the trajectory</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.insert( <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.begin(), source );</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keyword">static</span> <a class="code" href="classstring__id.html">emit_id</a> muzzle_smoke( <span class="stringliteral">&quot;emit_smaller_smoke_plume&quot;</span> );</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">if</span>( proj_effects.count( <span class="stringliteral">&quot;MUZZLE_SMOKE&quot;</span> ) ) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        here.<a class="code" href="classmap.html#a150f1b826e0e2722ccf76dbdac136ffd">emit_field</a>( <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.front(), muzzle_smoke );</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span>( !no_overshoot &amp;&amp; range &lt; extend_to_range ) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">// Continue line is very &quot;stiff&quot; when the original range is short</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">// TODO: Make it use a more distant point for more realistic extended lines</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        std::vector&lt;tripoint&gt; trajectory_extension = <a class="code" href="line_8cpp.html#a2bd46cad079efd79854dffc0b97ce94b">continue_line</a>( <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                extend_to_range - range );</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.reserve( <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.size() + trajectory_extension.size() );</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.insert( <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.end(), trajectory_extension.begin(), trajectory_extension.end() );</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// Range can be 0</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">size_t</span> traj_len = <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.size();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">while</span>( traj_len &gt; 0 &amp;&amp; <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source, <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>[traj_len - 1] ) &gt; proj_arg.<a class="code" href="structprojectile.html#a312bc9a78fe7a5fdefb44e3755154db3">range</a> ) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        --traj_len;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> projectile_skip_multiplier = 0.1f;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// Randomize the skip so that bursts look nicer</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">int</span> projectile_skip_calculation = range * projectile_skip_multiplier;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">int</span> projectile_skip_current_frame = <a class="code" href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a>( 0, projectile_skip_calculation );</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">bool</span> has_momentum = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 1; i &lt; traj_len &amp;&amp; ( has_momentum || stream ); ++i ) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        prev_point = tp;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        tp = <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>[i];</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">if</span>( tp.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> != prev_point.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> ) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <a class="code" href="structtripoint.html">tripoint</a> floor1 = prev_point;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <a class="code" href="structtripoint.html">tripoint</a> floor2 = tp;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            <span class="keywordflow">if</span>( floor1.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> &lt; floor2.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> ) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                floor1.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a>++;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                floor2.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a>++;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="comment">// We only stop the bullet if there are two floors in a row</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="comment">// this allow the shooter to shoot adjacent enemies from rooftops.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a78e0a35a5041e0daf6e7a2a4ec522014">has_floor_or_water</a>( floor1 ) &amp;&amp; here.<a class="code" href="classmap.html#a78e0a35a5041e0daf6e7a2a4ec522014">has_floor_or_water</a>( floor2 ) ) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="comment">// Currently strictly no shooting through floor</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="comment">// TODO: Bash the floor</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                tp = prev_point;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                traj_len = --i;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">// Drawing the bullet uses player g-&gt;u, and not player p, because it&#39;s drawn</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">// relative to YOUR position, which may not be the gunman&#39;s position.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">if</span>( do_animation &amp;&amp; !do_draw_line ) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="comment">// TODO: Make this draw thrown item/launched grenade/arrow</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">if</span>( projectile_skip_current_frame &gt;= projectile_skip_calculation ) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;draw_bullet( tp, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( i ), <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>, bullet );</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                projectile_skip_current_frame = 0;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="comment">// If we missed recalculate the skip factor so they spread out.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                projectile_skip_calculation =</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>( range ), i ) * projectile_skip_multiplier;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                projectile_skip_current_frame++;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">if</span>( in_veh != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keyword">const</span> <a class="code" href="classoptional__vpart__position.html">optional_vpart_position</a> <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a> = here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( tp );</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keywordflow">if</span>( in_veh == <a class="code" href="vpart__position_8h.html#a8da46e924794d004c9899494ecd600c5">veh_pointer_or_null</a>( <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a> ) &amp;&amp; <a class="code" href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">other</a>-&gt;is_inside() ) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="comment">// Turret is on the roof and can&#39;t hit anything inside</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <a class="code" href="classCreature.html">Creature</a> *critter = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( tp );</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a> == critter ) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="comment">// No hitting self with &quot;weird&quot; attacks.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            critter = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="classmonster.html">monster</a> *mon = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmonster.html">monster</a> *<span class="keyword">&gt;</span>( critter );</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// ignore non-point-blank digging targets (since they are underground)</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">if</span>( mon != <span class="keyword">nullptr</span> &amp;&amp; mon-&gt;<a class="code" href="classmonster.html#af705eea6e40e12d7866010955602c7b5">digging</a>() &amp;&amp;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source, tp ) &gt; 1 ) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            critter = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            mon = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">// Reset hit critter from the last iteration</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.hit_critter = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="comment">// If we shot us a monster...</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">// TODO: add size effects to accuracy</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment">// If there&#39;s a monster in the path of our bullet, and either our aim was true,</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">//  OR it&#39;s not the monster we were aiming at and we were lucky enough to hit it</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordtype">double</span> cur_missed_by = aim.<a class="code" href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">missed_by</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="comment">// unintentional hit on something other than our actual target</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment">// don&#39;t re-roll for the actual target, we already decided on a missed_by value for that</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="comment">// at the start, misses should stay as misses</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">if</span>( critter != <span class="keyword">nullptr</span> &amp;&amp; tp != target_arg ) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="comment">// Unintentional hit</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            cur_missed_by = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( <a class="code" href="rng_8cpp.html#a0c88381d6334a2fbaa726c53f5cf9bb9">rng_float</a>( 0.1, 1.5 - aim.<a class="code" href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">missed_by</a> ) /</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                      critter-&gt;<a class="code" href="classCreature.html#a1c8ea56d06ff96a720201c46a40969aa">ranged_target_size</a>(), 0.4 );</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">if</span>( critter != <span class="keyword">nullptr</span> &amp;&amp; cur_missed_by &lt; 1.0 ) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="keywordflow">if</span>( in_veh != <span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="vpart__position_8h.html#a8da46e924794d004c9899494ecd600c5">veh_pointer_or_null</a>( here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( tp ) ) == in_veh &amp;&amp;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                critter-&gt;<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() ) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                <span class="comment">// Turret either was aimed by the player (who is now ducking) and shoots from above</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                <span class="comment">// Or was just IFFing, giving lots of warnings and time to get out of the line of fire</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="comment">// avoid friendly fire</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordflow">if</span>( critter-&gt;<a class="code" href="classCreature.html#a5698402eb4d7bbb013213f11f5768c92">attitude_to</a>( *<a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a> ) == <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Creature::Attitude::FRIENDLY</a> &amp;&amp;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a>-&gt;check_avoid_friendly_fire() ) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.missed_by = cur_missed_by;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordtype">bool</span> print_messages = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="comment">// If the attack is shot, once we&#39;re past point-blank,</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="comment">// overwrite the default damage with shot damage.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">if</span>( proj.<a class="code" href="structprojectile.html#ac535de1b5134a85ddcc5d1deffbf0d31">count</a> &gt; 1 &amp;&amp; <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( source, tp ) &gt; 1 ) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.proj.impact = <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.proj.shot_impact;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                print_messages = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            critter-&gt;<a class="code" href="classCreature.html#a16fbfd5268fd73935e5211bc1fa08617">deal_projectile_attack</a>( null_source ? <span class="keyword">nullptr</span> : <a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a>, <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>, print_messages,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                             wp_attack );</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">if</span>( critter-&gt;<a class="code" href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">is_npc</a>() ) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                critter-&gt;<a class="code" href="classCreature.html#a5de5f5e0d08deb03b68749608eb360b2">as_npc</a>()-&gt;<a class="code" href="classnpc.html#a965eb2beb1c490bb1b8efef1c07e20d0">on_attacked</a>( *<a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a> );</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="comment">// Critter can still dodge the projectile</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="comment">// In this case hit_critter won&#39;t be set</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.hit_critter != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                <span class="keyword">const</span> <a class="code" href="classint__id.html">field_type_id</a> <a class="code" href="character_8h.html#a985ec90ebcfc217cb519552102436f40">blood_type</a> = critter-&gt;<a class="code" href="classCreature.html#a5c6d320a21d767c65c807fe563c4b2c9">bloodType</a>();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="character_8h.html#a985ec90ebcfc217cb519552102436f40">blood_type</a> ) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">size_t</span> bt_len = <a class="code" href="ballistics_8cpp.html#af96b03314ba7a36b8a04b9ee5bacb7f9">blood_trail_len</a>( <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.dealt_dam.total_damage() );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <span class="keywordflow">if</span>( bt_len &gt; 0 ) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;dest = <a class="code" href="line_8cpp.html#a9d579f76fbf6ae5f314d294593448d94">move_along_line</a>( tp, <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>, bt_len );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                        here.<a class="code" href="classmap.html#a522fd89a4564c34f30ed629a00aa28fe">add_splatter_trail</a>( <a class="code" href="character_8h.html#a985ec90ebcfc217cb519552102436f40">blood_type</a>, tp, dest );</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <a class="code" href="namespacesfx.html#abd0353422210027726055778b4605e23">sfx::do_projectile_hit</a>( *<a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.hit_critter );</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                has_momentum = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <span class="comment">// on-hit effects for inflicted damage types</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const damage_type_id, int&gt; &amp;dt : <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.dealt_dam.dealt_dams ) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                    dt.first-&gt;onhit_effects( <a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a>, <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.hit_critter );</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>.missed_by = aim.<a class="code" href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">missed_by</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( in_veh != <span class="keyword">nullptr</span> &amp;&amp; <a class="code" href="vpart__position_8h.html#a8da46e924794d004c9899494ecd600c5">veh_pointer_or_null</a>( here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( tp ) ) == in_veh ) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="comment">// Don&#39;t do anything, especially don&#39;t call map::shoot as this would damage the vehicle</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            here.<a class="code" href="classmap.html#a30089f97bb31ba2ca2243c178a4a3c65">shoot</a>( tp, proj, !no_item_damage &amp;&amp; tp == target );</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            has_momentum = proj.<a class="code" href="structprojectile.html#a82d8f657f8cfc4e180c15bfab8ca8a6e">impact</a>.<a class="code" href="structdamage__instance.html#a96f6f6d008ed8744ce549cefcfec3951">total_damage</a>() &gt; 0;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">if</span>( ( !has_momentum || !is_bullet ) &amp;&amp; here.<a class="code" href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">impassable</a>( tp ) ) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="comment">// Don&#39;t let flamethrowers go through walls</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="comment">// TODO: Let them go through bars</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            traj_len = i;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// Done with the trajectory!</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span>( do_animation &amp;&amp; do_draw_line &amp;&amp; traj_len &gt; 2 ) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.erase( <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.begin() );</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>.resize( traj_len-- );</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;draw_line( tp, <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a> );</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;draw_bullet( tp, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( traj_len-- ), <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>, bullet );</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">impassable</a>( tp ) ) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        tp = prev_point;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="ballistics_8cpp.html#a2ed3afd8aecc72079ebd5b8697380e8f">drop_or_embed_projectile</a>( <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a> );</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="projectile_8cpp.html#a94546cfedf6b069ea55ca1d4c587bb93">apply_ammo_effects</a>( null_source ? <span class="keyword">nullptr</span> : <a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a>, tp, proj.<a class="code" href="structprojectile.html#a4536010a51aee3302d749f2eb4dcaf35">proj_effects</a> );</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keyword">const</span> <a class="code" href="structexplosion__data.html">explosion_data</a> &amp;expl = proj.<a class="code" href="structprojectile.html#a5fcd41d46e5ffb373b840ae4f66e38c0">get_custom_explosion</a>();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">if</span>( expl.<a class="code" href="structexplosion__data.html#a7611386ec7f61ad71a625f0b6750483c">power</a> &gt; 0.0f ) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="namespaceexplosion__handler.html#af4ae8e07a9627dbfe22b2d07ea577587">explosion_handler::explosion</a>( null_source ? <span class="keyword">nullptr</span> : <a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a>, tp, proj.<a class="code" href="structprojectile.html#a5fcd41d46e5ffb373b840ae4f66e38c0">get_custom_explosion</a>() );</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">// TODO: Move this outside now that we have hit point in return values?</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span>( proj.<a class="code" href="structprojectile.html#a4536010a51aee3302d749f2eb4dcaf35">proj_effects</a>.count( <span class="stringliteral">&quot;BOUNCE&quot;</span> ) ) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">// Add effect so the shooter is not targeted itself.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a> &amp;&amp; !<a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a>-&gt;has_effect( <a class="code" href="ballistics_8cpp.html#aa3f7307ad230ecea38f95a4ff0b8ee05">effect_bounced</a> ) ) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a>-&gt;add_effect( <a class="code" href="ballistics_8cpp.html#aa3f7307ad230ecea38f95a4ff0b8ee05">effect_bounced</a>, 1_turns );</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="classCreature.html">Creature</a> *mon_ptr = <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;get_creature_if( [&amp;]( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp; z ) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="comment">// search for creatures in radius 4 around impact site</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a>( z.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), tp ) &lt;= 4 &amp;&amp;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                here.<a class="code" href="classmap.html#aa8a67baac3cc72b2f5fbd669894587a0">sees</a>( z.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), tp, -1 ) ) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <span class="comment">// don&#39;t hit targets that have already been hit</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                if( !z.has_effect( effect_bounced ) ) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    return true;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        } );</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">if</span>( mon_ptr ) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <a class="code" href="classCreature.html">Creature</a> &amp;z = *mon_ptr;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <a class="code" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;The attack bounced to %s!&quot;</span> ), z.<a class="code" href="classCreature.html#a5881c150a3ed435f757e0b34b0d1009e">get_name</a>() );</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            z.<a class="code" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code" href="ballistics_8cpp.html#aa3f7307ad230ecea38f95a4ff0b8ee05">effect_bounced</a>, 1_turns );</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <a class="code" href="ballistics_8cpp.html#a3090f41e3e1093c0ac85ed679237a6df">projectile_attack</a>( proj, tp, z.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>(), dispersion, <a class="code" href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">origin</a>, in_veh );</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <a class="code" href="namespacesfx.html#a8fa2bb887ac81392fb686cc4079b5d5a">sfx::play_variant_sound</a>( <span class="stringliteral">&quot;fire_gun&quot;</span>, <span class="stringliteral">&quot;bio_lightning_tail&quot;</span>,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                     <a class="code" href="namespacesfx.html#a1f138eaa92db132e81ce591751c512cc">sfx::get_heard_volume</a>( z.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ), <a class="code" href="namespacesfx.html#aa186eb63210729f73d7c76dcda527ff5">sfx::get_heard_angle</a>( z.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() ) );</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">attack</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;}</div>
<div class="ttc" id="aballistics_8cpp_html_a2ed3afd8aecc72079ebd5b8697380e8f"><div class="ttname"><a href="ballistics_8cpp.html#a2ed3afd8aecc72079ebd5b8697380e8f">drop_or_embed_projectile</a></div><div class="ttdeci">static void drop_or_embed_projectile(const dealt_projectile_attack &amp;attack)</div><div class="ttdef"><b>Definition:</b> <a href="ballistics_8cpp_source.html#l00047">ballistics.cpp:47</a></div></div>
<div class="ttc" id="aballistics_8cpp_html_a3090f41e3e1093c0ac85ed679237a6df"><div class="ttname"><a href="ballistics_8cpp.html#a3090f41e3e1093c0ac85ed679237a6df">projectile_attack</a></div><div class="ttdeci">dealt_projectile_attack projectile_attack(const projectile &amp;proj_arg, const tripoint &amp;source, const tripoint &amp;target_arg, const dispersion_sources &amp;dispersion, Creature *origin, const vehicle *in_veh, const weakpoint_attack &amp;wp_attack, bool first)</div><div class="ttdoc">Fires a projectile at the target point from the source point with total_dispersion dispersion.</div><div class="ttdef"><b>Definition:</b> <a href="ballistics_8cpp_source.html#l00201">ballistics.cpp:201</a></div></div>
<div class="ttc" id="aballistics_8cpp_html_aa3f7307ad230ecea38f95a4ff0b8ee05"><div class="ttname"><a href="ballistics_8cpp.html#aa3f7307ad230ecea38f95a4ff0b8ee05">effect_bounced</a></div><div class="ttdeci">static const efftype_id effect_bounced(&quot;bounced&quot;)</div></div>
<div class="ttc" id="aballistics_8cpp_html_ac84f8a6ceee506b63a55de6327558230"><div class="ttname"><a href="ballistics_8cpp.html#ac84f8a6ceee506b63a55de6327558230">itype_glass_shard</a></div><div class="ttdeci">static const itype_id itype_glass_shard(&quot;glass_shard&quot;)</div></div>
<div class="ttc" id="aballistics_8cpp_html_acb706f9463b8dfb5ddc91164229d3652"><div class="ttname"><a href="ballistics_8cpp.html#acb706f9463b8dfb5ddc91164229d3652">projectile_attack_roll</a></div><div class="ttdeci">projectile_attack_aim projectile_attack_roll(const dispersion_sources &amp;dispersion, double range, double target_size)</div><div class="ttdoc">Evaluates dispersion sources, range, and target to determine attack trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="ballistics_8cpp_source.html#l00174">ballistics.cpp:174</a></div></div>
<div class="ttc" id="aballistics_8cpp_html_af96b03314ba7a36b8a04b9ee5bacb7f9"><div class="ttname"><a href="ballistics_8cpp.html#af96b03314ba7a36b8a04b9ee5bacb7f9">blood_trail_len</a></div><div class="ttdeci">static size_t blood_trail_len(int damage)</div><div class="ttdef"><b>Definition:</b> <a href="ballistics_8cpp_source.html#l00162">ballistics.cpp:162</a></div></div>
<div class="ttc" id="aballistics_8cpp_html_aff212e96c8be59a183e8b9fb955379a2"><div class="ttname"><a href="ballistics_8cpp.html#aff212e96c8be59a183e8b9fb955379a2">json_flag_HARDTOHIT</a></div><div class="ttdeci">static const json_character_flag json_flag_HARDTOHIT(&quot;HARDTOHIT&quot;)</div></div>
<div class="ttc" id="aballistics_8h_html"><div class="ttname"><a href="ballistics_8h.html">ballistics.h</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_a4249b6f1d0842211bfe53e5f9e206a10"><div class="ttname"><a href="calendar_8cpp.html#a4249b6f1d0842211bfe53e5f9e206a10">rng</a></div><div class="ttdeci">time_duration rng(time_duration lo, time_duration hi)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00779">calendar.cpp:779</a></div></div>
<div class="ttc" id="acalendar_8h_html"><div class="ttname"><a href="calendar_8h.html">calendar.h</a></div></div>
<div class="ttc" id="acharacter_8h_html"><div class="ttname"><a href="character_8h.html">character.h</a></div></div>
<div class="ttc" id="acharacter_8h_html_a985ec90ebcfc217cb519552102436f40"><div class="ttname"><a href="character_8h.html#a985ec90ebcfc217cb519552102436f40">blood_type</a></div><div class="ttdeci">blood_type</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00249">character.h:249</a></div></div>
<div class="ttc" id="aclassCharacter_html_aaaec0279242f05b51af5c8b7bb416bb1"><div class="ttname"><a href="classCharacter.html#aaaec0279242f05b51af5c8b7bb416bb1">Character::has_flag</a></div><div class="ttdeci">bool has_flag(const json_character_flag &amp;flag) const</div><div class="ttdoc">Returns true if player has a trait, bionic, effect, bodypart, or martial arts buff with a flag.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l11967">character.cpp:11967</a></div></div>
<div class="ttc" id="aclassCreature_html"><div class="ttname"><a href="classCreature.html">Creature</a></div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00250">creature.h:251</a></div></div>
<div class="ttc" id="aclassCreature_html_a16fbfd5268fd73935e5211bc1fa08617"><div class="ttname"><a href="classCreature.html#a16fbfd5268fd73935e5211bc1fa08617">Creature::deal_projectile_attack</a></div><div class="ttdeci">virtual void deal_projectile_attack(Creature *source, dealt_projectile_attack &amp;attack, bool print_messages=true, const weakpoint_attack &amp;wp_attack=weakpoint_attack())</div><div class="ttdoc">Attempts to harm a creature with a projectile.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01121">creature.cpp:1121</a></div></div>
<div class="ttc" id="aclassCreature_html_a1a65722d07102550f16d17ebd79e2743"><div class="ttname"><a href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">Creature::pos</a></div><div class="ttdeci">tripoint pos() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00178">creature.cpp:178</a></div></div>
<div class="ttc" id="aclassCreature_html_a1c8ea56d06ff96a720201c46a40969aa"><div class="ttname"><a href="classCreature.html#a1c8ea56d06ff96a720201c46a40969aa">Creature::ranged_target_size</a></div><div class="ttdeci">double ranged_target_size() const</div><div class="ttdoc">Size of the target this creature presents to ranged weapons.</div><div class="ttdef"><b>Definition:</b> <a href="ranged_8cpp_source.html#l00547">ranged.cpp:547</a></div></div>
<div class="ttc" id="aclassCreature_html_a55d12f92d62a7c89c44b466d7e7cb00d"><div class="ttname"><a href="classCreature.html#a55d12f92d62a7c89c44b466d7e7cb00d">Creature::as_character</a></div><div class="ttdeci">virtual Character * as_character()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00274">creature.h:274</a></div></div>
<div class="ttc" id="aclassCreature_html_a5698402eb4d7bbb013213f11f5768c92"><div class="ttname"><a href="classCreature.html#a5698402eb4d7bbb013213f11f5768c92">Creature::attitude_to</a></div><div class="ttdeci">virtual Attitude attitude_to(const Creature &amp;other) const =0</div><div class="ttdoc">Attitude (of this creature) towards another creature.</div></div>
<div class="ttc" id="aclassCreature_html_a5881c150a3ed435f757e0b34b0d1009e"><div class="ttname"><a href="classCreature.html#a5881c150a3ed435f757e0b34b0d1009e">Creature::get_name</a></div><div class="ttdeci">virtual std::string get_name() const =0</div></div>
<div class="ttc" id="aclassCreature_html_a5c6d320a21d767c65c807fe563c4b2c9"><div class="ttname"><a href="classCreature.html#a5c6d320a21d767c65c807fe563c4b2c9">Creature::bloodType</a></div><div class="ttdeci">virtual field_type_id bloodType() const =0</div></div>
<div class="ttc" id="aclassCreature_html_a5de5f5e0d08deb03b68749608eb360b2"><div class="ttname"><a href="classCreature.html#a5de5f5e0d08deb03b68749608eb360b2">Creature::as_npc</a></div><div class="ttdeci">virtual npc * as_npc()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00286">creature.h:286</a></div></div>
<div class="ttc" id="aclassCreature_html_a666022fd3ed772fa109d273c20e8de55"><div class="ttname"><a href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">Creature::add_effect</a></div><div class="ttdeci">void add_effect(const effect &amp;eff, bool force=false, bool deferred=false)</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00604">creature.h:604</a></div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217af6a34a956d1ce0a552bf4731b9f9d9c0">Creature::Attitude::FRIENDLY</a></div><div class="ttdeci">@ FRIENDLY</div></div>
<div class="ttc" id="aclassCreature_html_ac209d32cbfd3774af3d5c0500e2fae52"><div class="ttname"><a href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">Creature::is_avatar</a></div><div class="ttdeci">virtual bool is_avatar() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00265">creature.h:265</a></div></div>
<div class="ttc" id="aclassCreature_html_aed84fe52e1335d48d53f482f8a278c87"><div class="ttname"><a href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">Creature::is_npc</a></div><div class="ttdeci">virtual bool is_npc() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00268">creature.h:268</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html"><div class="ttname"><a href="classcreature__tracker.html">creature_tracker</a></div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8h_source.html#l00024">creature_tracker.h:25</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html_aba3c6663688bcd1806ea685d6961cb72"><div class="ttname"><a href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_tracker::creature_at</a></div><div class="ttdeci">T * creature_at(const tripoint &amp;p, bool allow_hallucination=false)</div><div class="ttdoc">Returns the Creature at the given location.</div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8cpp_source.html#l00303">creature_tracker.cpp:303</a></div></div>
<div class="ttc" id="aclassdispersion__sources_html"><div class="ttname"><a href="classdispersion__sources.html">dispersion_sources</a></div><div class="ttdef"><b>Definition:</b> <a href="dispersion_8h_source.html#l00008">dispersion.h:9</a></div></div>
<div class="ttc" id="aclassdispersion__sources_html_acaee96ee2b8a0c87b6fb5a9e2d4285d9"><div class="ttname"><a href="classdispersion__sources.html#acaee96ee2b8a0c87b6fb5a9e2d4285d9">dispersion_sources::roll</a></div><div class="ttdeci">double roll() const</div><div class="ttdef"><b>Definition:</b> <a href="dispersion_8cpp_source.html#l00005">dispersion.cpp:5</a></div></div>
<div class="ttc" id="aclassint__id_html"><div class="ttname"><a href="classint__id.html">int_id&lt; field_type &gt;</a></div></div>
<div class="ttc" id="aclassitem_html"><div class="ttname"><a href="classitem.html">item</a></div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l00195">item.h:196</a></div></div>
<div class="ttc" id="aclassitem_html_a2ea9b8df7dba40fc847f51563285f5aa"><div class="ttname"><a href="classitem.html#a2ea9b8df7dba40fc847f51563285f5aa">item::spill_contents</a></div><div class="ttdeci">bool spill_contents(Character &amp;c)</div><div class="ttdoc">Unloads the item's contents.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l10206">item.cpp:10206</a></div></div>
<div class="ttc" id="aclassitem_html_a30837987c08ac5daf3b1e377e0ecaa21"><div class="ttname"><a href="classitem.html#a30837987c08ac5daf3b1e377e0ecaa21">item::tname</a></div><div class="ttdeci">std::string tname(unsigned int quantity=1, tname::segment_bitset const &amp;segments=tname::default_tname) const</div><div class="ttdoc">Return the (translated) item name.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06814">item.cpp:6814</a></div></div>
<div class="ttc" id="aclassitem_html_a4d5555082454b3cb192f59a70838c891"><div class="ttname"><a href="classitem.html#a4d5555082454b3cb192f59a70838c891">item::is_null</a></div><div class="ttdeci">bool is_null() const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l00931">item.cpp:931</a></div></div>
<div class="ttc" id="aclassitem_html_a686df014e8aa8bc4637883802d05f935"><div class="ttname"><a href="classitem.html#a686df014e8aa8bc4637883802d05f935">item::volume</a></div><div class="ttdeci">units::volume volume(bool integral=false, bool ignore_contents=false, int charges_in_vol=-1) const</div><div class="ttdoc">Total volume of an item accounting for all contained/integrated items NOTE: Result is rounded up to n...</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07360">item.cpp:7360</a></div></div>
<div class="ttc" id="aclassitem_html_ac1d2c4c33b8a499812f3437cb2fad742"><div class="ttname"><a href="classitem.html#ac1d2c4c33b8a499812f3437cb2fad742">item::type</a></div><div class="ttdeci">const itype * type</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l03074">item.h:3074</a></div></div>
<div class="ttc" id="aclassitem_html_ac8356682e1760d4b4d4f62353eeb9ba9"><div class="ttname"><a href="classitem.html#ac8356682e1760d4b4d4f62353eeb9ba9">item::activate_thrown</a></div><div class="ttdeci">bool activate_thrown(const tripoint &amp;pos)</div><div class="ttdoc">Invoke use function on a thrown item that had &quot;ACT_ON_RANGED_HIT&quot; flag.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l00696">item.cpp:696</a></div></div>
<div class="ttc" id="aclassmap_html"><div class="ttname"><a href="classmap.html">map</a></div><div class="ttdoc">Manage and cache data about a part of the map.</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00345">map.h:346</a></div></div>
<div class="ttc" id="aclassmap_html_a0f73359be972a030063b4e84f770275e"><div class="ttname"><a href="classmap.html#a0f73359be972a030063b4e84f770275e">map::find_clear_path</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; find_clear_path(const tripoint &amp;source, const tripoint &amp;destination) const</div><div class="ttdoc">Iteratively tries Bresenham lines with different biases until it finds a clear line or decides there ...</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l07616">map.cpp:7616</a></div></div>
<div class="ttc" id="aclassmap_html_a150f1b826e0e2722ccf76dbdac136ffd"><div class="ttname"><a href="classmap.html#a150f1b826e0e2722ccf76dbdac136ffd">map::emit_field</a></div><div class="ttdeci">void emit_field(const tripoint &amp;pos, const emit_id &amp;src, float mul=1.0f)</div><div class="ttdoc">Runs one cycle of emission src which may result in propagation of fields.</div><div class="ttdef"><b>Definition:</b> <a href="map__field_8cpp_source.html#l02102">map_field.cpp:2102</a></div></div>
<div class="ttc" id="aclassmap_html_a27e22f0999ea03eff18babc48643c568"><div class="ttname"><a href="classmap.html#a27e22f0999ea03eff18babc48643c568">map::has_flag</a></div><div class="ttdeci">bool has_flag(const std::string &amp;flag, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03077">map.cpp:3077</a></div></div>
<div class="ttc" id="aclassmap_html_a30089f97bb31ba2ca2243c178a4a3c65"><div class="ttname"><a href="classmap.html#a30089f97bb31ba2ca2243c178a4a3c65">map::shoot</a></div><div class="ttdeci">void shoot(const tripoint &amp;p, projectile &amp;proj, bool hit_items)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l04484">map.cpp:4484</a></div></div>
<div class="ttc" id="aclassmap_html_a30ccb67ed3651d350f2caf214e0b5176"><div class="ttname"><a href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">map::tr_at</a></div><div class="ttdeci">const trap &amp; tr_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06213">map.cpp:6213</a></div></div>
<div class="ttc" id="aclassmap_html_a34187b9eff71461437403611d0d122a7"><div class="ttname"><a href="classmap.html#a34187b9eff71461437403611d0d122a7">map::ranged_target_size</a></div><div class="ttdeci">double ranged_target_size(const tripoint &amp;p) const</div><div class="ttdoc">Size of map objects at p for purposes of ranged combat.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02638">map.cpp:2638</a></div></div>
<div class="ttc" id="aclassmap_html_a522fd89a4564c34f30ed629a00aa28fe"><div class="ttname"><a href="classmap.html#a522fd89a4564c34f30ed629a00aa28fe">map::add_splatter_trail</a></div><div class="ttdeci">void add_splatter_trail(const field_type_id &amp;type, const tripoint &amp;from, const tripoint &amp;to)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06713">map.cpp:6713</a></div></div>
<div class="ttc" id="aclassmap_html_a5579e13088b4ccd9c5a75458919d528a"><div class="ttname"><a href="classmap.html#a5579e13088b4ccd9c5a75458919d528a">map::add_item_or_charges</a></div><div class="ttdeci">item &amp; add_item_or_charges(const tripoint &amp;pos, item obj, bool overflow=true)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l05177">map.cpp:5177</a></div></div>
<div class="ttc" id="aclassmap_html_a78e0a35a5041e0daf6e7a2a4ec522014"><div class="ttname"><a href="classmap.html#a78e0a35a5041e0daf6e7a2a4ec522014">map::has_floor_or_water</a></div><div class="ttdeci">bool has_floor_or_water(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02703">map.cpp:2703</a></div></div>
<div class="ttc" id="aclassmap_html_a802cc11379d4be61f4e2b13a50f6390e"><div class="ttname"><a href="classmap.html#a802cc11379d4be61f4e2b13a50f6390e">map::impassable</a></div><div class="ttdeci">bool impassable(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02462">map.cpp:2462</a></div></div>
<div class="ttc" id="aclassmap_html_aa487d96256c3d35db7a1bf273156b64a"><div class="ttname"><a href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">map::veh_at</a></div><div class="ttdeci">optional_vpart_position veh_at(const tripoint &amp;p) const</div><div class="ttdoc">Checks if tile is occupied by vehicle and by which part.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01316">map.cpp:1316</a></div></div>
<div class="ttc" id="aclassmap_html_aa8a67baac3cc72b2f5fbd669894587a0"><div class="ttname"><a href="classmap.html#aa8a67baac3cc72b2f5fbd669894587a0">map::sees</a></div><div class="ttdeci">bool sees(const tripoint &amp;F, const tripoint &amp;T, int range, bool with_fields=true) const</div><div class="ttdoc">Returns whether F sees T with a view range of range.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l07377">map.cpp:7377</a></div></div>
<div class="ttc" id="aclassmap_html_af563dc2397e71a053569cb45c6bb7e77"><div class="ttname"><a href="classmap.html#af563dc2397e71a053569cb45c6bb7e77">map::passable</a></div><div class="ttdeci">bool passable(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02472">map.cpp:2472</a></div></div>
<div class="ttc" id="aclassmonster_html"><div class="ttname"><a href="classmonster.html">monster</a></div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00085">monster.h:86</a></div></div>
<div class="ttc" id="aclassmonster_html_a6a50c1ca1b7405a717c95bac530e9e07"><div class="ttname"><a href="classmonster.html#a6a50c1ca1b7405a717c95bac530e9e07">monster::add_item</a></div><div class="ttdeci">void add_item(const item &amp;it)</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l03455">monster.cpp:3455</a></div></div>
<div class="ttc" id="aclassmonster_html_a7a6be5e2dd4d5b14d1b9ccb61b1b4f6d"><div class="ttname"><a href="classmonster.html#a7a6be5e2dd4d5b14d1b9ccb61b1b4f6d">monster::is_dead_state</a></div><div class="ttdeci">bool is_dead_state() const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01865">monster.cpp:1865</a></div></div>
<div class="ttc" id="aclassmonster_html_ab92cac0ecb2b2062fd4f821b671f86ac"><div class="ttname"><a href="classmonster.html#ab92cac0ecb2b2062fd4f821b671f86ac">monster::get_size</a></div><div class="ttdeci">creature_size get_size() const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l03503">monster.cpp:3503</a></div></div>
<div class="ttc" id="aclassmonster_html_af3444e4763b1dd53e75c5ea50fd8ba9f"><div class="ttname"><a href="classmonster.html#af3444e4763b1dd53e75c5ea50fd8ba9f">monster::disp_name</a></div><div class="ttdeci">std::string disp_name(bool possessive=false, bool capitalize_first=false) const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l00775">monster.cpp:775</a></div></div>
<div class="ttc" id="aclassmonster_html_af705eea6e40e12d7866010955602c7b5"><div class="ttname"><a href="classmonster.html#af705eea6e40e12d7866010955602c7b5">monster::digging</a></div><div class="ttdeci">bool digging() const override</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01247">monster.cpp:1247</a></div></div>
<div class="ttc" id="aclassnpc_html_a965eb2beb1c490bb1b8efef1c07e20d0"><div class="ttname"><a href="classnpc.html#a965eb2beb1c490bb1b8efef1c07e20d0">npc::on_attacked</a></div><div class="ttdeci">void on_attacked(const Creature &amp;attacker)</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l01650">npc.cpp:1650</a></div></div>
<div class="ttc" id="aclassoptional__vpart__position_html"><div class="ttname"><a href="classoptional__vpart__position.html">optional_vpart_position</a></div><div class="ttdoc">Simple wrapper to forward functions that may return a std::optional to vpart_position.</div><div class="ttdef"><b>Definition:</b> <a href="vpart__position_8h_source.html#l00124">vpart_position.h:125</a></div></div>
<div class="ttc" id="aclassstring__id_html"><div class="ttname"><a href="classstring__id.html">string_id&lt; effect_type &gt;</a></div></div>
<div class="ttc" id="aclassunits_1_1quantity_html"><div class="ttname"><a href="classunits_1_1quantity.html">units::quantity</a></div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00028">units.h:29</a></div></div>
<div class="ttc" id="aclassvehicle_html"><div class="ttname"><a href="classvehicle.html">vehicle</a></div><div class="ttdoc">A vehicle as a whole with all its components.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00801">vehicle.h:802</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a8e2cbab6dac12095f06b4cff66857fbb"><div class="ttname"><a href="coordinates_8h.html#a8e2cbab6dac12095f06b4cff66857fbb">rl_dist</a></div><div class="ttdeci">int rl_dist(const coords::coord_point&lt; Point, Origin, Scale, LhsInBounds &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale, RhsInBounds &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00769">coordinates.h:769</a></div></div>
<div class="ttc" id="acreature_8h_html"><div class="ttname"><a href="creature_8h.html">creature.h</a></div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2">creature_size</a></div><div class="ttdeci">creature_size</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00068">creature.h:68</a></div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2ad60cadf1a41c651e1f0ade50136bad43">creature_size::tiny</a></div><div class="ttdeci">@ tiny</div></div>
<div class="ttc" id="acreature_8h_html_a72acd342747a434c8b399cdceeadeea2aeb5c1399a871211c7e7ed732d15e3a8b"><div class="ttname"><a href="creature_8h.html#a72acd342747a434c8b399cdceeadeea2aeb5c1399a871211c7e7ed732d15e3a8b">creature_size::small</a></div><div class="ttdeci">@ small</div></div>
<div class="ttc" id="acreature__tracker_8h_html"><div class="ttname"><a href="creature__tracker_8h.html">creature_tracker.h</a></div></div>
<div class="ttc" id="acreature__tracker_8h_html_a16f631f70e72b53e590770670fb301fb"><div class="ttname"><a href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a></div><div class="ttdeci">creature_tracker &amp; get_creature_tracker()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13827">game.cpp:13827</a></div></div>
<div class="ttc" id="adamage_8h_html"><div class="ttname"><a href="damage_8h.html">damage.h</a></div></div>
<div class="ttc" id="adebug_8h_html"><div class="ttname"><a href="debug_8h.html">debug.h</a></div></div>
<div class="ttc" id="adebug_8h_html_a87e509562277a7ada3a75330d00cb445"><div class="ttname"><a href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a></div><div class="ttdeci">#define debugmsg(...)</div><div class="ttdoc">Debug message of level D_ERROR and class D_MAIN, also includes the source file name and line,...</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00069">debug.h:69</a></div></div>
<div class="ttc" id="adispersion_8h_html"><div class="ttname"><a href="dispersion_8h.html">dispersion.h</a></div></div>
<div class="ttc" id="aenums_8h_html"><div class="ttname"><a href="enums_8h.html">enums.h</a></div></div>
<div class="ttc" id="aenums_8h_html_a89bed42d8e3efcd44570febc837f088e"><div class="ttname"><a href="enums_8h.html#a89bed42d8e3efcd44570febc837f088e">sgn</a></div><div class="ttdeci">constexpr int sgn(const T x)</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00010">enums.h:10</a></div></div>
<div class="ttc" id="aexplosion_8h_html"><div class="ttname"><a href="explosion_8h.html">explosion.h</a></div></div>
<div class="ttc" id="agame_8cpp_html_abeb98e93502d73818b4a73fabe191bc1"><div class="ttname"><a href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a></div><div class="ttdeci">std::unique_ptr&lt; game &gt; g</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l00382">game.cpp:382</a></div></div>
<div class="ttc" id="agame_8cpp_html_afa1063326b0c16b43c6f3dc8c3df403d"><div class="ttname"><a href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a></div><div class="ttdeci">map &amp; get_map()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13822">game.cpp:13822</a></div></div>
<div class="ttc" id="agame_8h_html"><div class="ttname"><a href="game_8h.html">game.h</a></div></div>
<div class="ttc" id="aitem_8h_html"><div class="ttname"><a href="item_8h.html">item.h</a></div></div>
<div class="ttc" id="aitype_8h_html"><div class="ttname"><a href="itype_8h.html">itype.h</a></div></div>
<div class="ttc" id="aline_8cpp_html_a2bd46cad079efd79854dffc0b97ce94b"><div class="ttname"><a href="line_8cpp.html#a2bd46cad079efd79854dffc0b97ce94b">continue_line</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; continue_line(const std::vector&lt; tripoint &gt; &amp;line, const int distance)</div><div class="ttdef"><b>Definition:</b> <a href="line_8cpp_source.html#l00380">line.cpp:380</a></div></div>
<div class="ttc" id="aline_8cpp_html_a755929144f419e0be862e2a7a87b6ab7"><div class="ttname"><a href="line_8cpp.html#a755929144f419e0be862e2a7a87b6ab7">iso_tangent</a></div><div class="ttdeci">double iso_tangent(double distance, const units::angle &amp;vertex)</div><div class="ttdoc">Calculate base of an isosceles triangle.</div><div class="ttdef"><b>Definition:</b> <a href="line_8cpp_source.html#l00020">line.cpp:20</a></div></div>
<div class="ttc" id="aline_8cpp_html_a9d579f76fbf6ae5f314d294593448d94"><div class="ttname"><a href="line_8cpp.html#a9d579f76fbf6ae5f314d294593448d94">move_along_line</a></div><div class="ttdeci">tripoint move_along_line(const tripoint &amp;loc, const std::vector&lt; tripoint &gt; &amp;line, const int distance)</div><div class="ttdef"><b>Definition:</b> <a href="line_8cpp_source.html#l00367">line.cpp:367</a></div></div>
<div class="ttc" id="aline_8h_html"><div class="ttname"><a href="line_8h.html">line.h</a></div></div>
<div class="ttc" id="amake__static_8h_html"><div class="ttname"><a href="make__static_8h.html">make_static.h</a></div></div>
<div class="ttc" id="amake__static_8h_html_ad8ea997925f9b41fffbf138f4c05e09f"><div class="ttname"><a href="make__static_8h.html#ad8ea997925f9b41fffbf138f4c05e09f">STATIC</a></div><div class="ttdeci">#define STATIC(expr)</div><div class="ttdoc">The purpose of this macro is to provide a concise syntax for creation of inline literals (std::string...</div><div class="ttdef"><b>Definition:</b> <a href="make__static_8h_source.html#l00031">make_static.h:31</a></div></div>
<div class="ttc" id="amap_8h_html"><div class="ttname"><a href="map_8h.html">map.h</a></div></div>
<div class="ttc" id="amapdata_8h_html"><div class="ttname"><a href="mapdata_8h.html">mapdata.h</a></div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a7518f40a34b4cbfbc922c4888af267cc"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a7518f40a34b4cbfbc922c4888af267cc">ter_furn_flag::TFLAG_LIQUID</a></div><div class="ttdeci">@ TFLAG_LIQUID</div></div>
<div class="ttc" id="amath__parser__func_8h_html_a204ca52ef1b97d079c45e1cb6407f73b"><div class="ttname"><a href="math__parser__func_8h.html#a204ca52ef1b97d079c45e1cb6407f73b">floor</a></div><div class="ttdeci">double floor(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00095">math_parser_func.h:95</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a3d9f495ca19a6110e624fc1d0ed3da74"><div class="ttname"><a href="math__parser__func_8h.html#a3d9f495ca19a6110e624fc1d0ed3da74">sin</a></div><div class="ttdeci">double sin(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00071">math_parser_func.h:71</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a9009aa9e5eb1323238ebddffd8e1aedf"><div class="ttname"><a href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">max</a></div><div class="ttdeci">double max(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00035">math_parser_func.h:35</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a993dede52d23a9a3d15b01a342391ef4"><div class="ttname"><a href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">min</a></div><div class="ttdeci">double min(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00043">math_parser_func.h:43</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_aa178d72bf03c69677934a8c977f3b850"><div class="ttname"><a href="math__parser__func_8h.html#aa178d72bf03c69677934a8c977f3b850">cos</a></div><div class="ttdeci">double cos(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00076">math_parser_func.h:76</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_aeb3bbc4ec861ea58cbfca028920e4cc6"><div class="ttname"><a href="math__parser__func_8h.html#aeb3bbc4ec861ea58cbfca028920e4cc6">sqrt</a></div><div class="ttdeci">double sqrt(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00061">math_parser_func.h:61</a></div></div>
<div class="ttc" id="amessages_8cpp_html_a3ea1aed1d11cd410cce07fb5be7aa34f"><div class="ttname"><a href="messages_8cpp.html#a3ea1aed1d11cd410cce07fb5be7aa34f">add_msg_if_player_sees</a></div><div class="ttdeci">void add_msg_if_player_sees(const tripoint &amp;target, std::string msg)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8cpp_source.html#l01007">messages.cpp:1007</a></div></div>
<div class="ttc" id="amessages_8cpp_html_a54489326fc37823819c5105addfa27f2"><div class="ttname"><a href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a></div><div class="ttdeci">void add_msg(std::string msg)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8cpp_source.html#l00997">messages.cpp:997</a></div></div>
<div class="ttc" id="amessages_8h_html"><div class="ttname"><a href="messages_8h.html">messages.h</a></div></div>
<div class="ttc" id="amessages_8h_html_ab6590bda29b082a7282bcc1a9cc8f02a"><div class="ttname"><a href="messages_8h.html#ab6590bda29b082a7282bcc1a9cc8f02a">add_msg_debug</a></div><div class="ttdeci">#define add_msg_debug(type,...)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8h_source.html#l00177">messages.h:177</a></div></div>
<div class="ttc" id="amonster_8h_html"><div class="ttname"><a href="monster_8h.html">monster.h</a></div></div>
<div class="ttc" id="anamespacecoords_html_ad99808a305ad40299e592d1266bed4a7"><div class="ttname"><a href="namespacecoords.html#ad99808a305ad40299e592d1266bed4a7">coords::origin</a></div><div class="ttdeci">origin</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00065">coordinates.h:65</a></div></div>
<div class="ttc" id="anamespacedebugmode_html_ac654a55a1b56b11554103f87859968f2a0280ceb7e7edc880f2d9625ea9852dd9"><div class="ttname"><a href="namespacedebugmode.html#ac654a55a1b56b11554103f87859968f2a0280ceb7e7edc880f2d9625ea9852dd9">debugmode::DF_BALLISTIC</a></div><div class="ttdeci">@ DF_BALLISTIC</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00249">debug.h:249</a></div></div>
<div class="ttc" id="anamespaceexplosion__handler_html_af4ae8e07a9627dbfe22b2d07ea577587"><div class="ttname"><a href="namespaceexplosion__handler.html#af4ae8e07a9627dbfe22b2d07ea577587">explosion_handler::explosion</a></div><div class="ttdeci">void explosion(const Creature *source, const tripoint &amp;p, float power, float factor, bool fire, int casing_mass, float frag_mass)</div><div class="ttdoc">Queue an explosion at p of intensity (power) with (shrapnel) chunks of shrapnel.</div><div class="ttdef"><b>Definition:</b> <a href="explosion_8cpp_source.html#l00489">explosion.cpp:489</a></div></div>
<div class="ttc" id="anamespacesfx_html_a1f138eaa92db132e81ce591751c512cc"><div class="ttname"><a href="namespacesfx.html#a1f138eaa92db132e81ce591751c512cc">sfx::get_heard_volume</a></div><div class="ttdeci">int get_heard_volume(const tripoint &amp;source)</div><div class="ttdoc">Functions from sfx that do not use the SDL_mixer API at all.</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8cpp_source.html#l02045">sounds.cpp:2045</a></div></div>
<div class="ttc" id="anamespacesfx_html_a8fa2bb887ac81392fb686cc4079b5d5a"><div class="ttname"><a href="namespacesfx.html#a8fa2bb887ac81392fb686cc4079b5d5a">sfx::play_variant_sound</a></div><div class="ttdeci">void play_variant_sound(const std::string &amp;id, const std::string &amp;variant, int volume, units::angle angle, double pitch_min=-1.0, double pitch_max=-1.0)</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8cpp_source.html#l01999">sounds.cpp:1999</a></div></div>
<div class="ttc" id="anamespacesfx_html_aa186eb63210729f73d7c76dcda527ff5"><div class="ttname"><a href="namespacesfx.html#aa186eb63210729f73d7c76dcda527ff5">sfx::get_heard_angle</a></div><div class="ttdeci">units::angle get_heard_angle(const tripoint &amp;source)</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8cpp_source.html#l02058">sounds.cpp:2058</a></div></div>
<div class="ttc" id="anamespacesfx_html_abd0353422210027726055778b4605e23"><div class="ttname"><a href="namespacesfx.html#abd0353422210027726055778b4605e23">sfx::do_projectile_hit</a></div><div class="ttdeci">void do_projectile_hit(const Creature &amp;target)</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8cpp_source.html#l02011">sounds.cpp:2011</a></div></div>
<div class="ttc" id="anamespacesounds_html_a6bb79ae1c9c3dcd8c8e0b28c66b0398d"><div class="ttname"><a href="namespacesounds.html#a6bb79ae1c9c3dcd8c8e0b28c66b0398d">sounds::sound</a></div><div class="ttdeci">void sound(const tripoint &amp;p, int vol, sound_t category, const std::string &amp;description, bool ambient=false, const std::string &amp;id=&quot;&quot;, const std::string &amp;variant=&quot;default&quot;)</div><div class="ttdoc">Sound at (p) of intensity (vol)</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8cpp_source.html#l00318">sounds.cpp:318</a></div></div>
<div class="ttc" id="anamespacesounds_html_af6b3d144906d9ccfda6824fb87e46aa3ac222ae0d4e9c59bd254b72521b9e74ed"><div class="ttname"><a href="namespacesounds.html#af6b3d144906d9ccfda6824fb87e46aa3ac222ae0d4e9c59bd254b72521b9e74ed">sounds::sound_t::combat</a></div><div class="ttdeci">@ combat</div></div>
<div class="ttc" id="anamespacespell__effect_html_acfe36e6436b9cc2e3060fc5541bded22"><div class="ttname"><a href="namespacespell__effect.html#acfe36e6436b9cc2e3060fc5541bded22">spell_effect::attack</a></div><div class="ttdeci">void attack(const spell &amp;sp, Creature &amp;caster, const tripoint &amp;epicenter)</div><div class="ttdef"><b>Definition:</b> <a href="magic__spell__effect_8cpp_source.html#l00581">magic_spell_effect.cpp:581</a></div></div>
<div class="ttc" id="anamespacetarget__handler_html_aea843144f5e69546ddea88eeda177640"><div class="ttname"><a href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">target_handler::trajectory</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; trajectory</div><div class="ttdef"><b>Definition:</b> <a href="ranged_8h_source.html#l00029">ranged.h:29</a></div></div>
<div class="ttc" id="anamespaceunits_html_a69513b1c48b5d7da935832d5d25b2e11"><div class="ttname"><a href="namespaceunits.html#a69513b1c48b5d7da935832d5d25b2e11">units::atan2</a></div><div class="ttdeci">units::angle atan2(double y, double x)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l01122">units.h:1122</a></div></div>
<div class="ttc" id="anamespaceunits_html_a8306911daadc1a4d7a7b46e9786f4a4c"><div class="ttname"><a href="namespaceunits.html#a8306911daadc1a4d7a7b46e9786f4a4c">units::to_gram</a></div><div class="ttdeci">constexpr value_type to_gram(const quantity&lt; value_type, mass_in_milligram_tag &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00364">units.h:364</a></div></div>
<div class="ttc" id="anamespaceunits_html_ae3cb4452221bae58dc798b8fc5865007"><div class="ttname"><a href="namespaceunits.html#ae3cb4452221bae58dc798b8fc5865007">units::from_arcmin</a></div><div class="ttdeci">constexpr quantity&lt; double, angle_in_radians_tag &gt; from_arcmin(const value_type v)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00763">units.h:763</a></div></div>
<div class="ttc" id="anpc_8h_html"><div class="ttname"><a href="npc_8h.html">npc.h</a></div></div>
<div class="ttc" id="aomdata_8h_html_a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf"><div class="ttname"><a href="omdata_8h.html#a34fa26d94d253aff79aacd4ffbc1505da795f3202b17cb6bc3d4b771d8c6c9eaf">oter_travel_cost_type::other</a></div><div class="ttdeci">@ other</div></div>
<div class="ttc" id="aoptions_8h_html"><div class="ttname"><a href="options_8h.html">options.h</a></div></div>
<div class="ttc" id="apoint_8h_html"><div class="ttname"><a href="point_8h.html">point.h</a></div></div>
<div class="ttc" id="aprojectile_8cpp_html_a94546cfedf6b069ea55ca1d4c587bb93"><div class="ttname"><a href="projectile_8cpp.html#a94546cfedf6b069ea55ca1d4c587bb93">apply_ammo_effects</a></div><div class="ttdeci">void apply_ammo_effects(const Creature *source, const tripoint &amp;p, const std::set&lt; std::string &gt; &amp;effects)</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8cpp_source.html#l00142">projectile.cpp:142</a></div></div>
<div class="ttc" id="aprojectile_8h_html"><div class="ttname"><a href="projectile_8h.html">projectile.h</a></div></div>
<div class="ttc" id="arng_8cpp_html_a0c88381d6334a2fbaa726c53f5cf9bb9"><div class="ttname"><a href="rng_8cpp.html#a0c88381d6334a2fbaa726c53f5cf9bb9">rng_float</a></div><div class="ttdeci">double rng_float(double lo, double hi)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00027">rng.cpp:27</a></div></div>
<div class="ttc" id="arng_8cpp_html_aad28bdad07401a34ecf9912708f8b750"><div class="ttname"><a href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a></div><div class="ttdeci">bool one_in(int chance)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00108">rng.cpp:108</a></div></div>
<div class="ttc" id="arng_8cpp_html_acd19ae79e3590a99c9eaf0389318b686"><div class="ttname"><a href="rng_8cpp.html#acd19ae79e3590a99c9eaf0389318b686">roll_remainder</a></div><div class="ttdeci">int roll_remainder(double value)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00134">rng.cpp:134</a></div></div>
<div class="ttc" id="arng_8h_html"><div class="ttname"><a href="rng_8h.html">rng.h</a></div></div>
<div class="ttc" id="asounds_8h_html"><div class="ttname"><a href="sounds_8h.html">sounds.h</a></div></div>
<div class="ttc" id="astructdamage__instance_html_a96f6f6d008ed8744ce549cefcfec3951"><div class="ttname"><a href="structdamage__instance.html#a96f6f6d008ed8744ce549cefcfec3951">damage_instance::total_damage</a></div><div class="ttdeci">float total_damage() const</div><div class="ttdef"><b>Definition:</b> <a href="damage_8cpp_source.html#l00372">damage.cpp:372</a></div></div>
<div class="ttc" id="astructdealt__damage__instance_html"><div class="ttname"><a href="structdealt__damage__instance.html">dealt_damage_instance</a></div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00193">damage.h:193</a></div></div>
<div class="ttc" id="astructdealt__projectile__attack_html"><div class="ttname"><a href="structdealt__projectile__attack.html">dealt_projectile_attack</a></div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00069">projectile.h:69</a></div></div>
<div class="ttc" id="astructexplosion__data_html"><div class="ttname"><a href="structexplosion__data.html">explosion_data</a></div><div class="ttdef"><b>Definition:</b> <a href="explosion_8h_source.html#l00035">explosion.h:35</a></div></div>
<div class="ttc" id="astructexplosion__data_html_a7611386ec7f61ad71a625f0b6750483c"><div class="ttname"><a href="structexplosion__data.html#a7611386ec7f61ad71a625f0b6750483c">explosion_data::power</a></div><div class="ttdeci">float power</div><div class="ttdef"><b>Definition:</b> <a href="explosion_8h_source.html#l00036">explosion.h:36</a></div></div>
<div class="ttc" id="astructitype_html_a4ecb806dae208ff275b4aa50ffcd3902"><div class="ttname"><a href="structitype.html#a4ecb806dae208ff275b4aa50ffcd3902">itype::weight</a></div><div class="ttdeci">units::mass weight</div><div class="ttdoc">Weight of item ( or each stack member )</div><div class="ttdef"><b>Definition:</b> <a href="itype_8h_source.html#l01234">itype.h:1234</a></div></div>
<div class="ttc" id="astructprojectile__attack__aim_html"><div class="ttname"><a href="structprojectile__attack__aim.html">projectile_attack_aim</a></div><div class="ttdoc">Aim result for a single projectile attack.</div><div class="ttdef"><b>Definition:</b> <a href="ballistics_8h_source.html#l00023">ballistics.h:23</a></div></div>
<div class="ttc" id="astructprojectile__attack__aim_html_a14a4264cb4cba8ae7fed2b02ecef56f4"><div class="ttname"><a href="structprojectile__attack__aim.html#a14a4264cb4cba8ae7fed2b02ecef56f4">projectile_attack_aim::dispersion</a></div><div class="ttdeci">double dispersion</div><div class="ttdef"><b>Definition:</b> <a href="ballistics_8h_source.html#l00029">ballistics.h:29</a></div></div>
<div class="ttc" id="astructprojectile__attack__aim_html_a9b41c3c133bd09fadd1eedc38d6eec28"><div class="ttname"><a href="structprojectile__attack__aim.html#a9b41c3c133bd09fadd1eedc38d6eec28">projectile_attack_aim::missed_by_tiles</a></div><div class="ttdeci">double missed_by_tiles</div><div class="ttdoc">Dispersion of this particular shot in arcminutes.</div><div class="ttdef"><b>Definition:</b> <a href="ballistics_8h_source.html#l00027">ballistics.h:27</a></div></div>
<div class="ttc" id="astructprojectile__attack__aim_html_ad7f823a6bf8cb8d013d9b8912236dd39"><div class="ttname"><a href="structprojectile__attack__aim.html#ad7f823a6bf8cb8d013d9b8912236dd39">projectile_attack_aim::missed_by</a></div><div class="ttdeci">double missed_by</div><div class="ttdoc">&lt; Hit quality, where 0.0 is a perfect hit and 1.0 is a miss</div><div class="ttdef"><b>Definition:</b> <a href="ballistics_8h_source.html#l00025">ballistics.h:25</a></div></div>
<div class="ttc" id="astructprojectile_html"><div class="ttname"><a href="structprojectile.html">projectile</a></div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00017">projectile.h:17</a></div></div>
<div class="ttc" id="astructprojectile_html_a312bc9a78fe7a5fdefb44e3755154db3"><div class="ttname"><a href="structprojectile.html#a312bc9a78fe7a5fdefb44e3755154db3">projectile::range</a></div><div class="ttdeci">int range</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00022">projectile.h:22</a></div></div>
<div class="ttc" id="astructprojectile_html_a370f9c2a4b37c7ed526f9d2fd1442328"><div class="ttname"><a href="structprojectile.html#a370f9c2a4b37c7ed526f9d2fd1442328">projectile::get_drop</a></div><div class="ttdeci">const item &amp; get_drop() const</div><div class="ttdoc">Returns an item that should be dropped or an item for which is_null() is true when item to drop is un...</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8cpp_source.html#l00062">projectile.cpp:62</a></div></div>
<div class="ttc" id="astructprojectile_html_a4536010a51aee3302d749f2eb4dcaf35"><div class="ttname"><a href="structprojectile.html#a4536010a51aee3302d749f2eb4dcaf35">projectile::proj_effects</a></div><div class="ttdeci">std::set&lt; std::string &gt; proj_effects</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00033">projectile.h:33</a></div></div>
<div class="ttc" id="astructprojectile_html_a5fcd41d46e5ffb373b840ae4f66e38c0"><div class="ttname"><a href="structprojectile.html#a5fcd41d46e5ffb373b840ae4f66e38c0">projectile::get_custom_explosion</a></div><div class="ttdeci">const explosion_data &amp; get_custom_explosion() const</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8cpp_source.html#l00095">projectile.cpp:95</a></div></div>
<div class="ttc" id="astructprojectile_html_a82d8f657f8cfc4e180c15bfab8ca8a6e"><div class="ttname"><a href="structprojectile.html#a82d8f657f8cfc4e180c15bfab8ca8a6e">projectile::impact</a></div><div class="ttdeci">damage_instance impact</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00018">projectile.h:18</a></div></div>
<div class="ttc" id="astructprojectile_html_aa2af53bce63feecb719ef1edba54689e"><div class="ttname"><a href="structprojectile.html#aa2af53bce63feecb719ef1edba54689e">projectile::speed</a></div><div class="ttdeci">int speed</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00021">projectile.h:21</a></div></div>
<div class="ttc" id="astructprojectile_html_ac535de1b5134a85ddcc5d1deffbf0d31"><div class="ttname"><a href="structprojectile.html#ac535de1b5134a85ddcc5d1deffbf0d31">projectile::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="projectile_8h_source.html#l00024">projectile.h:24</a></div></div>
<div class="ttc" id="astructtrap_html"><div class="ttname"><a href="structtrap.html">trap</a></div><div class="ttdoc">Some traps aren't actually traps in the usual sense of the word.</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00109">trap.h:109</a></div></div>
<div class="ttc" id="astructtrap_html_a7a862026cc04677a44a7d945c786edd0"><div class="ttname"><a href="structtrap.html#a7a862026cc04677a44a7d945c786edd0">trap::trigger</a></div><div class="ttdeci">void trigger(const tripoint &amp;pos, Creature *creature, item *item) const</div><div class="ttdoc">Trigger trap effects.</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00350">trap.cpp:350</a></div></div>
<div class="ttc" id="astructtrap_html_aa7bc509c6fa1aec956f63ec03980e593"><div class="ttname"><a href="structtrap.html#aa7bc509c6fa1aec956f63ec03980e593">trap::triggered_by_item</a></div><div class="ttdeci">bool triggered_by_item(const item &amp;itm) const</div><div class="ttdoc">If the given item is throw onto the trap, does it trigger the trap?</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00371">trap.cpp:371</a></div></div>
<div class="ttc" id="astructtripoint_html"><div class="ttname"><a href="structtripoint.html">tripoint</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00129">point.h:129</a></div></div>
<div class="ttc" id="astructtripoint_html_a89f6c0a16e2bfd7ce4f1f1d20404c4d7"><div class="ttname"><a href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">tripoint::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00133">point.h:133</a></div></div>
<div class="ttc" id="astructtripoint_html_ac944c0e329b5eba2602f7a52f66bbbb9"><div class="ttname"><a href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">tripoint::z</a></div><div class="ttdeci">int z</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00134">point.h:134</a></div></div>
<div class="ttc" id="astructtripoint_html_affdc0d5b75024cbfacd208a495def3dc"><div class="ttname"><a href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">tripoint::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00132">point.h:132</a></div></div>
<div class="ttc" id="astructweakpoint__attack_html"><div class="ttname"><a href="structweakpoint__attack.html">weakpoint_attack</a></div><div class="ttdef"><b>Definition:</b> <a href="weakpoint_8h_source.html#l00024">weakpoint.h:24</a></div></div>
<div class="ttc" id="atranslations_8h_html"><div class="ttname"><a href="translations_8h.html">translations.h</a></div></div>
<div class="ttc" id="atranslations_8h_html_ab92bb4161a6308b302d283816975c3a6"><div class="ttname"><a href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a></div><div class="ttdeci">#define _(STRING)</div><div class="ttdef"><b>Definition:</b> <a href="translations_8h_source.html#l00089">translations.h:89</a></div></div>
<div class="ttc" id="atrap_8h_html"><div class="ttname"><a href="trap_8h.html">trap.h</a></div></div>
<div class="ttc" id="atype__id_8h_html"><div class="ttname"><a href="type__id_8h.html">type_id.h</a></div></div>
<div class="ttc" id="atype__id_8h_html_a119965745ae171b731d18a45ec6ee424"><div class="ttname"><a href="type__id_8h.html#a119965745ae171b731d18a45ec6ee424">damage_type_id</a></div><div class="ttdeci">string_id&lt; damage_type &gt; damage_type_id</div><div class="ttdef"><b>Definition:</b> <a href="type__id_8h_source.html#l00071">type_id.h:71</a></div></div>
<div class="ttc" id="aunits_8h_html"><div class="ttname"><a href="units_8h.html">units.h</a></div></div>
<div class="ttc" id="avpart__position_8h_html"><div class="ttname"><a href="vpart__position_8h.html">vpart_position.h</a></div></div>
<div class="ttc" id="avpart__position_8h_html_a8da46e924794d004c9899494ecd600c5"><div class="ttname"><a href="vpart__position_8h.html#a8da46e924794d004c9899494ecd600c5">veh_pointer_or_null</a></div><div class="ttdeci">vehicle * veh_pointer_or_null(const optional_vpart_position &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="vpart__position_8h_source.html#l00185">vpart_position.h:185</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 7 2024 08:48:25 for Cataclysm DDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
