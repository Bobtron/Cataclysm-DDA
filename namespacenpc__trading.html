<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm DDA: npc_trading Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm DDA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">npc_trading Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9a7dbd65b9ae311c79c92b57c1b134b4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a9a7dbd65b9ae311c79c92b57c1b134b4">pay_npc</a> (<a class="el" href="classnpc.html">npc</a> &amp;np, int cost)</td></tr>
<tr class="separator:a9a7dbd65b9ae311c79c92b57c1b134b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2490551444a83c9bd12925dd1e7ff977"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a2490551444a83c9bd12925dd1e7ff977">bionic_install_price</a> (<a class="el" href="classCharacter.html">Character</a> &amp;installer, <a class="el" href="classCharacter.html">Character</a> &amp;patient, <a class="el" href="classitem__location.html">item_location</a> const &amp;<a class="el" href="structbionic.html">bionic</a>)</td></tr>
<tr class="separator:a2490551444a83c9bd12925dd1e7ff977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a1dc71c7127ed0ae5a1fbeaacd905a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a9a1dc71c7127ed0ae5a1fbeaacd905a8">adjusted_price</a> (<a class="el" href="classitem.html">item</a> const *it, int amount, <a class="el" href="classCharacter.html">Character</a> const &amp;buyer, <a class="el" href="classCharacter.html">Character</a> const &amp;seller)</td></tr>
<tr class="separator:a9a1dc71c7127ed0ae5a1fbeaacd905a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c6ad57efeb8277e46f6b3ccf694b0a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a3c6ad57efeb8277e46f6b3ccf694b0a8">trading_price</a> (<a class="el" href="classCharacter.html">Character</a> const &amp;buyer, <a class="el" href="classCharacter.html">Character</a> const &amp;seller, <a class="el" href="classtrade__selector.html#acc1eefbd7c542e087e293b0a6c5dfa62">trade_selector::entry_t</a> const &amp;it)</td></tr>
<tr class="separator:a3c6ad57efeb8277e46f6b3ccf694b0a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89082b8b3e67a3373f7a5ad57829475"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#aa89082b8b3e67a3373f7a5ad57829475">calc_npc_owes_you</a> (const <a class="el" href="classnpc.html">npc</a> &amp;np, int your_balance)</td></tr>
<tr class="separator:aa89082b8b3e67a3373f7a5ad57829475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6622f31806f7ffa96822e00b8029b6c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#ab6622f31806f7ffa96822e00b8029b6c">npc_will_accept_trade</a> (<a class="el" href="classnpc.html">npc</a> const &amp;np, int your_balance)</td></tr>
<tr class="separator:ab6622f31806f7ffa96822e00b8029b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecde799c1b4707a45ac4f7a41bbed685"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#aecde799c1b4707a45ac4f7a41bbed685">npc_can_fit_items</a> (<a class="el" href="classnpc.html">npc</a> const &amp;np, <a class="el" href="classtrade__selector.html#ab610cad0ff2e19dcf907caa91de0fa63">trade_selector::select_t</a> const &amp;to_trade)</td></tr>
<tr class="separator:aecde799c1b4707a45ac4f7a41bbed685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a374790fe36faf56af557a968526d21e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a374790fe36faf56af557a968526d21e0">update_npc_owed</a> (<a class="el" href="classnpc.html">npc</a> &amp;np, int your_balance, int your_sale_value)</td></tr>
<tr class="separator:a374790fe36faf56af557a968526d21e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a501e43e4b4136a85e2773fbc89f19e69"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a501e43e4b4136a85e2773fbc89f19e69">cash_to_favor</a> (const <a class="el" href="classnpc.html">npc</a> &amp;, int cash)</td></tr>
<tr class="separator:a501e43e4b4136a85e2773fbc89f19e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a2503a123d406c93f62cb6e0c34080"><td class="memItemLeft" align="right" valign="top">std::list&lt; <a class="el" href="classitem.html">item</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a74a2503a123d406c93f62cb6e0c34080">transfer_items</a> (<a class="el" href="classtrade__selector.html#ab610cad0ff2e19dcf907caa91de0fa63">trade_selector::select_t</a> &amp;stuff, <a class="el" href="classCharacter.html">Character</a> &amp;giver, <a class="el" href="classCharacter.html">Character</a> &amp;receiver, std::list&lt; <a class="el" href="classitem__location.html">item_location</a> * &gt; &amp;from_map, bool use_escrow)</td></tr>
<tr class="separator:a74a2503a123d406c93f62cb6e0c34080"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2393539b2984483097299124a5a15fd1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a2393539b2984483097299124a5a15fd1">net_price_adjustment</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;buyer, const <a class="el" href="classCharacter.html">Character</a> &amp;seller)</td></tr>
<tr class="separator:a2393539b2984483097299124a5a15fd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ec2aaaf5437ced34ea57f9bd818259d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a0ec2aaaf5437ced34ea57f9bd818259d">trade</a> (<a class="el" href="classnpc.html">npc</a> &amp;p, int cost, const std::string &amp;deal)</td></tr>
<tr class="separator:a0ec2aaaf5437ced34ea57f9bd818259d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b3f78b67eaf84ceddde10b1f8bac191"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classitem__pricing.html">item_pricing</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenpc__trading.html#a4b3f78b67eaf84ceddde10b1f8bac191">init_selling</a> (<a class="el" href="classnpc.html">npc</a> &amp;p)</td></tr>
<tr class="separator:a4b3f78b67eaf84ceddde10b1f8bac191"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9a1dc71c7127ed0ae5a1fbeaacd905a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a1dc71c7127ed0ae5a1fbeaacd905a8">&#9670;&nbsp;</a></span>adjusted_price()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int npc_trading::adjusted_price </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classitem.html">item</a> const *&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>amount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> const &amp;&#160;</td>
          <td class="paramname"><em>buyer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> const &amp;&#160;</td>
          <td class="paramname"><em>seller</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00162">162</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classnpc.html">npc</a> <span class="keyword">const</span> *faction_party = buyer.<a class="code" href="classnpc.html#ade35193e7c95d47e1bfdc43a4afb486c">is_npc</a>() ? buyer.as_npc() : seller.as_npc();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="structfaction__price__rule.html">faction_price_rule</a> <span class="keyword">const</span> *<span class="keyword">const</span> fpr = faction_party-&gt;<a class="code" href="classnpc.html#a79991fda97029d95cf8e49e359b4ae2a">get_price_rules</a>( *it );</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">double</span> price = it-&gt;price_no_contents( <span class="keyword">true</span>, fpr != <span class="keyword">nullptr</span> ? fpr-&gt;<a class="code" href="structfaction__price__rule.html#a55d9b57c461b4ffc5ac88daffdf8046c">price</a> : std::nullopt );</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span>( fpr != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        price *= fpr-&gt;<a class="code" href="structfaction__price__rule.html#a1c62775568f7b94cf865b0aca789247b">premium</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">if</span>( seller.is_npc() ) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            price *= fpr-&gt;<a class="code" href="structfaction__price__rule.html#ae71e8d42984526dd6aecfd8683310dda">markup</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span>( it-&gt;count_by_charges() &amp;&amp; amount &gt;= 0 ) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        price *= <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( amount ) / it-&gt;charges;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span>( buyer.is_npc() ) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        price = buyer.as_npc()-&gt;value( *it, price );</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( seller.is_npc() ) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        price = seller.as_npc()-&gt;value( *it, price );</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span>( fpr != <span class="keyword">nullptr</span> &amp;&amp; fpr-&gt;<a class="code" href="structfaction__price__rule.html#a4964ef06568bd068da7d911bd1300d05">fixed_adj</a>.has_value() ) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordtype">double</span> <span class="keyword">const</span> fixed_adj = fpr-&gt;<a class="code" href="structfaction__price__rule.html#a4964ef06568bd068da7d911bd1300d05">fixed_adj</a>.value();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        price *= 1 + ( seller.is_npc() ? fixed_adj : -fixed_adj );</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordtype">double</span> <span class="keyword">const</span> adjust = <a class="code" href="namespacenpc__trading.html#a2393539b2984483097299124a5a15fd1">npc_trading::net_price_adjustment</a>( buyer, seller );</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        price *= 1 + 0.25 * adjust;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#ac9196b0cf8d9dd209db9fc00a69a55f6">std::ceil</a>( price ) );</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
<div class="ttc" id="aclassnpc_html"><div class="ttname"><a href="classnpc.html">npc</a></div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00791">npc.h:792</a></div></div>
<div class="ttc" id="aclassnpc_html_a79991fda97029d95cf8e49e359b4ae2a"><div class="ttname"><a href="classnpc.html#a79991fda97029d95cf8e49e359b4ae2a">npc::get_price_rules</a></div><div class="ttdeci">faction_price_rule const  * get_price_rules(item const &amp;it) const</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l02109">npc.cpp:2109</a></div></div>
<div class="ttc" id="aclassnpc_html_ade35193e7c95d47e1bfdc43a4afb486c"><div class="ttname"><a href="classnpc.html#ade35193e7c95d47e1bfdc43a4afb486c">npc::is_npc</a></div><div class="ttdeci">bool is_npc() const override</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00805">npc.h:805</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_ac9196b0cf8d9dd209db9fc00a69a55f6"><div class="ttname"><a href="math__parser__func_8h.html#ac9196b0cf8d9dd209db9fc00a69a55f6">ceil</a></div><div class="ttdeci">double ceil(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00100">math_parser_func.h:100</a></div></div>
<div class="ttc" id="anamespacenpc__trading_html_a2393539b2984483097299124a5a15fd1"><div class="ttname"><a href="namespacenpc__trading.html#a2393539b2984483097299124a5a15fd1">npc_trading::net_price_adjustment</a></div><div class="ttdeci">double net_price_adjustment(const Character &amp;buyer, const Character &amp;seller)</div><div class="ttdef"><b>Definition:</b> <a href="npctrade_8cpp_source.html#l00134">npctrade.cpp:134</a></div></div>
<div class="ttc" id="astructfaction__price__rule_html"><div class="ttname"><a href="structfaction__price__rule.html">faction_price_rule</a></div><div class="ttdef"><b>Definition:</b> <a href="faction_8h_source.html#l00073">faction.h:73</a></div></div>
<div class="ttc" id="astructfaction__price__rule_html_a1c62775568f7b94cf865b0aca789247b"><div class="ttname"><a href="structfaction__price__rule.html#a1c62775568f7b94cf865b0aca789247b">faction_price_rule::premium</a></div><div class="ttdeci">double premium</div><div class="ttdef"><b>Definition:</b> <a href="faction_8h_source.html#l00075">faction.h:75</a></div></div>
<div class="ttc" id="astructfaction__price__rule_html_a4964ef06568bd068da7d911bd1300d05"><div class="ttname"><a href="structfaction__price__rule.html#a4964ef06568bd068da7d911bd1300d05">faction_price_rule::fixed_adj</a></div><div class="ttdeci">std::optional&lt; double &gt; fixed_adj</div><div class="ttdef"><b>Definition:</b> <a href="faction_8h_source.html#l00076">faction.h:76</a></div></div>
<div class="ttc" id="astructfaction__price__rule_html_a55d9b57c461b4ffc5ac88daffdf8046c"><div class="ttname"><a href="structfaction__price__rule.html#a55d9b57c461b4ffc5ac88daffdf8046c">faction_price_rule::price</a></div><div class="ttdeci">std::optional&lt; int &gt; price</div><div class="ttdef"><b>Definition:</b> <a href="faction_8h_source.html#l00077">faction.h:77</a></div></div>
<div class="ttc" id="astructfaction__price__rule_html_ae71e8d42984526dd6aecfd8683310dda"><div class="ttname"><a href="structfaction__price__rule.html#ae71e8d42984526dd6aecfd8683310dda">faction_price_rule::markup</a></div><div class="ttdeci">double markup</div><div class="ttdef"><b>Definition:</b> <a href="faction_8h_source.html#l00074">faction.h:74</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="creature_8h_source.html#l00286">Creature::as_npc()</a>, <a class="el" href="math__parser__func_8h_source.html#l00100">ceil()</a>, <a class="el" href="item_8h_source.html#l03133">item::charges</a>, <a class="el" href="item_8cpp_source.html#l08618">item::count_by_charges()</a>, <a class="el" href="faction_8h_source.html#l00076">faction_price_rule::fixed_adj</a>, <a class="el" href="npc_8cpp_source.html#l02109">npc::get_price_rules()</a>, <a class="el" href="character_8h_source.html#l00538">Character::is_npc()</a>, <a class="el" href="faction_8h_source.html#l00074">faction_price_rule::markup</a>, <a class="el" href="npctrade_8cpp_source.html#l00134">net_price_adjustment()</a>, <a class="el" href="faction_8h_source.html#l00075">faction_price_rule::premium</a>, <a class="el" href="faction_8h_source.html#l00077">faction_price_rule::price</a>, <a class="el" href="item_8cpp_source.html#l07044">item::price_no_contents()</a>, and <a class="el" href="npc_8cpp_source.html#l02050">npc::value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctrade_8cpp_source.html#l00197">anonymous_namespace{npctrade.cpp}::_trading_price()</a>.</p>

</div>
</div>
<a id="a2490551444a83c9bd12925dd1e7ff977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2490551444a83c9bd12925dd1e7ff977">&#9670;&nbsp;</a></span>bionic_install_price()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int npc_trading::bionic_install_price </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>installer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>patient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classitem__location.html">item_location</a> const &amp;&#160;</td>
          <td class="paramname"><em>bionic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00153">153</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structbionic.html">bionic</a>-&gt;price( <span class="keyword">true</span> ) * 2 +</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;           ( <a class="code" href="structbionic.html">bionic</a>-&gt;is_owned_by( patient )</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;             ? 0</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;             : <a class="code" href="namespacenpc__trading.html#a3c6ad57efeb8277e46f6b3ccf694b0a8">npc_trading::trading_price</a>( patient, installer, { <a class="code" href="structbionic.html">bionic</a>, 1 } ) );</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div>
<div class="ttc" id="anamespacenpc__trading_html_a3c6ad57efeb8277e46f6b3ccf694b0a8"><div class="ttname"><a href="namespacenpc__trading.html#a3c6ad57efeb8277e46f6b3ccf694b0a8">npc_trading::trading_price</a></div><div class="ttdeci">int trading_price(Character const &amp;buyer, Character const &amp;seller, trade_selector::entry_t const &amp;it)</div><div class="ttdef"><b>Definition:</b> <a href="npctrade_8cpp_source.html#l00220">npctrade.cpp:220</a></div></div>
<div class="ttc" id="astructbionic_html"><div class="ttname"><a href="structbionic.html">bionic</a></div><div class="ttdef"><b>Definition:</b> <a href="bionics_8h_source.html#l00198">bionics.h:198</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="npctrade_8cpp_source.html#l00220">trading_price()</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctalk__funcs_8cpp_source.html#l00503">bionic_install_common()</a>, <a class="el" href="game__inventory_8cpp_source.html#l02663">bionic_install_surgeon_preset::get_denial()</a>, and <a class="el" href="game__inventory_8cpp_source.html#l02705">bionic_install_surgeon_preset::get_money_amount()</a>.</p>

</div>
</div>
<a id="aa89082b8b3e67a3373f7a5ad57829475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89082b8b3e67a3373f7a5ad57829475">&#9670;&nbsp;</a></span>calc_npc_owes_you()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int npc_trading::calc_npc_owes_you </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>your_balance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00248">248</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;{</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// Friends don&#39;t hold debts against friends.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span>( np.<a class="code" href="classnpc.html#a85ce34d522c9e7a5e8642ac5c1de3a72">will_exchange_items_freely</a>() ) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// If they&#39;re going to owe you more than before, and it&#39;s more than they&#39;re willing</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// to owe, then cap the amount owed at the present level or their willingness to owe</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// (whichever is bigger).</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// When could they owe you more than max_willing_to_owe? It could be from quest rewards,</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// when they were less angry, or from when you were better friends.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span>( your_balance &gt; np.<a class="code" href="classnpc.html#ae17fa770d3d2ecbb89371e334c21ea6b">op_of_u</a>.<a class="code" href="structnpc__opinion.html#a544114b24a1332d5fc31b1ec814684bd">owed</a> &amp;&amp; your_balance &gt; np.<a class="code" href="classnpc.html#aed248cd3263ebfd94b61fff26d617599">max_willing_to_owe</a>() ) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( np.<a class="code" href="classnpc.html#ae17fa770d3d2ecbb89371e334c21ea6b">op_of_u</a>.<a class="code" href="structnpc__opinion.html#a544114b24a1332d5fc31b1ec814684bd">owed</a>, np.<a class="code" href="classnpc.html#aed248cd3263ebfd94b61fff26d617599">max_willing_to_owe</a>() );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// Fair&#39;s fair. NPC will remember this debt (or credit they&#39;ve extended)</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">return</span> your_balance;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="ttc" id="aclassnpc_html_a85ce34d522c9e7a5e8642ac5c1de3a72"><div class="ttname"><a href="classnpc.html#a85ce34d522c9e7a5e8642ac5c1de3a72">npc::will_exchange_items_freely</a></div><div class="ttdeci">bool will_exchange_items_freely() const</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l01875">npc.cpp:1875</a></div></div>
<div class="ttc" id="aclassnpc_html_ae17fa770d3d2ecbb89371e334c21ea6b"><div class="ttname"><a href="classnpc.html#ae17fa770d3d2ecbb89371e334c21ea6b">npc::op_of_u</a></div><div class="ttdeci">npc_opinion op_of_u</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l01403">npc.h:1403</a></div></div>
<div class="ttc" id="aclassnpc_html_aed248cd3263ebfd94b61fff26d617599"><div class="ttname"><a href="classnpc.html#aed248cd3263ebfd94b61fff26d617599">npc::max_willing_to_owe</a></div><div class="ttdeci">int max_willing_to_owe() const</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l01906">npc.cpp:1906</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a9009aa9e5eb1323238ebddffd8e1aedf"><div class="ttname"><a href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">max</a></div><div class="ttdeci">double max(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00035">math_parser_func.h:35</a></div></div>
<div class="ttc" id="astructnpc__opinion_html_a544114b24a1332d5fc31b1ec814684bd"><div class="ttname"><a href="structnpc__opinion.html#a544114b24a1332d5fc31b1ec814684bd">npc_opinion::owed</a></div><div class="ttdeci">int owed</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00237">npc.h:237</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="math__parser__func_8h_source.html#l00035">max()</a>, <a class="el" href="npc_8cpp_source.html#l01906">npc::max_willing_to_owe()</a>, <a class="el" href="npc_8h_source.html#l01403">npc::op_of_u</a>, <a class="el" href="npc_8h_source.html#l00237">npc_opinion::owed</a>, and <a class="el" href="npc_8cpp_source.html#l01875">npc::will_exchange_items_freely()</a>.</p>

<p class="reference">Referenced by <a class="el" href="trade__ui_8cpp_source.html#l00277">trade_ui::_confirm_trade()</a>, and <a class="el" href="npctrade_8cpp_source.html#l00268">update_npc_owed()</a>.</p>

</div>
</div>
<a id="a501e43e4b4136a85e2773fbc89f19e69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a501e43e4b4136a85e2773fbc89f19e69">&#9670;&nbsp;</a></span>cash_to_favor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int npc_trading::cash_to_favor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctalk_8cpp_source.html#l00416">416</a> of file <a class="el" href="npctalk_8cpp_source.html">npctalk.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// TODO: It should affect different NPCs to a different degree</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// Square root of mission value in dollars</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// ~31 for zed mom, 50 for horde master, ~63 for plutonium cells</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">double</span> scaled_mission_val = <a class="code" href="math__parser__func_8h.html#aeb3bbc4ec861ea58cbfca028920e4cc6">std::sqrt</a>( cash / 100.0 );</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rng_8cpp.html#acd19ae79e3590a99c9eaf0389318b686">roll_remainder</a>( scaled_mission_val );</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;}</div>
<div class="ttc" id="amath__parser__func_8h_html_aeb3bbc4ec861ea58cbfca028920e4cc6"><div class="ttname"><a href="math__parser__func_8h.html#aeb3bbc4ec861ea58cbfca028920e4cc6">sqrt</a></div><div class="ttdeci">double sqrt(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00061">math_parser_func.h:61</a></div></div>
<div class="ttc" id="arng_8cpp_html_acd19ae79e3590a99c9eaf0389318b686"><div class="ttname"><a href="rng_8cpp.html#acd19ae79e3590a99c9eaf0389318b686">roll_remainder</a></div><div class="ttdeci">int roll_remainder(double value)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00134">rng.cpp:134</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="rng_8cpp_source.html#l00134">roll_remainder()</a>, and <a class="el" href="math__parser__func_8h_source.html#l00061">sqrt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="talker__npc_8cpp_source.html#l00316">talker_npc::cash_to_favor()</a>, and <a class="el" href="npctalk__funcs_8cpp_source.html#l00132">talk_function::mission_success()</a>.</p>

</div>
</div>
<a id="a4b3f78b67eaf84ceddde10b1f8bac191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b3f78b67eaf84ceddde10b1f8bac191">&#9670;&nbsp;</a></span>init_selling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classitem__pricing.html">item_pricing</a> &gt; npc_trading::init_selling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00108">108</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    std::vector&lt;item_pricing&gt; result;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keyword">const</span> std::vector&lt;item *&gt; inv_all = np.items_with( []( <span class="keyword">const</span> <a class="code" href="classitem.html">item</a> &amp; it ) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">return</span> !it.<a class="code" href="classitem.html#a0795ac0d3e2ba958ab3a6ff4e282482b">made_of</a>( <a class="code" href="enums_8h.html#ade8f325e8cc8463cef8f944f3209d0e5a5918e24870f0ea98b9978dae8a69c533">phase_id::LIQUID</a> );</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    } );</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classitem.html">item</a> *i : inv_all ) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="classitem.html">item</a> &amp;it = *i;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordtype">int</span> val = np.value( it );</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="comment">// FIXME: this item_location is a hack</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">if</span>( np.wants_to_sell( <a class="code" href="classitem__location.html">item_location</a>{ np, i }, val ).success() ) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            result.emplace_back( np, it, val, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( it.<a class="code" href="classitem.html#a016494fa25a7a403fe78fadbd90b267b">count</a>() ) );</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classitem__location.html">item_location</a> weapon = np.get_wielded_item();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span>(</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        np.will_exchange_items_freely() &amp;&amp; weapon &amp;&amp; !weapon-&gt;<a class="code" href="classitem.html#a3e532e4e5b7cef943634b1d910f99384">has_flag</a>( <a class="code" href="npctrade_8cpp.html#a5ef597c7ad650fea1ac47a47e88a235e">json_flag_NO_UNWIELD</a> )</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    ) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        result.emplace_back( np, *weapon, np.value( *weapon ), <span class="keyword">false</span> );</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="ttc" id="aclassitem__location_html"><div class="ttname"><a href="classitem__location.html">item_location</a></div><div class="ttdoc">A lightweight handle to an item independent of it's location Unlike a raw pointer can be (de-)seriali...</div><div class="ttdef"><b>Definition:</b> <a href="item__location_8h_source.html#l00028">item_location.h:29</a></div></div>
<div class="ttc" id="aclassitem_html"><div class="ttname"><a href="classitem.html">item</a></div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l00195">item.h:196</a></div></div>
<div class="ttc" id="aclassitem_html_a016494fa25a7a403fe78fadbd90b267b"><div class="ttname"><a href="classitem.html#a016494fa25a7a403fe78fadbd90b267b">item::count</a></div><div class="ttdeci">int count() const</div><div class="ttdoc">If count_by_charges(), returns charges, otherwise 1.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l08623">item.cpp:8623</a></div></div>
<div class="ttc" id="aclassitem_html_a0795ac0d3e2ba958ab3a6ff4e282482b"><div class="ttname"><a href="classitem.html#a0795ac0d3e2ba958ab3a6ff4e282482b">item::made_of</a></div><div class="ttdeci">const std::map&lt; material_id, int &gt; &amp; made_of() const</div><div class="ttdoc">The ids of all the materials this is made of.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09146">item.cpp:9146</a></div></div>
<div class="ttc" id="aclassitem_html_a3e532e4e5b7cef943634b1d910f99384"><div class="ttname"><a href="classitem.html#a3e532e4e5b7cef943634b1d910f99384">item::has_flag</a></div><div class="ttdeci">bool has_flag(const flag_id &amp;flag) const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07578">item.cpp:7578</a></div></div>
<div class="ttc" id="aenums_8h_html_ade8f325e8cc8463cef8f944f3209d0e5a5918e24870f0ea98b9978dae8a69c533"><div class="ttname"><a href="enums_8h.html#ade8f325e8cc8463cef8f944f3209d0e5a5918e24870f0ea98b9978dae8a69c533">phase_id::LIQUID</a></div><div class="ttdeci">@ LIQUID</div></div>
<div class="ttc" id="anpctrade_8cpp_html_a5ef597c7ad650fea1ac47a47e88a235e"><div class="ttname"><a href="npctrade_8cpp.html#a5ef597c7ad650fea1ac47a47e88a235e">json_flag_NO_UNWIELD</a></div><div class="ttdeci">static const flag_id json_flag_NO_UNWIELD(&quot;NO_UNWIELD&quot;)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="item_8cpp_source.html#l08623">item::count()</a>, <a class="el" href="character_8cpp_source.html#l00674">Character::get_wielded_item()</a>, <a class="el" href="item_8cpp_source.html#l07578">item::has_flag()</a>, <a class="el" href="visitable_8cpp_source.html#l00330">visitable::items_with()</a>, <a class="el" href="npctrade_8cpp.html#a5ef597c7ad650fea1ac47a47e88a235e">json_flag_NO_UNWIELD</a>, <a class="el" href="enums_8h.html#ade8f325e8cc8463cef8f944f3209d0e5a5918e24870f0ea98b9978dae8a69c533">LIQUID</a>, <a class="el" href="item_8cpp_source.html#l09146">item::made_of()</a>, <a class="el" href="npc_8cpp_source.html#l02050">npc::value()</a>, <a class="el" href="npc_8cpp_source.html#l01806">npc::wants_to_sell()</a>, and <a class="el" href="npc_8cpp_source.html#l01875">npc::will_exchange_items_freely()</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctalk__funcs_8cpp_source.html#l00612">talk_function::give_equipment_allowance()</a>.</p>

</div>
</div>
<a id="a2393539b2984483097299124a5a15fd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2393539b2984483097299124a5a15fd1">&#9670;&nbsp;</a></span>net_price_adjustment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double npc_trading::net_price_adjustment </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>buyer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>seller</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
NPC Intelligence slightly increases bartering price changes, relative to your INT NPC Barter increases bartering price changes, relative to your BARTER Intelligence slightly increases bartering price changes, relative to NPC INT Barter increases bartering price changes, relative to NPC BARTER 
<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00134">134</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// Adjust the prices based on your social skill.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// cap adjustment so nothing is ever sold below value</span><span class="comment"></span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">    ///\EFFECT_INT_NPC slightly increases bartering price changes, relative to your INT</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">    ///\EFFECT_BARTER_NPC increases bartering price changes, relative to your BARTER</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">    ///\EFFECT_INT slightly increases bartering price changes, relative to NPC INT</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">    ///\EFFECT_BARTER increases bartering price changes, relative to NPC BARTER</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span>    <span class="keywordtype">int</span> <span class="keyword">const</span> int_diff = seller.<a class="code" href="classCharacter.html#a994c83d61054215e81a6e87478d81203">int_cur</a> - buyer.<a class="code" href="classCharacter.html#a994c83d61054215e81a6e87478d81203">int_cur</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> int_adj = 1 + 0.05 * <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( 19, <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">std::abs</a>( int_diff ) );</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> soc_adj = <a class="code" href="skill_8cpp.html#acacb5720925a6d49c42cecc62c62b8dc">price_adjustment</a>( <a class="code" href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">round</a>( seller.<a class="code" href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">get_skill_level</a>( <a class="code" href="npctrade_8cpp.html#add6bff65f422cff2a7ede6c7b904d982">skill_speech</a> ) -</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                           buyer.<a class="code" href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">get_skill_level</a>( <a class="code" href="npctrade_8cpp.html#add6bff65f422cff2a7ede6c7b904d982">skill_speech</a> ) ) );</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">double</span> <span class="keyword">const</span> adjust = int_diff &gt;= 0 ? int_adj * soc_adj : soc_adj / int_adj;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">return</span> seller.<a class="code" href="classCharacter.html#a8f914d66d3d996a1356a31caf1d44c13">is_npc</a>() ? adjust : -1 / adjust;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div>
<div class="ttc" id="aclassCharacter_html_a8f914d66d3d996a1356a31caf1d44c13"><div class="ttname"><a href="classCharacter.html#a8f914d66d3d996a1356a31caf1d44c13">Character::is_npc</a></div><div class="ttdeci">bool is_npc() const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00538">character.h:538</a></div></div>
<div class="ttc" id="aclassCharacter_html_a93a3570e884214ba5c0eb3cdf1af75cc"><div class="ttname"><a href="classCharacter.html#a93a3570e884214ba5c0eb3cdf1af75cc">Character::get_skill_level</a></div><div class="ttdeci">float get_skill_level(const skill_id &amp;ident) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03428">character.cpp:3428</a></div></div>
<div class="ttc" id="aclassCharacter_html_a994c83d61054215e81a6e87478d81203"><div class="ttname"><a href="classCharacter.html#a994c83d61054215e81a6e87478d81203">Character::int_cur</a></div><div class="ttdeci">int int_cur</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00579">character.h:579</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a24f6ac6e06720c7cdf972a6083847132"><div class="ttname"><a href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">abs</a></div><div class="ttdeci">double abs(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00030">math_parser_func.h:30</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a5834219bcffc7118c95b395b8cdeec20"><div class="ttname"><a href="math__parser__func_8h.html#a5834219bcffc7118c95b395b8cdeec20">round</a></div><div class="ttdeci">double round(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00110">math_parser_func.h:110</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a993dede52d23a9a3d15b01a342391ef4"><div class="ttname"><a href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">min</a></div><div class="ttdeci">double min(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00043">math_parser_func.h:43</a></div></div>
<div class="ttc" id="anpctrade_8cpp_html_add6bff65f422cff2a7ede6c7b904d982"><div class="ttname"><a href="npctrade_8cpp.html#add6bff65f422cff2a7ede6c7b904d982">skill_speech</a></div><div class="ttdeci">static const skill_id skill_speech(&quot;speech&quot;)</div></div>
<div class="ttc" id="askill_8cpp_html_acacb5720925a6d49c42cecc62c62b8dc"><div class="ttname"><a href="skill_8cpp.html#acacb5720925a6d49c42cecc62c62b8dc">price_adjustment</a></div><div class="ttdeci">double price_adjustment(int barter_skill)</div><div class="ttdef"><b>Definition:</b> <a href="skill_8cpp_source.html#l00623">skill.cpp:623</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="math__parser__func_8h_source.html#l00030">abs()</a>, <a class="el" href="character_8cpp_source.html#l03428">Character::get_skill_level()</a>, <a class="el" href="character_8h_source.html#l00579">Character::int_cur</a>, <a class="el" href="character_8h_source.html#l00538">Character::is_npc()</a>, <a class="el" href="math__parser__func_8h_source.html#l00043">min()</a>, <a class="el" href="skill_8cpp_source.html#l00623">price_adjustment()</a>, <a class="el" href="math__parser__func_8h_source.html#l00110">round()</a>, and <a class="el" href="npctrade_8cpp.html#add6bff65f422cff2a7ede6c7b904d982">skill_speech</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctrade_8cpp_source.html#l00162">adjusted_price()</a>.</p>

</div>
</div>
<a id="aecde799c1b4707a45ac4f7a41bbed685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecde799c1b4707a45ac4f7a41bbed685">&#9670;&nbsp;</a></span>npc_can_fit_items()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool npc_trading::npc_can_fit_items </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnpc.html">npc</a> const &amp;&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classtrade__selector.html#ab610cad0ff2e19dcf907caa91de0fa63">trade_selector::select_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>to_trade</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00343">343</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    std::vector&lt;item&gt; avail_pockets = np.worn.available_pockets();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span>( !to_trade.empty() &amp;&amp; avail_pockets.empty() ) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classtrade__selector.html#acc1eefbd7c542e087e293b0a6c5dfa62">trade_selector::entry_t</a> <span class="keyword">const</span> &amp;it : to_trade ) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordtype">bool</span> item_stored = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="classitem.html">item</a> &amp;pkt : avail_pockets ) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keyword">const</span> <a class="code" href="classunits_1_1quantity.html">units::volume</a> pvol = pkt.max_containable_volume();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="keyword">const</span> <a class="code" href="classitem.html">item</a> &amp;i = *it.first;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">if</span>( pkt.can_holster( i ) || ( pkt.can_contain( i ).success() &amp;&amp; pvol &gt; i.<a class="code" href="classitem.html#a686df014e8aa8bc4637883802d05f935">volume</a>() ) ) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                pkt.<a class="code" href="classitem.html#a018fe1a11eaa7e18cae915d683088c02">put_in</a>( i, <a class="code" href="pocket__type_8h.html#af41ed729a50321996f6fa60225086cf1a9bbab5f947b9e3fbb8a399ecc257459b">pocket_type::CONTAINER</a> );</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                item_stored = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">if</span>( !item_stored &amp;&amp; !np.can_wear( *it.first, <span class="keyword">false</span> ).success() ) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="ttc" id="aclassitem_html_a018fe1a11eaa7e18cae915d683088c02"><div class="ttname"><a href="classitem.html#a018fe1a11eaa7e18cae915d683088c02">item::put_in</a></div><div class="ttdeci">ret_val&lt; void &gt; put_in(const item &amp;payload, pocket_type pk_type, bool unseal_pockets=false, Character *carrier=nullptr)</div><div class="ttdoc">Puts the given item into this one.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l01784">item.cpp:1784</a></div></div>
<div class="ttc" id="aclassitem_html_a686df014e8aa8bc4637883802d05f935"><div class="ttname"><a href="classitem.html#a686df014e8aa8bc4637883802d05f935">item::volume</a></div><div class="ttdeci">units::volume volume(bool integral=false, bool ignore_contents=false, int charges_in_vol=-1) const</div><div class="ttdoc">Total volume of an item accounting for all contained/integrated items NOTE: Result is rounded up to n...</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07360">item.cpp:7360</a></div></div>
<div class="ttc" id="aclasstrade__selector_html_acc1eefbd7c542e087e293b0a6c5dfa62"><div class="ttname"><a href="classtrade__selector.html#acc1eefbd7c542e087e293b0a6c5dfa62">trade_selector::entry_t</a></div><div class="ttdeci">std::pair&lt; item_location, int &gt; entry_t</div><div class="ttdef"><b>Definition:</b> <a href="trade__ui_8h_source.html#l00033">trade_ui.h:33</a></div></div>
<div class="ttc" id="aclassunits_1_1quantity_html"><div class="ttname"><a href="classunits_1_1quantity.html">units::quantity</a></div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00028">units.h:29</a></div></div>
<div class="ttc" id="apocket__type_8h_html_af41ed729a50321996f6fa60225086cf1a9bbab5f947b9e3fbb8a399ecc257459b"><div class="ttname"><a href="pocket__type_8h.html#af41ed729a50321996f6fa60225086cf1a9bbab5f947b9e3fbb8a399ecc257459b">pocket_type::CONTAINER</a></div><div class="ttdeci">@ CONTAINER</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__attire_8cpp_source.html#l02170">outfit::available_pockets()</a>, <a class="el" href="character__attire_8cpp_source.html#l00109">Character::can_wear()</a>, <a class="el" href="pocket__type_8h.html#af41ed729a50321996f6fa60225086cf1a9bbab5f947b9e3fbb8a399ecc257459b">CONTAINER</a>, <a class="el" href="item_8cpp_source.html#l01784">item::put_in()</a>, <a class="el" href="ret__val_8h_source.html#l00013">ret_val_common::success()</a>, <a class="el" href="item_8cpp_source.html#l07360">item::volume()</a>, and <a class="el" href="character_8h_source.html#l02690">Character::worn</a>.</p>

<p class="reference">Referenced by <a class="el" href="trade__ui_8cpp_source.html#l00277">trade_ui::_confirm_trade()</a>.</p>

</div>
</div>
<a id="ab6622f31806f7ffa96822e00b8029b6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6622f31806f7ffa96822e00b8029b6c">&#9670;&nbsp;</a></span>npc_will_accept_trade()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool npc_trading::npc_will_accept_trade </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnpc.html">npc</a> const &amp;&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>your_balance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00339">339</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">return</span> np.will_exchange_items_freely() || your_balance + np.max_credit_extended() &gt;= 0;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="npc_8cpp_source.html#l01883">npc::max_credit_extended()</a>, and <a class="el" href="npc_8cpp_source.html#l01875">npc::will_exchange_items_freely()</a>.</p>

<p class="reference">Referenced by <a class="el" href="trade__ui_8cpp_source.html#l00277">trade_ui::_confirm_trade()</a>, and <a class="el" href="trade__ui_8cpp_source.html#l00305">trade_ui::_draw_header()</a>.</p>

</div>
</div>
<a id="a9a7dbd65b9ae311c79c92b57c1b134b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a7dbd65b9ae311c79c92b57c1b134b4">&#9670;&nbsp;</a></span>pay_npc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool npc_trading::pay_npc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cost</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctalk__funcs_8cpp_source.html#l01062">1062</a> of file <a class="el" href="npctalk__funcs_8cpp_source.html">npctalk_funcs.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;{</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">if</span>( np.<a class="code" href="classnpc.html#ae17fa770d3d2ecbb89371e334c21ea6b">op_of_u</a>.<a class="code" href="structnpc__opinion.html#a544114b24a1332d5fc31b1ec814684bd">owed</a> &gt;= cost ) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        np.<a class="code" href="classnpc.html#ae17fa770d3d2ecbb89371e334c21ea6b">op_of_u</a>.<a class="code" href="structnpc__opinion.html#a544114b24a1332d5fc31b1ec814684bd">owed</a> -= cost;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacenpc__trading.html#a0ec2aaaf5437ced34ea57f9bd818259d">npc_trading::trade</a>( np, cost, <a class="code" href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a>( <span class="stringliteral">&quot;Pay:&quot;</span> ) );</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;}</div>
<div class="ttc" id="anamespacenpc__trading_html_a0ec2aaaf5437ced34ea57f9bd818259d"><div class="ttname"><a href="namespacenpc__trading.html#a0ec2aaaf5437ced34ea57f9bd818259d">npc_trading::trade</a></div><div class="ttdeci">bool trade(npc &amp;p, int cost, const std::string &amp;deal)</div><div class="ttdef"><b>Definition:</b> <a href="npctrade_8cpp_source.html#l00278">npctrade.cpp:278</a></div></div>
<div class="ttc" id="atranslations_8h_html_ab92bb4161a6308b302d283816975c3a6"><div class="ttname"><a href="translations_8h.html#ab92bb4161a6308b302d283816975c3a6">_</a></div><div class="ttdeci">#define _(STRING)</div><div class="ttdef"><b>Definition:</b> <a href="translations_8h_source.html#l00089">translations.h:89</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00089">_</a>, <a class="el" href="npc_8h_source.html#l01403">npc::op_of_u</a>, <a class="el" href="npc_8h_source.html#l00237">npc_opinion::owed</a>, and <a class="el" href="npctrade_8cpp_source.html#l00278">trade()</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctalk__funcs_8cpp_source.html#l00503">bionic_install_common()</a>, <a class="el" href="npctalk__funcs_8cpp_source.html#l00544">bionic_remove_common()</a>, <a class="el" href="talker__npc_8cpp_source.html#l00520">talker_npc::buy_from()</a>, <a class="el" href="talker__avatar_8cpp_source.html#l00067">talker_avatar::buy_monster()</a>, and <a class="el" href="npctalk__funcs_8cpp_source.html#l01144">talk_function::start_training_gen()</a>.</p>

</div>
</div>
<a id="a0ec2aaaf5437ced34ea57f9bd818259d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ec2aaaf5437ced34ea57f9bd818259d">&#9670;&nbsp;</a></span>trade()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool npc_trading::trade </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>deal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00278">278</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    np.shop_restock();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">//np.drop_items( np.weight_carried() - np.weight_capacity(),</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">//               np.volume_carried() - np.volume_capacity() );</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    np.drop_invalid_inventory();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    std::unique_ptr&lt;trade_ui&gt; tradeui = std::make_unique&lt;trade_ui&gt;( <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>(), np, cost, deal );</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="structtrade__ui_1_1trade__result__t.html">trade_ui::trade_result_t</a> trade_result = tradeui-&gt;perform_trade();</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span>( trade_result.<a class="code" href="structtrade__ui_1_1trade__result__t.html#a54c4c6de48a460d3afcc609f5722b2d6">traded</a> ) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        tradeui.reset();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        std::list&lt;item_location *&gt; from_map;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        std::list&lt;item&gt; escrow;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="classavatar.html">avatar</a> &amp;player_character = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">// Movement of items in 3 steps: player to escrow - npc to player - escrow to npc.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        escrow = <a class="code" href="namespacenpc__trading.html#a74a2503a123d406c93f62cb6e0c34080">npc_trading::transfer_items</a>( trade_result.<a class="code" href="structtrade__ui_1_1trade__result__t.html#aeb3619dd9d38f2cebaf96aedd683ed1f">items_you</a>, player_character, np, from_map,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                              <span class="keyword">true</span> );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="namespacenpc__trading.html#a74a2503a123d406c93f62cb6e0c34080">npc_trading::transfer_items</a>( trade_result.<a class="code" href="structtrade__ui_1_1trade__result__t.html#ad005944f6b67d80389d823f454f7b420">items_trader</a>, np, player_character, from_map, <span class="keyword">false</span> );</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// Now move items from escrow to the npc. Keep the weapon wielded.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span>( np.is_shopkeeper() ) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <a class="code" href="npctrade__utils_8cpp.html#af6d53c14326c1cb0370fa2b249a46a2d">distribute_items_to_npc_zones</a>( escrow, np );</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classitem.html">item</a> &amp;i : escrow ) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                np.i_add( i, <span class="keyword">true</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">true</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="classitem__location.html">item_location</a> *loc_ptr : from_map ) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">if</span>( !loc_ptr ) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <a class="code" href="classitem.html">item</a> *it = loc_ptr-&gt;get_item();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">if</span>( !it ) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">if</span>( it-&gt;<a class="code" href="classitem.html#a478ecf81e48540e1ba39de33df968c43">has_var</a>( <span class="stringliteral">&quot;trade_charges&quot;</span> ) &amp;&amp; it-&gt;<a class="code" href="classitem.html#a40963a016376016eb408bdb9dbb94388">count_by_charges</a>() ) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                it-&gt;<a class="code" href="classitem.html#a6bfb92ab5d41e0eb3a1da160fac71b0e">charges</a> -= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( it-&gt;<a class="code" href="classitem.html#a0b12108a604ac9d940716bb8f1368cf5">get_var</a>( <span class="stringliteral">&quot;trade_charges&quot;</span>, 0 ) );</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keywordflow">if</span>( it-&gt;<a class="code" href="classitem.html#a6bfb92ab5d41e0eb3a1da160fac71b0e">charges</a> &lt;= 0 ) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    loc_ptr-&gt;remove_item();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    it-&gt;<a class="code" href="classitem.html#aa24fc115fb6cd1124efec30970cfcd9b">erase_var</a>( <span class="stringliteral">&quot;trade_charges&quot;</span> );</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( it-&gt;<a class="code" href="classitem.html#a478ecf81e48540e1ba39de33df968c43">has_var</a>( <span class="stringliteral">&quot;trade_amount&quot;</span> ) ) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                loc_ptr-&gt;remove_item();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">// NPCs will remember debts, to the limit that they&#39;ll extend credit or previous debts</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">if</span>( !np.will_exchange_items_freely() ) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            player_character.<a class="code" href="classCharacter.html#a17213386e132fbde5ce772f04e22f5ba">cash</a> -= trade_result.<a class="code" href="structtrade__ui_1_1trade__result__t.html#ad86cf8a35fb8d709fbba526122a8c384">delta_bank</a>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <a class="code" href="namespacenpc__trading.html#a374790fe36faf56af557a968526d21e0">update_npc_owed</a>( np, trade_result.<a class="code" href="structtrade__ui_1_1trade__result__t.html#a5ce1a954ffdc69bacb9064a533f52601">balance</a>, trade_result.<a class="code" href="structtrade__ui_1_1trade__result__t.html#a832d519246a41ba5dba05240034f9d9a">value_you</a> );</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            player_character.<a class="code" href="classCharacter.html#a6535a02158a1d6b23b0a6bb623dfae19">practice</a>( <a class="code" href="npctrade_8cpp.html#add6bff65f422cff2a7ede6c7b904d982">skill_speech</a>, trade_result.<a class="code" href="structtrade__ui_1_1trade__result__t.html#a832d519246a41ba5dba05240034f9d9a">value_you</a> / 10000 );</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">return</span> trade_result.<a class="code" href="structtrade__ui_1_1trade__result__t.html#a54c4c6de48a460d3afcc609f5722b2d6">traded</a> ;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
<div class="ttc" id="aavatar_8h_html_a7fe2c1a3376948380f856732d4f34c5c"><div class="ttname"><a href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a></div><div class="ttdeci">avatar &amp; get_avatar()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13817">game.cpp:13817</a></div></div>
<div class="ttc" id="aclassCharacter_html_a17213386e132fbde5ce772f04e22f5ba"><div class="ttname"><a href="classCharacter.html#a17213386e132fbde5ce772f04e22f5ba">Character::cash</a></div><div class="ttdeci">int cash</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02760">character.h:2760</a></div></div>
<div class="ttc" id="aclassCharacter_html_a6535a02158a1d6b23b0a6bb623dfae19"><div class="ttname"><a href="classCharacter.html#a6535a02158a1d6b23b0a6bb623dfae19">Character::practice</a></div><div class="ttdeci">bool practice(const skill_id &amp;id, int amount, int cap=99, bool suppress_warning=false)</div><div class="ttdoc">This handles giving xp for a skill.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l02683">character.cpp:2683</a></div></div>
<div class="ttc" id="aclassavatar_html"><div class="ttname"><a href="classavatar.html">avatar</a></div><div class="ttdef"><b>Definition:</b> <a href="avatar_8h_source.html#l00083">avatar.h:84</a></div></div>
<div class="ttc" id="aclassitem_html_a0b12108a604ac9d940716bb8f1368cf5"><div class="ttname"><a href="classitem.html#a0b12108a604ac9d940716bb8f1368cf5">item::get_var</a></div><div class="ttdeci">double get_var(const std::string &amp;name, double default_value) const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l01839">item.cpp:1839</a></div></div>
<div class="ttc" id="aclassitem_html_a40963a016376016eb408bdb9dbb94388"><div class="ttname"><a href="classitem.html#a40963a016376016eb408bdb9dbb94388">item::count_by_charges</a></div><div class="ttdeci">bool count_by_charges() const</div><div class="ttdoc">Return true if this item's type is counted by charges (true for stackable, ammo, or comestible)</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l08618">item.cpp:8618</a></div></div>
<div class="ttc" id="aclassitem_html_a478ecf81e48540e1ba39de33df968c43"><div class="ttname"><a href="classitem.html#a478ecf81e48540e1ba39de33df968c43">item::has_var</a></div><div class="ttdeci">bool has_var(const std::string &amp;name) const</div><div class="ttdoc">Whether the variable is defined at all.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l01928">item.cpp:1928</a></div></div>
<div class="ttc" id="aclassitem_html_a6bfb92ab5d41e0eb3a1da160fac71b0e"><div class="ttname"><a href="classitem.html#a6bfb92ab5d41e0eb3a1da160fac71b0e">item::charges</a></div><div class="ttdeci">int charges</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l03133">item.h:3133</a></div></div>
<div class="ttc" id="aclassitem_html_aa24fc115fb6cd1124efec30970cfcd9b"><div class="ttname"><a href="classitem.html#aa24fc115fb6cd1124efec30970cfcd9b">item::erase_var</a></div><div class="ttdeci">void erase_var(const std::string &amp;name)</div><div class="ttdoc">Erase the value of the given variable.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l01933">item.cpp:1933</a></div></div>
<div class="ttc" id="anamespacenpc__trading_html_a374790fe36faf56af557a968526d21e0"><div class="ttname"><a href="namespacenpc__trading.html#a374790fe36faf56af557a968526d21e0">npc_trading::update_npc_owed</a></div><div class="ttdeci">void update_npc_owed(npc &amp;np, int your_balance, int your_sale_value)</div><div class="ttdef"><b>Definition:</b> <a href="npctrade_8cpp_source.html#l00268">npctrade.cpp:268</a></div></div>
<div class="ttc" id="anamespacenpc__trading_html_a74a2503a123d406c93f62cb6e0c34080"><div class="ttname"><a href="namespacenpc__trading.html#a74a2503a123d406c93f62cb6e0c34080">npc_trading::transfer_items</a></div><div class="ttdeci">std::list&lt; item &gt; transfer_items(trade_selector::select_t &amp;stuff, Character &amp;giver, Character &amp;receiver, std::list&lt; item_location * &gt; &amp;from_map, bool use_escrow)</div><div class="ttdef"><b>Definition:</b> <a href="npctrade_8cpp_source.html#l00030">npctrade.cpp:30</a></div></div>
<div class="ttc" id="anpctrade__utils_8cpp_html_af6d53c14326c1cb0370fa2b249a46a2d"><div class="ttname"><a href="npctrade__utils_8cpp.html#af6d53c14326c1cb0370fa2b249a46a2d">distribute_items_to_npc_zones</a></div><div class="ttdeci">std::list&lt; item &gt; distribute_items_to_npc_zones(std::list&lt; item &gt; &amp;items, npc &amp;guy)</div><div class="ttdef"><b>Definition:</b> <a href="npctrade__utils_8cpp_source.html#l00117">npctrade_utils.cpp:117</a></div></div>
<div class="ttc" id="astructtrade__ui_1_1trade__result__t_html"><div class="ttname"><a href="structtrade__ui_1_1trade__result__t.html">trade_ui::trade_result_t</a></div><div class="ttdef"><b>Definition:</b> <a href="trade__ui_8h_source.html#l00075">trade_ui.h:75</a></div></div>
<div class="ttc" id="astructtrade__ui_1_1trade__result__t_html_a54c4c6de48a460d3afcc609f5722b2d6"><div class="ttname"><a href="structtrade__ui_1_1trade__result__t.html#a54c4c6de48a460d3afcc609f5722b2d6">trade_ui::trade_result_t::traded</a></div><div class="ttdeci">bool traded</div><div class="ttdef"><b>Definition:</b> <a href="trade__ui_8h_source.html#l00076">trade_ui.h:76</a></div></div>
<div class="ttc" id="astructtrade__ui_1_1trade__result__t_html_a5ce1a954ffdc69bacb9064a533f52601"><div class="ttname"><a href="structtrade__ui_1_1trade__result__t.html#a5ce1a954ffdc69bacb9064a533f52601">trade_ui::trade_result_t::balance</a></div><div class="ttdeci">currency_t balance</div><div class="ttdef"><b>Definition:</b> <a href="trade__ui_8h_source.html#l00077">trade_ui.h:77</a></div></div>
<div class="ttc" id="astructtrade__ui_1_1trade__result__t_html_a832d519246a41ba5dba05240034f9d9a"><div class="ttname"><a href="structtrade__ui_1_1trade__result__t.html#a832d519246a41ba5dba05240034f9d9a">trade_ui::trade_result_t::value_you</a></div><div class="ttdeci">currency_t value_you</div><div class="ttdef"><b>Definition:</b> <a href="trade__ui_8h_source.html#l00079">trade_ui.h:79</a></div></div>
<div class="ttc" id="astructtrade__ui_1_1trade__result__t_html_ad005944f6b67d80389d823f454f7b420"><div class="ttname"><a href="structtrade__ui_1_1trade__result__t.html#ad005944f6b67d80389d823f454f7b420">trade_ui::trade_result_t::items_trader</a></div><div class="ttdeci">select_t items_trader</div><div class="ttdef"><b>Definition:</b> <a href="trade__ui_8h_source.html#l00082">trade_ui.h:82</a></div></div>
<div class="ttc" id="astructtrade__ui_1_1trade__result__t_html_ad86cf8a35fb8d709fbba526122a8c384"><div class="ttname"><a href="structtrade__ui_1_1trade__result__t.html#ad86cf8a35fb8d709fbba526122a8c384">trade_ui::trade_result_t::delta_bank</a></div><div class="ttdeci">currency_t delta_bank</div><div class="ttdef"><b>Definition:</b> <a href="trade__ui_8h_source.html#l00078">trade_ui.h:78</a></div></div>
<div class="ttc" id="astructtrade__ui_1_1trade__result__t_html_aeb3619dd9d38f2cebaf96aedd683ed1f"><div class="ttname"><a href="structtrade__ui_1_1trade__result__t.html#aeb3619dd9d38f2cebaf96aedd683ed1f">trade_ui::trade_result_t::items_you</a></div><div class="ttdeci">select_t items_you</div><div class="ttdef"><b>Definition:</b> <a href="trade__ui_8h_source.html#l00081">trade_ui.h:81</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="trade__ui_8h_source.html#l00077">trade_ui::trade_result_t::balance</a>, <a class="el" href="character_8h_source.html#l02760">Character::cash</a>, <a class="el" href="item_8h_source.html#l03133">item::charges</a>, <a class="el" href="item_8cpp_source.html#l08618">item::count_by_charges()</a>, <a class="el" href="trade__ui_8h_source.html#l00078">trade_ui::trade_result_t::delta_bank</a>, <a class="el" href="npctrade__utils_8cpp_source.html#l00117">distribute_items_to_npc_zones()</a>, <a class="el" href="character__inventory_8cpp_source.html#l00665">Character::drop_invalid_inventory()</a>, <a class="el" href="item_8cpp_source.html#l01933">item::erase_var()</a>, <a class="el" href="game_8cpp_source.html#l13817">get_avatar()</a>, <a class="el" href="item_8cpp_source.html#l01839">item::get_var()</a>, <a class="el" href="item_8cpp_source.html#l01928">item::has_var()</a>, <a class="el" href="character__inventory_8cpp_source.html#l00326">Character::i_add()</a>, <a class="el" href="npc_8cpp_source.html#l02027">npc::is_shopkeeper()</a>, <a class="el" href="trade__ui_8h_source.html#l00082">trade_ui::trade_result_t::items_trader</a>, <a class="el" href="trade__ui_8h_source.html#l00081">trade_ui::trade_result_t::items_you</a>, <a class="el" href="character_8cpp_source.html#l02683">Character::practice()</a>, <a class="el" href="npc_8cpp_source.html#l01933">npc::shop_restock()</a>, <a class="el" href="npctrade_8cpp.html#add6bff65f422cff2a7ede6c7b904d982">skill_speech</a>, <a class="el" href="trade__ui_8h_source.html#l00076">trade_ui::trade_result_t::traded</a>, <a class="el" href="npctrade_8cpp_source.html#l00030">transfer_items()</a>, <a class="el" href="npctrade_8cpp_source.html#l00268">update_npc_owed()</a>, <a class="el" href="trade__ui_8h_source.html#l00079">trade_ui::trade_result_t::value_you</a>, and <a class="el" href="npc_8cpp_source.html#l01875">npc::will_exchange_items_freely()</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctalk__funcs_8cpp_source.html#l00198">talk_function::mission_reward()</a>, <a class="el" href="game_8cpp_source.html#l05941">game::npc_menu()</a>, <a class="el" href="npctalk__funcs_8cpp_source.html#l01062">pay_npc()</a>, and <a class="el" href="npctalk__funcs_8cpp_source.html#l00236">talk_function::start_trade()</a>.</p>

</div>
</div>
<a id="a3c6ad57efeb8277e46f6b3ccf694b0a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c6ad57efeb8277e46f6b3ccf694b0a8">&#9670;&nbsp;</a></span>trading_price()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int npc_trading::trading_price </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> const &amp;&#160;</td>
          <td class="paramname"><em>buyer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> const &amp;&#160;</td>
          <td class="paramname"><em>seller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classtrade__selector.html#acc1eefbd7c542e087e293b0a6c5dfa62">trade_selector::entry_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>it</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00220">220</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02npctrade_8cpp_03.html#af21a6671a65cf035537390d3313ce414">_trading_price</a>( buyer, seller, it.first, it.second );</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
<div class="ttc" id="anamespaceanonymous__namespace_02npctrade_8cpp_03_html_af21a6671a65cf035537390d3313ce414"><div class="ttname"><a href="namespaceanonymous__namespace_02npctrade_8cpp_03.html#af21a6671a65cf035537390d3313ce414">anonymous_namespace{npctrade.cpp}::_trading_price</a></div><div class="ttdeci">int _trading_price(Character const &amp;buyer, Character const &amp;seller, item_location const &amp;it, int amount)</div><div class="ttdef"><b>Definition:</b> <a href="npctrade_8cpp_source.html#l00197">npctrade.cpp:197</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="npctrade_8cpp_source.html#l00197">anonymous_namespace{npctrade.cpp}::_trading_price()</a>.</p>

<p class="reference">Referenced by <a class="el" href="trade__ui_8cpp_source.html#l00216">trade_ui::autobalance()</a>, <a class="el" href="npctrade_8cpp_source.html#l00153">bionic_install_price()</a>, <a class="el" href="trade__ui_8cpp_source.html#l00060">trade_preset::get_denial()</a>, <a class="el" href="trade__ui_8cpp_source.html#l00201">trade_ui::recalc_values_cpane()</a>, <a class="el" href="trade__ui_8cpp_source.html#l00042">trade_preset::trade_preset()</a>, and <a class="el" href="npctrade_8cpp_source.html#l00030">transfer_items()</a>.</p>

</div>
</div>
<a id="a74a2503a123d406c93f62cb6e0c34080"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a2503a123d406c93f62cb6e0c34080">&#9670;&nbsp;</a></span>transfer_items()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt; <a class="el" href="classitem.html">item</a> &gt; npc_trading::transfer_items </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtrade__selector.html#ab610cad0ff2e19dcf907caa91de0fa63">trade_selector::select_t</a> &amp;&#160;</td>
          <td class="paramname"><em>stuff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>giver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>receiver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; <a class="el" href="classitem__location.html">item_location</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>from_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_escrow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00030">30</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// escrow is used only when the npc is the destination. Item transfer to the npc is deferred.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    std::list&lt;item&gt; escrow = std::list&lt;item&gt;();</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">for</span>( <a class="code" href="classtrade__selector.html#acc1eefbd7c542e087e293b0a6c5dfa62">trade_selector::entry_t</a> &amp;ip : stuff ) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">if</span>( ip.first.get_item() == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <a class="code" href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395a4759bd3f0b71819391a3e4024b645d69">D_ERROR</a>, <a class="code" href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3ac12486c4f9e5c3638edfaa04e4d9860a">D_NPC</a> ) &lt;&lt; <span class="stringliteral">&quot;Null item being traded in npc_trading::transfer_items&quot;</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="classitem.html">item</a> gift = *ip.first.get_item();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="classnpc.html">npc</a> <span class="keyword">const</span> *<a class="code" href="classnpc.html">npc</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        std::function&lt;bool( <a class="code" href="classitem__location.html">item_location</a> <span class="keyword">const</span> &amp;, <span class="keywordtype">int</span> )&gt; f_wants;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span>( giver.<a class="code" href="classCharacter.html#a8f914d66d3d996a1356a31caf1d44c13">is_npc</a>() ) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <a class="code" href="classnpc.html">npc</a> = giver.<a class="code" href="classCreature.html#a5de5f5e0d08deb03b68749608eb360b2">as_npc</a>();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            f_wants = [<a class="code" href="classnpc.html">npc</a>]( <a class="code" href="classitem__location.html">item_location</a> <span class="keyword">const</span> &amp; it, <span class="keywordtype">int</span> price ) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classnpc.html">npc</a>-&gt;<a class="code" href="classnpc.html#a456ce9c5d9f3377d0b30e3ad929c1605">wants_to_sell</a>( it, price ).success();</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            };</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( receiver.<a class="code" href="classCharacter.html#a8f914d66d3d996a1356a31caf1d44c13">is_npc</a>() ) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <a class="code" href="classnpc.html">npc</a> = receiver.<a class="code" href="classCreature.html#a5de5f5e0d08deb03b68749608eb360b2">as_npc</a>();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            f_wants = [<a class="code" href="classnpc.html">npc</a>]( <a class="code" href="classitem__location.html">item_location</a> <span class="keyword">const</span> &amp; it, <span class="keywordtype">int</span> price ) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classnpc.html">npc</a>-&gt;<a class="code" href="classnpc.html#a74835261fd154f7f7ccdf6fd0bfe41d7">wants_to_buy</a>( *it, price ).success();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            };</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="comment">// spill contained, unwanted items</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">if</span>( f_wants &amp;&amp; gift.<a class="code" href="classitem.html#a723753bab4cc789e3ec186846c9916a3">is_container</a>() ) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="keywordflow">for</span>( <a class="code" href="classitem.html">item</a> *it : gift.<a class="code" href="classitem.html#afd9fcc8f19476c95071b72c300f47ad1">get_contents</a>().<a class="code" href="classitem__contents.html#a3d0ce1b26434123e939a54714180b09b">all_items_top</a>() ) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                <span class="keywordtype">int</span> <span class="keyword">const</span> price =</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                    <a class="code" href="namespacenpc__trading.html#a3c6ad57efeb8277e46f6b3ccf694b0a8">trading_price</a>( giver, receiver, { <a class="code" href="classitem__location.html">item_location</a>{ giver, it }, 1 } );</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <span class="keywordflow">if</span>( !f_wants( <a class="code" href="classitem__location.html">item_location</a>{ ip.first, it }, price ) ) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                    giver.<a class="code" href="classCharacter.html#ae2d66e536142cf363783d099b6ae93da">i_add_or_drop</a>( *it, 1, ip.first.get_item() );</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                    gift.<a class="code" href="classvisitable.html#adeb03e3af46e1b106a5f88f112add296">remove_item</a>( *it );</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        gift.<a class="code" href="classitem.html#aa51b9b2950e9ea68811bffb5635911c6">set_owner</a>( receiver );</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">// Items are moving to escrow.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span>( use_escrow &amp;&amp; ip.first-&gt;count_by_charges() ) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            gift.<a class="code" href="classitem.html#a6bfb92ab5d41e0eb3a1da160fac71b0e">charges</a> = ip.second;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            escrow.emplace_back( gift );</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( use_escrow ) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            std::fill_n( std::back_inserter( escrow ), ip.second, gift );</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="comment">// No escrow in use. Items moving from giver to receiver.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ip.first-&gt;count_by_charges() ) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            gift.<a class="code" href="classitem.html#a6bfb92ab5d41e0eb3a1da160fac71b0e">charges</a> = ip.second;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <a class="code" href="classitem.html">item</a> newit = <a class="code" href="classitem.html">item</a>( gift );</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <a class="code" href="classret__val.html">ret_val&lt;item_location&gt;</a> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = receiver.<a class="code" href="classCharacter.html#ac1b7a385cf58425333922f844b85ec0b">i_add_or_fill</a>( newit, <span class="keyword">true</span>, <span class="keyword">nullptr</span>, &amp;gift,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                         <span class="comment">/*allow_drop=*/</span><span class="keyword">true</span>, <span class="comment">/*allow_wield=*/</span><span class="keyword">true</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; ip.second; i++ ) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                receiver.<a class="code" href="classCharacter.html#af04d061e415da9cb6f1fc234b04f3dfb">i_add</a>( gift );</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">if</span>( ip.first.held_by( giver ) ) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordflow">if</span>( ip.first-&gt;count_by_charges() ) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                giver.<a class="code" href="classCharacter.html#a3d0ec2b4e80527bd2daad576c2bbb187">use_charges</a>( gift.<a class="code" href="classitem.html#a4a9972e826d25be6736b749ab94b230f">typeId</a>(), ip.second );</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ip.second &gt; 0 ) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                giver.<a class="code" href="classCharacter.html#a25df6be553270664ed06bb38d8679bb7">remove_items_with</a>( [&amp;ip]( <span class="keyword">const</span> <a class="code" href="classitem.html">item</a> &amp; i ) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                    <span class="keywordflow">return</span> &amp;i == ip.first.get_item();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                }, ip.second );</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordflow">if</span>( ip.first-&gt;count_by_charges() ) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                ip.first.get_item()-&gt;set_var( <span class="stringliteral">&quot;trade_charges&quot;</span>, ip.second );</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                ip.first.get_item()-&gt;set_var( <span class="stringliteral">&quot;trade_amount&quot;</span>, 1 );</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            from_map.push_back( &amp;ip.first );</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">return</span> escrow;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="ttc" id="aclassCharacter_html_a25df6be553270664ed06bb38d8679bb7"><div class="ttname"><a href="classCharacter.html#a25df6be553270664ed06bb38d8679bb7">Character::remove_items_with</a></div><div class="ttdeci">std::list&lt; item &gt; remove_items_with(const std::function&lt; bool(const item &amp;)&gt; &amp;filter, int count=INT_MAX) override</div><div class="ttdoc">Removes items contained by this instance which match the filter.</div></div>
<div class="ttc" id="aclassCharacter_html_a3d0ec2b4e80527bd2daad576c2bbb187"><div class="ttname"><a href="classCharacter.html#a3d0ec2b4e80527bd2daad576c2bbb187">Character::use_charges</a></div><div class="ttdeci">std::list&lt; item &gt; use_charges(const itype_id &amp;what, int qty, const std::function&lt; bool(const item &amp;)&gt; &amp;filter=return_true&lt; item &gt;)</div><div class="ttdoc">Use charges in character inventory.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l09769">character.cpp:9769</a></div></div>
<div class="ttc" id="aclassCharacter_html_ac1b7a385cf58425333922f844b85ec0b"><div class="ttname"><a href="classCharacter.html#ac1b7a385cf58425333922f844b85ec0b">Character::i_add_or_fill</a></div><div class="ttdeci">ret_val&lt; item_location &gt; i_add_or_fill(item &amp;it, bool should_stack=true, const item *avoid=nullptr, const item *original_inventory_item=nullptr, bool allow_drop=true, bool allow_wield=true, bool ignore_pkt_settings=false)</div><div class="ttdef"><b>Definition:</b> <a href="character__inventory_8cpp_source.html#l00377">character_inventory.cpp:377</a></div></div>
<div class="ttc" id="aclassCharacter_html_ae2d66e536142cf363783d099b6ae93da"><div class="ttname"><a href="classCharacter.html#ae2d66e536142cf363783d099b6ae93da">Character::i_add_or_drop</a></div><div class="ttdeci">bool i_add_or_drop(item &amp;it, int qty=1, const item *avoid=nullptr, const item *original_inventory_item=nullptr)</div><div class="ttdoc">Sets invlet and adds to inventory if possible, drops otherwise, returns true if either succeeded.</div><div class="ttdef"><b>Definition:</b> <a href="character__inventory_8cpp_source.html#l00451">character_inventory.cpp:451</a></div></div>
<div class="ttc" id="aclassCharacter_html_af04d061e415da9cb6f1fc234b04f3dfb"><div class="ttname"><a href="classCharacter.html#af04d061e415da9cb6f1fc234b04f3dfb">Character::i_add</a></div><div class="ttdeci">item_location i_add(item it, bool should_stack=true, const item *avoid=nullptr, const item *original_inventory_item=nullptr, bool allow_drop=true, bool allow_wield=true, bool ignore_pkt_settings=false)</div><div class="ttdoc">Adds the item to the character's worn items or wields it, or prompts if the Character cannot pick it ...</div><div class="ttdef"><b>Definition:</b> <a href="character__inventory_8cpp_source.html#l00326">character_inventory.cpp:326</a></div></div>
<div class="ttc" id="aclassCreature_html_a5de5f5e0d08deb03b68749608eb360b2"><div class="ttname"><a href="classCreature.html#a5de5f5e0d08deb03b68749608eb360b2">Creature::as_npc</a></div><div class="ttdeci">virtual npc * as_npc()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00286">creature.h:286</a></div></div>
<div class="ttc" id="aclassitem__contents_html_a3d0ce1b26434123e939a54714180b09b"><div class="ttname"><a href="classitem__contents.html#a3d0ce1b26434123e939a54714180b09b">item_contents::all_items_top</a></div><div class="ttdeci">std::list&lt; item * &gt; all_items_top(const std::function&lt; bool(item_pocket &amp;)&gt; &amp;filter)</div><div class="ttdoc">returns a list of pointers to all top-level items from pockets that match the predicate</div><div class="ttdef"><b>Definition:</b> <a href="item__contents_8cpp_source.html#l01677">item_contents.cpp:1677</a></div></div>
<div class="ttc" id="aclassitem_html_a4a9972e826d25be6736b749ab94b230f"><div class="ttname"><a href="classitem.html#a4a9972e826d25be6736b749ab94b230f">item::typeId</a></div><div class="ttdeci">itype_id typeId() const</div><div class="ttdoc">return the unique identifier of the items underlying type</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l11850">item.cpp:11850</a></div></div>
<div class="ttc" id="aclassitem_html_a723753bab4cc789e3ec186846c9916a3"><div class="ttname"><a href="classitem.html#a723753bab4cc789e3ec186846c9916a3">item::is_container</a></div><div class="ttdeci">bool is_container() const</div><div class="ttdoc">Whether this is container.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09667">item.cpp:9667</a></div></div>
<div class="ttc" id="aclassitem_html_aa51b9b2950e9ea68811bffb5635911c6"><div class="ttname"><a href="classitem.html#aa51b9b2950e9ea68811bffb5635911c6">item::set_owner</a></div><div class="ttdeci">void set_owner(const faction_id &amp;new_owner)</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l02178">item.cpp:2178</a></div></div>
<div class="ttc" id="aclassitem_html_afd9fcc8f19476c95071b72c300f47ad1"><div class="ttname"><a href="classitem.html#afd9fcc8f19476c95071b72c300f47ad1">item::get_contents</a></div><div class="ttdeci">item_contents &amp; get_contents()</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l03165">item.h:3165</a></div></div>
<div class="ttc" id="aclassnpc_html_a456ce9c5d9f3377d0b30e3ad929c1605"><div class="ttname"><a href="classnpc.html#a456ce9c5d9f3377d0b30e3ad929c1605">npc::wants_to_sell</a></div><div class="ttdeci">bool wants_to_sell(const item_location &amp;it) const</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l01806">npc.cpp:1806</a></div></div>
<div class="ttc" id="aclassnpc_html_a74835261fd154f7f7ccdf6fd0bfe41d7"><div class="ttname"><a href="classnpc.html#a74835261fd154f7f7ccdf6fd0bfe41d7">npc::wants_to_buy</a></div><div class="ttdeci">bool wants_to_buy(const item &amp;it) const</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l01842">npc.cpp:1842</a></div></div>
<div class="ttc" id="aclassret__val_html"><div class="ttname"><a href="classret__val.html">ret_val</a></div><div class="ttdoc">The class represents a composite return value of an arbitrary function (result).</div><div class="ttdef"><b>Definition:</b> <a href="ret__val_8h_source.html#l00048">ret_val.h:49</a></div></div>
<div class="ttc" id="aclassvisitable_html_adeb03e3af46e1b106a5f88f112add296"><div class="ttname"><a href="classvisitable.html#adeb03e3af46e1b106a5f88f112add296">visitable::remove_item</a></div><div class="ttdeci">item remove_item(item &amp;it)</div><div class="ttdoc">Removes and returns the item which must be contained by this instance.</div><div class="ttdef"><b>Definition:</b> <a href="visitable_8cpp_source.html#l00543">visitable.cpp:543</a></div></div>
<div class="ttc" id="adebug_8cpp_html_a240782b16593c6bd607c64787c62da0e"><div class="ttname"><a href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a></div><div class="ttdeci">std::ostream &amp; DebugLog(DebugLevel lev, DebugClass cl)</div><div class="ttdef"><b>Definition:</b> <a href="debug_8cpp_source.html#l01438">debug.cpp:1438</a></div></div>
<div class="ttc" id="adebug_8h_html_ab658e6d84759440dbf3c890446075395a4759bd3f0b71819391a3e4024b645d69"><div class="ttname"><a href="debug_8h.html#ab658e6d84759440dbf3c890446075395a4759bd3f0b71819391a3e4024b645d69">D_ERROR</a></div><div class="ttdeci">@ D_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00142">debug.h:142</a></div></div>
<div class="ttc" id="adebug_8h_html_afa45cf12d72d4226196a7d03c54ad7d3ac12486c4f9e5c3638edfaa04e4d9860a"><div class="ttname"><a href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3ac12486c4f9e5c3638edfaa04e4d9860a">D_NPC</a></div><div class="ttdeci">@ D_NPC</div><div class="ttdoc">npcs*.cpp</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00169">debug.h:169</a></div></div>
<div class="ttc" id="anamespacecata_1_1hash64__detail_html_a5ca825db6fd06946302c60daa97333e4"><div class="ttname"><a href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">cata::hash64_detail::ret</a></div><div class="ttdeci">T ret</div><div class="ttdef"><b>Definition:</b> <a href="hash__utils_8h_source.html#l00097">hash_utils.h:97</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="item__contents_8cpp_source.html#l01677">item_contents::all_items_top()</a>, <a class="el" href="creature_8h_source.html#l00286">Creature::as_npc()</a>, <a class="el" href="item_8h_source.html#l03133">item::charges</a>, <a class="el" href="debug_8h_source.html#l00142">D_ERROR</a>, <a class="el" href="debug_8h_source.html#l00169">D_NPC</a>, <a class="el" href="debug_8cpp_source.html#l01438">DebugLog()</a>, <a class="el" href="item_8h_source.html#l03165">item::get_contents()</a>, <a class="el" href="character__inventory_8cpp_source.html#l00326">Character::i_add()</a>, <a class="el" href="character__inventory_8cpp_source.html#l00451">Character::i_add_or_drop()</a>, <a class="el" href="character__inventory_8cpp_source.html#l00377">Character::i_add_or_fill()</a>, <a class="el" href="item_8cpp_source.html#l09667">item::is_container()</a>, <a class="el" href="character_8h_source.html#l00538">Character::is_npc()</a>, <a class="el" href="visitable_8cpp_source.html#l00543">visitable::remove_item()</a>, <a class="el" href="classCharacter.html#a25df6be553270664ed06bb38d8679bb7">Character::remove_items_with()</a>, <a class="el" href="hash__utils_8h_source.html#l00097">cata::hash64_detail::ret</a>, <a class="el" href="item_8cpp_source.html#l02178">item::set_owner()</a>, <a class="el" href="npctrade_8cpp_source.html#l00220">trading_price()</a>, <a class="el" href="item_8cpp_source.html#l11850">item::typeId()</a>, <a class="el" href="character_8cpp_source.html#l09769">Character::use_charges()</a>, <a class="el" href="npc_8cpp_source.html#l01842">npc::wants_to_buy()</a>, and <a class="el" href="npc_8cpp_source.html#l01806">npc::wants_to_sell()</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctrade_8cpp_source.html#l00278">trade()</a>.</p>

</div>
</div>
<a id="a374790fe36faf56af557a968526d21e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a374790fe36faf56af557a968526d21e0">&#9670;&nbsp;</a></span>update_npc_owed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void npc_trading::update_npc_owed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnpc.html">npc</a> &amp;&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>your_balance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>your_sale_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="npctrade_8cpp_source.html#l00268">268</a> of file <a class="el" href="npctrade_8cpp_source.html">npctrade.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    np.<a class="code" href="classnpc.html#ae17fa770d3d2ecbb89371e334c21ea6b">op_of_u</a>.<a class="code" href="structnpc__opinion.html#a544114b24a1332d5fc31b1ec814684bd">owed</a> = <a class="code" href="namespacenpc__trading.html#aa89082b8b3e67a3373f7a5ad57829475">calc_npc_owes_you</a>( np, your_balance );</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    np.<a class="code" href="classnpc.html#ae17fa770d3d2ecbb89371e334c21ea6b">op_of_u</a>.<a class="code" href="structnpc__opinion.html#a523b58b23a338f96dff966ca09350fc8">sold</a> += your_sale_value;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="ttc" id="anamespacenpc__trading_html_aa89082b8b3e67a3373f7a5ad57829475"><div class="ttname"><a href="namespacenpc__trading.html#aa89082b8b3e67a3373f7a5ad57829475">npc_trading::calc_npc_owes_you</a></div><div class="ttdeci">int calc_npc_owes_you(const npc &amp;np, int your_balance)</div><div class="ttdef"><b>Definition:</b> <a href="npctrade_8cpp_source.html#l00248">npctrade.cpp:248</a></div></div>
<div class="ttc" id="astructnpc__opinion_html_a523b58b23a338f96dff966ca09350fc8"><div class="ttname"><a href="structnpc__opinion.html#a523b58b23a338f96dff966ca09350fc8">npc_opinion::sold</a></div><div class="ttdeci">int sold</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00238">npc.h:238</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="npctrade_8cpp_source.html#l00248">calc_npc_owes_you()</a>, <a class="el" href="npc_8h_source.html#l01403">npc::op_of_u</a>, <a class="el" href="npc_8h_source.html#l00237">npc_opinion::owed</a>, and <a class="el" href="npc_8h_source.html#l00238">npc_opinion::sold</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctrade_8cpp_source.html#l00278">trade()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 7 2024 08:48:47 for Cataclysm DDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
