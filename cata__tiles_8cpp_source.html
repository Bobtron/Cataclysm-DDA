<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm DDA: src/cata_tiles.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm DDA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cata_tiles.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cata__tiles_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#if defined(TILES)</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cata__tiles_8h.html">cata_tiles.h</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;bitset&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;unordered_set&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="action_8h.html">action.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="avatar_8h.html">avatar.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cached__options_8h.html">cached_options.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="calendar_8h.html">calendar.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cata__assert_8h.html">cata_assert.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cata__utility_8h.html">cata_utility.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="catacharset_8h.html">catacharset.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="character_8h.html">character.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="character__id_8h.html">character_id.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="clzones_8h.html">clzones.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="color_8h.html">color.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="creature__tracker_8h.html">creature_tracker.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cursesdef_8h.html">cursesdef.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cursesport_8h.html">cursesport.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="debug_8h.html">debug.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="field_8h.html">field.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="field__type_8h.html">field_type.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="filesystem_8h.html">filesystem.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="game_8h.html">game.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="game__constants_8h.html">game_constants.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="input_8h.html">input.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="int__id_8h.html">int_id.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="item_8h.html">item.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="item__factory_8h.html">item_factory.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="itype_8h.html">itype.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="json_8h.html">json.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="json__loader_8h.html">json_loader.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map_8h.html">map.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map__extras_8h.html">map_extras.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="map__memory_8h.html">map_memory.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mapdata_8h.html">mapdata.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mod__tileset_8h.html">mod_tileset.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="monster_8h.html">monster.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="monstergenerator_8h.html">monstergenerator.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mtype_8h.html">mtype.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mutation_8h.html">mutation.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="npc_8h.html">npc.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="output_8h.html">output.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="overlay__ordering_8h.html">overlay_ordering.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="path__info_8h.html">path_info.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pixel__minimap_8h.html">pixel_minimap.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="rect__range_8h.html">rect_range.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="scent__map_8h.html">scent_map.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sdl__utils_8h.html">sdl_utils.h</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sdl__wrappers_8h.html">sdl_wrappers.h</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sdltiles_8h.html">sdltiles.h</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sounds_8h.html">sounds.h</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="string__formatter_8h.html">string_formatter.h</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="string__id_8h.html">string_id.h</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="submap_8h.html">submap.h</a>&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tileray_8h.html">tileray.h</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="translations_8h.html">translations.h</a>&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="trap_8h.html">trap.h</a>&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="type__id_8h.html">type_id.h</a>&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="units__utility_8h.html">units_utility.h</a>&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="veh__type_8h.html">veh_type.h</a>&quot;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vehicle_8h.html">vehicle.h</a>&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vpart__position_8h.html">vpart_position.h</a>&quot;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="weather_8h.html">weather.h</a>&quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="weighted__list_8h.html">weighted_list.h</a>&quot;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#define dbg(x) DebugLog((x),D_SDL) &lt;&lt; __FILE__ &lt;&lt; &quot;:&quot;</span> &lt;&lt; __LINE__ &lt;&lt; &quot;: &quot;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">efftype_id</a> <a class="code" href="avatar__action_8cpp.html#a7c7651a289cc19a34456c213eeb46edc">effect_ridden</a>( <span class="stringliteral">&quot;ridden&quot;</span> );</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">itype_id</a> <a class="code" href="iexamine_8cpp.html#a4ea2c47870b82e831292a9239b2e6ff2">itype_corpse</a>( <span class="stringliteral">&quot;corpse&quot;</span> );</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">trait_id</a> <a class="code" href="game_8cpp.html#a7f3efc14d34d48d62804d9b8b8e627cc">trait_INATTENTIVE</a>( <span class="stringliteral">&quot;INATTENTIVE&quot;</span> );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classstring__id.html">trap_str_id</a> <a class="code" href="map_8cpp.html#a8fd90c11d7a509a3c0af0144cd1e0b12">tr_unfinished_construction</a>( <span class="stringliteral">&quot;tr_unfinished_construction&quot;</span> );</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> std::string ITEM_HIGHLIGHT( <span class="stringliteral">&quot;highlight_item&quot;</span> );</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> std::string ZOMBIE_REVIVAL_INDICATOR( <span class="stringliteral">&quot;zombie_revival_indicator&quot;</span> );</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> std::array&lt;std::string, 8&gt; multitile_keys = {{</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="stringliteral">&quot;center&quot;</span>,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="stringliteral">&quot;corner&quot;</span>,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="stringliteral">&quot;edge&quot;</span>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="stringliteral">&quot;t_connection&quot;</span>,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="stringliteral">&quot;end_piece&quot;</span>,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="stringliteral">&quot;unconnected&quot;</span>,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="stringliteral">&quot;open&quot;</span>,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="stringliteral">&quot;broken&quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;};</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> std::string empty_string;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> std::array&lt;std::string, 15&gt; TILE_CATEGORY_IDS = {{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="stringliteral">&quot;&quot;</span>, <span class="comment">// TILE_CATEGORY::NONE,</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="stringliteral">&quot;vehicle_part&quot;</span>, <span class="comment">// TILE_CATEGORY::VEHICLE_PART,</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="stringliteral">&quot;terrain&quot;</span>, <span class="comment">// TILE_CATEGORY::TERRAIN,</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="stringliteral">&quot;item&quot;</span>, <span class="comment">// TILE_CATEGORY::ITEM,</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="stringliteral">&quot;furniture&quot;</span>, <span class="comment">// TILE_CATEGORY::FURNITURE,</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="stringliteral">&quot;trap&quot;</span>, <span class="comment">// TILE_CATEGORY::TRAP,</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="stringliteral">&quot;field&quot;</span>, <span class="comment">// TILE_CATEGORY::FIELD,</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="stringliteral">&quot;lighting&quot;</span>, <span class="comment">// TILE_CATEGORY::LIGHTING,</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="stringliteral">&quot;monster&quot;</span>, <span class="comment">// TILE_CATEGORY::MONSTER,</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="stringliteral">&quot;bullet&quot;</span>, <span class="comment">// TILE_CATEGORY::BULLET,</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="stringliteral">&quot;hit_entity&quot;</span>, <span class="comment">// TILE_CATEGORY::HIT_ENTITY,</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="stringliteral">&quot;weather&quot;</span>, <span class="comment">// TILE_CATEGORY::WEATHER,</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="stringliteral">&quot;overmap_terrain&quot;</span>, <span class="comment">// TILE_CATEGORY::OVERMAP_TERRAIN</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="stringliteral">&quot;map_extra&quot;</span>, <span class="comment">// TILE_CATEGORY::MAP_EXTRA</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="stringliteral">&quot;overmap_note&quot;</span>, <span class="comment">// TILE_CATEGORY::OVERMAP_NOTE</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;};</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;static_assert( TILE_CATEGORY_IDS.size() == <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a98bd1c45684cf587ac2347a92dd7bb51">TILE_CATEGORY::last</a> ),</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;               <span class="stringliteral">&quot;TILE_CATEGORY_IDS must match list of TILE_CATEGORY values&quot;</span> );</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keyword">namespace</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;std::string get_ascii_tile_id( <span class="keyword">const</span> uint32_t sym, <span class="keyword">const</span> <span class="keywordtype">int</span> FG, <span class="keyword">const</span> <span class="keywordtype">int</span> BG )</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">return</span> std::string( { <span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;C&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;_&#39;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>( sym ),</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                          <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>( FG ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>( BG )</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                        } );</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<a class="code" href="pixel__minimap_8h.html#a6090ef73d2b1d07d802941f7b1e57421">pixel_minimap_mode</a> pixel_minimap_mode_from_string( <span class="keyword">const</span> std::string &amp;mode )</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span>( mode == <span class="stringliteral">&quot;solid&quot;</span> ) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="pixel__minimap_8h.html#a6090ef73d2b1d07d802941f7b1e57421aec03f91ae56e478455e3786e91559194">pixel_minimap_mode::solid</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( mode == <span class="stringliteral">&quot;squares&quot;</span> ) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="pixel__minimap_8h.html#a6090ef73d2b1d07d802941f7b1e57421a192ba166b3957ab1020e9a72ea1b40ed">pixel_minimap_mode::squares</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( mode == <span class="stringliteral">&quot;dots&quot;</span> ) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="pixel__minimap_8h.html#a6090ef73d2b1d07d802941f7b1e57421ae9c6cfa16d8958cb7752450883950ab8">pixel_minimap_mode::dots</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Unsupported pixel minimap mode \&quot;&quot;</span> + mode + <span class="stringliteral">&quot;\&quot;.&quot;</span> );</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="pixel__minimap_8h.html#a6090ef73d2b1d07d802941f7b1e57421aec03f91ae56e478455e3786e91559194">pixel_minimap_mode::solid</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> msgtype_to_tilecolor( <span class="keyword">const</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096e">game_message_type</a> type, <span class="keyword">const</span> <span class="keywordtype">bool</span> bOldMsg )</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> iBold = bOldMsg ? 0 : 8;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">switch</span>( type ) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10">m_good</a>:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">return</span> iBold + <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aaf95aa6d65219dcc01457b82df1be8fd">catacurses::green</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>:</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">return</span> iBold + <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2b607ba9b2b7edd76f3d0a07e9dca9fc">catacurses::red</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaa65a3cd4a2c6d0fbb31833ade22ee100">m_mixed</a>:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea917308a5da5a853b7ac25b683922ef96">m_headshot</a>:</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordflow">return</span> iBold + <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a82a5d57f7c713aa989d0851a4d0290a7">catacurses::magenta</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea3ab788e6c7dfa584be4ca2e90c49ec8c">m_neutral</a>:</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">return</span> iBold + <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a00c94a3341257be62e4db78730c88356">catacurses::white</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a>:</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea8663170a60ff438f4ba2ab98a1e6d6b5">m_critical</a>:</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">return</span> iBold + <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">catacurses::yellow</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>:</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea379f06a1968886ca7a96b103d5a628fc">m_grazing</a>:</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">return</span> iBold + <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a230026b5fc50f9f7efefa7dedfa3544d">catacurses::blue</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<a class="code" href="structformatted__text.html#a1fdaa7547911557f3e8c47b8ec48d3f9">formatted_text::formatted_text</a>( <span class="keyword">const</span> std::string &amp;text, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a>,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                <span class="keyword">const</span> <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> text_direction )</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    : text( text ), <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a>( <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> )</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;{</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">switch</span>( text_direction ) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a54486c15c75f9e0ada3484a7812252ff">direction::NORTHWEST</a>:</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a83c9f5692281bf59471b13dfddb3af91">direction::WEST</a>:</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a96f30aeb5638ae7ac40d90b5ebdde47e">direction::SOUTHWEST</a>:</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            alignment = <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8ea7c4f29407893c334a6cb7a87bf045c0d">text_alignment::right</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403">direction::NORTH</a>:</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3ac397289ee45877be0cd49811fe245b4e">direction::CENTER</a>:</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a96e44fa82e5a5263fb92337be422d3eb">direction::SOUTH</a>:</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            alignment = <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">text_alignment::center</a>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            alignment = <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8ea811882fecd5c7618d7099ebbd39ea254">text_alignment::left</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<a class="code" href="classcata__tiles.html#a5d4a9c92c8ad55778836ca54b8c3f936">cata_tiles::cata_tiles</a>( <span class="keyword">const</span> <a class="code" href="sdl__wrappers_8h.html#a8246e5114ebf3165ebf5549a4010b420">SDL_Renderer_Ptr</a> &amp;renderer, <span class="keyword">const</span> GeometryRenderer_Ptr &amp;geometry,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                        <a class="code" href="classtileset__cache.html">tileset_cache</a> &amp;cache ) :</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    renderer( renderer ),</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    geometry( geometry ),</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    cache( cache ),</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    minimap( renderer, geometry )</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( renderer );</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> = 0;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    tile_width = 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    in_animation = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    do_draw_explosion = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    do_draw_custom_explosion = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    do_draw_bullet = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    do_draw_hit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    do_draw_line = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    do_draw_cursor = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    do_draw_highlight = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    do_draw_weather = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    do_draw_sct = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    do_draw_zones = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    nv_goggles_activated = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    on_options_changed();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<a class="code" href="classcata__tiles.html#a1c4823477289d055756ab6d65912567e">cata_tiles::~cata_tiles</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a1e068b601f19c3b412cc778422ca2bfa">cata_tiles::on_options_changed</a>()</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="classcata__tiles.html#a156a038a2966c1cebf91192b40f2dfe0">memory_map_mode</a> = get_option &lt;std::string&gt;( <span class="stringliteral">&quot;MEMORY_MAP_MODE&quot;</span> );</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="structpixel__minimap__settings.html">pixel_minimap_settings</a> settings;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    settings.<a class="code" href="structpixel__minimap__settings.html#a472f00bcc7b59d32b42331c17db6329b">mode</a> =</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        pixel_minimap_mode_from_string( get_option&lt;std::string&gt;( <span class="stringliteral">&quot;PIXEL_MINIMAP_MODE&quot;</span> ) );</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    settings.<a class="code" href="structpixel__minimap__settings.html#a2bd026d1f7fd6efc2db379facccaa394">brightness</a> = get_option&lt;int&gt;( <span class="stringliteral">&quot;PIXEL_MINIMAP_BRIGHTNESS&quot;</span> );</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    settings.<a class="code" href="structpixel__minimap__settings.html#ad4bb822f7824630cd19dd92c95c559be">beacon_size</a> = get_option&lt;int&gt;( <span class="stringliteral">&quot;PIXEL_MINIMAP_BEACON_SIZE&quot;</span> );</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    settings.<a class="code" href="structpixel__minimap__settings.html#a97fbfd571c802c8828693390e3305b18">beacon_blink_interval</a> = get_option&lt;int&gt;( <span class="stringliteral">&quot;PIXEL_MINIMAP_BLINK&quot;</span> );</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    settings.<a class="code" href="structpixel__minimap__settings.html#a31399b2fbe2382d74e974fb00ec934b3">square_pixels</a> = get_option&lt;bool&gt;( <span class="stringliteral">&quot;PIXEL_MINIMAP_RATIO&quot;</span> );</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    settings.<a class="code" href="structpixel__minimap__settings.html#af820244d601ab274db059fbf365af3d9">scale_to_fit</a> = get_option&lt;bool&gt;( <span class="stringliteral">&quot;PIXEL_MINIMAP_SCALE_TO_FIT&quot;</span> );</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classcata__tiles.html#a52ccd64e7a34ca1a76c2c63c6b92c9ab">minimap</a>-&gt;set_settings( settings );</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset.html#ac5955523a9d7d455b5a0915165461dc8">tileset::clear</a>()</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;{</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="classtileset.html#a56b03955caf1b5054bb2618141e26ca8">tile_values</a>.clear();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="classtileset.html#a48f1d1aa368435d8c5943b9c9fd34d30">shadow_tile_values</a>.clear();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="classtileset.html#a63ea9a683e87a5a50cfede95c50eb3bb">night_tile_values</a>.clear();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classtileset.html#aaaed99cc83ffff12f758d90541f7b8d9">overexposed_tile_values</a>.clear();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="classtileset.html#aba9003b94d672585d9360ee348952c12">memory_tile_values</a>.clear();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="classtileset.html#a3a2817d754e912b4e90b8b5c9d530e9c">duplicate_ids</a>.clear();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="classtileset.html#aca2eb129c686bec0d2a46abb946f9b0e">tile_ids</a>.clear();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">for</span>( std::unordered_map&lt;std::string, season_tile_value&gt; &amp;m : <a class="code" href="classtileset.html#ae3313358358957d02fed95459d7310c2">tile_ids_by_season</a> ) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        m.clear();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classtileset.html#a8d45aa2af0836d4a891605e7a44cfa9d">item_layer_data</a>.clear();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="classtileset.html#a0da13b421e62420ed996ed2a265cf392">field_layer_data</a>.clear();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">const</span> <a class="code" href="structtile__type.html">tile_type</a> *<a class="code" href="classtileset.html#a9ed12e41bec6146436a09ec98ed1da17">tileset::find_tile_type</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span> )<span class="keyword"> const</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> iter = <a class="code" href="classtileset.html#aca2eb129c686bec0d2a46abb946f9b0e">tile_ids</a>.find( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">return</span> iter != <a class="code" href="classtileset.html#aca2eb129c686bec0d2a46abb946f9b0e">tile_ids</a>.end() ? &amp;iter-&gt;second : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;std::optional&lt;tile_lookup_res&gt;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<a class="code" href="classtileset.html#a4b51509ab6d1260d6f3fd9007553283e">tileset::find_tile_type_by_season</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1b">season_type</a> season )<span class="keyword"> const</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( <a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a> &lt; <a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1bafe1e85bb91d56f81f6f62a88e9ba318a">season_type::NUM_SEASONS</a> );</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> iter = <a class="code" href="classtileset.html#ae3313358358957d02fed95459d7310c2">tile_ids_by_season</a>[<a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a>].find( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span>( iter == <a class="code" href="classtileset.html#ae3313358358957d02fed95459d7310c2">tile_ids_by_season</a>[<a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a>].<a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">end</a>() ) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtileset_1_1season__tile__value.html">tileset::season_tile_value</a> &amp;res = iter-&gt;second;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span>( res.<a class="code" href="structtileset_1_1season__tile__value.html#ae6d6ac004f8be2fd015dd510c72ae7c2">season_tile</a> ) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">return</span> *res.<a class="code" href="structtileset_1_1season__tile__value.html#ae6d6ac004f8be2fd015dd510c72ae7c2">season_tile</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( res.<a class="code" href="structtileset_1_1season__tile__value.html#a7a105d4122840a82a4efc024d749553e">default_tile</a> ) { <span class="comment">// can skip this check, but just in case</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classtile__lookup__res.html">tile_lookup_res</a>( iter-&gt;first, *res.<a class="code" href="structtileset_1_1season__tile__value.html#a7a105d4122840a82a4efc024d749553e">default_tile</a> );</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;empty record found in `tile_ids_by_season` for key: %s&quot;</span>, <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<a class="code" href="structtile__type.html">tile_type</a> &amp;<a class="code" href="classtileset.html#a8adad8c500dce4878965211966a5f3c7">tileset::create_tile_type</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <a class="code" href="structtile__type.html">tile_type</a> &amp;&amp;new_tile_type )</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// Must overwrite existing tile</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// TODO: c++17 - replace [] + find() with insert_or_assign()</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="classtileset.html#aca2eb129c686bec0d2a46abb946f9b0e">tile_ids</a>[<a class="code" href="namespacebase__camps.html#a04fa69b1c0952a34dc4a7d26b3f9f786">id</a>] = std::move( new_tile_type );</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">auto</span> inserted = <a class="code" href="classtileset.html#aca2eb129c686bec0d2a46abb946f9b0e">tile_ids</a>.find( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keyword">const</span> std::string &amp;inserted_id = inserted-&gt;first;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="structtile__type.html">tile_type</a> &amp;inserted_tile = inserted-&gt;second;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// populate cache by season</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    constexpr <span class="keywordtype">size_t</span> suffix_len = 15;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">// NOLINTNEXTLINE(cata-use-mdarray,modernize-avoid-c-arrays)</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    constexpr <span class="keywordtype">char</span> season_suffix[<a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1bafe1e85bb91d56f81f6f62a88e9ba318a">NUM_SEASONS</a>][suffix_len] = {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="stringliteral">&quot;_season_spring&quot;</span>, <span class="stringliteral">&quot;_season_summer&quot;</span>, <span class="stringliteral">&quot;_season_autumn&quot;</span>, <span class="stringliteral">&quot;_season_winter&quot;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    };</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">bool</span> has_season_suffix = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1bafe1e85bb91d56f81f6f62a88e9ba318a">NUM_SEASONS</a>; i++ ) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a9c0114ce66e3c9758214c5a9d68e8702">string_ends_with</a>( <span class="keywordtype">id</span>, season_suffix[i] ) ) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            has_season_suffix = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="comment">// key is id without _season suffix</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            season_tile_value &amp;value = <a class="code" href="classtileset.html#ae3313358358957d02fed95459d7310c2">tile_ids_by_season</a>[i][<span class="keywordtype">id</span>.substr( 0,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                       <span class="keywordtype">id</span>.<a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>() - strlen( season_suffix[i] ) )];</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="comment">// value stores reference to string id with _season suffix</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            value.season_tile = <a class="code" href="classtile__lookup__res.html">tile_lookup_res</a>( inserted_id, inserted_tile );</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// tile doesn&#39;t have _season suffix, add it as &quot;default&quot; into all four seasons</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span>( !has_season_suffix ) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;by_season_map : <a class="code" href="classtileset.html#ae3313358358957d02fed95459d7310c2">tile_ids_by_season</a> ) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            by_season_map[<a class="code" href="namespacebase__camps.html#a04fa69b1c0952a34dc4a7d26b3f9f786">id</a>].default_tile = &amp;inserted_tile;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">return</span> inserted_tile;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a7da76855b701d38da8acb5ea329ea2b9">cata_tiles::load_tileset</a>( <span class="keyword">const</span> std::string &amp;tileset_id, <span class="keyword">const</span> <span class="keywordtype">bool</span> precheck,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                               <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a>, <span class="keyword">const</span> <span class="keywordtype">bool</span> pump_events )</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="classcata__tiles.html#afd43a8b18dc2f3db7aa081f5edc4f92f">tileset_ptr</a> &amp;&amp; <a class="code" href="classcata__tiles.html#afd43a8b18dc2f3db7aa081f5edc4f92f">tileset_ptr</a>-&gt;get_tileset_id() == tileset_id &amp;&amp; !<a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> ) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// TODO: move into clear or somewhere else.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// reset the overlay ordering from the previous loaded tileset</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="overlay__ordering_8cpp.html#a8c941dddc98116f69fb7404d30d4c1f0">tileset_mutation_overlay_ordering</a>.clear();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="classcata__tiles.html#afd43a8b18dc2f3db7aa081f5edc4f92f">tileset_ptr</a> = <a class="code" href="classcata__tiles.html#a9de43f937c038956997c0c574bd9cb29">cache</a>.<a class="code" href="classtileset__cache.html#a05384512fc8ba3e8bc906b2bf35d32ec">load_tileset</a>( tileset_id, <a class="code" href="classcata__tiles.html#a5a88605a5b9b1f5523f75b7d254cc468">renderer</a>, precheck, <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a>, pump_events );</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="classcata__tiles.html#ad2e4ff6ac6d8ce8514dc1cb33f8c429e">set_draw_scale</a>( 16 );</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// Precalculate fog transparency</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// On isometric tilesets, fog intensity scales with zlevel_height in tile_config.json</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="classcata__tiles.html#a74e94514c3b73f5e0367d5c1dab721ae">fog_alpha</a> = <a class="code" href="classcata__tiles.html#a11ca576aa837dabdc6f16e3206f48e4e">is_isometric</a>() ? <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( <span class="keywordtype">int</span>( 255.0f - 255.0f * pow( 155.0f / 255.0f,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                           <a class="code" href="classcata__tiles.html#aede13a359e6992b80aa3246cc300e650">zlevel_height</a> / 100.0f ) ), 40 ), 150 ) : 100;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a46bd185110872077b734d30dc2522ffd">cata_tiles::reinit</a>()</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="classcata__tiles.html#ad2e4ff6ac6d8ce8514dc1cb33f8c429e">set_draw_scale</a>( 16 );</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="sdl__wrappers_8h.html#aa1a4879dac5ea6742dcabf3b5e1b6e01">RenderClear</a>( <a class="code" href="classcata__tiles.html#a5a88605a5b9b1f5523f75b7d254cc468">renderer</a> );</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> get_tile_information( <span class="keyword">const</span> <a class="code" href="classcata__path.html">cata_path</a> &amp;config_path, std::string &amp;json_path,</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                  std::string &amp;tileset_path, std::string &amp;layering_path )</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">const</span> std::string default_json = <a class="code" href="namespacePATH__INFO.html#ae4c0906500b222227e00bc34cc94252f">PATH_INFO::defaulttilejson</a>();</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">const</span> std::string default_tileset = <a class="code" href="namespacePATH__INFO.html#a0773f1e01a9fb190c2f1e385ad2892b1">PATH_INFO::defaulttilepng</a>();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">const</span> std::string default_layering = <a class="code" href="namespacePATH__INFO.html#a3aa2e839e6beebf5c776979147cd0d4b">PATH_INFO::defaultlayeringjson</a>();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// Get JSON and TILESET vars from config</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> reader = [&amp;]( std::istream &amp; fin ) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">while</span>( !fin.eof() ) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            std::string sOption;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            fin &gt;&gt; sOption;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( sOption, <span class="stringliteral">&quot;JSON&quot;</span> ) ) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                fin &gt;&gt; json_path;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;JSON path set to [&quot;</span> &lt;&lt; json_path &lt;&lt; <span class="stringliteral">&quot;].&quot;</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( sOption, <span class="stringliteral">&quot;TILESET&quot;</span> ) ) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                fin &gt;&gt; tileset_path;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;TILESET path set to [&quot;</span> &lt;&lt; tileset_path &lt;&lt; <span class="stringliteral">&quot;].&quot;</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( sOption, <span class="stringliteral">&quot;LAYERING&quot;</span> ) ) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                fin &gt;&gt; layering_path;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;LAYERING path set to [&quot;</span> &lt;&lt; layering_path &lt;&lt; <span class="stringliteral">&quot;].&quot;</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                getline( fin, sOption );</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    };</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="cata__utility_8cpp.html#a10f070374b4e9c11ba1c0229291b4355">read_from_file</a>( config_path, reader ) ) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        json_path = default_json;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        tileset_path = default_tileset;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        layering_path = default_layering;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span>( json_path.empty() ) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        json_path = default_json;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;JSON set to default [&quot;</span> &lt;&lt; json_path &lt;&lt; <span class="stringliteral">&quot;].&quot;</span>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">if</span>( tileset_path.empty() ) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        tileset_path = default_tileset;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;TILESET set to default [&quot;</span> &lt;&lt; tileset_path &lt;&lt; <span class="stringliteral">&quot;].&quot;</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span>( layering_path.empty() ) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        layering_path = default_layering;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;TILESET set to default [&quot;</span> &lt;&lt; layering_path &lt;&lt; <span class="stringliteral">&quot;].&quot;</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> PixelConverter&gt;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keyword">static</span> <a class="code" href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a> apply_color_filter( <span class="keyword">const</span> <a class="code" href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a> &amp;original,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        PixelConverter pixel_converter )</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( original );</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a> surf = <a class="code" href="sdl__utils_8h.html#a2409219be466cff794b21b6fbe6154a5">create_surface_32</a>( original-&gt;w, original-&gt;h );</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( surf );</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="sdl__wrappers_8h.html#a96ef366875d5a5af3f5ade783ef6cd43">throwErrorIf</a>( SDL_BlitSurface( original.get(), <span class="keyword">nullptr</span>, surf.get(), <span class="keyword">nullptr</span> ) != 0,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                  <span class="stringliteral">&quot;SDL_BlitSurface failed&quot;</span> );</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    SDL_Color *pix = <span class="keyword">static_cast&lt;</span>SDL_Color *<span class="keyword">&gt;</span>( surf-&gt;pixels );</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> y = 0, ey = surf-&gt;h; y &lt; ey; ++y ) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> x = 0, ex = surf-&gt;w; x &lt; ex; ++x, ++pix ) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keywordflow">if</span>( pix-&gt;a == 0x00 ) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="comment">// This check significantly improves the performance since</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="comment">// vast majority of pixels in the tilesets are completely transparent.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            *pix = pixel_converter( *pix );</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> surf;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> is_contained( <span class="keyword">const</span> SDL_Rect &amp;smaller, <span class="keyword">const</span> SDL_Rect &amp;larger )</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;{</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">return</span> smaller.x &gt;= larger.x &amp;&amp;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;           smaller.y &gt;= larger.y &amp;&amp;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;           smaller.x + smaller.w &lt;= larger.x + larger.w &amp;&amp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;           smaller.y + smaller.h &lt;= larger.y + larger.h;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;}</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#a4b4186730919d5ac9063c1a46126d1fa">tileset_cache::loader::copy_surface_to_texture</a>( <span class="keyword">const</span> <a class="code" href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a> &amp;surf,</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;offset, std::vector&lt;texture&gt; &amp;target )</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;{</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( surf );</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keyword">const</span> <a class="code" href="classrect__range.html">rect_range&lt;SDL_Rect&gt;</a> input_range( <a class="code" href="classtileset__cache_1_1loader.html#aa0b1f3ac1fde6259b12a3e66305f2476">sprite_width</a>, <a class="code" href="classtileset__cache_1_1loader.html#a142d73e15f822c0e0eaa4d94d90230ee">sprite_height</a>,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                            <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( surf-&gt;w / <a class="code" href="classtileset__cache_1_1loader.html#aa0b1f3ac1fde6259b12a3e66305f2476">sprite_width</a>,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                    surf-&gt;h / <a class="code" href="classtileset__cache_1_1loader.html#a142d73e15f822c0e0eaa4d94d90230ee">sprite_height</a> ) );</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keyword">const</span> std::shared_ptr&lt;SDL_Texture&gt; texture_ptr = <a class="code" href="sdl__wrappers_8h.html#a66f609a8ce2a0c74718371608a48de52">CreateTextureFromSurface</a>( <a class="code" href="classtileset__cache_1_1loader.html#aa4ff78e9b3f87c3b06f25a264623b360">renderer</a>, surf );</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( texture_ptr );</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> SDL_Rect rect : input_range ) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( <a class="code" href="classtileset__cache_1_1loader.html#a16bc4517a4d542a3e5487e6ab95d5522">offset</a>.x % <a class="code" href="classtileset__cache_1_1loader.html#aa0b1f3ac1fde6259b12a3e66305f2476">sprite_width</a> == 0 );</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( <a class="code" href="classtileset__cache_1_1loader.html#a16bc4517a4d542a3e5487e6ab95d5522">offset</a>.y % <a class="code" href="classtileset__cache_1_1loader.html#a142d73e15f822c0e0eaa4d94d90230ee">sprite_height</a> == 0 );</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>( <a class="code" href="classtileset__cache_1_1loader.html#a16bc4517a4d542a3e5487e6ab95d5522">offset</a> + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( rect.x, rect.y ) );</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.x % <a class="code" href="classtileset__cache_1_1loader.html#aa0b1f3ac1fde6259b12a3e66305f2476">sprite_width</a> == 0 );</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.y % <a class="code" href="classtileset__cache_1_1loader.html#a142d73e15f822c0e0eaa4d94d90230ee">sprite_height</a> == 0 );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">size_t</span> index = this-&gt;offset + ( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.x / <a class="code" href="classtileset__cache_1_1loader.html#aa0b1f3ac1fde6259b12a3e66305f2476">sprite_width</a> ) + ( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.y / <a class="code" href="classtileset__cache_1_1loader.html#a142d73e15f822c0e0eaa4d94d90230ee">sprite_height</a> ) *</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                             ( <a class="code" href="classtileset__cache_1_1loader.html#a346e3d6d84e15a41254a3a3ee9bcacd3">tile_atlas_width</a> / <a class="code" href="classtileset__cache_1_1loader.html#aa0b1f3ac1fde6259b12a3e66305f2476">sprite_width</a> );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( index &lt; target.size() );</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( target[index].dimension() == std::make_pair( 0, 0 ) );</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        target[index] = <a class="code" href="classtexture.html">texture</a>( texture_ptr, rect );</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#ad9f31ae46c61ae8fc813ab164e93db61">tileset_cache::loader::create_textures_from_tile_atlas</a>( <span class="keyword">const</span> <a class="code" href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a> &amp;tile_atlas,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;offset )</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;{</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( tile_atlas );</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">    /** perform color filter conversion here */</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keyword">using</span> tiles_pixel_color_entry = std::tuple&lt;std::vector&lt;texture&gt;*, std::string&gt;;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    std::array&lt;tiles_pixel_color_entry, 5&gt; tile_values_data = {{</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            { std::make_tuple( &amp;ts.tile_values, <span class="stringliteral">&quot;color_pixel_none&quot;</span> ) },</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            { std::make_tuple( &amp;ts.shadow_tile_values, <span class="stringliteral">&quot;color_pixel_grayscale&quot;</span> ) },</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            { std::make_tuple( &amp;ts.night_tile_values, <span class="stringliteral">&quot;color_pixel_nightvision&quot;</span> ) },</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            { std::make_tuple( &amp;ts.overexposed_tile_values, <span class="stringliteral">&quot;color_pixel_overexposed&quot;</span> ) },</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            { std::make_tuple( &amp;ts.memory_tile_values, tilecontext-&gt;memory_map_mode ) }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    };</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">for</span>( tiles_pixel_color_entry &amp;entry : tile_values_data ) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        std::vector&lt;texture&gt; *tile_values = std::get&lt;0&gt;( entry );</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <a class="code" href="sdl__utils_8h.html#ae5e7ac0c9e3047b91b4560fe8bef99dc">color_pixel_function_pointer</a> color_pixel_function = <a class="code" href="sdl__utils_8h.html#afccebc0a4cff6737d67af7916994a164">get_color_pixel_function</a>( std::get&lt;1&gt;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                ( entry ) );</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span>( !color_pixel_function ) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="comment">// TODO: Move it inside apply_color_filter.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            copy_surface_to_texture( tile_atlas, offset, *tile_values );</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            copy_surface_to_texture( apply_color_filter( tile_atlas, color_pixel_function ), offset,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                     *tile_values );</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;}</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> extend_vector_by( std::vector&lt;T&gt; &amp;vec, <span class="keyword">const</span> <span class="keywordtype">size_t</span> additional_size )</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    vec.resize( vec.size() + additional_size );</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#ad7521b8e51c47aa487931970839931c5">tileset_cache::loader::load_tileset</a>( <span class="keyword">const</span> <a class="code" href="classcata__path.html">cata_path</a> &amp;img_path, <span class="keyword">const</span> <span class="keywordtype">bool</span> pump_events )</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;{</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( sprite_width &gt; 0 );</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( sprite_height &gt; 0 );</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keyword">const</span> <a class="code" href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a> tile_atlas = <a class="code" href="sdl__wrappers_8h.html#a0f93a5649ece71c19c5c25934f80abb9">load_image</a>( img_path.<a class="code" href="classcata__path.html#a646b95d8226cb386e914b263635efe35">get_unrelative_path</a>().u8string().c_str() );</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( tile_atlas );</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    tile_atlas_width = tile_atlas-&gt;w;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">if</span>( R &gt;= 0 &amp;&amp; R &lt;= 255 &amp;&amp; G &gt;= 0 &amp;&amp; G &lt;= 255 &amp;&amp; B &gt;= 0 &amp;&amp; B &lt;= 255 ) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keyword">const</span> Uint32 key = SDL_MapRGB( tile_atlas-&gt;format, 0, 0, 0 );</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <a class="code" href="sdl__wrappers_8h.html#a96ef366875d5a5af3f5ade783ef6cd43">throwErrorIf</a>( SDL_SetColorKey( tile_atlas.get(), SDL_TRUE, key ) != 0,</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                      <span class="stringliteral">&quot;SDL_SetColorKey failed&quot;</span> );</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <a class="code" href="sdl__wrappers_8h.html#a96ef366875d5a5af3f5ade783ef6cd43">throwErrorIf</a>( SDL_SetSurfaceRLE( tile_atlas.get(), 1 ), <span class="stringliteral">&quot;SDL_SetSurfaceRLE failed&quot;</span> );</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    SDL_RendererInfo info;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="sdl__wrappers_8h.html#a96ef366875d5a5af3f5ade783ef6cd43">throwErrorIf</a>( SDL_GetRendererInfo( renderer.get(), &amp;info ) != 0, <span class="stringliteral">&quot;SDL_GetRendererInfo failed&quot;</span> );</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// Software rendering stores textures as surfaces with run-length encoding, which makes</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// extracting a part in the middle of the texture slow. Therefore this &quot;simulates&quot; that the</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// renderer only supports one tile</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// per texture. Each tile will go on its own texture object.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span>( info.flags &amp; SDL_RENDERER_SOFTWARE ) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        info.max_texture_width = sprite_width;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        info.max_texture_height = sprite_height;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">// for debugging only: force a very small maximal texture size, as to trigger</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">// splitting the tile atlas.</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// +1 to check correct rounding</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    info.max_texture_width = sprite_width * 10 + 1;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    info.max_texture_height = sprite_height * 20 + 1;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> min_tile_xcount = 128;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> min_tile_ycount = min_tile_xcount * 2;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">if</span>( info.max_texture_width == 0 ) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        info.max_texture_width = sprite_width * min_tile_xcount;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <a class="code" href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a>, <a class="code" href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14">DC_ALL</a> ) &lt;&lt; <span class="stringliteral">&quot;SDL_RendererInfo max_texture_width was set to 0. &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                   <span class="stringliteral">&quot; Changing it to &quot;</span> &lt;&lt; info.max_texture_width;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="sdl__wrappers_8h.html#a96ef366875d5a5af3f5ade783ef6cd43">throwErrorIf</a>( info.max_texture_width &lt; sprite_width,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                      <span class="stringliteral">&quot;Maximal texture width is smaller than tile width&quot;</span> );</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordflow">if</span>( info.max_texture_height == 0 ) {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        info.max_texture_height = sprite_height * min_tile_ycount;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a>, <a class="code" href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14">DC_ALL</a> ) &lt;&lt; <span class="stringliteral">&quot;SDL_RendererInfo max_texture_height was set to 0. &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                   <span class="stringliteral">&quot; Changing it to &quot;</span> &lt;&lt; info.max_texture_height;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="sdl__wrappers_8h.html#a96ef366875d5a5af3f5ade783ef6cd43">throwErrorIf</a>( info.max_texture_height &lt; sprite_height,</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                      <span class="stringliteral">&quot;Maximal texture height is smaller than tile height&quot;</span> );</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// Number of tiles in each dimension that fits into a (maximal) SDL texture.</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// If the tile atlas contains more than that, we have to split it.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> max_tile_xcount = info.max_texture_width / sprite_width;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> max_tile_ycount = info.max_texture_height / sprite_height;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">// Range over the tile atlas, wherein each rectangle fits into the maximal</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">// SDL texture size. In other words: a range over the parts into which the</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// tile atlas needs to be split.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keyword">const</span> <a class="code" href="classrect__range.html">rect_range&lt;SDL_Rect&gt;</a> output_range(</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        max_tile_xcount * sprite_width,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        max_tile_ycount * sprite_height,</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( tile_atlas-&gt;w, info.max_texture_width ),</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;               <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( tile_atlas-&gt;h, info.max_texture_height ) ) );</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> expected_tilecount = ( tile_atlas-&gt;w / sprite_width ) *</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                   ( tile_atlas-&gt;h / sprite_height );</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    extend_vector_by( ts.tile_values, expected_tilecount );</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    extend_vector_by( ts.shadow_tile_values, expected_tilecount );</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    extend_vector_by( ts.night_tile_values, expected_tilecount );</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    extend_vector_by( ts.overexposed_tile_values, expected_tilecount );</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    extend_vector_by( ts.memory_tile_values, expected_tilecount );</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> SDL_Rect sub_rect : output_range ) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( sub_rect.x % sprite_width == 0 );</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( sub_rect.y % sprite_height == 0 );</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( sub_rect.w % sprite_width == 0 );</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( sub_rect.h % sprite_height == 0 );</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <a class="code" href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a> smaller_surf;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">if</span>( is_contained( SDL_Rect{ 0, 0, tile_atlas-&gt;w, tile_atlas-&gt;h }, sub_rect ) ) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="comment">// can use tile_atlas directly, it is completely contained in the output rectangle</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="comment">// Need a temporary surface that contains the parts of the tile atlas that fit</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="comment">// into sub_rect. But doesn&#39;t always need to be as large as sub_rect.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> w = <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( tile_atlas-&gt;w - sub_rect.x, sub_rect.w );</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> h = <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( tile_atlas-&gt;h - sub_rect.y, sub_rect.h );</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            smaller_surf = <a class="code" href="sdl__utils_8h.html#a2409219be466cff794b21b6fbe6154a5">::create_surface_32</a>( w, h );</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( smaller_surf );</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keyword">const</span> SDL_Rect inp{ sub_rect.x, sub_rect.y, w, h };</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <a class="code" href="sdl__wrappers_8h.html#a96ef366875d5a5af3f5ade783ef6cd43">throwErrorIf</a>( SDL_BlitSurface( tile_atlas.get(), &amp;inp, smaller_surf.get(),</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                           <span class="keyword">nullptr</span> ) != 0, <span class="stringliteral">&quot;SDL_BlitSurface failed&quot;</span> );</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keyword">const</span> <a class="code" href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a> &amp;surf_to_use = smaller_surf ? smaller_surf : tile_atlas;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( surf_to_use );</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        create_textures_from_tile_atlas( surf_to_use, <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( sub_rect.x, sub_rect.y ) );</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">if</span>( pump_events ) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <a class="code" href="input_8cpp.html#af16c50890fa8503efa899fc3b6de56d7">inp_mngr</a>.<a class="code" href="classinput__manager.html#a56fd029f8ad1ca3dcd864a6bb5537045">pump_events</a>();</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> = expected_tilecount;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#ad2e4ff6ac6d8ce8514dc1cb33f8c429e">cata_tiles::set_draw_scale</a>( <span class="keywordtype">int</span> <a class="code" href="namespacecoords.html#aefed5186be640da17dc0e723c536715a">scale</a> )</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;{</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( tileset_ptr );</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> mult = tileset_ptr-&gt;get_tile_pixelscale() * <a class="code" href="namespacecoords.html#aefed5186be640da17dc0e723c536715a">scale</a>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacemath__opers.html#a23fff2e10d1c6eec78481f24fb5d9de3">div</a> = 16;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    tile_width = tileset_ptr-&gt;get_tile_width() * mult / <a class="code" href="namespacemath__opers.html#a23fff2e10d1c6eec78481f24fb5d9de3">div</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> = tileset_ptr-&gt;get_tile_height() * mult / <a class="code" href="namespacemath__opers.html#a23fff2e10d1c6eec78481f24fb5d9de3">div</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    max_tile_extent = tileset_ptr-&gt;get_max_tile_extent();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">// Rounding down because the extent may be negative</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    max_tile_extent.p_min.x = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( max_tile_extent.p_min.x * mult, <a class="code" href="namespacemath__opers.html#a23fff2e10d1c6eec78481f24fb5d9de3">div</a> );</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    max_tile_extent.p_min.y = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( max_tile_extent.p_min.y * mult, <a class="code" href="namespacemath__opers.html#a23fff2e10d1c6eec78481f24fb5d9de3">div</a> );</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    max_tile_extent.p_max.x = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( max_tile_extent.p_max.x * mult, <a class="code" href="namespacemath__opers.html#a23fff2e10d1c6eec78481f24fb5d9de3">div</a> );</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    max_tile_extent.p_max.y = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( max_tile_extent.p_max.y * mult, <a class="code" href="namespacemath__opers.html#a23fff2e10d1c6eec78481f24fb5d9de3">div</a> );</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    zlevel_height = tileset_ptr-&gt;get_zlevel_height();</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;}</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#a940ec9501c853091a272adce26cf1ac9">tileset_cache::loader::load</a>( <span class="keyword">const</span> std::string &amp;tileset_id, <span class="keyword">const</span> <span class="keywordtype">bool</span> precheck,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">bool</span> pump_events )</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;{</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    std::string json_conf;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    std::string layering;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    std::string tileset_path;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="classcata__path.html">cata_path</a> tileset_root;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">bool</span> has_layering = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> tset_iter = <a class="code" href="options_8cpp.html#aec4a86b552158c4900ef652a0bdf1fc4">TILESETS</a>.find( tileset_id );</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">if</span>( tset_iter != <a class="code" href="options_8cpp.html#aec4a86b552158c4900ef652a0bdf1fc4">TILESETS</a>.end() ) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        tileset_root = tset_iter-&gt;second;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="charliteral">&#39;&quot;&#39;</span> &lt;&lt; tileset_id &lt;&lt; <span class="charliteral">&#39;&quot;&#39;</span> &lt;&lt; <span class="stringliteral">&quot; tileset: found config file path: &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                      tileset_root;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        get_tile_information( tileset_root / <a class="code" href="namespacePATH__INFO.html#adcb5161c3623a688d09bf1a0bc575dce">PATH_INFO::tileset_conf</a>(),</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                              json_conf, tileset_path, layering );</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;Current tileset is: &quot;</span> &lt;&lt; tileset_id;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395a4759bd3f0b71819391a3e4024b645d69">D_ERROR</a> ) &lt;&lt; <span class="stringliteral">&quot;Tileset \&quot;&quot;</span> &lt;&lt; tileset_id &lt;&lt; <span class="stringliteral">&quot;\&quot; from options is invalid&quot;</span>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        json_conf = <a class="code" href="namespacePATH__INFO.html#ae4c0906500b222227e00bc34cc94252f">PATH_INFO::defaulttilejson</a>();</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        tileset_path = <a class="code" href="namespacePATH__INFO.html#a0773f1e01a9fb190c2f1e385ad2892b1">PATH_INFO::defaulttilepng</a>();</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        layering = <a class="code" href="namespacePATH__INFO.html#a3aa2e839e6beebf5c776979147cd0d4b">PATH_INFO::defaultlayeringjson</a>();</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="classcata__path.html">cata_path</a> json_path = tileset_root / fs::u8path( json_conf );</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="classcata__path.html">cata_path</a> img_path = tileset_root / fs::u8path( tileset_path );</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="classcata__path.html">cata_path</a> layering_path = tileset_root / fs::u8path( layering );</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;Attempting to Load LAYERING file &quot;</span> &lt;&lt; layering_path;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    std::ifstream layering_file( layering_path.<a class="code" href="classcata__path.html#a646b95d8226cb386e914b263635efe35">get_unrelative_path</a>(),</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                 std::ifstream::in | std::ifstream::binary );</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">if</span>( !layering_file.good() ) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        has_layering = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="comment">//throw std::runtime_error(std::string(&quot;Failed to open layering info json: &quot;) + layering_path);</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;Attempting to Load JSON file &quot;</span> &lt;&lt; json_path;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    std::optional&lt;JsonValue&gt; config_json = <a class="code" href="classjson__loader.html#a411c04aa29647a241f76a899fbf95193">json_loader::from_path_opt</a>( json_path );</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">if</span>( !config_json.has_value() ) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error( std::string( <span class="stringliteral">&quot;Failed to open tile info json: &quot;</span> ) +</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                  json_path.<a class="code" href="classcata__path.html#a009b2bd4a635112ff57695717ff092c0">generic_u8string</a>() );</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="classJsonObject.html">JsonObject</a> config = ( *config_json ).<a class="code" href="classJsonObject.html#a3b9722313d9692826235c87e73e94f04">get_object</a>();</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    config.<a class="code" href="classJsonObject.html#ae00f195360e3783cf50527cf07344202">allow_omitted_members</a>();</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// &quot;tile_info&quot; section must exist.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">if</span>( !config.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;tile_info&quot;</span> ) ) {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        config.<a class="code" href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">throw_error</a>( <span class="stringliteral">&quot;\&quot;tile_info\&quot; missing&quot;</span> );</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> curr_info : config.<a class="code" href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">get_array</a>( <span class="stringliteral">&quot;tile_info&quot;</span> ) ) {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        ts.tile_height = curr_info.get_int( <span class="stringliteral">&quot;height&quot;</span> );</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        ts.tile_width = curr_info.get_int( <span class="stringliteral">&quot;width&quot;</span> );</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        ts.max_tile_extent = <a class="code" href="structhalf__open__rectangle.html">half_open_rectangle&lt;point&gt;</a>( <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>, { ts.tile_width, ts.tile_height } );</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        ts.zlevel_height = curr_info.get_int( <span class="stringliteral">&quot;zlevel_height&quot;</span>, 0 );</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        ts.tile_isometric = curr_info.get_bool( <span class="stringliteral">&quot;iso&quot;</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        ts.tile_pixelscale = curr_info.get_float( <span class="stringliteral">&quot;pixelscale&quot;</span>, 1.0f );</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        ts.prevent_occlusion_min_dist = curr_info.get_float( <span class="stringliteral">&quot;retract_dist_min&quot;</span>, -1.0f );</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        ts.prevent_occlusion_max_dist = curr_info.get_float( <span class="stringliteral">&quot;retract_dist_max&quot;</span>, 0.0f );</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span>( precheck ) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        config.<a class="code" href="classJsonObject.html#ae00f195360e3783cf50527cf07344202">allow_omitted_members</a>();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    ts.clear();</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">// Load tile information if available.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    offset = 0;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    load_internal( config, tileset_root, img_path, pump_events );</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// Load mod tilesets if available</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classmod__tileset.html">mod_tileset</a> &amp;mts : <a class="code" href="mod__tileset_8cpp.html#a93e6a2baacda4ff3c16d4046bfb58f26">all_mod_tilesets</a> ) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="comment">// Set sprite_id offset to separate from other tilesets.</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        sprite_id_offset = offset;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        tileset_root = mts.get_base_path();</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        json_path = mts.get_full_path();</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">if</span>( !mts.is_compatible( tileset_id ) ) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395a4759bd3f0b71819391a3e4024b645d69">D_ERROR</a> ) &lt;&lt; <span class="stringliteral">&quot;Mod tileset in \&quot;&quot;</span> &lt;&lt; json_path &lt;&lt; <span class="stringliteral">&quot;\&quot; is not compatible with \&quot;&quot;</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                           &lt;&lt; tileset_id &lt;&lt; <span class="stringliteral">&quot;\&quot;.&quot;</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;Attempting to Load JSON file &quot;</span> &lt;&lt; json_path;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        std::optional&lt;JsonValue&gt; mod_config_json_opt = <a class="code" href="classjson__loader.html#a411c04aa29647a241f76a899fbf95193">json_loader::from_path_opt</a>( json_path );</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">if</span>( !mod_config_json_opt.has_value() ) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            <span class="keywordflow">throw</span> std::runtime_error( std::string( <span class="stringliteral">&quot;Failed to open tile info json: &quot;</span> ) +</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                      json_path.<a class="code" href="classcata__path.html#a009b2bd4a635112ff57695717ff092c0">generic_u8string</a>() );</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="classJsonValue.html">JsonValue</a> &amp;mod_config_json = *mod_config_json_opt;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> mark_visited = []( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp; jobj ) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="comment">// These fields have been visited in load_mod_tileset</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            jobj.get_string_array( <span class="stringliteral">&quot;compatibility&quot;</span> );</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        };</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordtype">int</span> num_in_file = 1;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordflow">if</span>( mod_config_json.<a class="code" href="classJsonValue.html#a330b5aee6bbf5749eb972c833d8d7b2a">test_array</a>() ) {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> mod_config : mod_config_json.<a class="code" href="classJsonValue.html#ab7d103bab8c971a0c80972b04a18148f">get_array</a>() ) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="keywordflow">if</span>( mod_config.get_string( <span class="stringliteral">&quot;type&quot;</span> ) == <span class="stringliteral">&quot;mod_tileset&quot;</span> ) {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                    mark_visited( mod_config );</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    <span class="keywordflow">if</span>( num_in_file == mts.num_in_file() ) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                        <span class="comment">// visit this if it exists, it&#39;s used elsewhere</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                        <span class="keywordflow">if</span>( mod_config.has_member( <span class="stringliteral">&quot;compatibility&quot;</span> ) ) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                            mod_config.get_member( <span class="stringliteral">&quot;compatibility&quot;</span> );</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                        }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                        load_internal( mod_config, tileset_root, img_path, pump_events );</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    num_in_file++;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <a class="code" href="classJsonObject.html">JsonObject</a> mod_config = mod_config_json.<a class="code" href="classJsonValue.html#aa90309342403c2e86b358ce996e34a1f">get_object</a>();</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            mark_visited( mod_config );</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            load_internal( mod_config, tileset_root, img_path, pump_events );</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">// loop through all tile ids and eliminate empty/invalid things</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">auto</span> it = ts.tile_ids.begin(); it != ts.tile_ids.end(); ) {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="comment">// second is the tile_type describing that id</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <a class="code" href="structtile__type.html">tile_type</a> &amp;td = it-&gt;second;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        process_variations_after_loading( td.<a class="code" href="structtile__type.html#a35bb6574422477b93e5b447fb16d4cfb">fg</a> );</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        process_variations_after_loading( td.<a class="code" href="structtile__type.html#a0cbe74ee58be622d2e5399a791ae3efe">bg</a> );</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="comment">// All tiles need at least foreground or background data, otherwise they are useless.</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">if</span>( td.<a class="code" href="structtile__type.html#a0cbe74ee58be622d2e5399a791ae3efe">bg</a>.<a class="code" href="structweighted__list.html#ac22edb12b0027bf3f6d35e6504aeacb5">empty</a>() &amp;&amp; td.<a class="code" href="structtile__type.html#a35bb6574422477b93e5b447fb16d4cfb">fg</a>.<a class="code" href="structweighted__list.html#ac22edb12b0027bf3f6d35e6504aeacb5">empty</a>() ) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395a4759bd3f0b71819391a3e4024b645d69">D_ERROR</a> ) &lt;&lt; <span class="stringliteral">&quot;tile &quot;</span> &lt;&lt; it-&gt;first &lt;&lt; <span class="stringliteral">&quot; has no (valid) foreground nor background&quot;</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            ts.tile_ids.erase( it++ );</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            ++it;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">if</span>( !ts.find_tile_type( <span class="stringliteral">&quot;unknown&quot;</span> ) ) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395a4759bd3f0b71819391a3e4024b645d69">D_ERROR</a> ) &lt;&lt; <span class="stringliteral">&quot;The tileset you&#39;re using has no &#39;unknown&#39; tile defined!&quot;</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    ensure_default_item_highlight();</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    ts.tileset_id = tileset_id;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">// set up layering data</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">if</span>( has_layering ) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <a class="code" href="classJsonValue.html">JsonValue</a> layering_json = <a class="code" href="classjson__loader.html#a7a982b06b5ed83465fb9e0ec0d9a36f1">json_loader::from_path</a>( layering_path );</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <a class="code" href="classJsonObject.html">JsonObject</a> layer_config = layering_json.<a class="code" href="classJsonValue.html#aa90309342403c2e86b358ce996e34a1f">get_object</a>();</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        layer_config.<a class="code" href="classJsonObject.html#ae00f195360e3783cf50527cf07344202">allow_omitted_members</a>();</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="comment">// &quot;variants&quot; section must exist.</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">if</span>( !layer_config.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;variants&quot;</span> ) ) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            layer_config.<a class="code" href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">throw_error</a>( <span class="stringliteral">&quot;\&quot;variants\&quot; missing&quot;</span> );</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        load_layers( layer_config );</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;}</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#ae00933ca88eb5829cc9fa71f2f076d25">tileset_cache::loader::load_internal</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;config,</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="keyword">const</span> <a class="code" href="classcata__path.html">cata_path</a> &amp;tileset_root,</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keyword">const</span> <a class="code" href="classcata__path.html">cata_path</a> &amp;img_path, <span class="keyword">const</span> <span class="keywordtype">bool</span> pump_events )</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;{</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">if</span>( config.<a class="code" href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">has_array</a>( <span class="stringliteral">&quot;tiles-new&quot;</span> ) ) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="comment">// new system, several entries</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="comment">// When loading multiple tileset images this defines where</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="comment">// the tiles from the most recently loaded image start from.</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> tile_part_def : config.<a class="code" href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">get_array</a>( <span class="stringliteral">&quot;tiles-new&quot;</span> ) ) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keyword">const</span> <a class="code" href="classcata__path.html">cata_path</a> tileset_image_path = tileset_root / tile_part_def.get_string( <span class="stringliteral">&quot;file&quot;</span> );</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            R = -1;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            G = -1;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            B = -1;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="keywordflow">if</span>( tile_part_def.has_object( <span class="stringliteral">&quot;transparency&quot;</span> ) ) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                <a class="code" href="classJsonObject.html">JsonObject</a> tra = tile_part_def.<a class="code" href="classJsonObject.html#a3b9722313d9692826235c87e73e94f04">get_object</a>( <span class="stringliteral">&quot;transparency&quot;</span> );</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                R = tra.<a class="code" href="classJsonObject.html#a532ea812759469d654c7fde4738d11d5">get_int</a>( <span class="stringliteral">&quot;R&quot;</span> );</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                G = tra.<a class="code" href="classJsonObject.html#a532ea812759469d654c7fde4738d11d5">get_int</a>( <span class="stringliteral">&quot;G&quot;</span> );</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                B = tra.<a class="code" href="classJsonObject.html#a532ea812759469d654c7fde4738d11d5">get_int</a>( <span class="stringliteral">&quot;B&quot;</span> );</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            sprite_width = tile_part_def.get_int( <span class="stringliteral">&quot;sprite_width&quot;</span>, ts.tile_width );</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            sprite_height = tile_part_def.get_int( <span class="stringliteral">&quot;sprite_height&quot;</span>, ts.tile_height );</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="comment">// Now load the tile definitions for the loaded tileset image.</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            sprite_offset.x = tile_part_def.get_int( <span class="stringliteral">&quot;sprite_offset_x&quot;</span>, 0 );</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            sprite_offset.y = tile_part_def.get_int( <span class="stringliteral">&quot;sprite_offset_y&quot;</span>, 0 );</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            sprite_offset_retracted.x = tile_part_def.get_int( <span class="stringliteral">&quot;sprite_offset_x_retracted&quot;</span>, sprite_offset.x );</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            sprite_offset_retracted.y = tile_part_def.get_int( <span class="stringliteral">&quot;sprite_offset_y_retracted&quot;</span>, sprite_offset.y );</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            sprite_pixelscale = tile_part_def.get_float( <span class="stringliteral">&quot;pixelscale&quot;</span>, 1.0 );</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="comment">// Update maximum tile extent</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            ts.max_tile_extent = <a class="code" href="structhalf__open__rectangle.html">half_open_rectangle&lt;point&gt;</a> {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( ts.max_tile_extent.p_min.x,</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                              <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( sprite_offset.x, sprite_offset_retracted.x ) ),</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                    <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( ts.max_tile_extent.p_min.y,</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                              <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( sprite_offset.y, sprite_offset_retracted.y ) ),</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                }, {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( ts.max_tile_extent.p_max.x,</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                              sprite_width + <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( sprite_offset.x, sprite_offset_retracted.x ) ),</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                    <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( ts.max_tile_extent.p_max.y,</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                              sprite_height + <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( sprite_offset.y, sprite_offset_retracted.y ) ),</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            };</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">// First load the tileset image to get the number of available tiles.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;Attempting to Load Tileset file &quot;</span> &lt;&lt; tileset_image_path;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <a class="code" href="classtileset__cache.html#a05384512fc8ba3e8bc906b2bf35d32ec">load_tileset</a>( tileset_image_path, pump_events );</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            load_tilejson_from_file( tile_part_def );</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">if</span>( tile_part_def.has_member( <span class="stringliteral">&quot;ascii&quot;</span> ) ) {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                load_ascii( tile_part_def );</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="comment">// Make sure the tile definitions of the next tileset image don&#39;t</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="comment">// override the current ones.</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            offset += <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">if</span>( pump_events ) {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                <a class="code" href="input_8cpp.html#af16c50890fa8503efa899fc3b6de56d7">inp_mngr</a>.<a class="code" href="classinput__manager.html#a56fd029f8ad1ca3dcd864a6bb5537045">pump_events</a>();</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        sprite_width = ts.tile_width;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        sprite_height = ts.tile_height;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        sprite_offset = <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        sprite_offset_retracted = <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        sprite_pixelscale = 1.0;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        R = -1;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        G = -1;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        B = -1;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="comment">// old system, no tile file path entry, only one array of tiles</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;Attempting to Load Tileset file &quot;</span> &lt;&lt; img_path;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <a class="code" href="classtileset__cache.html#a05384512fc8ba3e8bc906b2bf35d32ec">load_tileset</a>( img_path, pump_events );</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        load_tilejson_from_file( config );</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        offset = <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">// allows a tileset to override the order of mutation images being applied to a character</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">if</span>( config.<a class="code" href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">has_array</a>( <span class="stringliteral">&quot;overlay_ordering&quot;</span> ) ) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <a class="code" href="overlay__ordering_8cpp.html#ac5db61fe6b396780345c2e3e2fe2cf47">load_overlay_ordering_into_array</a>( config, <a class="code" href="overlay__ordering_8cpp.html#a8c941dddc98116f69fb7404d30d4c1f0">tileset_mutation_overlay_ordering</a> );</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">// offset should be the total number of sprites loaded from every tileset image</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">// eliminate any sprite references that are too high to exist</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">// also eliminate negative sprite references</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;}</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#ab693cfe57344d4a2f958e411890b8160">tileset_cache::loader::load_layers</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;config )</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;{</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> <a class="code" href="classitem.html">item</a> : config.<a class="code" href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">get_array</a>( <span class="stringliteral">&quot;variants&quot;</span> ) ) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="classitem.html">item</a>.has_member( <span class="stringliteral">&quot;context&quot;</span> ) &amp;&amp; ( <a class="code" href="classitem.html">item</a>.has_array( <span class="stringliteral">&quot;item_variants&quot;</span> ) ||</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                              <a class="code" href="classitem.html">item</a>.has_array( <span class="stringliteral">&quot;field_variants&quot;</span> ) ) ) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            std::string <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a> = <a class="code" href="classitem.html">item</a>.get_string( <span class="stringliteral">&quot;context&quot;</span> );</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            std::vector&lt;layer_variant&gt; item_variants;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            std::vector&lt;layer_variant&gt; field_variants;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classitem.html">item</a>.has_array( <span class="stringliteral">&quot;item_variants&quot;</span> ) ) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a> : <a class="code" href="classitem.html">item</a>.get_array( <span class="stringliteral">&quot;item_variants&quot;</span> ) ) {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                    <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.has_member( <span class="stringliteral">&quot;item&quot;</span> ) &amp;&amp; <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.has_array( <span class="stringliteral">&quot;sprite&quot;</span> ) &amp;&amp; <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.has_member( <span class="stringliteral">&quot;layer&quot;</span> ) ) {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                        <a class="code" href="classlayer__variant.html">layer_variant</a> v;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                        v.<a class="code" href="classlayer__variant.html#addf11bbaec16eaf83ef405b727846743">id</a> = <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.get_string( <span class="stringliteral">&quot;item&quot;</span> );</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                        v.<a class="code" href="classlayer__variant.html#a9a6b1351ba8dd8a2ec9ae19a8b07e297">layer</a> = <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.get_int( <span class="stringliteral">&quot;layer&quot;</span> );</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        v.<a class="code" href="classlayer__variant.html#ac0dc6c2908c8d27c6e5f0dfe20896f97">offset</a> = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.get_int( <span class="stringliteral">&quot;offset_x&quot;</span>, 0 ), <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.get_int( <span class="stringliteral">&quot;offset_y&quot;</span>, 0 ) );</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                        <span class="keywordtype">int</span> total_weight = 0;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> sprites : <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.get_array( <span class="stringliteral">&quot;sprite&quot;</span> ) ) {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                            std::string <span class="keywordtype">id</span> = sprites.get_string( <span class="stringliteral">&quot;id&quot;</span> );</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                            <span class="keywordtype">int</span> weight = sprites.get_int( <span class="stringliteral">&quot;weight&quot;</span>, 1 );</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                            v.<a class="code" href="classlayer__variant.html#aff8c8329be30acb37b80641d8504bc53">sprite</a>.emplace( <span class="keywordtype">id</span>, weight );</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                            total_weight += weight;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                        }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                        v.<a class="code" href="classlayer__variant.html#a8e9700d9aaf66a5720ca6d741e4537d6">total_weight</a> = total_weight;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                        item_variants.push_back( v );</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                        config.<a class="code" href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">throw_error</a>( <span class="stringliteral">&quot;item_variants configured incorrectly&quot;</span> );</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                    }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                <span class="comment">// sort them based on layering so we can draw them correctly</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                std::sort( item_variants.begin(), item_variants.end(), []( <span class="keyword">const</span> <a class="code" href="classlayer__variant.html">layer_variant</a> &amp; <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>,</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <span class="keyword">const</span> <a class="code" href="classlayer__variant.html">layer_variant</a> &amp; <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> ) {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                    return a.layer &lt; b.layer;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                } );</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                ts.item_layer_data.emplace( <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, item_variants );</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="classitem.html">item</a>.has_array( <span class="stringliteral">&quot;field_variants&quot;</span> ) ) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a> : <a class="code" href="classitem.html">item</a>.get_array( <span class="stringliteral">&quot;field_variants&quot;</span> ) ) {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                    <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.has_member( <span class="stringliteral">&quot;field&quot;</span> ) &amp;&amp; <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.has_array( <span class="stringliteral">&quot;sprite&quot;</span> ) ) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                        <a class="code" href="classlayer__variant.html">layer_variant</a> v;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                        v.<a class="code" href="classlayer__variant.html#addf11bbaec16eaf83ef405b727846743">id</a> = <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.get_string( <span class="stringliteral">&quot;field&quot;</span> );</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                        v.<a class="code" href="classlayer__variant.html#ac0dc6c2908c8d27c6e5f0dfe20896f97">offset</a> = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.get_int( <span class="stringliteral">&quot;offset_x&quot;</span>, 0 ), <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.get_int( <span class="stringliteral">&quot;offset_y&quot;</span>, 0 ) );</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                        <span class="keywordtype">int</span> total_weight = 0;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> sprites : <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">vars</a>.get_array( <span class="stringliteral">&quot;sprite&quot;</span> ) ) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                            std::string <span class="keywordtype">id</span> = sprites.get_string( <span class="stringliteral">&quot;id&quot;</span> );</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                            <span class="keywordtype">int</span> weight = sprites.get_int( <span class="stringliteral">&quot;weight&quot;</span>, 1 );</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                            v.<a class="code" href="classlayer__variant.html#aff8c8329be30acb37b80641d8504bc53">sprite</a>.emplace( <span class="keywordtype">id</span>, weight );</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                            total_weight += weight;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        v.<a class="code" href="classlayer__variant.html#a8e9700d9aaf66a5720ca6d741e4537d6">total_weight</a> = total_weight;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                        field_variants.push_back( v );</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                        config.<a class="code" href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">throw_error</a>( <span class="stringliteral">&quot;field_variants configured incorrectly&quot;</span> );</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                    }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                ts.field_layer_data.emplace( <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, field_variants );</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            config.<a class="code" href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">throw_error</a>( <span class="stringliteral">&quot;layering configured incorrectly&quot;</span> );</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;}</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#a0e7fd8bb294514e3ea2a81ee0e6725c7">tileset_cache::loader::process_variations_after_loading</a>(</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="structweighted__int__list.html">weighted_int_list</a>&lt;std::vector&lt;int&gt;&gt; &amp;vs )<span class="keyword"> const</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="comment">// loop through all of the variations</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;v : vs ) {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="comment">// in a given variation, erase any invalid sprite ids</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        v.obj.erase(</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            std::remove_if(</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                v.obj.begin(),</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                v.obj.end(),</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        [&amp;]( <span class="keywordtype">int</span> <span class="keywordtype">id</span> ) {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            return id &gt;= offset || id &lt; 0;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        } ),</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        v.obj.end()</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        );</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    }</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">// erase any variations with no valid sprite ids left</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    vs.erase(</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        std::remove_if(</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            vs.begin(),</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            vs.end(),</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    [&amp;]( <span class="keyword">const</span> <a class="code" href="structweighted__object.html">weighted_object</a>&lt;<span class="keywordtype">int</span>, std::vector&lt;int&gt;&gt; &amp;o ) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        return o.obj.empty();</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        ),</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    vs.end()</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    );</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">// populate the bookkeeping table used for selecting sprite variations</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    vs.precalc();</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;}</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#af4bfffbbefa2dbec0e6a971dc833c451">tileset_cache::loader::add_ascii_subtile</a>( <a class="code" href="structtile__type.html">tile_type</a> &amp;curr_tile, <span class="keyword">const</span> std::string &amp;t_id,</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="keywordtype">int</span> sprite_id, <span class="keyword">const</span> std::string &amp;s_id )</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;{</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keyword">const</span> std::string m_id = t_id + <span class="stringliteral">&quot;_&quot;</span> + s_id;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="structtile__type.html">tile_type</a> curr_subtile;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    curr_subtile.<a class="code" href="structtile__type.html#a35bb6574422477b93e5b447fb16d4cfb">fg</a>.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( std::vector&lt;int&gt;( {sprite_id} ), 1 );</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    curr_subtile.<a class="code" href="structtile__type.html#adeeea68947a7fcd56075c444481722eb">rotates</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    curr_tile.<a class="code" href="structtile__type.html#afdce3fa4361373a841391a76cdb8905f">available_subtiles</a>.push_back( s_id );</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    ts.create_tile_type( m_id, std::move( curr_subtile ) );</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;}</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#a41d360b00c41a19439790bde03ddd30c">tileset_cache::loader::load_ascii</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;config )</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;{</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">if</span>( !config.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;ascii&quot;</span> ) ) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        config.<a class="code" href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">throw_error</a>( <span class="stringliteral">&quot;\&quot;ascii\&quot; section missing&quot;</span> );</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> entry : config.<a class="code" href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">get_array</a>( <span class="stringliteral">&quot;ascii&quot;</span> ) ) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        load_ascii_set( entry );</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;}</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#a1e259f495938801db422d5b51657e0a6">tileset_cache::loader::load_ascii_set</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;entry )</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;{</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="comment">// tile for ASCII char 0 is at `in_image_offset`,</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">// the other ASCII chars follow from there.</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> in_image_offset = entry.<a class="code" href="classJsonObject.html#a532ea812759469d654c7fde4738d11d5">get_int</a>( <span class="stringliteral">&quot;offset&quot;</span> );</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">if</span>( in_image_offset &gt;= <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> ) {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        entry.<a class="code" href="classJsonObject.html#a04b6ce7355b567646a587514fb811c68">throw_error_at</a>( <span class="stringliteral">&quot;offset&quot;</span>, <span class="stringliteral">&quot;invalid offset (out of range)&quot;</span> );</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// color, of the ASCII char. Can be -1 to indicate all/default colors.</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordtype">int</span> FG = -1;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keyword">const</span> std::string scolor = entry.<a class="code" href="classJsonObject.html#a1abb3808bb2a992716d5ef6f27a32b3c">get_string</a>( <span class="stringliteral">&quot;color&quot;</span>, <span class="stringliteral">&quot;DEFAULT&quot;</span> );</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">if</span>( scolor == <span class="stringliteral">&quot;BLACK&quot;</span> ) {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        FG = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aa8987a61b46eae2571fc4ab9bc5d6ed5">catacurses::black</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( scolor == <span class="stringliteral">&quot;RED&quot;</span> ) {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        FG = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2b607ba9b2b7edd76f3d0a07e9dca9fc">catacurses::red</a>;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( scolor == <span class="stringliteral">&quot;GREEN&quot;</span> ) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        FG = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aaf95aa6d65219dcc01457b82df1be8fd">catacurses::green</a>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( scolor == <span class="stringliteral">&quot;YELLOW&quot;</span> ) {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        FG = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">catacurses::yellow</a>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( scolor == <span class="stringliteral">&quot;BLUE&quot;</span> ) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        FG = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a230026b5fc50f9f7efefa7dedfa3544d">catacurses::blue</a>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( scolor == <span class="stringliteral">&quot;MAGENTA&quot;</span> ) {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        FG = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a82a5d57f7c713aa989d0851a4d0290a7">catacurses::magenta</a>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( scolor == <span class="stringliteral">&quot;CYAN&quot;</span> ) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        FG = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2f9b8cb89753ef803e048e78c598c15d">catacurses::cyan</a>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( scolor == <span class="stringliteral">&quot;WHITE&quot;</span> ) {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        FG = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a00c94a3341257be62e4db78730c88356">catacurses::white</a>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( scolor == <span class="stringliteral">&quot;DEFAULT&quot;</span> ) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        FG = -1;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        entry.<a class="code" href="classJsonObject.html#a04b6ce7355b567646a587514fb811c68">throw_error_at</a>( <span class="stringliteral">&quot;color&quot;</span>, <span class="stringliteral">&quot;invalid color for ASCII&quot;</span> );</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="comment">// Add an offset for bold colors (ncurses has this bold attribute,</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">// this mimics it). bold does not apply to default color.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span>( FG != -1 &amp;&amp; entry.<a class="code" href="classJsonObject.html#a3d748a5d67f435bbd170a3e92a7cd0ca">get_bool</a>( <span class="stringliteral">&quot;bold&quot;</span>, <span class="keyword">false</span> ) ) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        FG += 8;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> base_offset = offset + in_image_offset;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">// Finally load all 256 ASCII chars (actually extended ASCII)</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> ascii_char = 0; ascii_char &lt; 256; ascii_char++ ) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> index_in_image = ascii_char + in_image_offset;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="keywordflow">if</span>( index_in_image &lt; 0 || index_in_image &gt;= <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> ) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            <span class="comment">// Out of range is ignored for now.</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keyword">const</span> std::string <span class="keywordtype">id</span> = get_ascii_tile_id( ascii_char, FG, -1 );</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <a class="code" href="structtile__type.html">tile_type</a> curr_tile;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        curr_tile.<a class="code" href="structtile__type.html#ac90d8d872e121c75ff8c1261c7bf0dd2">offset</a> = sprite_offset;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        curr_tile.<a class="code" href="structtile__type.html#a31339fa61963ae8bc47b29ebe2e865c9">offset_retracted</a> = sprite_offset_retracted;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        curr_tile.<a class="code" href="structtile__type.html#ab75d45791aefe26d2f20f992ec64318a">pixelscale</a> = sprite_pixelscale;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <span class="keyword">auto</span> &amp;sprites = *curr_tile.<a class="code" href="structtile__type.html#a35bb6574422477b93e5b447fb16d4cfb">fg</a>.<a class="code" href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">add</a>( std::vector&lt;int&gt;( {index_in_image + offset} ), 1 );</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keywordflow">switch</span>( ascii_char ) {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="comment">// box bottom/top side (horizontal line)</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a2b180123cdd4352de9a2ebcbaabc8627">LINE_OXOX_C</a>:</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                sprites[0] = 205 + base_offset;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            <span class="comment">// box left/right side (vertical line)</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#adecb5eb42e17650557a3b1f7d014cd97">LINE_XOXO_C</a>:</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                sprites[0] = 186 + base_offset;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            <span class="comment">// box top left</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a9366a7c7ae74a665dfa0a7da229c1289">LINE_OXXO_C</a>:</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                sprites[0] = 201 + base_offset;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <span class="comment">// box top right</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a51f593b330977c09884e69642c69b3e1">LINE_OOXX_C</a>:</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                sprites[0] = 187 + base_offset;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <span class="comment">// box bottom right</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#acf8f3e28da5a6881a30c33e64484aef2">LINE_XOOX_C</a>:</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                sprites[0] = 188 + base_offset;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <span class="comment">// box bottom left</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a33b56b57f3e8b7d2fa0beaff9cd0900d">LINE_XXOO_C</a>:</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                sprites[0] = 200 + base_offset;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <span class="comment">// box bottom north T (left, right, up)</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#ac280967a17125ee5ab47b91c7c82904d">LINE_XXOX_C</a>:</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                sprites[0] = 202 + base_offset;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="comment">// box bottom east T (up, right, down)</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#adfed5ce9b05a4a77adff41e37957e203">LINE_XXXO_C</a>:</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                sprites[0] = 208 + base_offset;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <span class="comment">// box bottom south T (left, right, down)</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a7ff40ccfb98b8c772404746dad32c2cb">LINE_OXXX_C</a>:</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                sprites[0] = 203 + base_offset;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="comment">// box X (left down up right)</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a430b2ba81cbe0935f0438d49b02ebb92">LINE_XXXX_C</a>:</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                sprites[0] = 206 + base_offset;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="comment">// box bottom east T (left, down, up)</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#ab476e6f9cbd2eabac88865e08a1fe729">LINE_XOXX_C</a>:</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                sprites[0] = 184 + base_offset;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">if</span>( ascii_char == <a class="code" href="output_8h.html#adecb5eb42e17650557a3b1f7d014cd97">LINE_XOXO_C</a> || ascii_char == <a class="code" href="output_8h.html#a2b180123cdd4352de9a2ebcbaabc8627">LINE_OXOX_C</a> ) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            curr_tile.<a class="code" href="structtile__type.html#adeeea68947a7fcd56075c444481722eb">rotates</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            curr_tile.<a class="code" href="structtile__type.html#a2c4d836f396cc106934adc00f922c5f0">multitile</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            add_ascii_subtile( curr_tile, <span class="keywordtype">id</span>, 206 + base_offset, <span class="stringliteral">&quot;center&quot;</span> );</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            add_ascii_subtile( curr_tile, <span class="keywordtype">id</span>, 201 + base_offset, <span class="stringliteral">&quot;corner&quot;</span> );</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            add_ascii_subtile( curr_tile, <span class="keywordtype">id</span>, 186 + base_offset, <span class="stringliteral">&quot;edge&quot;</span> );</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            add_ascii_subtile( curr_tile, <span class="keywordtype">id</span>, 203 + base_offset, <span class="stringliteral">&quot;t_connection&quot;</span> );</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            add_ascii_subtile( curr_tile, <span class="keywordtype">id</span>, 210 + base_offset, <span class="stringliteral">&quot;end_piece&quot;</span> );</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            add_ascii_subtile( curr_tile, <span class="keywordtype">id</span>, 219 + base_offset, <span class="stringliteral">&quot;unconnected&quot;</span> );</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        ts.create_tile_type( <span class="keywordtype">id</span>, std::move( curr_tile ) );</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;}</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#a5af12dd6e01f8f000126a45991336675">tileset_cache::loader::load_tilejson_from_file</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;config )</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;{</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="keywordflow">if</span>( !config.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;tiles&quot;</span> ) ) {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        config.<a class="code" href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">throw_error</a>( <span class="stringliteral">&quot;\&quot;tiles\&quot; section missing&quot;</span> );</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> entry : config.<a class="code" href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">get_array</a>( <span class="stringliteral">&quot;tiles&quot;</span> ) ) {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        std::vector&lt;std::string&gt; ids;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keywordflow">if</span>( entry.<a class="code" href="classJsonObject.html#ac8dd6467300eb62e7ce842c3d99c083e">has_string</a>( <span class="stringliteral">&quot;id&quot;</span> ) ) {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            ids.push_back( entry.<a class="code" href="classJsonObject.html#a1abb3808bb2a992716d5ef6f27a32b3c">get_string</a>( <span class="stringliteral">&quot;id&quot;</span> ) );</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( entry.<a class="code" href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">has_array</a>( <span class="stringliteral">&quot;id&quot;</span> ) ) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            ids = entry.<a class="code" href="classJsonObject.html#a332ecdfbbcefd21204fad5e03ff43735">get_string_array</a>( <span class="stringliteral">&quot;id&quot;</span> );</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;t_id : ids ) {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            <a class="code" href="structtile__type.html">tile_type</a> &amp;curr_tile = load_tile( entry, t_id );</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            curr_tile.<a class="code" href="structtile__type.html#ac90d8d872e121c75ff8c1261c7bf0dd2">offset</a> = sprite_offset;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            curr_tile.<a class="code" href="structtile__type.html#a31339fa61963ae8bc47b29ebe2e865c9">offset_retracted</a> = sprite_offset_retracted;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            curr_tile.<a class="code" href="structtile__type.html#ab75d45791aefe26d2f20f992ec64318a">pixelscale</a> = sprite_pixelscale;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <span class="keywordtype">bool</span> t_multi = entry.<a class="code" href="classJsonObject.html#a3d748a5d67f435bbd170a3e92a7cd0ca">get_bool</a>( <span class="stringliteral">&quot;multitile&quot;</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="keywordtype">bool</span> t_rota = entry.<a class="code" href="classJsonObject.html#a3d748a5d67f435bbd170a3e92a7cd0ca">get_bool</a>( <span class="stringliteral">&quot;rotates&quot;</span>, t_multi );</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="keywordtype">int</span> t_h3d = entry.<a class="code" href="classJsonObject.html#a532ea812759469d654c7fde4738d11d5">get_int</a>( <span class="stringliteral">&quot;height_3d&quot;</span>, 0 );</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="keywordflow">if</span>( t_multi ) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                <span class="comment">// fetch additional tiles</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> subentry : entry.<a class="code" href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">get_array</a>( <span class="stringliteral">&quot;additional_tiles&quot;</span> ) ) {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                    <span class="keyword">const</span> std::string s_id = subentry.get_string( <span class="stringliteral">&quot;id&quot;</span> );</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                    <span class="keyword">const</span> std::string m_id = <a class="code" href="cata__utility_8h.html#a9739926e3b8f62356233563beb9542b2">str_cat</a>( t_id, <span class="stringliteral">&quot;_&quot;</span>, s_id );</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                    <a class="code" href="structtile__type.html">tile_type</a> &amp;curr_subtile = load_tile( subentry, m_id );</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    curr_subtile.<a class="code" href="structtile__type.html#ac90d8d872e121c75ff8c1261c7bf0dd2">offset</a> = sprite_offset;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                    curr_subtile.<a class="code" href="structtile__type.html#a31339fa61963ae8bc47b29ebe2e865c9">offset_retracted</a> = sprite_offset_retracted;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                    curr_subtile.<a class="code" href="structtile__type.html#ab75d45791aefe26d2f20f992ec64318a">pixelscale</a> = sprite_pixelscale;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                    curr_subtile.<a class="code" href="structtile__type.html#adeeea68947a7fcd56075c444481722eb">rotates</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    curr_subtile.<a class="code" href="structtile__type.html#afda60888f095bae6ba9bbdd657039d2b">height_3d</a> = t_h3d;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                    curr_subtile.<a class="code" href="structtile__type.html#a96b2abd5f9ca94ab686a7e3d08e6adc7">animated</a> = subentry.get_bool( <span class="stringliteral">&quot;animated&quot;</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    curr_tile.<a class="code" href="structtile__type.html#afdce3fa4361373a841391a76cdb8905f">available_subtiles</a>.push_back( s_id );</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( entry.<a class="code" href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">has_array</a>( <span class="stringliteral">&quot;additional_tiles&quot;</span> ) ) {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                    entry.<a class="code" href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">throw_error</a>( <span class="stringliteral">&quot;Additional tiles defined, but &#39;multitile&#39; is not true.&quot;</span> );</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                } <span class="keywordflow">catch</span>( <span class="keyword">const</span> <a class="code" href="classJsonError.html">JsonError</a> &amp;err ) {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                    <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;(json-error)\n%s&quot;</span>, err.what() );</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <span class="comment">// write the information of the base tile to curr_tile</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            curr_tile.<a class="code" href="structtile__type.html#a2c4d836f396cc106934adc00f922c5f0">multitile</a> = t_multi;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            curr_tile.<a class="code" href="structtile__type.html#adeeea68947a7fcd56075c444481722eb">rotates</a> = t_rota;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            curr_tile.<a class="code" href="structtile__type.html#afda60888f095bae6ba9bbdd657039d2b">height_3d</a> = t_h3d;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            curr_tile.<a class="code" href="structtile__type.html#a96b2abd5f9ca94ab686a7e3d08e6adc7">animated</a> = entry.<a class="code" href="classJsonObject.html#a3d748a5d67f435bbd170a3e92a7cd0ca">get_bool</a>( <span class="stringliteral">&quot;animated&quot;</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        }</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a> ) &lt;&lt; <span class="stringliteral">&quot;Tile Width: &quot;</span> &lt;&lt; ts.tile_width &lt;&lt; <span class="stringliteral">&quot; Tile Height: &quot;</span> &lt;&lt; ts.tile_height &lt;&lt;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                  <span class="stringliteral">&quot; Tile Definitions: &quot;</span> &lt;&lt; ts.tile_ids.size();</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;}</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment"> * Load a tile definition and add it to the @ref tileset::tile_ids map.</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment"> * All loaded tiles go into one vector (@ref tileset::tile_values), their index in it is their id.</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment"> * The JSON data (loaded here) contains tile ids relative to the associated image.</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment"> * They are translated into global ids by adding the @p offset, which is the number of</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment"> * previously loaded tiles (excluding the tiles from the associated image).</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment"> * @param id The id of the new tile definition (which is the key in @ref tileset::tile_ids).</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment"> * Any existing definition of the same id is overridden.</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment"> * @return A reference to the loaded tile inside the @ref tileset::tile_ids map.</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<a class="code" href="structtile__type.html">tile_type</a> &amp;<a class="code" href="classtileset__cache_1_1loader.html#af64be0a34a00ac075a9aa243cd6c686c">tileset_cache::loader::load_tile</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;entry, <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span> )</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;{</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">if</span>( ts.find_tile_type( <span class="keywordtype">id</span> ) ) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        ts.duplicate_ids.insert( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="structtile__type.html">tile_type</a> curr_subtile;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    load_tile_spritelists( entry, curr_subtile.<a class="code" href="structtile__type.html#a35bb6574422477b93e5b447fb16d4cfb">fg</a>, <span class="stringliteral">&quot;fg&quot;</span> );</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    load_tile_spritelists( entry, curr_subtile.<a class="code" href="structtile__type.html#a0cbe74ee58be622d2e5399a791ae3efe">bg</a>, <span class="stringliteral">&quot;bg&quot;</span> );</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">return</span> ts.create_tile_type( <span class="keywordtype">id</span>, std::move( curr_subtile ) );</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;}</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#a04bf459d4b0f1f94f0a631b03a51a3d4">tileset_cache::loader::load_tile_spritelists</a>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> &amp;entry,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <a class="code" href="structweighted__int__list.html">weighted_int_list</a>&lt;std::vector&lt;int&gt;&gt; &amp;vs,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <span class="keyword">const</span> std::string_view objname )<span class="keyword"> const</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">// json array indicates rotations or variations</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">if</span>( entry.<a class="code" href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">has_array</a>( objname ) ) {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <a class="code" href="classJsonArray.html">JsonArray</a> g_array = entry.<a class="code" href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">get_array</a>( objname );</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        <span class="comment">// int elements of array indicates rotations</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <span class="comment">// create one variation, populate sprite_ids with list of ints</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">if</span>( g_array.<a class="code" href="classJsonArray.html#a7fce434cf8811c1de09a6fffcd3fc56c">test_int</a>() ) {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            std::vector&lt;int&gt; v;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keywordtype">int</span> entry : g_array ) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> sprite_id = entry + sprite_id_offset;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                <span class="keywordflow">if</span>( sprite_id &gt;= 0 ) {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    v.push_back( sprite_id );</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            vs.add( v, 1 );</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        }</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <span class="comment">// object elements of array indicates variations</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="comment">// create one variation per object</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( g_array.test_object() ) {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonObject.html">JsonObject</a> vo : g_array ) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                std::vector&lt;int&gt; v;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                <span class="keywordtype">int</span> weight = vo.<a class="code" href="classJsonObject.html#a532ea812759469d654c7fde4738d11d5">get_int</a>( <span class="stringliteral">&quot;weight&quot;</span> );</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                <span class="comment">// negative weight is invalid</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                <span class="keywordflow">if</span>( weight &lt; 0 ) {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                    vo.throw_error_at( objname, <span class="stringliteral">&quot;Invalid weight for sprite variation (&lt;0)&quot;</span> );</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                <span class="comment">// int sprite means one sprite</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                <span class="keywordflow">if</span>( vo.has_int( <span class="stringliteral">&quot;sprite&quot;</span> ) ) {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> sprite_id = vo.get_int( <span class="stringliteral">&quot;sprite&quot;</span> ) + sprite_id_offset;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                    <span class="keywordflow">if</span>( sprite_id &gt;= 0 ) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                        v.push_back( sprite_id );</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                    }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                <span class="comment">// array sprite means rotations</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( vo.has_array( <span class="stringliteral">&quot;sprite&quot;</span> ) ) {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keywordtype">int</span> entry : vo.get_array( <span class="stringliteral">&quot;sprite&quot;</span> ) ) {</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">int</span> sprite_id = entry + sprite_id_offset;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                        <span class="keywordflow">if</span>( sprite_id &gt;= 0 ) {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                            v.push_back( sprite_id );</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                        }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                    }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                <span class="keywordflow">if</span>( v.size() != 1 &amp;&amp;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                    v.size() != 2 &amp;&amp;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                    v.size() != 4 ) {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                    vo.<a class="code" href="classJsonObject.html#a04b6ce7355b567646a587514fb811c68">throw_error_at</a>( objname, <span class="stringliteral">&quot;Invalid number of sprites (not 1, 2, or 4)&quot;</span> );</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                vs.add( v, weight );</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">// json int indicates a single sprite id</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( entry.<a class="code" href="classJsonObject.html#a271bf0c222d2a7c97329df4362ae6a54">has_int</a>( objname ) &amp;&amp; entry.<a class="code" href="classJsonObject.html#a532ea812759469d654c7fde4738d11d5">get_int</a>( objname ) &gt;= 0 ) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        vs.add( std::vector&lt;int&gt;( {entry.<a class="code" href="classJsonObject.html#a532ea812759469d654c7fde4738d11d5">get_int</a>( objname ) + sprite_id_offset} ), 1 );</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;}</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="keyword">static</span> std::map&lt;tripoint, int&gt; display_npc_attack_potential()</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;{</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <a class="code" href="classavatar.html">avatar</a> &amp;you = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <a class="code" href="classnpc.html">npc</a> avatar_as_npc;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <a class="code" href="classJsonOut.html">JsonOut</a> jsout( os );</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    jsout.write( you );</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="classJsonValue.html">JsonValue</a> jsin = <a class="code" href="classjson__loader.html#af3fbaf50a63b204dfe479e89e5d0dc9d">json_loader::from_string</a>( os.str() );</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    jsin.<a class="code" href="classJsonValue.html#a1262851fe4201cfd471f481212da3de7">read</a>( avatar_as_npc );</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    avatar_as_npc.<a class="code" href="classnpc.html#a01b95be72400ef6e5b659c34f634bcfd">regen_ai_cache</a>();</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    avatar_as_npc.<a class="code" href="classnpc.html#afb6788e7afa0689bb84fe0216c6b4663">evaluate_best_attack</a>( <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    std::map&lt;tripoint, int&gt; effectiveness_map;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    std::vector&lt;npc_attack_rating&gt; effectiveness =</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        avatar_as_npc.<a class="code" href="classnpc.html#ad27a4f70dc3b2d753bd3c8e0fe115135">get_current_attack</a>()-&gt;all_evaluations( avatar_as_npc, <span class="keyword">nullptr</span> );</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classnpc__attack__rating.html">npc_attack_rating</a> &amp;effectiveness_at_point : effectiveness ) {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keywordflow">if</span>( !effectiveness_at_point.value() ) {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        effectiveness_map[effectiveness_at_point.target()] = *effectiveness_at_point.value();</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">return</span> effectiveness_map;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;}</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#ab2fbcdf5ff33028beb88d0d148007d4a">cata_tiles::draw</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;dest, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                       std::multimap&lt;point, formatted_text&gt; &amp;overlay_strings,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                       <a class="code" href="cata__tiles_8h.html#a3d60e29ab63adaf6aef66d61fce44f23">color_block_overlay_container</a> &amp;color_blocks )</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;{</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a> ) {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="preprocessor">#if defined(__ANDROID__)</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="comment">// Attempted bugfix for Google Play crash - prevent divide-by-zero if no tile</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="comment">// width/height specified</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">if</span>( tile_width == 0 || <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> == 0 ) {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    }</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="comment">//set clipping to prevent drawing over stuff we shouldn&#39;t</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        SDL_Rect clipRect = {dest.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>, dest.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>, width, height};</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <a class="code" href="sdl__wrappers_8h.html#a7eb7cd1483cf633af1ca578070fd654e">printErrorIf</a>( SDL_RenderSetClipRect( renderer.get(), &amp;clipRect ) != 0,</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                      <span class="stringliteral">&quot;SDL_RenderSetClipRect failed&quot;</span> );</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="comment">//fill render area with black to prevent artifacts where no new pixels are drawn</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        geometry-&gt;rect( renderer, clipRect, SDL_Color() );</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> s = get_window_base_tile_counts( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( width, height ) );</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160; </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    init_light();</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keyword">const</span> <a class="code" href="structvisibility__variables.html">visibility_variables</a> &amp;cache = here.<a class="code" href="classmap.html#abb8095f0f1825688edee2d0edc5fd06d">get_visibility_variables_cache</a>();</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    o = is_isometric() ? <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.xy() : <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.xy() - <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( <a class="code" href="output_8cpp.html#a852bcaf15ef9b08c80dfa899078baa3d">POSX</a>, <a class="code" href="output_8cpp.html#ab911c8aec787739bcd40d1d3d620ad44">POSY</a> );</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    op = dest;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    screentile_width = s.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    screentile_height = s.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">// Limit draw depth to vertical vision setting</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> max_draw_depth = <a class="code" href="cached__options_8cpp.html#a0cb65464a3fa34c1ed5474f5d2d853a7">fov_3d_z_range</a>;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_ranges = is_isometric() ? 1 + <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0, max_draw_depth ) : 1;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    std::vector&lt;half_open_rectangle&lt;point&gt;&gt; z_any_tile_range( num_ranges );</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> z = 0; z &lt; num_ranges; ++z ) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        z_any_tile_range[z] = get_window_any_tile_range( { width, height }, -z );</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keyword">const</span> <a class="code" href="structhalf__open__rectangle.html">half_open_rectangle&lt;point&gt;</a> &amp;top_any_tile_range = z_any_tile_range[0];</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keyword">const</span> <a class="code" href="structhalf__open__rectangle.html">half_open_rectangle&lt;point&gt;</a> &amp;bottom_any_tile_range = z_any_tile_range[num_ranges - 1];</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#af7cec817aa5f9f48c6bb5b7615aff264">p_min</a>.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> == bottom_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#af7cec817aa5f9f48c6bb5b7615aff264">p_min</a>.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> );</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#a0d6dd0f5d65dd4f9b61d74d9baf6b499">p_max</a>.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> == bottom_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#a0d6dd0f5d65dd4f9b61d74d9baf6b499">p_max</a>.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> );</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#af7cec817aa5f9f48c6bb5b7615aff264">p_min</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> &gt;= bottom_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#af7cec817aa5f9f48c6bb5b7615aff264">p_min</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> );</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#a0d6dd0f5d65dd4f9b61d74d9baf6b499">p_max</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> &gt;= bottom_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#a0d6dd0f5d65dd4f9b61d74d9baf6b499">p_max</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> );</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> min_col = top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#af7cec817aa5f9f48c6bb5b7615aff264">p_min</a>.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> max_col = top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#a0d6dd0f5d65dd4f9b61d74d9baf6b499">p_max</a>.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> min_row = bottom_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#af7cec817aa5f9f48c6bb5b7615aff264">p_min</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> max_row = top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#a0d6dd0f5d65dd4f9b61d74d9baf6b499">p_max</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <a class="code" href="classavatar.html">avatar</a> &amp;you = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>();</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="comment">//limit the render area to maximum view range (121x121 square centered on player)</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> min_visible( you.<a class="code" href="classCreature.html#aecea7d852ffba499ec12350c95340b9d">posx</a>() % <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a>, you.<a class="code" href="classCreature.html#a9f0365208b65ab1c45d23f03f402f491">posy</a>() % <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> );</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> max_visible( ( you.<a class="code" href="classCreature.html#aecea7d852ffba499ec12350c95340b9d">posx</a>() % <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a> ) + ( <a class="code" href="game__constants_8h.html#ad277b12d7860c613865a85a2cc383c17">MAPSIZE</a> - 1 ) * <a class="code" href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a>,</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                             ( you.<a class="code" href="classCreature.html#a9f0365208b65ab1c45d23f03f402f491">posy</a>() % <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> ) + ( <a class="code" href="game__constants_8h.html#ad277b12d7860c613865a85a2cc383c17">MAPSIZE</a> - 1 ) * <a class="code" href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a> );</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> draw_min_z = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( you.<a class="code" href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">posz</a>() - max_draw_depth, -<a class="code" href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a> );</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keyword">const</span> <a class="code" href="structlevel__cache.html">level_cache</a> &amp;ch = here.<a class="code" href="classmap.html#a41fa0e03c8ccfc8fb013a6ab5459d06e">access_cache</a>( <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z );</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="comment">// Map memory should be at least the size of the view range</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">// so that new tiles can be memorized, and at least the size of the display</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="comment">// since at farthest zoom displayed area may be bigger than view range.</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <a class="code" href="structpoint.html">point</a> min_mm_reg = min_visible;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <a class="code" href="structpoint.html">point</a> max_mm_reg = max_visible;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        std::optional&lt;point&gt; northmost = tile_to_player( { min_col, min_row } );</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <span class="keywordflow">if</span>( !northmost.has_value() ) {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            northmost = tile_to_player( { min_col + 1, min_row } );</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        std::optional&lt;point&gt; southmost = tile_to_player( { max_col, max_row } );</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">if</span>( !southmost.has_value() ) {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            southmost = tile_to_player( { max_col - 1, max_row } );</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        }</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        std::optional&lt;point&gt; westmost = tile_to_player( { min_col, max_row } );</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="keywordflow">if</span>( !westmost.has_value() ) {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            westmost = tile_to_player( { min_col + 1, max_row } );</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        }</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        std::optional&lt;point&gt; eastmost = tile_to_player( { max_col, min_row } );</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <span class="keywordflow">if</span>( !eastmost.has_value() ) {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            eastmost = tile_to_player( { max_col - 1, min_row } );</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        }</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="keywordflow">if</span>( northmost.has_value() &amp;&amp; southmost.has_value()</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            &amp;&amp; westmost.has_value() &amp;&amp; eastmost.has_value() ) {</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            min_mm_reg = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( min_mm_reg.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>, westmost-&gt;x ),</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                                <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( min_mm_reg.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>, northmost-&gt;y ) );</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            max_mm_reg = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( max_mm_reg.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>, eastmost-&gt;x ),</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( max_mm_reg.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>, southmost-&gt;y ) );</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        }</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        std::optional&lt;point&gt; northwest = tile_to_player( { min_col, min_row } );</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        std::optional&lt;point&gt; southeast = tile_to_player( { max_col, max_row } );</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <span class="keywordflow">if</span>( northwest.has_value() &amp;&amp; southeast.has_value() ) {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            min_mm_reg = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( min_mm_reg.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>, northwest-&gt;x ),</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                                <a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( max_mm_reg.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>, northwest-&gt;y ) );</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            max_mm_reg = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( max_mm_reg.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>, southeast-&gt;x ),</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( max_mm_reg.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>, southeast-&gt;y ) );</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="comment">//invalidate draw_points_cache if viewport dimensions have changed</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <a class="code" href="structpoint.html">point</a> top_left( min_col, min_row );</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <a class="code" href="structpoint.html">point</a> bottom_right( max_col, max_row );</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">if</span>( top_left != here.prev_top_left || bottom_right != here.prev_bottom_right || o != here.prev_o ) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        set_draw_cache_dirty();</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    here.prev_top_left = top_left;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    here.prev_bottom_right = bottom_right;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    here.prev_o = o;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    you.<a class="code" href="classavatar.html#af690d039ef033cc62fe6c43a9519bb1d">prepare_map_memory_region</a>(</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( <a class="code" href="structtripoint.html">tripoint</a>( min_mm_reg, <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z ) ),</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( <a class="code" href="structtripoint.html">tripoint</a>( max_mm_reg, <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z ) )</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    );</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="comment">//set up a default tile for the edges outside the render area</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92e">visibility_type</a> offscreen_type = <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92ea347e628a8f72626a0611ef842fe9d304">visibility_type::HIDDEN</a>;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">if</span>( cache.<a class="code" href="structvisibility__variables.html#a1c7e65e8b8105ef486b2b9874b674d97">u_is_boomered</a> ) {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        offscreen_type = <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92eaed63a54298847d9f23d13f422561be4d">visibility_type::BOOMER_DARK</a>;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    }</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">//retrieve night vision goggle status once per draw</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keyword">auto</span> vision_cache = you.<a class="code" href="classCharacter.html#a5ac4e7940167393e27395b53b49db4bf">get_vision_modes</a>();</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    nv_goggles_activated = vision_cache[<a class="code" href="character_8h.html#ad87be595004034c31843cf782d41c0b5acd90043f9adf49fd333cd2109af3f2f5">NV_GOGGLES</a>];</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">// check that the creature for which we&#39;ll draw the visibility map is still alive at that point</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667acf112c2ce5f44400e21524b61bb5b107">ACTION_DISPLAY_VISIBILITY</a> ) &amp;&amp;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;displaying_visibility_creature ) {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> *<a class="code" href="descriptions_8cpp.html#aeed2fa049c80ba4e2960866b4e00d5d8a8a52e7a8d3b4c955d6f7927c6ba3fe72">creature</a> = <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;displaying_visibility_creature;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> is_same_creature_predicate = [&amp;<a class="code" href="descriptions_8cpp.html#aeed2fa049c80ba4e2960866b4e00d5d8a8a52e7a8d3b4c955d6f7927c6ba3fe72">creature</a>]( <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp; <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> ) {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="descriptions_8cpp.html#aeed2fa049c80ba4e2960866b4e00d5d8a8a52e7a8d3b4c955d6f7927c6ba3fe72">creature</a> == &amp;<a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        };</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;get_creature_if( is_same_creature_predicate ) == nullptr )  {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;displaying_visibility_creature = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> half_tile( tile_width / 2, 0 );</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> quarter_tile( tile_width / 4, <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> / 4 );</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> apply_visible = [&amp;]( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp; np, <span class="keyword">const</span> <a class="code" href="structlevel__cache.html">level_cache</a> &amp; ch, <a class="code" href="classmap.html">map</a> &amp; here ) {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <span class="keywordflow">return</span> np.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> &lt; min_visible.y || np.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a> &gt; max_visible.y ||</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;               np.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> &lt; min_visible.x || np.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a> &gt; max_visible.x ||</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;               would_apply_vision_effects( here.<a class="code" href="classmap.html#a9ca9495068efebbdf83d185e0845cc54">get_visibility</a>( ch.visibility_cache[np.<a class="code" href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">x</a>][np.<a class="code" href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">y</a>],</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                           cache ) );</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    };</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    std::map&lt;tripoint, int&gt; npc_attack_rating_map;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordtype">int</span> max_npc_effectiveness = 0;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667a060d88d218f38689afe8ec201fd1d5c9">ACTION_DISPLAY_NPC_ATTACK_POTENTIAL</a> ) ) {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        npc_attack_rating_map = display_npc_attack_potential();</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const tripoint, int&gt; &amp;pair : npc_attack_rating_map ) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            max_npc_effectiveness = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( pair.second, max_npc_effectiveness );</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        }</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    }</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="keywordflow">if</span>( here.draw_points_cache_dirty ) {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        here.draw_points_cache_dirty = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="comment">// overlay_strings and color_blocks are generated with draw_points and thus are cleared together</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        here.draw_points_cache.clear();</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        here.overlay_strings_cache.clear();</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        here.color_blocks_cache = {};</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667a69c5164b6e8c42c70b9f85f632136c04">ACTION_DISPLAY_VEHICLE_AI</a> ) ) {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structwrapped__vehicle.html">wrapped_vehicle</a> &amp;elem : here.<a class="code" href="classmap.html#ac1c02ce0648fe07137b86c84fc72f5de">get_vehicles</a>() ) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                <span class="keyword">const</span> <a class="code" href="classvehicle.html">vehicle</a> &amp;veh = *elem.v;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> veh_pos = veh.<a class="code" href="classvehicle.html#a3900ee345be0453828a955a200154db1">global_pos3</a>().<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>();</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;overlay_data : veh.<a class="code" href="classvehicle.html#af60dc22f3846d5dabbf7877f44ebf6f5">get_debug_overlay_data</a>() ) {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> pt = veh_pos + std::get&lt;0&gt;( overlay_data );</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = std::get&lt;1&gt;( overlay_data );</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                    <span class="keyword">const</span> std::string &amp;text = std::get&lt;2&gt;( overlay_data );</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                    overlay_strings.emplace( player_to_screen( pt ),</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                                             <a class="code" href="structformatted__text.html">formatted_text</a>( text, <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a>,</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                                                     <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8ea811882fecd5c7618d7099ebbd39ea254">text_alignment::left</a> ) );</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="comment">// Generate new draw points</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> row = min_row; row &lt; max_row; row ++ ) {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            <span class="comment">// Reserve columns on each row</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> zlevel = <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z; zlevel &gt;= draw_min_z; zlevel -- ) {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                here.draw_points_cache[zlevel][row].reserve( <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0, max_col - min_col ) );</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> col = min_col; col &lt; max_col; col ++ ) {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                <span class="keyword">const</span> std::optional&lt;point&gt; <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a> = tile_to_player( { col, row } );</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                <span class="keywordflow">if</span>( !<a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>.has_value() ) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                <span class="keywordflow">for</span>( <span class="keywordtype">int</span> zlevel = <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z; zlevel &gt;= draw_min_z; zlevel -- ) {</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                    <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>( <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>.value(), zlevel );</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> pos_global = here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;x = <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.x;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;y = <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.y;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_center_z = zlevel == <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                    <span class="keyword">const</span> <a class="code" href="structlevel__cache.html">level_cache</a> &amp;ch2 = here.<a class="code" href="classmap.html#a41fa0e03c8ccfc8fb013a6ab5459d06e">access_cache</a>( zlevel );</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                    <span class="comment">// light level is used for choosing between grayscale filter and normal lit tiles.</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                    <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                    <span class="comment">// invisible to normal eyes</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                    std::array&lt;bool, 5&gt; invisible;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                    invisible[0] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                    <span class="keywordflow">if</span>( y &lt; min_visible.y || y &gt; max_visible.y || x &lt; min_visible.x || x &gt; max_visible.x ) {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                        <span class="keywordflow">if</span>( has_memory_at( pos_global ) ) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                            ll = <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c">lit_level::MEMORIZED</a>;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                            invisible[0] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( has_draw_override( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) ) {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                            ll = <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aacaef50d33fc86532c260a045c672f3e">lit_level::DARK</a>;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                            invisible[0] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                            <span class="keywordflow">if</span>( would_apply_vision_effects( offscreen_type ) ) {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                                here.draw_points_cache[zlevel][row].emplace_back( <a class="code" href="structtile__render__info_1_1common.html">tile_render_info::common</a>{ <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0 },</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                                        <a class="code" href="structtile__render__info_1_1vision__effect.html">tile_render_info::vision_effect</a>{ offscreen_type } );</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                            }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                        }</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                        ll = ch2.<a class="code" href="structlevel__cache.html#a3a9ecaf0d5c4181ac518af293bfb6050">visibility_cache</a>[x][y];</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                    }</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                    <span class="keywordflow">if</span>( is_center_z ) {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                        <span class="comment">// Add scent value to the overlay_strings list for every visible tile when</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                        <span class="comment">// displaying scent</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667ac6a2622e05b532456fa5a12949d5ba7a">ACTION_DISPLAY_SCENT</a> ) &amp;&amp; !invisible[0] ) {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">int</span> scent_value = <a class="code" href="game_8cpp.html#afee362892b161716a3fc614b030a877d">get_scent</a>().<a class="code" href="classscent__map.html#a99aff3e6d8963d7f34618216a8448c8c">get</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                            <span class="keywordflow">if</span>( scent_value &gt; 0 ) {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                                here.overlay_strings_cache.emplace( player_to_screen( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( x, y ) ) + half_tile,</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                                                                    <a class="code" href="structformatted__text.html">formatted_text</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( scent_value ),</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                                                                            8 + <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">catacurses::yellow</a>, <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403">direction::NORTH</a> ) );</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                            }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                        }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                        <span class="comment">// Add scent type to the overlay_strings list for every visible tile when</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                        <span class="comment">// displaying scent</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667a8d4ed6671b471662169fdf1696f2e540">ACTION_DISPLAY_SCENT_TYPE</a> ) &amp;&amp; !invisible[0] ) {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classstring__id.html">scenttype_id</a> <a class="code" href="classscent__type.html">scent_type</a> = <a class="code" href="game_8cpp.html#afee362892b161716a3fc614b030a877d">get_scent</a>().<a class="code" href="classscent__map.html#a781c9a7c953f40d3027c3e3a36446ff3">get_type</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                            <span class="keywordflow">if</span>( !<a class="code" href="classscent__type.html">scent_type</a>.is_empty() ) {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                                here.overlay_strings_cache.emplace( player_to_screen( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( x, y ) ) + half_tile,</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                                                                    <a class="code" href="structformatted__text.html">formatted_text</a>( <a class="code" href="classscent__type.html">scent_type</a>.c_str(),</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                                                            8 + <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">catacurses::yellow</a>, <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403">direction::NORTH</a> ) );</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                            }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                        }</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667a7524d315bc01ce6a42a768df387a53db">ACTION_DISPLAY_RADIATION</a> ) ) {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                            <span class="keyword">const</span> <span class="keyword">auto</span> rad_override = radiation_override.find( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">bool</span> rad_overridden = rad_override != radiation_override.end();</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                            <span class="keywordflow">if</span>( rad_overridden || !invisible[0] ) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">int</span> rad_value = rad_overridden ? rad_override-&gt;second :</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                                      here.<a class="code" href="classmap.html#a49871648d1ab92a02a1a6f12797390a7">get_radiation</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8">catacurses::base_color</a> col;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                <span class="keywordflow">if</span>( rad_value &gt; 0 ) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                                    col = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aaf95aa6d65219dcc01457b82df1be8fd">catacurses::green</a>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                                    col = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2f9b8cb89753ef803e048e78c598c15d">catacurses::cyan</a>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                                }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                                here.overlay_strings_cache.emplace( player_to_screen( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( x, y ) ) + half_tile,</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                                                                    <a class="code" href="structformatted__text.html">formatted_text</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( rad_value ),</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                                                                            8 + col, <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403">direction::NORTH</a> ) );</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                            }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                        }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667a060d88d218f38689afe8ec201fd1d5c9">ACTION_DISPLAY_NPC_ATTACK_POTENTIAL</a> ) ) {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                            <span class="keywordflow">if</span>( npc_attack_rating_map.count( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) ) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">int</span> val = npc_attack_rating_map.at( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                                <span class="keywordtype">short</span> <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a>;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                                <span class="keywordflow">if</span>( val &lt;= 0 ) {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                                    <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2b607ba9b2b7edd76f3d0a07e9dca9fc">catacurses::red</a>;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( val == max_npc_effectiveness ) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                                    <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2f9b8cb89753ef803e048e78c598c15d">catacurses::cyan</a>;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                                    <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a00c94a3341257be62e4db78730c88356">catacurses::white</a>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                                }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                                here.overlay_strings_cache.emplace( player_to_screen( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( x, y ) ) + half_tile,</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                                                    <a class="code" href="structformatted__text.html">formatted_text</a>( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( val ), <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a>,</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                                                            <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403">direction::NORTH</a> ) );</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                            }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                        }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                        <span class="comment">// Add temperature value to the overlay_strings list for every visible tile when</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                        <span class="comment">// displaying temperature</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667a85ad66ac510611e454e87bd3e4b86bb2">ACTION_DISPLAY_TEMPERATURE</a> ) &amp;&amp; !invisible[0] ) {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classunits_1_1quantity.html">units::temperature</a> temp_value = <a class="code" href="game_8cpp.html#a20e1e24b746d8844d2e554086ba3b3bb">get_weather</a>().<a class="code" href="group__Weather.html#ga92e3dd986a664a399dffe62d2ebe2139">get_temperature</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">float</span> celsius_temp_value = <a class="code" href="namespaceunits.html#a9a5827312b56a57d423cb19197bcc358">units::to_celsius</a>( temp_value );</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                            <span class="keywordtype">short</span> <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a>;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">short</span> bold = 8;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                            <span class="keywordflow">if</span>( celsius_temp_value &gt; 40 ) {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                                <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2b607ba9b2b7edd76f3d0a07e9dca9fc">catacurses::red</a>;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( celsius_temp_value &gt; 25 ) {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                                <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">catacurses::yellow</a> + bold;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( celsius_temp_value &gt; 10 ) {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                                <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aaf95aa6d65219dcc01457b82df1be8fd">catacurses::green</a> + bold;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( celsius_temp_value &gt; 0 ) {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                                <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a00c94a3341257be62e4db78730c88356">catacurses::white</a> + bold;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( celsius_temp_value &gt; -10 ) {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                                <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2f9b8cb89753ef803e048e78c598c15d">catacurses::cyan</a> + bold;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                                <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a230026b5fc50f9f7efefa7dedfa3544d">catacurses::blue</a> + bold;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                            }</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                            std::string temp_str;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                            <span class="keywordflow">if</span>( get_option&lt;std::string&gt;( <span class="stringliteral">&quot;USE_CELSIUS&quot;</span> ) == <span class="stringliteral">&quot;celsius&quot;</span> ) {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                                temp_str = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%.0f&quot;</span>, celsius_temp_value );</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( get_option&lt;std::string&gt;( <span class="stringliteral">&quot;USE_CELSIUS&quot;</span> ) == <span class="stringliteral">&quot;kelvin&quot;</span> ) {</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                                temp_str = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%.0f&quot;</span>, <a class="code" href="namespaceunits.html#a7ad0e3aed5fcfc224568a0520be0efa5">units::to_kelvin</a>( temp_value ) );</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                                temp_str = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%.0f&quot;</span>, <a class="code" href="namespaceunits.html#ae31e6d9c71949a72ee41be4be6f1afcd">units::to_fahrenheit</a>( temp_value ) );</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                            }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                            here.overlay_strings_cache.emplace( player_to_screen( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( x, y ) ),</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                                                                <a class="code" href="structformatted__text.html">formatted_text</a>( temp_str, <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a>,</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                                                                        <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8ea811882fecd5c7618d7099ebbd39ea254">text_alignment::left</a> ) );</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                        }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667acf112c2ce5f44400e21524b61bb5b107">ACTION_DISPLAY_VISIBILITY</a> ) &amp;&amp;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                            <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;displaying_visibility_creature &amp;&amp; !invisible[0] ) {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">bool</span> visibility = <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;displaying_visibility_creature-&gt;sees( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                            <span class="comment">// color overlay.</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                            SDL_Color block_color = visibility ? windowsPalette[<a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aaf95aa6d65219dcc01457b82df1be8fd">catacurses::green</a>] :</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                                                    SDL_Color{ 192, 192, 192, 255 };</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                            block_color.a = 100;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                            here.color_blocks_cache.first = SDL_BLENDMODE_BLEND;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                            here.color_blocks_cache.second.emplace( player_to_screen( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( x, y ) ), block_color );</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                            <span class="comment">// overlay string</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                            std::string visibility_str = visibility ? <span class="stringliteral">&quot;+&quot;</span> : <span class="stringliteral">&quot;-&quot;</span>;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                            here.overlay_strings_cache.emplace( player_to_screen( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( x, y ) ) + quarter_tile,</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                                                                <a class="code" href="structformatted__text.html">formatted_text</a>( visibility_str, <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aa8987a61b46eae2571fc4ab9bc5d6ed5">catacurses::black</a>,</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                                                                        <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403">direction::NORTH</a> ) );</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                        }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                        <span class="keyword">static</span> std::vector&lt;SDL_Color&gt; lighting_colors;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                        <span class="comment">// color hue in the range of [0..10], 0 being white,  10 being blue</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                        <span class="keyword">auto</span> draw_debug_tile = [&amp;]( <span class="keyword">const</span> <span class="keywordtype">int</span> color_hue, <span class="keyword">const</span> std::string &amp; text ) {</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                            <span class="keywordflow">if</span>( lighting_colors.empty() ) {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                                SDL_Color <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a00c94a3341257be62e4db78730c88356">white</a> = { 255, 255, 255, 255 };</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                SDL_Color <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a230026b5fc50f9f7efefa7dedfa3544d">blue</a> = { 0, 0, 255, 255 };</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                                lighting_colors = <a class="code" href="sdl__utils_8h.html#a0343ef9415f1d15c92f4d324e0e1802d">color_linear_interpolate</a>( <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a00c94a3341257be62e4db78730c88356">white</a>, <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a230026b5fc50f9f7efefa7dedfa3544d">blue</a>, 9 );</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                            }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                            <a class="code" href="structpoint.html">point</a> tile_pos = player_to_screen( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( x, y ) );</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                            <span class="comment">// color overlay</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                            SDL_Color <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> = lighting_colors[<a class="code" href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">std::min</a>( <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 0, color_hue ), 10 )];</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                            <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a>.a = 100;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                            here.color_blocks_cache.first = SDL_BLENDMODE_BLEND;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                            here.color_blocks_cache.second.emplace( tile_pos, <a class="code" href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a> );</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                            <span class="comment">// string overlay</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                            here.overlay_strings_cache.emplace(</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                                tile_pos + quarter_tile,</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                <a class="code" href="structformatted__text.html">formatted_text</a>( text, <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aa8987a61b46eae2571fc4ab9bc5d6ed5">catacurses::black</a>, <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403">direction::NORTH</a> ) );</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                        };</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667aa4046b7475c2b0cefdba44eb4995e4ea">ACTION_DISPLAY_LIGHTING</a> ) ) {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                            <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;displaying_lighting_condition == 0 ) {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="weather__type_8h.html#a0b78777ab367c0db919aacd8bba938f0a2ac43aa43bf473f9a9c09b4b608619d3">light</a> = here.<a class="code" href="classmap.html#a47284179cd831f04aaa7ff3242a5fb7b">ambient_light_at</a>( {x, y, <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z} );</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                                <span class="comment">// note: lighting will be constrained in the [1.0, 11.0] range.</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                                <span class="keywordtype">int</span> <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> =</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                                    <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( 1.0, <a class="code" href="lightmap_8h.html#aee8c4bc593d2863e405cd21438a01f44">LIGHT_AMBIENT_LIT</a> - <a class="code" href="weather__type_8h.html#a0b78777ab367c0db919aacd8bba938f0a2ac43aa43bf473f9a9c09b4b608619d3">light</a> + 1.0 ) ) - 1;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                                draw_debug_tile( <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a>, <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%.1f&quot;</span>, <a class="code" href="weather__type_8h.html#a0b78777ab367c0db919aacd8bba938f0a2ac43aa43bf473f9a9c09b4b608619d3">light</a> ) );</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                            }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                        }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                        <span class="keywordflow">if</span>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;display_overlay_state( <a class="code" href="action_8h.html#a14769f0512c139a614db195c6477c667a741ce48850825cffe3d78beaabb8651a">ACTION_DISPLAY_TRANSPARENCY</a> ) ) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">float</span> tr = here.<a class="code" href="classmap.html#a5741cc08c79673119a9ec251a6253644">light_transparency</a>( {x, y, <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z} );</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                            <span class="keywordtype">int</span> <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> =  tr &lt;= LIGHT_TRANSPARENCY_SOLID ? 10 :  static_cast&lt;int&gt;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                                             ( ( tr - <a class="code" href="lightmap_8h.html#ab007d848fe0f7de9118042fff85fef07">LIGHT_TRANSPARENCY_OPEN_AIR</a> ) * 8 );</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                            draw_debug_tile( <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a>, <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%.2f&quot;</span>, tr ) );</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                        }</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                    }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                    <span class="keywordflow">if</span>( !invisible[0] ) {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                        <span class="keyword">const</span> <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92e">visibility_type</a> vis_type = here.<a class="code" href="classmap.html#a9ca9495068efebbdf83d185e0845cc54">get_visibility</a>( ll, cache );</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                        <span class="keywordflow">if</span>( would_apply_vision_effects( vis_type ) ) {</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> *critter = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                            <span class="keywordflow">if</span>( has_draw_override( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) || has_memory_at( pos_global ) ||</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                                ( critter &amp;&amp;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                                  ( critter-&gt;<a class="code" href="classCreature.html#aec78049b0ee4401d3a4c073663735aad">has_flag</a>( <a class="code" href="mtype_8cpp.html#acc03233e053eb1e761f81eab7c05d871">mon_flag_ALWAYS_VISIBLE</a> )</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                                    || you.<a class="code" href="classCharacter.html#a9976ba9d9bccdaff264bd834628b97ec">sees_with_infrared</a>( *critter )</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                                    || you.<a class="code" href="classCharacter.html#a9333ab3cffa25b588ec5aa932db8d73d">sees_with_specials</a>( *critter ) ) ) ) {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                                invisible[0] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                                here.draw_points_cache[zlevel][row].emplace_back( <a class="code" href="structtile__render__info_1_1common.html">tile_render_info::common</a>{ <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0 },</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                                        <a class="code" href="structtile__render__info_1_1vision__effect.html">tile_render_info::vision_effect</a>{ vis_type } );</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                            }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                        }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                    }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 4; i++ ) {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> np = <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> + <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>[i];</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                        invisible[1 + i] = apply_visible( np, ch2, here );</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                    }</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                    here.draw_points_cache[zlevel][row].emplace_back( <a class="code" href="structtile__render__info_1_1common.html">tile_render_info::common</a>{ <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0 },</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                            <a class="code" href="structtile__render__info_1_1sprite.html">tile_render_info::sprite</a>{ ll, invisible } );</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                    <span class="comment">// Stop building draw points below when floor reached</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#aa7733dd145c213ee0b1f412b157ae331">dont_draw_lower_floor</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) ) {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                    }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    overlay_strings = here.overlay_strings_cache;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    color_blocks = here.color_blocks_cache;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="comment">// List all layers for a single z-level</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keyword">const</span> std::array&lt;decltype( &amp;<a class="code" href="classcata__tiles.html#ab8a53ea1dd3d0ec554735b625cfc2558">cata_tiles::draw_furniture</a> ), 11&gt; drawing_layers = {{</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#a6b8c080c92c765f22391fdbd5ab48724">cata_tiles::draw_terrain</a>, &amp;<a class="code" href="classcata__tiles.html#ab8a53ea1dd3d0ec554735b625cfc2558">cata_tiles::draw_furniture</a>, &amp;<a class="code" href="classcata__tiles.html#a99ee5b9130e7f84721f9acebc6ccafc3">cata_tiles::draw_graffiti</a>, &amp;<a class="code" href="classcata__tiles.html#a4ef5afe9f52c7e10a08e8c37864f0459">cata_tiles::draw_trap</a>, &amp;<a class="code" href="classcata__tiles.html#a51a7955aa4dacc5bb297285b27f752be">cata_tiles::draw_part_con</a>,</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#ad1b6af8efb9ede7bd643c80a0bcf17b3">cata_tiles::draw_field_or_item</a>,</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#a1cded75a40f6d10c4101c747f80bd457">cata_tiles::draw_vpart_no_roof</a>, &amp;<a class="code" href="classcata__tiles.html#af7e94971ef0b936c11b2f65a5a457ce2">cata_tiles::draw_vpart_roof</a>,</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#a57482c189f06f5af3e75b5b020c0f0eb">cata_tiles::draw_critter_at</a>, &amp;<a class="code" href="classcata__tiles.html#a8614da22369731a18369471a6ef6d634">cata_tiles::draw_zone_mark</a>,</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#ace55c771dbf796f564733940419f7ac6">cata_tiles::draw_zombie_revival_indicators</a></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    };</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="comment">// Legacy code to use when vertical vision range is 0</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keyword">const</span> std::array&lt;decltype( &amp;<a class="code" href="classcata__tiles.html#ab8a53ea1dd3d0ec554735b625cfc2558">cata_tiles::draw_furniture</a> ), 14&gt; drawing_layers_legacy = {{</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#a6b8c080c92c765f22391fdbd5ab48724">cata_tiles::draw_terrain</a>, &amp;<a class="code" href="classcata__tiles.html#ab8a53ea1dd3d0ec554735b625cfc2558">cata_tiles::draw_furniture</a>, &amp;<a class="code" href="classcata__tiles.html#a99ee5b9130e7f84721f9acebc6ccafc3">cata_tiles::draw_graffiti</a>, &amp;<a class="code" href="classcata__tiles.html#a4ef5afe9f52c7e10a08e8c37864f0459">cata_tiles::draw_trap</a>, &amp;<a class="code" href="classcata__tiles.html#a51a7955aa4dacc5bb297285b27f752be">cata_tiles::draw_part_con</a>,</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#ad1b6af8efb9ede7bd643c80a0bcf17b3">cata_tiles::draw_field_or_item</a>, &amp;<a class="code" href="classcata__tiles.html#a065e55e5706f94dc703a1c3c7e5bf8f2">cata_tiles::draw_vpart_below</a>,</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#a8af75e3afc58a4cc563d6cadfaa26d51">cata_tiles::draw_critter_at_below</a>, &amp;<a class="code" href="classcata__tiles.html#a31c24814415ed89650a7bb25e3fc66c0">cata_tiles::draw_terrain_below</a>,</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#a1cded75a40f6d10c4101c747f80bd457">cata_tiles::draw_vpart_no_roof</a>, &amp;<a class="code" href="classcata__tiles.html#af7e94971ef0b936c11b2f65a5a457ce2">cata_tiles::draw_vpart_roof</a>,</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#a57482c189f06f5af3e75b5b020c0f0eb">cata_tiles::draw_critter_at</a>, &amp;<a class="code" href="classcata__tiles.html#a8614da22369731a18369471a6ef6d634">cata_tiles::draw_zone_mark</a>,</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            &amp;<a class="code" href="classcata__tiles.html#ace55c771dbf796f564733940419f7ac6">cata_tiles::draw_zombie_revival_indicators</a></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    };</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="comment">// Skip drawing shadow of critters above if there is no shadow sprite</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="keywordtype">bool</span> do_draw_shadow = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">if</span>( find_tile_looks_like( <span class="stringliteral">&quot;shadow&quot;</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, <span class="stringliteral">&quot;&quot;</span> ) ) {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        do_draw_shadow = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    }</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordflow">if</span>( max_draw_depth &lt;= 0 ) {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="comment">// Legacy draw mode</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> row = min_row; row &lt; max_row; row ++ ) {</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">auto</span> f : drawing_layers_legacy ) {</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                <span class="keywordflow">for</span>( <a class="code" href="structtile__render__info.html">tile_render_info</a> &amp;p : here.draw_points_cache[<a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z][row] ) {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                    <span class="keywordflow">if</span>( <span class="keyword">const</span> <a class="code" href="structtile__render__info_1_1vision__effect.html">tile_render_info::vision_effect</a> * <span class="keyword">const</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                        <a class="code" href="structvar.html">var</a> = std::get_if&lt;tile_render_info::vision_effect&gt;( &amp;p.var ) ) {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                        <span class="keywordflow">if</span>( f == &amp;<a class="code" href="classcata__tiles.html#a6b8c080c92c765f22391fdbd5ab48724">cata_tiles::draw_terrain</a> ) {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                            apply_vision_effects( p.com.pos, <a class="code" href="structvar.html">var</a>-&gt;vis, p.com.height_3d );</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                        }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <span class="keyword">const</span> <a class="code" href="structtile__render__info_1_1sprite.html">tile_render_info::sprite</a> * <span class="keyword">const</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                               <a class="code" href="structvar.html">var</a> = std::get_if&lt;tile_render_info::sprite&gt;( &amp;p.var ) ) {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                        ( this-&gt;*f )( p.com.pos, <a class="code" href="structvar.html">var</a>-&gt;ll, p.com.height_3d, <a class="code" href="structvar.html">var</a>-&gt;invisible, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                    }</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                }</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="comment">// Multi z-level draw mode</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="comment">// Start drawing from the lowest visible z-level (some off-screen tiles</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="comment">// are considered visible here to simplify the logic.)</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordtype">int</span> cur_zlevel = draw_min_z;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <span class="keywordflow">while</span>( cur_zlevel &lt;= <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z ) {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            <span class="keyword">const</span> <a class="code" href="structhalf__open__rectangle.html">half_open_rectangle&lt;point&gt;</a> &amp;cur_any_tile_range = is_isometric()</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                    ? z_any_tile_range[<a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z - cur_zlevel] : top_any_tile_range;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            <span class="comment">// For each row</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> row = cur_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#af7cec817aa5f9f48c6bb5b7615aff264">p_min</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>; row &lt; cur_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#a0d6dd0f5d65dd4f9b61d74d9baf6b499">p_max</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>; row ++ ) {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                <span class="comment">// Set base height for each tile</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                <span class="keywordflow">for</span>( <a class="code" href="structtile__render__info.html">tile_render_info</a> &amp;p : here.draw_points_cache[cur_zlevel][row] ) {</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                    p.com.height_3d = ( cur_zlevel - <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z ) * zlevel_height;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                }</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                <span class="comment">// For each layer</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                <span class="keywordflow">for</span>( <span class="keyword">auto</span> f : drawing_layers ) {</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                    <span class="comment">// For each tile</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                    <span class="keywordflow">for</span>( <a class="code" href="structtile__render__info.html">tile_render_info</a> &amp;p : here.draw_points_cache[cur_zlevel][row] ) {</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                        <span class="keywordflow">if</span>( <span class="keyword">const</span> <a class="code" href="structtile__render__info_1_1vision__effect.html">tile_render_info::vision_effect</a> * <span class="keyword">const</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                            <a class="code" href="structvar.html">var</a> = std::get_if&lt;tile_render_info::vision_effect&gt;( &amp;p.var ) ) {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                            <span class="keywordflow">if</span>( f == &amp;<a class="code" href="classcata__tiles.html#a6b8c080c92c765f22391fdbd5ab48724">cata_tiles::draw_terrain</a> ) {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                apply_vision_effects( p.com.pos, <a class="code" href="structvar.html">var</a>-&gt;vis, p.com.height_3d );</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                            }</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <span class="keyword">const</span> <a class="code" href="structtile__render__info_1_1sprite.html">tile_render_info::sprite</a> * <span class="keyword">const</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                                   <a class="code" href="structvar.html">var</a> = std::get_if&lt;tile_render_info::sprite&gt;( &amp;p.var ) ) {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160; </div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                            <span class="comment">// Get visibility variables</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                            <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll = <a class="code" href="structvar.html">var</a>-&gt;ll;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                            std::array&lt;bool, 5&gt; invisible = <a class="code" href="structvar.html">var</a>-&gt;invisible;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                            <span class="keywordflow">if</span>( f == &amp;<a class="code" href="classcata__tiles.html#a1cded75a40f6d10c4101c747f80bd457">cata_tiles::draw_vpart_no_roof</a> || f == &amp;<a class="code" href="classcata__tiles.html#af7e94971ef0b936c11b2f65a5a457ce2">cata_tiles::draw_vpart_roof</a> ) {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                                <span class="keywordtype">int</span> temp_height_3d = p.com.height_3d;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                                <span class="comment">// Reset height_3d to base when drawing vehicles</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                                p.com.height_3d = ( cur_zlevel - <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z ) * zlevel_height;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                                <span class="comment">// Draw</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                                <span class="keywordflow">if</span>( !( this-&gt;*f )( p.com.pos, ll, p.com.height_3d, invisible, false ) ) {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                                    <span class="comment">// If no vpart drawn, revert height_3d changes</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                                    p.com.height_3d = temp_height_3d;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                                }</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( f == &amp;<a class="code" href="classcata__tiles.html#a57482c189f06f5af3e75b5b020c0f0eb">cata_tiles::draw_critter_at</a> ) {</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                                <span class="comment">// Draw</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                                <span class="keywordflow">if</span>( !( this-&gt;*f )( p.com.pos, ll, p.com.height_3d, invisible, false ) &amp;&amp; do_draw_shadow &amp;&amp;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                                    here.<a class="code" href="classmap.html#aa7733dd145c213ee0b1f412b157ae331">dont_draw_lower_floor</a>( p.com.pos ) ) {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                                    <span class="comment">// Draw shadow of flying critters on bottom-most tile if no other critter drawn</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                                    draw_critter_above( p.com.pos, ll, p.com.height_3d, invisible );</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                                }</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                                <span class="comment">// Draw</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                                ( this-&gt;*f )( p.com.pos, ll, p.com.height_3d, invisible, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                            }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                        }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                    }</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                }</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            }</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            cur_zlevel += 1;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="comment">// display number of monsters to spawn in mapgen preview</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> row = top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#af7cec817aa5f9f48c6bb5b7615aff264">p_min</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>; row &lt; top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#a0d6dd0f5d65dd4f9b61d74d9baf6b499">p_max</a>.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>; row ++ ) {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtile__render__info.html">tile_render_info</a> &amp;p : here.draw_points_cache[<a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z][row] ) {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            <span class="keyword">const</span> <a class="code" href="structtile__render__info_1_1sprite.html">tile_render_info::sprite</a> *<span class="keyword">const</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            <a class="code" href="structvar.html">var</a> = std::get_if&lt;tile_render_info::sprite&gt;( &amp;p.var );</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            <span class="keywordflow">if</span>( !<a class="code" href="structvar.html">var</a> ) {</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> mon_override = monster_override.find( p.com.pos );</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            <span class="keywordflow">if</span>( mon_override != monster_override.end() ) {</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> count = std::get&lt;1&gt;( mon_override-&gt;second );</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">bool</span> more = std::get&lt;2&gt;( mon_override-&gt;second );</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                <span class="keywordflow">if</span>( count &gt; 1 || more ) {</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                    std::string text = <span class="stringliteral">&quot;x&quot;</span> + <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( count );</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                    <span class="keywordflow">if</span>( more ) {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                        text += <span class="stringliteral">&quot;+&quot;</span>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                    }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                    overlay_strings.emplace( player_to_screen( p.com.pos.xy() ) + half_tile,</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                                             <a class="code" href="structformatted__text.html">formatted_text</a>( text, <a class="code" href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2b607ba9b2b7edd76f3d0a07e9dca9fc">catacurses::red</a>,</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                                                     <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403">direction::NORTH</a> ) );</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            <span class="keywordflow">if</span>( !<a class="code" href="structvar.html">var</a>-&gt;invisible[0] ) {</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                here.<a class="code" href="classmap.html#af15de9578c0dfbe9450b890bca66d543">memory_cache_ter_set_dirty</a>( p.com.pos, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            }</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        }</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="comment">// tile overrides are already drawn in the previous code</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    void_radiation_override();</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    void_terrain_override();</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    void_furniture_override();</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    void_graffiti_override();</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    void_trap_override();</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    void_field_override();</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    void_item_override();</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    void_vpart_override();</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    void_draw_below_override();</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    void_monster_override();</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; </div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="comment">//Memorize everything the character just saw even if it wasn&#39;t displayed.</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> mem_y = min_visible.y; mem_y &lt;= max_visible.y; mem_y++ ) {</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> mem_x = min_visible.x; mem_x &lt;= max_visible.x; mem_x++ ) {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> colrow = player_to_tile( { mem_x, mem_y } );</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="keywordflow">if</span>( is_isometric() &amp;&amp; top_any_tile_range.<a class="code" href="structhalf__open__rectangle.html#ab08078b04b36fca6f5a08daee6bd9486">contains</a>( colrow ) ) {</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            }</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> p( mem_x, mem_y, <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z );</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> lighting = ch.visibility_cache[p.x][p.y];</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            <span class="comment">// `apply_vision_effects` does not memorize anything so we only need</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <span class="comment">// to call `would_apply_vision_effects` here.</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            <span class="keywordflow">if</span>( would_apply_vision_effects( here.<a class="code" href="classmap.html#a9ca9495068efebbdf83d185e0845cc54">get_visibility</a>( lighting, cache ) ) ) {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            }</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            <span class="keywordtype">int</span> height_3d = 0;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            std::array&lt;bool, 5&gt; invisible;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;            invisible[0] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 4; i++ ) {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> np = p + <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>[i];</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                invisible[1 + i] = apply_visible( np, ch, here );</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            }</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            <span class="comment">//calling draw to memorize (and only memorize) everything.</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            <span class="comment">//bypass cache check in case we learn something new about the terrain&#39;s connections</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            draw_terrain( p, lighting, height_3d, invisible, <span class="keyword">true</span> );</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a8ce6b6f4cacf6410ecb6b407bf61884e">memory_cache_dec_is_dirty</a>( p ) ) {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                you.<a class="code" href="classavatar.html#aa386699e6b2e7a85f60cdcb81d17538f">memorize_clear_decoration</a>( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ), <span class="stringliteral">&quot;&quot;</span> );</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                draw_furniture( p, lighting, height_3d, invisible, <span class="keyword">true</span> );</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                draw_trap( p, lighting, height_3d, invisible, <span class="keyword">true</span> );</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                draw_part_con( p, lighting, height_3d, invisible, <span class="keyword">true</span> );</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                draw_vpart_no_roof( p, lighting, height_3d, invisible, <span class="keyword">true</span> );</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                draw_vpart_roof( p, lighting, height_3d, invisible, <span class="keyword">true</span> );</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                here.<a class="code" href="classmap.html#a1807357b0f079f62746e9fe4c117b592">memory_cache_dec_set_dirty</a>( p, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; </div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    in_animation = do_draw_explosion || do_draw_custom_explosion ||</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                   do_draw_bullet || do_draw_hit || do_draw_line ||</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                   do_draw_cursor || do_draw_highlight || do_draw_weather ||</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                   do_draw_sct || do_draw_zones || do_draw_async_anim;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    draw_footsteps_frame( <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a> );</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">if</span>( in_animation ) {</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <span class="keywordflow">if</span>( do_draw_explosion ) {</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            draw_explosion_frame();</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <span class="keywordflow">if</span>( do_draw_custom_explosion ) {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            draw_custom_explosion_frame();</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <span class="keywordflow">if</span>( do_draw_bullet ) {</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            draw_bullet_frame();</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="keywordflow">if</span>( do_draw_hit ) {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            draw_hit_frame();</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            void_hit();</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        }</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        <span class="keywordflow">if</span>( do_draw_line ) {</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            <a class="code" href="drawing__primitives_8cpp.html#aa448993c381ed2832585af66baa6cb23">draw_line</a>();</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            void_line();</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keywordflow">if</span>( do_draw_weather ) {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            draw_weather_frame();</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            void_weather();</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        <span class="keywordflow">if</span>( do_draw_sct ) {</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            draw_sct_frame( overlay_strings );</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;            void_sct();</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        <span class="keywordflow">if</span>( do_draw_zones ) {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            draw_zones_frame();</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            void_zones();</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <span class="keywordflow">if</span>( do_draw_cursor ) {</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            draw_cursor();</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            void_cursor();</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        }</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        <span class="keywordflow">if</span>( do_draw_highlight ) {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            draw_highlight();</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            void_highlight();</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        }</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <span class="keywordflow">if</span>( do_draw_async_anim ) {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            draw_async_anim();</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        }</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( you.<a class="code" href="classCharacter.html#ad142b103f316b95f28681bd5502e79ef">view_offset</a> != <a class="code" href="point_8h.html#a4b1a6bcaa42d2c06ecc3afc63305bfdf">tripoint_zero</a> &amp;&amp; !you.<a class="code" href="classCharacter.html#a61bc9422c35b63128532af268e52cb71">in_vehicle</a> ) {</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <span class="comment">// check to see if player is located at ter</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        draw_from_id_string( <span class="stringliteral">&quot;cursor&quot;</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string,</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                             <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">tripoint</a>( <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;ter_view_p.xy(), <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z ), 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>,</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                             <span class="keyword">false</span> );</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    }</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="keywordflow">if</span>( you.<a class="code" href="classCharacter.html#a0701e6a3f1987d9fa3f76b450dd5624a">controlling_vehicle</a> ) {</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        std::optional&lt;tripoint&gt; indicator_offset = <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;get_veh_dir_indicator_location( <span class="keyword">true</span> );</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        <span class="keywordflow">if</span>( indicator_offset ) {</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            draw_from_id_string( <span class="stringliteral">&quot;cursor&quot;</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string,</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                                 indicator_offset-&gt;xy() +</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                                 <a class="code" href="structtripoint.html">tripoint</a>( you.<a class="code" href="classCreature.html#aecea7d852ffba499ec12350c95340b9d">posx</a>(), you.<a class="code" href="classCreature.html#a9f0365208b65ab1c45d23f03f402f491">posy</a>(), <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z ),</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                                 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    }</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <a class="code" href="sdl__wrappers_8h.html#a7eb7cd1483cf633af1ca578070fd654e">printErrorIf</a>( SDL_RenderSetClipRect( renderer.get(), <span class="keyword">nullptr</span> ) != 0,</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                  <span class="stringliteral">&quot;SDL_RenderSetClipRect failed&quot;</span> );</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;}</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#adf59367cb77169e5f7aca5c6582ba49f">cata_tiles::set_draw_cache_dirty</a>()</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;{</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().draw_points_cache_dirty = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;}</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#aa82a0e096f56193737a998ce6c8251e8">cata_tiles::draw_minimap</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;dest, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height )</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;{</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    minimap-&gt;set_type( is_isometric() ? <a class="code" href="pixel__minimap_8h.html#acbb44fdb9957650adb277e797d84de26ae906ec779ab4ac6cbfdf30db5cbb3f1c">pixel_minimap_type::iso</a> : <a class="code" href="pixel__minimap_8h.html#acbb44fdb9957650adb277e797d84de26ad06aefbb6165aa7fd908b9e942b2e18b">pixel_minimap_type::ortho</a> );</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    minimap-&gt;draw( SDL_Rect{ dest.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>, dest.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>, width, height }, <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a> );</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;}</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<a class="code" href="structpoint.html">point</a> <a class="code" href="classcata__tiles.html#a9a10feb3534fa79e387b0efd31c36030">cata_tiles::get_window_base_tile_counts</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;<a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> )<span class="keyword"> const</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="comment">//  |---sx---|</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="comment">//  w        |</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="comment">//  ~</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="comment">//         1\  }h</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <span class="comment">//  /\/\/\/\2\ --</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="comment">//  \/\/\/\3\/  |</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <span class="comment">//  /\/\/\/\4\  sy</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <span class="comment">//  \/\/\/\5\/  |</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="comment">//  /\/\/\/\6\ --</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <span class="comment">// The rhombuses above represent the basic tiles excluding any extra</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <span class="comment">// pixel that represents things in the z direction. `w = tile_width / 2`</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="comment">// is half basic tile width and `h = tile_width / 4` is half basic tile</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="comment">// height. `tile_height` is unrelated to and can be large than the basic</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        <span class="comment">// tile height `tile_width / 2`.</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="comment">// There is no strict requirement about the exact position of pixels</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="comment">// in a sprite, except that the basic tiles should be able to densely</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        <span class="comment">// tile the screen area, and any extra pixels should only be used to</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="comment">// represent the z direction because they will be occluded by sprites in</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        <span class="comment">// the next row and occlude sprites in the previous row.</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        <span class="comment">// Only the area from (0, 0) to (tile_width, tile_width / 2) is</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="comment">// considered when checking which tiles are on-screen, and the exact</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        <span class="comment">// position of pixels is disregarded. The numbers in the figure above</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="comment">// denote the first to the last drawn cells in the vertical direction.</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <span class="comment">// Therefore, we can see that,</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <span class="comment">// cols = 1 + divide_round_up(sx, w)</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="comment">// rows = 1 + divide_round_up(sy, h)</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="comment">// ||</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        <span class="comment">// \/</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> columns = <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.x * 2, tile_width ) + 1;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> rows = <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.y * 4, tile_width ) + 1;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( columns, rows );</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        <span class="comment">// Only the area from (0, 0) to (tile_width, tile_height) is considered</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <span class="comment">// when checking which tiles are on-screen.</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> columns = <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.x, tile_width );</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> rows = <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.y, <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> );</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( columns, rows );</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    }</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;}</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<a class="code" href="structhalf__open__rectangle.html">half_open_rectangle&lt;point&gt;</a> <a class="code" href="classcata__tiles.html#ac94369b25a34545afcabfda4eee0fbc7">cata_tiles::get_window_any_tile_range</a>(</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;<a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> z )<span class="keyword"> const</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="comment">// (following comments in get_window_base_tile_counts)</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="comment">// Based on the maximum tile extent, these ensure that any tile that can be</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="comment">// possibly on screen is included in the range.</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="comment">// z-level below =&gt; negative z_height =&gt; smaller row_beg and row_end</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> z_height = zlevel_height * z;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> col_beg = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( ( tile_width - max_tile_extent.p_max.x ) * 2,</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                                               tile_width );</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> col_end = <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.x - max_tile_extent.p_min.x ) * 2,</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                                             tile_width ) + 1;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> row_beg = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( ( z_height + <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                                               - max_tile_extent.p_max.y ) * 4,</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                                               tile_width );</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="comment">// The difference between the default sprite height `tile_height` and</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <span class="comment">// base tile height `tile_width / 2` should be added to the tile extent</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="comment">// here. Because `player_to_screen` shifts the sprite up by this extra</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <span class="comment">// height, it means this extra height should be subtracted from the</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        <span class="comment">// minimum extent.</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="comment">// (sy + zh - miny + th - tw / 2) / (tw / 4) + 1 =&gt;</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> row_end = <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( ( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.y + z_height</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                                               - max_tile_extent.p_min.y + <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> ) * 4,</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                                             tile_width ) - 1;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        <span class="keywordflow">return</span> { { col_beg, row_beg }, { col_end, row_end } };</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> col_beg = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( tile_width - max_tile_extent.p_max.x, tile_width );</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> col_end = <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.x - max_tile_extent.p_min.x, tile_width );</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> row_beg = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> - max_tile_extent.p_max.y, <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> );</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> row_end = <a class="code" href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.y - max_tile_extent.p_min.y, <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> );</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        <span class="keywordflow">return</span> { { col_beg, row_beg }, { col_end, row_end } };</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    }</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;}</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<a class="code" href="structhalf__open__rectangle.html">half_open_rectangle&lt;point&gt;</a> <a class="code" href="classcata__tiles.html#a4cb480be7ebba9b53f5655054790eadf">cata_tiles::get_window_full_base_tile_range</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;<a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a> )<span class="keyword"> const</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="comment">// (following comments in get_window_base_tile_counts)</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="comment">// Only the area from (0, 0) to (tile_width, tile_width / 2) is</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <span class="comment">// considered when checking which tiles are fully on-screen, and the</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        <span class="comment">// exact position of pixels is disregarded. In the figure above, as</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <span class="comment">// opposed to 1-6, only 2-5 are fully shown on-screen. Therefore, we can</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <span class="comment">// see that,</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        <span class="comment">// cols = divide_round_down(sx, w) - 1</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        <span class="comment">// rows = divide_round_down(sy, h) - 1</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <span class="comment">// ||</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        <span class="comment">// \/</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> columns = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.x * 2, tile_width ) - 1;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> rows = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.y * 4, tile_width ) - 1;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        <span class="comment">//NOLINTNEXTLINE(cata-use-named-point-constants): the name would be confusing here (screen &#39;NSWE&#39; are not map NSWE)</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="keywordflow">return</span> { { 1, 1 }, { columns + 1, rows + 1 } };</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        <span class="comment">// Only the area from (0, 0) to (tile_width, tile_height) is considered</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <span class="comment">// when checking which tiles are fully on-screen.</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> columns = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.x, tile_width );</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> rows = <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( <a class="code" href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">size</a>.y, <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> );</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        <span class="keywordflow">return</span> { <a class="code" href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a>, { columns, rows } };</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;}</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;std::optional&lt;point&gt; <a class="code" href="classcata__tiles.html#ab266711860484a85caaabbe6ca3e6752">cata_tiles::tile_to_player</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;colrow )<span class="keyword"> const</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="comment">// (following comments in get_window_base_tile_counts)</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        <span class="comment">// Based on the screen tile pattern, the player position can be calculated</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        <span class="comment">// from the column and row numbers as follows</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8cpp.html#aa6f470a02d08b2537d7ac06d3cabaf45">modulo</a>( colrow.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> - screentile_height / 2, 2 )</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;            != <a class="code" href="cata__utility_8cpp.html#aa6f470a02d08b2537d7ac06d3cabaf45">modulo</a>( colrow.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> - screentile_width / 2, 2 ) ) {</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;            <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        }</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="keywordflow">return</span> o + <a class="code" href="structpoint.html">point</a> {</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( colrow.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> - colrow.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> - screentile_width / 2</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                               + screentile_height / 2, 2 ),</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;            <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( colrow.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> + colrow.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> - screentile_height / 2</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                               - screentile_width / 2, 2 ),</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        };</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        <span class="keywordflow">return</span> colrow + o;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    }</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;}</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<a class="code" href="structpoint.html">point</a> <a class="code" href="classcata__tiles.html#adc2c2a9f06d8f097522ce7c09e229dd5">cata_tiles::player_to_tile</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> )<span class="keyword"> const</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="comment">// (calculate the screen position according to cata_tiles::tile_to_player)</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        <span class="comment">// (division rounded down):</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        <span class="comment">// pos.x = ( col - row - sx / 2 + sy / 2 ) / 2 + o.x;</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        <span class="comment">// pos.y = ( row + col - sy / 2 - sx / 2 ) / 2 + o.y;</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        <span class="comment">// ( col - sx / 2 ) % 2 = ( row - sy / 2 ) % 2</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        <span class="comment">// ||</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        <span class="comment">// \/</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> col = <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.y + <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.x + screentile_width / 2 - o.y - o.x;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> row = <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.y - <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.x + screentile_height / 2 - o.y + o.x;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        <span class="keywordflow">return</span> { col, row };</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> - o;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    }</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;}</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; </div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<a class="code" href="structpoint.html">point</a> <a class="code" href="classcata__tiles.html#aba324f7c546fb093eb0430b8235fc2a4">cata_tiles::player_to_screen</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> )<span class="keyword"> const</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> colrow = player_to_tile( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        <span class="comment">// To ensure the first fully drawn basic tile (col or row = 1, according</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        <span class="comment">// to the definition in get_window_full_base_tile_range) starts at 0,</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <span class="keywordflow">return</span> op + <a class="code" href="structpoint.html">point</a> {</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;            <span class="comment">// left = ( col - 1 ) * ( tw / 2.0 ) =&gt;</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;            <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( ( colrow.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> - 1 ) * tile_width, 2 ),</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;            <span class="comment">// top = ( row - 1 ) * ( tw / 4.0 ) - th + tw / 2.0 =&gt;</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            <span class="comment">// (shifted so that sprites with default height end at the basic height</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            <span class="comment">// of `tile_width / 4`)</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( ( colrow.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> + 1 ) * tile_width, 4 ) - <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a>,</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        };</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="keywordflow">return</span> op + <a class="code" href="structpoint.html">point</a> { colrow.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> * tile_width, colrow.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> * <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> };</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    }</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;}</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, <span class="keywordtype">int</span> subtile,</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                                      <span class="keywordtype">int</span> rota,</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                                      <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">bool</span> apply_night_vision_goggles )</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;{</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordtype">int</span> nullint = 0;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, subtile,</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                                            rota, ll, apply_night_vision_goggles, nullint, 0 );</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;}</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                                      <span class="keyword">const</span> std::string &amp;subcategory, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>,</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                                      <span class="keywordtype">int</span> subtile, <span class="keywordtype">int</span> rota, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll,</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                                      <span class="keywordtype">bool</span> apply_night_vision_goggles )</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;{</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    <span class="keywordtype">int</span> nullint = 0;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, subcategory, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, subtile, rota,</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                                            ll, apply_night_vision_goggles, nullint, 0 );</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;}</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, <span class="keywordtype">int</span> subtile,</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                                      <span class="keywordtype">int</span> rota,</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                                      <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">bool</span> apply_night_vision_goggles,</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                                      <span class="keywordtype">int</span> &amp;height_3d )</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;{</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, subtile,</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                                            rota, ll, apply_night_vision_goggles, height_3d, 0 );</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;}</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; </div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                                      <span class="keyword">const</span> std::string &amp;subcategory, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>,</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                                      <span class="keywordtype">int</span> subtile, <span class="keywordtype">int</span> rota, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll,</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                                      <span class="keywordtype">bool</span> apply_night_vision_goggles, <span class="keywordtype">int</span> &amp;height_3d, <span class="keywordtype">int</span> <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> )</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;{</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classcata__tiles.html#a11c10516e9f2e08a1b9b386b9c6531bd">cata_tiles::draw_from_id_string_internal</a>( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, subcategory, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, subtile, rota,</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            ll, -1, apply_night_vision_goggles, height_3d, <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>() );</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;}</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                                      <span class="keyword">const</span> std::string &amp;subcategory, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>,</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                                      <span class="keywordtype">int</span> subtile, <span class="keywordtype">int</span> rota, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll,</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                                      <span class="keywordtype">bool</span> apply_night_vision_goggles, <span class="keywordtype">int</span> &amp;height_3d )</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;{</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classcata__tiles.html#a11c10516e9f2e08a1b9b386b9c6531bd">cata_tiles::draw_from_id_string_internal</a>( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, subcategory, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, subtile, rota,</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            ll, -1, apply_night_vision_goggles, height_3d, 0, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>() );</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;}</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160; </div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                                      <span class="keyword">const</span> std::string &amp;subcategory, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>,</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                                      <span class="keywordtype">int</span> subtile, <span class="keywordtype">int</span> rota, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll,</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                                      <span class="keywordtype">bool</span> apply_night_vision_goggles, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                                      <span class="keywordtype">int</span> intensity_level, <span class="keyword">const</span> std::string &amp;variant )</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;{</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classcata__tiles.html#a11c10516e9f2e08a1b9b386b9c6531bd">cata_tiles::draw_from_id_string_internal</a>( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, subcategory, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, subtile, rota,</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            ll, -1, apply_night_vision_goggles, height_3d, intensity_level,</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;            variant, <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>() );</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;}</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                                      <span class="keyword">const</span> std::string &amp;subcategory, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>,</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                                      <span class="keywordtype">int</span> subtile, <span class="keywordtype">int</span> rota, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll,</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                                      <span class="keywordtype">bool</span> apply_night_vision_goggles, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                                      <span class="keywordtype">int</span> intensity_level, <span class="keyword">const</span> std::string &amp;variant,</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;offset )</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;{</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classcata__tiles.html#a11c10516e9f2e08a1b9b386b9c6531bd">cata_tiles::draw_from_id_string_internal</a>( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, subcategory, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, subtile, rota,</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;            ll, -1, apply_night_vision_goggles, height_3d, intensity_level,</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;            variant, offset );</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;}</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a11c10516e9f2e08a1b9b386b9c6531bd">cata_tiles::draw_from_id_string_internal</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>,</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        <span class="keywordtype">int</span> subtile,</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        <span class="keywordtype">int</span> rota,</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> retract, <span class="keywordtype">bool</span> apply_night_vision_goggles, <span class="keywordtype">int</span> &amp;height_3d )</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;{</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classcata__tiles.html#a11c10516e9f2e08a1b9b386b9c6531bd">cata_tiles::draw_from_id_string_internal</a>( <span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>,</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            subtile,</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            rota, ll, retract, apply_night_vision_goggles, height_3d, 0, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>() );</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;}</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;std::optional&lt;tile_lookup_res&gt;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<a class="code" href="classcata__tiles.html#a5c641161a758a940a813ce4585ca8b80">cata_tiles::find_tile_with_season</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span> )<span class="keyword"> const</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="keyword">const</span> <a class="code" href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1b">season_type</a> <a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a> = <a class="code" href="calendar_8cpp.html#a81656706da6c7486137ad8578c0f523e">season_of_year</a>( <a class="code" href="namespacecalendar.html#ae15fcbf1c971589eb49c1a657fb6a580">calendar::turn</a> );</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="keywordflow">return</span> tileset_ptr-&gt;find_tile_type_by_season( <span class="keywordtype">id</span>, <a class="code" href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">season</a> );</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;}</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;std::optional&lt;tile_lookup_res&gt;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<a class="code" href="classcata__tiles.html#afee8c9afadc327e507553edef4dcc0ce">cata_tiles::find_tile_looks_like_by_string_id</a>( <span class="keyword">const</span> std::string_view <span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> looks_like_jumps_limit )<span class="keyword"> const</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keyword">const</span> <a class="code" href="classstring__id.html">string_id&lt;T&gt;</a> s_id( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordflow">if</span>( !s_id.is_valid() ) {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    }</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="keyword">const</span> T &amp;obj = s_id.obj();</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="keywordflow">return</span> find_tile_looks_like( obj.looks_like, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <span class="stringliteral">&quot;&quot;</span>, looks_like_jumps_limit - 1 );</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;}</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160; </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;std::optional&lt;tile_lookup_res&gt;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<a class="code" href="classcata__tiles.html#a9d05eb6d00316ddd8a8dff517da05b25">cata_tiles::find_tile_looks_like</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                                  <span class="keyword">const</span> std::string &amp;variant,</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">int</span> looks_like_jumps_limit )<span class="keyword"> const</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="keywordflow">if</span>( <span class="keywordtype">id</span>.empty() || looks_like_jumps_limit &lt;= 0 ) {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;        <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    }</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">    *  Note on memory management:</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">    *  This method must returns pointers to the objects (std::string *id  and tile_type * tile)</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">    *  that are valid when this method returns. Ideally they should have the lifetime</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">    *  that is equal or exceeds lifetime of `this` or `this::tileset_ptr`.</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">    *  For example, `id` argument may have shorter lifetime and thus should not be returned!</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">    *  The result of `find_tile_with_season` is OK to be returned, because it&#39;s guaranteed to</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">    *  return pointers to the keys and values that are stored inside the `tileset_ptr`.</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="comment">// Try the variant first</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordflow">if</span>( !variant.empty() ) {</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> != <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd">TILE_CATEGORY::VEHICLE_PART</a> ) {</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            <span class="keywordflow">if</span>( <span class="keyword">auto</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = find_tile_with_season( <span class="keywordtype">id</span> + <span class="stringliteral">&quot;_var_&quot;</span> + variant ) ) {</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>; <span class="comment">// with variant</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            std::string_view variant_chunk = variant;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            <span class="keywordflow">while</span>( !variant_chunk.empty() ) {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                <span class="keywordflow">if</span>( <span class="keyword">auto</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = find_tile_with_season( <span class="keywordtype">id</span> + <span class="stringliteral">&quot;_&quot;</span> + std::string( variant_chunk ) ) ) {</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>; <span class="comment">// with variant, but vehicle parts have weird variant suffixes</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                }</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">size_t</span> next_start = variant_chunk.rfind( <span class="charliteral">&#39;_&#39;</span> );</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                <span class="keywordflow">if</span>( next_start != std::string::npos ) {</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                    variant_chunk = variant_chunk.substr( 0, next_start );</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                    variant_chunk = variant_chunk.substr( 0, 0 );</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                }</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            }</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    }</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keywordflow">if</span>( <span class="keyword">auto</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = find_tile_with_season( <span class="keywordtype">id</span> ) ) {</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>; <span class="comment">// no variant</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; </div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <span class="comment">// Then do looks_like</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> ) {</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a479a2f961e7db58cfe3291ea257d432a">TILE_CATEGORY::FURNITURE</a>:</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            <span class="keywordflow">return</span> find_tile_looks_like_by_string_id&lt;furn_t&gt;( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                    looks_like_jumps_limit );</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32">TILE_CATEGORY::TERRAIN</a>:</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            <span class="keywordflow">return</span> find_tile_looks_like_by_string_id&lt;ter_t&gt;( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, looks_like_jumps_limit );</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d">TILE_CATEGORY::FIELD</a>:</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            <span class="keywordflow">return</span> find_tile_looks_like_by_string_id&lt;field_type&gt;( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                    looks_like_jumps_limit );</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afdd3a8eb3032c0124c1c43dec883b670">TILE_CATEGORY::MONSTER</a>:</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            <span class="keywordflow">return</span> find_tile_looks_like_by_string_id&lt;mtype&gt;( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, looks_like_jumps_limit );</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a4467febb183d4c7dba4acf8a9742796e">TILE_CATEGORY::OVERMAP_TERRAIN</a>: {</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            std::optional&lt;tile_lookup_res&gt; <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            <span class="keyword">const</span> <a class="code" href="classstring__id.html">oter_type_str_id</a> type_tmp( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;            <span class="keywordflow">if</span>( !type_tmp.is_valid() ) {</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            }</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;            <span class="keywordtype">int</span> jump_limit = looks_like_jumps_limit;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;looks_like : type_tmp.obj().looks_like ) {</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160; </div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = find_tile_looks_like( looks_like, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <span class="stringliteral">&quot;&quot;</span>, jump_limit - 1 );</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.has_value() ) {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                }</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160; </div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                jump_limit--;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                <span class="keywordflow">if</span>( jump_limit &lt;= 0 ) {</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                }</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;            }</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; </div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd">TILE_CATEGORY::VEHICLE_PART</a>: {</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> lljl = looks_like_jumps_limit - 1;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            <span class="comment">// vehicle parts start with vp_ for their tiles, but not their IDs</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;            <span class="keyword">const</span> <a class="code" href="classstring__id.html">vpart_id</a> vpid( <span class="keywordtype">id</span>.substr( 3 ) );</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;            <span class="keywordflow">if</span>( !vpid.is_valid() ) {</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            }</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;            <span class="keyword">const</span> std::string &amp;looks_like = vpid-&gt;looks_like;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="keywordflow">if</span>( looks_like.empty() ) {</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;            }</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            <span class="keywordflow">if</span>( <span class="keyword">auto</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = find_tile_looks_like( <span class="stringliteral">&quot;vp_&quot;</span> + looks_like, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, variant, lljl ) ) {</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;            }</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            <span class="keywordflow">if</span>( <span class="keyword">auto</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = find_tile_looks_like( looks_like, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, variant, lljl ) ) {</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            }</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        }</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160; </div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a2b911c015ed17a423c74ab9987330e60">TILE_CATEGORY::ITEM</a>: {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            <span class="keywordflow">if</span>( !<a class="code" href="classitem.html#a4c54ded219374a2f5f80e8eee192dcdf">item::type_is_defined</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5b71ce78dc7a00ad2177c6655231928c">itype_id</a>( <span class="keywordtype">id</span> ) ) ) {</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( <span class="keywordtype">id</span>, <span class="stringliteral">&quot;corpse_&quot;</span> ) ) {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                    <span class="keywordflow">return</span> find_tile_looks_like(</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                               <span class="stringliteral">&quot;corpse&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <span class="stringliteral">&quot;&quot;</span>, looks_like_jumps_limit - 1</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                           );</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                }</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            }</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            <span class="keyword">const</span> <a class="code" href="structitype.html">itype</a> *new_it = <a class="code" href="classitem.html#a11cf8d500b6d8106302470dce5ca9177">item::find_type</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5b71ce78dc7a00ad2177c6655231928c">itype_id</a>( <span class="keywordtype">id</span> ) );</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            <span class="keywordflow">return</span> find_tile_looks_like( new_it-&gt;<a class="code" href="structitype.html#a4e982ae6c205d1a157d2df129373eca3">looks_like</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>(), <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                                         looks_like_jumps_limit - 1 );</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        }</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    }</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;}</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a8754be9e0df7a9f4994fce3053fe6747">cata_tiles::find_overlay_looks_like</a>( <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="newcharacter_8cpp.html#a1d22ab3ab1f5b7b3d7b9491dcd8787b4">male</a>, <span class="keyword">const</span> std::string &amp;overlay,</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <span class="keyword">const</span> std::string &amp;variant, std::string &amp;draw_id )</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;{</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    <span class="keywordtype">bool</span> exists = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    std::string looks_like;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    std::string over_type;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( overlay, <span class="stringliteral">&quot;worn_&quot;</span> ) ) {</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        looks_like = overlay.substr( 5 );</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        over_type = <span class="stringliteral">&quot;worn_&quot;</span>;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( overlay, <span class="stringliteral">&quot;wielded_&quot;</span> ) ) {</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        looks_like = overlay.substr( 8 );</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        over_type = <span class="stringliteral">&quot;wielded_&quot;</span>;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        looks_like = overlay;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    }</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160; </div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="comment">// Try to draw variants, then fall back to drawing the base</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="comment">// We can potentially do this twice for a variant of an active mutation</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 2; ++i ) {</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        draw_id.clear();</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        <a class="code" href="cata__utility_8h.html#a08531d647db70a8f67a522176a6f2130">str_append</a>( draw_id,</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                    ( <a class="code" href="newcharacter_8cpp.html#a1d22ab3ab1f5b7b3d7b9491dcd8787b4">male</a> ? <span class="stringliteral">&quot;overlay_male_&quot;</span> : <span class="stringliteral">&quot;overlay_female_&quot;</span> ), over_type, looks_like, <span class="stringliteral">&quot;_var_&quot;</span>,</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                    variant );</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( draw_id ) ) {</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        draw_id.clear();</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        <a class="code" href="cata__utility_8h.html#a08531d647db70a8f67a522176a6f2130">str_append</a>( draw_id, <span class="stringliteral">&quot;overlay_&quot;</span>, over_type, looks_like, <span class="stringliteral">&quot;_var_&quot;</span>, variant );</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( draw_id ) ) {</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        }</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( looks_like, <span class="stringliteral">&quot;mutation_active_&quot;</span> ) ) {</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            looks_like = <span class="stringliteral">&quot;mutation_&quot;</span> + looks_like.substr( 16 );</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        }</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    }</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> cnt = 0; cnt &lt; 10 &amp;&amp; !looks_like.empty(); cnt++ ) {</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        draw_id.clear();</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <a class="code" href="cata__utility_8h.html#a08531d647db70a8f67a522176a6f2130">str_append</a>( draw_id,</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                    ( <a class="code" href="newcharacter_8cpp.html#a1d22ab3ab1f5b7b3d7b9491dcd8787b4">male</a> ? <span class="stringliteral">&quot;overlay_male_&quot;</span> : <span class="stringliteral">&quot;overlay_female_&quot;</span> ), over_type, looks_like );</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( draw_id ) ) {</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            exists = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        }</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        draw_id.clear();</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        <a class="code" href="cata__utility_8h.html#a08531d647db70a8f67a522176a6f2130">str_append</a>( draw_id, <span class="stringliteral">&quot;overlay_&quot;</span>, over_type, looks_like );</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( draw_id ) ) {</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            exists = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        }</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( looks_like, <span class="stringliteral">&quot;mutation_active_&quot;</span> ) ) {</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            looks_like = <span class="stringliteral">&quot;mutation_&quot;</span> + looks_like.substr( 16 );</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        <span class="keywordflow">if</span>( !<a class="code" href="classitem.html#a4c54ded219374a2f5f80e8eee192dcdf">item::type_is_defined</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5b71ce78dc7a00ad2177c6655231928c">itype_id</a>( looks_like ) ) ) {</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        }</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        <span class="keyword">const</span> <a class="code" href="structitype.html">itype</a> *new_it = <a class="code" href="classitem.html#a11cf8d500b6d8106302470dce5ca9177">item::find_type</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5b71ce78dc7a00ad2177c6655231928c">itype_id</a>( looks_like ) );</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        looks_like = new_it-&gt;<a class="code" href="structitype.html#a4e982ae6c205d1a157d2df129373eca3">looks_like</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    }</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordflow">return</span> exists;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;}</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a11c10516e9f2e08a1b9b386b9c6531bd">cata_tiles::draw_from_id_string_internal</a>( <span class="keyword">const</span> std::string &amp;<span class="keywordtype">id</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        <span class="keyword">const</span> std::string &amp;subcategory, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>,</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <span class="keywordtype">int</span> subtile, <span class="keywordtype">int</span> rota, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> retract,</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        <span class="keywordtype">bool</span> apply_night_vision_goggles, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        <span class="keywordtype">int</span> intensity_level, <span class="keyword">const</span> std::string &amp;variant,</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;offset )</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;{</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="keywordtype">bool</span> nv_color_active = apply_night_vision_goggles &amp;&amp; get_option&lt;bool&gt;( <span class="stringliteral">&quot;NV_GREEN_TOGGLE&quot;</span> );</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <span class="comment">// If the ID string does not produce a drawable tile</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="comment">// it will revert to the &quot;unknown&quot; tile.</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="comment">// The &quot;unknown&quot; tile is one that is highly visible so you kinda can&#39;t miss it :D</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtile__type.html">tile_type</a> *tt = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    std::optional&lt;tile_lookup_res&gt; res;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="comment">// translate from player-relative to screen relative tile position</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> screen_pos = player_to_screen( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.xy() );</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; </div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="keywordflow">if</span>( retract &lt; 0 &amp;&amp; ( <a class="code" href="cached__options_8cpp.html#a23c5a251d51bb2592b83ee1daa1f81f9">prevent_occlusion_transp</a> || <a class="code" href="cached__options_8cpp.html#afcb9eb2d0281d789f0f5b492c623b5fd">prevent_occlusion_retract</a> ) ) {</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="cached__options_8cpp.html#ab89c4bf33e6fc159efd1e392b2340540">prevent_occlusion</a> == 0 ) {</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            retract = 0;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="cached__options_8cpp.html#ab89c4bf33e6fc159efd1e392b2340540">prevent_occlusion</a> == 1 ) {</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;            retract = 100;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> distance = o.distance( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.xy() );</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> d_min = <a class="code" href="cached__options_8cpp.html#af3fa94d0c2cd07c6e27c9c4f455e1d1e">prevent_occlusion_min_dist</a> &gt; 0.0 ? <a class="code" href="cached__options_8cpp.html#af3fa94d0c2cd07c6e27c9c4f455e1d1e">prevent_occlusion_min_dist</a> :</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                                tileset_ptr-&gt;get_prevent_occlusion_min_dist();</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> d_max = <a class="code" href="cached__options_8cpp.html#ae34f538a8b94884b1c01e3cb98f1cef2">prevent_occlusion_max_dist</a> &gt; 0.0 ? <a class="code" href="cached__options_8cpp.html#ae34f538a8b94884b1c01e3cb98f1cef2">prevent_occlusion_max_dist</a> :</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                                tileset_ptr-&gt;get_prevent_occlusion_max_dist();</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160; </div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> d_range = d_max - d_min;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> d_slope = d_range &lt;= 0.0f ? 100.0 : 1.0 / d_range;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;            retract = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( 100.0 * ( 1.0 - <a class="code" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( ( distance - d_min ) * d_slope, 0.0f, 1.0f ) ) );</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        }</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="cached__options_8cpp.html#a23c5a251d51bb2592b83ee1daa1f81f9">prevent_occlusion_transp</a> &amp;&amp; retract &gt; 0 ) {</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;            res = find_tile_looks_like( <span class="keywordtype">id</span> + <span class="stringliteral">&quot;_transparent&quot;</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, variant );</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            <span class="keywordflow">if</span>( res ) {</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                tt = &amp;res -&gt; tile();</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;            }</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        }</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    }</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <span class="comment">// check if there is an available intensity tile and if there is use that instead of the basic tile</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="comment">// this is only relevant for fields</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="keywordflow">if</span>( intensity_level &gt; 0 ) {</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        res = find_tile_looks_like( <span class="keywordtype">id</span> + <span class="stringliteral">&quot;_int&quot;</span> + <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( intensity_level ), <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, variant );</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        <span class="keywordflow">if</span>( res ) {</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;            tt = &amp;res -&gt; tile();</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        }</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    }</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="comment">// if a tile with intensity hasn&#39;t already been found then fall back to a base tile</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keywordflow">if</span>( !res ) {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        res = find_tile_looks_like( <span class="keywordtype">id</span>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, variant );</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <span class="keywordflow">if</span>( res ) {</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            tt = &amp;res -&gt; tile();</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    }</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <span class="keyword">const</span> std::string &amp;found_id = res ? res-&gt;id() : <a class="code" href="namespacebase__camps.html#a04fa69b1c0952a34dc4a7d26b3f9f786">id</a>;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160; </div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="keywordflow">if</span>( !tt ) {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        <span class="comment">// Use fog overlay as fallback for transparent terrain</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32">TILE_CATEGORY::TERRAIN</a> &amp;&amp; !here.<a class="code" href="classmap.html#aa7733dd145c213ee0b1f412b157ae331">dont_draw_lower_floor</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) ) {</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;            draw_zlevel_overlay( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, ll, height_3d );</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;            <span class="comment">// t_open_air is plentiful at high z-levels</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;            <span class="comment">// Skipping the rest of the fallback code will significantly improve performance</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;            <span class="keywordflow">if</span>( <span class="keywordtype">id</span> == <span class="stringliteral">&quot;t_open_air&quot;</span> ) {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;            }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;        }</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        uint32_t sym = <a class="code" href="catacharset_8h.html#ad1552b0ee59f5106267a8417a2f620a8">UNKNOWN_UNICODE</a>;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        <a class="code" href="classnc__color.html">nc_color</a> col = <a class="code" href="color_8h.html#a0d06dc49b9761bbc54607397213728bb">c_white</a>;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a479a2f961e7db58cfe3291ea257d432a">TILE_CATEGORY::FURNITURE</a> ) {</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;            <span class="keyword">const</span> <a class="code" href="classstring__id.html">furn_str_id</a> fid( found_id );</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;            <span class="keywordflow">if</span>( fid.is_valid() ) {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                <span class="keyword">const</span> <a class="code" href="structfurn__t.html">furn_t</a> &amp;f = fid.obj();</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                sym = f.<a class="code" href="structmap__data__common__t.html#ae397fb9418c5b559c641061245bc8c18">symbol</a>();</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                col = f.<a class="code" href="structmap__data__common__t.html#aa7c0e4d48398517e30f167b5f2582664">color</a>();</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;            }</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32">TILE_CATEGORY::TERRAIN</a> ) {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            <span class="keyword">const</span> <a class="code" href="classstring__id.html">ter_str_id</a> tid( found_id );</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;            <span class="keywordflow">if</span>( tid.is_valid() ) {</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                <span class="keyword">const</span> <a class="code" href="structter__t.html">ter_t</a> &amp;t = tid.obj();</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                sym = t.<a class="code" href="structmap__data__common__t.html#ae397fb9418c5b559c641061245bc8c18">symbol</a>();</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                col = t.<a class="code" href="structmap__data__common__t.html#aa7c0e4d48398517e30f167b5f2582664">color</a>();</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;            }</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afdd3a8eb3032c0124c1c43dec883b670">TILE_CATEGORY::MONSTER</a> ) {</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;            <span class="keyword">const</span> <a class="code" href="classstring__id.html">mtype_id</a> mid( found_id );</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;            <span class="keywordflow">if</span>( mid.is_valid() ) {</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                <span class="keyword">const</span> <a class="code" href="structmtype.html">mtype</a> &amp;mt = mid.obj();</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                sym = <a class="code" href="catacharset_8cpp.html#a2227e8c0afd74ed174cbb4daf8e46ab2">UTF8_getch</a>( mt.<a class="code" href="structmtype.html#a38400904b6ae1207054cca44318d0426">sym</a> );</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                col = mt.<a class="code" href="structmtype.html#a6ad4c76593c4cd6423492169733885a1">color</a>;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;            }</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd">TILE_CATEGORY::VEHICLE_PART</a> ) {</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;            <span class="keyword">const</span> <a class="code" href="classstring__id.html">vpart_id</a> vpid( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( found_id, <span class="stringliteral">&quot;vp_&quot;</span> ) ? found_id.substr( 3 ) : found_id );</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            <span class="keywordflow">if</span>( vpid.is_valid() ) {</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                <span class="keyword">const</span> <a class="code" href="classvpart__info.html">vpart_info</a> &amp;vpi = *vpid;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                <span class="keywordflow">if</span>( vpi.<a class="code" href="classvpart__info.html#ac49f2d6f9a4b8e42a768dfb28dad69c3">variants</a>.count( variant ) ) {</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classvpart__variant.html">vpart_variant</a> &amp;vv = vpi.<a class="code" href="classvpart__info.html#ac49f2d6f9a4b8e42a768dfb28dad69c3">variants</a>.at( variant );</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                    <span class="keywordflow">if</span>( subtile == <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aa0734d934d4034f144b98c304caab076">open_</a> ) {</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                        sym = <span class="charliteral">&#39;\&#39;&#39;</span>;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                        sym = vv.<a class="code" href="classvpart__variant.html#a20202dc1a49cd7bac2d070c619c41152">get_symbol_curses</a>( 90_degrees * rota, subtile == <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a1f85e94c05010d1308d67d1d918944e4">broken</a> );</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                    }</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                    col = vpi.<a class="code" href="classvpart__info.html#ac8dbc94ea6028b13c5a9f4e8da9b14ba">color</a>;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                    subtile = -1;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                    rota = 0;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ll != <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c">lit_level::MEMORIZED</a> ) {</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                    <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;invalid variant &#39;%s&#39; on vpart_id &#39;%s&#39;&quot;</span>, variant, vpid.str() );</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                }</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ll != <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c">lit_level::MEMORIZED</a> ) {</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;invalid vpart_id &#39;%s&#39;&quot;</span>, vpid.str() );</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            }</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d">TILE_CATEGORY::FIELD</a> ) {</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;            <span class="keyword">const</span> <a class="code" href="classint__id.html">field_type_id</a> fid = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a1e3f04102267eaf5e8d0ca424fd5c561">field_type_id</a>( found_id );</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            sym = fid-&gt;<a class="code" href="structfield__type.html#a46f1cb85c4bfdac38826b81178295ed5">get_intensity_level</a>().<a class="code" href="structfield__intensity__level.html#a78f4cabdc0e6b7affb3ba30eee64805b">symbol</a>;</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            col = fid-&gt;<a class="code" href="structfield__type.html#a46f1cb85c4bfdac38826b81178295ed5">get_intensity_level</a>().<a class="code" href="structfield__intensity__level.html#a0b6695c49116d5a491cad180fd229be6">color</a>;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a26d3b291eb79dc52744a2ebb34004e97">TILE_CATEGORY::TRAP</a> ) {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;            <span class="keyword">const</span> <a class="code" href="classstring__id.html">trap_str_id</a> tmp( found_id );</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            <span class="keywordflow">if</span>( tmp.is_valid() ) {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                <span class="keyword">const</span> <a class="code" href="structtrap.html">trap</a> &amp;t = tmp.obj();</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                sym = t.<a class="code" href="structtrap.html#a975d50578595efdc3b93fb32bab0e41b">sym</a>;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                col = t.<a class="code" href="structtrap.html#a92373743ed980b356de173c228c79499">color</a>;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a2b911c015ed17a423c74ab9987330e60">TILE_CATEGORY::ITEM</a> ) {</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;            <a class="code" href="classitem.html">item</a> tmp;</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( found_id, <span class="stringliteral">&quot;corpse_&quot;</span> ) ) {</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                tmp = <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc">item</a>( <a class="code" href="iexamine_8cpp.html#a4ea2c47870b82e831292a9239b2e6ff2">itype_corpse</a>, <a class="code" href="namespacecalendar.html#a2830b54b0424fe452c0933f87d6201b3">calendar::turn_zero</a> );</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                tmp = <a class="code" href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc">item</a>( found_id, <a class="code" href="namespacecalendar.html#a2830b54b0424fe452c0933f87d6201b3">calendar::turn_zero</a> );</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            }</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            <span class="keywordflow">if</span>( !variant.empty() ) {</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                tmp.<a class="code" href="classitem.html#a2307462a36b9809493966946645c2bc4">set_itype_variant</a>( variant );</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                tmp.<a class="code" href="classitem.html#a3101211dc3db3a8aa95675ab86d3ba36">clear_itype_variant</a>();</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;            }</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;            sym = <span class="keyword">static_cast&lt;</span>uint8_t<span class="keyword">&gt;</span>( tmp.<a class="code" href="classitem.html#a1ff6f2a9cd0fc994e3484b66138cb049">symbol</a>().empty() ? <span class="charliteral">&#39; &#39;</span> : tmp.<a class="code" href="classitem.html#a1ff6f2a9cd0fc994e3484b66138cb049">symbol</a>().front() );</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            col = tmp.<a class="code" href="classitem.html#ac3802e76b128e7ee2982352e7ad72030">color</a>();</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a4467febb183d4c7dba4acf8a9742796e">TILE_CATEGORY::OVERMAP_TERRAIN</a> ) {</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;            <span class="keyword">const</span> <a class="code" href="classstring__id.html">oter_type_str_id</a> tmp( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;            <span class="keywordflow">if</span>( tmp.is_valid() ) {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                <span class="keywordflow">if</span>( !tmp-&gt;is_linear() ) {</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                    sym = tmp-&gt;get_rotated( <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceom__direction.html#a3f3a3bf2c5af33fc8036734d1ba70b7c">om_direction::type</a><span class="keyword">&gt;</span>( rota ) )-&gt;get_uint32_symbol();</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                    sym = tmp-&gt;<a class="code" href="classitem.html#a1ff6f2a9cd0fc994e3484b66138cb049">symbol</a>;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                }</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                col = tmp-&gt;<a class="code" href="classitem.html#ac3802e76b128e7ee2982352e7ad72030">color</a>;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;            }</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a3535b8a10b75a49c73a56cb88ed6f2ad">TILE_CATEGORY::OVERMAP_NOTE</a> ) {</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;            sym = <span class="keyword">static_cast&lt;</span>uint8_t<span class="keyword">&gt;</span>( <span class="keywordtype">id</span>[5] );</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;            col = <a class="code" href="color_8cpp.html#a4a88185cb5fcb714421d6bc682481d5b">color_from_string</a>( <span class="keywordtype">id</span>.substr( 7, <span class="keywordtype">id</span>.<a class="code" href="smart__controller__ui_8h.html#a70311dd7f8c88e8727c2a7567aa555caaa7970bb5f1149f16a82922773632ebe3">length</a>() - 1 ) );</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        }</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        <span class="comment">// Special cases for walls</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        <span class="keywordflow">switch</span>( sym ) {</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a33ab4e0193402fed8f74590a30fadc3c">LINE_XOXO</a>:</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#ac80e34aa2e1caf07189f2d1c758ae9a0">LINE_XOXO_UNICODE</a>:</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                sym = <a class="code" href="output_8h.html#adecb5eb42e17650557a3b1f7d014cd97">LINE_XOXO_C</a>;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a435355aeca1be3844e79fc4db8e691e1">LINE_OXOX</a>:</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a331aebdd7d682000108b345699a052e5">LINE_OXOX_UNICODE</a>:</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                sym = <a class="code" href="output_8h.html#a2b180123cdd4352de9a2ebcbaabc8627">LINE_OXOX_C</a>;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#af6d239f277e1b763f690b94efa469792">LINE_XXOO</a>:</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a663fd8bf8b213ed7a60b559cbab27248">LINE_XXOO_UNICODE</a>:</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;                sym = <a class="code" href="output_8h.html#a33b56b57f3e8b7d2fa0beaff9cd0900d">LINE_XXOO_C</a>;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a6405dcdb708433c3c3dde836aa8a15cc">LINE_OXXO</a>:</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a7bdca7292f2ca836ba27dcea9eb1493a">LINE_OXXO_UNICODE</a>:</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;                sym = <a class="code" href="output_8h.html#a9366a7c7ae74a665dfa0a7da229c1289">LINE_OXXO_C</a>;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a479e8a9ad84c68ed5f8609d4b536a8bb">LINE_OOXX</a>:</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a2d78fca682aa56b3aae26b0c763b18d5">LINE_OOXX_UNICODE</a>:</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                sym = <a class="code" href="output_8h.html#a51f593b330977c09884e69642c69b3e1">LINE_OOXX_C</a>;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#ad3a54f998264087befce6de30cb787b0">LINE_XOOX</a>:</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#ac48c8e45a5f70ffc3e529206c2b4d661">LINE_XOOX_UNICODE</a>:</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;                sym = <a class="code" href="output_8h.html#acf8f3e28da5a6881a30c33e64484aef2">LINE_XOOX_C</a>;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a4b80f0039259ebe61dc2e58ca4b31043">LINE_XXXO</a>:</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a802d664db221121367b39cc767bf79dd">LINE_XXXO_UNICODE</a>:</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;                sym = <a class="code" href="output_8h.html#adfed5ce9b05a4a77adff41e37957e203">LINE_XXXO_C</a>;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a612d0d0728e93276b2b7de1fc57b096b">LINE_XXOX</a>:</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a7cfb0ef357d2ae159978cd93d0e4d309">LINE_XXOX_UNICODE</a>:</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                sym = <a class="code" href="output_8h.html#ac280967a17125ee5ab47b91c7c82904d">LINE_XXOX_C</a>;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a0803e4570f3cd69d38952bc2b4555c24">LINE_XOXX</a>:</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a8bc8e69b50626b375b65dde9607c4626">LINE_XOXX_UNICODE</a>:</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                sym = <a class="code" href="output_8h.html#ab476e6f9cbd2eabac88865e08a1fe729">LINE_XOXX_C</a>;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a4a3bfadbe7ec0abb14ff53e5e2f8983e">LINE_OXXX</a>:</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a4660d5c291e71922051edf0f2f3142e8">LINE_OXXX_UNICODE</a>:</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                sym = <a class="code" href="output_8h.html#a7ff40ccfb98b8c772404746dad32c2cb">LINE_OXXX_C</a>;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#af951bd858b538b7c2a10ae7ffd97b848">LINE_XXXX</a>:</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="output_8h.html#a99267201d227c306e523ec39c05825cd">LINE_XXXX_UNICODE</a>:</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                sym = <a class="code" href="output_8h.html#a430b2ba81cbe0935f0438d49b02ebb92">LINE_XXXX_C</a>;</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;                <span class="comment">// sym goes unchanged</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        }</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160; </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        <span class="keywordflow">if</span>( sym != 0 &amp;&amp; sym &lt; 256 ) {</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;            <span class="comment">// see cursesport.cpp, function wattron</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> pairNumber = col.<a class="code" href="classnc__color.html#a9cc29a810af4b9f38101dcfd2194e722">to_color_pair_index</a>();</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;            <span class="keyword">const</span> cata_cursesport::pairs &amp;colorpair = <a class="code" href="cata__imgui_8cpp.html#ac95da3f41714ec1458968960346eadfe">cata_cursesport::colorpairs</a>[pairNumber];</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            <span class="comment">// What about isBlink?</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> isBold = col.<a class="code" href="classnc__color.html#a56cc19eb9c2f8949f541de4497c24696">is_bold</a>();</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> FG = colorpair.FG + ( isBold ? 8 : 0 );</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;            std::string generic_id = get_ascii_tile_id( sym, FG, -1 );</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160; </div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;            <span class="comment">// do not rotate fallback tiles!</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;            <span class="keywordflow">if</span>( sym != <a class="code" href="output_8h.html#adecb5eb42e17650557a3b1f7d014cd97">LINE_XOXO_C</a> &amp;&amp; sym != <a class="code" href="output_8h.html#a2b180123cdd4352de9a2ebcbaabc8627">LINE_OXOX_C</a> ) {</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                rota = 0;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;            }</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;            <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( generic_id ) ) {</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                <span class="keywordflow">return</span> draw_from_id_string_internal( generic_id, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, subtile, rota,</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;                                                     ll, retract, nv_color_active, height_3d );</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;            }</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;            <span class="comment">// Try again without color this time (using default color).</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            generic_id = get_ascii_tile_id( sym, -1, -1 );</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( generic_id ) ) {</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                <span class="keywordflow">return</span> draw_from_id_string_internal( generic_id, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, subtile, rota,</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                                                     ll, retract, nv_color_active, height_3d );</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;            }</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        }</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    }</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160; </div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <span class="comment">// if id is not found, try to find a tile for the category+subcategory combination</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <span class="keyword">const</span> std::string &amp;category_id = TILE_CATEGORY_IDS[<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> )];</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <span class="keywordflow">if</span>( !tt ) {</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        <span class="keywordflow">if</span>( !category_id.empty() &amp;&amp; !subcategory.empty() ) {</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;            tt = tileset_ptr-&gt;find_tile_type( <span class="stringliteral">&quot;unknown_&quot;</span> + category_id + <span class="stringliteral">&quot;_&quot;</span> + subcategory );</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        }</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;    }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160; </div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="comment">// if at this point we have no tile, try just the category</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <span class="keywordflow">if</span>( !tt ) {</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        <span class="keywordflow">if</span>( !category_id.empty() ) {</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;            tt = tileset_ptr-&gt;find_tile_type( <span class="stringliteral">&quot;unknown_&quot;</span> + category_id );</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;        }</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    }</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160; </div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <span class="comment">// if we still have no tile, we&#39;re out of luck, fall back to unknown</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="keywordflow">if</span>( !tt ) {</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        tt = tileset_ptr-&gt;find_tile_type( <span class="stringliteral">&quot;unknown&quot;</span> );</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160; </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <span class="comment">//  this really shouldn&#39;t happen, but the tileset creator might have forgotten to define</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <span class="comment">// an unknown tile</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <span class="keywordflow">if</span>( !tt ) {</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    }</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160; </div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtile__type.html">tile_type</a> &amp;display_tile = *tt;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <span class="comment">// check to see if the display_tile is multitile, and if so if it has the key related to</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <span class="comment">// subtile</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <span class="keywordflow">if</span>( subtile != -1 &amp;&amp; display_tile.<a class="code" href="structtile__type.html#a2c4d836f396cc106934adc00f922c5f0">multitile</a> ) {</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;display_subtiles = display_tile.<a class="code" href="structtile__type.html#afdce3fa4361373a841391a76cdb8905f">available_subtiles</a>;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">end</a> = <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">std::end</a>( display_subtiles );</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        <span class="keywordflow">if</span>( std::find( begin( display_subtiles ), <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">end</a>, multitile_keys[subtile] ) != <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">end</a> ) {</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;            <span class="comment">// append subtile name to tile and re-find display_tile</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;            <span class="keywordflow">return</span> draw_from_id_string_internal(</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;                       found_id + <span class="stringliteral">&quot;_&quot;</span> + multitile_keys[subtile], <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, subcategory, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, -1, rota, ll,</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                       retract, nv_color_active, height_3d, 0, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>() );</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;        }</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    }</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160; </div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    <span class="keyword">auto</span> simple_point_hash = []( <span class="keyword">const</span> <span class="keyword">auto</span> &amp; p ) {</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        <span class="keywordflow">return</span> p.x + p.y * 65536;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    };</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160; </div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    <span class="comment">// seed the PRNG to get a reproducible random int</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="comment">// TODO: faster solution here</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = 0;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    <a class="code" href="classcreature__tracker.html">creature_tracker</a> &amp;creatures = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>();</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <span class="comment">// TODO: determine ways other than category to differentiate more types of sprites</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> ) {</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32">TILE_CATEGORY::TERRAIN</a>:</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d">TILE_CATEGORY::FIELD</a>:</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a8b1aa4726295b67f4ca299670037daeb">TILE_CATEGORY::LIGHTING</a>:</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;            <span class="comment">// stationary map tiles, seed based on map coordinates</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;            <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = simple_point_hash( here.<a class="code" href="classmap.html#a501f3a1d449ac022f1b36b99da653e94">getabs</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) );</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd">TILE_CATEGORY::VEHICLE_PART</a>:</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            <span class="comment">// vehicle parts, seed based on coordinates within the vehicle</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;            <span class="comment">// TODO: also use some vehicle id, for less predictability</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;        {</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;            <span class="comment">// new scope for variable declarations</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> vp_override = vpart_override.find( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> vp_overridden = vp_override != vpart_override.end();</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;            <span class="keywordflow">if</span>( vp_overridden ) {</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;                <span class="keyword">const</span> <a class="code" href="classstring__id.html">vpart_id</a> &amp;vp_id = std::get&lt;0&gt;( vp_override-&gt;second );</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                <span class="keywordflow">if</span>( vp_id ) {</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;mount = std::get&lt;4&gt;( vp_override-&gt;second );</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                    <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = simple_point_hash( mount );</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                }</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                <span class="keyword">const</span> <a class="code" href="classoptional__vpart__position.html">optional_vpart_position</a> vp = here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                <span class="keywordflow">if</span>( vp ) {</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                    <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = simple_point_hash( vp-&gt;mount() );</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                }</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            }</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        }</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a479a2f961e7db58cfe3291ea257d432a">TILE_CATEGORY::FURNITURE</a>: {</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            <span class="comment">// If the furniture is not movable, we&#39;ll allow seeding by the position</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            <span class="comment">// since we won&#39;t get the behavior that occurs where the tile constantly</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;            <span class="comment">// changes when the player grabs the furniture and drags it, causing the</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            <span class="comment">// seed to change.</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;            <span class="keyword">const</span> <a class="code" href="classstring__id.html">furn_str_id</a> fid( found_id );</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            <span class="keywordflow">if</span>( fid.<a class="code" href="classint__id.html#a8ca0e76fa665125f1e50bd1ed8dbd213">is_valid</a>() ) {</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                <span class="keyword">const</span> <a class="code" href="structfurn__t.html">furn_t</a> &amp;f = fid.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>();</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                <span class="keywordflow">if</span>( !f.<a class="code" href="structfurn__t.html#a7ef46ed5fb8a03bb1487754eeb5fb7b7">is_movable</a>() ) {</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;                    <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = simple_point_hash( here.<a class="code" href="classmap.html#a501f3a1d449ac022f1b36b99da653e94">getabs</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) );</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                }</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;            }</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;        }</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a4467febb183d4c7dba4acf8a9742796e">TILE_CATEGORY::OVERMAP_TERRAIN</a>:</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afeb73e1c74ff492ff8fd4b8d38d490ef">TILE_CATEGORY::MAP_EXTRA</a>:</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;            <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = simple_point_hash( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> );</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>:</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;            <span class="comment">// graffiti</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;            <span class="keywordflow">if</span>( found_id == <span class="stringliteral">&quot;graffiti&quot;</span> ) {</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;                <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = std::hash&lt;std::string&gt; {}( here.<a class="code" href="classmap.html#ae074b6e1e06913bee442d894f590131f">graffiti_at</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) );</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( found_id, <span class="stringliteral">&quot;graffiti&quot;</span> ) ) {</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;                <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = simple_point_hash( here.<a class="code" href="classmap.html#a501f3a1d449ac022f1b36b99da653e94">getabs</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) );</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;            }</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a2b911c015ed17a423c74ab9987330e60">TILE_CATEGORY::ITEM</a>:</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a26d3b291eb79dc52744a2ebb34004e97">TILE_CATEGORY::TRAP</a>:</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a5fb9dc502beb6f75a2175f0ea535437d">TILE_CATEGORY::BULLET</a>:</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a370f36e1c5ce51a59c8b3ebcc5ddeda6">TILE_CATEGORY::HIT_ENTITY</a>:</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a83a014c3c0a41242b5a879d011b677d6">TILE_CATEGORY::WEATHER</a>:</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;            <span class="comment">// TODO: come up with ways to make random sprites consistent for these types</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afdd3a8eb3032c0124c1c43dec883b670">TILE_CATEGORY::MONSTER</a>:</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;            <span class="comment">// FIXME: add persistent id to Creature type, instead of using monster pointer address</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            <span class="keywordflow">if</span>( monster_override.find( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) == monster_override.end() ) {</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = <span class="keyword">reinterpret_cast&lt;</span>uintptr_t<span class="keyword">&gt;</span>( creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classmonster.html">monster</a>&gt;( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) );</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            <span class="comment">// player</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( found_id, <span class="stringliteral">&quot;player_&quot;</span> ) ) {</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = std::hash&lt;std::string&gt; {}( <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">name</a> );</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;            }</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;            <span class="comment">// NPC</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( found_id, <span class="stringliteral">&quot;npc_&quot;</span> ) ) {</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="classnpc.html">npc</a> *<span class="keyword">const</span> guy = creatures.<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>&lt;<a class="code" href="classnpc.html">npc</a>&gt;( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) ) {</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                    <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> = guy-&gt;getID().get_value();</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            }</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    }</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160; </div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    <span class="comment">// make sure we aren&#39;t going to rotate the tile if it shouldn&#39;t be rotated</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="keywordflow">if</span>( !display_tile.<a class="code" href="structtile__type.html#adeeea68947a7fcd56075c444481722eb">rotates</a> &amp;&amp; !( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a> )</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        &amp;&amp; !( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> == <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afdd3a8eb3032c0124c1c43dec883b670">TILE_CATEGORY::MONSTER</a> ) ) {</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        rota = 0;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    }</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160; </div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> loc_rand = 0;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <span class="comment">// only bother mixing up a hash/random value if the tile has some sprites to randomly pick</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="comment">// between</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="keywordflow">if</span>( display_tile.<a class="code" href="structtile__type.html#a35bb6574422477b93e5b447fb16d4cfb">fg</a>.<a class="code" href="structweighted__list.html#a05d7ee6620edd859f0f35a7c4f69027f">size</a>() &gt; 1 || display_tile.<a class="code" href="structtile__type.html#a0cbe74ee58be622d2e5399a791ae3efe">bg</a>.<a class="code" href="structweighted__list.html#a05d7ee6620edd859f0f35a7c4f69027f">size</a>() &gt; 1 ) {</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> rot32 = []( <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x, <span class="keyword">const</span> <span class="keywordtype">int</span> k ) {</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;            <span class="keywordflow">return</span> ( x &lt;&lt; k ) | ( x &gt;&gt; ( 32 - k ) );</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        };</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        <span class="comment">// use a fair mix function to turn the &quot;random&quot; seed into a random int</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;        <span class="comment">// taken from public domain code at http://burtleburtle.net/bob/c/lookup3.c 2015/12/11</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a>;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> = -<a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a>;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> = <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a> * <a class="code" href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">seed</a>;</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> ^= <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a>;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> -= rot32( <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a>, 14 );</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> ^= <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a>;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> -= rot32( <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a>, 11 );</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> ^= <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> -= rot32( <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, 25 );</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> ^= <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a>;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> -= rot32( <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a>, 16 );</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> ^= <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a>;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> -= rot32( <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a>, 4 );</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> ^= <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> -= rot32( <a class="code" href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, 14 );</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> ^= <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a>;</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> -= rot32( <a class="code" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a>, 24 );</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        loc_rand = <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a>;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160; </div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        <span class="comment">// idle tile animations:</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        <span class="keywordflow">if</span>( display_tile.<a class="code" href="structtile__type.html#a96b2abd5f9ca94ab686a7e3d08e6adc7">animated</a> ) {</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;            <span class="comment">// idle animations run during the user&#39;s turn, and the animation speed</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;            <span class="comment">// needs to be defined by the tileset to look good, so we use system clock:</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;            std::chrono::steady_clock::time_point now = std::chrono::steady_clock::now();</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            <span class="keyword">auto</span> now_ms = std::chrono::time_point_cast&lt;std::chrono::milliseconds&gt;( now );</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            std::chrono::milliseconds value = now_ms.time_since_epoch();</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            <span class="comment">// aiming roughly at the standard 60 frames per second:</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;            <span class="keywordtype">int</span> animation_frame = value.count() / 17;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;            <span class="comment">// offset by log_rand so that everything does not blink at the same time:</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;            animation_frame += loc_rand;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;            <span class="keywordtype">int</span> frames_in_loop = display_tile.<a class="code" href="structtile__type.html#a35bb6574422477b93e5b447fb16d4cfb">fg</a>.<a class="code" href="structweighted__list.html#a23a0eb0640d5aacb0fae74940d2864bd">get_weight</a>();</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;            <span class="keywordflow">if</span>( frames_in_loop == 1 ) {</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                frames_in_loop = display_tile.<a class="code" href="structtile__type.html#a0cbe74ee58be622d2e5399a791ae3efe">bg</a>.<a class="code" href="structweighted__list.html#a23a0eb0640d5aacb0fae74940d2864bd">get_weight</a>();</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;            }</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;            <span class="comment">// loc_rand is actually the weighed index of the selected tile, and</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;            <span class="comment">// for animations the &quot;weight&quot; is the number of frames to show the tile for:</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;            loc_rand = animation_frame % frames_in_loop;</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        }</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    }</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160; </div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    <span class="keywordflow">if</span>( ! <a class="code" href="cached__options_8cpp.html#afcb9eb2d0281d789f0f5b492c623b5fd">prevent_occlusion_retract</a> ) {</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;        retract = 0;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;    }</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="comment">//draw it!</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    draw_tile_at( display_tile, screen_pos, loc_rand, rota, ll,</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                  nv_color_active, retract, height_3d, offset );</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160; </div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;}</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160; </div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a270738a499079ff082921a6d81998388">cata_tiles::draw_sprite_at</a>(</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtile__type.html">tile_type</a> &amp;tile, <span class="keyword">const</span> <a class="code" href="structweighted__int__list.html">weighted_int_list</a>&lt;std::vector&lt;int&gt;&gt; &amp;svlist,</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;p, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> loc_rand, <span class="keywordtype">bool</span> rota_fg, <span class="keywordtype">int</span> rota, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll,</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    <span class="keywordtype">bool</span> apply_night_vision_goggles, <span class="keywordtype">int</span> retract, <span class="keywordtype">int</span> &amp;height_3d, <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;offset )</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;{</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <span class="keyword">const</span> std::vector&lt;int&gt; *picked = svlist.pick( loc_rand );</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    <span class="keywordflow">if</span>( !picked ) {</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    }</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="keyword">const</span> std::vector&lt;int&gt; &amp;spritelist = *picked;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    <span class="keywordflow">if</span>( spritelist.empty() ) {</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    }</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160; </div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = 0;</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <span class="comment">// blit foreground based on rotation</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="keywordtype">bool</span> rotate_sprite = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    <span class="keywordtype">int</span> sprite_num = 0;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <span class="keywordflow">if</span>( !rota_fg &amp;&amp; spritelist.size() == 1 ) {</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        <span class="comment">// don&#39;t rotate, a background tile without manual rotations</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        rotate_sprite = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;        sprite_num = 0;</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( spritelist.size() == 1 ) {</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;        <span class="comment">// just one tile, apply SDL sprite rotation if not in isometric mode</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;        rotate_sprite = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;        sprite_num = 0;</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;        <span class="comment">// multiple rotated tiles defined, don&#39;t apply sprite rotation after picking one</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        rotate_sprite = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        <span class="comment">// two tiles, tile 0 is N/S, tile 1 is E/W</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        <span class="comment">// four tiles, 0=N, 1=E, 2=S, 3=W</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        <span class="comment">// extending this to more than 4 rotated tiles will require changing rota to degrees</span></div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        sprite_num = rota % spritelist.size();</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    }</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160; </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> sprite_index = spritelist[sprite_num];</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <span class="keyword">const</span> <a class="code" href="classtexture.html">texture</a> *sprite_tex = tileset_ptr-&gt;get_tile( sprite_index );</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160; </div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <span class="comment">//use night vision colors when in use</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <span class="comment">//then use low light tile if available</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <span class="keywordflow">if</span>( ll == <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c">lit_level::MEMORIZED</a> ) {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        <span class="keywordflow">if</span>( <span class="keyword">const</span> <a class="code" href="classtexture.html">texture</a> *ptr = tileset_ptr-&gt;get_memory_tile( sprite_index ) ) {</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            sprite_tex = ptr;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        }</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( apply_night_vision_goggles ) {</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        <span class="keywordflow">if</span>( ll != <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a41bc94cbd8eebea13ce0491b2ac11b88">lit_level::LOW</a> ) {</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;            <span class="keywordflow">if</span>( <span class="keyword">const</span> <a class="code" href="classtexture.html">texture</a> *ptr = tileset_ptr-&gt;get_overexposed_tile( sprite_index ) ) {</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                sprite_tex = ptr;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;            }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;            <span class="keywordflow">if</span>( <span class="keyword">const</span> <a class="code" href="classtexture.html">texture</a> *ptr = tileset_ptr-&gt;get_night_tile( sprite_index ) ) {</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                sprite_tex = ptr;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;            }</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        }</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ll == <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a41bc94cbd8eebea13ce0491b2ac11b88">lit_level::LOW</a> ) {</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        <span class="keywordflow">if</span>( <span class="keyword">const</span> <a class="code" href="classtexture.html">texture</a> *ptr = tileset_ptr-&gt;get_shadow_tile( sprite_index ) ) {</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;            sprite_tex = ptr;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        }</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    }</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160; </div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <span class="keywordtype">int</span> width = 0;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <span class="keywordtype">int</span> height = 0;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    std::tie( width, height ) = sprite_tex-&gt;<a class="code" href="classtexture.html#aeec5e98968dbd7b9563f4217dbda5368">dimension</a>();</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160; </div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;tile_offset = retract &lt;= 0</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;                               ? tile.<a class="code" href="structtile__type.html#ac90d8d872e121c75ff8c1261c7bf0dd2">offset</a></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;                               : ( retract &gt;= 100</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                                   ? tile.<a class="code" href="structtile__type.html#a31339fa61963ae8bc47b29ebe2e865c9">offset_retracted</a></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;                                   : tile.<a class="code" href="structtile__type.html#ac90d8d872e121c75ff8c1261c7bf0dd2">offset</a></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                                   + ( ( tile.<a class="code" href="structtile__type.html#a31339fa61963ae8bc47b29ebe2e865c9">offset_retracted</a> - tile.<a class="code" href="structtile__type.html#ac90d8d872e121c75ff8c1261c7bf0dd2">offset</a> ) * retract ) / 100</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                                 );</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    SDL_Rect destination;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <span class="comment">// Using divide_round_down because the offset might be negative.</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    destination.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> = p.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> + <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( ( tile_offset.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> + offset.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> ) * tile_width,</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                    tileset_ptr-&gt;get_tile_width() );</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    destination.y = p.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> + <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( ( tile_offset.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> + offset.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> - height_3d ) * tile_width,</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                    tileset_ptr-&gt;get_tile_width() );</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    destination.w = width * tile_width * tile.<a class="code" href="structtile__type.html#ab75d45791aefe26d2f20f992ec64318a">pixelscale</a> / tileset_ptr-&gt;get_tile_width();</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    destination.h = height * <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> * tile.<a class="code" href="structtile__type.html#ab75d45791aefe26d2f20f992ec64318a">pixelscale</a> / tileset_ptr-&gt;get_tile_height();</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160; </div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="keywordflow">if</span>( rotate_sprite ) {</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        <span class="keywordflow">if</span>( rota == -1 ) {</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;            <span class="comment">// flip horizontally</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;            <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = sprite_tex-&gt;<a class="code" href="classtexture.html#abe01180582ee52b049d77e0ab39380af">render_copy_ex</a>(</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                      renderer, &amp;destination, 0, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                      <span class="keyword">static_cast&lt;</span>SDL_RendererFlip<span class="keyword">&gt;</span>( SDL_FLIP_HORIZONTAL ) );</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;            <span class="keywordflow">switch</span>( rota % 4 ) {</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                    <span class="comment">// unrotated (and 180, with just two sprites)</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                    <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = sprite_tex-&gt;<a class="code" href="classtexture.html#abe01180582ee52b049d77e0ab39380af">render_copy_ex</a>( renderer, &amp;destination, 0, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                                                      SDL_FLIP_NONE );</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                    <span class="comment">// 90 degrees (and 270, with just two sprites)</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;<span class="preprocessor">#if defined(_WIN32) &amp;&amp; defined(CROSS_LINUX)</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                    <span class="comment">// For an unknown reason, additional offset is required in direct3d mode</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                    <span class="comment">// for cross-compilation from Linux to Windows</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                    <span class="keywordflow">if</span>( <a class="code" href="cached__options_8cpp.html#a8fd66fb8f4480123fcacdd4c3631e0d0">direct3d_mode</a> ) {</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                        destination.y -= 1;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                    }</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                    <span class="keywordflow">if</span>( !is_isometric() ) {</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                        <span class="comment">// never rotate isometric tiles</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                        <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = sprite_tex-&gt;<a class="code" href="classtexture.html#abe01180582ee52b049d77e0ab39380af">render_copy_ex</a>( renderer, &amp;destination, -90, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                                                          SDL_FLIP_NONE );</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;                        <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = sprite_tex-&gt;<a class="code" href="classtexture.html#abe01180582ee52b049d77e0ab39380af">render_copy_ex</a>( renderer, &amp;destination, 0, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                                                          SDL_FLIP_NONE );</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                    }</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                    <span class="comment">// 180 degrees, implemented with flips instead of rotation</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                    <span class="keywordflow">if</span>( !is_isometric() ) {</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                        <span class="comment">// never flip isometric tiles vertically</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                        <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = sprite_tex-&gt;<a class="code" href="classtexture.html#abe01180582ee52b049d77e0ab39380af">render_copy_ex</a>(</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                                  renderer, &amp;destination, 0, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                                  <span class="keyword">static_cast&lt;</span>SDL_RendererFlip<span class="keyword">&gt;</span>( SDL_FLIP_HORIZONTAL | SDL_FLIP_VERTICAL ) );</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;                        <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = sprite_tex-&gt;<a class="code" href="classtexture.html#abe01180582ee52b049d77e0ab39380af">render_copy_ex</a>( renderer, &amp;destination, 0, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;                                                          SDL_FLIP_NONE );</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                    }</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;                    <span class="comment">// 270 degrees</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;<span class="preprocessor">#if defined(_WIN32) &amp;&amp; defined(CROSS_LINUX)</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;                    <span class="comment">// For an unknown reason, additional offset is required in direct3d mode</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                    <span class="comment">// for cross-compilation from Linux to Windows</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                    <span class="keywordflow">if</span>( <a class="code" href="cached__options_8cpp.html#a8fd66fb8f4480123fcacdd4c3631e0d0">direct3d_mode</a> ) {</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                        destination.x -= 1;</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                    }</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                    <span class="keywordflow">if</span>( !is_isometric() ) {</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                        <span class="comment">// never rotate isometric tiles</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                        <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = sprite_tex-&gt;<a class="code" href="classtexture.html#abe01180582ee52b049d77e0ab39380af">render_copy_ex</a>( renderer, &amp;destination, 90, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                                                          SDL_FLIP_NONE );</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                        <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = sprite_tex-&gt;<a class="code" href="classtexture.html#abe01180582ee52b049d77e0ab39380af">render_copy_ex</a>( renderer, &amp;destination, 0, <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                                                          SDL_FLIP_NONE );</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                    }</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;            }</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        }</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <span class="comment">// don&#39;t rotate, same as case 0 above</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = sprite_tex-&gt;<a class="code" href="classtexture.html#abe01180582ee52b049d77e0ab39380af">render_copy_ex</a>( renderer, &amp;destination, 0, <span class="keyword">nullptr</span>, SDL_FLIP_NONE );</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    }</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160; </div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <a class="code" href="sdl__wrappers_8h.html#a7eb7cd1483cf633af1ca578070fd654e">printErrorIf</a>( <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> != 0, <span class="stringliteral">&quot;SDL_RenderCopyEx() failed&quot;</span> );</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <span class="comment">// this reference passes all the way back up the call chain back to</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    <span class="comment">// cata_tiles::draw() here.draw_points_cache[z][row][col].com.height_3d</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    <span class="comment">// where we are accumulating the height of every sprite stacked up in a tile</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    height_3d += tile.<a class="code" href="structtile__type.html#afda60888f095bae6ba9bbdd657039d2b">height_3d</a>;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;}</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160; </div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a201af5ee04216f2b1c35cf197ae34f91">cata_tiles::draw_tile_at</a>(</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtile__type.html">tile_type</a> &amp;tile, <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;p, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> loc_rand, <span class="keywordtype">int</span> rota,</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">bool</span> apply_night_vision_goggles, <span class="keywordtype">int</span> retract, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;offset )</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;{</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    <span class="keywordtype">int</span> fake_int = height_3d;</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    draw_sprite_at( tile, tile.<a class="code" href="structtile__type.html#a0cbe74ee58be622d2e5399a791ae3efe">bg</a>, p, loc_rand, <span class="comment">/*fg:*/</span> <span class="keyword">false</span>, rota, ll,</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;                    apply_night_vision_goggles, retract, fake_int, offset );</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    draw_sprite_at( tile, tile.<a class="code" href="structtile__type.html#a35bb6574422477b93e5b447fb16d4cfb">fg</a>, p, loc_rand, <span class="comment">/*fg:*/</span> <span class="keyword">true</span>, rota, ll,</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;                    apply_night_vision_goggles, retract, height_3d, offset );</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;}</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160; </div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a648ab890b9dec665f94242f839194016">cata_tiles::would_apply_vision_effects</a>( <span class="keyword">const</span> <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92e">visibility_type</a> visibility )<span class="keyword"> const</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <span class="keywordflow">return</span> visibility != <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92ea813461e0c58e7ad59a2fd83ca2237fec">visibility_type::CLEAR</a>;</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;}</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160; </div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#ae96aed69d598add62714e60497457701">cata_tiles::apply_vision_effects</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>,</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92e">visibility_type</a> visibility,</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                                       <span class="keywordtype">int</span> &amp;height_3d )</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;{</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <span class="keywordflow">if</span>( !would_apply_vision_effects( visibility ) ) {</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    }</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    std::string light_name;</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    <span class="keywordflow">switch</span>( visibility ) {</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92ea347e628a8f72626a0611ef842fe9d304">visibility_type::HIDDEN</a>:</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;            light_name = <span class="stringliteral">&quot;lighting_hidden&quot;</span>;</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92eaa4e36ae36e52be95ee5c8d2bc974dfd8">visibility_type::LIT</a>:</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;            light_name = <span class="stringliteral">&quot;lighting_lowlight_light&quot;</span>;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92eae8e4aa962e8efae537d18456fa7b49ab">visibility_type::BOOMER</a>:</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;            light_name = <span class="stringliteral">&quot;lighting_boomered_light&quot;</span>;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92eaed63a54298847d9f23d13f422561be4d">visibility_type::BOOMER_DARK</a>:</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;            light_name = <span class="stringliteral">&quot;lighting_boomered_dark&quot;</span>;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92eaacaef50d33fc86532c260a045c672f3e">visibility_type::DARK</a>:</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;            light_name = <span class="stringliteral">&quot;lighting_lowlight_dark&quot;</span>;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92ea813461e0c58e7ad59a2fd83ca2237fec">visibility_type::CLEAR</a>:</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;            <span class="comment">// should never happen</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    }</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    <span class="comment">// lighting is never rotated, though, could possibly add in random rotation?</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    draw_from_id_string( light_name, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a8b1aa4726295b67f4ca299670037daeb">TILE_CATEGORY::LIGHTING</a>, empty_string, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0, 0,</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                         <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160; </div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;}</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160; </div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a078062c1314e92a5e61db571e42254ed">cata_tiles::has_memory_at</a>( <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    <span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;mt = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>().<a class="code" href="classavatar.html#a73c5cdc86dbe8861397ac85d22122d12">get_memorized_tile</a>( p );</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    <span class="keywordflow">return</span> !mt.<a class="code" href="classmemorized__tile.html#ad34e31f323be7131a1075ae4528ea37d">get_ter_id</a>().empty() || !mt.<a class="code" href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">get_dec_id</a>().empty();</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;}</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;<span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;<a class="code" href="classcata__tiles.html#a1b44014fe7f2010a42e857df157312bd">cata_tiles::get_terrain_memory_at</a>( <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    <span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;mt = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>().<a class="code" href="classavatar.html#a73c5cdc86dbe8861397ac85d22122d12">get_memorized_tile</a>( p );</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    <span class="keywordflow">if</span>( !mt.<a class="code" href="classmemorized__tile.html#ad34e31f323be7131a1075ae4528ea37d">get_ter_id</a>().empty() ) {</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        <span class="keywordflow">return</span> mt;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    }</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structmm__submap.html#a05cadd6f8ed333dd6664feb0499b076d">mm_submap::default_tile</a>;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;}</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; </div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;<span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;<a class="code" href="classcata__tiles.html#a7bd15102861cd368a24b1dbf09c959c7">cata_tiles::get_furniture_memory_at</a>( <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;mt = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>().<a class="code" href="classavatar.html#a73c5cdc86dbe8861397ac85d22122d12">get_memorized_tile</a>( p );</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( mt.<a class="code" href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">get_dec_id</a>(), <span class="stringliteral">&quot;f_&quot;</span> ) ) {</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        <span class="keywordflow">return</span> mt;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    }</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structmm__submap.html#a05cadd6f8ed333dd6664feb0499b076d">mm_submap::default_tile</a>;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;}</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160; </div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;<a class="code" href="classcata__tiles.html#a5bc94323ca542f59e657d8fb50635e74">cata_tiles::get_trap_memory_at</a>( <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;mt = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>().<a class="code" href="classavatar.html#a73c5cdc86dbe8861397ac85d22122d12">get_memorized_tile</a>( p );</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( mt.<a class="code" href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">get_dec_id</a>(), <span class="stringliteral">&quot;tr_&quot;</span> ) ) {</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;        <span class="keywordflow">return</span> mt;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    }</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structmm__submap.html#a05cadd6f8ed333dd6664feb0499b076d">mm_submap::default_tile</a>;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;}</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160; </div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;<a class="code" href="classcata__tiles.html#a6e2d47bb4200116afcb941ff64e0c871">cata_tiles::get_vpart_memory_at</a>( <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;mt = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>().<a class="code" href="classavatar.html#a73c5cdc86dbe8861397ac85d22122d12">get_memorized_tile</a>( p );</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a>( mt.<a class="code" href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">get_dec_id</a>(), <span class="stringliteral">&quot;vp_&quot;</span> ) ) {</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;        <span class="keywordflow">return</span> mt;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    }</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structmm__submap.html#a05cadd6f8ed333dd6664feb0499b076d">mm_submap::default_tile</a>;</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;}</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160; </div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#afda1e45afc653a68ca19707ffdc893fd">cata_tiles::draw_square_below</a>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;p, <span class="keyword">const</span> <a class="code" href="classnc__color.html">nc_color</a> &amp;col, <span class="keyword">const</span> <span class="keywordtype">int</span> sizefactor )</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;{</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="keyword">const</span> SDL_Color sdlcol = <a class="code" href="sdl__utils_8h.html#a53204099dcec8ba4483731c8f2e2a853">curses_color_to_SDL</a>( col );</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    SDL_Rect sdlrect;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> screen = player_to_screen( p );</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        <span class="comment">// See comments in get_window_base_tile_counts for an explanation of tile width and height</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        <span class="comment">// tw / sizefactor * 3.0 / 4.0</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        sdlrect.w = ( tile_width * 3 ) / ( sizefactor * 4 );</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        <span class="keywordflow">if</span>( tile_width % 2 != sdlrect.w % 2 ) {</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;            sdlrect.w++;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;        }</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;        <span class="comment">// (tw / 2.0) / sizefactor * 3.0 / 4.0</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        sdlrect.h = ( tile_width * 3 ) / ( sizefactor * 8 );</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        <span class="keywordflow">if</span>( tile_width / 2 % 2 != sdlrect.h % 2 ) {</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;            sdlrect.h++;</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;        }</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;        <span class="comment">// scrx + (tw - rectw) / 2.0</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;        sdlrect.x = screen.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> + <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( tile_width - sdlrect.w, 2 );</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;        <span class="comment">// scry + th - tw / 2.0 + (tw / 2.0 - recth) / 2.0</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;        <span class="comment">// Adding th and subtracting tw/2 here to cancel out the shifting in player_to_screen.</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;        sdlrect.y = screen.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> + <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> + <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( -tile_width - sdlrect.h * 2, 4 );</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;        sdlrect.w = tile_width / sizefactor;</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;        <span class="keywordflow">if</span>( tile_width % 2 != sdlrect.w % 2 ) {</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;            sdlrect.w++;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        }</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        sdlrect.h = <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> / sizefactor;</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> % 2 != sdlrect.h % 2 ) {</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;            sdlrect.h++;</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;        }</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;        sdlrect.x = screen.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> + <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( tile_width - sdlrect.w, 2 );</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;        sdlrect.y = screen.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> + <a class="code" href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a>( <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> - sdlrect.h, 2 );</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    }</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    geometry-&gt;rect( renderer, sdlrect, sdlcol );</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;}</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160; </div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a31c24814415ed89650a7bb25e3fc66c0">cata_tiles::draw_terrain_below</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a>, <span class="keywordtype">int</span> &amp;,</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                                     <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;{</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    <span class="keywordflow">if</span>( memorize_only ) {</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    }</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160; </div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> low_override = draw_below_override.find( p );</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> low_overridden = low_override != draw_below_override.end();</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <span class="keywordflow">if</span>( low_overridden ? !low_override-&gt;second :</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        ( invisible[0] || here.<a class="code" href="classmap.html#aa7733dd145c213ee0b1f412b157ae331">dont_draw_lower_floor</a>( p ) ) ) {</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;    }</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160; </div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> pbelow = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">tripoint</a>( p.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>(), p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> - 1 );</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <a class="code" href="classnc__color.html">nc_color</a> col = <a class="code" href="color_8h.html#a5738d18ff9e165cca088a623cb1883ae">c_dark_gray</a>;</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160; </div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    <span class="keyword">const</span> <a class="code" href="structter__t.html">ter_t</a> &amp;curr_ter = here.<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( pbelow ).<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>();</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    <span class="keyword">const</span> <a class="code" href="structfurn__t.html">furn_t</a> &amp;curr_furn = here.<a class="code" href="classmap.html#af55e014aab791bbe4c8630361c1311dd">furn</a>( pbelow ).<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>();</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    <span class="keywordtype">int</span> part_below;</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <span class="keywordtype">int</span> sizefactor = 2;</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    <span class="keywordflow">if</span>( curr_furn.<a class="code" href="structmap__data__common__t.html#a630778707744fb147436b9aa0c370a7e">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054af2631f9535f52be23f6999592eed2608">ter_furn_flag::TFLAG_SEEN_FROM_ABOVE</a> ) || curr_furn.<a class="code" href="structmap__data__common__t.html#aa6eb23c1a5d8e89d877880f9aaf32eb6">movecost</a> &lt; 0 ) {</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;        col = curr_furn.<a class="code" href="structmap__data__common__t.html#aa7c0e4d48398517e30f167b5f2582664">color</a>();</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <span class="keyword">const</span> <a class="code" href="classvehicle.html">vehicle</a> *veh = here.<a class="code" href="classmap.html#ab822562ab4d1069ff53486f67098d0da">veh_at_internal</a>( pbelow, part_below ) ) {</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> roof = veh-&gt;<a class="code" href="classvehicle.html#a898e68c15af3168bb84a22a71a454c70">roof_at_part</a>( part_below );</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> vpobst = <a class="code" href="classvpart__position.html">vpart_position</a>( <span class="keyword">const_cast&lt;</span><a class="code" href="classvehicle.html">vehicle</a> &amp;<span class="keyword">&gt;</span>( *veh ),</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                                            part_below ).<a class="code" href="classvpart__position.html#a3888b23941b14d5931801b7afe3e3eb8">obstacle_at_part</a>();</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        col = ( roof &gt;= 0 || vpobst ) ? <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> : <a class="code" href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a>;</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        sizefactor = ( roof &gt;= 0 || vpobst ) ? 4 : 2;</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( curr_ter.<a class="code" href="structmap__data__common__t.html#a630778707744fb147436b9aa0c370a7e">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054af2631f9535f52be23f6999592eed2608">ter_furn_flag::TFLAG_SEEN_FROM_ABOVE</a> ) ||</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;               curr_ter.<a class="code" href="structmap__data__common__t.html#a630778707744fb147436b9aa0c370a7e">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054af607730a38ff7975c6724b22881e0e58">ter_furn_flag::TFLAG_NO_FLOOR</a> ) ||</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;               curr_ter.<a class="code" href="structmap__data__common__t.html#a630778707744fb147436b9aa0c370a7e">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ad07116a9d172192917b9e8fda1230c83">ter_furn_flag::TFLAG_NO_FLOOR_WATER</a> ) ||</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;               curr_ter.<a class="code" href="structmap__data__common__t.html#aa6eb23c1a5d8e89d877880f9aaf32eb6">movecost</a> == 0 ) {</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;        col = curr_ter.<a class="code" href="structmap__data__common__t.html#aa7c0e4d48398517e30f167b5f2582664">color</a>();</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        sizefactor = 4;</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;        col = curr_ter.<a class="code" href="structmap__data__common__t.html#aa7c0e4d48398517e30f167b5f2582664">color</a>();</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    }</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160; </div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;    draw_square_below( pbelow.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>(), col, sizefactor );</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;}</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160; </div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a6b8c080c92c765f22391fdbd5ab48724">cata_tiles::draw_terrain</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;                               <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;{</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <span class="keyword">override</span> = terrain_override.find( p );</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> overridden = <span class="keyword">override</span> != terrain_override.end();</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    <span class="keywordtype">bool</span> neighborhood_overridden = overridden;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <span class="keywordflow">if</span>( !neighborhood_overridden ) {</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;dir : <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> ) {</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;            <span class="keywordflow">if</span>( terrain_override.find( p + dir ) != terrain_override.end() ) {</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                neighborhood_overridden = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;            }</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        }</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    }</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    <span class="comment">// first memorize the actual terrain</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__id.html">ter_id</a> &amp;t = here.<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( p );</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    <span class="keyword">const</span> std::string &amp;<a class="code" href="namespacetname.html">tname</a> = t.<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    <span class="comment">// Legacy mode does not draw fog sprites</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="cached__options_8cpp.html#a0cb65464a3fa34c1ed5474f5d2d853a7">fov_3d_z_range</a> == 0 &amp;&amp; <a class="code" href="namespacetname.html">tname</a> == <span class="stringliteral">&quot;t_open_air&quot;</span> ) {</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    }</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    <span class="keywordflow">if</span>( t &amp;&amp; !invisible[0] ) {</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;        <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;<a class="code" href="structconnect__group.html">connect_group</a> = t.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmap__data__common__t.html#adebdc5c7e1aefaa0348f7905a338e430">connect_to_groups</a>;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;        <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;rotate_group = t.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmap__data__common__t.html#a6e0ca587a62b2ec09c314fd8ea40ea09">rotate_to_groups</a>;</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160; </div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="structconnect__group.html">connect_group</a>.any() ) {</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;            get_connect_values( p, subtile, rotation, <a class="code" href="structconnect__group.html">connect_group</a>, rotate_group, {} );</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;            <span class="comment">// re-memorize previously seen terrain in case new connections have been seen</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;            here.<a class="code" href="classmap.html#af15de9578c0dfbe9450b890bca66d543">memory_cache_ter_set_dirty</a>( p, <span class="keyword">true</span> );</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;            get_terrain_orientation( p, rotation, subtile, {}, invisible, rotate_group );</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;            <span class="comment">// do something to get other terrain orientation values</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;        }</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a4f75e26115ded774817aa501d09c715d">memory_cache_ter_is_dirty</a>( p ) ) {</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;            <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>().<a class="code" href="classavatar.html#ab19cabc9e315ac018646a3b49d26bdf0">memorize_terrain</a>( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ), <a class="code" href="namespacetname.html">tname</a>, subtile, rotation );</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        }</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;        <span class="comment">// draw the actual terrain if there&#39;s no override</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;        <span class="keywordflow">if</span>( !neighborhood_overridden ) {</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;                   ? false</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;                   : draw_from_id_string( <a class="code" href="namespacetname.html">tname</a>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32">TILE_CATEGORY::TERRAIN</a>, empty_string, p, subtile,</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;                                          rotation, ll, nv_goggles_activated, height_3d );</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;        }</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    }</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="keywordflow">if</span>( invisible[0] ? overridden : neighborhood_overridden ) {</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;        <span class="comment">// and then draw the override terrain</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        <span class="keyword">const</span> <a class="code" href="classint__id.html">ter_id</a> &amp;t2 = overridden ? <span class="keyword">override</span>-&gt;second : t;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        <span class="keywordflow">if</span>( t2 ) {</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;            <span class="comment">// both the current and neighboring overrides may change the appearance</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;            <span class="comment">// of the tile, so always re-calculate it.</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;            <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;            <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;            <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;<a class="code" href="structconnect__group.html">connect_group</a> = t2.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmap__data__common__t.html#adebdc5c7e1aefaa0348f7905a338e430">connect_to_groups</a>;</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;            <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;rotate_group = t2.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmap__data__common__t.html#a6e0ca587a62b2ec09c314fd8ea40ea09">rotate_to_groups</a>;</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160; </div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="structconnect__group.html">connect_group</a>.any() ) {</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;                get_connect_values( p, subtile, rotation, <a class="code" href="structconnect__group.html">connect_group</a>, rotate_group, terrain_override );</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;                get_terrain_orientation( p, rotation, subtile, terrain_override, invisible, rotate_group );</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;            }</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;            <span class="keyword">const</span> std::string &amp;<a class="code" href="namespacetname.html">tname</a> = t2.<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;            <span class="comment">// tile overrides are never memorized</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;            <span class="comment">// tile overrides are always shown with full visibility</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;            <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> lit = overridden ? <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a> : ll;</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> nv = overridden ? false : nv_goggles_activated;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;                   ? false</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;                   : draw_from_id_string( <a class="code" href="namespacetname.html">tname</a>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32">TILE_CATEGORY::TERRAIN</a>, empty_string, p, subtile,</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;                                          rotation, lit, nv, height_3d );</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        }</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( invisible[0] ) {</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;        <span class="comment">// try drawing memory if invisible and not overridden</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;mt = get_terrain_memory_at( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ) );</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        <span class="keywordflow">if</span>( !mt.<a class="code" href="classmemorized__tile.html#ad34e31f323be7131a1075ae4528ea37d">get_ter_id</a>().empty() ) {</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                   ? false</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                   : draw_from_id_string(</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;                       mt.<a class="code" href="classmemorized__tile.html#ad34e31f323be7131a1075ae4528ea37d">get_ter_id</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32">TILE_CATEGORY::TERRAIN</a>, empty_string, p, mt.<a class="code" href="classmemorized__tile.html#a3403109e5b4f6107c602ee1a970ccf44">get_ter_subtile</a>(),</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;                       mt.<a class="code" href="classmemorized__tile.html#ae7de9207ae58c9bb5f65a1d168880396">get_ter_rotation</a>(), <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c">lit_level::MEMORIZED</a>, nv_goggles_activated, height_3d );</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;        }</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    }</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;}</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160; </div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#ab8a53ea1dd3d0ec554735b625cfc2558">cata_tiles::draw_furniture</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;                                 <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;{</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <a class="code" href="classavatar.html">avatar</a> &amp;you = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>();</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <span class="keyword">override</span> = furniture_override.find( p );</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> overridden = <span class="keyword">override</span> != furniture_override.end();</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <span class="keywordtype">bool</span> neighborhood_overridden = overridden;</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;    <span class="keywordflow">if</span>( !neighborhood_overridden ) {</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;dir : <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> ) {</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;            <span class="keywordflow">if</span>( furniture_override.find( p + dir ) != furniture_override.end() ) {</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;                neighborhood_overridden = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;            }</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;        }</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    }</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;    <span class="comment">// first memorize the actual furniture</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__id.html">furn_id</a> &amp;f = here.<a class="code" href="classmap.html#af55e014aab791bbe4c8630361c1311dd">furn</a>( p );</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;    <span class="keywordflow">if</span>( f &amp;&amp; !invisible[0] ) {</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <span class="keyword">const</span> std::array&lt;int, 4&gt; <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> = {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( here.<a class="code" href="classmap.html#af55e014aab791bbe4c8630361c1311dd">furn</a>( p + <a class="code" href="point_8h.html#a702e673ec0d39d0822e2dc453a6af3e5">point_south</a> ) ),</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( here.<a class="code" href="classmap.html#af55e014aab791bbe4c8630361c1311dd">furn</a>( p + <a class="code" href="point_8h.html#aff73fd5bf470a3db5291c5dec855bb71">point_east</a> ) ),</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( here.<a class="code" href="classmap.html#af55e014aab791bbe4c8630361c1311dd">furn</a>( p + <a class="code" href="point_8h.html#a0acd5e182489265fadc8c586f5d4d701">point_west</a> ) ),</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( here.<a class="code" href="classmap.html#af55e014aab791bbe4c8630361c1311dd">furn</a>( p + <a class="code" href="point_8h.html#acfe3d4a2977589c0adad45cf36774d8a">point_north</a> ) )</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        };</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;<a class="code" href="structconnect__group.html">connect_group</a> = f.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmap__data__common__t.html#adebdc5c7e1aefaa0348f7905a338e430">connect_to_groups</a>;</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;rotate_group = f.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmap__data__common__t.html#a6e0ca587a62b2ec09c314fd8ea40ea09">rotate_to_groups</a>;</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160; </div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="structconnect__group.html">connect_group</a>.any() ) {</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;            get_furn_connect_values( p, subtile, rotation, <a class="code" href="structconnect__group.html">connect_group</a>, rotate_group, {} );</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;            get_tile_values_with_ter( p, f.<a class="code" href="classint__id.html#a99e80dcc802865c122fc1dfd8db8fc85">to_i</a>(), <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>, subtile, rotation, rotate_group );</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;        }</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;        <span class="keyword">const</span> std::string &amp;fname = f.<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;        <span class="keywordflow">if</span>( !( you.<a class="code" href="classavatar.html#a3fe7bbe225126bee662ce6127526cdfb">get_grab_type</a>() == <a class="code" href="enums_8h.html#a805138f2fff55cebf7ad4bc2b49f1f71a479a2f961e7db58cfe3291ea257d432a">object_type::FURNITURE</a></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;               &amp;&amp; p == you.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() + you.<a class="code" href="classCharacter.html#ac033cd38ee98900bb08eb196c674aa55">grab_point</a> )</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;            &amp;&amp; here.<a class="code" href="classmap.html#a8ce6b6f4cacf6410ecb6b407bf61884e">memory_cache_dec_is_dirty</a>( p ) ) {</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;            you.<a class="code" href="classavatar.html#a3f93e313b981c8a9a70f651d3cd4bbf3">memorize_decoration</a>( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ), fname, subtile, rotation );</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;        }</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        <span class="comment">// draw the actual furniture if there&#39;s no override</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;        <span class="keywordflow">if</span>( !neighborhood_overridden ) {</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                   ? false</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;                   : draw_from_id_string( fname, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a479a2f961e7db58cfe3291ea257d432a">TILE_CATEGORY::FURNITURE</a>, empty_string, p, subtile,</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                                          rotation, ll, nv_goggles_activated, height_3d );</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;        }</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    }</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <span class="keywordflow">if</span>( invisible[0] ? overridden : neighborhood_overridden ) {</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        <span class="comment">// and then draw the override furniture</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;        <span class="keyword">const</span> <a class="code" href="classint__id.html">furn_id</a> &amp;<a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7a4685304075364415da67c818580343f9">f2</a> = overridden ? <span class="keyword">override</span>-&gt;second : f;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7a4685304075364415da67c818580343f9">f2</a> ) {</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;            <span class="comment">// both the current and neighboring overrides may change the appearance</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;            <span class="comment">// of the tile, so always re-calculate it.</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> furn = [&amp;]( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp; q, <span class="keyword">const</span> <span class="keywordtype">bool</span> invis ) -&gt; <a class="code" href="classint__id.html">furn_id</a> {</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> it = furniture_override.find( q );</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                <span class="keywordflow">return</span> it != furniture_override.end() ? it-&gt;second :</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                ( !overridden || !invis ) ? here.<a class="code" href="classmap.html#af55e014aab791bbe4c8630361c1311dd">furn</a>( q ) : <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">furn_str_id::NULL_ID</a>().<a class="code" href="classstring__id.html#aa3cde2bfb58efa9621289c0a70d24c5a">id</a>();</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;            };</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;            <span class="keyword">const</span> std::array&lt;int, 4&gt; <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> = {</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( furn( p + <a class="code" href="point_8h.html#a702e673ec0d39d0822e2dc453a6af3e5">point_south</a>, invisible[1] ) ),</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( furn( p + <a class="code" href="point_8h.html#aff73fd5bf470a3db5291c5dec855bb71">point_east</a>, invisible[2] ) ),</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( furn( p + <a class="code" href="point_8h.html#a0acd5e182489265fadc8c586f5d4d701">point_west</a>, invisible[3] ) ),</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( furn( p + <a class="code" href="point_8h.html#acfe3d4a2977589c0adad45cf36774d8a">point_north</a>, invisible[4] ) )</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;            };</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;            <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;            <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;            <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;<a class="code" href="structconnect__group.html">connect_group</a> = f.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmap__data__common__t.html#adebdc5c7e1aefaa0348f7905a338e430">connect_to_groups</a>;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;            <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;rotate_group = f.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structmap__data__common__t.html#a6e0ca587a62b2ec09c314fd8ea40ea09">rotate_to_groups</a>;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160; </div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="structconnect__group.html">connect_group</a>.any() ) {</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;                get_furn_connect_values( p, subtile, rotation, <a class="code" href="structconnect__group.html">connect_group</a>, rotate_group, {} );</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;                get_tile_values_with_ter( p, f.<a class="code" href="classint__id.html#a99e80dcc802865c122fc1dfd8db8fc85">to_i</a>(), <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>, subtile, rotation, rotate_group );</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;            }</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;            get_tile_values_with_ter( p, <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7a4685304075364415da67c818580343f9">f2</a>.to_i(), <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>, subtile, rotation, 0 );</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;            <span class="keyword">const</span> std::string &amp;fname = <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7a4685304075364415da67c818580343f9">f2</a>.id().str();</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;            <span class="comment">// tile overrides are never memorized</span></div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;            <span class="comment">// tile overrides are always shown with full visibility</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;            <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> lit = overridden ? <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a> : ll;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> nv = overridden ? false : nv_goggles_activated;</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;                   ? false</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;                   : draw_from_id_string( fname, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a479a2f961e7db58cfe3291ea257d432a">TILE_CATEGORY::FURNITURE</a>, empty_string, p, subtile,</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;                                          rotation, lit, nv, height_3d );</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        }</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( invisible[0] ) {</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;        <span class="comment">// try drawing memory if invisible and not overridden</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;mt = get_furniture_memory_at( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ) );</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        <span class="keywordflow">if</span>( !mt.<a class="code" href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">get_dec_id</a>().empty() ) {</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;                   ? false</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;                   : draw_from_id_string(</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;                       mt.<a class="code" href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">get_dec_id</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a479a2f961e7db58cfe3291ea257d432a">TILE_CATEGORY::FURNITURE</a>, empty_string, p, mt.<a class="code" href="classmemorized__tile.html#ac8ef0ca7edfe6fb2bf3679bfe8399ba8">get_dec_subtile</a>(),</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;                       mt.<a class="code" href="classmemorized__tile.html#af9bf337c3d4d23e0a2c67ae5404bba0e">get_dec_rotation</a>(), <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c">lit_level::MEMORIZED</a>, nv_goggles_activated, height_3d );</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;        }</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    }</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;}</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160; </div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a4ef5afe9f52c7e10a08e8c37864f0459">cata_tiles::draw_trap</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;                            <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;{</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <span class="keyword">override</span> = trap_override.find( p );</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> overridden = <span class="keyword">override</span> != trap_override.end();</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="keywordtype">bool</span> neighborhood_overridden = overridden;</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    <span class="keywordflow">if</span>( !neighborhood_overridden ) {</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;dir : <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> ) {</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;            <span class="keywordflow">if</span>( trap_override.find( p + dir ) != trap_override.end() ) {</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;                neighborhood_overridden = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;            }</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        }</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;    }</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160; </div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;    <a class="code" href="classavatar.html">avatar</a> &amp;you = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>();</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    <span class="comment">// first memorize the actual trap</span></div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtrap.html">trap</a> &amp;tr = here.<a class="code" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( p );</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    <span class="keywordflow">if</span>( !tr.<a class="code" href="structtrap.html#a6a9ac96c5c81eb31093e049ffeac8b4f">is_null</a>() &amp;&amp; !invisible[0] &amp;&amp; tr.<a class="code" href="structtrap.html#abeb5ff27f9f78475035f22aabdcfe834">can_see</a>( p, you ) ) {</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;        <span class="keyword">const</span> std::array&lt;int, 4&gt; <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> = {</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( here.<a class="code" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( p + <a class="code" href="point_8h.html#a702e673ec0d39d0822e2dc453a6af3e5">point_south</a> ).<a class="code" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a> ),</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( here.<a class="code" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( p + <a class="code" href="point_8h.html#aff73fd5bf470a3db5291c5dec855bb71">point_east</a> ).<a class="code" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a> ),</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( here.<a class="code" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( p + <a class="code" href="point_8h.html#a0acd5e182489265fadc8c586f5d4d701">point_west</a> ).<a class="code" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a> ),</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;            <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( here.<a class="code" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( p + <a class="code" href="point_8h.html#acfe3d4a2977589c0adad45cf36774d8a">point_north</a> ).<a class="code" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a> )</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        };</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;        <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;        get_tile_values( tr.<a class="code" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a>.<a class="code" href="classint__id.html#a99e80dcc802865c122fc1dfd8db8fc85">to_i</a>(), <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>, subtile, rotation, 0 );</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;        <span class="keyword">const</span> std::string trname = tr.<a class="code" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a>.<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a8ce6b6f4cacf6410ecb6b407bf61884e">memory_cache_dec_is_dirty</a>( p ) ) {</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;            you.<a class="code" href="classavatar.html#a3f93e313b981c8a9a70f651d3cd4bbf3">memorize_decoration</a>( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ), trname, subtile, rotation );</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;        }</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        <span class="comment">// draw the actual trap if there&#39;s no override</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        <span class="keywordflow">if</span>( !neighborhood_overridden ) {</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;                   ? false</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;                   : draw_from_id_string( trname, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a26d3b291eb79dc52744a2ebb34004e97">TILE_CATEGORY::TRAP</a>, empty_string, p, subtile,</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;                                          rotation, ll, nv_goggles_activated, height_3d );</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        }</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    }</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    <span class="keywordflow">if</span>( overridden || ( !invisible[0] &amp;&amp; neighborhood_overridden &amp;&amp;</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;                        tr.<a class="code" href="structtrap.html#abeb5ff27f9f78475035f22aabdcfe834">can_see</a>( p, you ) ) ) {</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;        <span class="comment">// and then draw the override trap</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;        <span class="keyword">const</span> <a class="code" href="classint__id.html">trap_id</a> &amp;tr2 = overridden ? <span class="keyword">override</span>-&gt;second : tr.<a class="code" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a>;</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;        <span class="keywordflow">if</span>( tr2 ) {</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;            <span class="comment">// both the current and neighboring overrides may change the appearance</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;            <span class="comment">// of the tile, so always re-calculate it.</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> tr_at = [&amp;]( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp; q, <span class="keyword">const</span> <span class="keywordtype">bool</span> invis ) -&gt; <a class="code" href="classint__id.html">trap_id</a> {</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> it = trap_override.find( q );</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                <span class="keywordflow">return</span> it != trap_override.end() ? it-&gt;second :</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                ( !overridden || !invis ) ? here.<a class="code" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( q ).<a class="code" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a> : <a class="code" href="trap_8cpp.html#a7b8e40eb2b50e3841e2d9f2d0531226a">tr_null</a>;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;            };</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;            <span class="keyword">const</span> std::array&lt;int, 4&gt; <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> = {</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( tr_at( p + <a class="code" href="point_8h.html#a702e673ec0d39d0822e2dc453a6af3e5">point_south</a>, invisible[1] ) ),</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( tr_at( p + <a class="code" href="point_8h.html#aff73fd5bf470a3db5291c5dec855bb71">point_east</a>, invisible[2] ) ),</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( tr_at( p + <a class="code" href="point_8h.html#a0acd5e182489265fadc8c586f5d4d701">point_west</a>, invisible[3] ) ),</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( tr_at( p + <a class="code" href="point_8h.html#acfe3d4a2977589c0adad45cf36774d8a">point_north</a>, invisible[4] ) )</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;            };</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;            <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;            <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;            get_tile_values( tr2.<a class="code" href="classint__id.html#a99e80dcc802865c122fc1dfd8db8fc85">to_i</a>(), <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>, subtile, rotation, 0 );</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;            <span class="keyword">const</span> std::string &amp;trname = tr2.<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;            <span class="comment">// tile overrides are never memorized</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;            <span class="comment">// tile overrides are always shown with full visibility</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;            <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> lit = overridden ? <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a> : ll;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> nv = overridden ? false : nv_goggles_activated;</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                   ? false</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                   : draw_from_id_string( trname, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a26d3b291eb79dc52744a2ebb34004e97">TILE_CATEGORY::TRAP</a>, empty_string, p, subtile,</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                                          rotation, lit, nv, height_3d );</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;        }</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( invisible[0] ) {</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;        <span class="comment">// try drawing memory if invisible and not overridden</span></div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;mt = get_trap_memory_at( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ) );</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;        <span class="keywordflow">if</span>( !mt.<a class="code" href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">get_dec_id</a>().empty() ) {</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;                   ? false</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                   : draw_from_id_string(</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;                       mt.<a class="code" href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">get_dec_id</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a26d3b291eb79dc52744a2ebb34004e97">TILE_CATEGORY::TRAP</a>, empty_string, p, mt.<a class="code" href="classmemorized__tile.html#ac8ef0ca7edfe6fb2bf3679bfe8399ba8">get_dec_subtile</a>(), mt.<a class="code" href="classmemorized__tile.html#af9bf337c3d4d23e0a2c67ae5404bba0e">get_dec_rotation</a>(),</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                       <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c">lit_level::MEMORIZED</a>, nv_goggles_activated, height_3d );</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;        }</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    }</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;}</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160; </div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a51a7955aa4dacc5bb297285b27f752be">cata_tiles::draw_part_con</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                                <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;{</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <span class="comment">// FIXME: fix tripoint type</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a4dfba170dba1792376456ac2e6a6fd20">partial_con_at</a>( <a class="code" href="classcoords_1_1coord__point.html">tripoint_bub_ms</a>( p ) ) != <span class="keyword">nullptr</span> &amp;&amp; !invisible[0] ) {</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;        <a class="code" href="classavatar.html">avatar</a> &amp;you = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>();</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;        std::string <span class="keyword">const</span> &amp;trname = <a class="code" href="map_8cpp.html#a8fd90c11d7a509a3c0af0144cd1e0b12">tr_unfinished_construction</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();;</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a8ce6b6f4cacf6410ecb6b407bf61884e">memory_cache_dec_is_dirty</a>( p ) ) {</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;            you.<a class="code" href="classavatar.html#a3f93e313b981c8a9a70f651d3cd4bbf3">memorize_decoration</a>( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ), trname, 0, 0 );</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;        }</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;        <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;               ? false</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;               : draw_from_id_string( trname, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a26d3b291eb79dc52744a2ebb34004e97">TILE_CATEGORY::TRAP</a>, empty_string, p, 0,</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;                                      0, ll, nv_goggles_activated, height_3d );</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;    }</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;}</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160; </div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a99ee5b9130e7f84721f9acebc6ccafc3">cata_tiles::draw_graffiti</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;                                <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;{</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;    <span class="keywordflow">if</span>( memorize_only ) {</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;    }</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160; </div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <span class="keyword">override</span> = graffiti_override.find( p );</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> overridden = <span class="keyword">override</span> != graffiti_override.end();</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;    <span class="keywordflow">if</span>( overridden ? !override-&gt;second : ( invisible[0] || !here.<a class="code" href="classmap.html#a5ccfdc04bdc6f516d836502579aeac89">has_graffiti_at</a>( p ) ) ) {</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;    }</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> lit = overridden ? <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a> : ll;</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> rotation = here.<a class="code" href="classmap.html#af563dc2397e71a053569cb45c6bb7e77">passable</a>( p ) ? 1 : 0;</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;    <span class="keyword">const</span> std::string tile = <span class="stringliteral">&quot;graffiti_&quot;</span> +</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                             <a class="code" href="output_8cpp.html#a78f0928723504ed91d542c9090cd244d">to_upper_case</a>( <a class="code" href="output_8cpp.html#a5413fa90edaa8d61a8bb3aaa1329e6e4">string_replace</a>( <a class="code" href="output_8cpp.html#a55e27b39c3ab424e4f2b35a2855897ef">remove_punctuations</a>( here.<a class="code" href="classmap.html#ae074b6e1e06913bee442d894f590131f">graffiti_at</a>( p ) ), <span class="stringliteral">&quot; &quot;</span>,</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                                            <span class="stringliteral">&quot;_&quot;</span> ) ).substr( 0, 32 );</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    <span class="keywordflow">return</span> draw_from_id_string( tileset_ptr-&gt;find_tile_type( tile ) ? tile : <span class="stringliteral">&quot;graffiti&quot;</span>,</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;                                <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, p, 0, rotation, lit, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;}</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160; </div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#ad1b6af8efb9ede7bd643c80a0bcf17b3">cata_tiles::draw_field_or_item</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                                     <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;{</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;    <span class="keywordflow">if</span>( memorize_only ) {</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;    }</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160; </div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> fld_override = field_override.find( p );</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> fld_overridden = fld_override != field_override.end();</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__id.html">field_type_id</a> &amp;fld = fld_overridden ?</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;                               fld_override-&gt;second : here.<a class="code" href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">field_at</a>( p ).<a class="code" href="classfield.html#a8adfc9dd4000543431b4d1a94ab312ab">displayed_field_type</a>();</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    <span class="keywordtype">bool</span> ret_draw_field = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;    <span class="keywordtype">bool</span> ret_draw_items = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;    <span class="comment">// go through each field and draw it</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;    <span class="keywordflow">if</span>( !fld_overridden ) {</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmaptile__impl.html">maptile</a> &amp;tile = here.<a class="code" href="classmap.html#ac3badcb7b80602246664fa3671a840ba">maptile_at</a>( p );</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160; </div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const field_type_id, field_entry&gt; &amp;fd_pr : here.<a class="code" href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">field_at</a>( p ) ) {</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;            <span class="keyword">const</span> <a class="code" href="classint__id.html">field_type_id</a> &amp;fld = fd_pr.first;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;            <span class="keywordflow">if</span>( !invisible[0] &amp;&amp; fld.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structfield__type.html#a5fb79ce2363759ad2da0f0df6e071b94">display_field</a> ) {</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;                <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> lit = ll;</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">bool</span> nv = nv_goggles_activated;</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160; </div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                <span class="keyword">auto</span> has_field = [&amp;]( <a class="code" href="classint__id.html">field_type_id</a> fld, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp; q, <span class="keyword">const</span> <span class="keywordtype">bool</span> invis ) -&gt; <a class="code" href="classint__id.html">field_type_id</a> {</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;                    <span class="comment">// go through the fields and see if they are equal</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;                    <a class="code" href="classint__id.html">field_type_id</a> found = <a class="code" href="field__type_8cpp.html#abbf9ee25d4081063b76f7f3bd2a11793">fd_null</a>;</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;                    <span class="keywordflow">for</span>( std::pair&lt;const field_type_id, field_entry&gt; &amp;this_fld : here.<a class="code" href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">field_at</a>( q ) )</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;                    {</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;                        <span class="keywordflow">if</span>( this_fld.first == fld ) {</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;                            found = fld;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;                        }</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;                    }</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;                    <span class="keyword">const</span> <span class="keyword">auto</span> it = field_override.find( q );</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;                    <span class="keywordflow">return</span> it != field_override.end() ? it-&gt;second :</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;                           ( !fld_overridden || !invis ) ?  found : <a class="code" href="field__type_8cpp.html#abbf9ee25d4081063b76f7f3bd2a11793">fd_null</a>;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;                };</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;                <span class="comment">// for rotation information</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;                <span class="keyword">const</span> std::array&lt;int, 4&gt; <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> = { {</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;                        <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( has_field( fld, p + <a class="code" href="point_8h.html#a702e673ec0d39d0822e2dc453a6af3e5">point_south</a>, invisible[1] ) ),</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;                        <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( has_field( fld, p + <a class="code" href="point_8h.html#aff73fd5bf470a3db5291c5dec855bb71">point_east</a>, invisible[2] ) ),</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;                        <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( has_field( fld, p + <a class="code" href="point_8h.html#a0acd5e182489265fadc8c586f5d4d701">point_west</a>, invisible[3] ) ),</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;                        <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( has_field( fld, p + <a class="code" href="point_8h.html#acfe3d4a2977589c0adad45cf36774d8a">point_north</a>, invisible[4] ) )</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;                    }</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;                };</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160; </div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;                <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;                <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;                get_tile_values( fld.<a class="code" href="classint__id.html#a99e80dcc802865c122fc1dfd8db8fc85">to_i</a>(), <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>, subtile, rotation, 0 );</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160; </div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;                <span class="comment">//get field intensity</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> = fd_pr.second.get_field_intensity();</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160; </div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;                <span class="keywordtype">bool</span> has_drawn = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160; </div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;                <span class="comment">// start by drawing the layering data if available</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;                <span class="comment">// start for checking if layer data is available for the furniture</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;                <span class="keyword">auto</span> itt = tileset_ptr-&gt;field_layer_data.find( tile.<a class="code" href="classmaptile__impl.html#a5d1ab7324df577e978041f6e9881144c">get_furn_t</a>().<a class="code" href="structfurn__t.html#a90af2d486432fed3a9d006bf1d47ab76">id</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>() );</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;                <span class="keywordflow">if</span>( itt != tileset_ptr-&gt;field_layer_data.end() ) {</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160; </div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;                    <span class="comment">// the furniture has layer info</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;                    <span class="comment">// go through all the layer variants</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;                    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classlayer__variant.html">layer_variant</a> &amp;layer_var : itt-&gt;second ) {</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;                        <span class="keywordflow">if</span>( fld.<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>() == layer_var.<a class="code" href="classlayer__variant.html#addf11bbaec16eaf83ef405b727846743">id</a> ) {</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160; </div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                            <span class="comment">// get the sprite to draw</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                            <span class="comment">// roll should be based on the maptile seed to keep visuals consistent</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;                            <span class="keywordtype">int</span> roll = 1;</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;                            std::string sprite_to_draw;</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;                            <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;sprite_list : layer_var.<a class="code" href="classlayer__variant.html#aff8c8329be30acb37b80641d8504bc53">sprite</a> ) {</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;                                roll = roll - sprite_list.second;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;                                <span class="keywordflow">if</span>( roll &lt; 0 ) {</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;                                    sprite_to_draw = sprite_list.first;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;                                }</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;                            }</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160; </div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;                            <span class="comment">// if we have found info on the item go through and draw its stuff</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                            ret_draw_field = draw_from_id_string( sprite_to_draw, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d">TILE_CATEGORY::FIELD</a>, empty_string, p,</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;                                                                  subtile, rotation, lit, nv, height_3d, <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a>, <span class="stringliteral">&quot;&quot;</span>, layer_var.<a class="code" href="classlayer__variant.html#ac0dc6c2908c8d27c6e5f0dfe20896f97">offset</a> );</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;                            has_drawn = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;                        }</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                    }</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;                    <span class="comment">// check if the terrain has data</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;                    <span class="keyword">auto</span> itt = tileset_ptr-&gt;field_layer_data.find( tile.<a class="code" href="classmaptile__impl.html#a0629376a52a7a2f0ac1f55dcb93290a1">get_ter_t</a>().<a class="code" href="structter__t.html#a876ecdb9de153e3d864ee221ed63bd45">id</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>() );</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;                    <span class="keywordflow">if</span>( itt != tileset_ptr-&gt;field_layer_data.end() ) {</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;                        <span class="comment">// the furniture has layer info</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;                        <span class="comment">// go through all the layer variants</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;                        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classlayer__variant.html">layer_variant</a> &amp;layer_var : itt-&gt;second ) {</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;                            <span class="keywordflow">if</span>( fld.<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>() == layer_var.<a class="code" href="classlayer__variant.html#addf11bbaec16eaf83ef405b727846743">id</a> ) {</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160; </div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;                                <span class="comment">// get the sprite to draw</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;                                <span class="comment">// roll should be based on the maptile seed to keep visuals consistent</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;                                <span class="keywordtype">int</span> roll = 1;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;                                std::string sprite_to_draw;</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;                                <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;sprite_list : layer_var.<a class="code" href="classlayer__variant.html#aff8c8329be30acb37b80641d8504bc53">sprite</a> ) {</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;                                    roll = roll - sprite_list.second;</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;                                    <span class="keywordflow">if</span>( roll &lt; 0 ) {</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;                                        sprite_to_draw = sprite_list.first;</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;                                    }</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;                                }</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160; </div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;                                <span class="comment">// if we have found info on the item go through and draw its stuff</span></div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;                                ret_draw_field = draw_from_id_string( sprite_to_draw, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d">TILE_CATEGORY::FIELD</a>, empty_string, p,</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;                                                                      subtile, rotation, lit, nv, height_3d, <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a>, <span class="stringliteral">&quot;&quot;</span>, layer_var.<a class="code" href="classlayer__variant.html#ac0dc6c2908c8d27c6e5f0dfe20896f97">offset</a> );</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                                has_drawn = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;                            }</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;                        }</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;                    }</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;                }</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160; </div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;                <span class="comment">// draw the default sprite</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;                <span class="keywordflow">if</span>( !has_drawn ) {</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;                    ret_draw_field = draw_from_id_string( fld.<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d">TILE_CATEGORY::FIELD</a>, empty_string,</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;                                                          p, subtile, rotation, lit, nv, height_3d, <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> );</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;                }</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160; </div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;            }</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;        }</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;        <span class="comment">// draw the override</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;        <span class="keyword">const</span> <a class="code" href="classint__id.html">field_type_id</a> &amp;fld = fld_override-&gt;second;</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;        <span class="keywordflow">if</span>( fld.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structfield__type.html#a5fb79ce2363759ad2da0f0df6e071b94">display_field</a> ) {</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;            <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> lit = <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> nv = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160; </div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;            <span class="keyword">auto</span> field_at = [&amp;]( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp; q, <span class="keyword">const</span> <span class="keywordtype">bool</span> invis ) -&gt; <a class="code" href="classint__id.html">field_type_id</a> {</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> it = field_override.find( q );</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;                <span class="keywordflow">return</span> it != field_override.end() ? it-&gt;second :</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;                ( !fld_overridden || !invis ) ? here.<a class="code" href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">field_at</a>( q ).<a class="code" href="classfield.html#a8adfc9dd4000543431b4d1a94ab312ab">displayed_field_type</a>() : <a class="code" href="field__type_8cpp.html#abbf9ee25d4081063b76f7f3bd2a11793">fd_null</a>;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;            };</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;            <span class="comment">// for rotation information</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;            <span class="keyword">const</span> std::array&lt;int, 4&gt; <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> = {</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( field_at( p + <a class="code" href="point_8h.html#a702e673ec0d39d0822e2dc453a6af3e5">point_south</a>, invisible[1] ) ),</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( field_at( p + <a class="code" href="point_8h.html#aff73fd5bf470a3db5291c5dec855bb71">point_east</a>, invisible[2] ) ),</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( field_at( p + <a class="code" href="point_8h.html#a0acd5e182489265fadc8c586f5d4d701">point_west</a>, invisible[3] ) ),</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( field_at( p + <a class="code" href="point_8h.html#acfe3d4a2977589c0adad45cf36774d8a">point_north</a>, invisible[4] ) )</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;            };</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160; </div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;            <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;            <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;            get_tile_values( fld.<a class="code" href="classint__id.html#a99e80dcc802865c122fc1dfd8db8fc85">to_i</a>(), <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>, subtile, rotation, 0 );</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160; </div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;            <span class="comment">//get field intensity</span></div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> = fld_overridden ? 0 : here.<a class="code" href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">field_at</a>( p ).<a class="code" href="classfield.html#a59090b4a884ffd80aee7e1c86cf66b59">displayed_intensity</a>();</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            ret_draw_field = draw_from_id_string( fld.<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d">TILE_CATEGORY::FIELD</a>, empty_string,</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;                                                  p, subtile, rotation, lit, nv, height_3d, <a class="code" href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a> );</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;        }</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    }</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160; </div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    <span class="keywordflow">if</span>( fld.<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structfield__type.html#ab9770b873bdb5331c9ef936fd6a9012a">display_items</a> ) {</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> it_override = item_override.find( p );</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> it_overridden = it_override != item_override.end();</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160; </div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;        <a class="code" href="classstring__id.html">itype_id</a> it_id;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;        <a class="code" href="classstring__id.html">mtype_id</a> mon_id;</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;        std::string variant;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="color_8cpp.html#a99e42a5de98370aab8662d4423cf4a4d">hilite</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <span class="keywordtype">bool</span> drawtop = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;        <span class="keyword">const</span> <a class="code" href="structitype.html">itype</a> *it_type;</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmaptile__impl.html">maptile</a> &amp;tile = here.<a class="code" href="classmap.html#ac3badcb7b80602246664fa3671a840ba">maptile_at</a>( p );</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160; </div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;        <span class="keywordflow">if</span>( !invisible[0] ) {</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;            <span class="comment">// start by drawing the layering data if available</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;            <span class="comment">// start for checking if layer data is available for the furniture</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;            <span class="keyword">auto</span> itt = tileset_ptr-&gt;item_layer_data.find( tile.<a class="code" href="classmaptile__impl.html#a5d1ab7324df577e978041f6e9881144c">get_furn_t</a>().<a class="code" href="structfurn__t.html#a90af2d486432fed3a9d006bf1d47ab76">id</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>() );</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;            <span class="keywordflow">if</span>( itt != tileset_ptr-&gt;item_layer_data.end() ) {</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160; </div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;                <span class="comment">// the furniture has layer info</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;                <span class="comment">// go through all the layer variants</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;                <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classlayer__variant.html">layer_variant</a> &amp;layer_var : itt-&gt;second ) {</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classitem.html">item</a> &amp;i : tile.<a class="code" href="classmaptile__impl.html#a224583b97f031cc5223b7e161abab3cf">get_items</a>() ) {</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                        <span class="keywordflow">if</span>( i.typeId().str() == layer_var.<a class="code" href="classlayer__variant.html#addf11bbaec16eaf83ef405b727846743">id</a> ) {</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                            <span class="comment">// if an item matches draw it and break</span></div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                            <span class="keyword">const</span> std::string layer_it_category = i.typeId()-&gt;get_item_type_string();</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                            <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> layer_lit = ll;</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">bool</span> layer_nv = nv_goggles_activated;</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160; </div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;                            <span class="comment">// get the sprite to draw</span></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;                            <span class="comment">// roll should be based on the maptile seed to keep visuals consistent</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;                            <span class="keywordtype">int</span> roll = i.seed % layer_var.<a class="code" href="classlayer__variant.html#a8e9700d9aaf66a5720ca6d741e4537d6">total_weight</a>;</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                            std::string sprite_to_draw;</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                            <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;sprite_list : layer_var.<a class="code" href="classlayer__variant.html#aff8c8329be30acb37b80641d8504bc53">sprite</a> ) {</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;                                roll = roll - sprite_list.second;</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;                                <span class="keywordflow">if</span>( roll &lt; 0 ) {</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;                                    sprite_to_draw = sprite_list.first;</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;                                }</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;                            }</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160; </div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;                            <span class="keywordflow">if</span>( i.has_itype_variant() ) {</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;                                variant = i.itype_variant().id;</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                            }</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;                            <span class="comment">// if we have found info on the item go through and draw its stuff</span></div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                            draw_from_id_string( sprite_to_draw, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a2b911c015ed17a423c74ab9987330e60">TILE_CATEGORY::ITEM</a>, layer_it_category, p, 0,</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;                                                 0, layer_lit, layer_nv, height_3d, 0, variant, layer_var.<a class="code" href="classlayer__variant.html#ac0dc6c2908c8d27c6e5f0dfe20896f97">offset</a> );</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160; </div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;                            <span class="comment">// if the top item is already being layered don&#39;t draw it later</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;                            <span class="keywordflow">if</span>( i.typeId() == tile.<a class="code" href="classmaptile__impl.html#a5fa51fe8e3a637c9481e2fce9ac19c2a">get_uppermost_item</a>().<a class="code" href="classitem.html#a4a9972e826d25be6736b749ab94b230f">typeId</a>() ) {</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;                                drawtop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;                            }</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160; </div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                        }</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;                    }</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160; </div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                }</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160; </div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;                <span class="comment">// check if the terrain has data</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;                <span class="keyword">auto</span> itt = tileset_ptr-&gt;item_layer_data.find( tile.<a class="code" href="classmaptile__impl.html#a0629376a52a7a2f0ac1f55dcb93290a1">get_ter_t</a>().<a class="code" href="structter__t.html#a876ecdb9de153e3d864ee221ed63bd45">id</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>() );</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                <span class="keywordflow">if</span>( itt != tileset_ptr-&gt;item_layer_data.end() ) {</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160; </div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;                    <span class="comment">// the furniture has layer info</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;                    <span class="comment">// go through all the layer variants</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;                    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classlayer__variant.html">layer_variant</a> &amp;layer_var : itt-&gt;second ) {</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;                        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classitem.html">item</a> &amp;i : tile.<a class="code" href="classmaptile__impl.html#a224583b97f031cc5223b7e161abab3cf">get_items</a>() ) {</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;                            <span class="keywordflow">if</span>( i.typeId().str() == layer_var.<a class="code" href="classlayer__variant.html#addf11bbaec16eaf83ef405b727846743">id</a> ) {</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;                                <span class="comment">// if an item matches draw it and break</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;                                <span class="keyword">const</span> std::string layer_it_category = i.typeId()-&gt;get_item_type_string();</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;                                <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> layer_lit = ll;</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">bool</span> layer_nv = nv_goggles_activated;</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160; </div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;                                <span class="comment">// get the sprite to draw</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;                                <span class="comment">// roll should be based on the maptile seed to keep visuals consistent</span></div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;                                <span class="keywordtype">int</span> roll = i.seed % layer_var.<a class="code" href="classlayer__variant.html#a8e9700d9aaf66a5720ca6d741e4537d6">total_weight</a>;</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;                                std::string sprite_to_draw;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;                                <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;sprite_list : layer_var.<a class="code" href="classlayer__variant.html#aff8c8329be30acb37b80641d8504bc53">sprite</a> ) {</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;                                    roll = roll - sprite_list.second;</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;                                    <span class="keywordflow">if</span>( roll &lt; 0 ) {</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;                                        sprite_to_draw = sprite_list.first;</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;                                    }</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;                                }</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160; </div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;                                <span class="keywordflow">if</span>( i.has_itype_variant() ) {</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;                                    variant = i.itype_variant().id;</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;                                }</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;                                <span class="comment">// if we have found info on the item go through and draw its stuff</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;                                draw_from_id_string( sprite_to_draw, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a2b911c015ed17a423c74ab9987330e60">TILE_CATEGORY::ITEM</a>, layer_it_category, p, 0,</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;                                                     0, layer_lit, layer_nv, height_3d, 0, variant, layer_var.<a class="code" href="classlayer__variant.html#ac0dc6c2908c8d27c6e5f0dfe20896f97">offset</a> );</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160; </div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;                                <span class="comment">// if the top item is already being layered don&#39;t draw it later</span></div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;                                <span class="keywordflow">if</span>( i.typeId() == tile.<a class="code" href="classmaptile__impl.html#a5fa51fe8e3a637c9481e2fce9ac19c2a">get_uppermost_item</a>().<a class="code" href="classitem.html#a4a9972e826d25be6736b749ab94b230f">typeId</a>() ) {</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;                                    drawtop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;                                }</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160; </div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                            }</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;                        }</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160; </div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;                    }</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160; </div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;                }</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;            }</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        }</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160; </div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;        variant.clear();</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;        <span class="keywordflow">if</span>( drawtop || it_overridden ) {</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;            <span class="keywordflow">if</span>( it_overridden ) {</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;                it_id = std::get&lt;0&gt;( it_override-&gt;second );</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;                mon_id = std::get&lt;1&gt;( it_override-&gt;second );</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;                <a class="code" href="color_8cpp.html#a99e42a5de98370aab8662d4423cf4a4d">hilite</a> = std::get&lt;2&gt;( it_override-&gt;second );</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;                it_type = <a class="code" href="classitem.html#a11cf8d500b6d8106302470dce5ca9177">item::find_type</a>( it_id );</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !invisible[0] &amp;&amp; here.<a class="code" href="classmap.html#a5b666218957f159f8af59e98644c7183">sees_some_items</a>( p, <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() ) ) {</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;                <span class="keyword">const</span> <a class="code" href="classitem.html">item</a> &amp;itm = tile.<a class="code" href="classmaptile__impl.html#a5fa51fe8e3a637c9481e2fce9ac19c2a">get_uppermost_item</a>();</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;                <span class="keywordflow">if</span>( itm.<a class="code" href="classitem.html#ac748827c6e5f8720ac68669108a7ba29">has_itype_variant</a>() ) {</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;                    variant = itm.<a class="code" href="classitem.html#ad590c0adef8b5b3ad024bf4c67900505">itype_variant</a>().<a class="code" href="structitype__variant__data.html#a14ff35ef22c3665018aaaeef145c81fc">id</a>;</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;                }</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;                <span class="keyword">const</span> <a class="code" href="structmtype.html">mtype</a> *<span class="keyword">const</span> mon = itm.<a class="code" href="classitem.html#a66ba4b05a8ea5f9f15e4694027235aae">get_mtype</a>();</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;                it_id = itm.<a class="code" href="classitem.html#a4a9972e826d25be6736b749ab94b230f">typeId</a>();</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;                mon_id = mon ? mon-&gt;<a class="code" href="structmtype.html#a60dea81cdc4c627313e540831d311b5a">id</a> : <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">mtype_id::NULL_ID</a>();</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;                <a class="code" href="color_8cpp.html#a99e42a5de98370aab8662d4423cf4a4d">hilite</a> = tile.<a class="code" href="classmaptile__impl.html#a49cee4f9bd788754fcbe5d517cd80ba1">get_item_count</a>() &gt; 1;</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;                it_type = itm.<a class="code" href="classitem.html#ac1d2c4c33b8a499812f3437cb2fad742">type</a>;</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;                it_type = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;            }</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;            <span class="keywordflow">if</span>( it_type &amp;&amp; !it_id.<a class="code" href="classstring__id.html#a3ca78345025397b3d3ac22729ba1684b">is_null</a>() ) {</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160; </div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;                <span class="keyword">const</span> std::string disp_id = it_id == <a class="code" href="iexamine_8cpp.html#a4ea2c47870b82e831292a9239b2e6ff2">itype_corpse</a> &amp;&amp; mon_id ?</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;                                            <span class="stringliteral">&quot;corpse_&quot;</span> + mon_id.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>() : it_id.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;                <span class="keyword">const</span> std::string it_category = it_type-&gt;<a class="code" href="structitype.html#a0b38a905202f2f3ec5a5429c3d3724a8">get_item_type_string</a>();</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;                <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> lit = it_overridden ? <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a> : ll;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">bool</span> nv = it_overridden ? false : nv_goggles_activated;</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160; </div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;                ret_draw_items = draw_from_id_string( disp_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a2b911c015ed17a423c74ab9987330e60">TILE_CATEGORY::ITEM</a>, it_category, p, 0,</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;                                                      0, lit, nv, height_3d, 0, variant );</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;                <span class="keywordflow">if</span>( ret_draw_items &amp;&amp; <a class="code" href="color_8cpp.html#a99e42a5de98370aab8662d4423cf4a4d">hilite</a> ) {</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;                    draw_item_highlight( p, height_3d );</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;                }</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;            }</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        }</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;        <span class="comment">// we may still need to draw the highlight</span></div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tile.<a class="code" href="classmaptile__impl.html#a49cee4f9bd788754fcbe5d517cd80ba1">get_item_count</a>() &gt; 1 &amp;&amp; here.<a class="code" href="classmap.html#a5b666218957f159f8af59e98644c7183">sees_some_items</a>( p, <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() ) ) {</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;            draw_item_highlight( p, height_3d );</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;        }</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    }</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    <span class="keywordflow">return</span> ret_draw_field &amp;&amp; ret_draw_items;</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;}</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160; </div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a065e55e5706f94dc703a1c3c7e5bf8f2">cata_tiles::draw_vpart_below</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> <span class="comment">/*ll*/</span>, <span class="keywordtype">int</span> &amp;<span class="comment">/*height_3d*/</span>,</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;                                   <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;{</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    <span class="keywordflow">if</span>( memorize_only ) {</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    }</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160; </div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> low_override = draw_below_override.find( p );</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> low_overridden = low_override != draw_below_override.end();</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;    <span class="keywordflow">if</span>( low_overridden ? !low_override-&gt;second : ( invisible[0] ||</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;            <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().dont_draw_lower_floor( p ) ) ) {</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;    }</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> pbelow( p.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>(), p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> - 1 );</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    <span class="keywordtype">int</span> height_3d_below = 0;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;    std::array&lt;bool, 5&gt; below_invisible;</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;    std::fill( below_invisible.begin(), below_invisible.end(), <span class="keyword">false</span> );</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;    <span class="keywordflow">return</span> draw_vpart_no_roof( pbelow, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a41bc94cbd8eebea13ce0491b2ac11b88">lit_level::LOW</a>, height_3d_below, below_invisible,</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;                               memorize_only );</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;}</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160; </div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a1cded75a40f6d10c4101c747f80bd457">cata_tiles::draw_vpart_no_roof</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;                                     <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;{</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;    <span class="keywordflow">return</span> draw_vpart( p, ll, height_3d, invisible, <span class="keyword">false</span>, memorize_only );</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;}</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160; </div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#af7e94971ef0b936c11b2f65a5a457ce2">cata_tiles::draw_vpart_roof</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                                  <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;{</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;    <span class="keywordflow">return</span> draw_vpart( p, ll, height_3d, invisible, <span class="keyword">true</span>, memorize_only );</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;}</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160; </div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#aa2c979ea5d726c3e554dd9500e3b6e4d">cata_tiles::draw_vpart</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;                             <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keywordtype">bool</span> roof, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;{</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <span class="keyword">override</span> = vpart_override.find( p );</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> overridden = <span class="keyword">override</span> != vpart_override.end();</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;    <span class="comment">// first memorize the actual vpart</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;    <span class="keyword">const</span> <a class="code" href="classoptional__vpart__position.html">optional_vpart_position</a> ovp = here.<a class="code" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( p );</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    <span class="keywordflow">if</span>( ovp &amp;&amp; !invisible[0] ) {</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;        <span class="keyword">const</span> <a class="code" href="classvehicle.html">vehicle</a> &amp;veh = ovp-&gt;vehicle();</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        <span class="keyword">const</span> <a class="code" href="classvpart__display.html">vpart_display</a> vd = veh.<a class="code" href="classvehicle.html#a7169d55f706c34c402ed7ff8e9fa13f3">get_display_of_tile</a>( ovp-&gt;mount() );</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        <span class="keywordflow">if</span>( !vd.<a class="code" href="classvpart__display.html#a2a0ad17dc48d84832ad6147498f1d3c0">id</a>.<a class="code" href="classstring__id.html#a3ca78345025397b3d3ac22729ba1684b">is_null</a>() ) {</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> subtile = vd.<a class="code" href="classvpart__display.html#a325e6771036b594fbcf5b52afc4c95e0">is_open</a> ? <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aa0734d934d4034f144b98c304caab076">open_</a> : vd.<a class="code" href="classvpart__display.html#ab0940fd60c429e209b874e9447f0be48">is_broken</a> ? <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a1f85e94c05010d1308d67d1d918944e4">broken</a> : 0;</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> rotation = <a class="code" href="units__utility_8cpp.html#abc1b64df407a608febfde03382d40e2e">angle_to_dir4</a>( 270_degrees - veh.<a class="code" href="classvehicle.html#a8e021d197980bbed36ff3c43962df957">face</a>.<a class="code" href="classtileray.html#a91ed01227e1754597024f4916f8bd6af">dir</a>() );</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;            <a class="code" href="classavatar.html">avatar</a> &amp;you = <a class="code" href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a>();</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;            <span class="keywordflow">if</span>( !veh.<a class="code" href="classvehicle.html#a8e7305881802ea38e07925826da63b82">forward_velocity</a>() &amp;&amp; !veh.<a class="code" href="classvehicle.html#a341515426011486c265d016c35f84de6">player_in_control</a>( you )</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;                &amp;&amp; !( you.<a class="code" href="classavatar.html#a3fe7bbe225126bee662ce6127526cdfb">get_grab_type</a>() == <a class="code" href="enums_8h.html#a805138f2fff55cebf7ad4bc2b49f1f71ae9fa318f4d73c31493e98096efa497e2">object_type::VEHICLE</a></div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                      &amp;&amp; veh.<a class="code" href="classvehicle.html#ae6df00db578931d74d20de595736b190">get_points</a>().count( you.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>() + you.<a class="code" href="classCharacter.html#ac033cd38ee98900bb08eb196c674aa55">grab_point</a> ) )</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                &amp;&amp; here.<a class="code" href="classmap.html#a8ce6b6f4cacf6410ecb6b407bf61884e">memory_cache_dec_is_dirty</a>( p ) ) {</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;                you.<a class="code" href="classavatar.html#a3f93e313b981c8a9a70f651d3cd4bbf3">memorize_decoration</a>( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ), vd.<a class="code" href="classvpart__display.html#a995ba5771e3638a4d16f798896bc82ff">get_tileset_id</a>(), subtile, rotation );</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;            }</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;            <span class="keywordflow">if</span>( !overridden ) {</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;                <span class="keywordtype">int</span> height_3d_temp = height_3d;</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = memorize_only</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                                 ? false</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                                 : draw_from_id_string( <span class="stringliteral">&quot;vp_&quot;</span> + vd.<a class="code" href="classvpart__display.html#a2a0ad17dc48d84832ad6147498f1d3c0">id</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd">TILE_CATEGORY::VEHICLE_PART</a>,</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;                                                        empty_string, p, subtile, rotation, ll,</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;                                                        nv_goggles_activated, height_3d_temp, 0, vd.<a class="code" href="classvpart__display.html#afc4fcc47144565397f41a1659b953b74">variant</a>.<a class="code" href="classvpart__variant.html#af93535cc7d60651707ef94391cb385f1">id</a> );</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;                <span class="keywordflow">if</span>( <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> &amp;&amp; vd.<a class="code" href="classvpart__display.html#a663b6eed211568abb1b457231c6df88a">has_cargo</a> ) {</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                    draw_item_highlight( p, height_3d_temp );</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;                }</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;                <span class="comment">// Do not increment height_3d for roof vparts</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;                <span class="keywordflow">if</span>( !roof ) {</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;                    height_3d = height_3d_temp;</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;                }</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;            }</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;        }</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;    }</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;    <span class="keywordflow">if</span>( overridden ) {</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;        <span class="comment">// and then draw the override vpart</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;        <span class="keyword">const</span> <a class="code" href="classstring__id.html">vpart_id</a> &amp;vp2 = std::get&lt;0&gt;( override-&gt;second );</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;        <span class="keywordflow">if</span>( vp2 ) {</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> part_mod = std::get&lt;1&gt;( override-&gt;second );</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> subtile = part_mod == 1 ? <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aa0734d934d4034f144b98c304caab076">open_</a> : part_mod == 2 ? <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a1f85e94c05010d1308d67d1d918944e4">broken</a> : 0;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> rotation = <a class="code" href="units__utility_8cpp.html#abc1b64df407a608febfde03382d40e2e">angle_to_dir4</a>( 270_degrees - std::get&lt;2&gt;( override-&gt;second ) );</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> draw_highlight = std::get&lt;3&gt;( override-&gt;second );</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;            <span class="keyword">const</span> std::string vpname = <span class="stringliteral">&quot;vp_&quot;</span> + vp2.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;            <span class="comment">// tile overrides are never memorized</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;            <span class="comment">// tile overrides are always shown with full visibility</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;            <span class="keywordtype">int</span> height_3d_temp = height_3d;</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = memorize_only</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;                             ? false</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;                             : draw_from_id_string( vpname, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd">TILE_CATEGORY::VEHICLE_PART</a>, empty_string, p, subtile,</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;                                                    rotation, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span>, height_3d_temp );</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> &amp;&amp; draw_highlight ) {</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;                draw_item_highlight( p, height_3d_temp );</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;            }</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;            <span class="keywordflow">if</span>( !roof ) {</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;                height_3d = height_3d_temp;</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;            }</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;        }</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !roof &amp;&amp; invisible[0] ) {</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;        <span class="comment">// try drawing memory if invisible and not overridden</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmemorized__tile.html">memorized_tile</a> &amp;t = get_vpart_memory_at( here.<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p ) );</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;        std::string_view tid = t.<a class="code" href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">get_dec_id</a>();</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;        <span class="keywordflow">if</span>( !tid.empty() ) {</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;            <span class="keywordtype">int</span> height_3d_temp = height_3d;</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;            std::string_view tvar;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">size_t</span> <a class="code" href="namespacevehicles.html#a78c8b078f6e38a1e9cc70d759c8d914a">variant_separator</a> = tid.find( <a class="code" href="namespacevehicles.html#a78c8b078f6e38a1e9cc70d759c8d914a">vehicles::variant_separator</a> );</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="namespacevehicles.html#a78c8b078f6e38a1e9cc70d759c8d914a">variant_separator</a> != std::string::npos ) {</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;                tvar = tid.substr( <a class="code" href="namespacevehicles.html#a78c8b078f6e38a1e9cc70d759c8d914a">variant_separator</a> + 1 );</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                tid = tid.substr( 0, <a class="code" href="namespacevehicles.html#a78c8b078f6e38a1e9cc70d759c8d914a">variant_separator</a> );</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;            }</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;            <span class="keywordflow">return</span> memorize_only</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;                   ? false</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                   : draw_from_id_string(</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;                       std::string( tid ), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd">TILE_CATEGORY::VEHICLE_PART</a>, empty_string, p, t.<a class="code" href="classmemorized__tile.html#ac8ef0ca7edfe6fb2bf3679bfe8399ba8">get_dec_subtile</a>(),</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                       t.<a class="code" href="classmemorized__tile.html#af9bf337c3d4d23e0a2c67ae5404bba0e">get_dec_rotation</a>(), <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c">lit_level::MEMORIZED</a>, nv_goggles_activated, height_3d_temp, 0,</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;                       std::string( tvar ) );</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;        }</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;    }</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;}</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160; </div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a8af75e3afc58a4cc563d6cadfaa26d51">cata_tiles::draw_critter_at_below</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a>, <span class="keywordtype">int</span> &amp;,</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;                                        <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;{</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;    <span class="keywordflow">if</span>( memorize_only ) {</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;    }</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160; </div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    <span class="comment">// Check if we even need to draw below. If not, bail.</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> low_override = draw_below_override.find( p );</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> low_overridden = low_override != draw_below_override.end();</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;    <span class="keywordflow">if</span>( low_overridden ? !low_override-&gt;second : ( invisible[0] ||</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;            <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().dont_draw_lower_floor( p ) ) ) {</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;    }</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160; </div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> pbelow( p.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>(), p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> - 1 );</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160; </div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;    <span class="comment">// Get the critter at the location below. If there isn&#39;t one,</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;    <span class="comment">// we can bail.</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;    <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> *critter = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( pbelow, <span class="keyword">true</span> );</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;    <span class="keywordflow">if</span>( critter == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    }</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160; </div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;you = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;    <span class="comment">// Check if the player can actually see the critter. We don&#39;t care if</span></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;    <span class="comment">// it&#39;s via infrared or not, just whether or not they&#39;re seen. If not,</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    <span class="comment">// we can bail.</span></div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;    <span class="keywordflow">if</span>( !you.<a class="code" href="classCharacter.html#a906192bd3a5f29a61ee12695e18d2eb5">sees</a>( *critter ) &amp;&amp;</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        !( you.<a class="code" href="classCharacter.html#a9976ba9d9bccdaff264bd834628b97ec">sees_with_infrared</a>( *critter ) || you.<a class="code" href="classCharacter.html#a9333ab3cffa25b588ec5aa932db8d73d">sees_with_specials</a>( *critter ) ) ) {</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;    }</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160; </div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;    draw_square_below( pbelow.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>(), <a class="code" href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a>, 2 );</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160; </div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;}</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160; </div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a57482c189f06f5af3e75b5b020c0f0eb">cata_tiles::draw_critter_at</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;                                  <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;{</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;    <span class="keywordflow">if</span>( memorize_only ) {</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;    }</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160; </div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;    <span class="keywordtype">bool</span> result;</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;    <span class="keywordtype">bool</span> is_player;</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;    <span class="keywordtype">bool</span> sees_player;</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;    <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217">Creature::Attitude</a> attitude;</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;you = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;    <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> *pcritter = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( p, <span class="keyword">true</span> );</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> always_visible = pcritter &amp;&amp; pcritter-&gt;<a class="code" href="classCreature.html#aec78049b0ee4401d3a4c073663735aad">has_flag</a>( <a class="code" href="mtype_8cpp.html#acc03233e053eb1e761f81eab7c05d871">mon_flag_ALWAYS_VISIBLE</a> );</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> <span class="keyword">override</span> = monster_override.find( p );</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    <span class="keywordflow">if</span>( <span class="keyword">override</span> != monster_override.end() ) {</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;        <span class="keyword">const</span> <a class="code" href="classstring__id.html">mtype_id</a> <span class="keywordtype">id</span> = std::get&lt;0&gt;( override-&gt;second );</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;        <span class="keywordflow">if</span>( !<span class="keywordtype">id</span> ) {</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;        }</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;        is_player = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;        sees_player = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;        attitude = std::get&lt;3&gt;( override-&gt;second );</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;        <span class="keyword">const</span> std::string &amp;chosen_id = <span class="keywordtype">id</span>.str();</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;        <span class="keyword">const</span> std::string &amp;ent_subcategory = <span class="keywordtype">id</span>.obj().species.empty() ?</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                                             empty_string : <span class="keywordtype">id</span>.obj().species.begin()-&gt;str();</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;        result = draw_from_id_string( chosen_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afdd3a8eb3032c0124c1c43dec883b670">TILE_CATEGORY::MONSTER</a>, ent_subcategory, p,</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                                      <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !invisible[0] || always_visible ) {</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;        <span class="keywordflow">if</span>( pcritter == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;        }</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;        <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;critter = *pcritter;</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160; </div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;        <span class="keywordflow">if</span>( !you.<a class="code" href="classCharacter.html#a906192bd3a5f29a61ee12695e18d2eb5">sees</a>( critter ) ) {</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;            <span class="keywordflow">if</span>( you.<a class="code" href="classCharacter.html#a9976ba9d9bccdaff264bd834628b97ec">sees_with_infrared</a>( critter ) ||</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;                you.<a class="code" href="classCharacter.html#a9333ab3cffa25b588ec5aa932db8d73d">sees_with_specials</a>( critter ) ) {</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;                <span class="keywordflow">return</span> draw_from_id_string( <span class="stringliteral">&quot;infrared_creature&quot;</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string,</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;                                            p, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;            }</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;        }</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;        result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;        sees_player = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;        is_player = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;        attitude = <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a8e1bde3c3d303163521522cf1d62f21f">Creature::Attitude::ANY</a>;</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmonster.html">monster</a> *m = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmonster.html">monster</a> *<span class="keyword">&gt;</span>( &amp;critter );</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;        <span class="keywordflow">if</span>( m != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;            <span class="keyword">const</span> <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> ent_category = <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afdd3a8eb3032c0124c1c43dec883b670">TILE_CATEGORY::MONSTER</a>;</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;            std::string ent_subcategory = empty_string;</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;            <span class="keywordflow">if</span>( !m-&gt;<a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#ad2d6c0780216ad8a2999bc4e7ec7822c">species</a>.empty() ) {</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;                ent_subcategory = m-&gt;<a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#ad2d6c0780216ad8a2999bc4e7ec7822c">species</a>.begin()-&gt;str();</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;            }</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;            <span class="comment">// depending on the toggle flip sprite left or right</span></div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;            <span class="keywordtype">int</span> rot_facing = -2;</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;            <span class="keywordflow">if</span>( m-&gt;<a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> == <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403">FacingDirection::RIGHT</a> ) {</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;                rot_facing = 0;</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( m-&gt;<a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> == <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758">FacingDirection::LEFT</a> ) {</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;                rot_facing = -1;</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;            }</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;            <span class="keywordflow">if</span>( rot_facing &gt;= -1 ) {</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;                <span class="keyword">const</span> <a class="code" href="classstring__id.html">mtype_id</a> ent_name = m-&gt;<a class="code" href="classmonster.html#aa30f973bf524ba275ada847f6118b048">type</a>-&gt;<a class="code" href="structmtype.html#a60dea81cdc4c627313e540831d311b5a">id</a>;</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;                std::string chosen_id = ent_name.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                <span class="keywordflow">if</span>( m-&gt;<a class="code" href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">has_effect</a>( <a class="code" href="avatar__action_8cpp.html#a7c7651a289cc19a34456c213eeb46edc">effect_ridden</a> ) ) {</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;                    <span class="keywordtype">int</span> pl_under_height = 6;</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;                    <span class="keywordflow">if</span>( m-&gt;<a class="code" href="classmonster.html#aa07ebef40819868b9f7a86383d6cd8c3">mounted_player</a> ) {</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;                        draw_entity_with_overlays( *m-&gt;<a class="code" href="classmonster.html#aa07ebef40819868b9f7a86383d6cd8c3">mounted_player</a>, p, ll, pl_under_height );</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;                    }</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;                    <span class="keyword">const</span> std::string <a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> = <span class="stringliteral">&quot;rid_&quot;</span>;</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;                    std::string copy_id = chosen_id;</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                    <span class="keyword">const</span> std::string ridden_id = copy_id.insert( 0, <a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> );</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;                    <span class="keyword">const</span> <a class="code" href="structtile__type.html">tile_type</a> *tt = tileset_ptr-&gt;find_tile_type( ridden_id );</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;                    <span class="keywordflow">if</span>( tt ) {</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;                        chosen_id = ridden_id;</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;                    }</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;                }</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                result = draw_from_id_string( chosen_id, ent_category, ent_subcategory, p,</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;                                              subtile, rot_facing, ll, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;                sees_player = m-&gt;<a class="code" href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">sees</a>( you );</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;                attitude = m-&gt;<a class="code" href="classmonster.html#a125622587c2069dc4dbbe07943c81336">attitude_to</a>( you );</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;            }</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;        }</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;        <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> *pl = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classCharacter.html">Character</a> *<span class="keyword">&gt;</span>( &amp;critter );</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;        <span class="keywordflow">if</span>( pl != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;            draw_entity_with_overlays( *pl, p, ll, height_3d );</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;            result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;            <span class="keywordflow">if</span>( pl-&gt;<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() ) {</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;                is_player = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;                sees_player = pl-&gt;<a class="code" href="classCharacter.html#a906192bd3a5f29a61ee12695e18d2eb5">sees</a>( you );</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;                attitude = pl-&gt;<a class="code" href="classCharacter.html#a6b6a4fc8bbec9e138f0e3922bdbf2ce9">attitude_to</a>( you );</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;            }</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;        }</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;        <span class="comment">// invisible</span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;        <span class="keywordflow">if</span>( pcritter == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;        }</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        <span class="comment">// scope_is_blocking is true if player is aiming and aim FOV limits obscure that position</span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> scope_is_blocking = you.<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() &amp;&amp; you.<a class="code" href="classCreature.html#a3efb920d8e3d22ee766b62012ad0f9cd">as_avatar</a>()-&gt;<a class="code" href="classavatar.html#aeb3d6148ca381978e3cc60d892846828">cant_see</a>( p );</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> sees_with_infrared = !scope_is_blocking &amp;&amp; you.<a class="code" href="classCharacter.html#a9976ba9d9bccdaff264bd834628b97ec">sees_with_infrared</a>( *pcritter );</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;        <span class="keywordflow">if</span>( sees_with_infrared || you.<a class="code" href="classCharacter.html#a9333ab3cffa25b588ec5aa932db8d73d">sees_with_specials</a>( *pcritter ) ) {</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;            <span class="comment">// try drawing infrared creature if invisible and not overridden</span></div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;            <span class="comment">// return directly without drawing overlay</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;            <span class="keywordflow">return</span> draw_from_id_string( <span class="stringliteral">&quot;infrared_creature&quot;</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, p,</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;                                        0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;        }</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;    }</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160; </div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;    <span class="keywordflow">if</span>( result &amp;&amp; !is_player ) {</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;        std::string draw_id = <span class="stringliteral">&quot;overlay_&quot;</span> + <a class="code" href="classCreature.html#ad628fd3820652dc675e2165d3252e6dc">Creature::attitude_raw_string</a>( attitude );</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;        <span class="keywordflow">if</span>( sees_player &amp;&amp; !you.<a class="code" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code" href="game_8cpp.html#a7f3efc14d34d48d62804d9b8b8e627cc">trait_INATTENTIVE</a> ) ) {</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;            draw_id += <span class="stringliteral">&quot;_sees_player&quot;</span>;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;        }</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;        <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( draw_id ) ) {</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;            draw_from_id_string( draw_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, p, 0, 0,</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;                                 <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        }</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;    }</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;}</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160; </div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#abb3ddb2b71d8b2286389eb2bb4b122fb">cata_tiles::draw_critter_above</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;                                     <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible )</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;{</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;    <span class="keywordflow">if</span>( invisible[0] ) {</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;    }</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160; </div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> scan_p( p.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>(), p.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> + 1 );</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;    <a class="code" href="classCharacter.html">Character</a> &amp;you = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>();</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> *pcritter = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;    <span class="comment">// Search for a creature above</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    <span class="keywordflow">while</span>( pcritter == <span class="keyword">nullptr</span> &amp;&amp; !here.<a class="code" href="classmap.html#aa7733dd145c213ee0b1f412b157ae331">dont_draw_lower_floor</a>( scan_p ) &amp;&amp;</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;           scan_p.z - you.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> &lt;= <a class="code" href="cached__options_8cpp.html#a0cb65464a3fa34c1ed5474f5d2d853a7">fov_3d_z_range</a> ) {</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;        pcritter = <a class="code" href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a>().<a class="code" href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_at</a>( scan_p, <span class="keyword">true</span> );</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;        scan_p.z++;</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;    }</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160; </div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;    <span class="comment">// Abort if no creature found</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    <span class="keywordflow">if</span>( pcritter == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;    }</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a> &amp;critter = *pcritter;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160; </div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <span class="comment">// Draw shadow</span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;    <span class="keywordflow">if</span>( draw_from_id_string( <span class="stringliteral">&quot;shadow&quot;</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, p,</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;                             0, 0, ll, <span class="keyword">false</span>, height_3d ) &amp;&amp; scan_p.z - 1 &gt; you.<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>().<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> &amp;&amp; you.<a class="code" href="classCharacter.html#a906192bd3a5f29a61ee12695e18d2eb5">sees</a>( critter ) ) {</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160; </div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        <span class="keywordtype">bool</span> is_player = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        <span class="keywordtype">bool</span> sees_player = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;        <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217">Creature::Attitude</a> attitude = <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217a8e1bde3c3d303163521522cf1d62f21f">Creature::Attitude::ANY</a>;</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160; </div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;        <span class="comment">// Get critter status disposition if monster</span></div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmonster.html">monster</a> *m = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmonster.html">monster</a> *<span class="keyword">&gt;</span>( &amp;critter );</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;        <span class="keywordflow">if</span>( m != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;            sees_player = m-&gt;<a class="code" href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">sees</a>( you );</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;            attitude = m-&gt;<a class="code" href="classmonster.html#a125622587c2069dc4dbbe07943c81336">attitude_to</a>( you );</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;        }</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160; </div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;        <span class="comment">// Get critter status disposition if character</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;        <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> *pl = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classCharacter.html">Character</a> *<span class="keyword">&gt;</span>( &amp;critter );</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;        <span class="keywordflow">if</span>( pl != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;            <span class="keywordflow">if</span>( pl-&gt;<a class="code" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() ) {</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;                is_player = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;                sees_player = pl-&gt;<a class="code" href="classCharacter.html#a906192bd3a5f29a61ee12695e18d2eb5">sees</a>( you );</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;                attitude = pl-&gt;<a class="code" href="classCharacter.html#a6b6a4fc8bbec9e138f0e3922bdbf2ce9">attitude_to</a>( you );</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;            }</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;        }</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160; </div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;        <span class="comment">// Draw overlay for shadow owner</span></div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;        <span class="keywordflow">if</span>( !is_player ) {</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;            std::string draw_id = <span class="stringliteral">&quot;overlay_&quot;</span> + <a class="code" href="classCreature.html#ad628fd3820652dc675e2165d3252e6dc">Creature::attitude_raw_string</a>( attitude );</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;            <span class="keywordflow">if</span>( sees_player &amp;&amp; !you.<a class="code" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code" href="game_8cpp.html#a7f3efc14d34d48d62804d9b8b8e627cc">trait_INATTENTIVE</a> ) ) {</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;                draw_id += <span class="stringliteral">&quot;_sees_player&quot;</span>;</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;            }</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;            <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( draw_id ) ) {</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;                draw_from_id_string( draw_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, p, 0, 0,</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;                                     <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;            }</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;        }</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;    }</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;}</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160; </div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a8614da22369731a18369471a6ef6d634">cata_tiles::draw_zone_mark</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d,</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;                                 <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;{</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    <span class="keywordflow">if</span>( memorize_only ) {</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;    }</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160; </div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;    <span class="keywordflow">if</span>( invisible[0] ) {</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;    }</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160; </div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;is_zones_manager_open() ) {</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    }</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160; </div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;    <span class="keyword">const</span> <a class="code" href="classzone__manager.html">zone_manager</a> &amp;mgr = <a class="code" href="classzone__manager.html#a54609d51d21bd8f370ee8b59525eb750">zone_manager::get_manager</a>();</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    <span class="keyword">const</span> <a class="code" href="classcoords_1_1coord__point.html">tripoint_abs_ms</a> <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">abs</a> = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">getglobal</a>( p );</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    <span class="keyword">const</span> <a class="code" href="classzone__data.html">zone_data</a> *zone = mgr.<a class="code" href="classzone__manager.html#ab8daed2ba10b94a1f679165ef17db6b9">get_bottom_zone</a>( <a class="code" href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">abs</a> );</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160; </div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    <span class="keywordflow">if</span>( zone &amp;&amp; zone-&gt;<a class="code" href="classzone__data.html#adbde632da5acfb7b86495d68a9b7455d">has_options</a>() ) {</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmark__option.html">mark_option</a> *option = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmark__option.html">mark_option</a> *<span class="keyword">&gt;</span>( &amp;zone-&gt;<a class="code" href="classzone__data.html#a170c22a33e6fa998353ad0bbf9caafe3">get_options</a>() );</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160; </div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;        <span class="keywordflow">if</span>( option &amp;&amp; !option-&gt;<a class="code" href="classmark__option.html#a8a1aa174c43e7824b3d56f4bbf234a16">get_mark</a>().empty() ) {</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;            <span class="keywordflow">return</span> draw_from_id_string( option-&gt;<a class="code" href="classmark__option.html#a8a1aa174c43e7824b3d56f4bbf234a16">get_mark</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, p,</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;                                        0, 0, ll, nv_goggles_activated, height_3d );</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;        }</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    }</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160; </div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;}</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160; </div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#ace55c771dbf796f564733940419f7ac6">cata_tiles::draw_zombie_revival_indicators</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> <span class="comment">/*ll*/</span>,</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;        <span class="keywordtype">int</span> &amp;height_3d, <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible, <span class="keyword">const</span> <span class="keywordtype">bool</span> memorize_only )</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;{</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;    <span class="keywordflow">if</span>( memorize_only ) {</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    }</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160; </div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;    <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( ZOMBIE_REVIVAL_INDICATOR ) &amp;&amp; !invisible[0] &amp;&amp;</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;        item_override.find( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) == item_override.end() &amp;&amp;</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;        here.<a class="code" href="classmap.html#a632c3745cfe78bec4f22a0c7bc110b89">could_see_items</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>() ) ) {</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;        <span class="keywordflow">for</span>( <a class="code" href="classitem.html">item</a> &amp;i : here.<a class="code" href="classmap.html#a5130a127601b67e569eaef37a1a88610">i_at</a>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> ) ) {</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;            <span class="keywordflow">if</span>( i.can_revive() ) {</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;                <span class="keywordflow">return</span> draw_from_id_string( ZOMBIE_REVIVAL_INDICATOR, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>,</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;                                            empty_string, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;            }</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;        }</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    }</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;}</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160; </div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a28bd234da19f838335eaa1c7d5aa995c">cata_tiles::draw_zlevel_overlay</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll, <span class="keywordtype">int</span> &amp;height_3d )</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;{</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;    <span class="comment">// Draws zlevel fog using geometry renderer</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    <span class="comment">// Slower than sprites so only use as fallback when sprite missing</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> screen = player_to_screen( p.<a class="code" href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">xy</a>() );</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    SDL_Rect draw_rect;</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;        <span class="comment">// See comments in get_window_base_tile_counts for an explanation of tile width</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;        <span class="comment">// and height.</span></div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;        <span class="comment">// Because different tilesets may have different tile shapes, we cannot</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;        <span class="comment">// draw a tile that fits every tileset, so this only acts as a placeholder</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;        <span class="comment">// and the tilesets should make a tile that matches the shape of other</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;        <span class="comment">// sprites.</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;        draw_rect.x = screen.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>;</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;        <span class="comment">// scry</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;        <span class="comment">// + th - tw / 2.0   /* cancel out the shifting in player_to_screen */</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;        <span class="comment">// - height_3d</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;        <span class="comment">// + tw / 8.0        /* shift 1/4 of normal height to avoid overlap among overlays */</span></div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;        draw_rect.y = screen.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> + <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a> - tile_width * 3 / 8 - height_3d;</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;        draw_rect.w = tile_width;</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;        <span class="comment">// Make the tile half the normal height to avoid overlap among overlays</span></div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;        draw_rect.h = tile_width / 4;</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;        draw_rect.x = screen.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>;</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        draw_rect.y = screen.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a> - height_3d;</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;        draw_rect.w = tile_width;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        draw_rect.h = <a class="code" href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a>;</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    }</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160; </div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    <span class="comment">// Overlay color is based on light level</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;    SDL_Color fog_color = <a class="code" href="sdl__utils_8h.html#a53204099dcec8ba4483731c8f2e2a853">curses_color_to_SDL</a>( <a class="code" href="color_8h.html#a2d8f37367a34632745626276dd4c9da6">c_black</a> );</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    <span class="keywordflow">if</span>( ll == <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38adaaecad8e0b70f2d3edbbcf6dbf444a2">lit_level::BRIGHT_ONLY</a> || ll == <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aca78b38b9fe41e51b331abe6999a1040">lit_level::BRIGHT</a> || ll == <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a> ) {</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;        fog_color = <a class="code" href="sdl__utils_8h.html#a53204099dcec8ba4483731c8f2e2a853">curses_color_to_SDL</a>( <a class="code" href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a> );</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ll == <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a41bc94cbd8eebea13ce0491b2ac11b88">lit_level::LOW</a> ) {</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;        fog_color = <a class="code" href="sdl__utils_8h.html#a53204099dcec8ba4483731c8f2e2a853">curses_color_to_SDL</a>( <a class="code" href="color_8h.html#a5738d18ff9e165cca088a623cb1883ae">c_dark_gray</a> );</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    }</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;    <span class="comment">// Setting for fog transparency</span></div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <span class="comment">// On isometric tilesets, fog intensity scales with zlevel_height in tile_config.json</span></div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;    fog_color.a = fog_alpha;</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160; </div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    <span class="comment">// Change blend mode for transparency to work</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;    <span class="comment">// Disable after to avoid visual bugs</span></div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;    <a class="code" href="sdl__wrappers_8h.html#a5d741774a78797db3021028f4f09a021">SetRenderDrawBlendMode</a>( renderer, SDL_BLENDMODE_BLEND );</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    geometry-&gt;rect( renderer, draw_rect, fog_color );</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;    <a class="code" href="sdl__wrappers_8h.html#a5d741774a78797db3021028f4f09a021">SetRenderDrawBlendMode</a>( renderer, SDL_BLENDMODE_NONE );</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;}</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160; </div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a17ef88decc5224e93598fcba8cbb04b2">cata_tiles::draw_entity_with_overlays</a>( <span class="keyword">const</span> <a class="code" href="classCharacter.html">Character</a> &amp;ch, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a> ll,</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;        <span class="keywordtype">int</span> &amp;height_3d )</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;{</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;    std::vector&lt;trait_id&gt; override_look_muts = ch.<a class="code" href="classCharacter.html#a9b2b7e1e9f7bf88c5f0d7ea2155642be">get_mutations</a>( <span class="keyword">true</span>,</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    <span class="keyword">false</span>, []( <span class="keyword">const</span> <a class="code" href="structmutation__branch.html">mutation_branch</a> &amp; mut ) {</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        <span class="keywordflow">return</span> mut.<a class="code" href="structmutation__branch.html#aabc7c17a2d6f5182a5fd68d91e6219b8">override_look</a>.has_value();</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;    } );</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;    <span class="comment">// first draw the character itself(i guess this means a tileset that</span></div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    <span class="comment">// takes this seriously needs a naked sprite)</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;    <span class="keywordtype">int</span> prev_height_3d = height_3d;</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;    <span class="keywordflow">if</span>( override_look_muts.empty() ) {</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;        std::string ent_name;</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160; </div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;        <span class="keywordflow">if</span>( ch.<a class="code" href="classCharacter.html#a8f914d66d3d996a1356a31caf1d44c13">is_npc</a>() ) {</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;            ent_name = ch.<a class="code" href="classCharacter.html#a8e6a78e6c4497a9aa7b8cc127dcdd4e3">male</a> ? <span class="stringliteral">&quot;npc_male&quot;</span> : <span class="stringliteral">&quot;npc_female&quot;</span>;</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;            ent_name = ch.<a class="code" href="classCharacter.html#a8e6a78e6c4497a9aa7b8cc127dcdd4e3">male</a> ? <span class="stringliteral">&quot;player_male&quot;</span> : <span class="stringliteral">&quot;player_female&quot;</span>;</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;        }</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;        <span class="comment">// depending on the toggle flip sprite left or right</span></div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;        <span class="keywordflow">if</span>( ch.<a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> == <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403">FacingDirection::RIGHT</a> ) {</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;            draw_from_id_string( ent_name, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, <span class="stringliteral">&quot;&quot;</span>, p, <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>, 0, ll, <span class="keyword">false</span>,</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                                 height_3d );</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ch.<a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> == <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758">FacingDirection::LEFT</a> ) {</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;            draw_from_id_string( ent_name, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, <span class="stringliteral">&quot;&quot;</span>, p, <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>, -1, ll, <span class="keyword">false</span>,</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;                                 height_3d );</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;        }</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;        <a class="code" href="structmutation__branch_1_1OverrideLook.html">mutation_branch::OverrideLook</a> override_look = override_look_muts.at(</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                    0 ).obj().override_look.value();</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;        <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>;</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="cata__tiles_8h.html#ab524e7890049130434bcc79cfa267ce9">to_TILE_CATEGORY</a>.find( override_look.<a class="code" href="structmutation__branch_1_1OverrideLook.html#a2d3425405dead48aaebf4f395581973f">tile_category</a> ) != <a class="code" href="cata__tiles_8h.html#ab524e7890049130434bcc79cfa267ce9">to_TILE_CATEGORY</a>.end() ) {</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;            <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> = <a class="code" href="cata__tiles_8h.html#ab524e7890049130434bcc79cfa267ce9">to_TILE_CATEGORY</a>.at( override_look.<a class="code" href="structmutation__branch_1_1OverrideLook.html#a2d3425405dead48aaebf4f395581973f">tile_category</a> );</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;            <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;invalid tile category %s&quot;</span>, override_look.<a class="code" href="structmutation__branch_1_1OverrideLook.html#a2d3425405dead48aaebf4f395581973f">tile_category</a> );</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;            <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> = <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>;</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;        }</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;        <span class="keywordflow">if</span>( ch.<a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> == <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403">FacingDirection::RIGHT</a> ) {</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;            draw_from_id_string( override_look.<a class="code" href="structmutation__branch_1_1OverrideLook.html#aadb2402aaa8182c86c7cf81e6866cd92">id</a>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <span class="stringliteral">&quot;&quot;</span>, p, <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>, 0, ll, <span class="keyword">false</span>,</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;                                 height_3d );</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ch.<a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> == <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758">FacingDirection::LEFT</a> ) {</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;            draw_from_id_string( override_look.<a class="code" href="structmutation__branch_1_1OverrideLook.html#aadb2402aaa8182c86c7cf81e6866cd92">id</a>, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <span class="stringliteral">&quot;&quot;</span>, p, <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>, -1, ll, <span class="keyword">false</span>,</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;                                 height_3d );</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;        }</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;    }</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160; </div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;    <span class="comment">// next up, draw all the overlays</span></div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;    std::vector&lt;std::pair&lt;std::string, std::string&gt;&gt; overlays = override_look_muts.empty() ?</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;            ch.<a class="code" href="classCharacter.html#a290ab6aff408dbea2cdc7f5b5086d5b1">get_overlay_ids</a>() : ch.<a class="code" href="classCharacter.html#aa612bb3aab79906ce70c2c6acf8704ed">get_overlay_ids_when_override_look</a>();</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;std::string, std::string&gt; &amp;overlay : overlays ) {</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;        std::string draw_id = overlay.first;</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;        <span class="keywordflow">if</span>( find_overlay_looks_like( ch.<a class="code" href="classCharacter.html#a8e6a78e6c4497a9aa7b8cc127dcdd4e3">male</a>, overlay.first, overlay.second, draw_id ) ) {</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;            <span class="keywordtype">int</span> overlay_height_3d = prev_height_3d;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;            <span class="keywordflow">if</span>( ch.<a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> == <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403">FacingDirection::RIGHT</a> ) {</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;                draw_from_id_string( draw_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, <span class="stringliteral">&quot;&quot;</span>, p, <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>, <span class="comment">/*rota:*/</span> 0, ll,</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;                                     <span class="keyword">false</span>, overlay_height_3d );</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ch.<a class="code" href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">facing</a> == <a class="code" href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758">FacingDirection::LEFT</a> ) {</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                draw_from_id_string( draw_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, <span class="stringliteral">&quot;&quot;</span>, p, <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>, <span class="comment">/*rota:*/</span> -1, ll,</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                                     <span class="keyword">false</span>, overlay_height_3d );</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;            }</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;            <span class="comment">// the tallest height-having overlay is the one that counts</span></div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;            height_3d = <a class="code" href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">std::max</a>( height_3d, overlay_height_3d );</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;        }</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;    }</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;}</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160; </div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a6e035d6488ebe68a18badd5b936f7064">cata_tiles::draw_item_highlight</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, <span class="keywordtype">int</span> &amp;height_3d )</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;{</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    <span class="keywordflow">return</span> draw_from_id_string( ITEM_HIGHLIGHT, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0, 0,</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;                                <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span>, height_3d );</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;}</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160; </div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;std::shared_ptr&lt;const tileset&gt; <a class="code" href="classtileset__cache.html#a05384512fc8ba3e8bc906b2bf35d32ec">tileset_cache::load_tileset</a>( <span class="keyword">const</span> std::string &amp;tileset_id,</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;        <span class="keyword">const</span> <a class="code" href="sdl__wrappers_8h.html#a8246e5114ebf3165ebf5549a4010b420">SDL_Renderer_Ptr</a> &amp;renderer, <span class="keyword">const</span> <span class="keywordtype">bool</span> precheck, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a>, <span class="keyword">const</span> <span class="keywordtype">bool</span> pump_events )</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;{</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> get_or_create_tileset = [&amp;]() {</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> it = <a class="code" href="classtileset__cache.html#a0312eab86d6b57f8ef8976798f5124f2">tilesets_</a>.find( tileset_id );</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;        <span class="keywordflow">if</span>( it == <a class="code" href="classtileset__cache.html#a0312eab86d6b57f8ef8976798f5124f2">tilesets_</a>.end() || it-&gt;second.expired() ) {</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;            std::shared_ptr&lt;tileset&gt; new_ts = std::make_shared&lt;tileset&gt;();</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;            loader loader( *new_ts, renderer );</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;            loader.load( tileset_id, precheck, pump_events );</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;            <a class="code" href="classtileset__cache.html#a0312eab86d6b57f8ef8976798f5124f2">tilesets_</a>.emplace( tileset_id, new_ts );</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;            <span class="keywordflow">return</span> new_ts;</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;        }</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;        <span class="keywordflow">return</span> it-&gt;second.lock();</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;    };</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160; </div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;    std::shared_ptr&lt;tileset&gt; ts = get_or_create_tileset();</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160; </div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a> || ( ts-&gt;get_tileset_id().empty() &amp;&amp; !precheck ) ) {</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;        loader loader( *ts, renderer );</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;        loader.load( tileset_id, precheck, pump_events );</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    }</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    <span class="keywordflow">return</span> ts;</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;}</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160; </div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classtileset__cache_1_1loader.html#ac91b701cd76c2cf7aff019df0728adc6">tileset_cache::loader::ensure_default_item_highlight</a>()</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;{</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;    <span class="keywordflow">if</span>( ts.find_tile_type( ITEM_HIGHLIGHT ) ) {</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;    }</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    <span class="keyword">const</span> Uint8 highlight_alpha = 127;</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160; </div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    <span class="keywordtype">int</span> index = ts.tile_values.size();</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160; </div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <span class="keyword">const</span> <a class="code" href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a> surface = <a class="code" href="sdl__utils_8h.html#a2409219be466cff794b21b6fbe6154a5">create_surface_32</a>( ts.tile_width, ts.tile_height );</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;    <a class="code" href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a>( surface );</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;    <a class="code" href="sdl__wrappers_8h.html#a96ef366875d5a5af3f5ade783ef6cd43">throwErrorIf</a>( SDL_FillRect( surface.get(), <span class="keyword">nullptr</span>, SDL_MapRGBA( surface-&gt;format, 0, 0, 127,</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                                highlight_alpha ) ) != 0, <span class="stringliteral">&quot;SDL_FillRect failed&quot;</span> );</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;    ts.tile_values.emplace_back( <a class="code" href="sdl__wrappers_8h.html#a66f609a8ce2a0c74718371608a48de52">CreateTextureFromSurface</a>( renderer, surface ),</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;                                 SDL_Rect{ 0, 0, ts.tile_width, ts.tile_height } );</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    ts.tile_ids[ITEM_HIGHLIGHT].fg.add( std::vector&lt;int&gt;( {index} ), 1 );</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;}</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160; </div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;<span class="comment">/* Animation Functions */</span></div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;<span class="comment">/* -- Inits */</span></div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#af5cafc99736f35ed6c63aa66badbef60">cata_tiles::init_explosion</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keywordtype">int</span> radius )</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;{</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;    do_draw_explosion = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;    exp_pos = p;</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;    exp_rad = radius;</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;}</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a8a20bcd3986d3e374367dfe9bf14ae62">cata_tiles::init_custom_explosion_layer</a>( <span class="keyword">const</span> std::map&lt;tripoint, explosion_tile&gt; &amp;layer )</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;{</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;    do_draw_custom_explosion = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    custom_explosion_layer = layer;</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;}</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#abe26bd8c0611b06420eb4f6fd08748e4">cata_tiles::init_draw_bullet</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, std::string <a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> )</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;{</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    do_draw_bullet = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    bul_pos = p;</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    bul_id = std::move( <a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> );</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;}</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a8f0786c7bc8932177815c50dcc251e04">cata_tiles::init_draw_hit</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, std::string <a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> )</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;{</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;    do_draw_hit = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;    hit_pos = p;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;    hit_entity_id = std::move( <a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> );</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;}</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a0ed66c02bf90ce2ebfa85e77ef2854b4">cata_tiles::init_draw_line</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, std::vector&lt;tripoint&gt; <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a>,</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;                                 std::string <a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a>, <span class="keywordtype">bool</span> target_line )</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;{</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;    do_draw_line = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;    is_target_line = target_line;</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    line_pos = p;</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    line_endpoint_id = std::move( <a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> );</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;    line_trajectory = std::move( <a class="code" href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">trajectory</a> );</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;}</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#aa304115785ac2a0ed19087f26fbd8980">cata_tiles::init_draw_cursor</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;{</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;    do_draw_cursor = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    cursors.emplace_back( p );</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;}</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#ae2147e9fa0214f58b26afc6c6a4a2bb9">cata_tiles::init_draw_highlight</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;{</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    do_draw_highlight = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    highlights.emplace_back( p );</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;}</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a9860055508cc1c87454f977499018405">cata_tiles::init_draw_weather</a>( <a class="code" href="structweather__printable.html">weather_printable</a> weather, std::string <a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> )</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;{</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    do_draw_weather = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    weather_name = std::move( <a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> );</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    anim_weather = std::move( weather );</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;}</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#ab9805d867df123ef18d483ea887eda85">cata_tiles::init_draw_sct</a>()</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;{</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;    do_draw_sct = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;}</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a6a17ed4a354880ccd65915775cfcd39f">cata_tiles::init_draw_zones</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;_start, <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;_end,</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;_offset )</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;{</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;    do_draw_zones = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;    zone_start = _start;</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;    zone_end = _end;</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;    zone_offset = _offset;</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;}</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a46e297a26edbef8a38dc53a4a843101d">cata_tiles::init_draw_async_anim</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> std::string &amp;tile_id )</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;{</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;    do_draw_async_anim = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    async_anim_layer[ p ] = tile_id;</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;}</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#af1f629ae1d395324f3bb180be4fba428">cata_tiles::init_draw_radiation_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <span class="keywordtype">int</span> rad )</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;{</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    radiation_override.emplace( p, rad );</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;}</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a8340d4b1e13e103ba5f3903a8eae0af5">cata_tiles::init_draw_terrain_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="classint__id.html">ter_id</a> &amp;<span class="keywordtype">id</span> )</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;{</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;    terrain_override.emplace( p, <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;}</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a5f0e3fe656ef58b7d07653dc60a9445b">cata_tiles::init_draw_furniture_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="classint__id.html">furn_id</a> &amp;<span class="keywordtype">id</span> )</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;{</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    furniture_override.emplace( p, <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;}</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a4f737cbae2461a609038e8f747c72400">cata_tiles::init_draw_graffiti_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <span class="keywordtype">bool</span> has )</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;{</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;    graffiti_override.emplace( p, has );</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;}</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a07642d1c63dfe18a622d4ea9ea1825a3">cata_tiles::init_draw_trap_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="classint__id.html">trap_id</a> &amp;<span class="keywordtype">id</span> )</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;{</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;    trap_override.emplace( p, <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;}</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a9e3538ad287a3c09f21457808d6e1736">cata_tiles::init_draw_field_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="classint__id.html">field_type_id</a> &amp;<span class="keywordtype">id</span> )</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;{</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;    field_override.emplace( p, <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;}</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a68f083b016b41d7e5d19e1c58579cd69">cata_tiles::init_draw_item_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="classstring__id.html">itype_id</a> &amp;<span class="keywordtype">id</span>,</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;        <span class="keyword">const</span> <a class="code" href="classstring__id.html">mtype_id</a> &amp;mid, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="color_8cpp.html#a99e42a5de98370aab8662d4423cf4a4d">hilite</a> )</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;{</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;    item_override.emplace( p, std::make_tuple( <span class="keywordtype">id</span>, mid, <a class="code" href="color_8cpp.html#a99e42a5de98370aab8662d4423cf4a4d">hilite</a> ) );</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;}</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a07f9d2a6ef5a989c9351417a1e6ee2ff">cata_tiles::init_draw_vpart_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="classstring__id.html">vpart_id</a> &amp;<span class="keywordtype">id</span>,</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> part_mod, <span class="keyword">const</span> <a class="code" href="classunits_1_1quantity.html">units::angle</a> &amp;veh_dir, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="color_8cpp.html#a99e42a5de98370aab8662d4423cf4a4d">hilite</a>, <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> &amp;mount )</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;{</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;    vpart_override.emplace( p, std::make_tuple( <span class="keywordtype">id</span>, part_mod, veh_dir, <a class="code" href="color_8cpp.html#a99e42a5de98370aab8662d4423cf4a4d">hilite</a>, mount ) );</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;}</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a4acce8fe0a9c5d3e38b55d5ed9d08e93">cata_tiles::init_draw_below_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespaceovermap__ui.html#a4aeb45df4fdc5bb21b1935abb8280fd7">draw</a> )</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;{</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;    draw_below_override.emplace( p, <a class="code" href="namespaceovermap__ui.html#a4aeb45df4fdc5bb21b1935abb8280fd7">draw</a> );</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;}</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a8797277bc2bb2b75649ed0094de42e54">cata_tiles::init_draw_monster_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <a class="code" href="classstring__id.html">mtype_id</a> &amp;<span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">int</span> count,</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> more, <span class="keyword">const</span> <a class="code" href="classCreature.html#a8a475630b3289c468bd06cf114008217">Creature::Attitude</a> att )</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;{</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;    monster_override.emplace( p, std::make_tuple( <span class="keywordtype">id</span>, count, more, att ) );</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;}</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160; </div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;<span class="comment">/* -- Void Animators */</span></div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a11af22cf3c9a2bbc9f9c3fc40bbe5324">cata_tiles::void_explosion</a>()</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;{</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    do_draw_explosion = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;    exp_pos = {-1, -1, -1};</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;    exp_rad = -1;</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;}</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a6af13732ce3cb22eb8757fbaf66c6c91">cata_tiles::void_custom_explosion</a>()</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;{</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    do_draw_custom_explosion = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;    custom_explosion_layer.clear();</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;}</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a834496947d35774c9f0c3fe12d717b3d">cata_tiles::void_bullet</a>()</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;{</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;    do_draw_bullet = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    bul_pos = { -1, -1, -1 };</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;    bul_id.clear();</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;}</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#aba8fa0945b720f6b625e412c61bab476">cata_tiles::void_hit</a>()</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;{</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;    do_draw_hit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;    hit_pos = { -1, -1, -1 };</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    hit_entity_id.clear();</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;}</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a8d20b079df643f0722ddf1d023f23da5">cata_tiles::void_line</a>()</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;{</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;    do_draw_line = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;    is_target_line = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;    line_pos = { -1, -1, -1 };</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;    line_endpoint_id.clear();</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;    line_trajectory.clear();</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;}</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a3adef2397ed9571fc0785e7271ed770e">cata_tiles::void_cursor</a>()</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;{</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;    do_draw_cursor = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;    cursors.clear();</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;}</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a7adcf2e2d5af90ee464fe1c534f8c332">cata_tiles::void_highlight</a>()</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;{</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;    do_draw_highlight = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;    highlights.clear();</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;}</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#abb86896bb9f3e1c1581e7b8aa26bd07e">cata_tiles::void_weather</a>()</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;{</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;    do_draw_weather = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;    weather_name.clear();</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;    anim_weather.vdrops.clear();</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;}</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a7a5375334ee33f9d871879017597ae98">cata_tiles::void_sct</a>()</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;{</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;    do_draw_sct = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;}</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a097293f413b6e806f574baa2c258cefd">cata_tiles::void_zones</a>()</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;{</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    do_draw_zones = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;}</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a7da5291a7e43432e0f0c19e7051f5a52">cata_tiles::void_async_anim</a>()</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;{</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;    do_draw_async_anim = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;    async_anim_layer.clear();</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;}</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a7332ece01534dc1df3d1482039f7b408">cata_tiles::void_radiation_override</a>()</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;{</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    radiation_override.clear();</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;}</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a5fd0e0c2dee0096bd05f1d5879ec9b83">cata_tiles::void_terrain_override</a>()</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;{</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;    terrain_override.clear();</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;}</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a57944c39e219b0e84a80149d99463111">cata_tiles::void_furniture_override</a>()</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;{</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;    furniture_override.clear();</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;}</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#ab4f72dd1ee657c490764a9150bc72fa4">cata_tiles::void_graffiti_override</a>()</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;{</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;    graffiti_override.clear();</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;}</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a820388e4b879abab145e6dbc00413cfb">cata_tiles::void_trap_override</a>()</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;{</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;    trap_override.clear();</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;}</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#ac99ab08dcbbe22fb622d025712477018">cata_tiles::void_field_override</a>()</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;{</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;    field_override.clear();</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;}</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a10021ef8a6d11168b56836d7e1c37dcc">cata_tiles::void_item_override</a>()</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;{</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;    item_override.clear();</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;}</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#ab8eb7105d6b85d937f8baa6918635f75">cata_tiles::void_vpart_override</a>()</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;{</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;    vpart_override.clear();</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;}</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#acc075fb9ab0dc9f343cd0a65cd889a85">cata_tiles::void_draw_below_override</a>()</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;{</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;    draw_below_override.clear();</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;}</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#aebdb80f0d2b7f9fc9008cf60bbee035e">cata_tiles::void_monster_override</a>()</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;{</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;    monster_override.clear();</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;}</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160; </div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classcata__tiles.html#a00eee6b8b0ea991532c35d22b09fa0e7">cata_tiles::has_draw_override</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p )<span class="keyword"> const</span></div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;    <span class="keywordflow">return</span> radiation_override.find( p ) != radiation_override.end() ||</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;           terrain_override.find( p ) != terrain_override.end() ||</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;           furniture_override.find( p ) != furniture_override.end() ||</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;           graffiti_override.find( p ) != graffiti_override.end() ||</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;           trap_override.find( p ) != trap_override.end() ||</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;           field_override.find( p ) != field_override.end() ||</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;           item_override.find( p ) != item_override.end() ||</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;           vpart_override.find( p ) != vpart_override.end() ||</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;           draw_below_override.find( p ) != draw_below_override.end() ||</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;           monster_override.find( p ) != monster_override.end();</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;}</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160; </div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;<span class="comment">/* -- Animation Renders */</span></div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#af2c994fca8c9eb02c4ffe0b455ad09fb">cata_tiles::draw_explosion_frame</a>()</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;{</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;    std::string exp_name = <span class="stringliteral">&quot;explosion&quot;</span>;</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;    <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;    <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160; </div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 1; i &lt; exp_rad; ++i ) {</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;        subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;        rotation = 0;</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160; </div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;        draw_from_id_string( exp_name, exp_pos + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( -i, -i ),</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;                             subtile, rotation++, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;        draw_from_id_string( exp_name, exp_pos + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( -i, i ),</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;                             subtile, rotation++, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;        draw_from_id_string( exp_name, exp_pos + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( i, i ),</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;                             subtile, rotation++, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;        draw_from_id_string( exp_name, exp_pos + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( i, -i ),</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;                             subtile, rotation, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160; </div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;        subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = 1 - i; j &lt; 0 + i; j++ ) {</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;            rotation = 0;</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;            draw_from_id_string( exp_name, exp_pos + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( j, -i ),</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;                                 subtile, rotation, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;            draw_from_id_string( exp_name, exp_pos + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( j, i ),</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;                                 subtile, rotation, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160; </div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;            rotation = 1;</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;            draw_from_id_string( exp_name, exp_pos + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( -i, j ),</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;                                 subtile, rotation, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;            draw_from_id_string( exp_name, exp_pos + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( i, j ),</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;                                 subtile, rotation, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;        }</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;    }</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;}</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160; </div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a5e469c34909a46bcba765ac8421906c4">cata_tiles::draw_custom_explosion_frame</a>()</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;{</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;    <span class="comment">// TODO: Make the drawing code handle all the missing tiles: &lt;^&gt;v and *</span></div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;    <span class="comment">// TODO: Add more explosion tiles, like &quot;strong explosion&quot;, so that it displays more info</span></div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> std::string exp_strong = <span class="stringliteral">&quot;explosion&quot;</span>;</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> std::string exp_medium = <span class="stringliteral">&quot;explosion_medium&quot;</span>;</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> std::string exp_weak = <span class="stringliteral">&quot;explosion_weak&quot;</span>;</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;    <span class="keywordtype">int</span> subtile = 0;</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;    <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160; </div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;pr : custom_explosion_layer ) {</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;        <span class="keyword">const</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340">explosion_neighbors</a> ngh = pr.second.neighborhood;</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;        <span class="keyword">const</span> <a class="code" href="classnc__color.html">nc_color</a> col = pr.second.color;</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160; </div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;        <span class="keywordflow">switch</span>( ngh ) {</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136">N_NORTH</a>:</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a">N_SOUTH</a>:</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;                subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>;</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;                rotation = 1;</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7">N_WEST</a>:</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534">N_EAST</a>:</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;                subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>;</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;                rotation = 0;</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136">N_NORTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a">N_SOUTH</a>:</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136">N_NORTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a">N_SOUTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7">N_WEST</a>:</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136">N_NORTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a">N_SOUTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534">N_EAST</a>:</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;                subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>;</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;                rotation = 1;</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7">N_WEST</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534">N_EAST</a>:</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7">N_WEST</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534">N_EAST</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136">N_NORTH</a>:</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7">N_WEST</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534">N_EAST</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a">N_SOUTH</a>:</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;                subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>;</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;                rotation = 0;</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a">N_SOUTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534">N_EAST</a>:</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;                subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;                rotation = 0;</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136">N_NORTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534">N_EAST</a>:</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;                subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;                rotation = 1;</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136">N_NORTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7">N_WEST</a>:</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;                subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;                rotation = 2;</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a">N_SOUTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7">N_WEST</a>:</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;                subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;                rotation = 3;</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a4443b7226afecc3f949806f30ff0f8f3">N_NO_NEIGHBORS</a>:</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7">N_WEST</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534">N_EAST</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136">N_NORTH</a> | <a class="code" href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a">N_SOUTH</a>:</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;                <span class="comment">// Needs some special tile</span></div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;                subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>;</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;        }</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160; </div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p = pr.first;</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;        std::string explosion_tile_id;</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;        <span class="comment">// Use target sprite if exist, otherwise col will determine fallback sprite</span></div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;        <span class="keywordflow">if</span>( pr.second.tile_name &amp;&amp;</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;            find_tile_looks_like( *pr.second.tile_name, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, <span class="stringliteral">&quot;&quot;</span> ) ) {</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;            explosion_tile_id = *pr.second.tile_name;</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( col == <a class="code" href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a> ) {</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;            explosion_tile_id = exp_strong;</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( col == <a class="code" href="color_8h.html#a81e80ab9142609903b4788a6bb31ae45">c_yellow</a> ) {</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;            explosion_tile_id = exp_medium;</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( col == <a class="code" href="color_8h.html#a2d8f37367a34632745626276dd4c9da6">c_black</a> ) {</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;            <span class="comment">// c_black results in no fallback sprite</span></div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;            explosion_tile_id = exp_weak;</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;        }</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160; </div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;        draw_from_id_string( explosion_tile_id, p, subtile, rotation, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>,</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;                             nv_goggles_activated );</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;    }</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;}</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a6158cb3bafd5267fdd9a78e8c6820400">cata_tiles::draw_bullet_frame</a>()</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;{</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;    draw_from_id_string( bul_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a5fb9dc502beb6f75a2175f0ea535437d">TILE_CATEGORY::BULLET</a>, empty_string, bul_pos, 0, 0,</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;                         <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;}</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a1ae092d4ae7edb014bb26712613452b1">cata_tiles::draw_hit_frame</a>()</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;{</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;    std::string hit_overlay = <span class="stringliteral">&quot;animation_hit&quot;</span>;</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160; </div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;    draw_from_id_string( hit_entity_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a370f36e1c5ce51a59c8b3ebcc5ddeda6">TILE_CATEGORY::HIT_ENTITY</a>, empty_string, hit_pos, 0, 0,</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;                         <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;    draw_from_id_string( hit_overlay, hit_pos, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;}</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#aa4798ea81ef35ccc5fa456513ab7b1df">cata_tiles::draw_line</a>()</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;{</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;    <span class="keywordflow">if</span>( line_trajectory.empty() ) {</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;    }</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;    <span class="keyword">static</span> std::string line_overlay = <span class="stringliteral">&quot;animation_line&quot;</span>;</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;    <span class="keywordflow">if</span>( !is_target_line || <a class="code" href="game_8cpp.html#ab5c977b7e81348725fb7bf09fc64ed95">get_player_view</a>().sees( line_pos ) ) {</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">auto</span> it = line_trajectory.begin(); it != line_trajectory.end() - 1; ++it ) {</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;            draw_from_id_string( line_overlay, *it, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;        }</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;    }</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160; </div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;    draw_from_id_string( line_endpoint_id, line_trajectory.back(), 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;}</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a631db34c3736d6580d7ea28fb5032eb2">cata_tiles::draw_cursor</a>()</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;{</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p : cursors ) {</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;        draw_from_id_string( <span class="stringliteral">&quot;cursor&quot;</span>, p, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;    }</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;}</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a69251791dbc951927838245a26d3dae6">cata_tiles::draw_highlight</a>()</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;{</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p : highlights ) {</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;        draw_from_id_string( <span class="stringliteral">&quot;highlight&quot;</span>, p, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;    }</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;}</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#abc9438288e20b308e34895885008b4fb">cata_tiles::draw_weather_frame</a>()</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;{</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160; </div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;vdrop : anim_weather.vdrops ) {</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;        <span class="comment">// TODO: Z-level awareness if weather ever happens on anything but z-level 0.</span></div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;        <a class="code" href="structpoint.html">point</a> p( vdrop.first, vdrop.second );</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;        <span class="keywordflow">if</span>( !is_isometric() ) {</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;            <span class="comment">// currently in ASCII screen coordinates</span></div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;            <span class="keyword">const</span> <a class="code" href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">std::optional</a> <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a> = tile_to_player( p );</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;            <span class="keywordflow">if</span>( !<a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>.has_value() ) {</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;            }</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;            p = <a class="code" href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">temp</a>.value();</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;        }</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>( p, 0 );</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;        draw_from_id_string( weather_name, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a83a014c3c0a41242b5a879d011b677d6">TILE_CATEGORY::WEATHER</a>, empty_string, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0, 0,</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;                             <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;    }</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;}</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160; </div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a067e0649b72a41aa479ec12d90b72cba">cata_tiles::draw_sct_frame</a>( std::multimap&lt;point, formatted_text&gt; &amp;overlay_strings )</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;{</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> use_font = get_option&lt;bool&gt;( <span class="stringliteral">&quot;ANIMATION_SCT_USE_FONT&quot;</span> );</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> player_pos = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>();</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160; </div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classscrollingcombattext_1_1cSCT.html">scrollingcombattext::cSCT</a> &amp;sct : <a class="code" href="output_8cpp.html#ac8f1d6275ee49732d8988e5e671b1776">SCT</a>.<a class="code" href="classscrollingcombattext.html#a01ace3538aa0d57253df538dd7723343">vSCT</a> ) {</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;        <span class="keyword">const</span> <a class="code" href="structpoint.html">point</a> iD( sct.<a class="code" href="classscrollingcombattext_1_1cSCT.html#a6d9f2e2247547de10c9a3b8d1d3c21a3">getPosX</a>(), sct.<a class="code" href="classscrollingcombattext_1_1cSCT.html#a431b5149d42e287e668889c9728b989f">getPosY</a>() );</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> full_text_length = <a class="code" href="catacharset_8cpp.html#af20ee33da59ccceb9f4c14005c0bbe80">utf8_width</a>( sct.<a class="code" href="classscrollingcombattext_1_1cSCT.html#a1614ba32b175906a78b216e6ff076ab0">getText</a>() );</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160; </div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;        <a class="code" href="structpoint.html">point</a> iOffset;</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160; </div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j = 0; j &lt; 2; ++j ) {</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;            std::string sText = sct.<a class="code" href="classscrollingcombattext_1_1cSCT.html#a1614ba32b175906a78b216e6ff076ab0">getText</a>( ( j == 0 ) ? <span class="stringliteral">&quot;first&quot;</span> : <span class="stringliteral">&quot;second&quot;</span> );</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;            <span class="keywordtype">int</span> FG = msgtype_to_tilecolor( sct.<a class="code" href="classscrollingcombattext_1_1cSCT.html#ab5b52af8e3116e40c39902460834dff9">getMsgType</a>( ( j == 0 ) ? <span class="stringliteral">&quot;first&quot;</span> : <span class="stringliteral">&quot;second&quot;</span> ),</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;                                           sct.<a class="code" href="classscrollingcombattext_1_1cSCT.html#a399c8be22c29bfa755a6983f238c8168">getStep</a>() &gt;= <a class="code" href="classscrollingcombattext.html#a216d979c0986240c92c7baecd91ce853">scrollingcombattext::iMaxSteps</a> / 2 );</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160; </div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;            <span class="keywordflow">if</span>( use_font ) {</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;                <span class="keyword">const</span> <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> = sct.<a class="code" href="classscrollingcombattext_1_1cSCT.html#a521202c0584f4b1735bcd8b15719512d">getDirection</a>();</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;                <span class="comment">// Compensate for string length offset added at SCT creation</span></div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;                <span class="comment">// (it will be readded using font size and proper encoding later).</span></div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> direction_offset = ( -<a class="code" href="line_8cpp.html#a399f25250fad82fbc37b72a78dfafb43">displace_XY</a>( <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> ).<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a> + 1 ) *</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;                                             full_text_length / 2;</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160; </div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;                overlay_strings.emplace(</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;                    player_to_screen( iD + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">point</a>( direction_offset, 0 ) ),</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;                    <a class="code" href="structformatted__text.html">formatted_text</a>( sText, FG, <a class="code" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> ) );</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                <span class="keywordflow">for</span>( <span class="keywordtype">char</span> &amp;it : sText ) {</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;                    <span class="keyword">const</span> std::string generic_id = get_ascii_tile_id( it, FG, -1 );</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160; </div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;                    <span class="keywordflow">if</span>( tileset_ptr-&gt;find_tile_type( generic_id ) ) {</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;                        draw_from_id_string( generic_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string,</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;                                             iD + <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">tripoint</a>( iOffset, player_pos.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> ),</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;                                             0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;                    }</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160; </div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;                    <span class="keywordflow">if</span>( is_isometric() ) {</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;                        iOffset.<a class="code" href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">y</a>++;</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;                    }</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;                    iOffset.<a class="code" href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">x</a>++;</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;                }</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;            }</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;        }</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;    }</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;}</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160; </div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#af0bc2a34b699af09cf25b3c6116cdf48">cata_tiles::draw_zones_frame</a>()</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;{</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;    <a class="code" href="structtripoint.html">tripoint</a> player_pos = <a class="code" href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a>().<a class="code" href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">pos</a>();</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> iY = zone_start.y; iY &lt;= zone_end.y; ++ iY ) {</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> iX = zone_start.x; iX &lt;= zone_end.x; ++iX ) {</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;            draw_from_id_string( <span class="stringliteral">&quot;highlight&quot;</span>, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, empty_string,</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;                                 zone_offset.xy() + <a class="code" href="structtripoint.html">tripoint</a>( iX, iY, player_pos.<a class="code" href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">z</a> ),</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;                                 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;        }</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;    }</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160; </div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;}</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160; </div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#aea3e41f8a18ab2b07d1bc763ffb242da">cata_tiles::draw_async_anim</a>()</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;{</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;    <span class="comment">// game::draw_async_anim can be called multiple times, storing each animation to be played in async_anim_layer</span></div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;    <span class="comment">// Iterate through every tripoint-tileid pair in async_anim_layer</span></div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;anim : async_anim_layer ) {</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;        <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> p = anim.first;</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;        <span class="keyword">const</span> std::string tile_id = anim.second;</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;        <span class="comment">// Only draw if sprite found</span></div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;        <span class="keywordflow">if</span>( find_tile_looks_like( tile_id, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a>, <span class="stringliteral">&quot;&quot;</span> ) ) {</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;            draw_from_id_string( tile_id, p, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, nv_goggles_activated );</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;        }</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;    }</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;}</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160; </div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a3c80a60ff014eead9fee2d5429507463">cata_tiles::draw_footsteps_frame</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a> )</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;{</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> std::string id_footstep = <span class="stringliteral">&quot;footstep&quot;</span>;</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> std::string id_footstep_above = <span class="stringliteral">&quot;footstep_above&quot;</span>;</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> std::string id_footstep_below = <span class="stringliteral">&quot;footstep_below&quot;</span>;</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160; </div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtile__type.html">tile_type</a> *tl_above = tileset_ptr-&gt;find_tile_type( id_footstep_above );</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtile__type.html">tile_type</a> *tl_below = tileset_ptr-&gt;find_tile_type( id_footstep_below );</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160; </div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;<a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a> : <a class="code" href="namespacesounds.html#a658252f566c644d810dab49c5a6e2d7d">sounds::get_footstep_markers</a>() ) {</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.z &gt; <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z &amp;&amp; tl_above ) {</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;            draw_from_id_string( id_footstep_above, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>.z &lt; <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>.z &amp;&amp; tl_below ) {</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;            draw_from_id_string( id_footstep_below, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;            draw_from_id_string( id_footstep, <a class="code" href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">pos</a>, 0, 0, <a class="code" href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;        }</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;    }</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;}</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;<span class="comment">/* END OF ANIMATION FUNCTIONS */</span></div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160; </div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a1fafa5bd77219f4b556de23207c292c8">cata_tiles::tile_loading_report_dups</a>()</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;{</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160; </div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;    std::vector&lt;std::string&gt; dups_list;</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;    <span class="keyword">const</span> std::unordered_set&lt;std::string&gt; &amp;dups_set = tileset_ptr-&gt;get_duplicate_ids();</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;    std::copy( dups_set.begin(), dups_set.end(), std::back_inserter( dups_list ) );</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;    <span class="comment">// NOLINTNEXTLINE(cata-use-localized-sorting)</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;    std::sort( dups_list.begin(), dups_list.end() );</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160; </div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;    std::string res;</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;s : dups_list ) {</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;        res += s;</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;        res += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;    }</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;    <a class="code" href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a>, <a class="code" href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14">DC_ALL</a> ) &lt;&lt; <span class="stringliteral">&quot;Have duplicates: &quot;</span> &lt;&lt; res;</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;}</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160; </div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a68eb43336124082b2dfd137219ff736b">cata_tiles::init_light</a>()</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;{</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;    <a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;reset_light_level();</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;}</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160; </div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a0275c4f823b364eb0c4d5c2567c3ac3e">cata_tiles::get_terrain_orientation</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keywordtype">int</span> &amp;rota, <span class="keywordtype">int</span> &amp;subtile,</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;        <span class="keyword">const</span> std::map&lt;tripoint, ter_id&gt; &amp;ter_override, <span class="keyword">const</span> std::array&lt;bool, 5&gt; &amp;invisible,</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;        <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;rotate_group )</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;{</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> overridden = ter_override.find( p ) != ter_override.end();</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> ter = [&amp;]( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp; q, <span class="keyword">const</span> <span class="keywordtype">bool</span> invis ) -&gt; <a class="code" href="classstring__id.html">ter_str_id</a> {</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> override_it = ter_override.find( q );</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;        <span class="keywordflow">return</span> override_it != ter_override.end() ? override_it-&gt;second.<a class="code" href="structter__t.html#a876ecdb9de153e3d864ee221ed63bd45">id</a>() :</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;        ( !overridden || !invis ) ? here.<a class="code" href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">ter</a>( q ).<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>() : <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>();</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;    };</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160; </div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;    <span class="comment">// get terrain at x,y</span></div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    <span class="keyword">const</span> <a class="code" href="classint__id.html">ter_id</a> tid = ter( p, invisible[0] );</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;    <span class="keywordflow">if</span>( tid == <a class="code" href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">ter_str_id::NULL_ID</a>() ) {</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;        subtile = 0;</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;        rota = 0;</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;    }</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160; </div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;    <span class="comment">// get terrain neighborhood</span></div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;    <span class="keyword">const</span> std::array&lt;ter_id, 4&gt; <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a> = {</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;        ter( p + <a class="code" href="point_8h.html#a702e673ec0d39d0822e2dc453a6af3e5">point_south</a>, invisible[1] ),</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;        ter( p + <a class="code" href="point_8h.html#aff73fd5bf470a3db5291c5dec855bb71">point_east</a>, invisible[2] ),</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;        ter( p + <a class="code" href="point_8h.html#a0acd5e182489265fadc8c586f5d4d701">point_west</a>, invisible[3] ),</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;        ter( p + <a class="code" href="point_8h.html#acfe3d4a2977589c0adad45cf36774d8a">point_north</a>, invisible[4] )</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;    };</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160; </div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;    <span class="keywordtype">char</span> val = 0;</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160; </div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;    <span class="comment">// populate connection information</span></div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i ) {</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a>[i] == tid ) {</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;            val += 1 &lt;&lt; i;</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;        }</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;    }</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160; </div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;    uint8_t rotation_targets = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#a9dc35cc898f6346a01a2168edc9a0361">get_known_rotates_to</a>( p, rotate_group, {} );</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;    get_rotation_and_subtile( val, rotation_targets, rota, subtile );</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;}</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160; </div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a5f3d1d10096cdd601dfbca8955e0ab26">cata_tiles::get_rotation_and_subtile</a>( <span class="keyword">const</span> <span class="keywordtype">char</span> val, <span class="keyword">const</span> <span class="keywordtype">char</span> rot_to, <span class="keywordtype">int</span> &amp;rotation,</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;        <span class="keywordtype">int</span> &amp;subtile )</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;{</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> no_rotation = rot_to == CHAR_MAX;</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;    <span class="keywordflow">switch</span>( val ) {</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;        <span class="comment">// no connections</span></div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9ab9f378b6c23a56efbb2f5c5014f78ea5">unconnected</a>;</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;            <span class="keywordflow">if</span>( no_rotation ) {</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                rotation = 0;</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;            }</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;            rotation = get_rotation_unconnected( rot_to );</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;        <span class="comment">// all connections</span></div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;        <span class="keywordflow">case</span> 15:</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;            subtile = <a class="code" href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">center</a>;</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;            rotation = 0;</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;        <span class="comment">// end pieces</span></div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;        <span class="comment">// rotations:</span></div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;        <span class="comment">// --&gt; edge index</span></div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;        <span class="comment">// Nw, Ws, Sw, Es,</span></div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;        <span class="comment">// Ne, Wn, Se, En,  |</span></div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;        <span class="comment">// N+, W+, S+, E+,  V  get_rotation_... return index</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;        <span class="comment">// N-, W-, S-, E-</span></div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;        <span class="comment">// (Nw = north end piece, rotated to west)</span></div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;        <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;            <span class="comment">// vertical end piece S</span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a1f02cb4178d2f744c7ac2fa1b34a42c9">end_piece</a>;</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;            <span class="keywordflow">if</span>( no_rotation ) {</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;                rotation = 2;</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;            }</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;            rotation = 2 + 4 * get_rotation_edge_ns( rot_to );</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;            <span class="comment">// horizontal end piece E</span></div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a1f02cb4178d2f744c7ac2fa1b34a42c9">end_piece</a>;</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;            <span class="keywordflow">if</span>( no_rotation ) {</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;                rotation = 3;</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;            }</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;            rotation = 3 + 4 * get_rotation_edge_ew( rot_to );</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;            <span class="comment">// horizontal end piece W</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a1f02cb4178d2f744c7ac2fa1b34a42c9">end_piece</a>;</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;            <span class="keywordflow">if</span>( no_rotation ) {</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;                rotation = 1;</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;            }</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;            rotation = 1 + 4 * get_rotation_edge_ew( rot_to );</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;            <span class="comment">// vertical end piece N</span></div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a1f02cb4178d2f744c7ac2fa1b34a42c9">end_piece</a>;</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;            <span class="keywordflow">if</span>( no_rotation ) {</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;                rotation = 0;</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;            }</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;            rotation = 4 * get_rotation_edge_ns( rot_to );</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;        <span class="comment">// edges</span></div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;        <span class="comment">// rotations:</span></div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;        <span class="comment">// --&gt; edge index</span></div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;        <span class="comment">// NSw, EWs,</span></div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;        <span class="comment">// NSe, EWn,  |</span></div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;        <span class="comment">// NS+, EW+,  V  get_rotation_... return index</span></div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;        <span class="comment">// NS-, EW-,</span></div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;        <span class="comment">// (NSw = north-south edge, rotated to west)</span></div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;        <span class="keywordflow">case</span> 9:</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;            <span class="comment">// vertical edge</span></div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>;</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;            <span class="keywordflow">if</span>( no_rotation ) {</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;                rotation = 0;</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;            }</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;            rotation = 2 * get_rotation_edge_ns( rot_to );</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;        <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;            <span class="comment">// horizontal edge</span></div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a>;</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;            <span class="keywordflow">if</span>( no_rotation ) {</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;                rotation = 1;</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;            }</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;            rotation = 1 + 2 * get_rotation_edge_ew( rot_to );</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;        <span class="comment">// corners</span></div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;        <span class="keywordflow">case</span> 12:</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;            rotation = 2;</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;        <span class="keywordflow">case</span> 10:</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;            rotation = 1;</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;            rotation = 0;</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;        <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a>;</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;            rotation = 3;</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;        <span class="comment">// all t_connections</span></div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;        <span class="keywordflow">case</span> 14:</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a51c08cf9763167d97834c0c196ebcd8e">t_connection</a>;</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;            rotation = 2;</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;        <span class="keywordflow">case</span> 11:</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a51c08cf9763167d97834c0c196ebcd8e">t_connection</a>;</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;            rotation = 1;</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;        <span class="keywordflow">case</span> 7:</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a51c08cf9763167d97834c0c196ebcd8e">t_connection</a>;</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;            rotation = 0;</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;        <span class="keywordflow">case</span> 13:</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;            subtile = <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9a51c08cf9763167d97834c0c196ebcd8e">t_connection</a>;</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;            rotation = 3;</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;    }</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;}</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160; </div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;<span class="keywordtype">int</span> <a class="code" href="classcata__tiles.html#a60573ddae0afec2d6c8fbad0d10331d8">cata_tiles::get_rotation_edge_ns</a>( <span class="keyword">const</span> <span class="keywordtype">char</span> rot_to )</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;{</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;    <span class="keywordflow">if</span>( ( rot_to &amp; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a45ac78bf3d4882ac520f4e7fb08d55c5">NEIGHBOUR::EAST</a> ) ) == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a45ac78bf3d4882ac520f4e7fb08d55c5">NEIGHBOUR::EAST</a> ) ) {</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;        <span class="keywordflow">if</span>( ( rot_to &amp; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a83c9f5692281bf59471b13dfddb3af91">NEIGHBOUR::WEST</a> ) ) == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a83c9f5692281bf59471b13dfddb3af91">NEIGHBOUR::WEST</a> ) ) {</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;            <span class="comment">// EW</span></div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;            <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;            <span class="comment">// Ew</span></div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;        }</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// east -</span></div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;        <span class="keywordflow">if</span>( ( rot_to &amp; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a83c9f5692281bf59471b13dfddb3af91">NEIGHBOUR::WEST</a> ) ) == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a83c9f5692281bf59471b13dfddb3af91">NEIGHBOUR::WEST</a> ) ) {</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;            <span class="comment">// eW</span></div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;            <span class="comment">// ew</span></div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;            <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;        }</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;    }</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;}</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160; </div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;<span class="keywordtype">int</span> <a class="code" href="classcata__tiles.html#a8059269595873b6f998b76d93b9d9077">cata_tiles::get_rotation_edge_ew</a>( <span class="keyword">const</span> <span class="keywordtype">char</span> rot_to )</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;{</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;    <span class="keywordflow">if</span>( ( rot_to &amp; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a2bf8f791695c70efa9c14e6f1c326403">NEIGHBOUR::NORTH</a> ) ) == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a2bf8f791695c70efa9c14e6f1c326403">NEIGHBOUR::NORTH</a> ) ) {</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;        <span class="keywordflow">if</span>( ( rot_to &amp; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a96e44fa82e5a5263fb92337be422d3eb">NEIGHBOUR::SOUTH</a> ) ) == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a96e44fa82e5a5263fb92337be422d3eb">NEIGHBOUR::SOUTH</a> ) ) {</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;            <span class="comment">// NS</span></div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;            <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;            <span class="comment">// Ns</span></div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;        }</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// north -</span></div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;        <span class="keywordflow">if</span>( ( rot_to &amp; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a96e44fa82e5a5263fb92337be422d3eb">NEIGHBOUR::SOUTH</a> ) ) == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a96e44fa82e5a5263fb92337be422d3eb">NEIGHBOUR::SOUTH</a> ) ) {</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;            <span class="comment">// nS</span></div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;            <span class="comment">// ns</span></div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;            <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;        }</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;    }</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;}</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160; </div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;<span class="keywordtype">int</span> <a class="code" href="classcata__tiles.html#aba40b04dd925a15c62f0c6b1d14383c4">cata_tiles::get_rotation_unconnected</a>( <span class="keyword">const</span> <span class="keywordtype">char</span> rot_to )</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;{</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;    <span class="keywordtype">int</span> rotation = 0;</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;    <span class="keywordflow">switch</span>( rot_to ) {</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;        <span class="comment">// Catch no and all first for performance; these are the last sprites!</span></div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;        <span class="keywordflow">case</span> 0: <span class="comment">// NONE</span></div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;            rotation = 15;</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;        <span class="keywordflow">case</span> 15: <span class="comment">// ALL</span></div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;            rotation = 12;</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160; </div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;        <span class="comment">// Cases for single tile to rotate to -&gt; easy</span></div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;        <span class="keywordflow">case</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a2bf8f791695c70efa9c14e6f1c326403">NEIGHBOUR::NORTH</a> ):</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;            rotation = 2;</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;        <span class="keywordflow">case</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a45ac78bf3d4882ac520f4e7fb08d55c5">NEIGHBOUR::EAST</a> ):</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;            rotation = 3;</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;        <span class="keywordflow">case</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a96e44fa82e5a5263fb92337be422d3eb">NEIGHBOUR::SOUTH</a> ):</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;            rotation = 0;</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;        <span class="keywordflow">case</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a83c9f5692281bf59471b13dfddb3af91">NEIGHBOUR::WEST</a> ):</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;            rotation = 1;</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;        <span class="comment">// Two tiles, resulting in diagonal</span></div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;        <span class="keywordflow">case</span> 10: <span class="comment">// NE</span></div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;            rotation = 6;</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;        <span class="keywordflow">case</span> 3: <span class="comment">// SE</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;            rotation = 7;</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;        <span class="keywordflow">case</span> 5: <span class="comment">// SW</span></div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;            rotation = 4;</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;        <span class="keywordflow">case</span> 12: <span class="comment">// NW</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;            rotation = 5;</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;        <span class="comment">// Cases for three tiles to rotate to -&gt; easy</span></div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;        <span class="comment">// Arranged to fallback / modulo to fitting index 0-4</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;        <span class="keywordflow">case</span> 14: <span class="comment">// 3 but south --&gt; modulo = north</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;            rotation = 10;</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;        <span class="keywordflow">case</span> 11: <span class="comment">// 3 but west --&gt; modulo = east</span></div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;            rotation = 11;</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;        <span class="keywordflow">case</span> 7: <span class="comment">// 3 but north --&gt; modulo = south</span></div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;            rotation = 8;</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;        <span class="keywordflow">case</span> 13: <span class="comment">// 3 but east --&gt; modulo = west</span></div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;            rotation = 9;</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;        <span class="comment">// Two opposing tiles, (No tiles, all tiles; see first cases)</span></div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;        <span class="keywordflow">case</span> 9: <span class="comment">// N-S</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;            rotation = 14;</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;        <span class="keywordflow">case</span> 6: <span class="comment">// E-W</span></div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;            rotation = 13;</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;    }</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160; </div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;    <span class="keywordflow">return</span> rotation;</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;}</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160; </div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#af4ac91460226018be31f41fc65c62422">cata_tiles::get_connect_values</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keywordtype">int</span> &amp;subtile, <span class="keywordtype">int</span> &amp;rotation,</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;                                     <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;<a class="code" href="structconnect__group.html">connect_group</a>,</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;                                     <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;rotate_to_group,</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;                                     <span class="keyword">const</span> std::map&lt;tripoint, ter_id&gt; &amp;ter_override )</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;{</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;    uint8_t <a class="code" href="namespaceanonymous__namespace_02overmap__connection_8cpp_03.html#aa78e792a2288b7cc1abfcc97b0902b89">connections</a> = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#abc428da9c457d0a8ba0171c33b15d644">get_known_connections</a>( p, <a class="code" href="structconnect__group.html">connect_group</a>, ter_override );</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;    uint8_t rotation_targets = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#a9dc35cc898f6346a01a2168edc9a0361">get_known_rotates_to</a>( p, rotate_to_group, ter_override );</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;    get_rotation_and_subtile( <a class="code" href="namespaceanonymous__namespace_02overmap__connection_8cpp_03.html#aa78e792a2288b7cc1abfcc97b0902b89">connections</a>, rotation_targets, rotation, subtile );</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;}</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160; </div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#adb67bd398650f6d8f96ca919b34b9777">cata_tiles::get_furn_connect_values</a>( <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keywordtype">int</span> &amp;subtile, <span class="keywordtype">int</span> &amp;rotation,</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;        <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;<a class="code" href="structconnect__group.html">connect_group</a>, <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;rotate_to_group,</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;        <span class="keyword">const</span> std::map&lt;tripoint, furn_id&gt; &amp;furn_override )</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;{</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;    uint8_t <a class="code" href="namespaceanonymous__namespace_02overmap__connection_8cpp_03.html#aa78e792a2288b7cc1abfcc97b0902b89">connections</a> = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#a87090fcfef8b856048c65d555d7840b7">get_known_connections_f</a>( p, <a class="code" href="structconnect__group.html">connect_group</a>, furn_override );</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;    uint8_t rotation_targets = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#adeea375dfe039c35f02604a166082c2f">get_known_rotates_to_f</a>( p, rotate_to_group, {}, {} );</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;    get_rotation_and_subtile( <a class="code" href="namespaceanonymous__namespace_02overmap__connection_8cpp_03.html#aa78e792a2288b7cc1abfcc97b0902b89">connections</a>, rotation_targets, rotation, subtile );</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;}</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160; </div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#ae3bd897a4090ad5d2e9ce99c42726a1a">cata_tiles::get_tile_values</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> t, <span class="keyword">const</span> std::array&lt;int, 4&gt; &amp;tn, <span class="keywordtype">int</span> &amp;subtile,</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;                                  <span class="keywordtype">int</span> &amp;rotation, <span class="keyword">const</span> <span class="keywordtype">char</span> rotation_targets )</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;{</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;    std::array&lt;bool, 4&gt; connects;</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;    <span class="keywordtype">char</span> val = 0;</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i ) {</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;        connects[i] = ( tn[i] == t );</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;        <span class="keywordflow">if</span>( connects[i] ) {</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;            val += 1 &lt;&lt; i;</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;        }</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;    }</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;    get_rotation_and_subtile( val, rotation_targets, rotation, subtile );</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;}</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160; </div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#ab5b62a4248bc1579630384128765d1b3">cata_tiles::get_tile_values_with_ter</a>(</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;    <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;p, <span class="keyword">const</span> <span class="keywordtype">int</span> t, <span class="keyword">const</span> std::array&lt;int, 4&gt; &amp;tn, <span class="keywordtype">int</span> &amp;subtile, <span class="keywordtype">int</span> &amp;rotation,</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;    <span class="keyword">const</span> std::bitset&lt;NUM_TERCONN&gt; &amp;rotate_to_group )</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;{</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;    <a class="code" href="classmap.html">map</a> &amp;here = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>();</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;    uint8_t rotation_targets = <a class="code" href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a>().<a class="code" href="classmap.html#adeea375dfe039c35f02604a166082c2f">get_known_rotates_to_f</a>( p, rotate_to_group, {} );</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;    <span class="comment">//check if furniture should connect to itself</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;    <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a6d8e901e3f5ad46758e03e8abe434ed5">ter_furn_flag::TFLAG_NO_SELF_CONNECT</a>, p ) ||</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;        here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a86266b671365a2d1a48c55fcb1eac067">ter_furn_flag::TFLAG_ALIGN_WORKBENCH</a>, p ) ) {</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;        <span class="comment">//if we don&#39;t ever connect to ourself just return unconnected to be used further</span></div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;        get_rotation_and_subtile( 0, rotation_targets, rotation, subtile );</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;        <span class="comment">//if we do connect to ourself (tables, counters etc.) calculate based on neighbours</span></div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;        get_tile_values( t, tn, subtile, rotation, rotation_targets );</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;    }</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;    <span class="comment">// calculate rotation for unconnected tiles based on surrounding walls</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;    <span class="comment">// if not any rotates_to neighbours</span></div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;    <span class="keywordflow">if</span>( subtile == <a class="code" href="enums_8h.html#a00763863874f01b868849b27ceee73c9ab9f378b6c23a56efbb2f5c5014f78ea5">unconnected</a> &amp;&amp; ( rotation_targets == 0 || rotation_targets == CHAR_MAX ) ) {</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;        <span class="keywordtype">int</span> val = 0;</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;        <span class="keywordtype">bool</span> use_furniture = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160; </div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;        <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a86266b671365a2d1a48c55fcb1eac067">ter_furn_flag::TFLAG_ALIGN_WORKBENCH</a>, p ) ) {</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i ) {</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;                <span class="comment">// align to furniture that has the workbench quality</span></div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;                <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;pt = p + <a class="code" href="point_8h.html#aad28d8d682bc8e5628fd2b04df87decd">four_adjacent_offsets</a>[i];</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a00008f407a53edc2445622618d7ed071">has_furn</a>( pt ) &amp;&amp; here.<a class="code" href="classmap.html#af55e014aab791bbe4c8630361c1311dd">furn</a>( pt ).<a class="code" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code" href="structfurn__t.html#af52ef394c24fe2caeb92defee42bbd21">workbench</a> ) {</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;                    val += 1 &lt;&lt; i;</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;                    use_furniture = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;                }</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;            }</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;        }</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;        <span class="comment">// if still unaligned, try aligning to walls</span></div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;        <span class="keywordflow">if</span>( val == 0 ) {</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; 4; ++i ) {</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;                <span class="keyword">const</span> <a class="code" href="structtripoint.html">tripoint</a> &amp;pt = p + <a class="code" href="point_8h.html#aad28d8d682bc8e5628fd2b04df87decd">four_adjacent_offsets</a>[i];</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;                <span class="keywordflow">if</span>( here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a6701f7dc0aa6dba5a2a7cbb3568c3673">ter_furn_flag::TFLAG_WALL</a>, pt ) ||</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;                    here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a56e78d8ee67ad1dfdcb62932045a8a17">ter_furn_flag::TFLAG_WINDOW</a>, pt ) ||</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                    here.<a class="code" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code" href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac862a199df92b3793a8ce4cf5b039d20">ter_furn_flag::TFLAG_DOOR</a>, pt ) ) {</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;                    val += 1 &lt;&lt; i;</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;                }</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;            }</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;        }</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160; </div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;        <span class="keywordflow">switch</span>( val ) {</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;            <span class="keywordflow">case</span> 4:    <span class="comment">// south wall</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;            <span class="keywordflow">case</span> 14:   <span class="comment">// north opening T</span></div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;                rotation = 2;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;            <span class="keywordflow">case</span> 2:    <span class="comment">// east wall</span></div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;            <span class="keywordflow">case</span> 6:    <span class="comment">// southeast corner</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;            <span class="keywordflow">case</span> 5:    <span class="comment">// E/W corridor</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;            <span class="keywordflow">case</span> 7:    <span class="comment">// east opening T</span></div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;                rotation = 1;</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;            <span class="keywordflow">case</span> 8:    <span class="comment">// west wall</span></div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;            <span class="keywordflow">case</span> 12:   <span class="comment">// southwest corner</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;            <span class="keywordflow">case</span> 13:   <span class="comment">// west opening T</span></div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;                rotation = 3;</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;            <span class="keywordflow">case</span> 0:    <span class="comment">// no walls</span></div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;            <span class="keywordflow">case</span> 1:    <span class="comment">// north wall</span></div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;            <span class="keywordflow">case</span> 3:    <span class="comment">// northeast corner</span></div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;            <span class="keywordflow">case</span> 9:    <span class="comment">// northwest corner</span></div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;            <span class="keywordflow">case</span> 10:   <span class="comment">// N/S corridor</span></div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;            <span class="keywordflow">case</span> 11:   <span class="comment">// south opening T</span></div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;            <span class="keywordflow">case</span> 15:   <span class="comment">// surrounded</span></div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;            <span class="keywordflow">default</span>:   <span class="comment">// just in case</span></div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;                rotation = rotate_to_group.none() ? 0 : 15;</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;        }</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160; </div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;        <span class="keywordflow">if</span>( use_furniture ) {</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;            rotation = ( rotation + 2 ) % 4;</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;        }</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;    }</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;}</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160; </div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#afef68ffd1bb1725312005e3b502745b2">cata_tiles::do_tile_loading_report</a>()</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;{</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;    <a class="code" href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a>, <a class="code" href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14">DC_ALL</a> ) &lt;&lt; <span class="stringliteral">&quot;Loaded tileset: &quot;</span> &lt;&lt; get_option&lt;std::string&gt;( <span class="stringliteral">&quot;TILES&quot;</span> );</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160; </div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;    <span class="keywordflow">if</span>( !<a class="code" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;is_core_data_loaded() ) {</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;        <span class="comment">// There&#39;s nothing to do anymore without the core data.</span></div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;    }</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160; </div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;    tile_loading_report_seq_types( <a class="code" href="namespacevehicles_1_1parts.html#a1760b563889a67b60d887f2cd6331846">vehicles::parts::get_all</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd">TILE_CATEGORY::VEHICLE_PART</a>, <span class="stringliteral">&quot;vp_&quot;</span> );</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;    tile_loading_report_count&lt;ter_t&gt;( <a class="code" href="structter__t.html#a353932a6b434023d88b9a6625b356cdb">ter_t::count</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32">TILE_CATEGORY::TERRAIN</a> );</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160; </div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;    std::map&lt;itype_id, const itype *&gt; items;</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structitype.html">itype</a> *e : <a class="code" href="item__factory_8cpp.html#a62fc9d4e4ca8f0e62b4556f5f65b666c">item_controller</a>-&gt;all() ) {</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;        items.emplace( e-&gt;get_id(), e );</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;    }</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;    tile_loading_report_map( items, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a2b911c015ed17a423c74ab9987330e60">TILE_CATEGORY::ITEM</a> );</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160; </div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;    tile_loading_report_count&lt;furn_t&gt;( <a class="code" href="structfurn__t.html#a3f9d08b89197443b951462b9d45deb56">furn_t::count</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a479a2f961e7db58cfe3291ea257d432a">TILE_CATEGORY::FURNITURE</a> );</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;    tile_loading_report_count&lt;trap&gt;( <a class="code" href="structtrap.html#a4d4f2d0ba3ca652e09d818843b7f49dd">trap::count</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a26d3b291eb79dc52744a2ebb34004e97">TILE_CATEGORY::TRAP</a> );</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;    tile_loading_report_count&lt;field_type&gt;( <a class="code" href="structfield__type.html#a31caec5e850586158764f19686d8e0b7">field_type::count</a>(), <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d">TILE_CATEGORY::FIELD</a> );</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160; </div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;    <span class="comment">// TODO: LIGHTING</span></div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160; </div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;    tile_loading_report_seq_types( <a class="code" href="classMonsterGenerator.html#ab3ccba99cd10e85f8739e6af58956c0b">MonsterGenerator::generator</a>().get_all_mtypes(),</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;                                   <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afdd3a8eb3032c0124c1c43dec883b670">TILE_CATEGORY::MONSTER</a> );</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160; </div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;    <span class="comment">// TODO: BULLET</span></div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;    <span class="comment">// TODO: HIT_ENTITY</span></div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;    <span class="comment">// TODO: WEATHER</span></div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160; </div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;    std::vector&lt;oter_type_str_id&gt; oter_types;</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="structoter__t.html">oter_t</a> &amp;oter : <a class="code" href="namespaceovermap__terrains.html#adeb350d773c86be9ebdc18a60b9eca30">overmap_terrains::get_all</a>() ) {</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;        oter_types.push_back( oter.get_type_id() );</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;    }</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;    std::sort( oter_types.begin(), oter_types.end() );</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;    oter_types.erase( std::unique( oter_types.begin(), oter_types.end() ), oter_types.end() );</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;    tile_loading_report_seq_ids( oter_types, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a4467febb183d4c7dba4acf8a9742796e">TILE_CATEGORY::OVERMAP_TERRAIN</a> );</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160; </div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;    std::vector&lt;map_extra_id&gt; map_extra_ids = <a class="code" href="namespaceMapExtras.html#a55242667262f19e4358210f893caeade">MapExtras::get_all_function_names</a>();</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;    map_extra_ids.erase(</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;        std::remove_if( map_extra_ids.begin(), map_extra_ids.end(),</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;    []( <span class="keyword">const</span> <a class="code" href="classstring__id.html">map_extra_id</a> &amp; <span class="keywordtype">id</span> ) {</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;        return !id-&gt;autonote;</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;    } ), map_extra_ids.end() );</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;    tile_loading_report_seq_ids( map_extra_ids, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afeb73e1c74ff492ff8fd4b8d38d490ef">TILE_CATEGORY::MAP_EXTRA</a> );</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160; </div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;    <span class="comment">// TODO: OVERMAP_NOTE</span></div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160; </div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;    static_assert( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a98bd1c45684cf587ac2347a92dd7bb51">TILE_CATEGORY::last</a> ) == 15,</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;                   <span class="stringliteral">&quot;If you add more tile categories then update this tile loading report and then &quot;</span></div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;                   <span class="stringliteral">&quot;increment the value in this static_assert accordingly&quot;</span> );</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160; </div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;    tile_loading_report_dups();</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160; </div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;    <span class="comment">// needed until DebugLog ostream::flush bugfix lands</span></div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;    <a class="code" href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a>, <a class="code" href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14">DC_ALL</a> );</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;}</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160; </div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> Iter, <span class="keyword">typename</span> Func&gt;</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#aa9683d157ee79e2bed3e6a0b710a3750">cata_tiles::lr_generic</a>( Iter begin, Iter <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">end</a>, Func id_func, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;                             <span class="keyword">const</span> std::string &amp;<a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> )</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;{</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;    std::string missing_list;</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;    std::string missing_with_looks_like_list;</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;    <span class="keywordflow">for</span>( ; begin != <a class="code" href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">end</a>; ++begin ) {</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;        <span class="keyword">const</span> std::string id_string = id_func( begin );</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160; </div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;        <span class="keywordflow">if</span>( !tileset_ptr-&gt;find_tile_type( <a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> + id_string ) &amp;&amp;</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;            !find_tile_looks_like( id_string, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <span class="stringliteral">&quot;&quot;</span> ) ) {</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;            missing_list.append( id_string + <span class="stringliteral">&quot; &quot;</span> );</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !tileset_ptr-&gt;find_tile_type( <a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> + id_string ) ) {</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;            missing_with_looks_like_list.append( id_string + <span class="stringliteral">&quot; &quot;</span> );</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;        }</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;    }</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;    <span class="keyword">const</span> std::string &amp;category_name = TILE_CATEGORY_IDS[<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>( <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a> )];</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;    <a class="code" href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a>, <a class="code" href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14">DC_ALL</a> ) &lt;&lt; <span class="stringliteral">&quot;Missing &quot;</span> &lt;&lt; category_name &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; missing_list;</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;    <a class="code" href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a>, <a class="code" href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14">DC_ALL</a> ) &lt;&lt; <span class="stringliteral">&quot;Missing &quot;</span> &lt;&lt; category_name &lt;&lt;</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;                               <span class="stringliteral">&quot; (but looks_like tile exists): &quot;</span> &lt;&lt; missing_with_looks_like_list;</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;}</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160; </div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> maptype&gt;</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a9fc965f8022f63cd8f09ea06a3ab63b8">cata_tiles::tile_loading_report_map</a>( <span class="keyword">const</span> maptype &amp;tiletypemap, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;        <span class="keyword">const</span> std::string &amp;<a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> )</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;{</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;    lr_generic( tiletypemap.begin(), tiletypemap.end(),</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;    []( <span class="keyword">const</span> decltype( tiletypemap.begin() ) &amp; v ) {</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;        <span class="comment">// c_str works for std::string and for string_id!</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;        return v-&gt;first.c_str();</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;    }, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> );</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;}</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160; </div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Sequence&gt;</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a450c8afdd717655f3aa4a6503b7462a7">cata_tiles::tile_loading_report_seq_types</a>( <span class="keyword">const</span> Sequence &amp;tiletypes, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;        <span class="keyword">const</span> std::string &amp;<a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> )</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;{</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;    lr_generic( tiletypes.begin(), tiletypes.end(),</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;    []( <span class="keyword">const</span> decltype( tiletypes.begin() ) &amp; v ) {</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;        return v-&gt;id.c_str();</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;    }, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> );</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;}</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160; </div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Sequence&gt;</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#aa81cc5f7a3ca0ba7cce6a6a4e36102ac">cata_tiles::tile_loading_report_seq_ids</a>( <span class="keyword">const</span> Sequence &amp;tiletypes, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;        <span class="keyword">const</span> std::string &amp;<a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> )</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;{</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;    lr_generic( tiletypes.begin(), tiletypes.end(),</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;    []( <span class="keyword">const</span> decltype( tiletypes.begin() ) &amp; v ) {</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;        <span class="comment">// c_str works for std::string and for string_id!</span></div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;        return v-&gt;c_str();</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    }, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> );</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;}</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160; </div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> base_type&gt;</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classcata__tiles.html#a0b3716b200bbf58ce31020df4333bf5e">cata_tiles::tile_loading_report_count</a>( <span class="keyword">const</span> <span class="keywordtype">size_t</span> count, <a class="code" href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a> <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>,</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;        <span class="keyword">const</span> std::string &amp;<a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> )</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;{</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;    lr_generic( <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>( 0 ), count,</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;    []( <span class="keyword">const</span> <span class="keywordtype">size_t</span> i ) {</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classint__id.html">int_id&lt;base_type&gt;</a>( i ).<a class="code" href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">id</a>().str();</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;    }, <a class="code" href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">category</a>, <a class="code" href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">prefix</a> );</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;}</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160; </div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;std::vector&lt;options_manager::id_and_option&gt; <a class="code" href="classcata__tiles.html#a5ab8dba6e3b3c0ef1e3189a7b14a7553">cata_tiles::build_renderer_list</a>()</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;{</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;    std::vector&lt;options_manager::id_and_option&gt; renderer_names;</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;    std::vector&lt;options_manager::id_and_option&gt; default_renderer_names = {</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;<span class="preprocessor">#   if defined(_WIN32)</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;        { <span class="stringliteral">&quot;direct3d&quot;</span>, <a class="code" href="translation_8cpp.html#a176e288c640c6506a86330cb10fbe13a">to_translation</a>( <span class="stringliteral">&quot;direct3d&quot;</span> ) },</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;<span class="preprocessor">#   endif</span></div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;        { <span class="stringliteral">&quot;software&quot;</span>, <a class="code" href="translation_8cpp.html#a176e288c640c6506a86330cb10fbe13a">to_translation</a>( <span class="stringliteral">&quot;software&quot;</span> ) },</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;        { <span class="stringliteral">&quot;opengl&quot;</span>, <a class="code" href="translation_8cpp.html#a176e288c640c6506a86330cb10fbe13a">to_translation</a>( <span class="stringliteral">&quot;opengl&quot;</span> ) },</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;        { <span class="stringliteral">&quot;opengles2&quot;</span>, <a class="code" href="translation_8cpp.html#a176e288c640c6506a86330cb10fbe13a">to_translation</a>( <span class="stringliteral">&quot;opengles2&quot;</span> ) },</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;    };</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;    <span class="keywordtype">int</span> numRenderDrivers = SDL_GetNumRenderDrivers();</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> ii = 0; ii &lt; numRenderDrivers; ii++ ) {</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;        SDL_RendererInfo ri;</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;        SDL_GetRenderDriverInfo( ii, &amp;ri );</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;        <span class="comment">// First default renderer name we will put first on the list. We can use it later as</span></div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;        <span class="comment">// default value.</span></div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;        <span class="keywordflow">if</span>( ri.name == default_renderer_names.front().first ) {</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;            renderer_names.emplace( renderer_names.begin(), default_renderer_names.front() );</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;            renderer_names.emplace_back( ri.name, <a class="code" href="translation_8cpp.html#a7afa19f8e1a45d955fc6fbaa420a6760">no_translation</a>( ri.name ) );</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;        }</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;    }</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;    <a class="code" href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a>( <a class="code" href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a>, <a class="code" href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14">DC_ALL</a> ) &lt;&lt; <span class="stringliteral">&quot;SDL render devices: &quot;</span> &lt;&lt; <a class="code" href="output_8h.html#a4be67498ee67b5186fcae5cf706f7512">enumerate_as_string</a>( renderer_names,</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;    []( <span class="keyword">const</span> <a class="code" href="classoptions__manager.html#ae86276f64ca285bc8e1d6220a9013411">options_manager::id_and_option</a> &amp; iao ) {</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;        <span class="keywordflow">return</span> iao.first;</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;    }, <a class="code" href="output_8h.html#acff0d12357d8a4690e781eed41b36b98a334c4a4c42fdb79d7ebc3e73b517e6f8">enumeration_conjunction::none</a> );</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160; </div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;    <span class="keywordflow">return</span> renderer_names.empty() ? default_renderer_names : renderer_names;</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;}</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160; </div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;std::vector&lt;options_manager::id_and_option&gt; <a class="code" href="classcata__tiles.html#a710aafbcad966ee5d6096ca989874b9b">cata_tiles::build_display_list</a>()</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;{</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;    std::vector&lt;options_manager::id_and_option&gt; display_names;</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;    std::vector&lt;options_manager::id_and_option&gt; default_display_names = {</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;        { <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="translation_8cpp.html#a176e288c640c6506a86330cb10fbe13a">to_translation</a>( <span class="stringliteral">&quot;Display 0&quot;</span> ) }</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;    };</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160; </div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;    <span class="keywordtype">int</span> numdisplays = SDL_GetNumVideoDisplays();</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;    display_names.reserve( numdisplays );</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0 ; i &lt; numdisplays ; i++ ) {</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;        display_names.emplace_back( <a class="code" href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">std::to_string</a>( i ),</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;                                    <a class="code" href="translation_8cpp.html#a7afa19f8e1a45d955fc6fbaa420a6760">no_translation</a>( SDL_GetDisplayName( i ) ) );</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;    }</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160; </div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;    <span class="keywordflow">return</span> display_names.empty() ? default_display_names : display_names;</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;}</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160; </div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// SDL_TILES</span></div>
<div class="ttc" id="aaction_8h_html"><div class="ttname"><a href="action_8h.html">action.h</a></div></div>
<div class="ttc" id="aaction_8h_html_a14769f0512c139a614db195c6477c667a060d88d218f38689afe8ec201fd1d5c9"><div class="ttname"><a href="action_8h.html#a14769f0512c139a614db195c6477c667a060d88d218f38689afe8ec201fd1d5c9">ACTION_DISPLAY_NPC_ATTACK_POTENTIAL</a></div><div class="ttdeci">@ ACTION_DISPLAY_NPC_ATTACK_POTENTIAL</div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00348">action.h:348</a></div></div>
<div class="ttc" id="aaction_8h_html_a14769f0512c139a614db195c6477c667a69c5164b6e8c42c70b9f85f632136c04"><div class="ttname"><a href="action_8h.html#a14769f0512c139a614db195c6477c667a69c5164b6e8c42c70b9f85f632136c04">ACTION_DISPLAY_VEHICLE_AI</a></div><div class="ttdeci">@ ACTION_DISPLAY_VEHICLE_AI</div><div class="ttdoc">Toggle vehicle autopilot data.</div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00337">action.h:337</a></div></div>
<div class="ttc" id="aaction_8h_html_a14769f0512c139a614db195c6477c667a741ce48850825cffe3d78beaabb8651a"><div class="ttname"><a href="action_8h.html#a14769f0512c139a614db195c6477c667a741ce48850825cffe3d78beaabb8651a">ACTION_DISPLAY_TRANSPARENCY</a></div><div class="ttdeci">@ ACTION_DISPLAY_TRANSPARENCY</div><div class="ttdoc">Toggle transparency map.</div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00345">action.h:345</a></div></div>
<div class="ttc" id="aaction_8h_html_a14769f0512c139a614db195c6477c667a7524d315bc01ce6a42a768df387a53db"><div class="ttname"><a href="action_8h.html#a14769f0512c139a614db195c6477c667a7524d315bc01ce6a42a768df387a53db">ACTION_DISPLAY_RADIATION</a></div><div class="ttdeci">@ ACTION_DISPLAY_RADIATION</div><div class="ttdoc">Toggle radiation map.</div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00343">action.h:343</a></div></div>
<div class="ttc" id="aaction_8h_html_a14769f0512c139a614db195c6477c667a85ad66ac510611e454e87bd3e4b86bb2"><div class="ttname"><a href="action_8h.html#a14769f0512c139a614db195c6477c667a85ad66ac510611e454e87bd3e4b86bb2">ACTION_DISPLAY_TEMPERATURE</a></div><div class="ttdeci">@ ACTION_DISPLAY_TEMPERATURE</div><div class="ttdoc">Toggle temperature map.</div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00335">action.h:335</a></div></div>
<div class="ttc" id="aaction_8h_html_a14769f0512c139a614db195c6477c667a8d4ed6671b471662169fdf1696f2e540"><div class="ttname"><a href="action_8h.html#a14769f0512c139a614db195c6477c667a8d4ed6671b471662169fdf1696f2e540">ACTION_DISPLAY_SCENT_TYPE</a></div><div class="ttdeci">@ ACTION_DISPLAY_SCENT_TYPE</div><div class="ttdoc">Toggle scent type map.</div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00305">action.h:305</a></div></div>
<div class="ttc" id="aaction_8h_html_a14769f0512c139a614db195c6477c667aa4046b7475c2b0cefdba44eb4995e4ea"><div class="ttname"><a href="action_8h.html#a14769f0512c139a614db195c6477c667aa4046b7475c2b0cefdba44eb4995e4ea">ACTION_DISPLAY_LIGHTING</a></div><div class="ttdeci">@ ACTION_DISPLAY_LIGHTING</div><div class="ttdoc">Toggle lighting conditions map.</div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00341">action.h:341</a></div></div>
<div class="ttc" id="aaction_8h_html_a14769f0512c139a614db195c6477c667ac6a2622e05b532456fa5a12949d5ba7a"><div class="ttname"><a href="action_8h.html#a14769f0512c139a614db195c6477c667ac6a2622e05b532456fa5a12949d5ba7a">ACTION_DISPLAY_SCENT</a></div><div class="ttdeci">@ ACTION_DISPLAY_SCENT</div><div class="ttdoc">Toggle scent map.</div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00303">action.h:303</a></div></div>
<div class="ttc" id="aaction_8h_html_a14769f0512c139a614db195c6477c667acf112c2ce5f44400e21524b61bb5b107"><div class="ttname"><a href="action_8h.html#a14769f0512c139a614db195c6477c667acf112c2ce5f44400e21524b61bb5b107">ACTION_DISPLAY_VISIBILITY</a></div><div class="ttdeci">@ ACTION_DISPLAY_VISIBILITY</div><div class="ttdoc">Toggle visibility map.</div><div class="ttdef"><b>Definition:</b> <a href="action_8h_source.html#l00339">action.h:339</a></div></div>
<div class="ttc" id="aactivity__handlers_8cpp_html_a49bc164f30e64702250d2cbea09bf86c"><div class="ttname"><a href="activity__handlers_8cpp.html#a49bc164f30e64702250d2cbea09bf86c">dbg</a></div><div class="ttdeci">#define dbg(x)</div><div class="ttdef"><b>Definition:</b> <a href="activity__handlers_8cpp_source.html#l00109">activity_handlers.cpp:109</a></div></div>
<div class="ttc" id="aanimation_8h_html_a45cb12f33098d8a53ed80ed4db49e340"><div class="ttname"><a href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340">explosion_neighbors</a></div><div class="ttdeci">explosion_neighbors</div><div class="ttdef"><b>Definition:</b> <a href="animation_8h_source.html#l00010">animation.h:10</a></div></div>
<div class="ttc" id="aanimation_8h_html_a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7"><div class="ttname"><a href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a3d86c4b1c2818425862f5dbc6dd9e7e7">N_WEST</a></div><div class="ttdeci">@ N_WEST</div><div class="ttdef"><b>Definition:</b> <a href="animation_8h_source.html#l00017">animation.h:17</a></div></div>
<div class="ttc" id="aanimation_8h_html_a45cb12f33098d8a53ed80ed4db49e340a4443b7226afecc3f949806f30ff0f8f3"><div class="ttname"><a href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a4443b7226afecc3f949806f30ff0f8f3">N_NO_NEIGHBORS</a></div><div class="ttdeci">@ N_NO_NEIGHBORS</div><div class="ttdef"><b>Definition:</b> <a href="animation_8h_source.html#l00011">animation.h:11</a></div></div>
<div class="ttc" id="aanimation_8h_html_a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136"><div class="ttname"><a href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a978e896dcf6dea2ac3752173549ac136">N_NORTH</a></div><div class="ttdeci">@ N_NORTH</div><div class="ttdef"><b>Definition:</b> <a href="animation_8h_source.html#l00012">animation.h:12</a></div></div>
<div class="ttc" id="aanimation_8h_html_a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a"><div class="ttname"><a href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340a9fa60f4ca026d5f0260b7d76bef77a6a">N_SOUTH</a></div><div class="ttdeci">@ N_SOUTH</div><div class="ttdef"><b>Definition:</b> <a href="animation_8h_source.html#l00014">animation.h:14</a></div></div>
<div class="ttc" id="aanimation_8h_html_a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534"><div class="ttname"><a href="animation_8h.html#a45cb12f33098d8a53ed80ed4db49e340ab32d172ee7c8dde95f6ec5f4745e0534">N_EAST</a></div><div class="ttdeci">@ N_EAST</div><div class="ttdef"><b>Definition:</b> <a href="animation_8h_source.html#l00022">animation.h:22</a></div></div>
<div class="ttc" id="aavatar_8h_html"><div class="ttname"><a href="avatar_8h.html">avatar.h</a></div></div>
<div class="ttc" id="aavatar_8h_html_a7fe2c1a3376948380f856732d4f34c5c"><div class="ttname"><a href="avatar_8h.html#a7fe2c1a3376948380f856732d4f34c5c">get_avatar</a></div><div class="ttdeci">avatar &amp; get_avatar()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13817">game.cpp:13817</a></div></div>
<div class="ttc" id="aavatar__action_8cpp_html_a7c7651a289cc19a34456c213eeb46edc"><div class="ttname"><a href="avatar__action_8cpp.html#a7c7651a289cc19a34456c213eeb46edc">effect_ridden</a></div><div class="ttdeci">static const efftype_id effect_ridden(&quot;ridden&quot;)</div></div>
<div class="ttc" id="acached__options_8cpp_html_a0cb65464a3fa34c1ed5474f5d2d853a7"><div class="ttname"><a href="cached__options_8cpp.html#a0cb65464a3fa34c1ed5474f5d2d853a7">fov_3d_z_range</a></div><div class="ttdeci">int fov_3d_z_range</div><div class="ttdef"><b>Definition:</b> <a href="cached__options_8cpp_source.html#l00003">cached_options.cpp:3</a></div></div>
<div class="ttc" id="acached__options_8cpp_html_a23c5a251d51bb2592b83ee1daa1f81f9"><div class="ttname"><a href="cached__options_8cpp.html#a23c5a251d51bb2592b83ee1daa1f81f9">prevent_occlusion_transp</a></div><div class="ttdeci">bool prevent_occlusion_transp</div><div class="ttdef"><b>Definition:</b> <a href="cached__options_8cpp_source.html#l00011">cached_options.cpp:11</a></div></div>
<div class="ttc" id="acached__options_8cpp_html_a8fd66fb8f4480123fcacdd4c3631e0d0"><div class="ttname"><a href="cached__options_8cpp.html#a8fd66fb8f4480123fcacdd4c3631e0d0">direct3d_mode</a></div><div class="ttdeci">bool direct3d_mode</div><div class="ttdef"><b>Definition:</b> <a href="cached__options_8cpp_source.html#l00019">cached_options.cpp:19</a></div></div>
<div class="ttc" id="acached__options_8cpp_html_ab89c4bf33e6fc159efd1e392b2340540"><div class="ttname"><a href="cached__options_8cpp.html#ab89c4bf33e6fc159efd1e392b2340540">prevent_occlusion</a></div><div class="ttdeci">int prevent_occlusion</div><div class="ttdef"><b>Definition:</b> <a href="cached__options_8cpp_source.html#l00009">cached_options.cpp:9</a></div></div>
<div class="ttc" id="acached__options_8cpp_html_ae34f538a8b94884b1c01e3cb98f1cef2"><div class="ttname"><a href="cached__options_8cpp.html#ae34f538a8b94884b1c01e3cb98f1cef2">prevent_occlusion_max_dist</a></div><div class="ttdeci">float prevent_occlusion_max_dist</div><div class="ttdef"><b>Definition:</b> <a href="cached__options_8cpp_source.html#l00013">cached_options.cpp:13</a></div></div>
<div class="ttc" id="acached__options_8cpp_html_af3fa94d0c2cd07c6e27c9c4f455e1d1e"><div class="ttname"><a href="cached__options_8cpp.html#af3fa94d0c2cd07c6e27c9c4f455e1d1e">prevent_occlusion_min_dist</a></div><div class="ttdeci">float prevent_occlusion_min_dist</div><div class="ttdef"><b>Definition:</b> <a href="cached__options_8cpp_source.html#l00012">cached_options.cpp:12</a></div></div>
<div class="ttc" id="acached__options_8cpp_html_afcb9eb2d0281d789f0f5b492c623b5fd"><div class="ttname"><a href="cached__options_8cpp.html#afcb9eb2d0281d789f0f5b492c623b5fd">prevent_occlusion_retract</a></div><div class="ttdeci">bool prevent_occlusion_retract</div><div class="ttdef"><b>Definition:</b> <a href="cached__options_8cpp_source.html#l00010">cached_options.cpp:10</a></div></div>
<div class="ttc" id="acached__options_8h_html"><div class="ttname"><a href="cached__options_8h.html">cached_options.h</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_a81656706da6c7486137ad8578c0f523e"><div class="ttname"><a href="calendar_8cpp.html#a81656706da6c7486137ad8578c0f523e">season_of_year</a></div><div class="ttdeci">season_type season_of_year(const time_point &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00810">calendar.cpp:810</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_abf1cdb8f4662bf96c8d762e9229df8d9"><div class="ttname"><a href="calendar_8cpp.html#abf1cdb8f4662bf96c8d762e9229df8d9">to_string</a></div><div class="ttdeci">std::string to_string(const time_duration &amp;d, const bool compact)</div><div class="ttdoc">Returns a string showing a duration.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00546">calendar.cpp:546</a></div></div>
<div class="ttc" id="acalendar_8h_html"><div class="ttname"><a href="calendar_8h.html">calendar.h</a></div></div>
<div class="ttc" id="acalendar_8h_html_a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8"><div class="ttname"><a href="calendar_8h.html#a30acaac03fb0c3f8f4e2792f24a187c2a3f1b0333a44fd5f611d3429887eba4a8">clipped_unit::season</a></div><div class="ttdeci">@ season</div></div>
<div class="ttc" id="acalendar_8h_html_a5ac915753729cd68b608506d3c63ad1b"><div class="ttname"><a href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1b">season_type</a></div><div class="ttdeci">season_type</div><div class="ttdoc">Real world seasons.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00021">calendar.h:21</a></div></div>
<div class="ttc" id="acalendar_8h_html_a5ac915753729cd68b608506d3c63ad1bafe1e85bb91d56f81f6f62a88e9ba318a"><div class="ttname"><a href="calendar_8h.html#a5ac915753729cd68b608506d3c63ad1bafe1e85bb91d56f81f6f62a88e9ba318a">NUM_SEASONS</a></div><div class="ttdeci">@ NUM_SEASONS</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00027">calendar.h:26</a></div></div>
<div class="ttc" id="acata__assert_8h_html"><div class="ttname"><a href="cata__assert_8h.html">cata_assert.h</a></div></div>
<div class="ttc" id="acata__assert_8h_html_abb2ca9fce6a171932c05748ecc5df5bb"><div class="ttname"><a href="cata__assert_8h.html#abb2ca9fce6a171932c05748ecc5df5bb">cata_assert</a></div><div class="ttdeci">#define cata_assert(expression)</div><div class="ttdef"><b>Definition:</b> <a href="cata__assert_8h_source.html#l00036">cata_assert.h:36</a></div></div>
<div class="ttc" id="acata__imgui_8cpp_html_ac95da3f41714ec1458968960346eadfe"><div class="ttname"><a href="cata__imgui_8cpp.html#ac95da3f41714ec1458968960346eadfe">colorpairs</a></div><div class="ttdeci">std::array&lt; pairs, 100 &gt; colorpairs</div><div class="ttdef"><b>Definition:</b> <a href="cata__imgui_8cpp_source.html#l00036">cata_imgui.cpp:36</a></div></div>
<div class="ttc" id="acata__tiles_8h_html"><div class="ttname"><a href="cata__tiles_8h.html">cata_tiles.h</a></div></div>
<div class="ttc" id="acata__tiles_8h_html_a3d60e29ab63adaf6aef66d61fce44f23"><div class="ttname"><a href="cata__tiles_8h.html#a3d60e29ab63adaf6aef66d61fce44f23">color_block_overlay_container</a></div><div class="ttdeci">std::pair&lt; SDL_BlendMode, std::multimap&lt; point, SDL_Color &gt; &gt; color_block_overlay_container</div><div class="ttdoc">type used for color blocks overlays.</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00406">cata_tiles.h:406</a></div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4">TILE_CATEGORY</a></div><div class="ttdeci">TILE_CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00054">cata_tiles.h:54</a></div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a26d3b291eb79dc52744a2ebb34004e97"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a26d3b291eb79dc52744a2ebb34004e97">TILE_CATEGORY::TRAP</a></div><div class="ttdeci">@ TRAP</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a2b911c015ed17a423c74ab9987330e60"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a2b911c015ed17a423c74ab9987330e60">TILE_CATEGORY::ITEM</a></div><div class="ttdeci">@ ITEM</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a3535b8a10b75a49c73a56cb88ed6f2ad"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a3535b8a10b75a49c73a56cb88ed6f2ad">TILE_CATEGORY::OVERMAP_NOTE</a></div><div class="ttdeci">@ OVERMAP_NOTE</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a370f36e1c5ce51a59c8b3ebcc5ddeda6"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a370f36e1c5ce51a59c8b3ebcc5ddeda6">TILE_CATEGORY::HIT_ENTITY</a></div><div class="ttdeci">@ HIT_ENTITY</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a4467febb183d4c7dba4acf8a9742796e"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a4467febb183d4c7dba4acf8a9742796e">TILE_CATEGORY::OVERMAP_TERRAIN</a></div><div class="ttdeci">@ OVERMAP_TERRAIN</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a479a2f961e7db58cfe3291ea257d432a"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a479a2f961e7db58cfe3291ea257d432a">TILE_CATEGORY::FURNITURE</a></div><div class="ttdeci">@ FURNITURE</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a552a541802e89c9f535247f725bd1c0d">TILE_CATEGORY::FIELD</a></div><div class="ttdeci">@ FIELD</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a5fb9dc502beb6f75a2175f0ea535437d"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a5fb9dc502beb6f75a2175f0ea535437d">TILE_CATEGORY::BULLET</a></div><div class="ttdeci">@ BULLET</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a83a014c3c0a41242b5a879d011b677d6"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a83a014c3c0a41242b5a879d011b677d6">TILE_CATEGORY::WEATHER</a></div><div class="ttdeci">@ WEATHER</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a8b1aa4726295b67f4ca299670037daeb"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a8b1aa4726295b67f4ca299670037daeb">TILE_CATEGORY::LIGHTING</a></div><div class="ttdeci">@ LIGHTING</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a98bd1c45684cf587ac2347a92dd7bb51"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a98bd1c45684cf587ac2347a92dd7bb51">TILE_CATEGORY::last</a></div><div class="ttdeci">@ last</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4a9ce08b6c21dbec604d090444450f02cd">TILE_CATEGORY::VEHICLE_PART</a></div><div class="ttdeci">@ VEHICLE_PART</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4ab50339a10e1de285ac99d4c3990b8693">TILE_CATEGORY::NONE</a></div><div class="ttdeci">@ NONE</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4abdfa171c5b4d44824eec5798556eef32">TILE_CATEGORY::TERRAIN</a></div><div class="ttdeci">@ TERRAIN</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4afdd3a8eb3032c0124c1c43dec883b670"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afdd3a8eb3032c0124c1c43dec883b670">TILE_CATEGORY::MONSTER</a></div><div class="ttdeci">@ MONSTER</div></div>
<div class="ttc" id="acata__tiles_8h_html_a847d0e126a7684d25f82ed1bbeaeedf4afeb73e1c74ff492ff8fd4b8d38d490ef"><div class="ttname"><a href="cata__tiles_8h.html#a847d0e126a7684d25f82ed1bbeaeedf4afeb73e1c74ff492ff8fd4b8d38d490ef">TILE_CATEGORY::MAP_EXTRA</a></div><div class="ttdeci">@ MAP_EXTRA</div></div>
<div class="ttc" id="acata__tiles_8h_html_a86c8e5228d21b4eb72f10ef9a20d8362a2bf8f791695c70efa9c14e6f1c326403"><div class="ttname"><a href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a2bf8f791695c70efa9c14e6f1c326403">NEIGHBOUR::NORTH</a></div><div class="ttdeci">@ NORTH</div></div>
<div class="ttc" id="acata__tiles_8h_html_a86c8e5228d21b4eb72f10ef9a20d8362a45ac78bf3d4882ac520f4e7fb08d55c5"><div class="ttname"><a href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a45ac78bf3d4882ac520f4e7fb08d55c5">NEIGHBOUR::EAST</a></div><div class="ttdeci">@ EAST</div></div>
<div class="ttc" id="acata__tiles_8h_html_a86c8e5228d21b4eb72f10ef9a20d8362a83c9f5692281bf59471b13dfddb3af91"><div class="ttname"><a href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a83c9f5692281bf59471b13dfddb3af91">NEIGHBOUR::WEST</a></div><div class="ttdeci">@ WEST</div></div>
<div class="ttc" id="acata__tiles_8h_html_a86c8e5228d21b4eb72f10ef9a20d8362a96e44fa82e5a5263fb92337be422d3eb"><div class="ttname"><a href="cata__tiles_8h.html#a86c8e5228d21b4eb72f10ef9a20d8362a96e44fa82e5a5263fb92337be422d3eb">NEIGHBOUR::SOUTH</a></div><div class="ttdeci">@ SOUTH</div></div>
<div class="ttc" id="acata__tiles_8h_html_ab524e7890049130434bcc79cfa267ce9"><div class="ttname"><a href="cata__tiles_8h.html#ab524e7890049130434bcc79cfa267ce9">to_TILE_CATEGORY</a></div><div class="ttdeci">const std::unordered_map&lt; std::string, TILE_CATEGORY &gt; to_TILE_CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00073">cata_tiles.h:73</a></div></div>
<div class="ttc" id="acata__tiles_8h_html_affa90804269b044a43867f93746f8f8ea7c4f29407893c334a6cb7a87bf045c0d"><div class="ttname"><a href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8ea7c4f29407893c334a6cb7a87bf045c0d">text_alignment::right</a></div><div class="ttdeci">@ right</div></div>
<div class="ttc" id="acata__tiles_8h_html_affa90804269b044a43867f93746f8f8ea811882fecd5c7618d7099ebbd39ea254"><div class="ttname"><a href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8ea811882fecd5c7618d7099ebbd39ea254">text_alignment::left</a></div><div class="ttdeci">@ left</div></div>
<div class="ttc" id="acata__tiles_8h_html_affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667"><div class="ttname"><a href="cata__tiles_8h.html#affa90804269b044a43867f93746f8f8eaadb115059e28d960fa8badfac5516667">text_alignment::center</a></div><div class="ttdeci">@ center</div></div>
<div class="ttc" id="acata__utility_8cpp_html_a10f070374b4e9c11ba1c0229291b4355"><div class="ttname"><a href="cata__utility_8cpp.html#a10f070374b4e9c11ba1c0229291b4355">read_from_file</a></div><div class="ttdeci">bool read_from_file(const cata_path &amp;path, const std::function&lt; void(std::istream &amp;)&gt; &amp;reader)</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8cpp_source.html#l00447">cata_utility.cpp:447</a></div></div>
<div class="ttc" id="acata__utility_8cpp_html_aa6f470a02d08b2537d7ac06d3cabaf45"><div class="ttname"><a href="cata__utility_8cpp.html#aa6f470a02d08b2537d7ac06d3cabaf45">modulo</a></div><div class="ttdeci">int modulo(int v, int m)</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8cpp_source.html#l00075">cata_utility.cpp:75</a></div></div>
<div class="ttc" id="acata__utility_8cpp_html_adb0406f13ddb84bae4b718804fd599e9"><div class="ttname"><a href="cata__utility_8cpp.html#adb0406f13ddb84bae4b718804fd599e9">divide_round_down</a></div><div class="ttdeci">int divide_round_down(int a, int b)</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8cpp_source.html#l00062">cata_utility.cpp:62</a></div></div>
<div class="ttc" id="acata__utility_8h_html"><div class="ttname"><a href="cata__utility_8h.html">cata_utility.h</a></div></div>
<div class="ttc" id="acata__utility_8h_html_a00069567a0e8438fa2707a5214e53ca4"><div class="ttname"><a href="cata__utility_8h.html#a00069567a0e8438fa2707a5214e53ca4">string_starts_with</a></div><div class="ttdeci">bool string_starts_with(std::string_view s1, std::string_view s2)</div><div class="ttdoc">Returns true iff s1 starts with s2.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00450">cata_utility.h:450</a></div></div>
<div class="ttc" id="acata__utility_8h_html_a08531d647db70a8f67a522176a6f2130"><div class="ttname"><a href="cata__utility_8h.html#a08531d647db70a8f67a522176a6f2130">str_append</a></div><div class="ttdeci">std::string &amp; str_append(std::string &amp;root, T &amp;&amp;...a)</div><div class="ttdoc">Append all arguments after the first to the first.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00523">cata_utility.h:523</a></div></div>
<div class="ttc" id="acata__utility_8h_html_a9312e12ba19546023c021438a29b8830"><div class="ttname"><a href="cata__utility_8h.html#a9312e12ba19546023c021438a29b8830">divide_round_up</a></div><div class="ttdeci">T divide_round_up(T num, T den)</div><div class="ttdoc">Divide num by den, rounding up.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00079">cata_utility.h:79</a></div></div>
<div class="ttc" id="acata__utility_8h_html_a9739926e3b8f62356233563beb9542b2"><div class="ttname"><a href="cata__utility_8h.html#a9739926e3b8f62356233563beb9542b2">str_cat</a></div><div class="ttdeci">std::string str_cat(T0 &amp;&amp;a0, T &amp;&amp;...a)</div><div class="ttdoc">Concatenates a bunch of strings with append, to minimize unnecessary allocations.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00539">cata_utility.h:539</a></div></div>
<div class="ttc" id="acata__utility_8h_html_a9c0114ce66e3c9758214c5a9d68e8702"><div class="ttname"><a href="cata__utility_8h.html#a9c0114ce66e3c9758214c5a9d68e8702">string_ends_with</a></div><div class="ttdeci">bool string_ends_with(std::string_view s1, std::string_view s2)</div><div class="ttdoc">Returns true iff s1 ends with s2.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00458">cata_utility.h:458</a></div></div>
<div class="ttc" id="acata__utility_8h_html_ad22b4a043b6eb4c2c06f87f83b720b15"><div class="ttname"><a href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a></div><div class="ttdeci">constexpr T clamp(const T &amp;val, const T &amp;min, const T &amp;max)</div><div class="ttdoc">Clamp first argument so that it is no lower than second and no higher than third.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00221">cata_utility.h:221</a></div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a1e3f04102267eaf5e8d0ca424fd5c561"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a1e3f04102267eaf5e8d0ca424fd5c561">cata_variant_type::field_type_id</a></div><div class="ttdeci">@ field_type_id</div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a45a310b5cb289ed0e3a8870a1991736e">cata_variant_type::tripoint</a></div><div class="ttdeci">@ tripoint</div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a5b71ce78dc7a00ad2177c6655231928c"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5b71ce78dc7a00ad2177c6655231928c">cata_variant_type::itype_id</a></div><div class="ttdeci">@ itype_id</div></div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a78ee54aa8f813885fe2fe20d232518b9">cata_variant_type::point</a></div><div class="ttdeci">@ point</div></div>
<div class="ttc" id="acatacharset_8cpp_html_a2227e8c0afd74ed174cbb4daf8e46ab2"><div class="ttname"><a href="catacharset_8cpp.html#a2227e8c0afd74ed174cbb4daf8e46ab2">UTF8_getch</a></div><div class="ttdeci">uint32_t UTF8_getch(const char **src, int *srclen)</div><div class="ttdef"><b>Definition:</b> <a href="catacharset_8cpp_source.html#l00020">catacharset.cpp:20</a></div></div>
<div class="ttc" id="acatacharset_8cpp_html_af20ee33da59ccceb9f4c14005c0bbe80"><div class="ttname"><a href="catacharset_8cpp.html#af20ee33da59ccceb9f4c14005c0bbe80">utf8_width</a></div><div class="ttdeci">int utf8_width(const std::string_view s, const bool ignore_tags)</div><div class="ttdef"><b>Definition:</b> <a href="catacharset_8cpp_source.html#l00104">catacharset.cpp:104</a></div></div>
<div class="ttc" id="acatacharset_8h_html"><div class="ttname"><a href="catacharset_8h.html">catacharset.h</a></div></div>
<div class="ttc" id="acatacharset_8h_html_ad1552b0ee59f5106267a8417a2f620a8"><div class="ttname"><a href="catacharset_8h.html#ad1552b0ee59f5106267a8417a2f620a8">UNKNOWN_UNICODE</a></div><div class="ttdeci">constexpr int UNKNOWN_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="catacharset_8h_source.html#l00015">catacharset.h:15</a></div></div>
<div class="ttc" id="acharacter_8h_html"><div class="ttname"><a href="character_8h.html">character.h</a></div></div>
<div class="ttc" id="acharacter_8h_html_abaafa6561de05c3b1324214e3048745a"><div class="ttname"><a href="character_8h.html#abaafa6561de05c3b1324214e3048745a">get_player_character</a></div><div class="ttdeci">Character &amp; get_player_character()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13807">game.cpp:13807</a></div></div>
<div class="ttc" id="acharacter_8h_html_ad87be595004034c31843cf782d41c0b5acd90043f9adf49fd333cd2109af3f2f5"><div class="ttname"><a href="character_8h.html#ad87be595004034c31843cf782d41c0b5acd90043f9adf49fd333cd2109af3f2f5">NV_GOGGLES</a></div><div class="ttdeci">@ NV_GOGGLES</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00133">character.h:133</a></div></div>
<div class="ttc" id="acharacter__id_8h_html"><div class="ttname"><a href="character__id_8h.html">character_id.h</a></div></div>
<div class="ttc" id="aclassCharacter_html"><div class="ttname"><a href="classCharacter.html">Character</a></div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00522">character.h:523</a></div></div>
<div class="ttc" id="aclassCharacter_html_a0701e6a3f1987d9fa3f76b450dd5624a"><div class="ttname"><a href="classCharacter.html#a0701e6a3f1987d9fa3f76b450dd5624a">Character::controlling_vehicle</a></div><div class="ttdeci">bool controlling_vehicle</div><div class="ttdoc">Is currently in control of a vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00559">character.h:559</a></div></div>
<div class="ttc" id="aclassCharacter_html_a290ab6aff408dbea2cdc7f5b5086d5b1"><div class="ttname"><a href="classCharacter.html#a290ab6aff408dbea2cdc7f5b5086d5b1">Character::get_overlay_ids</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; std::string, std::string &gt; &gt; get_overlay_ids() const</div><div class="ttdoc">Returns a list of the IDs of overlays on this character, sorted from &quot;lowest&quot; to &quot;highest&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03324">character.cpp:3324</a></div></div>
<div class="ttc" id="aclassCharacter_html_a5ac4e7940167393e27395b53b49db4bf"><div class="ttname"><a href="classCharacter.html#a5ac4e7940167393e27395b53b49db4bf">Character::get_vision_modes</a></div><div class="ttdeci">const std::bitset&lt; NUM_VISION_MODES &gt; &amp; get_vision_modes() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02645">character.h:2645</a></div></div>
<div class="ttc" id="aclassCharacter_html_a61bc9422c35b63128532af268e52cb71"><div class="ttname"><a href="classCharacter.html#a61bc9422c35b63128532af268e52cb71">Character::in_vehicle</a></div><div class="ttdeci">bool in_vehicle</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02693">character.h:2693</a></div></div>
<div class="ttc" id="aclassCharacter_html_a6592c35167738421f3e04ca8808d37db"><div class="ttname"><a href="classCharacter.html#a6592c35167738421f3e04ca8808d37db">Character::name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02684">character.h:2684</a></div></div>
<div class="ttc" id="aclassCharacter_html_a6b6a4fc8bbec9e138f0e3922bdbf2ce9"><div class="ttname"><a href="classCharacter.html#a6b6a4fc8bbec9e138f0e3922bdbf2ce9">Character::attitude_to</a></div><div class="ttdeci">Attitude attitude_to(const Creature &amp;other) const override</div><div class="ttdoc">Attitude (of this creature) towards another creature.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l11349">character.cpp:11349</a></div></div>
<div class="ttc" id="aclassCharacter_html_a8e6a78e6c4497a9aa7b8cc127dcdd4e3"><div class="ttname"><a href="classCharacter.html#a8e6a78e6c4497a9aa7b8cc127dcdd4e3">Character::male</a></div><div class="ttdeci">bool male</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02687">character.h:2687</a></div></div>
<div class="ttc" id="aclassCharacter_html_a8f914d66d3d996a1356a31caf1d44c13"><div class="ttname"><a href="classCharacter.html#a8f914d66d3d996a1356a31caf1d44c13">Character::is_npc</a></div><div class="ttdeci">bool is_npc() const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00538">character.h:538</a></div></div>
<div class="ttc" id="aclassCharacter_html_a906192bd3a5f29a61ee12695e18d2eb5"><div class="ttname"><a href="classCharacter.html#a906192bd3a5f29a61ee12695e18d2eb5">Character::sees</a></div><div class="ttdeci">bool sees(const tripoint &amp;t, bool is_avatar=false, int range_mod=0) const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l11397">character.cpp:11397</a></div></div>
<div class="ttc" id="aclassCharacter_html_a9333ab3cffa25b588ec5aa932db8d73d"><div class="ttname"><a href="classCharacter.html#a9333ab3cffa25b588ec5aa932db8d73d">Character::sees_with_specials</a></div><div class="ttdeci">bool sees_with_specials(const Creature &amp;critter) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l06064">character.cpp:6064</a></div></div>
<div class="ttc" id="aclassCharacter_html_a9976ba9d9bccdaff264bd834628b97ec"><div class="ttname"><a href="classCharacter.html#a9976ba9d9bccdaff264bd834628b97ec">Character::sees_with_infrared</a></div><div class="ttdeci">bool sees_with_infrared(const Creature &amp;critter) const</div><div class="ttdoc">Check whether the this player can see the other creature with infrared.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10481">character.cpp:10481</a></div></div>
<div class="ttc" id="aclassCharacter_html_a9b2b7e1e9f7bf88c5f0d7ea2155642be"><div class="ttname"><a href="classCharacter.html#a9b2b7e1e9f7bf88c5f0d7ea2155642be">Character::get_mutations</a></div><div class="ttdeci">std::vector&lt; trait_id &gt; get_mutations(bool include_hidden=true, bool ignore_enchantment=false, const std::function&lt; bool(const mutation_branch &amp;)&gt; &amp;filter=nullptr) const</div><div class="ttdoc">Get the idents of all traits/mutations.</div><div class="ttdef"><b>Definition:</b> <a href="newcharacter_8cpp_source.html#l04655">newcharacter.cpp:4655</a></div></div>
<div class="ttc" id="aclassCharacter_html_aa612bb3aab79906ce70c2c6acf8704ed"><div class="ttname"><a href="classCharacter.html#aa612bb3aab79906ce70c2c6acf8704ed">Character::get_overlay_ids_when_override_look</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; std::string, std::string &gt; &gt; get_overlay_ids_when_override_look() const</div><div class="ttdoc">Returns a list of the IDs of overlays on this character if the character has override look mutations ...</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03390">character.cpp:3390</a></div></div>
<div class="ttc" id="aclassCharacter_html_ac033cd38ee98900bb08eb196c674aa55"><div class="ttname"><a href="classCharacter.html#ac033cd38ee98900bb08eb196c674aa55">Character::grab_point</a></div><div class="ttdeci">tripoint grab_point</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00592">character.h:592</a></div></div>
<div class="ttc" id="aclassCharacter_html_ad142b103f316b95f28681bd5502e79ef"><div class="ttname"><a href="classCharacter.html#ad142b103f316b95f28681bd5502e79ef">Character::view_offset</a></div><div class="ttdeci">tripoint view_offset</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02705">character.h:2705</a></div></div>
<div class="ttc" id="aclassCharacter_html_af06dd97724f4f05df782e7a4b4f9cfe1"><div class="ttname"><a href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">Character::has_trait</a></div><div class="ttdeci">bool has_trait(const trait_id &amp;b) const override</div><div class="ttdoc">Returns true if the player has the entered trait.</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8cpp_source.html#l00111">mutation.cpp:111</a></div></div>
<div class="ttc" id="aclassCreature_html"><div class="ttname"><a href="classCreature.html">Creature</a></div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00250">creature.h:251</a></div></div>
<div class="ttc" id="aclassCreature_html_a1a65722d07102550f16d17ebd79e2743"><div class="ttname"><a href="classCreature.html#a1a65722d07102550f16d17ebd79e2743">Creature::pos</a></div><div class="ttdeci">tripoint pos() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00178">creature.cpp:178</a></div></div>
<div class="ttc" id="aclassCreature_html_a21b8fbeb525a28615eec6a6c22beff44"><div class="ttname"><a href="classCreature.html#a21b8fbeb525a28615eec6a6c22beff44">Creature::facing</a></div><div class="ttdeci">FacingDirection facing</div><div class="ttdoc">return the direction the creature is facing, for sdl horizontal flip</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00303">creature.h:303</a></div></div>
<div class="ttc" id="aclassCreature_html_a3efb920d8e3d22ee766b62012ad0f9cd"><div class="ttname"><a href="classCreature.html#a3efb920d8e3d22ee766b62012ad0f9cd">Creature::as_avatar</a></div><div class="ttdeci">virtual avatar * as_avatar()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00280">creature.h:280</a></div></div>
<div class="ttc" id="aclassCreature_html_a5f818f1aa899ba2e2765f327a020a878"><div class="ttname"><a href="classCreature.html#a5f818f1aa899ba2e2765f327a020a878">Creature::sees</a></div><div class="ttdeci">bool sees(const Creature &amp;critter) const override</div><div class="ttdoc">The functions check whether this creature can see the target.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00358">creature.cpp:358</a></div></div>
<div class="ttc" id="aclassCreature_html_a7bf62f4f36b0475f1f39ea27f3beebb0"><div class="ttname"><a href="classCreature.html#a7bf62f4f36b0475f1f39ea27f3beebb0">Creature::has_effect</a></div><div class="ttdeci">bool has_effect(const efftype_id &amp;eff_id, const bodypart_id &amp;bp) const</div><div class="ttdoc">Check if creature has the matching effect.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01770">creature.cpp:1770</a></div></div>
<div class="ttc" id="aclassCreature_html_a88c28bc08aa3e0d6fa1b187cee97d1c4"><div class="ttname"><a href="classCreature.html#a88c28bc08aa3e0d6fa1b187cee97d1c4">Creature::posz</a></div><div class="ttdeci">int posz() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00317">creature.h:317</a></div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217">Creature::Attitude</a></div><div class="ttdeci">Attitude</div><div class="ttdoc">Simplified attitude towards any creature: hostile - hate, want to kill, etc.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00352">creature.h:352</a></div></div>
<div class="ttc" id="aclassCreature_html_a8a475630b3289c468bd06cf114008217a8e1bde3c3d303163521522cf1d62f21f"><div class="ttname"><a href="classCreature.html#a8a475630b3289c468bd06cf114008217a8e1bde3c3d303163521522cf1d62f21f">Creature::Attitude::ANY</a></div><div class="ttdeci">@ ANY</div></div>
<div class="ttc" id="aclassCreature_html_a9f0365208b65ab1c45d23f03f402f491"><div class="ttname"><a href="classCreature.html#a9f0365208b65ab1c45d23f03f402f491">Creature::posy</a></div><div class="ttdeci">int posy() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00314">creature.h:314</a></div></div>
<div class="ttc" id="aclassCreature_html_ac209d32cbfd3774af3d5c0500e2fae52"><div class="ttname"><a href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">Creature::is_avatar</a></div><div class="ttdeci">virtual bool is_avatar() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00265">creature.h:265</a></div></div>
<div class="ttc" id="aclassCreature_html_ad628fd3820652dc675e2165d3252e6dc"><div class="ttname"><a href="classCreature.html#ad628fd3820652dc675e2165d3252e6dc">Creature::attitude_raw_string</a></div><div class="ttdeci">static std::string attitude_raw_string(Attitude att)</div><div class="ttdoc">Simplified attitude string for unlocalized needs.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l03074">creature.cpp:3074</a></div></div>
<div class="ttc" id="aclassCreature_html_aec78049b0ee4401d3a4c073663735aad"><div class="ttname"><a href="classCreature.html#aec78049b0ee4401d3a4c073663735aad">Creature::has_flag</a></div><div class="ttdeci">virtual bool has_flag(const mon_flag_id &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00752">creature.h:752</a></div></div>
<div class="ttc" id="aclassCreature_html_aecea7d852ffba499ec12350c95340b9d"><div class="ttname"><a href="classCreature.html#aecea7d852ffba499ec12350c95340b9d">Creature::posx</a></div><div class="ttdeci">int posx() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00311">creature.h:311</a></div></div>
<div class="ttc" id="aclassJsonArray_html"><div class="ttname"><a href="classJsonArray.html">JsonArray</a></div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00346">flexbuffer_json.h:347</a></div></div>
<div class="ttc" id="aclassJsonArray_html_a7fce434cf8811c1de09a6fffcd3fc56c"><div class="ttname"><a href="classJsonArray.html#a7fce434cf8811c1de09a6fffcd3fc56c">JsonArray::test_int</a></div><div class="ttdeci">bool test_int() const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00706">flexbuffer_json-inl.h:706</a></div></div>
<div class="ttc" id="aclassJsonError_html"><div class="ttname"><a href="classJsonError.html">JsonError</a></div><div class="ttdef"><b>Definition:</b> <a href="json__error_8h_source.html#l00007">json_error.h:8</a></div></div>
<div class="ttc" id="aclassJsonObject_html"><div class="ttname"><a href="classJsonObject.html">JsonObject</a></div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00526">flexbuffer_json.h:527</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a04b6ce7355b567646a587514fb811c68"><div class="ttname"><a href="classJsonObject.html#a04b6ce7355b567646a587514fb811c68">JsonObject::throw_error_at</a></div><div class="ttdeci">void throw_error_at(std::string_view member, const std::string &amp;err) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8cpp_source.html#l00358">flexbuffer_json.cpp:358</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a1abb3808bb2a992716d5ef6f27a32b3c"><div class="ttname"><a href="classJsonObject.html#a1abb3808bb2a992716d5ef6f27a32b3c">JsonObject::get_string</a></div><div class="ttdeci">std::string get_string(const std::string &amp;key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00813">flexbuffer_json-inl.h:813</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a271bf0c222d2a7c97329df4362ae6a54"><div class="ttname"><a href="classJsonObject.html#a271bf0c222d2a7c97329df4362ae6a54">JsonObject::has_int</a></div><div class="ttdeci">bool has_int(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00956">flexbuffer_json-inl.h:956</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a332ecdfbbcefd21204fad5e03ff43735"><div class="ttname"><a href="classJsonObject.html#a332ecdfbbcefd21204fad5e03ff43735">JsonObject::get_string_array</a></div><div class="ttdeci">std::vector&lt; std::string &gt; get_string_array(std::string_view name) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00919">flexbuffer_json-inl.h:919</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a3b9722313d9692826235c87e73e94f04"><div class="ttname"><a href="classJsonObject.html#a3b9722313d9692826235c87e73e94f04">JsonObject::get_object</a></div><div class="ttdeci">JsonObject get_object(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00864">flexbuffer_json-inl.h:864</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a3d748a5d67f435bbd170a3e92a7cd0ca"><div class="ttname"><a href="classJsonObject.html#a3d748a5d67f435bbd170a3e92a7cd0ca">JsonObject::get_bool</a></div><div class="ttdeci">bool get_bool(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00850">flexbuffer_json-inl.h:850</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a4d917fcb285203f91b74002565375dce"><div class="ttname"><a href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">JsonObject::has_array</a></div><div class="ttdeci">bool has_array(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00984">flexbuffer_json-inl.h:984</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a532ea812759469d654c7fde4738d11d5"><div class="ttname"><a href="classJsonObject.html#a532ea812759469d654c7fde4738d11d5">JsonObject::get_int</a></div><div class="ttdeci">int get_int(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00840">flexbuffer_json-inl.h:840</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a619cb4eae7922f357db47479fc71cf9b"><div class="ttname"><a href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">JsonObject::has_member</a></div><div class="ttdeci">bool has_member(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00944">flexbuffer_json-inl.h:944</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a88142edb1dd9ea1e7a96c7a99cd70896"><div class="ttname"><a href="classJsonObject.html#a88142edb1dd9ea1e7a96c7a99cd70896">JsonObject::get_array</a></div><div class="ttdeci">JsonArray get_array(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00855">flexbuffer_json-inl.h:855</a></div></div>
<div class="ttc" id="aclassJsonObject_html_ac8dd6467300eb62e7ce842c3d99c083e"><div class="ttname"><a href="classJsonObject.html#ac8dd6467300eb62e7ce842c3d99c083e">JsonObject::has_string</a></div><div class="ttdeci">bool has_string(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00972">flexbuffer_json-inl.h:972</a></div></div>
<div class="ttc" id="aclassJsonObject_html_ae00f195360e3783cf50527cf07344202"><div class="ttname"><a href="classJsonObject.html#ae00f195360e3783cf50527cf07344202">JsonObject::allow_omitted_members</a></div><div class="ttdeci">void allow_omitted_members() const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00662">flexbuffer_json.h:662</a></div></div>
<div class="ttc" id="aclassJsonObject_html_af3e3ae76afc340c1fa3510acaaba57b8"><div class="ttname"><a href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">JsonObject::throw_error</a></div><div class="ttdeci">void throw_error(const std::string &amp;err) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8cpp_source.html#l00353">flexbuffer_json.cpp:353</a></div></div>
<div class="ttc" id="aclassJsonOut_html"><div class="ttname"><a href="classJsonOut.html">JsonOut</a></div><div class="ttdef"><b>Definition:</b> <a href="json_8h_source.html#l00735">json.h:736</a></div></div>
<div class="ttc" id="aclassJsonValue_html"><div class="ttname"><a href="classJsonValue.html">JsonValue</a></div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00166">flexbuffer_json.h:167</a></div></div>
<div class="ttc" id="aclassJsonValue_html_a1262851fe4201cfd471f481212da3de7"><div class="ttname"><a href="classJsonValue.html#a1262851fe4201cfd471f481212da3de7">JsonValue::read</a></div><div class="ttdeci">bool read(bool &amp;b, bool throw_on_error=false) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8cpp_source.html#l00143">flexbuffer_json.cpp:143</a></div></div>
<div class="ttc" id="aclassJsonValue_html_a330b5aee6bbf5749eb972c833d8d7b2a"><div class="ttname"><a href="classJsonValue.html#a330b5aee6bbf5749eb972c833d8d7b2a">JsonValue::test_array</a></div><div class="ttdeci">bool test_array() const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00225">flexbuffer_json-inl.h:225</a></div></div>
<div class="ttc" id="aclassJsonValue_html_aa90309342403c2e86b358ce996e34a1f"><div class="ttname"><a href="classJsonValue.html#aa90309342403c2e86b358ce996e34a1f">JsonValue::get_object</a></div><div class="ttdeci">JsonObject get_object() const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00268">flexbuffer_json-inl.h:268</a></div></div>
<div class="ttc" id="aclassJsonValue_html_ab7d103bab8c971a0c80972b04a18148f"><div class="ttname"><a href="classJsonValue.html#ab7d103bab8c971a0c80972b04a18148f">JsonValue::get_array</a></div><div class="ttdeci">JsonArray get_array() const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00263">flexbuffer_json-inl.h:263</a></div></div>
<div class="ttc" id="aclassMonsterGenerator_html_ab3ccba99cd10e85f8739e6af58956c0b"><div class="ttname"><a href="classMonsterGenerator.html#ab3ccba99cd10e85f8739e6af58956c0b">MonsterGenerator::generator</a></div><div class="ttdeci">static MonsterGenerator &amp; generator()</div><div class="ttdef"><b>Definition:</b> <a href="monstergenerator_8h_source.html#l00055">monstergenerator.h:55</a></div></div>
<div class="ttc" id="aclassavatar_html"><div class="ttname"><a href="classavatar.html">avatar</a></div><div class="ttdef"><b>Definition:</b> <a href="avatar_8h_source.html#l00083">avatar.h:84</a></div></div>
<div class="ttc" id="aclassavatar_html_a3f93e313b981c8a9a70f651d3cd4bbf3"><div class="ttname"><a href="classavatar.html#a3f93e313b981c8a9a70f651d3cd4bbf3">avatar::memorize_decoration</a></div><div class="ttdeci">void memorize_decoration(const tripoint_abs_ms &amp;p, std::string_view id, int subtile, int rotation)</div><div class="ttdef"><b>Definition:</b> <a href="avatar_8cpp_source.html#l00295">avatar.cpp:295</a></div></div>
<div class="ttc" id="aclassavatar_html_a3fe7bbe225126bee662ce6127526cdfb"><div class="ttname"><a href="classavatar.html#a3fe7bbe225126bee662ce6127526cdfb">avatar::get_grab_type</a></div><div class="ttdeci">object_type get_grab_type() const</div><div class="ttdef"><b>Definition:</b> <a href="avatar_8cpp_source.html#l00733">avatar.cpp:733</a></div></div>
<div class="ttc" id="aclassavatar_html_a73c5cdc86dbe8861397ac85d22122d12"><div class="ttname"><a href="classavatar.html#a73c5cdc86dbe8861397ac85d22122d12">avatar::get_memorized_tile</a></div><div class="ttdeci">const memorized_tile &amp; get_memorized_tile(const tripoint_abs_ms &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="avatar_8cpp_source.html#l00281">avatar.cpp:281</a></div></div>
<div class="ttc" id="aclassavatar_html_aa386699e6b2e7a85f60cdcb81d17538f"><div class="ttname"><a href="classavatar.html#aa386699e6b2e7a85f60cdcb81d17538f">avatar::memorize_clear_decoration</a></div><div class="ttdeci">void memorize_clear_decoration(const tripoint_abs_ms &amp;p, std::string_view prefix=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="avatar_8cpp_source.html#l00306">avatar.cpp:306</a></div></div>
<div class="ttc" id="aclassavatar_html_ab19cabc9e315ac018646a3b49d26bdf0"><div class="ttname"><a href="classavatar.html#ab19cabc9e315ac018646a3b49d26bdf0">avatar::memorize_terrain</a></div><div class="ttdeci">void memorize_terrain(const tripoint_abs_ms &amp;p, std::string_view id, int subtile, int rotation)</div><div class="ttdef"><b>Definition:</b> <a href="avatar_8cpp_source.html#l00289">avatar.cpp:289</a></div></div>
<div class="ttc" id="aclassavatar_html_aeb3d6148ca381978e3cc60d892846828"><div class="ttname"><a href="classavatar.html#aeb3d6148ca381978e3cc60d892846828">avatar::cant_see</a></div><div class="ttdeci">bool cant_see(const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="avatar_8cpp_source.html#l01233">avatar.cpp:1233</a></div></div>
<div class="ttc" id="aclassavatar_html_af690d039ef033cc62fe6c43a9519bb1d"><div class="ttname"><a href="classavatar.html#af690d039ef033cc62fe6c43a9519bb1d">avatar::prepare_map_memory_region</a></div><div class="ttdeci">void prepare_map_memory_region(const tripoint_abs_ms &amp;p1, const tripoint_abs_ms &amp;p2)</div><div class="ttdef"><b>Definition:</b> <a href="avatar_8cpp_source.html#l00276">avatar.cpp:276</a></div></div>
<div class="ttc" id="aclasscata__path_html"><div class="ttname"><a href="classcata__path.html">cata_path</a></div><div class="ttdoc">One of the problems of filesystem paths is they lack contextual awareness of 'where' they are.</div><div class="ttdef"><b>Definition:</b> <a href="cata__path_8h_source.html#l00033">cata_path.h:34</a></div></div>
<div class="ttc" id="aclasscata__path_html_a009b2bd4a635112ff57695717ff092c0"><div class="ttname"><a href="classcata__path.html#a009b2bd4a635112ff57695717ff092c0">cata_path::generic_u8string</a></div><div class="ttdeci">std::string generic_u8string() const</div><div class="ttdef"><b>Definition:</b> <a href="cata__path_8h_source.html#l00142">cata_path.h:142</a></div></div>
<div class="ttc" id="aclasscata__path_html_a646b95d8226cb386e914b263635efe35"><div class="ttname"><a href="classcata__path.html#a646b95d8226cb386e914b263635efe35">cata_path::get_unrelative_path</a></div><div class="ttdeci">fs::path get_unrelative_path() const</div><div class="ttdef"><b>Definition:</b> <a href="cata__path_8h_source.html#l00065">cata_path.h:65</a></div></div>
<div class="ttc" id="aclasscata__tiles_html_a00eee6b8b0ea991532c35d22b09fa0e7"><div class="ttname"><a href="classcata__tiles.html#a00eee6b8b0ea991532c35d22b09fa0e7">cata_tiles::has_draw_override</a></div><div class="ttdeci">bool has_draw_override(const tripoint &amp;p) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_a0275c4f823b364eb0c4d5c2567c3ac3e"><div class="ttname"><a href="classcata__tiles.html#a0275c4f823b364eb0c4d5c2567c3ac3e">cata_tiles::get_terrain_orientation</a></div><div class="ttdeci">void get_terrain_orientation(const tripoint &amp;p, int &amp;rota, int &amp;subtile, const std::map&lt; tripoint, ter_id &gt; &amp;ter_override, const std::array&lt; bool, 5 &gt; &amp;invisible, const std::bitset&lt; NUM_TERCONN &gt; &amp;rotate_group)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a065e55e5706f94dc703a1c3c7e5bf8f2"><div class="ttname"><a href="classcata__tiles.html#a065e55e5706f94dc703a1c3c7e5bf8f2">cata_tiles::draw_vpart_below</a></div><div class="ttdeci">bool draw_vpart_below(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a067e0649b72a41aa479ec12d90b72cba"><div class="ttname"><a href="classcata__tiles.html#a067e0649b72a41aa479ec12d90b72cba">cata_tiles::draw_sct_frame</a></div><div class="ttdeci">void draw_sct_frame(std::multimap&lt; point, formatted_text &gt; &amp;overlay_strings)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a07642d1c63dfe18a622d4ea9ea1825a3"><div class="ttname"><a href="classcata__tiles.html#a07642d1c63dfe18a622d4ea9ea1825a3">cata_tiles::init_draw_trap_override</a></div><div class="ttdeci">void init_draw_trap_override(const tripoint &amp;p, const trap_id &amp;id)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a078062c1314e92a5e61db571e42254ed"><div class="ttname"><a href="classcata__tiles.html#a078062c1314e92a5e61db571e42254ed">cata_tiles::has_memory_at</a></div><div class="ttdeci">bool has_memory_at(const tripoint_abs_ms &amp;p) const</div><div class="ttdoc">Map memory.</div></div>
<div class="ttc" id="aclasscata__tiles_html_a07f9d2a6ef5a989c9351417a1e6ee2ff"><div class="ttname"><a href="classcata__tiles.html#a07f9d2a6ef5a989c9351417a1e6ee2ff">cata_tiles::init_draw_vpart_override</a></div><div class="ttdeci">void init_draw_vpart_override(const tripoint &amp;p, const vpart_id &amp;id, int part_mod, const units::angle &amp;veh_dir, bool hilite, const point &amp;mount)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a097293f413b6e806f574baa2c258cefd"><div class="ttname"><a href="classcata__tiles.html#a097293f413b6e806f574baa2c258cefd">cata_tiles::void_zones</a></div><div class="ttdeci">void void_zones()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a0b3716b200bbf58ce31020df4333bf5e"><div class="ttname"><a href="classcata__tiles.html#a0b3716b200bbf58ce31020df4333bf5e">cata_tiles::tile_loading_report_count</a></div><div class="ttdeci">void tile_loading_report_count(size_t count, TILE_CATEGORY category, const std::string &amp;prefix=&quot;&quot;)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a0ed66c02bf90ce2ebfa85e77ef2854b4"><div class="ttname"><a href="classcata__tiles.html#a0ed66c02bf90ce2ebfa85e77ef2854b4">cata_tiles::init_draw_line</a></div><div class="ttdeci">void init_draw_line(const tripoint &amp;p, std::vector&lt; tripoint &gt; trajectory, std::string line_end_name, bool target_line)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a10021ef8a6d11168b56836d7e1c37dcc"><div class="ttname"><a href="classcata__tiles.html#a10021ef8a6d11168b56836d7e1c37dcc">cata_tiles::void_item_override</a></div><div class="ttdeci">void void_item_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a11af22cf3c9a2bbc9f9c3fc40bbe5324"><div class="ttname"><a href="classcata__tiles.html#a11af22cf3c9a2bbc9f9c3fc40bbe5324">cata_tiles::void_explosion</a></div><div class="ttdeci">void void_explosion()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a11c10516e9f2e08a1b9b386b9c6531bd"><div class="ttname"><a href="classcata__tiles.html#a11c10516e9f2e08a1b9b386b9c6531bd">cata_tiles::draw_from_id_string_internal</a></div><div class="ttdeci">bool draw_from_id_string_internal(const std::string &amp;id, const tripoint &amp;pos, int subtile, int rota, lit_level ll, int retract, bool apply_night_vision_goggles, int &amp;height_3d)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a11ca576aa837dabdc6f16e3206f48e4e"><div class="ttname"><a href="classcata__tiles.html#a11ca576aa837dabdc6f16e3206f48e4e">cata_tiles::is_isometric</a></div><div class="ttdeci">bool is_isometric() const</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00686">cata_tiles.h:686</a></div></div>
<div class="ttc" id="aclasscata__tiles_html_a156a038a2966c1cebf91192b40f2dfe0"><div class="ttname"><a href="classcata__tiles.html#a156a038a2966c1cebf91192b40f2dfe0">cata_tiles::memory_map_mode</a></div><div class="ttdeci">std::string memory_map_mode</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00829">cata_tiles.h:829</a></div></div>
<div class="ttc" id="aclasscata__tiles_html_a17ef88decc5224e93598fcba8cbb04b2"><div class="ttname"><a href="classcata__tiles.html#a17ef88decc5224e93598fcba8cbb04b2">cata_tiles::draw_entity_with_overlays</a></div><div class="ttdeci">void draw_entity_with_overlays(const Character &amp;ch, const tripoint &amp;p, lit_level ll, int &amp;height_3d)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a1ae092d4ae7edb014bb26712613452b1"><div class="ttname"><a href="classcata__tiles.html#a1ae092d4ae7edb014bb26712613452b1">cata_tiles::draw_hit_frame</a></div><div class="ttdeci">void draw_hit_frame()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a1b44014fe7f2010a42e857df157312bd"><div class="ttname"><a href="classcata__tiles.html#a1b44014fe7f2010a42e857df157312bd">cata_tiles::get_terrain_memory_at</a></div><div class="ttdeci">const memorized_tile &amp; get_terrain_memory_at(const tripoint_abs_ms &amp;p) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_a1c4823477289d055756ab6d65912567e"><div class="ttname"><a href="classcata__tiles.html#a1c4823477289d055756ab6d65912567e">cata_tiles::~cata_tiles</a></div><div class="ttdeci">~cata_tiles()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a1cded75a40f6d10c4101c747f80bd457"><div class="ttname"><a href="classcata__tiles.html#a1cded75a40f6d10c4101c747f80bd457">cata_tiles::draw_vpart_no_roof</a></div><div class="ttdeci">bool draw_vpart_no_roof(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a1e068b601f19c3b412cc778422ca2bfa"><div class="ttname"><a href="classcata__tiles.html#a1e068b601f19c3b412cc778422ca2bfa">cata_tiles::on_options_changed</a></div><div class="ttdeci">void on_options_changed()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a1fafa5bd77219f4b556de23207c292c8"><div class="ttname"><a href="classcata__tiles.html#a1fafa5bd77219f4b556de23207c292c8">cata_tiles::tile_loading_report_dups</a></div><div class="ttdeci">void tile_loading_report_dups()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a201af5ee04216f2b1c35cf197ae34f91"><div class="ttname"><a href="classcata__tiles.html#a201af5ee04216f2b1c35cf197ae34f91">cata_tiles::draw_tile_at</a></div><div class="ttdeci">bool draw_tile_at(const tile_type &amp;tile, const point &amp;, unsigned int loc_rand, int rota, lit_level ll, bool apply_night_vision_goggles, int retract, int &amp;height_3d, const point &amp;offset)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a270738a499079ff082921a6d81998388"><div class="ttname"><a href="classcata__tiles.html#a270738a499079ff082921a6d81998388">cata_tiles::draw_sprite_at</a></div><div class="ttdeci">bool draw_sprite_at(const tile_type &amp;tile, const weighted_int_list&lt; std::vector&lt; int &gt;&gt; &amp;svlist, const point &amp;, unsigned int loc_rand, bool rota_fg, int rota, lit_level ll, bool apply_night_vision_goggles, int retract, int &amp;height_3d, const point &amp;offset)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a28bd234da19f838335eaa1c7d5aa995c"><div class="ttname"><a href="classcata__tiles.html#a28bd234da19f838335eaa1c7d5aa995c">cata_tiles::draw_zlevel_overlay</a></div><div class="ttdeci">void draw_zlevel_overlay(const tripoint &amp;p, lit_level ll, int &amp;height_3d)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a2d3156f72aef976c0317bc8b49fd6b26"><div class="ttname"><a href="classcata__tiles.html#a2d3156f72aef976c0317bc8b49fd6b26">cata_tiles::draw_from_id_string</a></div><div class="ttdeci">bool draw_from_id_string(const std::string &amp;id, const tripoint &amp;pos, int subtile, int rota, lit_level ll, bool apply_night_vision_goggles)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a31c24814415ed89650a7bb25e3fc66c0"><div class="ttname"><a href="classcata__tiles.html#a31c24814415ed89650a7bb25e3fc66c0">cata_tiles::draw_terrain_below</a></div><div class="ttdeci">bool draw_terrain_below(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a3adef2397ed9571fc0785e7271ed770e"><div class="ttname"><a href="classcata__tiles.html#a3adef2397ed9571fc0785e7271ed770e">cata_tiles::void_cursor</a></div><div class="ttdeci">void void_cursor()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a3c80a60ff014eead9fee2d5429507463"><div class="ttname"><a href="classcata__tiles.html#a3c80a60ff014eead9fee2d5429507463">cata_tiles::draw_footsteps_frame</a></div><div class="ttdeci">void draw_footsteps_frame(const tripoint &amp;center)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a450c8afdd717655f3aa4a6503b7462a7"><div class="ttname"><a href="classcata__tiles.html#a450c8afdd717655f3aa4a6503b7462a7">cata_tiles::tile_loading_report_seq_types</a></div><div class="ttdeci">void tile_loading_report_seq_types(const Sequence &amp;tiletypes, TILE_CATEGORY category, const std::string &amp;prefix=&quot;&quot;)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a46bd185110872077b734d30dc2522ffd"><div class="ttname"><a href="classcata__tiles.html#a46bd185110872077b734d30dc2522ffd">cata_tiles::reinit</a></div><div class="ttdeci">void reinit()</div><div class="ttdoc">Reinitializes the current tileset, like init, but using the original screen information.</div></div>
<div class="ttc" id="aclasscata__tiles_html_a46e297a26edbef8a38dc53a4a843101d"><div class="ttname"><a href="classcata__tiles.html#a46e297a26edbef8a38dc53a4a843101d">cata_tiles::init_draw_async_anim</a></div><div class="ttdeci">void init_draw_async_anim(const tripoint &amp;p, const std::string &amp;tile_id)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a4acce8fe0a9c5d3e38b55d5ed9d08e93"><div class="ttname"><a href="classcata__tiles.html#a4acce8fe0a9c5d3e38b55d5ed9d08e93">cata_tiles::init_draw_below_override</a></div><div class="ttdeci">void init_draw_below_override(const tripoint &amp;p, bool draw)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a4cb480be7ebba9b53f5655054790eadf"><div class="ttname"><a href="classcata__tiles.html#a4cb480be7ebba9b53f5655054790eadf">cata_tiles::get_window_full_base_tile_range</a></div><div class="ttdeci">half_open_rectangle&lt; point &gt; get_window_full_base_tile_range(const point &amp;size) const</div><div class="ttdoc">Coordinate range of fully shown tiles that fit into the given dimensions, disregarding any extra cont...</div></div>
<div class="ttc" id="aclasscata__tiles_html_a4ef5afe9f52c7e10a08e8c37864f0459"><div class="ttname"><a href="classcata__tiles.html#a4ef5afe9f52c7e10a08e8c37864f0459">cata_tiles::draw_trap</a></div><div class="ttdeci">bool draw_trap(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a4f737cbae2461a609038e8f747c72400"><div class="ttname"><a href="classcata__tiles.html#a4f737cbae2461a609038e8f747c72400">cata_tiles::init_draw_graffiti_override</a></div><div class="ttdeci">void init_draw_graffiti_override(const tripoint &amp;p, bool has)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a51a7955aa4dacc5bb297285b27f752be"><div class="ttname"><a href="classcata__tiles.html#a51a7955aa4dacc5bb297285b27f752be">cata_tiles::draw_part_con</a></div><div class="ttdeci">bool draw_part_con(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a52ccd64e7a34ca1a76c2c63c6b92c9ab"><div class="ttname"><a href="classcata__tiles.html#a52ccd64e7a34ca1a76c2c63c6b92c9ab">cata_tiles::minimap</a></div><div class="ttdeci">pimpl&lt; pixel_minimap &gt; minimap</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00823">cata_tiles.h:823</a></div></div>
<div class="ttc" id="aclasscata__tiles_html_a57482c189f06f5af3e75b5b020c0f0eb"><div class="ttname"><a href="classcata__tiles.html#a57482c189f06f5af3e75b5b020c0f0eb">cata_tiles::draw_critter_at</a></div><div class="ttdeci">bool draw_critter_at(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a57944c39e219b0e84a80149d99463111"><div class="ttname"><a href="classcata__tiles.html#a57944c39e219b0e84a80149d99463111">cata_tiles::void_furniture_override</a></div><div class="ttdeci">void void_furniture_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a5a88605a5b9b1f5523f75b7d254cc468"><div class="ttname"><a href="classcata__tiles.html#a5a88605a5b9b1f5523f75b7d254cc468">cata_tiles::renderer</a></div><div class="ttdeci">const SDL_Renderer_Ptr &amp; renderer</div><div class="ttdoc">Variables.</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00734">cata_tiles.h:734</a></div></div>
<div class="ttc" id="aclasscata__tiles_html_a5ab8dba6e3b3c0ef1e3189a7b14a7553"><div class="ttname"><a href="classcata__tiles.html#a5ab8dba6e3b3c0ef1e3189a7b14a7553">cata_tiles::build_renderer_list</a></div><div class="ttdeci">static std::vector&lt; options_manager::id_and_option &gt; build_renderer_list()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a5bc94323ca542f59e657d8fb50635e74"><div class="ttname"><a href="classcata__tiles.html#a5bc94323ca542f59e657d8fb50635e74">cata_tiles::get_trap_memory_at</a></div><div class="ttdeci">const memorized_tile &amp; get_trap_memory_at(const tripoint_abs_ms &amp;p) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_a5c641161a758a940a813ce4585ca8b80"><div class="ttname"><a href="classcata__tiles.html#a5c641161a758a940a813ce4585ca8b80">cata_tiles::find_tile_with_season</a></div><div class="ttdeci">std::optional&lt; tile_lookup_res &gt; find_tile_with_season(const std::string &amp;id) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_a5d4a9c92c8ad55778836ca54b8c3f936"><div class="ttname"><a href="classcata__tiles.html#a5d4a9c92c8ad55778836ca54b8c3f936">cata_tiles::cata_tiles</a></div><div class="ttdeci">cata_tiles(const SDL_Renderer_Ptr &amp;render, const GeometryRenderer_Ptr &amp;geometry, tileset_cache &amp;cache)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a5e469c34909a46bcba765ac8421906c4"><div class="ttname"><a href="classcata__tiles.html#a5e469c34909a46bcba765ac8421906c4">cata_tiles::draw_custom_explosion_frame</a></div><div class="ttdeci">void draw_custom_explosion_frame()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a5f0e3fe656ef58b7d07653dc60a9445b"><div class="ttname"><a href="classcata__tiles.html#a5f0e3fe656ef58b7d07653dc60a9445b">cata_tiles::init_draw_furniture_override</a></div><div class="ttdeci">void init_draw_furniture_override(const tripoint &amp;p, const furn_id &amp;id)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a5f3d1d10096cdd601dfbca8955e0ab26"><div class="ttname"><a href="classcata__tiles.html#a5f3d1d10096cdd601dfbca8955e0ab26">cata_tiles::get_rotation_and_subtile</a></div><div class="ttdeci">static void get_rotation_and_subtile(char val, char rot_to, int &amp;rota, int &amp;subtile)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a5fd0e0c2dee0096bd05f1d5879ec9b83"><div class="ttname"><a href="classcata__tiles.html#a5fd0e0c2dee0096bd05f1d5879ec9b83">cata_tiles::void_terrain_override</a></div><div class="ttdeci">void void_terrain_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a60573ddae0afec2d6c8fbad0d10331d8"><div class="ttname"><a href="classcata__tiles.html#a60573ddae0afec2d6c8fbad0d10331d8">cata_tiles::get_rotation_edge_ns</a></div><div class="ttdeci">static int get_rotation_edge_ns(char rot_to)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a6158cb3bafd5267fdd9a78e8c6820400"><div class="ttname"><a href="classcata__tiles.html#a6158cb3bafd5267fdd9a78e8c6820400">cata_tiles::draw_bullet_frame</a></div><div class="ttdeci">void draw_bullet_frame()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a631db34c3736d6580d7ea28fb5032eb2"><div class="ttname"><a href="classcata__tiles.html#a631db34c3736d6580d7ea28fb5032eb2">cata_tiles::draw_cursor</a></div><div class="ttdeci">void draw_cursor()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a648ab890b9dec665f94242f839194016"><div class="ttname"><a href="classcata__tiles.html#a648ab890b9dec665f94242f839194016">cata_tiles::would_apply_vision_effects</a></div><div class="ttdeci">bool would_apply_vision_effects(visibility_type visibility) const</div><div class="ttdoc">Drawing Layers.</div></div>
<div class="ttc" id="aclasscata__tiles_html_a68eb43336124082b2dfd137219ff736b"><div class="ttname"><a href="classcata__tiles.html#a68eb43336124082b2dfd137219ff736b">cata_tiles::init_light</a></div><div class="ttdeci">void init_light()</div><div class="ttdoc">Lighting.</div></div>
<div class="ttc" id="aclasscata__tiles_html_a68f083b016b41d7e5d19e1c58579cd69"><div class="ttname"><a href="classcata__tiles.html#a68f083b016b41d7e5d19e1c58579cd69">cata_tiles::init_draw_item_override</a></div><div class="ttdeci">void init_draw_item_override(const tripoint &amp;p, const itype_id &amp;id, const mtype_id &amp;mid, bool hilite)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a69251791dbc951927838245a26d3dae6"><div class="ttname"><a href="classcata__tiles.html#a69251791dbc951927838245a26d3dae6">cata_tiles::draw_highlight</a></div><div class="ttdeci">void draw_highlight()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a6a17ed4a354880ccd65915775cfcd39f"><div class="ttname"><a href="classcata__tiles.html#a6a17ed4a354880ccd65915775cfcd39f">cata_tiles::init_draw_zones</a></div><div class="ttdeci">void init_draw_zones(const tripoint &amp;start, const tripoint &amp;end, const tripoint &amp;offset)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a6af13732ce3cb22eb8757fbaf66c6c91"><div class="ttname"><a href="classcata__tiles.html#a6af13732ce3cb22eb8757fbaf66c6c91">cata_tiles::void_custom_explosion</a></div><div class="ttdeci">void void_custom_explosion()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a6b8c080c92c765f22391fdbd5ab48724"><div class="ttname"><a href="classcata__tiles.html#a6b8c080c92c765f22391fdbd5ab48724">cata_tiles::draw_terrain</a></div><div class="ttdeci">bool draw_terrain(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a6e035d6488ebe68a18badd5b936f7064"><div class="ttname"><a href="classcata__tiles.html#a6e035d6488ebe68a18badd5b936f7064">cata_tiles::draw_item_highlight</a></div><div class="ttdeci">bool draw_item_highlight(const tripoint &amp;pos, int &amp;height_3d)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a6e2d47bb4200116afcb941ff64e0c871"><div class="ttname"><a href="classcata__tiles.html#a6e2d47bb4200116afcb941ff64e0c871">cata_tiles::get_vpart_memory_at</a></div><div class="ttdeci">const memorized_tile &amp; get_vpart_memory_at(const tripoint_abs_ms &amp;p) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_a710aafbcad966ee5d6096ca989874b9b"><div class="ttname"><a href="classcata__tiles.html#a710aafbcad966ee5d6096ca989874b9b">cata_tiles::build_display_list</a></div><div class="ttdeci">static std::vector&lt; options_manager::id_and_option &gt; build_display_list()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a7332ece01534dc1df3d1482039f7b408"><div class="ttname"><a href="classcata__tiles.html#a7332ece01534dc1df3d1482039f7b408">cata_tiles::void_radiation_override</a></div><div class="ttdeci">void void_radiation_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a74e94514c3b73f5e0367d5c1dab721ae"><div class="ttname"><a href="classcata__tiles.html#a74e94514c3b73f5e0367d5c1dab721ae">cata_tiles::fog_alpha</a></div><div class="ttdeci">int fog_alpha</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00753">cata_tiles.h:753</a></div></div>
<div class="ttc" id="aclasscata__tiles_html_a7a5375334ee33f9d871879017597ae98"><div class="ttname"><a href="classcata__tiles.html#a7a5375334ee33f9d871879017597ae98">cata_tiles::void_sct</a></div><div class="ttdeci">void void_sct()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a7adcf2e2d5af90ee464fe1c534f8c332"><div class="ttname"><a href="classcata__tiles.html#a7adcf2e2d5af90ee464fe1c534f8c332">cata_tiles::void_highlight</a></div><div class="ttdeci">void void_highlight()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a7bd15102861cd368a24b1dbf09c959c7"><div class="ttname"><a href="classcata__tiles.html#a7bd15102861cd368a24b1dbf09c959c7">cata_tiles::get_furniture_memory_at</a></div><div class="ttdeci">const memorized_tile &amp; get_furniture_memory_at(const tripoint_abs_ms &amp;p) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_a7da5291a7e43432e0f0c19e7051f5a52"><div class="ttname"><a href="classcata__tiles.html#a7da5291a7e43432e0f0c19e7051f5a52">cata_tiles::void_async_anim</a></div><div class="ttdeci">void void_async_anim()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a7da76855b701d38da8acb5ea329ea2b9"><div class="ttname"><a href="classcata__tiles.html#a7da76855b701d38da8acb5ea329ea2b9">cata_tiles::load_tileset</a></div><div class="ttdeci">void load_tileset(const std::string &amp;tileset_id, bool precheck=false, bool force=false, bool pump_events=false)</div><div class="ttdoc">Initialize the current tileset (load tile images, load mapping), using the current tileset as it is s...</div></div>
<div class="ttc" id="aclasscata__tiles_html_a8059269595873b6f998b76d93b9d9077"><div class="ttname"><a href="classcata__tiles.html#a8059269595873b6f998b76d93b9d9077">cata_tiles::get_rotation_edge_ew</a></div><div class="ttdeci">static int get_rotation_edge_ew(char rot_to)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a820388e4b879abab145e6dbc00413cfb"><div class="ttname"><a href="classcata__tiles.html#a820388e4b879abab145e6dbc00413cfb">cata_tiles::void_trap_override</a></div><div class="ttdeci">void void_trap_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a8340d4b1e13e103ba5f3903a8eae0af5"><div class="ttname"><a href="classcata__tiles.html#a8340d4b1e13e103ba5f3903a8eae0af5">cata_tiles::init_draw_terrain_override</a></div><div class="ttdeci">void init_draw_terrain_override(const tripoint &amp;p, const ter_id &amp;id)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a834496947d35774c9f0c3fe12d717b3d"><div class="ttname"><a href="classcata__tiles.html#a834496947d35774c9f0c3fe12d717b3d">cata_tiles::void_bullet</a></div><div class="ttdeci">void void_bullet()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a8614da22369731a18369471a6ef6d634"><div class="ttname"><a href="classcata__tiles.html#a8614da22369731a18369471a6ef6d634">cata_tiles::draw_zone_mark</a></div><div class="ttdeci">bool draw_zone_mark(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a8754be9e0df7a9f4994fce3053fe6747"><div class="ttname"><a href="classcata__tiles.html#a8754be9e0df7a9f4994fce3053fe6747">cata_tiles::find_overlay_looks_like</a></div><div class="ttdeci">bool find_overlay_looks_like(bool male, const std::string &amp;overlay, const std::string &amp;variant, std::string &amp;draw_id)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a8797277bc2bb2b75649ed0094de42e54"><div class="ttname"><a href="classcata__tiles.html#a8797277bc2bb2b75649ed0094de42e54">cata_tiles::init_draw_monster_override</a></div><div class="ttdeci">void init_draw_monster_override(const tripoint &amp;p, const mtype_id &amp;id, int count, bool more, Creature::Attitude att)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a8a20bcd3986d3e374367dfe9bf14ae62"><div class="ttname"><a href="classcata__tiles.html#a8a20bcd3986d3e374367dfe9bf14ae62">cata_tiles::init_custom_explosion_layer</a></div><div class="ttdeci">void init_custom_explosion_layer(const std::map&lt; tripoint, explosion_tile &gt; &amp;layer)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a8af75e3afc58a4cc563d6cadfaa26d51"><div class="ttname"><a href="classcata__tiles.html#a8af75e3afc58a4cc563d6cadfaa26d51">cata_tiles::draw_critter_at_below</a></div><div class="ttdeci">bool draw_critter_at_below(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a8d20b079df643f0722ddf1d023f23da5"><div class="ttname"><a href="classcata__tiles.html#a8d20b079df643f0722ddf1d023f23da5">cata_tiles::void_line</a></div><div class="ttdeci">void void_line()</div></div>
<div class="ttc" id="aclasscata__tiles_html_a8f0786c7bc8932177815c50dcc251e04"><div class="ttname"><a href="classcata__tiles.html#a8f0786c7bc8932177815c50dcc251e04">cata_tiles::init_draw_hit</a></div><div class="ttdeci">void init_draw_hit(const tripoint &amp;p, std::string name)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a9860055508cc1c87454f977499018405"><div class="ttname"><a href="classcata__tiles.html#a9860055508cc1c87454f977499018405">cata_tiles::init_draw_weather</a></div><div class="ttdeci">void init_draw_weather(weather_printable weather, std::string name)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a99ee5b9130e7f84721f9acebc6ccafc3"><div class="ttname"><a href="classcata__tiles.html#a99ee5b9130e7f84721f9acebc6ccafc3">cata_tiles::draw_graffiti</a></div><div class="ttdeci">bool draw_graffiti(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a9a10feb3534fa79e387b0efd31c36030"><div class="ttname"><a href="classcata__tiles.html#a9a10feb3534fa79e387b0efd31c36030">cata_tiles::get_window_base_tile_counts</a></div><div class="ttdeci">point get_window_base_tile_counts(const point &amp;size) const</div><div class="ttdoc">How many rows and columns of tiles fit into given dimensions, fully or partially shown,...</div></div>
<div class="ttc" id="aclasscata__tiles_html_a9d05eb6d00316ddd8a8dff517da05b25"><div class="ttname"><a href="classcata__tiles.html#a9d05eb6d00316ddd8a8dff517da05b25">cata_tiles::find_tile_looks_like</a></div><div class="ttdeci">std::optional&lt; tile_lookup_res &gt; find_tile_looks_like(const std::string &amp;id, TILE_CATEGORY category, const std::string &amp;variant, int looks_like_jumps_limit=10) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_a9de43f937c038956997c0c574bd9cb29"><div class="ttname"><a href="classcata__tiles.html#a9de43f937c038956997c0c574bd9cb29">cata_tiles::cache</a></div><div class="ttdeci">tileset_cache &amp; cache</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00736">cata_tiles.h:736</a></div></div>
<div class="ttc" id="aclasscata__tiles_html_a9e3538ad287a3c09f21457808d6e1736"><div class="ttname"><a href="classcata__tiles.html#a9e3538ad287a3c09f21457808d6e1736">cata_tiles::init_draw_field_override</a></div><div class="ttdeci">void init_draw_field_override(const tripoint &amp;p, const field_type_id &amp;id)</div></div>
<div class="ttc" id="aclasscata__tiles_html_a9fc965f8022f63cd8f09ea06a3ab63b8"><div class="ttname"><a href="classcata__tiles.html#a9fc965f8022f63cd8f09ea06a3ab63b8">cata_tiles::tile_loading_report_map</a></div><div class="ttdeci">void tile_loading_report_map(const maptype &amp;tiletypemap, TILE_CATEGORY category, const std::string &amp;prefix=&quot;&quot;)</div></div>
<div class="ttc" id="aclasscata__tiles_html_aa2c979ea5d726c3e554dd9500e3b6e4d"><div class="ttname"><a href="classcata__tiles.html#aa2c979ea5d726c3e554dd9500e3b6e4d">cata_tiles::draw_vpart</a></div><div class="ttdeci">bool draw_vpart(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool roof, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_aa304115785ac2a0ed19087f26fbd8980"><div class="ttname"><a href="classcata__tiles.html#aa304115785ac2a0ed19087f26fbd8980">cata_tiles::init_draw_cursor</a></div><div class="ttdeci">void init_draw_cursor(const tripoint &amp;p)</div></div>
<div class="ttc" id="aclasscata__tiles_html_aa4798ea81ef35ccc5fa456513ab7b1df"><div class="ttname"><a href="classcata__tiles.html#aa4798ea81ef35ccc5fa456513ab7b1df">cata_tiles::draw_line</a></div><div class="ttdeci">void draw_line()</div></div>
<div class="ttc" id="aclasscata__tiles_html_aa81cc5f7a3ca0ba7cce6a6a4e36102ac"><div class="ttname"><a href="classcata__tiles.html#aa81cc5f7a3ca0ba7cce6a6a4e36102ac">cata_tiles::tile_loading_report_seq_ids</a></div><div class="ttdeci">void tile_loading_report_seq_ids(const Sequence &amp;tiletypes, TILE_CATEGORY category, const std::string &amp;prefix=&quot;&quot;)</div></div>
<div class="ttc" id="aclasscata__tiles_html_aa82a0e096f56193737a998ce6c8251e8"><div class="ttname"><a href="classcata__tiles.html#aa82a0e096f56193737a998ce6c8251e8">cata_tiles::draw_minimap</a></div><div class="ttdeci">void draw_minimap(const point &amp;dest, const tripoint &amp;center, int width, int height)</div><div class="ttdoc">Minimap functionality.</div></div>
<div class="ttc" id="aclasscata__tiles_html_aa9683d157ee79e2bed3e6a0b710a3750"><div class="ttname"><a href="classcata__tiles.html#aa9683d157ee79e2bed3e6a0b710a3750">cata_tiles::lr_generic</a></div><div class="ttdeci">void lr_generic(Iter begin, Iter end, Func id_func, TILE_CATEGORY category, const std::string &amp;prefix)</div><div class="ttdoc">Generic tile_loading_report, begin and end are iterators, id_func translates the iterator to an id st...</div></div>
<div class="ttc" id="aclasscata__tiles_html_ab266711860484a85caaabbe6ca3e6752"><div class="ttname"><a href="classcata__tiles.html#ab266711860484a85caaabbe6ca3e6752">cata_tiles::tile_to_player</a></div><div class="ttdeci">std::optional&lt; point &gt; tile_to_player(const point &amp;colrow) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_ab2fbcdf5ff33028beb88d0d148007d4a"><div class="ttname"><a href="classcata__tiles.html#ab2fbcdf5ff33028beb88d0d148007d4a">cata_tiles::draw</a></div><div class="ttdeci">void draw(const point &amp;dest, const tripoint &amp;center, int width, int height, std::multimap&lt; point, formatted_text &gt; &amp;overlay_strings, color_block_overlay_container &amp;color_blocks)</div><div class="ttdoc">Draw to screen.</div></div>
<div class="ttc" id="aclasscata__tiles_html_ab4f72dd1ee657c490764a9150bc72fa4"><div class="ttname"><a href="classcata__tiles.html#ab4f72dd1ee657c490764a9150bc72fa4">cata_tiles::void_graffiti_override</a></div><div class="ttdeci">void void_graffiti_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_ab5b62a4248bc1579630384128765d1b3"><div class="ttname"><a href="classcata__tiles.html#ab5b62a4248bc1579630384128765d1b3">cata_tiles::get_tile_values_with_ter</a></div><div class="ttdeci">void get_tile_values_with_ter(const tripoint &amp;p, int t, const std::array&lt; int, 4 &gt; &amp;tn, int &amp;subtile, int &amp;rotation, const std::bitset&lt; NUM_TERCONN &gt; &amp;rotate_to_group)</div></div>
<div class="ttc" id="aclasscata__tiles_html_ab8a53ea1dd3d0ec554735b625cfc2558"><div class="ttname"><a href="classcata__tiles.html#ab8a53ea1dd3d0ec554735b625cfc2558">cata_tiles::draw_furniture</a></div><div class="ttdeci">bool draw_furniture(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_ab8eb7105d6b85d937f8baa6918635f75"><div class="ttname"><a href="classcata__tiles.html#ab8eb7105d6b85d937f8baa6918635f75">cata_tiles::void_vpart_override</a></div><div class="ttdeci">void void_vpart_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_ab9805d867df123ef18d483ea887eda85"><div class="ttname"><a href="classcata__tiles.html#ab9805d867df123ef18d483ea887eda85">cata_tiles::init_draw_sct</a></div><div class="ttdeci">void init_draw_sct()</div></div>
<div class="ttc" id="aclasscata__tiles_html_aba324f7c546fb093eb0430b8235fc2a4"><div class="ttname"><a href="classcata__tiles.html#aba324f7c546fb093eb0430b8235fc2a4">cata_tiles::player_to_screen</a></div><div class="ttdeci">point player_to_screen(const point &amp;pos) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_aba40b04dd925a15c62f0c6b1d14383c4"><div class="ttname"><a href="classcata__tiles.html#aba40b04dd925a15c62f0c6b1d14383c4">cata_tiles::get_rotation_unconnected</a></div><div class="ttdeci">static int get_rotation_unconnected(char rot_to)</div></div>
<div class="ttc" id="aclasscata__tiles_html_aba8fa0945b720f6b625e412c61bab476"><div class="ttname"><a href="classcata__tiles.html#aba8fa0945b720f6b625e412c61bab476">cata_tiles::void_hit</a></div><div class="ttdeci">void void_hit()</div></div>
<div class="ttc" id="aclasscata__tiles_html_abb3ddb2b71d8b2286389eb2bb4b122fb"><div class="ttname"><a href="classcata__tiles.html#abb3ddb2b71d8b2286389eb2bb4b122fb">cata_tiles::draw_critter_above</a></div><div class="ttdeci">bool draw_critter_above(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible)</div></div>
<div class="ttc" id="aclasscata__tiles_html_abb86896bb9f3e1c1581e7b8aa26bd07e"><div class="ttname"><a href="classcata__tiles.html#abb86896bb9f3e1c1581e7b8aa26bd07e">cata_tiles::void_weather</a></div><div class="ttdeci">void void_weather()</div></div>
<div class="ttc" id="aclasscata__tiles_html_abc9438288e20b308e34895885008b4fb"><div class="ttname"><a href="classcata__tiles.html#abc9438288e20b308e34895885008b4fb">cata_tiles::draw_weather_frame</a></div><div class="ttdeci">void draw_weather_frame()</div></div>
<div class="ttc" id="aclasscata__tiles_html_abe26bd8c0611b06420eb4f6fd08748e4"><div class="ttname"><a href="classcata__tiles.html#abe26bd8c0611b06420eb4f6fd08748e4">cata_tiles::init_draw_bullet</a></div><div class="ttdeci">void init_draw_bullet(const tripoint &amp;p, std::string name)</div></div>
<div class="ttc" id="aclasscata__tiles_html_ac94369b25a34545afcabfda4eee0fbc7"><div class="ttname"><a href="classcata__tiles.html#ac94369b25a34545afcabfda4eee0fbc7">cata_tiles::get_window_any_tile_range</a></div><div class="ttdeci">half_open_rectangle&lt; point &gt; get_window_any_tile_range(const point &amp;size, int z) const</div><div class="ttdoc">Coordinate range of tiles at the given relative z-level that fit into the given dimensions,...</div></div>
<div class="ttc" id="aclasscata__tiles_html_ac99ab08dcbbe22fb622d025712477018"><div class="ttname"><a href="classcata__tiles.html#ac99ab08dcbbe22fb622d025712477018">cata_tiles::void_field_override</a></div><div class="ttdeci">void void_field_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_acc075fb9ab0dc9f343cd0a65cd889a85"><div class="ttname"><a href="classcata__tiles.html#acc075fb9ab0dc9f343cd0a65cd889a85">cata_tiles::void_draw_below_override</a></div><div class="ttdeci">void void_draw_below_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_ace55c771dbf796f564733940419f7ac6"><div class="ttname"><a href="classcata__tiles.html#ace55c771dbf796f564733940419f7ac6">cata_tiles::draw_zombie_revival_indicators</a></div><div class="ttdeci">bool draw_zombie_revival_indicators(const tripoint &amp;pos, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_ad1b6af8efb9ede7bd643c80a0bcf17b3"><div class="ttname"><a href="classcata__tiles.html#ad1b6af8efb9ede7bd643c80a0bcf17b3">cata_tiles::draw_field_or_item</a></div><div class="ttdeci">bool draw_field_or_item(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_ad2e4ff6ac6d8ce8514dc1cb33f8c429e"><div class="ttname"><a href="classcata__tiles.html#ad2e4ff6ac6d8ce8514dc1cb33f8c429e">cata_tiles::set_draw_scale</a></div><div class="ttdeci">void set_draw_scale(int scale)</div><div class="ttdoc">Reload tileset, with the given scale.</div></div>
<div class="ttc" id="aclasscata__tiles_html_adb67bd398650f6d8f96ca919b34b9777"><div class="ttname"><a href="classcata__tiles.html#adb67bd398650f6d8f96ca919b34b9777">cata_tiles::get_furn_connect_values</a></div><div class="ttdeci">static void get_furn_connect_values(const tripoint &amp;p, int &amp;subtile, int &amp;rotation, const std::bitset&lt; NUM_TERCONN &gt; &amp;connect_group, const std::bitset&lt; NUM_TERCONN &gt; &amp;rotate_to_group, const std::map&lt; tripoint, furn_id &gt; &amp;furn_override)</div></div>
<div class="ttc" id="aclasscata__tiles_html_adc2c2a9f06d8f097522ce7c09e229dd5"><div class="ttname"><a href="classcata__tiles.html#adc2c2a9f06d8f097522ce7c09e229dd5">cata_tiles::player_to_tile</a></div><div class="ttdeci">point player_to_tile(const point &amp;pos) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_adf59367cb77169e5f7aca5c6582ba49f"><div class="ttname"><a href="classcata__tiles.html#adf59367cb77169e5f7aca5c6582ba49f">cata_tiles::set_draw_cache_dirty</a></div><div class="ttdeci">void set_draw_cache_dirty()</div></div>
<div class="ttc" id="aclasscata__tiles_html_ae2147e9fa0214f58b26afc6c6a4a2bb9"><div class="ttname"><a href="classcata__tiles.html#ae2147e9fa0214f58b26afc6c6a4a2bb9">cata_tiles::init_draw_highlight</a></div><div class="ttdeci">void init_draw_highlight(const tripoint &amp;p)</div></div>
<div class="ttc" id="aclasscata__tiles_html_ae3bd897a4090ad5d2e9ce99c42726a1a"><div class="ttname"><a href="classcata__tiles.html#ae3bd897a4090ad5d2e9ce99c42726a1a">cata_tiles::get_tile_values</a></div><div class="ttdeci">void get_tile_values(int t, const std::array&lt; int, 4 &gt; &amp;tn, int &amp;subtile, int &amp;rotation, char rotation_targets)</div></div>
<div class="ttc" id="aclasscata__tiles_html_ae96aed69d598add62714e60497457701"><div class="ttname"><a href="classcata__tiles.html#ae96aed69d598add62714e60497457701">cata_tiles::apply_vision_effects</a></div><div class="ttdeci">bool apply_vision_effects(const tripoint &amp;pos, visibility_type visibility, int &amp;height_3d)</div></div>
<div class="ttc" id="aclasscata__tiles_html_aea3e41f8a18ab2b07d1bc763ffb242da"><div class="ttname"><a href="classcata__tiles.html#aea3e41f8a18ab2b07d1bc763ffb242da">cata_tiles::draw_async_anim</a></div><div class="ttdeci">void draw_async_anim()</div></div>
<div class="ttc" id="aclasscata__tiles_html_aebdb80f0d2b7f9fc9008cf60bbee035e"><div class="ttname"><a href="classcata__tiles.html#aebdb80f0d2b7f9fc9008cf60bbee035e">cata_tiles::void_monster_override</a></div><div class="ttdeci">void void_monster_override()</div></div>
<div class="ttc" id="aclasscata__tiles_html_aede13a359e6992b80aa3246cc300e650"><div class="ttname"><a href="classcata__tiles.html#aede13a359e6992b80aa3246cc300e650">cata_tiles::zlevel_height</a></div><div class="ttdeci">int zlevel_height</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00747">cata_tiles.h:747</a></div></div>
<div class="ttc" id="aclasscata__tiles_html_af0bc2a34b699af09cf25b3c6116cdf48"><div class="ttname"><a href="classcata__tiles.html#af0bc2a34b699af09cf25b3c6116cdf48">cata_tiles::draw_zones_frame</a></div><div class="ttdeci">void draw_zones_frame()</div></div>
<div class="ttc" id="aclasscata__tiles_html_af1f629ae1d395324f3bb180be4fba428"><div class="ttname"><a href="classcata__tiles.html#af1f629ae1d395324f3bb180be4fba428">cata_tiles::init_draw_radiation_override</a></div><div class="ttdeci">void init_draw_radiation_override(const tripoint &amp;p, int rad)</div></div>
<div class="ttc" id="aclasscata__tiles_html_af2c994fca8c9eb02c4ffe0b455ad09fb"><div class="ttname"><a href="classcata__tiles.html#af2c994fca8c9eb02c4ffe0b455ad09fb">cata_tiles::draw_explosion_frame</a></div><div class="ttdeci">void draw_explosion_frame()</div></div>
<div class="ttc" id="aclasscata__tiles_html_af4ac91460226018be31f41fc65c62422"><div class="ttname"><a href="classcata__tiles.html#af4ac91460226018be31f41fc65c62422">cata_tiles::get_connect_values</a></div><div class="ttdeci">static void get_connect_values(const tripoint &amp;p, int &amp;subtile, int &amp;rotation, const std::bitset&lt; NUM_TERCONN &gt; &amp;connect_group, const std::bitset&lt; NUM_TERCONN &gt; &amp;rotate_to_group, const std::map&lt; tripoint, ter_id &gt; &amp;ter_override)</div></div>
<div class="ttc" id="aclasscata__tiles_html_af5cafc99736f35ed6c63aa66badbef60"><div class="ttname"><a href="classcata__tiles.html#af5cafc99736f35ed6c63aa66badbef60">cata_tiles::init_explosion</a></div><div class="ttdeci">void init_explosion(const tripoint &amp;p, int radius)</div></div>
<div class="ttc" id="aclasscata__tiles_html_af7e94971ef0b936c11b2f65a5a457ce2"><div class="ttname"><a href="classcata__tiles.html#af7e94971ef0b936c11b2f65a5a457ce2">cata_tiles::draw_vpart_roof</a></div><div class="ttdeci">bool draw_vpart_roof(const tripoint &amp;p, lit_level ll, int &amp;height_3d, const std::array&lt; bool, 5 &gt; &amp;invisible, bool memorize_only)</div></div>
<div class="ttc" id="aclasscata__tiles_html_afd43a8b18dc2f3db7aa081f5edc4f92f"><div class="ttname"><a href="classcata__tiles.html#afd43a8b18dc2f3db7aa081f5edc4f92f">cata_tiles::tileset_ptr</a></div><div class="ttdeci">std::shared_ptr&lt; const tileset &gt; tileset_ptr</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00737">cata_tiles.h:737</a></div></div>
<div class="ttc" id="aclasscata__tiles_html_afda1e45afc653a68ca19707ffdc893fd"><div class="ttname"><a href="classcata__tiles.html#afda1e45afc653a68ca19707ffdc893fd">cata_tiles::draw_square_below</a></div><div class="ttdeci">void draw_square_below(const point &amp;p, const nc_color &amp;col, int sizefactor)</div></div>
<div class="ttc" id="aclasscata__tiles_html_afee8c9afadc327e507553edef4dcc0ce"><div class="ttname"><a href="classcata__tiles.html#afee8c9afadc327e507553edef4dcc0ce">cata_tiles::find_tile_looks_like_by_string_id</a></div><div class="ttdeci">std::optional&lt; tile_lookup_res &gt; find_tile_looks_like_by_string_id(std::string_view id, TILE_CATEGORY category, int looks_like_jumps_limit) const</div></div>
<div class="ttc" id="aclasscata__tiles_html_afef68ffd1bb1725312005e3b502745b2"><div class="ttname"><a href="classcata__tiles.html#afef68ffd1bb1725312005e3b502745b2">cata_tiles::do_tile_loading_report</a></div><div class="ttdeci">void do_tile_loading_report()</div></div>
<div class="ttc" id="aclasscoords_1_1coord__point_html"><div class="ttname"><a href="classcoords_1_1coord__point.html">coords::coord_point&lt; tripoint, coords::origin::abs, coords::ms &gt;</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html"><div class="ttname"><a href="classcreature__tracker.html">creature_tracker</a></div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8h_source.html#l00024">creature_tracker.h:25</a></div></div>
<div class="ttc" id="aclasscreature__tracker_html_aba3c6663688bcd1806ea685d6961cb72"><div class="ttname"><a href="classcreature__tracker.html#aba3c6663688bcd1806ea685d6961cb72">creature_tracker::creature_at</a></div><div class="ttdeci">T * creature_at(const tripoint &amp;p, bool allow_hallucination=false)</div><div class="ttdoc">Returns the Creature at the given location.</div><div class="ttdef"><b>Definition:</b> <a href="creature__tracker_8cpp_source.html#l00303">creature_tracker.cpp:303</a></div></div>
<div class="ttc" id="aclassfield_html_a59090b4a884ffd80aee7e1c86cf66b59"><div class="ttname"><a href="classfield.html#a59090b4a884ffd80aee7e1c86cf66b59">field::displayed_intensity</a></div><div class="ttdeci">int displayed_intensity() const</div><div class="ttdoc">Returns the intensity of the drawn tile.</div><div class="ttdef"><b>Definition:</b> <a href="field_8cpp_source.html#l00251">field.cpp:251</a></div></div>
<div class="ttc" id="aclassfield_html_a8adfc9dd4000543431b4d1a94ab312ab"><div class="ttname"><a href="classfield.html#a8adfc9dd4000543431b4d1a94ab312ab">field::displayed_field_type</a></div><div class="ttdeci">field_type_id displayed_field_type() const</div><div class="ttdoc">Returns field type that should be drawn.</div><div class="ttdef"><b>Definition:</b> <a href="field_8cpp_source.html#l00241">field.cpp:241</a></div></div>
<div class="ttc" id="aclassinput__manager_html_a56fd029f8ad1ca3dcd864a6bb5537045"><div class="ttname"><a href="classinput__manager.html#a56fd029f8ad1ca3dcd864a6bb5537045">input_manager::pump_events</a></div><div class="ttdeci">void pump_events()</div><div class="ttdoc">Resize &amp; refresh if necessary, process all pending window events, and ignore keypresses.</div><div class="ttdef"><b>Definition:</b> <a href="ncurses__def_8cpp_source.html#l00356">ncurses_def.cpp:356</a></div></div>
<div class="ttc" id="aclassint__id_html"><div class="ttname"><a href="classint__id.html">int_id&lt; field_type &gt;</a></div></div>
<div class="ttc" id="aclassint__id_html_a4796245d3cd6e0283670698a98d46ae9"><div class="ttname"><a href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">int_id::obj</a></div><div class="ttdeci">const T &amp; obj() const</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00026">ammo_effect.cpp:26</a></div></div>
<div class="ttc" id="aclassint__id_html_a88b1e0c550f4d6f36cac7a73feca7f01"><div class="ttname"><a href="classint__id.html#a88b1e0c550f4d6f36cac7a73feca7f01">int_id::id</a></div><div class="ttdeci">const string_id&lt; T &gt; &amp; id() const</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00033">ammo_effect.cpp:33</a></div></div>
<div class="ttc" id="aclassint__id_html_a8ca0e76fa665125f1e50bd1ed8dbd213"><div class="ttname"><a href="classint__id.html#a8ca0e76fa665125f1e50bd1ed8dbd213">int_id::is_valid</a></div><div class="ttdeci">bool is_valid() const</div><div class="ttdoc">Returns whether this id is valid, that means whether it refers to an existing object.</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00019">ammo_effect.cpp:19</a></div></div>
<div class="ttc" id="aclassint__id_html_a99e80dcc802865c122fc1dfd8db8fc85"><div class="ttname"><a href="classint__id.html#a99e80dcc802865c122fc1dfd8db8fc85">int_id::to_i</a></div><div class="ttdeci">int to_i() const</div><div class="ttdoc">Returns the identifier as plain int.</div><div class="ttdef"><b>Definition:</b> <a href="int__id_8h_source.html#l00087">int_id.h:87</a></div></div>
<div class="ttc" id="aclassitem_html"><div class="ttname"><a href="classitem.html">item</a></div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l00195">item.h:196</a></div></div>
<div class="ttc" id="aclassitem_html_a11cf8d500b6d8106302470dce5ca9177"><div class="ttname"><a href="classitem.html#a11cf8d500b6d8106302470dce5ca9177">item::find_type</a></div><div class="ttdeci">static const itype * find_type(const itype_id &amp;type)</div><div class="ttdoc">Returns the item type of the given identifier.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l14581">item.cpp:14581</a></div></div>
<div class="ttc" id="aclassitem_html_a1ff6f2a9cd0fc994e3484b66138cb049"><div class="ttname"><a href="classitem.html#a1ff6f2a9cd0fc994e3484b66138cb049">item::symbol</a></div><div class="ttdeci">const std::string &amp; symbol() const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06290">item.cpp:6290</a></div></div>
<div class="ttc" id="aclassitem_html_a2307462a36b9809493966946645c2bc4"><div class="ttname"><a href="classitem.html#a2307462a36b9809493966946645c2bc4">item::set_itype_variant</a></div><div class="ttdeci">void set_itype_variant(const std::string &amp;variant)</div><div class="ttdoc">Set the gun variant of this item.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09361">item.cpp:9361</a></div></div>
<div class="ttc" id="aclassitem_html_a3101211dc3db3a8aa95675ab86d3ba36"><div class="ttname"><a href="classitem.html#a3101211dc3db3a8aa95675ab86d3ba36">item::clear_itype_variant</a></div><div class="ttdeci">void clear_itype_variant()</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09400">item.cpp:9400</a></div></div>
<div class="ttc" id="aclassitem_html_a4a9972e826d25be6736b749ab94b230f"><div class="ttname"><a href="classitem.html#a4a9972e826d25be6736b749ab94b230f">item::typeId</a></div><div class="ttdeci">itype_id typeId() const</div><div class="ttdoc">return the unique identifier of the items underlying type</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l11850">item.cpp:11850</a></div></div>
<div class="ttc" id="aclassitem_html_a4c54ded219374a2f5f80e8eee192dcdf"><div class="ttname"><a href="classitem.html#a4c54ded219374a2f5f80e8eee192dcdf">item::type_is_defined</a></div><div class="ttdeci">static bool type_is_defined(const itype_id &amp;id)</div><div class="ttdoc">Check whether the type id refers to a known type.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l14576">item.cpp:14576</a></div></div>
<div class="ttc" id="aclassitem_html_a66ba4b05a8ea5f9f15e4694027235aae"><div class="ttname"><a href="classitem.html#a66ba4b05a8ea5f9f15e4694027235aae">item::get_mtype</a></div><div class="ttdeci">const mtype * get_mtype() const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09531">item.cpp:9531</a></div></div>
<div class="ttc" id="aclassitem_html_ac1d2c4c33b8a499812f3437cb2fad742"><div class="ttname"><a href="classitem.html#ac1d2c4c33b8a499812f3437cb2fad742">item::type</a></div><div class="ttdeci">const itype * type</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l03074">item.h:3074</a></div></div>
<div class="ttc" id="aclassitem_html_ac3802e76b128e7ee2982352e7ad72030"><div class="ttname"><a href="classitem.html#ac3802e76b128e7ee2982352e7ad72030">item::color</a></div><div class="ttdeci">nc_color color() const</div><div class="ttdoc">Returns the default color of the item (e.g.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07018">item.cpp:7018</a></div></div>
<div class="ttc" id="aclassitem_html_ac748827c6e5f8720ac68669108a7ba29"><div class="ttname"><a href="classitem.html#ac748827c6e5f8720ac68669108a7ba29">item::has_itype_variant</a></div><div class="ttdeci">bool has_itype_variant(bool check_option=true) const</div><div class="ttdoc">Does this item have a gun variant associated with it If check_option, the return of this is dependent...</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09337">item.cpp:9337</a></div></div>
<div class="ttc" id="aclassitem_html_ad590c0adef8b5b3ad024bf4c67900505"><div class="ttname"><a href="classitem.html#ad590c0adef8b5b3ad024bf4c67900505">item::itype_variant</a></div><div class="ttdeci">const itype_variant_data &amp; itype_variant() const</div><div class="ttdoc">The gun variant associated with this item.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09356">item.cpp:9356</a></div></div>
<div class="ttc" id="aclassjson__loader_html_a411c04aa29647a241f76a899fbf95193"><div class="ttname"><a href="classjson__loader.html#a411c04aa29647a241f76a899fbf95193">json_loader::from_path_opt</a></div><div class="ttdeci">static std::optional&lt; JsonValue &gt; from_path_opt(const cata_path &amp;source_file) noexcept(false)</div><div class="ttdef"><b>Definition:</b> <a href="json__loader_8cpp_source.html#l00127">json_loader.cpp:127</a></div></div>
<div class="ttc" id="aclassjson__loader_html_a7a982b06b5ed83465fb9e0ec0d9a36f1"><div class="ttname"><a href="classjson__loader.html#a7a982b06b5ed83465fb9e0ec0d9a36f1">json_loader::from_path</a></div><div class="ttdeci">static JsonValue from_path(const cata_path &amp;source_file) noexcept(false)</div><div class="ttdef"><b>Definition:</b> <a href="json__loader_8cpp_source.html#l00149">json_loader.cpp:149</a></div></div>
<div class="ttc" id="aclassjson__loader_html_af3fbaf50a63b204dfe479e89e5d0dc9d"><div class="ttname"><a href="classjson__loader.html#af3fbaf50a63b204dfe479e89e5d0dc9d">json_loader::from_string</a></div><div class="ttdeci">static JsonValue from_string(std::string const &amp;data) noexcept(false)</div><div class="ttdef"><b>Definition:</b> <a href="json__loader_8cpp_source.html#l00154">json_loader.cpp:154</a></div></div>
<div class="ttc" id="aclasslayer__variant_html"><div class="ttname"><a href="classlayer__variant.html">layer_variant</a></div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00141">cata_tiles.h:142</a></div></div>
<div class="ttc" id="aclasslayer__variant_html_a8e9700d9aaf66a5720ca6d741e4537d6"><div class="ttname"><a href="classlayer__variant.html#a8e9700d9aaf66a5720ca6d741e4537d6">layer_variant::total_weight</a></div><div class="ttdeci">int total_weight</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00148">cata_tiles.h:148</a></div></div>
<div class="ttc" id="aclasslayer__variant_html_a9a6b1351ba8dd8a2ec9ae19a8b07e297"><div class="ttname"><a href="classlayer__variant.html#a9a6b1351ba8dd8a2ec9ae19a8b07e297">layer_variant::layer</a></div><div class="ttdeci">int layer</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00146">cata_tiles.h:146</a></div></div>
<div class="ttc" id="aclasslayer__variant_html_ac0dc6c2908c8d27c6e5f0dfe20896f97"><div class="ttname"><a href="classlayer__variant.html#ac0dc6c2908c8d27c6e5f0dfe20896f97">layer_variant::offset</a></div><div class="ttdeci">point offset</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00147">cata_tiles.h:147</a></div></div>
<div class="ttc" id="aclasslayer__variant_html_addf11bbaec16eaf83ef405b727846743"><div class="ttname"><a href="classlayer__variant.html#addf11bbaec16eaf83ef405b727846743">layer_variant::id</a></div><div class="ttdeci">std::string id</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00144">cata_tiles.h:144</a></div></div>
<div class="ttc" id="aclasslayer__variant_html_aff8c8329be30acb37b80641d8504bc53"><div class="ttname"><a href="classlayer__variant.html#aff8c8329be30acb37b80641d8504bc53">layer_variant::sprite</a></div><div class="ttdeci">std::map&lt; std::string, int &gt; sprite</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00145">cata_tiles.h:145</a></div></div>
<div class="ttc" id="aclassmap_html"><div class="ttname"><a href="classmap.html">map</a></div><div class="ttdoc">Manage and cache data about a part of the map.</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00345">map.h:346</a></div></div>
<div class="ttc" id="aclassmap_html_a00008f407a53edc2445622618d7ed071"><div class="ttname"><a href="classmap.html#a00008f407a53edc2445622618d7ed071">map::has_furn</a></div><div class="ttdeci">bool has_furn(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01712">map.cpp:1712</a></div></div>
<div class="ttc" id="aclassmap_html_a1807357b0f079f62746e9fe4c117b592"><div class="ttname"><a href="classmap.html#a1807357b0f079f62746e9fe4c117b592">map::memory_cache_dec_set_dirty</a></div><div class="ttdeci">void memory_cache_dec_set_dirty(const tripoint &amp;p, bool value) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00336">map.cpp:336</a></div></div>
<div class="ttc" id="aclassmap_html_a27e22f0999ea03eff18babc48643c568"><div class="ttname"><a href="classmap.html#a27e22f0999ea03eff18babc48643c568">map::has_flag</a></div><div class="ttdeci">bool has_flag(const std::string &amp;flag, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l03077">map.cpp:3077</a></div></div>
<div class="ttc" id="aclassmap_html_a30ccb67ed3651d350f2caf214e0b5176"><div class="ttname"><a href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">map::tr_at</a></div><div class="ttdeci">const trap &amp; tr_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06213">map.cpp:6213</a></div></div>
<div class="ttc" id="aclassmap_html_a395a729a4b954692cf08d13e1d32f73e"><div class="ttname"><a href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">map::field_at</a></div><div class="ttdeci">const field &amp; field_at(const tripoint &amp;p) const</div><div class="ttdoc">Get the fields that are here.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06379">map.cpp:6379</a></div></div>
<div class="ttc" id="aclassmap_html_a41fa0e03c8ccfc8fb013a6ab5459d06e"><div class="ttname"><a href="classmap.html#a41fa0e03c8ccfc8fb013a6ab5459d06e">map::access_cache</a></div><div class="ttdeci">level_cache &amp; access_cache(int zlev)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l10243">map.cpp:10243</a></div></div>
<div class="ttc" id="aclassmap_html_a47284179cd831f04aaa7ff3242a5fb7b"><div class="ttname"><a href="classmap.html#a47284179cd831f04aaa7ff3242a5fb7b">map::ambient_light_at</a></div><div class="ttdeci">float ambient_light_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="lightmap_8cpp_source.html#l00640">lightmap.cpp:640</a></div></div>
<div class="ttc" id="aclassmap_html_a49871648d1ab92a02a1a6f12797390a7"><div class="ttname"><a href="classmap.html#a49871648d1ab92a02a1a6f12797390a7">map::get_radiation</a></div><div class="ttdeci">int get_radiation(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l04899">map.cpp:4899</a></div></div>
<div class="ttc" id="aclassmap_html_a4dfba170dba1792376456ac2e6a6fd20"><div class="ttname"><a href="classmap.html#a4dfba170dba1792376456ac2e6a6fd20">map::partial_con_at</a></div><div class="ttdeci">partial_con * partial_con_at(const tripoint_bub_ms &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06244">map.cpp:6244</a></div></div>
<div class="ttc" id="aclassmap_html_a4f75e26115ded774817aa501d09c715d"><div class="ttname"><a href="classmap.html#a4f75e26115ded774817aa501d09c715d">map::memory_cache_ter_is_dirty</a></div><div class="ttdeci">bool memory_cache_ter_is_dirty(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00345">map.cpp:345</a></div></div>
<div class="ttc" id="aclassmap_html_a501f3a1d449ac022f1b36b99da653e94"><div class="ttname"><a href="classmap.html#a501f3a1d449ac022f1b36b99da653e94">map::getabs</a></div><div class="ttdeci">tripoint getabs(const tripoint &amp;p) const</div><div class="ttdoc">Translates local (to this map) coordinates of a square to global absolute coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09614">map.cpp:9614</a></div></div>
<div class="ttc" id="aclassmap_html_a5130a127601b67e569eaef37a1a88610"><div class="ttname"><a href="classmap.html#a5130a127601b67e569eaef37a1a88610">map::i_at</a></div><div class="ttdeci">map_stack i_at(const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l04978">map.cpp:4978</a></div></div>
<div class="ttc" id="aclassmap_html_a5741cc08c79673119a9ec251a6253644"><div class="ttname"><a href="classmap.html#a5741cc08c79673119a9ec251a6253644">map::light_transparency</a></div><div class="ttdeci">float light_transparency(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="lightmap_8cpp_source.html#l00659">lightmap.cpp:659</a></div></div>
<div class="ttc" id="aclassmap_html_a5b666218957f159f8af59e98644c7183"><div class="ttname"><a href="classmap.html#a5b666218957f159f8af59e98644c7183">map::sees_some_items</a></div><div class="ttdeci">bool sees_some_items(const tripoint &amp;p, const Creature &amp;who) const</div><div class="ttdoc">Check if creature can see some items at p.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l05855">map.cpp:5855</a></div></div>
<div class="ttc" id="aclassmap_html_a5ccfdc04bdc6f516d836502579aeac89"><div class="ttname"><a href="classmap.html#a5ccfdc04bdc6f516d836502579aeac89">map::has_graffiti_at</a></div><div class="ttdeci">bool has_graffiti_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09197">map.cpp:9197</a></div></div>
<div class="ttc" id="aclassmap_html_a632c3745cfe78bec4f22a0c7bc110b89"><div class="ttname"><a href="classmap.html#a632c3745cfe78bec4f22a0c7bc110b89">map::could_see_items</a></div><div class="ttdeci">bool could_see_items(const tripoint &amp;p, const Creature &amp;who) const</div><div class="ttdoc">Check if the creature could see items at p if there were any items.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l05866">map.cpp:5866</a></div></div>
<div class="ttc" id="aclassmap_html_a87090fcfef8b856048c65d555d7840b7"><div class="ttname"><a href="classmap.html#a87090fcfef8b856048c65d555d7840b7">map::get_known_connections_f</a></div><div class="ttdeci">uint8_t get_known_connections_f(const tripoint &amp;p, const std::bitset&lt; NUM_TERCONN &gt; &amp;connect_group, const std::map&lt; tripoint, furn_id &gt; &amp;override={}) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02059">map.cpp:2059</a></div></div>
<div class="ttc" id="aclassmap_html_a8ce6b6f4cacf6410ecb6b407bf61884e"><div class="ttname"><a href="classmap.html#a8ce6b6f4cacf6410ecb6b407bf61884e">map::memory_cache_dec_is_dirty</a></div><div class="ttdeci">bool memory_cache_dec_is_dirty(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00327">map.cpp:327</a></div></div>
<div class="ttc" id="aclassmap_html_a9ca9495068efebbdf83d185e0845cc54"><div class="ttname"><a href="classmap.html#a9ca9495068efebbdf83d185e0845cc54">map::get_visibility</a></div><div class="ttdeci">visibility_type get_visibility(lit_level ll, const visibility_variables &amp;cache) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06884">map.cpp:6884</a></div></div>
<div class="ttc" id="aclassmap_html_a9dc35cc898f6346a01a2168edc9a0361"><div class="ttname"><a href="classmap.html#a9dc35cc898f6346a01a2168edc9a0361">map::get_known_rotates_to</a></div><div class="ttdeci">uint8_t get_known_rotates_to(const tripoint &amp;p, const std::bitset&lt; NUM_TERCONN &gt; &amp;rotate_to_group, const std::map&lt; tripoint, ter_id &gt; &amp;override={}) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02030">map.cpp:2030</a></div></div>
<div class="ttc" id="aclassmap_html_aa487d96256c3d35db7a1bf273156b64a"><div class="ttname"><a href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">map::veh_at</a></div><div class="ttdeci">optional_vpart_position veh_at(const tripoint &amp;p) const</div><div class="ttdoc">Checks if tile is occupied by vehicle and by which part.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01316">map.cpp:1316</a></div></div>
<div class="ttc" id="aclassmap_html_aa7733dd145c213ee0b1f412b157ae331"><div class="ttname"><a href="classmap.html#aa7733dd145c213ee0b1f412b157ae331">map::dont_draw_lower_floor</a></div><div class="ttdeci">bool dont_draw_lower_floor(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l07099">map.cpp:7099</a></div></div>
<div class="ttc" id="aclassmap_html_ab822562ab4d1069ff53486f67098d0da"><div class="ttname"><a href="classmap.html#ab822562ab4d1069ff53486f67098d0da">map::veh_at_internal</a></div><div class="ttdeci">vehicle * veh_at_internal(const tripoint &amp;p, int &amp;part_num)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01356">map.cpp:1356</a></div></div>
<div class="ttc" id="aclassmap_html_aba8f330c2cc25be0652489b42d8dd530"><div class="ttname"><a href="classmap.html#aba8f330c2cc25be0652489b42d8dd530">map::ter</a></div><div class="ttdeci">ter_id ter(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01922">map.cpp:1922</a></div></div>
<div class="ttc" id="aclassmap_html_abb8095f0f1825688edee2d0edc5fd06d"><div class="ttname"><a href="classmap.html#abb8095f0f1825688edee2d0edc5fd06d">map::get_visibility_variables_cache</a></div><div class="ttdeci">const visibility_variables &amp; get_visibility_variables_cache() const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l06879">map.cpp:6879</a></div></div>
<div class="ttc" id="aclassmap_html_abc428da9c457d0a8ba0171c33b15d644"><div class="ttname"><a href="classmap.html#abc428da9c457d0a8ba0171c33b15d644">map::get_known_connections</a></div><div class="ttdeci">uint8_t get_known_connections(const tripoint &amp;p, const std::bitset&lt; NUM_TERCONN &gt; &amp;connect_group, const std::map&lt; tripoint, ter_id &gt; &amp;override={}) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01973">map.cpp:1973</a></div></div>
<div class="ttc" id="aclassmap_html_ac1c02ce0648fe07137b86c84fc72f5de"><div class="ttname"><a href="classmap.html#ac1c02ce0648fe07137b86c84fc72f5de">map::get_vehicles</a></div><div class="ttdeci">VehicleList get_vehicles()</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00432">map.cpp:432</a></div></div>
<div class="ttc" id="aclassmap_html_ac3badcb7b80602246664fa3671a840ba"><div class="ttname"><a href="classmap.html#ac3badcb7b80602246664fa3671a840ba">map::maptile_at</a></div><div class="ttdeci">const_maptile maptile_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00386">map.cpp:386</a></div></div>
<div class="ttc" id="aclassmap_html_ac868b594b36b6b9bbcb130650fd4f61f"><div class="ttname"><a href="classmap.html#ac868b594b36b6b9bbcb130650fd4f61f">map::getglobal</a></div><div class="ttdeci">tripoint_abs_ms getglobal(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09625">map.cpp:9625</a></div></div>
<div class="ttc" id="aclassmap_html_adeea375dfe039c35f02604a166082c2f"><div class="ttname"><a href="classmap.html#adeea375dfe039c35f02604a166082c2f">map::get_known_rotates_to_f</a></div><div class="ttdeci">uint8_t get_known_rotates_to_f(const tripoint &amp;p, const std::bitset&lt; NUM_TERCONN &gt; &amp;rotate_to_group, const std::map&lt; tripoint, ter_id &gt; &amp;override={}, const std::map&lt; tripoint, furn_id &gt; &amp;override_f={}) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02116">map.cpp:2116</a></div></div>
<div class="ttc" id="aclassmap_html_ae074b6e1e06913bee442d894f590131f"><div class="ttname"><a href="classmap.html#ae074b6e1e06913bee442d894f590131f">map::graffiti_at</a></div><div class="ttdeci">const std::string &amp; graffiti_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l09181">map.cpp:9181</a></div></div>
<div class="ttc" id="aclassmap_html_af15de9578c0dfbe9450b890bca66d543"><div class="ttname"><a href="classmap.html#af15de9578c0dfbe9450b890bca66d543">map::memory_cache_ter_set_dirty</a></div><div class="ttdeci">void memory_cache_ter_set_dirty(const tripoint &amp;p, bool value) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00354">map.cpp:354</a></div></div>
<div class="ttc" id="aclassmap_html_af55e014aab791bbe4c8630361c1311dd"><div class="ttname"><a href="classmap.html#af55e014aab791bbe4c8630361c1311dd">map::furn</a></div><div class="ttdeci">furn_id furn(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01722">map.cpp:1722</a></div></div>
<div class="ttc" id="aclassmap_html_af563dc2397e71a053569cb45c6bb7e77"><div class="ttname"><a href="classmap.html#af563dc2397e71a053569cb45c6bb7e77">map::passable</a></div><div class="ttdeci">bool passable(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02472">map.cpp:2472</a></div></div>
<div class="ttc" id="aclassmaptile__impl_html"><div class="ttname"><a href="classmaptile__impl.html">maptile_impl</a></div><div class="ttdoc">A wrapper for a submap point.</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00332">submap.h:333</a></div></div>
<div class="ttc" id="aclassmaptile__impl_html_a0629376a52a7a2f0ac1f55dcb93290a1"><div class="ttname"><a href="classmaptile__impl.html#a0629376a52a7a2f0ac1f55dcb93290a1">maptile_impl::get_ter_t</a></div><div class="ttdeci">const ter_t &amp; get_ter_t() const</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00375">submap.h:375</a></div></div>
<div class="ttc" id="aclassmaptile__impl_html_a224583b97f031cc5223b7e161abab3cf"><div class="ttname"><a href="classmaptile__impl.html#a224583b97f031cc5223b7e161abab3cf">maptile_impl::get_items</a></div><div class="ttdeci">const cata::colony&lt; item &gt; &amp; get_items() const</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00419">submap.h:419</a></div></div>
<div class="ttc" id="aclassmaptile__impl_html_a49cee4f9bd788754fcbe5d517cd80ba1"><div class="ttname"><a href="classmaptile__impl.html#a49cee4f9bd788754fcbe5d517cd80ba1">maptile_impl::get_item_count</a></div><div class="ttdeci">size_t get_item_count() const</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00409">submap.h:409</a></div></div>
<div class="ttc" id="aclassmaptile__impl_html_a5d1ab7324df577e978041f6e9881144c"><div class="ttname"><a href="classmaptile__impl.html#a5d1ab7324df577e978041f6e9881144c">maptile_impl::get_furn_t</a></div><div class="ttdeci">const furn_t &amp; get_furn_t() const</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00372">submap.h:372</a></div></div>
<div class="ttc" id="aclassmaptile__impl_html_a5fa51fe8e3a637c9481e2fce9ac19c2a"><div class="ttname"><a href="classmaptile__impl.html#a5fa51fe8e3a637c9481e2fce9ac19c2a">maptile_impl::get_uppermost_item</a></div><div class="ttdeci">const item &amp; get_uppermost_item() const</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00414">submap.h:414</a></div></div>
<div class="ttc" id="aclassmark__option_html"><div class="ttname"><a href="classmark__option.html">mark_option</a></div><div class="ttdef"><b>Definition:</b> <a href="clzones_8h_source.html#l00118">clzones.h:119</a></div></div>
<div class="ttc" id="aclassmark__option_html_a8a1aa174c43e7824b3d56f4bbf234a16"><div class="ttname"><a href="classmark__option.html#a8a1aa174c43e7824b3d56f4bbf234a16">mark_option::get_mark</a></div><div class="ttdeci">virtual std::string get_mark() const =0</div></div>
<div class="ttc" id="aclassmemorized__tile_html"><div class="ttname"><a href="classmemorized__tile.html">memorized_tile</a></div><div class="ttdef"><b>Definition:</b> <a href="map__memory_8h_source.html#l00019">map_memory.h:20</a></div></div>
<div class="ttc" id="aclassmemorized__tile_html_a3403109e5b4f6107c602ee1a970ccf44"><div class="ttname"><a href="classmemorized__tile.html#a3403109e5b4f6107c602ee1a970ccf44">memorized_tile::get_ter_subtile</a></div><div class="ttdeci">int get_ter_subtile() const</div><div class="ttdef"><b>Definition:</b> <a href="map__memory_8cpp_source.html#l00138">map_memory.cpp:138</a></div></div>
<div class="ttc" id="aclassmemorized__tile_html_ac8ef0ca7edfe6fb2bf3679bfe8399ba8"><div class="ttname"><a href="classmemorized__tile.html#ac8ef0ca7edfe6fb2bf3679bfe8399ba8">memorized_tile::get_dec_subtile</a></div><div class="ttdeci">int get_dec_subtile() const</div><div class="ttdef"><b>Definition:</b> <a href="map__memory_8cpp_source.html#l00153">map_memory.cpp:153</a></div></div>
<div class="ttc" id="aclassmemorized__tile_html_ad34e31f323be7131a1075ae4528ea37d"><div class="ttname"><a href="classmemorized__tile.html#ad34e31f323be7131a1075ae4528ea37d">memorized_tile::get_ter_id</a></div><div class="ttdeci">const std::string &amp; get_ter_id() const</div><div class="ttdef"><b>Definition:</b> <a href="map__memory_8cpp_source.html#l00088">map_memory.cpp:88</a></div></div>
<div class="ttc" id="aclassmemorized__tile_html_ae7de9207ae58c9bb5f65a1d168880396"><div class="ttname"><a href="classmemorized__tile.html#ae7de9207ae58c9bb5f65a1d168880396">memorized_tile::get_ter_rotation</a></div><div class="ttdeci">int get_ter_rotation() const</div><div class="ttdef"><b>Definition:</b> <a href="map__memory_8cpp_source.html#l00108">map_memory.cpp:108</a></div></div>
<div class="ttc" id="aclassmemorized__tile_html_aee52a4740870eb43401ca654627445a0"><div class="ttname"><a href="classmemorized__tile.html#aee52a4740870eb43401ca654627445a0">memorized_tile::get_dec_id</a></div><div class="ttdeci">const std::string &amp; get_dec_id() const</div><div class="ttdef"><b>Definition:</b> <a href="map__memory_8cpp_source.html#l00093">map_memory.cpp:93</a></div></div>
<div class="ttc" id="aclassmemorized__tile_html_af9bf337c3d4d23e0a2c67ae5404bba0e"><div class="ttname"><a href="classmemorized__tile.html#af9bf337c3d4d23e0a2c67ae5404bba0e">memorized_tile::get_dec_rotation</a></div><div class="ttdeci">int get_dec_rotation() const</div><div class="ttdef"><b>Definition:</b> <a href="map__memory_8cpp_source.html#l00123">map_memory.cpp:123</a></div></div>
<div class="ttc" id="aclassmod__tileset_html"><div class="ttname"><a href="classmod__tileset.html">mod_tileset</a></div><div class="ttdef"><b>Definition:</b> <a href="mod__tileset_8h_source.html#l00019">mod_tileset.h:20</a></div></div>
<div class="ttc" id="aclassmonster_html"><div class="ttname"><a href="classmonster.html">monster</a></div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00085">monster.h:86</a></div></div>
<div class="ttc" id="aclassmonster_html_a125622587c2069dc4dbbe07943c81336"><div class="ttname"><a href="classmonster.html#a125622587c2069dc4dbbe07943c81336">monster::attitude_to</a></div><div class="ttdeci">Attitude attitude_to(const Creature &amp;other) const override</div><div class="ttdoc">Attitude (of this creature) towards another creature.</div><div class="ttdef"><b>Definition:</b> <a href="monster_8cpp_source.html#l01450">monster.cpp:1450</a></div></div>
<div class="ttc" id="aclassmonster_html_aa07ebef40819868b9f7a86383d6cd8c3"><div class="ttname"><a href="classmonster.html#aa07ebef40819868b9f7a86383d6cd8c3">monster::mounted_player</a></div><div class="ttdeci">Character * mounted_player</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00526">monster.h:526</a></div></div>
<div class="ttc" id="aclassmonster_html_aa30f973bf524ba275ada847f6118b048"><div class="ttname"><a href="classmonster.html#aa30f973bf524ba275ada847f6118b048">monster::type</a></div><div class="ttdeci">const mtype * type</div><div class="ttdef"><b>Definition:</b> <a href="monster_8h_source.html#l00550">monster.h:550</a></div></div>
<div class="ttc" id="aclassnc__color_html"><div class="ttname"><a href="classnc__color.html">nc_color</a></div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00347">color.h:348</a></div></div>
<div class="ttc" id="aclassnc__color_html_a56cc19eb9c2f8949f541de4497c24696"><div class="ttname"><a href="classnc__color.html#a56cc19eb9c2f8949f541de4497c24696">nc_color::is_bold</a></div><div class="ttdeci">bool is_bold() const</div><div class="ttdef"><b>Definition:</b> <a href="ncurses__def_8cpp_source.html#l00518">ncurses_def.cpp:518</a></div></div>
<div class="ttc" id="aclassnc__color_html_a9cc29a810af4b9f38101dcfd2194e722"><div class="ttname"><a href="classnc__color.html#a9cc29a810af4b9f38101dcfd2194e722">nc_color::to_color_pair_index</a></div><div class="ttdeci">int to_color_pair_index() const</div><div class="ttdef"><b>Definition:</b> <a href="ncurses__def_8cpp_source.html#l00508">ncurses_def.cpp:508</a></div></div>
<div class="ttc" id="aclassnpc__attack__rating_html"><div class="ttname"><a href="classnpc__attack__rating.html">npc_attack_rating</a></div><div class="ttdef"><b>Definition:</b> <a href="npc__attack_8h_source.html#l00017">npc_attack.h:18</a></div></div>
<div class="ttc" id="aclassnpc_html"><div class="ttname"><a href="classnpc.html">npc</a></div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00791">npc.h:792</a></div></div>
<div class="ttc" id="aclassnpc_html_a01b95be72400ef6e5b659c34f634bcfd"><div class="ttname"><a href="classnpc.html#a01b95be72400ef6e5b659c34f634bcfd">npc::regen_ai_cache</a></div><div class="ttdeci">void regen_ai_cache()</div><div class="ttdef"><b>Definition:</b> <a href="npcmove_8cpp_source.html#l01215">npcmove.cpp:1215</a></div></div>
<div class="ttc" id="aclassnpc_html_ad27a4f70dc3b2d753bd3c8e0fe115135"><div class="ttname"><a href="classnpc.html#ad27a4f70dc3b2d753bd3c8e0fe115135">npc::get_current_attack</a></div><div class="ttdeci">const std::shared_ptr&lt; npc_attack &gt; &amp; get_current_attack() const</div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l01352">npc.h:1352</a></div></div>
<div class="ttc" id="aclassnpc_html_afb6788e7afa0689bb84fe0216c6b4663"><div class="ttname"><a href="classnpc.html#afb6788e7afa0689bb84fe0216c6b4663">npc::evaluate_best_attack</a></div><div class="ttdeci">void evaluate_best_attack(const Creature *target)</div><div class="ttdef"><b>Definition:</b> <a href="npcmove_8cpp_source.html#l01985">npcmove.cpp:1985</a></div></div>
<div class="ttc" id="aclassoptional__vpart__position_html"><div class="ttname"><a href="classoptional__vpart__position.html">optional_vpart_position</a></div><div class="ttdoc">Simple wrapper to forward functions that may return a std::optional to vpart_position.</div><div class="ttdef"><b>Definition:</b> <a href="vpart__position_8h_source.html#l00124">vpart_position.h:125</a></div></div>
<div class="ttc" id="aclassoptions__manager_html_ae86276f64ca285bc8e1d6220a9013411"><div class="ttname"><a href="classoptions__manager.html#ae86276f64ca285bc8e1d6220a9013411">options_manager::id_and_option</a></div><div class="ttdeci">std::pair&lt; std::string, translation &gt; id_and_option</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00028">options.h:28</a></div></div>
<div class="ttc" id="aclassrect__range_html"><div class="ttname"><a href="classrect__range.html">rect_range</a></div><div class="ttdef"><b>Definition:</b> <a href="rect__range_8h_source.html#l00010">rect_range.h:11</a></div></div>
<div class="ttc" id="aclassscent__map_html_a781c9a7c953f40d3027c3e3a36446ff3"><div class="ttname"><a href="classscent__map.html#a781c9a7c953f40d3027c3e3a36446ff3">scent_map::get_type</a></div><div class="ttdeci">scenttype_id get_type() const</div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8cpp_source.html#l00122">scent_map.cpp:122</a></div></div>
<div class="ttc" id="aclassscent__map_html_a99aff3e6d8963d7f34618216a8448c8c"><div class="ttname"><a href="classscent__map.html#a99aff3e6d8963d7f34618216a8448c8c">scent_map::get</a></div><div class="ttdeci">int get(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8cpp_source.html#l00095">scent_map.cpp:95</a></div></div>
<div class="ttc" id="aclassscent__type_html"><div class="ttname"><a href="classscent__type.html">scent_type</a></div><div class="ttdef"><b>Definition:</b> <a href="scent__map_8h_source.html#l00029">scent_map.h:30</a></div></div>
<div class="ttc" id="aclassscrollingcombattext_1_1cSCT_html"><div class="ttname"><a href="classscrollingcombattext_1_1cSCT.html">scrollingcombattext::cSCT</a></div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l01061">output.h:1062</a></div></div>
<div class="ttc" id="aclassscrollingcombattext_1_1cSCT_html_a1614ba32b175906a78b216e6ff076ab0"><div class="ttname"><a href="classscrollingcombattext_1_1cSCT.html#a1614ba32b175906a78b216e6ff076ab0">scrollingcombattext::cSCT::getText</a></div><div class="ttdeci">std::string getText(const std::string &amp;type=&quot;full&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l02995">output.cpp:2995</a></div></div>
<div class="ttc" id="aclassscrollingcombattext_1_1cSCT_html_a399c8be22c29bfa755a6983f238c8168"><div class="ttname"><a href="classscrollingcombattext_1_1cSCT.html#a399c8be22c29bfa755a6983f238c8168">scrollingcombattext::cSCT::getStep</a></div><div class="ttdeci">int getStep() const</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l01090">output.h:1090</a></div></div>
<div class="ttc" id="aclassscrollingcombattext_1_1cSCT_html_a431b5149d42e287e668889c9728b989f"><div class="ttname"><a href="classscrollingcombattext_1_1cSCT.html#a431b5149d42e287e668889c9728b989f">scrollingcombattext::cSCT::getPosY</a></div><div class="ttdeci">int getPosY() const</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l03062">output.cpp:3062</a></div></div>
<div class="ttc" id="aclassscrollingcombattext_1_1cSCT_html_a521202c0584f4b1735bcd8b15719512d"><div class="ttname"><a href="classscrollingcombattext_1_1cSCT.html#a521202c0584f4b1735bcd8b15719512d">scrollingcombattext::cSCT::getDirection</a></div><div class="ttdeci">direction getDirection() const</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l01104">output.h:1104</a></div></div>
<div class="ttc" id="aclassscrollingcombattext_1_1cSCT_html_a6d9f2e2247547de10c9a3b8d1d3c21a3"><div class="ttname"><a href="classscrollingcombattext_1_1cSCT.html#a6d9f2e2247547de10c9a3b8d1d3c21a3">scrollingcombattext::cSCT::getPosX</a></div><div class="ttdeci">int getPosX() const</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l03036">output.cpp:3036</a></div></div>
<div class="ttc" id="aclassscrollingcombattext_1_1cSCT_html_ab5b52af8e3116e40c39902460834dff9"><div class="ttname"><a href="classscrollingcombattext_1_1cSCT.html#ab5b52af8e3116e40c39902460834dff9">scrollingcombattext::cSCT::getMsgType</a></div><div class="ttdeci">game_message_type getMsgType(const std::string &amp;type=&quot;first&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l03019">output.cpp:3019</a></div></div>
<div class="ttc" id="aclassscrollingcombattext_html_a01ace3538aa0d57253df538dd7723343"><div class="ttname"><a href="classscrollingcombattext.html#a01ace3538aa0d57253df538dd7723343">scrollingcombattext::vSCT</a></div><div class="ttdeci">std::vector&lt; cSCT &gt; vSCT</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l01120">output.h:1120</a></div></div>
<div class="ttc" id="aclassscrollingcombattext_html_a216d979c0986240c92c7baecd91ce853"><div class="ttname"><a href="classscrollingcombattext.html#a216d979c0986240c92c7baecd91ce853">scrollingcombattext::iMaxSteps</a></div><div class="ttdeci">static constexpr int iMaxSteps</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l01057">output.h:1057</a></div></div>
<div class="ttc" id="aclassstring__id_html"><div class="ttname"><a href="classstring__id.html">string_id&lt; effect_type &gt;</a></div></div>
<div class="ttc" id="aclassstring__id_html_a1b2100ed077789ba45aaf5081791b36c"><div class="ttname"><a href="classstring__id.html#a1b2100ed077789ba45aaf5081791b36c">string_id&lt; furn_t &gt;::NULL_ID</a></div><div class="ttdeci">static const string_id&lt; furn_t &gt; &amp; NULL_ID()</div><div class="ttdoc">Returns a null id whose string_id&lt;T&gt;::is_null() must always return true.</div></div>
<div class="ttc" id="aclassstring__id_html_a3ca78345025397b3d3ac22729ba1684b"><div class="ttname"><a href="classstring__id.html#a3ca78345025397b3d3ac22729ba1684b">string_id::is_null</a></div><div class="ttdeci">bool is_null() const</div><div class="ttdoc">Returns whether this represents the id of the null-object (in which case it's the null-id).</div><div class="ttdef"><b>Definition:</b> <a href="string__id_8h_source.html#l00322">string_id.h:322</a></div></div>
<div class="ttc" id="aclassstring__id_html_aa3cde2bfb58efa9621289c0a70d24c5a"><div class="ttname"><a href="classstring__id.html#aa3cde2bfb58efa9621289c0a70d24c5a">string_id::id</a></div><div class="ttdeci">int_id&lt; T &gt; id() const</div><div class="ttdoc">Translate the string based it to the matching integer based id.</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00054">ammo_effect.cpp:54</a></div></div>
<div class="ttc" id="aclassstring__id_html_ae75b0a209b55081a67c5fe6c17a4be00"><div class="ttname"><a href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">string_id::str</a></div><div class="ttdeci">const std::string &amp; str() const</div><div class="ttdoc">Returns the identifier as plain std::string.</div><div class="ttdef"><b>Definition:</b> <a href="string__id_8h_source.html#l00260">string_id.h:260</a></div></div>
<div class="ttc" id="aclasstexture_html"><div class="ttname"><a href="classtexture.html">texture</a></div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00114">cata_tiles.h:115</a></div></div>
<div class="ttc" id="aclasstexture_html_abe01180582ee52b049d77e0ab39380af"><div class="ttname"><a href="classtexture.html#abe01180582ee52b049d77e0ab39380af">texture::render_copy_ex</a></div><div class="ttdeci">int render_copy_ex(const SDL_Renderer_Ptr &amp;renderer, const SDL_Rect *const dstrect, const double angle, const SDL_Point *const center, const SDL_RendererFlip flip) const</div><div class="ttdoc">Interface to SDL_RenderCopyEx, using this as the texture, and null as source rectangle (render the wh...</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00133">cata_tiles.h:133</a></div></div>
<div class="ttc" id="aclasstexture_html_aeec5e98968dbd7b9563f4217dbda5368"><div class="ttname"><a href="classtexture.html#aeec5e98968dbd7b9563f4217dbda5368">texture::dimension</a></div><div class="ttdeci">std::pair&lt; int, int &gt; dimension() const</div><div class="ttdoc">Returns the width (first) and height (second) of the stored texture.</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00127">cata_tiles.h:127</a></div></div>
<div class="ttc" id="aclasstile__lookup__res_html"><div class="ttname"><a href="classtile__lookup__res.html">tile_lookup_res</a></div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00099">cata_tiles.h:100</a></div></div>
<div class="ttc" id="aclasstileray_html_a91ed01227e1754597024f4916f8bd6af"><div class="ttname"><a href="classtileray.html#a91ed01227e1754597024f4916f8bd6af">tileray::dir</a></div><div class="ttdeci">units::angle dir() const</div><div class="ttdef"><b>Definition:</b> <a href="tileray_8cpp_source.html#l00073">tileray.cpp:73</a></div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a04bf459d4b0f1f94f0a631b03a51a3d4"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a04bf459d4b0f1f94f0a631b03a51a3d4">tileset_cache::loader::load_tile_spritelists</a></div><div class="ttdeci">void load_tile_spritelists(const JsonObject &amp;entry, weighted_int_list&lt; std::vector&lt; int &gt;&gt; &amp;vs, std::string_view objname) const</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a0e7fd8bb294514e3ea2a81ee0e6725c7"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a0e7fd8bb294514e3ea2a81ee0e6725c7">tileset_cache::loader::process_variations_after_loading</a></div><div class="ttdeci">void process_variations_after_loading(weighted_int_list&lt; std::vector&lt; int &gt;&gt; &amp;v) const</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a142d73e15f822c0e0eaa4d94d90230ee"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a142d73e15f822c0e0eaa4d94d90230ee">tileset_cache::loader::sprite_height</a></div><div class="ttdeci">int sprite_height</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00296">cata_tiles.h:296</a></div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a16bc4517a4d542a3e5487e6ab95d5522"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a16bc4517a4d542a3e5487e6ab95d5522">tileset_cache::loader::offset</a></div><div class="ttdeci">int offset</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00298">cata_tiles.h:298</a></div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a1e259f495938801db422d5b51657e0a6"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a1e259f495938801db422d5b51657e0a6">tileset_cache::loader::load_ascii_set</a></div><div class="ttdeci">void load_ascii_set(const JsonObject &amp;entry)</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a346e3d6d84e15a41254a3a3ee9bcacd3"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a346e3d6d84e15a41254a3a3ee9bcacd3">tileset_cache::loader::tile_atlas_width</a></div><div class="ttdeci">int tile_atlas_width</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00306">cata_tiles.h:306</a></div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a41d360b00c41a19439790bde03ddd30c"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a41d360b00c41a19439790bde03ddd30c">tileset_cache::loader::load_ascii</a></div><div class="ttdeci">void load_ascii(const JsonObject &amp;config)</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a4b4186730919d5ac9063c1a46126d1fa"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a4b4186730919d5ac9063c1a46126d1fa">tileset_cache::loader::copy_surface_to_texture</a></div><div class="ttdeci">void copy_surface_to_texture(const SDL_Surface_Ptr &amp;surf, const point &amp;offset, std::vector&lt; texture &gt; &amp;target)</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a5af12dd6e01f8f000126a45991336675"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a5af12dd6e01f8f000126a45991336675">tileset_cache::loader::load_tilejson_from_file</a></div><div class="ttdeci">void load_tilejson_from_file(const JsonObject &amp;config)</div><div class="ttdoc">Load tiles from json data.This expects a &quot;tiles&quot; array in config.</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_a940ec9501c853091a272adce26cf1ac9"><div class="ttname"><a href="classtileset__cache_1_1loader.html#a940ec9501c853091a272adce26cf1ac9">tileset_cache::loader::load</a></div><div class="ttdeci">void load(const std::string &amp;tileset_id, bool precheck, bool pump_events=false)</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_aa0b1f3ac1fde6259b12a3e66305f2476"><div class="ttname"><a href="classtileset__cache_1_1loader.html#aa0b1f3ac1fde6259b12a3e66305f2476">tileset_cache::loader::sprite_width</a></div><div class="ttdeci">int sprite_width</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00295">cata_tiles.h:295</a></div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_aa4ff78e9b3f87c3b06f25a264623b360"><div class="ttname"><a href="classtileset__cache_1_1loader.html#aa4ff78e9b3f87c3b06f25a264623b360">tileset_cache::loader::renderer</a></div><div class="ttdeci">const SDL_Renderer_Ptr &amp; renderer</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00289">cata_tiles.h:289</a></div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_ab693cfe57344d4a2f958e411890b8160"><div class="ttname"><a href="classtileset__cache_1_1loader.html#ab693cfe57344d4a2f958e411890b8160">tileset_cache::loader::load_layers</a></div><div class="ttdeci">void load_layers(const JsonObject &amp;config)</div><div class="ttdoc">Helper function to load layering data.</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_ac91b701cd76c2cf7aff019df0728adc6"><div class="ttname"><a href="classtileset__cache_1_1loader.html#ac91b701cd76c2cf7aff019df0728adc6">tileset_cache::loader::ensure_default_item_highlight</a></div><div class="ttdeci">void ensure_default_item_highlight()</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_ad7521b8e51c47aa487931970839931c5"><div class="ttname"><a href="classtileset__cache_1_1loader.html#ad7521b8e51c47aa487931970839931c5">tileset_cache::loader::load_tileset</a></div><div class="ttdeci">void load_tileset(const cata_path &amp;path, bool pump_events)</div><div class="ttdoc">Load tileset, R,G,B, are the color components of the transparent color Returns the number of tiles th...</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_ad9f31ae46c61ae8fc813ab164e93db61"><div class="ttname"><a href="classtileset__cache_1_1loader.html#ad9f31ae46c61ae8fc813ab164e93db61">tileset_cache::loader::create_textures_from_tile_atlas</a></div><div class="ttdeci">void create_textures_from_tile_atlas(const SDL_Surface_Ptr &amp;tile_atlas, const point &amp;offset)</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_ae00933ca88eb5829cc9fa71f2f076d25"><div class="ttname"><a href="classtileset__cache_1_1loader.html#ae00933ca88eb5829cc9fa71f2f076d25">tileset_cache::loader::load_internal</a></div><div class="ttdeci">void load_internal(const JsonObject &amp;config, const cata_path &amp;tileset_root, const cata_path &amp;img_path, bool pump_events)</div><div class="ttdoc">Helper function called by load.</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_af4bfffbbefa2dbec0e6a971dc833c451"><div class="ttname"><a href="classtileset__cache_1_1loader.html#af4bfffbbefa2dbec0e6a971dc833c451">tileset_cache::loader::add_ascii_subtile</a></div><div class="ttdeci">void add_ascii_subtile(tile_type &amp;curr_tile, const std::string &amp;t_id, int sprite_id, const std::string &amp;s_id)</div></div>
<div class="ttc" id="aclasstileset__cache_1_1loader_html_af64be0a34a00ac075a9aa243cd6c686c"><div class="ttname"><a href="classtileset__cache_1_1loader.html#af64be0a34a00ac075a9aa243cd6c686c">tileset_cache::loader::load_tile</a></div><div class="ttdeci">tile_type &amp; load_tile(const JsonObject &amp;entry, const std::string &amp;id)</div><div class="ttdoc">Create a new tile_type, add it to tile_ids (using id).</div></div>
<div class="ttc" id="aclasstileset__cache_html"><div class="ttname"><a href="classtileset__cache.html">tileset_cache</a></div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00274">cata_tiles.h:275</a></div></div>
<div class="ttc" id="aclasstileset__cache_html_a0312eab86d6b57f8ef8976798f5124f2"><div class="ttname"><a href="classtileset__cache.html#a0312eab86d6b57f8ef8976798f5124f2">tileset_cache::tilesets_</a></div><div class="ttdeci">std::unordered_map&lt; std::string, std::weak_ptr&lt; tileset &gt; &gt; tilesets_</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00282">cata_tiles.h:281</a></div></div>
<div class="ttc" id="aclasstileset__cache_html_a05384512fc8ba3e8bc906b2bf35d32ec"><div class="ttname"><a href="classtileset__cache.html#a05384512fc8ba3e8bc906b2bf35d32ec">tileset_cache::load_tileset</a></div><div class="ttdeci">std::shared_ptr&lt; const tileset &gt; load_tileset(const std::string &amp;tileset_id, const SDL_Renderer_Ptr &amp;renderer, bool precheck, bool force, bool pump_events)</div></div>
<div class="ttc" id="aclasstileset_html_a0da13b421e62420ed996ed2a265cf392"><div class="ttname"><a href="classtileset.html#a0da13b421e62420ed996ed2a265cf392">tileset::field_layer_data</a></div><div class="ttdeci">std::unordered_map&lt; std::string, std::vector&lt; layer_variant &gt; &gt; field_layer_data</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00200">cata_tiles.h:200</a></div></div>
<div class="ttc" id="aclasstileset_html_a3a2817d754e912b4e90b8b5c9d530e9c"><div class="ttname"><a href="classtileset.html#a3a2817d754e912b4e90b8b5c9d530e9c">tileset::duplicate_ids</a></div><div class="ttdeci">std::unordered_set&lt; std::string &gt; duplicate_ids</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00182">cata_tiles.h:182</a></div></div>
<div class="ttc" id="aclasstileset_html_a48f1d1aa368435d8c5943b9c9fd34d30"><div class="ttname"><a href="classtileset.html#a48f1d1aa368435d8c5943b9c9fd34d30">tileset::shadow_tile_values</a></div><div class="ttdeci">std::vector&lt; texture &gt; shadow_tile_values</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00177">cata_tiles.h:177</a></div></div>
<div class="ttc" id="aclasstileset_html_a4b51509ab6d1260d6f3fd9007553283e"><div class="ttname"><a href="classtileset.html#a4b51509ab6d1260d6f3fd9007553283e">tileset::find_tile_type_by_season</a></div><div class="ttdeci">std::optional&lt; tile_lookup_res &gt; find_tile_type_by_season(const std::string &amp;id, season_type season) const</div><div class="ttdoc">Looks up tile by id + season suffix AND just raw id Example: if id == &quot;t_tree_apple&quot; and season == SP...</div></div>
<div class="ttc" id="aclasstileset_html_a56b03955caf1b5054bb2618141e26ca8"><div class="ttname"><a href="classtileset.html#a56b03955caf1b5054bb2618141e26ca8">tileset::tile_values</a></div><div class="ttdeci">std::vector&lt; texture &gt; tile_values</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00176">cata_tiles.h:176</a></div></div>
<div class="ttc" id="aclasstileset_html_a63ea9a683e87a5a50cfede95c50eb3bb"><div class="ttname"><a href="classtileset.html#a63ea9a683e87a5a50cfede95c50eb3bb">tileset::night_tile_values</a></div><div class="ttdeci">std::vector&lt; texture &gt; night_tile_values</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00178">cata_tiles.h:178</a></div></div>
<div class="ttc" id="aclasstileset_html_a8adad8c500dce4878965211966a5f3c7"><div class="ttname"><a href="classtileset.html#a8adad8c500dce4878965211966a5f3c7">tileset::create_tile_type</a></div><div class="ttdeci">tile_type &amp; create_tile_type(const std::string &amp;id, tile_type &amp;&amp;new_tile_type)</div></div>
<div class="ttc" id="aclasstileset_html_a8d45aa2af0836d4a891605e7a44cfa9d"><div class="ttname"><a href="classtileset.html#a8d45aa2af0836d4a891605e7a44cfa9d">tileset::item_layer_data</a></div><div class="ttdeci">std::unordered_map&lt; std::string, std::vector&lt; layer_variant &gt; &gt; item_layer_data</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00199">cata_tiles.h:199</a></div></div>
<div class="ttc" id="aclasstileset_html_a9ed12e41bec6146436a09ec98ed1da17"><div class="ttname"><a href="classtileset.html#a9ed12e41bec6146436a09ec98ed1da17">tileset::find_tile_type</a></div><div class="ttdeci">const tile_type * find_tile_type(const std::string &amp;id) const</div></div>
<div class="ttc" id="aclasstileset_html_aaaed99cc83ffff12f758d90541f7b8d9"><div class="ttname"><a href="classtileset.html#aaaed99cc83ffff12f758d90541f7b8d9">tileset::overexposed_tile_values</a></div><div class="ttdeci">std::vector&lt; texture &gt; overexposed_tile_values</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00179">cata_tiles.h:179</a></div></div>
<div class="ttc" id="aclasstileset_html_aba9003b94d672585d9360ee348952c12"><div class="ttname"><a href="classtileset.html#aba9003b94d672585d9360ee348952c12">tileset::memory_tile_values</a></div><div class="ttdeci">std::vector&lt; texture &gt; memory_tile_values</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00180">cata_tiles.h:180</a></div></div>
<div class="ttc" id="aclasstileset_html_ac5955523a9d7d455b5a0915165461dc8"><div class="ttname"><a href="classtileset.html#ac5955523a9d7d455b5a0915165461dc8">tileset::clear</a></div><div class="ttdeci">void clear()</div></div>
<div class="ttc" id="aclasstileset_html_aca2eb129c686bec0d2a46abb946f9b0e"><div class="ttname"><a href="classtileset.html#aca2eb129c686bec0d2a46abb946f9b0e">tileset::tile_ids</a></div><div class="ttdeci">std::unordered_map&lt; std::string, tile_type &gt; tile_ids</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00184">cata_tiles.h:184</a></div></div>
<div class="ttc" id="aclasstileset_html_ae3313358358957d02fed95459d7310c2"><div class="ttname"><a href="classtileset.html#ae3313358358957d02fed95459d7310c2">tileset::tile_ids_by_season</a></div><div class="ttdeci">std::array&lt; std::unordered_map&lt; std::string, season_tile_value &gt;, season_type::NUM_SEASONS &gt; tile_ids_by_season</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00188">cata_tiles.h:188</a></div></div>
<div class="ttc" id="aclassunits_1_1quantity_html"><div class="ttname"><a href="classunits_1_1quantity.html">units::quantity</a></div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00028">units.h:29</a></div></div>
<div class="ttc" id="aclassvehicle_html"><div class="ttname"><a href="classvehicle.html">vehicle</a></div><div class="ttdoc">A vehicle as a whole with all its components.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00801">vehicle.h:802</a></div></div>
<div class="ttc" id="aclassvehicle_html_a341515426011486c265d016c35f84de6"><div class="ttname"><a href="classvehicle.html#a341515426011486c265d016c35f84de6">vehicle::player_in_control</a></div><div class="ttdeci">bool player_in_control(const Character &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l00253">vehicle.cpp:253</a></div></div>
<div class="ttc" id="aclassvehicle_html_a3900ee345be0453828a955a200154db1"><div class="ttname"><a href="classvehicle.html#a3900ee345be0453828a955a200154db1">vehicle::global_pos3</a></div><div class="ttdeci">tripoint global_pos3() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l03431">vehicle.cpp:3431</a></div></div>
<div class="ttc" id="aclassvehicle_html_a7169d55f706c34c402ed7ff8e9fa13f3"><div class="ttname"><a href="classvehicle.html#a7169d55f706c34c402ed7ff8e9fa13f3">vehicle::get_display_of_tile</a></div><div class="ttdeci">vpart_display get_display_of_tile(const point &amp;dp, bool rotate=true, bool include_fake=true, bool below_roof=true, bool roof=true) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__display_8cpp_source.html#l00059">vehicle_display.cpp:59</a></div></div>
<div class="ttc" id="aclassvehicle_html_a898e68c15af3168bb84a22a71a454c70"><div class="ttname"><a href="classvehicle.html#a898e68c15af3168bb84a22a71a454c70">vehicle::roof_at_part</a></div><div class="ttdeci">int roof_at_part(int p) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l03290">vehicle.cpp:3290</a></div></div>
<div class="ttc" id="aclassvehicle_html_a8e021d197980bbed36ff3c43962df957"><div class="ttname"><a href="classvehicle.html#a8e021d197980bbed36ff3c43962df957">vehicle::face</a></div><div class="ttdeci">tileray face</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l02312">vehicle.h:2312</a></div></div>
<div class="ttc" id="aclassvehicle_html_a8e7305881802ea38e07925826da63b82"><div class="ttname"><a href="classvehicle.html#a8e7305881802ea38e07925826da63b82">vehicle::forward_velocity</a></div><div class="ttdeci">float forward_velocity() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__move_8cpp_source.html#l01580">vehicle_move.cpp:1580</a></div></div>
<div class="ttc" id="aclassvehicle_html_ae6df00db578931d74d20de595736b190"><div class="ttname"><a href="classvehicle.html#ae6df00db578931d74d20de595736b190">vehicle::get_points</a></div><div class="ttdeci">const std::set&lt; tripoint &gt; &amp; get_points(bool force_refresh=false, bool no_fake=false) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l07725">vehicle.cpp:7725</a></div></div>
<div class="ttc" id="aclassvehicle_html_af60dc22f3846d5dabbf7877f44ebf6f5"><div class="ttname"><a href="classvehicle.html#af60dc22f3846d5dabbf7877f44ebf6f5">vehicle::get_debug_overlay_data</a></div><div class="ttdeci">std::vector&lt; std::tuple&lt; point, int, std::string &gt; &gt; get_debug_overlay_data() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__autodrive_8cpp_source.html#l01264">vehicle_autodrive.cpp:1264</a></div></div>
<div class="ttc" id="aclassvpart__display_html"><div class="ttname"><a href="classvpart__display.html">vpart_display</a></div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00711">vehicle.h:712</a></div></div>
<div class="ttc" id="aclassvpart__display_html_a2a0ad17dc48d84832ad6147498f1d3c0"><div class="ttname"><a href="classvpart__display.html#a2a0ad17dc48d84832ad6147498f1d3c0">vpart_display::id</a></div><div class="ttdeci">const vpart_id &amp; id</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00717">vehicle.h:717</a></div></div>
<div class="ttc" id="aclassvpart__display_html_a325e6771036b594fbcf5b52afc4c95e0"><div class="ttname"><a href="classvpart__display.html#a325e6771036b594fbcf5b52afc4c95e0">vpart_display::is_open</a></div><div class="ttdeci">bool is_open</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00723">vehicle.h:723</a></div></div>
<div class="ttc" id="aclassvpart__display_html_a663b6eed211568abb1b457231c6df88a"><div class="ttname"><a href="classvpart__display.html#a663b6eed211568abb1b457231c6df88a">vpart_display::has_cargo</a></div><div class="ttdeci">bool has_cargo</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00724">vehicle.h:724</a></div></div>
<div class="ttc" id="aclassvpart__display_html_a995ba5771e3638a4d16f798896bc82ff"><div class="ttname"><a href="classvpart__display.html#a995ba5771e3638a4d16f798896bc82ff">vpart_display::get_tileset_id</a></div><div class="ttdeci">std::string get_tileset_id() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__display_8cpp_source.html#l00045">vehicle_display.cpp:45</a></div></div>
<div class="ttc" id="aclassvpart__display_html_ab0940fd60c429e209b874e9447f0be48"><div class="ttname"><a href="classvpart__display.html#ab0940fd60c429e209b874e9447f0be48">vpart_display::is_broken</a></div><div class="ttdeci">bool is_broken</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00722">vehicle.h:722</a></div></div>
<div class="ttc" id="aclassvpart__display_html_afc4fcc47144565397f41a1659b953b74"><div class="ttname"><a href="classvpart__display.html#afc4fcc47144565397f41a1659b953b74">vpart_display::variant</a></div><div class="ttdeci">const vpart_variant &amp; variant</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00718">vehicle.h:718</a></div></div>
<div class="ttc" id="aclassvpart__info_html"><div class="ttname"><a href="classvpart__info.html">vpart_info</a></div><div class="ttdef"><b>Definition:</b> <a href="veh__type_8h_source.html#l00239">veh_type.h:240</a></div></div>
<div class="ttc" id="aclassvpart__info_html_ac49f2d6f9a4b8e42a768dfb28dad69c3"><div class="ttname"><a href="classvpart__info.html#ac49f2d6f9a4b8e42a768dfb28dad69c3">vpart_info::variants</a></div><div class="ttdeci">std::map&lt; std::string, vpart_variant &gt; variants</div><div class="ttdef"><b>Definition:</b> <a href="veh__type_8h_source.html#l00342">veh_type.h:342</a></div></div>
<div class="ttc" id="aclassvpart__info_html_ac8dbc94ea6028b13c5a9f4e8da9b14ba"><div class="ttname"><a href="classvpart__info.html#ac8dbc94ea6028b13c5a9f4e8da9b14ba">vpart_info::color</a></div><div class="ttdeci">nc_color color</div><div class="ttdoc">Color of part for different states.</div><div class="ttdef"><b>Definition:</b> <a href="veh__type_8h_source.html#l00378">veh_type.h:378</a></div></div>
<div class="ttc" id="aclassvpart__position_html"><div class="ttname"><a href="classvpart__position.html">vpart_position</a></div><div class="ttdoc">Reference to a position (a point) of the vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="vpart__position_8h_source.html#l00043">vpart_position.h:44</a></div></div>
<div class="ttc" id="aclassvpart__position_html_a3888b23941b14d5931801b7afe3e3eb8"><div class="ttname"><a href="classvpart__position.html#a3888b23941b14d5931801b7afe3e3eb8">vpart_position::obstacle_at_part</a></div><div class="ttdeci">std::optional&lt; vpart_reference &gt; obstacle_at_part() const</div><div class="ttdoc">Returns the obstacle that exists at this point of the vehicle (if any).</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l02604">vehicle.cpp:2604</a></div></div>
<div class="ttc" id="aclassvpart__variant_html"><div class="ttname"><a href="classvpart__variant.html">vpart_variant</a></div><div class="ttdef"><b>Definition:</b> <a href="veh__type_8h_source.html#l00209">veh_type.h:210</a></div></div>
<div class="ttc" id="aclassvpart__variant_html_a20202dc1a49cd7bac2d070c619c41152"><div class="ttname"><a href="classvpart__variant.html#a20202dc1a49cd7bac2d070c619c41152">vpart_variant::get_symbol_curses</a></div><div class="ttdeci">int get_symbol_curses(units::angle direction, bool is_broken) const</div><div class="ttdef"><b>Definition:</b> <a href="veh__type_8cpp_source.html#l01191">veh_type.cpp:1191</a></div></div>
<div class="ttc" id="aclassvpart__variant_html_af93535cc7d60651707ef94391cb385f1"><div class="ttname"><a href="classvpart__variant.html#af93535cc7d60651707ef94391cb385f1">vpart_variant::id</a></div><div class="ttdeci">std::string id</div><div class="ttdef"><b>Definition:</b> <a href="veh__type_8h_source.html#l00212">veh_type.h:212</a></div></div>
<div class="ttc" id="aclasszone__data_html"><div class="ttname"><a href="classzone__data.html">zone_data</a></div><div class="ttdoc">These are zones the player can designate.</div><div class="ttdef"><b>Definition:</b> <a href="clzones_8h_source.html#l00348">clzones.h:349</a></div></div>
<div class="ttc" id="aclasszone__data_html_a170c22a33e6fa998353ad0bbf9caafe3"><div class="ttname"><a href="classzone__data.html#a170c22a33e6fa998353ad0bbf9caafe3">zone_data::get_options</a></div><div class="ttdeci">const zone_options &amp; get_options() const</div><div class="ttdef"><b>Definition:</b> <a href="clzones_8h_source.html#l00490">clzones.h:490</a></div></div>
<div class="ttc" id="aclasszone__data_html_adbde632da5acfb7b86495d68a9b7455d"><div class="ttname"><a href="classzone__data.html#adbde632da5acfb7b86495d68a9b7455d">zone_data::has_options</a></div><div class="ttdeci">bool has_options() const</div><div class="ttdef"><b>Definition:</b> <a href="clzones_8h_source.html#l00487">clzones.h:487</a></div></div>
<div class="ttc" id="aclasszone__manager_html"><div class="ttname"><a href="classzone__manager.html">zone_manager</a></div><div class="ttdef"><b>Definition:</b> <a href="clzones_8h_source.html#l00512">clzones.h:513</a></div></div>
<div class="ttc" id="aclasszone__manager_html_a54609d51d21bd8f370ee8b59525eb750"><div class="ttname"><a href="classzone__manager.html#a54609d51d21bd8f370ee8b59525eb750">zone_manager::get_manager</a></div><div class="ttdeci">static zone_manager &amp; get_manager()</div><div class="ttdef"><b>Definition:</b> <a href="clzones_8h_source.html#l00550">clzones.h:550</a></div></div>
<div class="ttc" id="aclasszone__manager_html_ab8daed2ba10b94a1f679165ef17db6b9"><div class="ttname"><a href="classzone__manager.html#ab8daed2ba10b94a1f679165ef17db6b9">zone_manager::get_bottom_zone</a></div><div class="ttdeci">const zone_data * get_bottom_zone(const tripoint_abs_ms &amp;where, const faction_id &amp;fac=your_fac) const</div><div class="ttdef"><b>Definition:</b> <a href="clzones_8cpp_source.html#l01340">clzones.cpp:1340</a></div></div>
<div class="ttc" id="aclzones_8h_html"><div class="ttname"><a href="clzones_8h.html">clzones.h</a></div></div>
<div class="ttc" id="acolor_8cpp_html_a4a88185cb5fcb714421d6bc682481d5b"><div class="ttname"><a href="color_8cpp.html#a4a88185cb5fcb714421d6bc682481d5b">color_from_string</a></div><div class="ttdeci">nc_color color_from_string(const std::string_view color, const report_color_error color_error)</div><div class="ttdoc">Given the name of a foreground color, returns the nc_color value that matches.</div><div class="ttdef"><b>Definition:</b> <a href="color_8cpp_source.html#l00629">color.cpp:629</a></div></div>
<div class="ttc" id="acolor_8cpp_html_a99e42a5de98370aab8662d4423cf4a4d"><div class="ttname"><a href="color_8cpp.html#a99e42a5de98370aab8662d4423cf4a4d">hilite</a></div><div class="ttdeci">nc_color hilite(const nc_color &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="color_8cpp_source.html#l00546">color.cpp:546</a></div></div>
<div class="ttc" id="acolor_8h_html"><div class="ttname"><a href="color_8h.html">color.h</a></div></div>
<div class="ttc" id="acolor_8h_html_a0d06dc49b9761bbc54607397213728bb"><div class="ttname"><a href="color_8h.html#a0d06dc49b9761bbc54607397213728bb">c_white</a></div><div class="ttdeci">#define c_white</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00016">color.h:16</a></div></div>
<div class="ttc" id="acolor_8h_html_a1b1e3c0bef566a83c3535e38a93ad733"><div class="ttname"><a href="color_8h.html#a1b1e3c0bef566a83c3535e38a93ad733">c_light_gray</a></div><div class="ttdeci">#define c_light_gray</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00017">color.h:17</a></div></div>
<div class="ttc" id="acolor_8h_html_a2d8f37367a34632745626276dd4c9da6"><div class="ttname"><a href="color_8h.html#a2d8f37367a34632745626276dd4c9da6">c_black</a></div><div class="ttdeci">#define c_black</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00015">color.h:15</a></div></div>
<div class="ttc" id="acolor_8h_html_a39fc218ef401d918701636583a85a168"><div class="ttname"><a href="color_8h.html#a39fc218ef401d918701636583a85a168">c_magenta</a></div><div class="ttdeci">#define c_magenta</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00023">color.h:23</a></div></div>
<div class="ttc" id="acolor_8h_html_a5738d18ff9e165cca088a623cb1883ae"><div class="ttname"><a href="color_8h.html#a5738d18ff9e165cca088a623cb1883ae">c_dark_gray</a></div><div class="ttdeci">#define c_dark_gray</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00018">color.h:18</a></div></div>
<div class="ttc" id="acolor_8h_html_a81e80ab9142609903b4788a6bb31ae45"><div class="ttname"><a href="color_8h.html#a81e80ab9142609903b4788a6bb31ae45">c_yellow</a></div><div class="ttdeci">#define c_yellow</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00030">color.h:30</a></div></div>
<div class="ttc" id="acolor_8h_html_af0a87eaef36305269f4506dfa34d94c0"><div class="ttname"><a href="color_8h.html#af0a87eaef36305269f4506dfa34d94c0">c_red</a></div><div class="ttdeci">#define c_red</div><div class="ttdef"><b>Definition:</b> <a href="color_8h_source.html#l00019">color.h:19</a></div></div>
<div class="ttc" id="acreature_8h_html_a299ec0c42ccc5a2d79d1739428ac3210"><div class="ttname"><a href="creature_8h.html#a299ec0c42ccc5a2d79d1739428ac3210">intensity</a></div><div class="ttdeci">int intensity</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00240">creature.h:240</a></div></div>
<div class="ttc" id="acreature_8h_html_a4b73e33b57ae387dc418906492d5f998"><div class="ttname"><a href="creature_8h.html#a4b73e33b57ae387dc418906492d5f998">force</a></div><div class="ttdeci">bool force</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00241">creature.h:241</a></div></div>
<div class="ttc" id="acreature_8h_html_ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403"><div class="ttname"><a href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a21507b40c80068eda19865706fdc2403">FacingDirection::RIGHT</a></div><div class="ttdeci">@ RIGHT</div></div>
<div class="ttc" id="acreature_8h_html_ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758"><div class="ttname"><a href="creature_8h.html#ab97a871dbf59ff8692908611795f7642a684d325a7303f52e64011467ff5c5758">FacingDirection::LEFT</a></div><div class="ttdeci">@ LEFT</div></div>
<div class="ttc" id="acreature__tracker_8h_html"><div class="ttname"><a href="creature__tracker_8h.html">creature_tracker.h</a></div></div>
<div class="ttc" id="acreature__tracker_8h_html_a16f631f70e72b53e590770670fb301fb"><div class="ttname"><a href="creature__tracker_8h.html#a16f631f70e72b53e590770670fb301fb">get_creature_tracker</a></div><div class="ttdeci">creature_tracker &amp; get_creature_tracker()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13827">game.cpp:13827</a></div></div>
<div class="ttc" id="acursesdef_8h_html"><div class="ttname"><a href="cursesdef_8h.html">cursesdef.h</a></div></div>
<div class="ttc" id="acursesport_8h_html"><div class="ttname"><a href="cursesport_8h.html">cursesport.h</a></div></div>
<div class="ttc" id="adebug_8cpp_html_a240782b16593c6bd607c64787c62da0e"><div class="ttname"><a href="debug_8cpp.html#a240782b16593c6bd607c64787c62da0e">DebugLog</a></div><div class="ttdeci">std::ostream &amp; DebugLog(DebugLevel lev, DebugClass cl)</div><div class="ttdef"><b>Definition:</b> <a href="debug_8cpp_source.html#l01438">debug.cpp:1438</a></div></div>
<div class="ttc" id="adebug_8h_html"><div class="ttname"><a href="debug_8h.html">debug.h</a></div></div>
<div class="ttc" id="adebug_8h_html_a87e509562277a7ada3a75330d00cb445"><div class="ttname"><a href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a></div><div class="ttdeci">#define debugmsg(...)</div><div class="ttdoc">Debug message of level D_ERROR and class D_MAIN, also includes the source file name and line,...</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00069">debug.h:69</a></div></div>
<div class="ttc" id="adebug_8h_html_ab658e6d84759440dbf3c890446075395a4759bd3f0b71819391a3e4024b645d69"><div class="ttname"><a href="debug_8h.html#ab658e6d84759440dbf3c890446075395a4759bd3f0b71819391a3e4024b645d69">D_ERROR</a></div><div class="ttdeci">@ D_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00142">debug.h:142</a></div></div>
<div class="ttc" id="adebug_8h_html_ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba"><div class="ttname"><a href="debug_8h.html#ab658e6d84759440dbf3c890446075395ab51d2329abb542af139bd358206609ba">D_INFO</a></div><div class="ttdeci">@ D_INFO</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00140">debug.h:140</a></div></div>
<div class="ttc" id="adebug_8h_html_afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14"><div class="ttname"><a href="debug_8h.html#afa45cf12d72d4226196a7d03c54ad7d3adfa3ea5b834aebc2a8e4e83b7d33db14">DC_ALL</a></div><div class="ttdeci">@ DC_ALL</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00176">debug.h:175</a></div></div>
<div class="ttc" id="adescriptions_8cpp_html_aeed2fa049c80ba4e2960866b4e00d5d8a8a52e7a8d3b4c955d6f7927c6ba3fe72"><div class="ttname"><a href="descriptions_8cpp.html#aeed2fa049c80ba4e2960866b4e00d5d8a8a52e7a8d3b4c955d6f7927c6ba3fe72">description_target::creature</a></div><div class="ttdeci">@ creature</div></div>
<div class="ttc" id="adisplay_8h_html_ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f"><div class="ttname"><a href="display_8h.html#ad55df0d7f625a78f1afc728ee1a6d6a4a3d801aa532c1cec3ee82d87a99fdf63f">bodygraph_var::temp</a></div><div class="ttdeci">@ temp</div></div>
<div class="ttc" id="adrawing__primitives_8cpp_html_aa448993c381ed2832585af66baa6cb23"><div class="ttname"><a href="drawing__primitives_8cpp.html#aa448993c381ed2832585af66baa6cb23">draw_line</a></div><div class="ttdeci">void draw_line(const std::function&lt; void(const point &amp;)&gt; &amp;set, const point &amp;p1, const point &amp;p2)</div><div class="ttdef"><b>Definition:</b> <a href="drawing__primitives_8cpp_source.html#l00011">drawing_primitives.cpp:11</a></div></div>
<div class="ttc" id="aeditmap_8cpp_html_a025a5c063205294df20818edc4cfe355"><div class="ttname"><a href="editmap_8cpp.html#a025a5c063205294df20818edc4cfe355">color</a></div><div class="ttdeci">static nc_color color(const T_t &amp;t)</div></div>
<div class="ttc" id="aenums_8h_html_a00763863874f01b868849b27ceee73c9a1f02cb4178d2f744c7ac2fa1b34a42c9"><div class="ttname"><a href="enums_8h.html#a00763863874f01b868849b27ceee73c9a1f02cb4178d2f744c7ac2fa1b34a42c9">end_piece</a></div><div class="ttdeci">@ end_piece</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00414">enums.h:414</a></div></div>
<div class="ttc" id="aenums_8h_html_a00763863874f01b868849b27ceee73c9a1f85e94c05010d1308d67d1d918944e4"><div class="ttname"><a href="enums_8h.html#a00763863874f01b868849b27ceee73c9a1f85e94c05010d1308d67d1d918944e4">broken</a></div><div class="ttdeci">@ broken</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00417">enums.h:417</a></div></div>
<div class="ttc" id="aenums_8h_html_a00763863874f01b868849b27ceee73c9a51c08cf9763167d97834c0c196ebcd8e"><div class="ttname"><a href="enums_8h.html#a00763863874f01b868849b27ceee73c9a51c08cf9763167d97834c0c196ebcd8e">t_connection</a></div><div class="ttdeci">@ t_connection</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00413">enums.h:413</a></div></div>
<div class="ttc" id="aenums_8h_html_a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28"><div class="ttname"><a href="enums_8h.html#a00763863874f01b868849b27ceee73c9a9a7f1c7d12afe397733af7bb9a539f28">edge</a></div><div class="ttdeci">@ edge</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00412">enums.h:412</a></div></div>
<div class="ttc" id="aenums_8h_html_a00763863874f01b868849b27ceee73c9aa0734d934d4034f144b98c304caab076"><div class="ttname"><a href="enums_8h.html#a00763863874f01b868849b27ceee73c9aa0734d934d4034f144b98c304caab076">open_</a></div><div class="ttdeci">@ open_</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00416">enums.h:416</a></div></div>
<div class="ttc" id="aenums_8h_html_a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834"><div class="ttname"><a href="enums_8h.html#a00763863874f01b868849b27ceee73c9aaff35d0e26ed8830cf708063bac9c834">corner</a></div><div class="ttdeci">@ corner</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00411">enums.h:411</a></div></div>
<div class="ttc" id="aenums_8h_html_a00763863874f01b868849b27ceee73c9ab9f378b6c23a56efbb2f5c5014f78ea5"><div class="ttname"><a href="enums_8h.html#a00763863874f01b868849b27ceee73c9ab9f378b6c23a56efbb2f5c5014f78ea5">unconnected</a></div><div class="ttdeci">@ unconnected</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00415">enums.h:415</a></div></div>
<div class="ttc" id="aenums_8h_html_a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a"><div class="ttname"><a href="enums_8h.html#a02646717f97faa05c11dbda0aac2c716a851f5ac9941d720844d143ed9cfcf60a">ot_match_type::prefix</a></div><div class="ttdeci">@ prefix</div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096e"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096e">game_message_type</a></div><div class="ttdeci">game_message_type</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00346">enums.h:346</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10">m_good</a></div><div class="ttdeci">@ m_good</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00347">enums.h:347</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea379f06a1968886ca7a96b103d5a628fc"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea379f06a1968886ca7a96b103d5a628fc">m_grazing</a></div><div class="ttdeci">@ m_grazing</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00362">enums.h:362</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea3ab788e6c7dfa584be4ca2e90c49ec8c"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea3ab788e6c7dfa584be4ca2e90c49ec8c">m_neutral</a></div><div class="ttdeci">@ m_neutral</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00354">enums.h:354</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a></div><div class="ttdeci">@ m_info</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00352">enums.h:352</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a></div><div class="ttdeci">@ m_bad</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00348">enums.h:348</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea8663170a60ff438f4ba2ab98a1e6d6b5"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea8663170a60ff438f4ba2ab98a1e6d6b5">m_critical</a></div><div class="ttdeci">@ m_critical</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00361">enums.h:361</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea917308a5da5a853b7ac25b683922ef96"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea917308a5da5a853b7ac25b683922ef96">m_headshot</a></div><div class="ttdeci">@ m_headshot</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00360">enums.h:360</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096eaa65a3cd4a2c6d0fbb31833ade22ee100"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaa65a3cd4a2c6d0fbb31833ade22ee100">m_mixed</a></div><div class="ttdeci">@ m_mixed</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00349">enums.h:349</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a></div><div class="ttdeci">@ m_warning</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00351">enums.h:351</a></div></div>
<div class="ttc" id="aenums_8h_html_a5a4abd9e47d931dc62b0aadf09ede92e"><div class="ttname"><a href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92e">visibility_type</a></div><div class="ttdeci">visibility_type</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00115">enums.h:115</a></div></div>
<div class="ttc" id="aenums_8h_html_a5a4abd9e47d931dc62b0aadf09ede92ea347e628a8f72626a0611ef842fe9d304"><div class="ttname"><a href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92ea347e628a8f72626a0611ef842fe9d304">visibility_type::HIDDEN</a></div><div class="ttdeci">@ HIDDEN</div></div>
<div class="ttc" id="aenums_8h_html_a5a4abd9e47d931dc62b0aadf09ede92ea813461e0c58e7ad59a2fd83ca2237fec"><div class="ttname"><a href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92ea813461e0c58e7ad59a2fd83ca2237fec">visibility_type::CLEAR</a></div><div class="ttdeci">@ CLEAR</div></div>
<div class="ttc" id="aenums_8h_html_a5a4abd9e47d931dc62b0aadf09ede92eaa4e36ae36e52be95ee5c8d2bc974dfd8"><div class="ttname"><a href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92eaa4e36ae36e52be95ee5c8d2bc974dfd8">visibility_type::LIT</a></div><div class="ttdeci">@ LIT</div></div>
<div class="ttc" id="aenums_8h_html_a5a4abd9e47d931dc62b0aadf09ede92eaacaef50d33fc86532c260a045c672f3e"><div class="ttname"><a href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92eaacaef50d33fc86532c260a045c672f3e">visibility_type::DARK</a></div><div class="ttdeci">@ DARK</div></div>
<div class="ttc" id="aenums_8h_html_a5a4abd9e47d931dc62b0aadf09ede92eae8e4aa962e8efae537d18456fa7b49ab"><div class="ttname"><a href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92eae8e4aa962e8efae537d18456fa7b49ab">visibility_type::BOOMER</a></div><div class="ttdeci">@ BOOMER</div></div>
<div class="ttc" id="aenums_8h_html_a5a4abd9e47d931dc62b0aadf09ede92eaed63a54298847d9f23d13f422561be4d"><div class="ttname"><a href="enums_8h.html#a5a4abd9e47d931dc62b0aadf09ede92eaed63a54298847d9f23d13f422561be4d">visibility_type::BOOMER_DARK</a></div><div class="ttdeci">@ BOOMER_DARK</div></div>
<div class="ttc" id="aenums_8h_html_a805138f2fff55cebf7ad4bc2b49f1f71a479a2f961e7db58cfe3291ea257d432a"><div class="ttname"><a href="enums_8h.html#a805138f2fff55cebf7ad4bc2b49f1f71a479a2f961e7db58cfe3291ea257d432a">object_type::FURNITURE</a></div><div class="ttdeci">@ FURNITURE</div></div>
<div class="ttc" id="aenums_8h_html_a805138f2fff55cebf7ad4bc2b49f1f71ae9fa318f4d73c31493e98096efa497e2"><div class="ttname"><a href="enums_8h.html#a805138f2fff55cebf7ad4bc2b49f1f71ae9fa318f4d73c31493e98096efa497e2">object_type::VEHICLE</a></div><div class="ttdeci">@ VEHICLE</div></div>
<div class="ttc" id="afield_8h_html"><div class="ttname"><a href="field_8h.html">field.h</a></div></div>
<div class="ttc" id="afield__type_8cpp_html_abbf9ee25d4081063b76f7f3bd2a11793"><div class="ttname"><a href="field__type_8cpp.html#abbf9ee25d4081063b76f7f3bd2a11793">fd_null</a></div><div class="ttdeci">const field_type_str_id fd_null</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8cpp_source.html#l00011">field_type.cpp:11</a></div></div>
<div class="ttc" id="afield__type_8h_html"><div class="ttname"><a href="field__type_8h.html">field_type.h</a></div></div>
<div class="ttc" id="afilesystem_8h_html"><div class="ttname"><a href="filesystem_8h.html">filesystem.h</a></div></div>
<div class="ttc" id="agame_8cpp_html_a20e1e24b746d8844d2e554086ba3b3bb"><div class="ttname"><a href="game_8cpp.html#a20e1e24b746d8844d2e554086ba3b3bb">get_weather</a></div><div class="ttdeci">weather_manager &amp; get_weather()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13866">game.cpp:13866</a></div></div>
<div class="ttc" id="agame_8cpp_html_a7f3efc14d34d48d62804d9b8b8e627cc"><div class="ttname"><a href="game_8cpp.html#a7f3efc14d34d48d62804d9b8b8e627cc">trait_INATTENTIVE</a></div><div class="ttdeci">static const trait_id trait_INATTENTIVE(&quot;INATTENTIVE&quot;)</div></div>
<div class="ttc" id="agame_8cpp_html_ab5c977b7e81348725fb7bf09fc64ed95"><div class="ttname"><a href="game_8cpp.html#ab5c977b7e81348725fb7bf09fc64ed95">get_player_view</a></div><div class="ttdeci">viewer &amp; get_player_view()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13812">game.cpp:13812</a></div></div>
<div class="ttc" id="agame_8cpp_html_abeb98e93502d73818b4a73fabe191bc1"><div class="ttname"><a href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a></div><div class="ttdeci">std::unique_ptr&lt; game &gt; g</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l00382">game.cpp:382</a></div></div>
<div class="ttc" id="agame_8cpp_html_afa1063326b0c16b43c6f3dc8c3df403d"><div class="ttname"><a href="game_8cpp.html#afa1063326b0c16b43c6f3dc8c3df403d">get_map</a></div><div class="ttdeci">map &amp; get_map()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13822">game.cpp:13822</a></div></div>
<div class="ttc" id="agame_8cpp_html_afee362892b161716a3fc614b030a877d"><div class="ttname"><a href="game_8cpp.html#afee362892b161716a3fc614b030a877d">get_scent</a></div><div class="ttdeci">scent_map &amp; get_scent()</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l13851">game.cpp:13851</a></div></div>
<div class="ttc" id="agame_8h_html"><div class="ttname"><a href="game_8h.html">game.h</a></div></div>
<div class="ttc" id="agame__constants_8h_html"><div class="ttname"><a href="game__constants_8h.html">game_constants.h</a></div></div>
<div class="ttc" id="agame__constants_8h_html_a39fd8a829e3dc412646663066dbdb54c"><div class="ttname"><a href="game__constants_8h.html#a39fd8a829e3dc412646663066dbdb54c">SEEX</a></div><div class="ttdeci">constexpr int SEEX</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00042">game_constants.h:42</a></div></div>
<div class="ttc" id="agame__constants_8h_html_a4cfa35de359af17f7bc6c2a424339eb5"><div class="ttname"><a href="game__constants_8h.html#a4cfa35de359af17f7bc6c2a424339eb5">SEEY</a></div><div class="ttdeci">constexpr int SEEY</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00043">game_constants.h:43</a></div></div>
<div class="ttc" id="agame__constants_8h_html_aad0eacfa516a8f7e005674027d7640fe"><div class="ttname"><a href="game__constants_8h.html#aad0eacfa516a8f7e005674027d7640fe">OVERMAP_DEPTH</a></div><div class="ttdeci">constexpr int OVERMAP_DEPTH</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00073">game_constants.h:73</a></div></div>
<div class="ttc" id="agame__constants_8h_html_ad277b12d7860c613865a85a2cc383c17"><div class="ttname"><a href="game__constants_8h.html#ad277b12d7860c613865a85a2cc383c17">MAPSIZE</a></div><div class="ttdeci">constexpr int MAPSIZE</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00037">game_constants.h:37</a></div></div>
<div class="ttc" id="ageneric__factory_8h_html_a43443191f61bb76aca1c2895eea4ad8f"><div class="ttname"><a href="generic__factory_8h.html#a43443191f61bb76aca1c2895eea4ad8f">optional</a></div><div class="ttdeci">void optional(const JsonObject &amp;jo, const bool was_loaded, const std::string_view name, MemberType &amp;member)</div><div class="ttdef"><b>Definition:</b> <a href="generic__factory_8h_source.html#l00829">generic_factory.h:829</a></div></div>
<div class="ttc" id="aglobal__vars_8h_html_a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab"><div class="ttname"><a href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">var_type::context</a></div><div class="ttdeci">@ context</div></div>
<div class="ttc" id="agroup__Weather_html_ga92e3dd986a664a399dffe62d2ebe2139"><div class="ttname"><a href="group__Weather.html#ga92e3dd986a664a399dffe62d2ebe2139">weather_manager::get_temperature</a></div><div class="ttdeci">units::temperature get_temperature(const tripoint &amp;location)</div><div class="ttdef"><b>Definition:</b> <a href="weather_8cpp_source.html#l00957">weather.cpp:957</a></div></div>
<div class="ttc" id="aiexamine_8cpp_html_a4ea2c47870b82e831292a9239b2e6ff2"><div class="ttname"><a href="iexamine_8cpp.html#a4ea2c47870b82e831292a9239b2e6ff2">itype_corpse</a></div><div class="ttdeci">static const itype_id itype_corpse(&quot;corpse&quot;)</div></div>
<div class="ttc" id="ainput_8cpp_html_af16c50890fa8503efa899fc3b6de56d7"><div class="ttname"><a href="input_8cpp.html#af16c50890fa8503efa899fc3b6de56d7">inp_mngr</a></div><div class="ttdeci">input_manager inp_mngr</div><div class="ttdef"><b>Definition:</b> <a href="input_8cpp_source.html#l00161">input.cpp:161</a></div></div>
<div class="ttc" id="ainput_8h_html"><div class="ttname"><a href="input_8h.html">input.h</a></div></div>
<div class="ttc" id="aint__id_8h_html"><div class="ttname"><a href="int__id_8h.html">int_id.h</a></div></div>
<div class="ttc" id="aitem_8h_html"><div class="ttname"><a href="item_8h.html">item.h</a></div></div>
<div class="ttc" id="aitem__factory_8cpp_html_a62fc9d4e4ca8f0e62b4556f5f65b666c"><div class="ttname"><a href="item__factory_8cpp.html#a62fc9d4e4ca8f0e62b4556f5f65b666c">item_controller</a></div><div class="ttdeci">std::unique_ptr&lt; Item_factory &gt; item_controller</div><div class="ttdef"><b>Definition:</b> <a href="item__factory_8cpp_source.html#l00126">item_factory.cpp:126</a></div></div>
<div class="ttc" id="aitem__factory_8h_html"><div class="ttname"><a href="item__factory_8h.html">item_factory.h</a></div></div>
<div class="ttc" id="aitype_8h_html"><div class="ttname"><a href="itype_8h.html">itype.h</a></div></div>
<div class="ttc" id="ajson_8h_html"><div class="ttname"><a href="json_8h.html">json.h</a></div></div>
<div class="ttc" id="ajson__loader_8h_html"><div class="ttname"><a href="json__loader_8h.html">json_loader.h</a></div></div>
<div class="ttc" id="alightmap_8h_html_ab007d848fe0f7de9118042fff85fef07"><div class="ttname"><a href="lightmap_8h.html#ab007d848fe0f7de9118042fff85fef07">LIGHT_TRANSPARENCY_OPEN_AIR</a></div><div class="ttdeci">constexpr float LIGHT_TRANSPARENCY_OPEN_AIR</div><div class="ttdef"><b>Definition:</b> <a href="lightmap_8h_source.html#l00036">lightmap.h:36</a></div></div>
<div class="ttc" id="alightmap_8h_html_aeb9bbbd65db85e3561729666fb6c7b38"><div class="ttname"><a href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38">lit_level</a></div><div class="ttdeci">lit_level</div><div class="ttdef"><b>Definition:</b> <a href="lightmap_8h_source.html#l00050">lightmap.h:50</a></div></div>
<div class="ttc" id="alightmap_8h_html_aeb9bbbd65db85e3561729666fb6c7b38a41bc94cbd8eebea13ce0491b2ac11b88"><div class="ttname"><a href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a41bc94cbd8eebea13ce0491b2ac11b88">lit_level::LOW</a></div><div class="ttdeci">@ LOW</div></div>
<div class="ttc" id="alightmap_8h_html_aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c"><div class="ttname"><a href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38a719f57e329878958d6b4111357b7412c">lit_level::MEMORIZED</a></div><div class="ttdeci">@ MEMORIZED</div></div>
<div class="ttc" id="alightmap_8h_html_aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8"><div class="ttname"><a href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aa4e36ae36e52be95ee5c8d2bc974dfd8">lit_level::LIT</a></div><div class="ttdeci">@ LIT</div></div>
<div class="ttc" id="alightmap_8h_html_aeb9bbbd65db85e3561729666fb6c7b38aacaef50d33fc86532c260a045c672f3e"><div class="ttname"><a href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aacaef50d33fc86532c260a045c672f3e">lit_level::DARK</a></div><div class="ttdeci">@ DARK</div></div>
<div class="ttc" id="alightmap_8h_html_aeb9bbbd65db85e3561729666fb6c7b38aca78b38b9fe41e51b331abe6999a1040"><div class="ttname"><a href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38aca78b38b9fe41e51b331abe6999a1040">lit_level::BRIGHT</a></div><div class="ttdeci">@ BRIGHT</div></div>
<div class="ttc" id="alightmap_8h_html_aeb9bbbd65db85e3561729666fb6c7b38adaaecad8e0b70f2d3edbbcf6dbf444a2"><div class="ttname"><a href="lightmap_8h.html#aeb9bbbd65db85e3561729666fb6c7b38adaaecad8e0b70f2d3edbbcf6dbf444a2">lit_level::BRIGHT_ONLY</a></div><div class="ttdeci">@ BRIGHT_ONLY</div></div>
<div class="ttc" id="alightmap_8h_html_aee8c4bc593d2863e405cd21438a01f44"><div class="ttname"><a href="lightmap_8h.html#aee8c4bc593d2863e405cd21438a01f44">LIGHT_AMBIENT_LIT</a></div><div class="ttdeci">constexpr float LIGHT_AMBIENT_LIT</div><div class="ttdef"><b>Definition:</b> <a href="lightmap_8h_source.html#l00018">lightmap.h:18</a></div></div>
<div class="ttc" id="aline_8cpp_html_a399f25250fad82fbc37b72a78dfafb43"><div class="ttname"><a href="line_8cpp.html#a399f25250fad82fbc37b72a78dfafb43">displace_XY</a></div><div class="ttdeci">point displace_XY(const direction dir)</div><div class="ttdef"><b>Definition:</b> <a href="line_8cpp_source.html#l00515">line.cpp:515</a></div></div>
<div class="ttc" id="aline_8h_html_a3621d2006812bd84f3ed6999b38f90a3"><div class="ttname"><a href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a></div><div class="ttdeci">direction</div><div class="ttdef"><b>Definition:</b> <a href="line_8h_source.html#l00042">line.h:42</a></div></div>
<div class="ttc" id="aline_8h_html_a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403"><div class="ttname"><a href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a2bf8f791695c70efa9c14e6f1c326403">direction::NORTH</a></div><div class="ttdeci">@ NORTH</div></div>
<div class="ttc" id="aline_8h_html_a3621d2006812bd84f3ed6999b38f90a3a54486c15c75f9e0ada3484a7812252ff"><div class="ttname"><a href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a54486c15c75f9e0ada3484a7812252ff">direction::NORTHWEST</a></div><div class="ttdeci">@ NORTHWEST</div></div>
<div class="ttc" id="aline_8h_html_a3621d2006812bd84f3ed6999b38f90a3a83c9f5692281bf59471b13dfddb3af91"><div class="ttname"><a href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a83c9f5692281bf59471b13dfddb3af91">direction::WEST</a></div><div class="ttdeci">@ WEST</div></div>
<div class="ttc" id="aline_8h_html_a3621d2006812bd84f3ed6999b38f90a3a96e44fa82e5a5263fb92337be422d3eb"><div class="ttname"><a href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a96e44fa82e5a5263fb92337be422d3eb">direction::SOUTH</a></div><div class="ttdeci">@ SOUTH</div></div>
<div class="ttc" id="aline_8h_html_a3621d2006812bd84f3ed6999b38f90a3a96f30aeb5638ae7ac40d90b5ebdde47e"><div class="ttname"><a href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3a96f30aeb5638ae7ac40d90b5ebdde47e">direction::SOUTHWEST</a></div><div class="ttdeci">@ SOUTHWEST</div></div>
<div class="ttc" id="aline_8h_html_a3621d2006812bd84f3ed6999b38f90a3ac397289ee45877be0cd49811fe245b4e"><div class="ttname"><a href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3ac397289ee45877be0cd49811fe245b4e">direction::CENTER</a></div><div class="ttdeci">@ CENTER</div></div>
<div class="ttc" id="amagic_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="magic_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">static constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01566">magic.cpp:1566</a></div></div>
<div class="ttc" id="amagic_8cpp_html_a6753ecfe87da659675b18c2f81d6ec12"><div class="ttname"><a href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a></div><div class="ttdeci">static constexpr double c</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01568">magic.cpp:1568</a></div></div>
<div class="ttc" id="amagic_8cpp_html_aa93a189fb7bbbf87be54bcc7bd11bb6f"><div class="ttname"><a href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a></div><div class="ttdeci">static constexpr double b</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01567">magic.cpp:1567</a></div></div>
<div class="ttc" id="amagic_8h_html_a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc"><div class="ttname"><a href="magic_8h.html#a43ffd543787e68e5333debafdbb7ead7a447b7147e84be512208dcc0995d67ebc">spell_target::item</a></div><div class="ttdeci">@ item</div></div>
<div class="ttc" id="amap_8cpp_html_a8fd90c11d7a509a3c0af0144cd1e0b12"><div class="ttname"><a href="map_8cpp.html#a8fd90c11d7a509a3c0af0144cd1e0b12">tr_unfinished_construction</a></div><div class="ttdeci">static const trap_str_id tr_unfinished_construction(&quot;tr_unfinished_construction&quot;)</div></div>
<div class="ttc" id="amap_8h_html"><div class="ttname"><a href="map_8h.html">map.h</a></div></div>
<div class="ttc" id="amap__extras_8h_html"><div class="ttname"><a href="map__extras_8h.html">map_extras.h</a></div></div>
<div class="ttc" id="amap__memory_8h_html"><div class="ttname"><a href="map__memory_8h.html">map_memory.h</a></div></div>
<div class="ttc" id="amapdata_8h_html"><div class="ttname"><a href="mapdata_8h.html">mapdata.h</a></div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a56e78d8ee67ad1dfdcb62932045a8a17"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a56e78d8ee67ad1dfdcb62932045a8a17">ter_furn_flag::TFLAG_WINDOW</a></div><div class="ttdeci">@ TFLAG_WINDOW</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a6701f7dc0aa6dba5a2a7cbb3568c3673"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a6701f7dc0aa6dba5a2a7cbb3568c3673">ter_furn_flag::TFLAG_WALL</a></div><div class="ttdeci">@ TFLAG_WALL</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a6d8e901e3f5ad46758e03e8abe434ed5"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a6d8e901e3f5ad46758e03e8abe434ed5">ter_furn_flag::TFLAG_NO_SELF_CONNECT</a></div><div class="ttdeci">@ TFLAG_NO_SELF_CONNECT</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054a86266b671365a2d1a48c55fcb1eac067"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054a86266b671365a2d1a48c55fcb1eac067">ter_furn_flag::TFLAG_ALIGN_WORKBENCH</a></div><div class="ttdeci">@ TFLAG_ALIGN_WORKBENCH</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054ac862a199df92b3793a8ce4cf5b039d20"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ac862a199df92b3793a8ce4cf5b039d20">ter_furn_flag::TFLAG_DOOR</a></div><div class="ttdeci">@ TFLAG_DOOR</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054ad07116a9d172192917b9e8fda1230c83"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054ad07116a9d172192917b9e8fda1230c83">ter_furn_flag::TFLAG_NO_FLOOR_WATER</a></div><div class="ttdeci">@ TFLAG_NO_FLOOR_WATER</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054af2631f9535f52be23f6999592eed2608"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054af2631f9535f52be23f6999592eed2608">ter_furn_flag::TFLAG_SEEN_FROM_ABOVE</a></div><div class="ttdeci">@ TFLAG_SEEN_FROM_ABOVE</div></div>
<div class="ttc" id="amapdata_8h_html_a2edbbfd25069897b3062331e48224054af607730a38ff7975c6724b22881e0e58"><div class="ttname"><a href="mapdata_8h.html#a2edbbfd25069897b3062331e48224054af607730a38ff7975c6724b22881e0e58">ter_furn_flag::TFLAG_NO_FLOOR</a></div><div class="ttdeci">@ TFLAG_NO_FLOOR</div></div>
<div class="ttc" id="amath__parser__func_8h_html_a24f6ac6e06720c7cdf972a6083847132"><div class="ttname"><a href="math__parser__func_8h.html#a24f6ac6e06720c7cdf972a6083847132">abs</a></div><div class="ttdeci">double abs(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00030">math_parser_func.h:30</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a9009aa9e5eb1323238ebddffd8e1aedf"><div class="ttname"><a href="math__parser__func_8h.html#a9009aa9e5eb1323238ebddffd8e1aedf">max</a></div><div class="ttdeci">double max(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00035">math_parser_func.h:35</a></div></div>
<div class="ttc" id="amath__parser__func_8h_html_a993dede52d23a9a3d15b01a342391ef4"><div class="ttname"><a href="math__parser__func_8h.html#a993dede52d23a9a3d15b01a342391ef4">min</a></div><div class="ttdeci">double min(std::vector&lt; double &gt; const &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__func_8h_source.html#l00043">math_parser_func.h:43</a></div></div>
<div class="ttc" id="amod__tileset_8cpp_html_a93e6a2baacda4ff3c16d4046bfb58f26"><div class="ttname"><a href="mod__tileset_8cpp.html#a93e6a2baacda4ff3c16d4046bfb58f26">all_mod_tilesets</a></div><div class="ttdeci">std::vector&lt; mod_tileset &gt; all_mod_tilesets</div><div class="ttdef"><b>Definition:</b> <a href="mod__tileset_8cpp_source.html#l00008">mod_tileset.cpp:8</a></div></div>
<div class="ttc" id="amod__tileset_8h_html"><div class="ttname"><a href="mod__tileset_8h.html">mod_tileset.h</a></div></div>
<div class="ttc" id="amonster_8h_html"><div class="ttname"><a href="monster_8h.html">monster.h</a></div></div>
<div class="ttc" id="amonstergenerator_8h_html"><div class="ttname"><a href="monstergenerator_8h.html">monstergenerator.h</a></div></div>
<div class="ttc" id="amtype_8cpp_html_acc03233e053eb1e761f81eab7c05d871"><div class="ttname"><a href="mtype_8cpp.html#acc03233e053eb1e761f81eab7c05d871">mon_flag_ALWAYS_VISIBLE</a></div><div class="ttdeci">mon_flag_id mon_flag_ALWAYS_VISIBLE</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8cpp_source.html#l00046">mtype.cpp:46</a></div></div>
<div class="ttc" id="amtype_8h_html"><div class="ttname"><a href="mtype_8h.html">mtype.h</a></div></div>
<div class="ttc" id="amutation_8h_html"><div class="ttname"><a href="mutation_8h.html">mutation.h</a></div></div>
<div class="ttc" id="anamespaceMapExtras_html_a55242667262f19e4358210f893caeade"><div class="ttname"><a href="namespaceMapExtras.html#a55242667262f19e4358210f893caeade">MapExtras::get_all_function_names</a></div><div class="ttdeci">std::vector&lt; map_extra_id &gt; get_all_function_names()</div><div class="ttdef"><b>Definition:</b> <a href="map__extras_8cpp_source.html#l02183">map_extras.cpp:2183</a></div></div>
<div class="ttc" id="anamespacePATH__INFO_html_a0773f1e01a9fb190c2f1e385ad2892b1"><div class="ttname"><a href="namespacePATH__INFO.html#a0773f1e01a9fb190c2f1e385ad2892b1">PATH_INFO::defaulttilepng</a></div><div class="ttdeci">std::string defaulttilepng()</div><div class="ttdef"><b>Definition:</b> <a href="path__info_8cpp_source.html#l00286">path_info.cpp:286</a></div></div>
<div class="ttc" id="anamespacePATH__INFO_html_a3aa2e839e6beebf5c776979147cd0d4b"><div class="ttname"><a href="namespacePATH__INFO.html#a3aa2e839e6beebf5c776979147cd0d4b">PATH_INFO::defaultlayeringjson</a></div><div class="ttdeci">std::string defaultlayeringjson()</div><div class="ttdef"><b>Definition:</b> <a href="path__info_8cpp_source.html#l00282">path_info.cpp:282</a></div></div>
<div class="ttc" id="anamespacePATH__INFO_html_adcb5161c3623a688d09bf1a0bc575dce"><div class="ttname"><a href="namespacePATH__INFO.html#adcb5161c3623a688d09bf1a0bc575dce">PATH_INFO::tileset_conf</a></div><div class="ttdeci">std::string tileset_conf()</div><div class="ttdef"><b>Definition:</b> <a href="path__info_8cpp_source.html#l00426">path_info.cpp:426</a></div></div>
<div class="ttc" id="anamespacePATH__INFO_html_ae4c0906500b222227e00bc34cc94252f"><div class="ttname"><a href="namespacePATH__INFO.html#ae4c0906500b222227e00bc34cc94252f">PATH_INFO::defaulttilejson</a></div><div class="ttdeci">std::string defaulttilejson()</div><div class="ttdef"><b>Definition:</b> <a href="path__info_8cpp_source.html#l00278">path_info.cpp:278</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02item__tname_8cpp_03_html_a01bb93e9b73c4fc64afc80ffde115c0a"><div class="ttname"><a href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a01bb93e9b73c4fc64afc80ffde115c0a">anonymous_namespace{item_tname.cpp}::category</a></div><div class="ttdeci">std::string category(item const &amp;it, unsigned int quantity, segment_bitset const &amp;segments)</div><div class="ttdef"><b>Definition:</b> <a href="item__tname_8cpp_source.html#l00540">item_tname.cpp:540</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02item__tname_8cpp_03_html_a2b08c17b274e9f92d8d14bceefdd9932"><div class="ttname"><a href="namespaceanonymous__namespace_02item__tname_8cpp_03.html#a2b08c17b274e9f92d8d14bceefdd9932">anonymous_namespace{item_tname.cpp}::vars</a></div><div class="ttdeci">std::string vars(item const &amp;it, unsigned int, segment_bitset const &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="item__tname_8cpp_source.html#l00424">item_tname.cpp:424</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02overmap__connection_8cpp_03_html_aa78e792a2288b7cc1abfcc97b0902b89"><div class="ttname"><a href="namespaceanonymous__namespace_02overmap__connection_8cpp_03.html#aa78e792a2288b7cc1abfcc97b0902b89">anonymous_namespace{overmap_connection.cpp}::connections</a></div><div class="ttdeci">generic_factory&lt; overmap_connection &gt; connections(&quot;overmap connection&quot;)</div></div>
<div class="ttc" id="anamespacebase__camps_html_a04fa69b1c0952a34dc4a7d26b3f9f786"><div class="ttname"><a href="namespacebase__camps.html#a04fa69b1c0952a34dc4a7d26b3f9f786">base_camps::id</a></div><div class="ttdeci">const std::string id</div><div class="ttdef"><b>Definition:</b> <a href="basecamp_8h_source.html#l00105">basecamp.h:105</a></div></div>
<div class="ttc" id="anamespacecalendar_html_a2830b54b0424fe452c0933f87d6201b3"><div class="ttname"><a href="namespacecalendar.html#a2830b54b0424fe452c0933f87d6201b3">calendar::turn_zero</a></div><div class="ttdeci">constexpr time_point turn_zero</div><div class="ttdoc">Represents time point 0.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00541">calendar.h:541</a></div></div>
<div class="ttc" id="anamespacecalendar_html_ae15fcbf1c971589eb49c1a657fb6a580"><div class="ttname"><a href="namespacecalendar.html#ae15fcbf1c971589eb49c1a657fb6a580">calendar::turn</a></div><div class="ttdeci">time_point turn</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00038">calendar.cpp:38</a></div></div>
<div class="ttc" id="anamespacecata_1_1hash64__detail_html_a5ca825db6fd06946302c60daa97333e4"><div class="ttname"><a href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">cata::hash64_detail::ret</a></div><div class="ttdeci">T ret</div><div class="ttdef"><b>Definition:</b> <a href="hash__utils_8h_source.html#l00097">hash_utils.h:97</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8">catacurses::base_color</a></div><div class="ttdeci">base_color</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00078">cursesdef.h:78</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8a00c94a3341257be62e4db78730c88356"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a00c94a3341257be62e4db78730c88356">catacurses::white</a></div><div class="ttdeci">@ white</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00086">cursesdef.h:86</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8a230026b5fc50f9f7efefa7dedfa3544d"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a230026b5fc50f9f7efefa7dedfa3544d">catacurses::blue</a></div><div class="ttdeci">@ blue</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00083">cursesdef.h:83</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a26b496339c95a340a6b34734deec5bd1">catacurses::yellow</a></div><div class="ttdeci">@ yellow</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00082">cursesdef.h:82</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8a2b607ba9b2b7edd76f3d0a07e9dca9fc"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2b607ba9b2b7edd76f3d0a07e9dca9fc">catacurses::red</a></div><div class="ttdeci">@ red</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00080">cursesdef.h:80</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8a2f9b8cb89753ef803e048e78c598c15d"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a2f9b8cb89753ef803e048e78c598c15d">catacurses::cyan</a></div><div class="ttdeci">@ cyan</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00085">cursesdef.h:85</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8a82a5d57f7c713aa989d0851a4d0290a7"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8a82a5d57f7c713aa989d0851a4d0290a7">catacurses::magenta</a></div><div class="ttdeci">@ magenta</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00084">cursesdef.h:84</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8aa8987a61b46eae2571fc4ab9bc5d6ed5"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aa8987a61b46eae2571fc4ab9bc5d6ed5">catacurses::black</a></div><div class="ttdeci">@ black</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00079">cursesdef.h:79</a></div></div>
<div class="ttc" id="anamespacecatacurses_html_a2181be54a83455ed99a7b7fab4fb46e8aaf95aa6d65219dcc01457b82df1be8fd"><div class="ttname"><a href="namespacecatacurses.html#a2181be54a83455ed99a7b7fab4fb46e8aaf95aa6d65219dcc01457b82df1be8fd">catacurses::green</a></div><div class="ttdeci">@ green</div><div class="ttdef"><b>Definition:</b> <a href="cursesdef_8h_source.html#l00081">cursesdef.h:81</a></div></div>
<div class="ttc" id="anamespacecoords_html_aefed5186be640da17dc0e723c536715a"><div class="ttname"><a href="namespacecoords.html#aefed5186be640da17dc0e723c536715a">coords::scale</a></div><div class="ttdeci">scale</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00029">coordinates.h:29</a></div></div>
<div class="ttc" id="anamespaceiuse_html_ae81079151986b7a91874751dae6720a5"><div class="ttname"><a href="namespaceiuse.html#ae81079151986b7a91874751dae6720a5">iuse::seed</a></div><div class="ttdeci">std::optional&lt; int &gt; seed(Character *, item *, const tripoint &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="iuse_8cpp_source.html#l05301">iuse.cpp:5301</a></div></div>
<div class="ttc" id="anamespacekeycode_html_a16ca776f0df120afb4f1b16a92e2d7f7a4685304075364415da67c818580343f9"><div class="ttname"><a href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7a4685304075364415da67c818580343f9">keycode::f2</a></div><div class="ttdeci">@ f2</div><div class="ttdef"><b>Definition:</b> <a href="input_8h_source.html#l00082">input.h:82</a></div></div>
<div class="ttc" id="anamespacekeycode_html_a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac"><div class="ttname"><a href="namespacekeycode.html#a16ca776f0df120afb4f1b16a92e2d7f7aa6efe66b8fc51ca203d5f0015d983eac">keycode::end</a></div><div class="ttdeci">@ end</div><div class="ttdef"><b>Definition:</b> <a href="input_8h_source.html#l00095">input.h:95</a></div></div>
<div class="ttc" id="anamespacemath__opers_html_a23fff2e10d1c6eec78481f24fb5d9de3"><div class="ttname"><a href="namespacemath__opers.html#a23fff2e10d1c6eec78481f24fb5d9de3">math_opers::div</a></div><div class="ttdeci">constexpr double div(double l, double r)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__impl_8h_source.html#l00223">math_parser_impl.h:223</a></div></div>
<div class="ttc" id="anamespacemath__opers_html_a2f0118617735cc810b9d76d62bd182f6"><div class="ttname"><a href="namespacemath__opers.html#a2f0118617735cc810b9d76d62bd182f6">math_opers::pos</a></div><div class="ttdeci">constexpr double pos(double, double r)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__impl_8h_source.html#l00203">math_parser_impl.h:203</a></div></div>
<div class="ttc" id="anamespaceom__direction_html_a3f3a3bf2c5af33fc8036734d1ba70b7c"><div class="ttname"><a href="namespaceom__direction.html#a3f3a3bf2c5af33fc8036734d1ba70b7c">om_direction::type</a></div><div class="ttdeci">type</div><div class="ttdoc">Basic enum for directions.</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00054">omdata.h:54</a></div></div>
<div class="ttc" id="anamespaceom__direction_html_a8ba958ccfad28c0a5572a04dd1428f32"><div class="ttname"><a href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">om_direction::name</a></div><div class="ttdeci">std::string name(type dir)</div><div class="ttdoc">Get Human readable name of a direction.</div><div class="ttdef"><b>Definition:</b> <a href="overmap_8cpp_source.html#l06412">overmap.cpp:6412</a></div></div>
<div class="ttc" id="anamespaceom__direction_html_af97f9dbddaa758278662da3478826c61"><div class="ttname"><a href="namespaceom__direction.html#af97f9dbddaa758278662da3478826c61">om_direction::size</a></div><div class="ttdeci">const size_t size</div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00066">omdata.h:66</a></div></div>
<div class="ttc" id="anamespaceovermap__terrains_html_adeb350d773c86be9ebdc18a60b9eca30"><div class="ttname"><a href="namespaceovermap__terrains.html#adeb350d773c86be9ebdc18a60b9eca30">overmap_terrains::get_all</a></div><div class="ttdeci">const std::vector&lt; oter_t &gt; &amp; get_all()</div><div class="ttdef"><b>Definition:</b> <a href="overmap_8cpp_source.html#l01072">overmap.cpp:1072</a></div></div>
<div class="ttc" id="anamespaceovermap__ui_html_a4aeb45df4fdc5bb21b1935abb8280fd7"><div class="ttname"><a href="namespaceovermap__ui.html#a4aeb45df4fdc5bb21b1935abb8280fd7">overmap_ui::draw</a></div><div class="ttdeci">static void draw(ui_adaptor &amp;ui, const tripoint_abs_omt &amp;center, const tripoint_abs_omt &amp;orig, bool blink, bool show_explored, bool fast_scroll, input_context *inp_ctxt, const draw_data_t &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="overmap__ui_8cpp_source.html#l01253">overmap_ui.cpp:1253</a></div></div>
<div class="ttc" id="anamespacesounds_html_a658252f566c644d810dab49c5a6e2d7d"><div class="ttname"><a href="namespacesounds.html#a658252f566c644d810dab49c5a6e2d7d">sounds::get_footstep_markers</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; get_footstep_markers()</div><div class="ttdef"><b>Definition:</b> <a href="sounds_8cpp_source.html#l00797">sounds.cpp:797</a></div></div>
<div class="ttc" id="anamespacetarget__handler_html_aea843144f5e69546ddea88eeda177640"><div class="ttname"><a href="namespacetarget__handler.html#aea843144f5e69546ddea88eeda177640">target_handler::trajectory</a></div><div class="ttdeci">std::vector&lt; tripoint &gt; trajectory</div><div class="ttdef"><b>Definition:</b> <a href="ranged_8h_source.html#l00029">ranged.h:29</a></div></div>
<div class="ttc" id="anamespacetname_html"><div class="ttname"><a href="namespacetname.html">tname</a></div><div class="ttdef"><b>Definition:</b> <a href="item__tname_8cpp_source.html#l00612">item_tname.cpp:613</a></div></div>
<div class="ttc" id="anamespaceunits_html_a7ad0e3aed5fcfc224568a0520be0efa5"><div class="ttname"><a href="namespaceunits.html#a7ad0e3aed5fcfc224568a0520be0efa5">units::to_kelvin</a></div><div class="ttdeci">constexpr value_type to_kelvin(const quantity&lt; value_type, temperature_in_kelvin_tag &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00411">units.h:411</a></div></div>
<div class="ttc" id="anamespaceunits_html_a9a5827312b56a57d423cb19197bcc358"><div class="ttname"><a href="namespaceunits.html#a9a5827312b56a57d423cb19197bcc358">units::to_celsius</a></div><div class="ttdeci">constexpr value_type to_celsius(const quantity&lt; value_type, temperature_in_kelvin_tag &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00433">units.h:433</a></div></div>
<div class="ttc" id="anamespaceunits_html_ae31e6d9c71949a72ee41be4be6f1afcd"><div class="ttname"><a href="namespaceunits.html#ae31e6d9c71949a72ee41be4be6f1afcd">units::to_fahrenheit</a></div><div class="ttdeci">constexpr value_type to_fahrenheit(const quantity&lt; value_type, temperature_in_kelvin_tag &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="units_8h_source.html#l00440">units.h:440</a></div></div>
<div class="ttc" id="anamespacevehicles_1_1parts_html_a1760b563889a67b60d887f2cd6331846"><div class="ttname"><a href="namespacevehicles_1_1parts.html#a1760b563889a67b60d887f2cd6331846">vehicles::parts::get_all</a></div><div class="ttdeci">const std::vector&lt; vpart_info &gt; &amp; get_all()</div><div class="ttdef"><b>Definition:</b> <a href="veh__type_8cpp_source.html#l00960">veh_type.cpp:960</a></div></div>
<div class="ttc" id="anamespacevehicles_html_a78c8b078f6e38a1e9cc70d759c8d914a"><div class="ttname"><a href="namespacevehicles.html#a78c8b078f6e38a1e9cc70d759c8d914a">vehicles::variant_separator</a></div><div class="ttdeci">constexpr char variant_separator</div><div class="ttdef"><b>Definition:</b> <a href="veh__type_8h_source.html#l00038">veh_type.h:38</a></div></div>
<div class="ttc" id="anewcharacter_8cpp_html_a1d22ab3ab1f5b7b3d7b9491dcd8787b4"><div class="ttname"><a href="newcharacter_8cpp.html#a1d22ab3ab1f5b7b3d7b9491dcd8787b4">male</a></div><div class="ttdeci">bool male</div><div class="ttdef"><b>Definition:</b> <a href="newcharacter_8cpp_source.html#l02053">newcharacter.cpp:2053</a></div></div>
<div class="ttc" id="anpc_8h_html"><div class="ttname"><a href="npc_8h.html">npc.h</a></div></div>
<div class="ttc" id="aoptions_8cpp_html_aec4a86b552158c4900ef652a0bdf1fc4"><div class="ttname"><a href="options_8cpp.html#aec4a86b552158c4900ef652a0bdf1fc4">TILESETS</a></div><div class="ttdeci">std::map&lt; std::string, cata_path &gt; TILESETS</div><div class="ttdoc">A mapping(string:string) that stores all tileset values.</div><div class="ttdef"><b>Definition:</b> <a href="options_8cpp_source.html#l00055">options.cpp:55</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a5413fa90edaa8d61a8bb3aaa1329e6e4"><div class="ttname"><a href="output_8cpp.html#a5413fa90edaa8d61a8bb3aaa1329e6e4">string_replace</a></div><div class="ttdeci">std::string string_replace(std::string text, const std::string &amp;before, const std::string &amp;after)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00978">output.cpp:978</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a55e27b39c3ab424e4f2b35a2855897ef"><div class="ttname"><a href="output_8cpp.html#a55e27b39c3ab424e4f2b35a2855897ef">remove_punctuations</a></div><div class="ttdeci">std::string remove_punctuations(const std::string_view s)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l01378">output.cpp:1378</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a78f0928723504ed91d542c9090cd244d"><div class="ttname"><a href="output_8cpp.html#a78f0928723504ed91d542c9090cd244d">to_upper_case</a></div><div class="ttdeci">std::string to_upper_case(const std::string &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l01389">output.cpp:1389</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_a852bcaf15ef9b08c80dfa899078baa3d"><div class="ttname"><a href="output_8cpp.html#a852bcaf15ef9b08c80dfa899078baa3d">POSX</a></div><div class="ttdeci">int POSX</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00051">output.cpp:51</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_ab911c8aec787739bcd40d1d3d620ad44"><div class="ttname"><a href="output_8cpp.html#ab911c8aec787739bcd40d1d3d620ad44">POSY</a></div><div class="ttdeci">int POSY</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00052">output.cpp:52</a></div></div>
<div class="ttc" id="aoutput_8cpp_html_ac8f1d6275ee49732d8988e5e671b1776"><div class="ttname"><a href="output_8cpp.html#ac8f1d6275ee49732d8988e5e671b1776">SCT</a></div><div class="ttdeci">scrollingcombattext SCT</div><div class="ttdef"><b>Definition:</b> <a href="output_8cpp_source.html#l00067">output.cpp:67</a></div></div>
<div class="ttc" id="aoutput_8h_html"><div class="ttname"><a href="output_8h.html">output.h</a></div></div>
<div class="ttc" id="aoutput_8h_html_a0803e4570f3cd69d38952bc2b4555c24"><div class="ttname"><a href="output_8h.html#a0803e4570f3cd69d38952bc2b4555c24">LINE_XOXX</a></div><div class="ttdeci">#define LINE_XOXX</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00054">output.h:54</a></div></div>
<div class="ttc" id="aoutput_8h_html_a2b180123cdd4352de9a2ebcbaabc8627"><div class="ttname"><a href="output_8h.html#a2b180123cdd4352de9a2ebcbaabc8627">LINE_OXOX_C</a></div><div class="ttdeci">#define LINE_OXOX_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00059">output.h:59</a></div></div>
<div class="ttc" id="aoutput_8h_html_a2d78fca682aa56b3aae26b0c763b18d5"><div class="ttname"><a href="output_8h.html#a2d78fca682aa56b3aae26b0c763b18d5">LINE_OOXX_UNICODE</a></div><div class="ttdeci">#define LINE_OOXX_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00086">output.h:86</a></div></div>
<div class="ttc" id="aoutput_8h_html_a331aebdd7d682000108b345699a052e5"><div class="ttname"><a href="output_8h.html#a331aebdd7d682000108b345699a052e5">LINE_OXOX_UNICODE</a></div><div class="ttdeci">#define LINE_OXOX_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00083">output.h:83</a></div></div>
<div class="ttc" id="aoutput_8h_html_a33ab4e0193402fed8f74590a30fadc3c"><div class="ttname"><a href="output_8h.html#a33ab4e0193402fed8f74590a30fadc3c">LINE_XOXO</a></div><div class="ttdeci">#define LINE_XOXO</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00046">output.h:46</a></div></div>
<div class="ttc" id="aoutput_8h_html_a33b56b57f3e8b7d2fa0beaff9cd0900d"><div class="ttname"><a href="output_8h.html#a33b56b57f3e8b7d2fa0beaff9cd0900d">LINE_XXOO_C</a></div><div class="ttdeci">#define LINE_XXOO_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00060">output.h:60</a></div></div>
<div class="ttc" id="aoutput_8h_html_a430b2ba81cbe0935f0438d49b02ebb92"><div class="ttname"><a href="output_8h.html#a430b2ba81cbe0935f0438d49b02ebb92">LINE_XXXX_C</a></div><div class="ttdeci">#define LINE_XXXX_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00068">output.h:68</a></div></div>
<div class="ttc" id="aoutput_8h_html_a435355aeca1be3844e79fc4db8e691e1"><div class="ttname"><a href="output_8h.html#a435355aeca1be3844e79fc4db8e691e1">LINE_OXOX</a></div><div class="ttdeci">#define LINE_OXOX</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00047">output.h:47</a></div></div>
<div class="ttc" id="aoutput_8h_html_a4660d5c291e71922051edf0f2f3142e8"><div class="ttname"><a href="output_8h.html#a4660d5c291e71922051edf0f2f3142e8">LINE_OXXX_UNICODE</a></div><div class="ttdeci">#define LINE_OXXX_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00091">output.h:91</a></div></div>
<div class="ttc" id="aoutput_8h_html_a479e8a9ad84c68ed5f8609d4b536a8bb"><div class="ttname"><a href="output_8h.html#a479e8a9ad84c68ed5f8609d4b536a8bb">LINE_OOXX</a></div><div class="ttdeci">#define LINE_OOXX</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00050">output.h:50</a></div></div>
<div class="ttc" id="aoutput_8h_html_a4a3bfadbe7ec0abb14ff53e5e2f8983e"><div class="ttname"><a href="output_8h.html#a4a3bfadbe7ec0abb14ff53e5e2f8983e">LINE_OXXX</a></div><div class="ttdeci">#define LINE_OXXX</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00055">output.h:55</a></div></div>
<div class="ttc" id="aoutput_8h_html_a4b80f0039259ebe61dc2e58ca4b31043"><div class="ttname"><a href="output_8h.html#a4b80f0039259ebe61dc2e58ca4b31043">LINE_XXXO</a></div><div class="ttdeci">#define LINE_XXXO</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00052">output.h:52</a></div></div>
<div class="ttc" id="aoutput_8h_html_a4be67498ee67b5186fcae5cf706f7512"><div class="ttname"><a href="output_8h.html#a4be67498ee67b5186fcae5cf706f7512">enumerate_as_string</a></div><div class="ttdeci">std::string enumerate_as_string(const Container &amp;values, enumeration_conjunction conj=enumeration_conjunction::and_)</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00647">output.h:647</a></div></div>
<div class="ttc" id="aoutput_8h_html_a51f593b330977c09884e69642c69b3e1"><div class="ttname"><a href="output_8h.html#a51f593b330977c09884e69642c69b3e1">LINE_OOXX_C</a></div><div class="ttdeci">#define LINE_OOXX_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00062">output.h:62</a></div></div>
<div class="ttc" id="aoutput_8h_html_a612d0d0728e93276b2b7de1fc57b096b"><div class="ttname"><a href="output_8h.html#a612d0d0728e93276b2b7de1fc57b096b">LINE_XXOX</a></div><div class="ttdeci">#define LINE_XXOX</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00053">output.h:53</a></div></div>
<div class="ttc" id="aoutput_8h_html_a6405dcdb708433c3c3dde836aa8a15cc"><div class="ttname"><a href="output_8h.html#a6405dcdb708433c3c3dde836aa8a15cc">LINE_OXXO</a></div><div class="ttdeci">#define LINE_OXXO</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00049">output.h:49</a></div></div>
<div class="ttc" id="aoutput_8h_html_a663fd8bf8b213ed7a60b559cbab27248"><div class="ttname"><a href="output_8h.html#a663fd8bf8b213ed7a60b559cbab27248">LINE_XXOO_UNICODE</a></div><div class="ttdeci">#define LINE_XXOO_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00084">output.h:84</a></div></div>
<div class="ttc" id="aoutput_8h_html_a7bdca7292f2ca836ba27dcea9eb1493a"><div class="ttname"><a href="output_8h.html#a7bdca7292f2ca836ba27dcea9eb1493a">LINE_OXXO_UNICODE</a></div><div class="ttdeci">#define LINE_OXXO_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00085">output.h:85</a></div></div>
<div class="ttc" id="aoutput_8h_html_a7cfb0ef357d2ae159978cd93d0e4d309"><div class="ttname"><a href="output_8h.html#a7cfb0ef357d2ae159978cd93d0e4d309">LINE_XXOX_UNICODE</a></div><div class="ttdeci">#define LINE_XXOX_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00089">output.h:89</a></div></div>
<div class="ttc" id="aoutput_8h_html_a7ff40ccfb98b8c772404746dad32c2cb"><div class="ttname"><a href="output_8h.html#a7ff40ccfb98b8c772404746dad32c2cb">LINE_OXXX_C</a></div><div class="ttdeci">#define LINE_OXXX_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00067">output.h:67</a></div></div>
<div class="ttc" id="aoutput_8h_html_a802d664db221121367b39cc767bf79dd"><div class="ttname"><a href="output_8h.html#a802d664db221121367b39cc767bf79dd">LINE_XXXO_UNICODE</a></div><div class="ttdeci">#define LINE_XXXO_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00088">output.h:88</a></div></div>
<div class="ttc" id="aoutput_8h_html_a8bc8e69b50626b375b65dde9607c4626"><div class="ttname"><a href="output_8h.html#a8bc8e69b50626b375b65dde9607c4626">LINE_XOXX_UNICODE</a></div><div class="ttdeci">#define LINE_XOXX_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00090">output.h:90</a></div></div>
<div class="ttc" id="aoutput_8h_html_a9366a7c7ae74a665dfa0a7da229c1289"><div class="ttname"><a href="output_8h.html#a9366a7c7ae74a665dfa0a7da229c1289">LINE_OXXO_C</a></div><div class="ttdeci">#define LINE_OXXO_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00061">output.h:61</a></div></div>
<div class="ttc" id="aoutput_8h_html_a99267201d227c306e523ec39c05825cd"><div class="ttname"><a href="output_8h.html#a99267201d227c306e523ec39c05825cd">LINE_XXXX_UNICODE</a></div><div class="ttdeci">#define LINE_XXXX_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00092">output.h:92</a></div></div>
<div class="ttc" id="aoutput_8h_html_ab476e6f9cbd2eabac88865e08a1fe729"><div class="ttname"><a href="output_8h.html#ab476e6f9cbd2eabac88865e08a1fe729">LINE_XOXX_C</a></div><div class="ttdeci">#define LINE_XOXX_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00066">output.h:66</a></div></div>
<div class="ttc" id="aoutput_8h_html_ac280967a17125ee5ab47b91c7c82904d"><div class="ttname"><a href="output_8h.html#ac280967a17125ee5ab47b91c7c82904d">LINE_XXOX_C</a></div><div class="ttdeci">#define LINE_XXOX_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00065">output.h:65</a></div></div>
<div class="ttc" id="aoutput_8h_html_ac48c8e45a5f70ffc3e529206c2b4d661"><div class="ttname"><a href="output_8h.html#ac48c8e45a5f70ffc3e529206c2b4d661">LINE_XOOX_UNICODE</a></div><div class="ttdeci">#define LINE_XOOX_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00087">output.h:87</a></div></div>
<div class="ttc" id="aoutput_8h_html_ac80e34aa2e1caf07189f2d1c758ae9a0"><div class="ttname"><a href="output_8h.html#ac80e34aa2e1caf07189f2d1c758ae9a0">LINE_XOXO_UNICODE</a></div><div class="ttdeci">#define LINE_XOXO_UNICODE</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00082">output.h:82</a></div></div>
<div class="ttc" id="aoutput_8h_html_acf8f3e28da5a6881a30c33e64484aef2"><div class="ttname"><a href="output_8h.html#acf8f3e28da5a6881a30c33e64484aef2">LINE_XOOX_C</a></div><div class="ttdeci">#define LINE_XOOX_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00063">output.h:63</a></div></div>
<div class="ttc" id="aoutput_8h_html_acff0d12357d8a4690e781eed41b36b98a334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="output_8h.html#acff0d12357d8a4690e781eed41b36b98a334c4a4c42fdb79d7ebc3e73b517e6f8">enumeration_conjunction::none</a></div><div class="ttdeci">@ none</div></div>
<div class="ttc" id="aoutput_8h_html_ad3a54f998264087befce6de30cb787b0"><div class="ttname"><a href="output_8h.html#ad3a54f998264087befce6de30cb787b0">LINE_XOOX</a></div><div class="ttdeci">#define LINE_XOOX</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00051">output.h:51</a></div></div>
<div class="ttc" id="aoutput_8h_html_adecb5eb42e17650557a3b1f7d014cd97"><div class="ttname"><a href="output_8h.html#adecb5eb42e17650557a3b1f7d014cd97">LINE_XOXO_C</a></div><div class="ttdeci">#define LINE_XOXO_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00058">output.h:58</a></div></div>
<div class="ttc" id="aoutput_8h_html_adfed5ce9b05a4a77adff41e37957e203"><div class="ttname"><a href="output_8h.html#adfed5ce9b05a4a77adff41e37957e203">LINE_XXXO_C</a></div><div class="ttdeci">#define LINE_XXXO_C</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00064">output.h:64</a></div></div>
<div class="ttc" id="aoutput_8h_html_af6d239f277e1b763f690b94efa469792"><div class="ttname"><a href="output_8h.html#af6d239f277e1b763f690b94efa469792">LINE_XXOO</a></div><div class="ttdeci">#define LINE_XXOO</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00048">output.h:48</a></div></div>
<div class="ttc" id="aoutput_8h_html_af951bd858b538b7c2a10ae7ffd97b848"><div class="ttname"><a href="output_8h.html#af951bd858b538b7c2a10ae7ffd97b848">LINE_XXXX</a></div><div class="ttdeci">#define LINE_XXXX</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00056">output.h:56</a></div></div>
<div class="ttc" id="aoverlay__ordering_8cpp_html_a8c941dddc98116f69fb7404d30d4c1f0"><div class="ttname"><a href="overlay__ordering_8cpp.html#a8c941dddc98116f69fb7404d30d4c1f0">tileset_mutation_overlay_ordering</a></div><div class="ttdeci">std::map&lt; std::string, int &gt; tileset_mutation_overlay_ordering</div><div class="ttdef"><b>Definition:</b> <a href="overlay__ordering_8cpp_source.html#l00010">overlay_ordering.cpp:10</a></div></div>
<div class="ttc" id="aoverlay__ordering_8cpp_html_ac5db61fe6b396780345c2e3e2fe2cf47"><div class="ttname"><a href="overlay__ordering_8cpp.html#ac5db61fe6b396780345c2e3e2fe2cf47">load_overlay_ordering_into_array</a></div><div class="ttdeci">void load_overlay_ordering_into_array(const JsonObject &amp;jsobj, std::map&lt; std::string, int &gt; &amp;orderarray)</div><div class="ttdef"><b>Definition:</b> <a href="overlay__ordering_8cpp_source.html#l00017">overlay_ordering.cpp:17</a></div></div>
<div class="ttc" id="aoverlay__ordering_8h_html"><div class="ttname"><a href="overlay__ordering_8h.html">overlay_ordering.h</a></div></div>
<div class="ttc" id="apath__info_8h_html"><div class="ttname"><a href="path__info_8h.html">path_info.h</a></div></div>
<div class="ttc" id="apixel__minimap_8h_html"><div class="ttname"><a href="pixel__minimap_8h.html">pixel_minimap.h</a></div></div>
<div class="ttc" id="apixel__minimap_8h_html_a6090ef73d2b1d07d802941f7b1e57421"><div class="ttname"><a href="pixel__minimap_8h.html#a6090ef73d2b1d07d802941f7b1e57421">pixel_minimap_mode</a></div><div class="ttdeci">pixel_minimap_mode</div><div class="ttdef"><b>Definition:</b> <a href="pixel__minimap_8h_source.html#l00019">pixel_minimap.h:19</a></div></div>
<div class="ttc" id="apixel__minimap_8h_html_a6090ef73d2b1d07d802941f7b1e57421a192ba166b3957ab1020e9a72ea1b40ed"><div class="ttname"><a href="pixel__minimap_8h.html#a6090ef73d2b1d07d802941f7b1e57421a192ba166b3957ab1020e9a72ea1b40ed">pixel_minimap_mode::squares</a></div><div class="ttdeci">@ squares</div></div>
<div class="ttc" id="apixel__minimap_8h_html_a6090ef73d2b1d07d802941f7b1e57421ae9c6cfa16d8958cb7752450883950ab8"><div class="ttname"><a href="pixel__minimap_8h.html#a6090ef73d2b1d07d802941f7b1e57421ae9c6cfa16d8958cb7752450883950ab8">pixel_minimap_mode::dots</a></div><div class="ttdeci">@ dots</div></div>
<div class="ttc" id="apixel__minimap_8h_html_a6090ef73d2b1d07d802941f7b1e57421aec03f91ae56e478455e3786e91559194"><div class="ttname"><a href="pixel__minimap_8h.html#a6090ef73d2b1d07d802941f7b1e57421aec03f91ae56e478455e3786e91559194">pixel_minimap_mode::solid</a></div><div class="ttdeci">@ solid</div></div>
<div class="ttc" id="apixel__minimap_8h_html_acbb44fdb9957650adb277e797d84de26ad06aefbb6165aa7fd908b9e942b2e18b"><div class="ttname"><a href="pixel__minimap_8h.html#acbb44fdb9957650adb277e797d84de26ad06aefbb6165aa7fd908b9e942b2e18b">pixel_minimap_type::ortho</a></div><div class="ttdeci">@ ortho</div></div>
<div class="ttc" id="apixel__minimap_8h_html_acbb44fdb9957650adb277e797d84de26ae906ec779ab4ac6cbfdf30db5cbb3f1c"><div class="ttname"><a href="pixel__minimap_8h.html#acbb44fdb9957650adb277e797d84de26ae906ec779ab4ac6cbfdf30db5cbb3f1c">pixel_minimap_type::iso</a></div><div class="ttdeci">@ iso</div></div>
<div class="ttc" id="apoint_8h_html_a0acd5e182489265fadc8c586f5d4d701"><div class="ttname"><a href="point_8h.html#a0acd5e182489265fadc8c586f5d4d701">point_west</a></div><div class="ttdeci">constexpr point point_west</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00259">point.h:259</a></div></div>
<div class="ttc" id="apoint_8h_html_a0ee2195dcb488ae55fbf4316f5011172"><div class="ttname"><a href="point_8h.html#a0ee2195dcb488ae55fbf4316f5011172">point_zero</a></div><div class="ttdeci">constexpr point point_zero</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00251">point.h:251</a></div></div>
<div class="ttc" id="apoint_8h_html_a1c7e010679751133312202e360667f24"><div class="ttname"><a href="point_8h.html#a1c7e010679751133312202e360667f24">neighborhood</a></div><div class="ttdeci">constexpr std::array&lt; point, 4 &gt; neighborhood</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00337">point.h:337</a></div></div>
<div class="ttc" id="apoint_8h_html_a4b1a6bcaa42d2c06ecc3afc63305bfdf"><div class="ttname"><a href="point_8h.html#a4b1a6bcaa42d2c06ecc3afc63305bfdf">tripoint_zero</a></div><div class="ttdeci">constexpr tripoint tripoint_zero</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00250">point.h:250</a></div></div>
<div class="ttc" id="apoint_8h_html_a702e673ec0d39d0822e2dc453a6af3e5"><div class="ttname"><a href="point_8h.html#a702e673ec0d39d0822e2dc453a6af3e5">point_south</a></div><div class="ttdeci">constexpr point point_south</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00257">point.h:257</a></div></div>
<div class="ttc" id="apoint_8h_html_aad28d8d682bc8e5628fd2b04df87decd"><div class="ttname"><a href="point_8h.html#aad28d8d682bc8e5628fd2b04df87decd">four_adjacent_offsets</a></div><div class="ttdeci">constexpr std::array&lt; point, 4 &gt; four_adjacent_offsets</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00333">point.h:333</a></div></div>
<div class="ttc" id="apoint_8h_html_acfe3d4a2977589c0adad45cf36774d8a"><div class="ttname"><a href="point_8h.html#acfe3d4a2977589c0adad45cf36774d8a">point_north</a></div><div class="ttdeci">constexpr point point_north</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00253">point.h:253</a></div></div>
<div class="ttc" id="apoint_8h_html_aff73fd5bf470a3db5291c5dec855bb71"><div class="ttname"><a href="point_8h.html#aff73fd5bf470a3db5291c5dec855bb71">point_east</a></div><div class="ttdeci">constexpr point point_east</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00255">point.h:255</a></div></div>
<div class="ttc" id="arect__range_8h_html"><div class="ttname"><a href="rect__range_8h.html">rect_range.h</a></div></div>
<div class="ttc" id="ascent__map_8h_html"><div class="ttname"><a href="scent__map_8h.html">scent_map.h</a></div></div>
<div class="ttc" id="asdl__utils_8h_html"><div class="ttname"><a href="sdl__utils_8h.html">sdl_utils.h</a></div></div>
<div class="ttc" id="asdl__utils_8h_html_a0343ef9415f1d15c92f4d324e0e1802d"><div class="ttname"><a href="sdl__utils_8h.html#a0343ef9415f1d15c92f4d324e0e1802d">color_linear_interpolate</a></div><div class="ttdeci">std::vector&lt; SDL_Color &gt; color_linear_interpolate(const SDL_Color &amp;start_color, const SDL_Color &amp;end_color, unsigned additional_steps)</div><div class="ttdoc">Linearly interpolate intermediate colors between two given colors.</div></div>
<div class="ttc" id="asdl__utils_8h_html_a2409219be466cff794b21b6fbe6154a5"><div class="ttname"><a href="sdl__utils_8h.html#a2409219be466cff794b21b6fbe6154a5">create_surface_32</a></div><div class="ttdeci">SDL_Surface_Ptr create_surface_32(int w, int h)</div></div>
<div class="ttc" id="asdl__utils_8h_html_a53204099dcec8ba4483731c8f2e2a853"><div class="ttname"><a href="sdl__utils_8h.html#a53204099dcec8ba4483731c8f2e2a853">curses_color_to_SDL</a></div><div class="ttdeci">SDL_Color curses_color_to_SDL(const nc_color &amp;color)</div></div>
<div class="ttc" id="asdl__utils_8h_html_ae5e7ac0c9e3047b91b4560fe8bef99dc"><div class="ttname"><a href="sdl__utils_8h.html#ae5e7ac0c9e3047b91b4560fe8bef99dc">color_pixel_function_pointer</a></div><div class="ttdeci">SDL_Color(*)(const SDL_Color &amp;color) color_pixel_function_pointer</div><div class="ttdef"><b>Definition:</b> <a href="sdl__utils_8h_source.html#l00015">sdl_utils.h:15</a></div></div>
<div class="ttc" id="asdl__utils_8h_html_afccebc0a4cff6737d67af7916994a164"><div class="ttname"><a href="sdl__utils_8h.html#afccebc0a4cff6737d67af7916994a164">get_color_pixel_function</a></div><div class="ttdeci">color_pixel_function_pointer get_color_pixel_function(const std::string &amp;name)</div></div>
<div class="ttc" id="asdl__wrappers_8h_html"><div class="ttname"><a href="sdl__wrappers_8h.html">sdl_wrappers.h</a></div></div>
<div class="ttc" id="asdl__wrappers_8h_html_a0f93a5649ece71c19c5c25934f80abb9"><div class="ttname"><a href="sdl__wrappers_8h.html#a0f93a5649ece71c19c5c25934f80abb9">load_image</a></div><div class="ttdeci">SDL_Surface_Ptr load_image(const char *path)</div></div>
<div class="ttc" id="asdl__wrappers_8h_html_a21bc7b3dfd52e91ac19b38154e0a0580"><div class="ttname"><a href="sdl__wrappers_8h.html#a21bc7b3dfd52e91ac19b38154e0a0580">SDL_Surface_Ptr</a></div><div class="ttdeci">std::unique_ptr&lt; SDL_Surface, SDL_Surface_deleter &gt; SDL_Surface_Ptr</div><div class="ttdef"><b>Definition:</b> <a href="sdl__wrappers_8h_source.html#l00060">sdl_wrappers.h:60</a></div></div>
<div class="ttc" id="asdl__wrappers_8h_html_a5d741774a78797db3021028f4f09a021"><div class="ttname"><a href="sdl__wrappers_8h.html#a5d741774a78797db3021028f4f09a021">SetRenderDrawBlendMode</a></div><div class="ttdeci">void SetRenderDrawBlendMode(const SDL_Renderer_Ptr &amp;renderer, SDL_BlendMode blendMode)</div></div>
<div class="ttc" id="asdl__wrappers_8h_html_a66f609a8ce2a0c74718371608a48de52"><div class="ttname"><a href="sdl__wrappers_8h.html#a66f609a8ce2a0c74718371608a48de52">CreateTextureFromSurface</a></div><div class="ttdeci">SDL_Texture_Ptr CreateTextureFromSurface(const SDL_Renderer_Ptr &amp;renderer, const SDL_Surface_Ptr &amp;surface)</div></div>
<div class="ttc" id="asdl__wrappers_8h_html_a7eb7cd1483cf633af1ca578070fd654e"><div class="ttname"><a href="sdl__wrappers_8h.html#a7eb7cd1483cf633af1ca578070fd654e">printErrorIf</a></div><div class="ttdeci">bool printErrorIf(bool condition, const char *message)</div><div class="ttdoc">If the condition is true, an error (including the given message and the output of SDL_GetError) is lo...</div></div>
<div class="ttc" id="asdl__wrappers_8h_html_a8246e5114ebf3165ebf5549a4010b420"><div class="ttname"><a href="sdl__wrappers_8h.html#a8246e5114ebf3165ebf5549a4010b420">SDL_Renderer_Ptr</a></div><div class="ttdeci">std::unique_ptr&lt; SDL_Renderer, SDL_Renderer_deleter &gt; SDL_Renderer_Ptr</div><div class="ttdef"><b>Definition:</b> <a href="sdl__wrappers_8h_source.html#l00032">sdl_wrappers.h:32</a></div></div>
<div class="ttc" id="asdl__wrappers_8h_html_a96ef366875d5a5af3f5ade783ef6cd43"><div class="ttname"><a href="sdl__wrappers_8h.html#a96ef366875d5a5af3f5ade783ef6cd43">throwErrorIf</a></div><div class="ttdeci">void throwErrorIf(bool condition, const char *message)</div><div class="ttdoc">If the condition is true, an exception (including the given message and the output of SDL_GetError) i...</div></div>
<div class="ttc" id="asdl__wrappers_8h_html_aa1a4879dac5ea6742dcabf3b5e1b6e01"><div class="ttname"><a href="sdl__wrappers_8h.html#aa1a4879dac5ea6742dcabf3b5e1b6e01">RenderClear</a></div><div class="ttdeci">void RenderClear(const SDL_Renderer_Ptr &amp;renderer)</div></div>
<div class="ttc" id="asdltiles_8h_html"><div class="ttname"><a href="sdltiles_8h.html">sdltiles.h</a></div></div>
<div class="ttc" id="asmart__controller__ui_8h_html_a70311dd7f8c88e8727c2a7567aa555caaa7970bb5f1149f16a82922773632ebe3"><div class="ttname"><a href="smart__controller__ui_8h.html#a70311dd7f8c88e8727c2a7567aa555caaa7970bb5f1149f16a82922773632ebe3">length</a></div><div class="ttdeci">@ length</div><div class="ttdef"><b>Definition:</b> <a href="smart__controller__ui_8h_source.html#l00026">smart_controller_ui.h:26</a></div></div>
<div class="ttc" id="asounds_8h_html"><div class="ttname"><a href="sounds_8h.html">sounds.h</a></div></div>
<div class="ttc" id="astring__formatter_8h_html"><div class="ttname"><a href="string__formatter_8h.html">string_formatter.h</a></div></div>
<div class="ttc" id="astring__formatter_8h_html_a8964099387da2f95396c67566bafce3d"><div class="ttname"><a href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a></div><div class="ttdeci">std::string string_format(std::string_view format, Args &amp;&amp;...args)</div><div class="ttdoc">Simple wrapper over string_formatter::parse.</div><div class="ttdef"><b>Definition:</b> <a href="string__formatter_8h_source.html#l00417">string_formatter.h:417</a></div></div>
<div class="ttc" id="astring__id_8h_html"><div class="ttname"><a href="string__id_8h.html">string_id.h</a></div></div>
<div class="ttc" id="astructconnect__group_html"><div class="ttname"><a href="structconnect__group.html">connect_group</a></div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00337">mapdata.h:337</a></div></div>
<div class="ttc" id="astructfield__intensity__level_html_a0b6695c49116d5a491cad180fd229be6"><div class="ttname"><a href="structfield__intensity__level.html#a0b6695c49116d5a491cad180fd229be6">field_intensity_level::color</a></div><div class="ttdeci">nc_color color</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00103">field_type.h:103</a></div></div>
<div class="ttc" id="astructfield__intensity__level_html_a78f4cabdc0e6b7affb3ba30eee64805b"><div class="ttname"><a href="structfield__intensity__level.html#a78f4cabdc0e6b7affb3ba30eee64805b">field_intensity_level::symbol</a></div><div class="ttdeci">uint32_t symbol</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00102">field_type.h:102</a></div></div>
<div class="ttc" id="astructfield__type_html_a31caec5e850586158764f19686d8e0b7"><div class="ttname"><a href="structfield__type.html#a31caec5e850586158764f19686d8e0b7">field_type::count</a></div><div class="ttdeci">static size_t count()</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8cpp_source.html#l00357">field_type.cpp:357</a></div></div>
<div class="ttc" id="astructfield__type_html_a46f1cb85c4bfdac38826b81178295ed5"><div class="ttname"><a href="structfield__type.html#a46f1cb85c4bfdac38826b81178295ed5">field_type::get_intensity_level</a></div><div class="ttdeci">const field_intensity_level &amp; get_intensity_level(int level=0) const</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8cpp_source.html#l00170">field_type.cpp:170</a></div></div>
<div class="ttc" id="astructfield__type_html_a5fb79ce2363759ad2da0f0df6e071b94"><div class="ttname"><a href="structfield__type.html#a5fb79ce2363759ad2da0f0df6e071b94">field_type::display_field</a></div><div class="ttdeci">bool display_field</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00223">field_type.h:223</a></div></div>
<div class="ttc" id="astructfield__type_html_ab9770b873bdb5331c9ef936fd6a9012a"><div class="ttname"><a href="structfield__type.html#ab9770b873bdb5331c9ef936fd6a9012a">field_type::display_items</a></div><div class="ttdeci">bool display_items</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8h_source.html#l00222">field_type.h:222</a></div></div>
<div class="ttc" id="astructformatted__text_html"><div class="ttname"><a href="structformatted__text.html">formatted_text</a></div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00388">cata_tiles.h:388</a></div></div>
<div class="ttc" id="astructformatted__text_html_a1fdaa7547911557f3e8c47b8ec48d3f9"><div class="ttname"><a href="structformatted__text.html#a1fdaa7547911557f3e8c47b8ec48d3f9">formatted_text::formatted_text</a></div><div class="ttdeci">formatted_text(const std::string &amp;text, const int color, const text_alignment alignment)</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00393">cata_tiles.h:393</a></div></div>
<div class="ttc" id="astructfurn__t_html"><div class="ttname"><a href="structfurn__t.html">furn_t</a></div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00641">mapdata.h:641</a></div></div>
<div class="ttc" id="astructfurn__t_html_a3f9d08b89197443b951462b9d45deb56"><div class="ttname"><a href="structfurn__t.html#a3f9d08b89197443b951462b9d45deb56">furn_t::count</a></div><div class="ttdeci">static size_t count()</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l01035">mapdata.cpp:1035</a></div></div>
<div class="ttc" id="astructfurn__t_html_a7ef46ed5fb8a03bb1487754eeb5fb7b7"><div class="ttname"><a href="structfurn__t.html#a7ef46ed5fb8a03bb1487754eeb5fb7b7">furn_t::is_movable</a></div><div class="ttdeci">bool is_movable() const</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l01040">mapdata.cpp:1040</a></div></div>
<div class="ttc" id="astructfurn__t_html_a90af2d486432fed3a9d006bf1d47ab76"><div class="ttname"><a href="structfurn__t.html#a90af2d486432fed3a9d006bf1d47ab76">furn_t::id</a></div><div class="ttdeci">furn_str_id id</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00645">mapdata.h:645</a></div></div>
<div class="ttc" id="astructfurn__t_html_af52ef394c24fe2caeb92defee42bbd21"><div class="ttname"><a href="structfurn__t.html#af52ef394c24fe2caeb92defee42bbd21">furn_t::workbench</a></div><div class="ttdeci">cata::value_ptr&lt; furn_workbench_info &gt; workbench</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00665">mapdata.h:665</a></div></div>
<div class="ttc" id="astructhalf__open__rectangle_html"><div class="ttname"><a href="structhalf__open__rectangle.html">half_open_rectangle&lt; point &gt;</a></div></div>
<div class="ttc" id="astructhalf__open__rectangle_html_a0d6dd0f5d65dd4f9b61d74d9baf6b499"><div class="ttname"><a href="structhalf__open__rectangle.html#a0d6dd0f5d65dd4f9b61d74d9baf6b499">half_open_rectangle::p_max</a></div><div class="ttdeci">Point p_max</div><div class="ttdef"><b>Definition:</b> <a href="cuboid__rectangle_8h_source.html#l00020">cuboid_rectangle.h:20</a></div></div>
<div class="ttc" id="astructhalf__open__rectangle_html_ab08078b04b36fca6f5a08daee6bd9486"><div class="ttname"><a href="structhalf__open__rectangle.html#ab08078b04b36fca6f5a08daee6bd9486">half_open_rectangle::contains</a></div><div class="ttdeci">constexpr bool contains(const Point &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="cuboid__rectangle_8h_source.html#l00033">cuboid_rectangle.h:33</a></div></div>
<div class="ttc" id="astructhalf__open__rectangle_html_af7cec817aa5f9f48c6bb5b7615aff264"><div class="ttname"><a href="structhalf__open__rectangle.html#af7cec817aa5f9f48c6bb5b7615aff264">half_open_rectangle::p_min</a></div><div class="ttdeci">Point p_min</div><div class="ttdef"><b>Definition:</b> <a href="cuboid__rectangle_8h_source.html#l00019">cuboid_rectangle.h:17</a></div></div>
<div class="ttc" id="astructitype__variant__data_html_a14ff35ef22c3665018aaaeef145c81fc"><div class="ttname"><a href="structitype__variant__data.html#a14ff35ef22c3665018aaaeef145c81fc">itype_variant_data::id</a></div><div class="ttdeci">std::string id</div><div class="ttdef"><b>Definition:</b> <a href="itype_8h_source.html#l00668">itype.h:668</a></div></div>
<div class="ttc" id="astructitype_html"><div class="ttname"><a href="structitype.html">itype</a></div><div class="ttdef"><b>Definition:</b> <a href="itype_8h_source.html#l01186">itype.h:1186</a></div></div>
<div class="ttc" id="astructitype_html_a0b38a905202f2f3ec5a5429c3d3724a8"><div class="ttname"><a href="structitype.html#a0b38a905202f2f3ec5a5429c3d3724a8">itype::get_item_type_string</a></div><div class="ttdeci">std::string get_item_type_string() const</div><div class="ttdef"><b>Definition:</b> <a href="itype_8cpp_source.html#l00075">itype.cpp:75</a></div></div>
<div class="ttc" id="astructitype_html_a4e982ae6c205d1a157d2df129373eca3"><div class="ttname"><a href="structitype.html#a4e982ae6c205d1a157d2df129373eca3">itype::looks_like</a></div><div class="ttdeci">itype_id looks_like</div><div class="ttdef"><b>Definition:</b> <a href="itype_8h_source.html#l01259">itype.h:1259</a></div></div>
<div class="ttc" id="astructlevel__cache_html"><div class="ttname"><a href="structlevel__cache.html">level_cache</a></div><div class="ttdef"><b>Definition:</b> <a href="level__cache_8h_source.html#l00019">level_cache.h:19</a></div></div>
<div class="ttc" id="astructlevel__cache_html_a3a9ecaf0d5c4181ac518af293bfb6050"><div class="ttname"><a href="structlevel__cache.html#a3a9ecaf0d5c4181ac518af293bfb6050">level_cache::visibility_cache</a></div><div class="ttdeci">cata::mdarray&lt; lit_level, point_bub_ms &gt; visibility_cache</div><div class="ttdef"><b>Definition:</b> <a href="level__cache_8h_source.html#l00075">level_cache.h:75</a></div></div>
<div class="ttc" id="astructmap__data__common__t_html_a630778707744fb147436b9aa0c370a7e"><div class="ttname"><a href="structmap__data__common__t.html#a630778707744fb147436b9aa0c370a7e">map_data_common_t::has_flag</a></div><div class="ttdeci">bool has_flag(const std::string &amp;flag) const</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00534">mapdata.h:534</a></div></div>
<div class="ttc" id="astructmap__data__common__t_html_a6e0ca587a62b2ec09c314fd8ea40ea09"><div class="ttname"><a href="structmap__data__common__t.html#a6e0ca587a62b2ec09c314fd8ea40ea09">map_data_common_t::rotate_to_groups</a></div><div class="ttdeci">std::bitset&lt; NUM_TERCONN &gt; rotate_to_groups</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00553">mapdata.h:553</a></div></div>
<div class="ttc" id="astructmap__data__common__t_html_aa6eb23c1a5d8e89d877880f9aaf32eb6"><div class="ttname"><a href="structmap__data__common__t.html#aa6eb23c1a5d8e89d877880f9aaf32eb6">map_data_common_t::movecost</a></div><div class="ttdeci">int movecost</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00501">mapdata.h:501</a></div></div>
<div class="ttc" id="astructmap__data__common__t_html_aa7c0e4d48398517e30f167b5f2582664"><div class="ttname"><a href="structmap__data__common__t.html#aa7c0e4d48398517e30f167b5f2582664">map_data_common_t::color</a></div><div class="ttdeci">nc_color color() const</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00636">mapdata.cpp:636</a></div></div>
<div class="ttc" id="astructmap__data__common__t_html_adebdc5c7e1aefaa0348f7905a338e430"><div class="ttname"><a href="structmap__data__common__t.html#adebdc5c7e1aefaa0348f7905a338e430">map_data_common_t::connect_to_groups</a></div><div class="ttdeci">std::bitset&lt; NUM_TERCONN &gt; connect_to_groups</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00551">mapdata.h:551</a></div></div>
<div class="ttc" id="astructmap__data__common__t_html_ae397fb9418c5b559c641061245bc8c18"><div class="ttname"><a href="structmap__data__common__t.html#ae397fb9418c5b559c641061245bc8c18">map_data_common_t::symbol</a></div><div class="ttdeci">int symbol() const</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00631">mapdata.cpp:631</a></div></div>
<div class="ttc" id="astructmm__submap_html_a05cadd6f8ed333dd6664feb0499b076d"><div class="ttname"><a href="structmm__submap.html#a05cadd6f8ed333dd6664feb0499b076d">mm_submap::default_tile</a></div><div class="ttdeci">static const memorized_tile default_tile</div><div class="ttdef"><b>Definition:</b> <a href="map__memory_8h_source.html#l00056">map_memory.h:56</a></div></div>
<div class="ttc" id="astructmtype_html"><div class="ttname"><a href="structmtype.html">mtype</a></div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00284">mtype.h:284</a></div></div>
<div class="ttc" id="astructmtype_html_a38400904b6ae1207054cca44318d0426"><div class="ttname"><a href="structmtype.html#a38400904b6ae1207054cca44318d0426">mtype::sym</a></div><div class="ttdeci">std::string sym</div><div class="ttdoc">UTF-8 encoded symbol, should be exactly one cell wide.</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00352">mtype.h:352</a></div></div>
<div class="ttc" id="astructmtype_html_a60dea81cdc4c627313e540831d311b5a"><div class="ttname"><a href="structmtype.html#a60dea81cdc4c627313e540831d311b5a">mtype::id</a></div><div class="ttdeci">mtype_id id</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00301">mtype.h:301</a></div></div>
<div class="ttc" id="astructmtype_html_a6ad4c76593c4cd6423492169733885a1"><div class="ttname"><a href="structmtype.html#a6ad4c76593c4cd6423492169733885a1">mtype::color</a></div><div class="ttdeci">nc_color color</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00480">mtype.h:480</a></div></div>
<div class="ttc" id="astructmtype_html_ad2d6c0780216ad8a2999bc4e7ec7822c"><div class="ttname"><a href="structmtype.html#ad2d6c0780216ad8a2999bc4e7ec7822c">mtype::species</a></div><div class="ttdeci">std::set&lt; species_id &gt; species</div><div class="ttdef"><b>Definition:</b> <a href="mtype_8h_source.html#l00362">mtype.h:362</a></div></div>
<div class="ttc" id="astructmutation__branch_1_1OverrideLook_html"><div class="ttname"><a href="structmutation__branch_1_1OverrideLook.html">mutation_branch::OverrideLook</a></div><div class="ttdef"><b>Definition:</b> <a href="mutation_8h_source.html#l00289">mutation.h:289</a></div></div>
<div class="ttc" id="astructmutation__branch_1_1OverrideLook_html_a2d3425405dead48aaebf4f395581973f"><div class="ttname"><a href="structmutation__branch_1_1OverrideLook.html#a2d3425405dead48aaebf4f395581973f">mutation_branch::OverrideLook::tile_category</a></div><div class="ttdeci">std::string tile_category</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8h_source.html#l00291">mutation.h:291</a></div></div>
<div class="ttc" id="astructmutation__branch_1_1OverrideLook_html_aadb2402aaa8182c86c7cf81e6866cd92"><div class="ttname"><a href="structmutation__branch_1_1OverrideLook.html#aadb2402aaa8182c86c7cf81e6866cd92">mutation_branch::OverrideLook::id</a></div><div class="ttdeci">std::string id</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8h_source.html#l00290">mutation.h:290</a></div></div>
<div class="ttc" id="astructmutation__branch_html"><div class="ttname"><a href="structmutation__branch.html">mutation_branch</a></div><div class="ttdef"><b>Definition:</b> <a href="mutation_8h_source.html#l00172">mutation.h:172</a></div></div>
<div class="ttc" id="astructmutation__branch_html_aabc7c17a2d6f5182a5fd68d91e6219b8"><div class="ttname"><a href="structmutation__branch.html#aabc7c17a2d6f5182a5fd68d91e6219b8">mutation_branch::override_look</a></div><div class="ttdeci">std::optional&lt; OverrideLook &gt; override_look</div><div class="ttdoc">ID, tile category, and variant This will make the player appear as another entity (such as a non-huma...</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8h_source.html#l00298">mutation.h:298</a></div></div>
<div class="ttc" id="astructoter__t_html"><div class="ttname"><a href="structoter__t.html">oter_t</a></div><div class="ttdef"><b>Definition:</b> <a href="omdata_8h_source.html#l00310">omdata.h:310</a></div></div>
<div class="ttc" id="astructpixel__minimap__settings_html"><div class="ttname"><a href="structpixel__minimap__settings.html">pixel_minimap_settings</a></div><div class="ttdef"><b>Definition:</b> <a href="pixel__minimap_8h_source.html#l00025">pixel_minimap.h:25</a></div></div>
<div class="ttc" id="astructpixel__minimap__settings_html_a2bd026d1f7fd6efc2db379facccaa394"><div class="ttname"><a href="structpixel__minimap__settings.html#a2bd026d1f7fd6efc2db379facccaa394">pixel_minimap_settings::brightness</a></div><div class="ttdeci">int brightness</div><div class="ttdef"><b>Definition:</b> <a href="pixel__minimap_8h_source.html#l00027">pixel_minimap.h:27</a></div></div>
<div class="ttc" id="astructpixel__minimap__settings_html_a31399b2fbe2382d74e974fb00ec934b3"><div class="ttname"><a href="structpixel__minimap__settings.html#a31399b2fbe2382d74e974fb00ec934b3">pixel_minimap_settings::square_pixels</a></div><div class="ttdeci">bool square_pixels</div><div class="ttdef"><b>Definition:</b> <a href="pixel__minimap_8h_source.html#l00030">pixel_minimap.h:30</a></div></div>
<div class="ttc" id="astructpixel__minimap__settings_html_a472f00bcc7b59d32b42331c17db6329b"><div class="ttname"><a href="structpixel__minimap__settings.html#a472f00bcc7b59d32b42331c17db6329b">pixel_minimap_settings::mode</a></div><div class="ttdeci">pixel_minimap_mode mode</div><div class="ttdef"><b>Definition:</b> <a href="pixel__minimap_8h_source.html#l00026">pixel_minimap.h:26</a></div></div>
<div class="ttc" id="astructpixel__minimap__settings_html_a97fbfd571c802c8828693390e3305b18"><div class="ttname"><a href="structpixel__minimap__settings.html#a97fbfd571c802c8828693390e3305b18">pixel_minimap_settings::beacon_blink_interval</a></div><div class="ttdeci">int beacon_blink_interval</div><div class="ttdef"><b>Definition:</b> <a href="pixel__minimap_8h_source.html#l00029">pixel_minimap.h:29</a></div></div>
<div class="ttc" id="astructpixel__minimap__settings_html_ad4bb822f7824630cd19dd92c95c559be"><div class="ttname"><a href="structpixel__minimap__settings.html#ad4bb822f7824630cd19dd92c95c559be">pixel_minimap_settings::beacon_size</a></div><div class="ttdeci">int beacon_size</div><div class="ttdef"><b>Definition:</b> <a href="pixel__minimap_8h_source.html#l00028">pixel_minimap.h:28</a></div></div>
<div class="ttc" id="astructpixel__minimap__settings_html_af820244d601ab274db059fbf365af3d9"><div class="ttname"><a href="structpixel__minimap__settings.html#af820244d601ab274db059fbf365af3d9">pixel_minimap_settings::scale_to_fit</a></div><div class="ttdeci">bool scale_to_fit</div><div class="ttdef"><b>Definition:</b> <a href="pixel__minimap_8h_source.html#l00031">pixel_minimap.h:31</a></div></div>
<div class="ttc" id="astructpoint_html"><div class="ttname"><a href="structpoint.html">point</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00020">point.h:20</a></div></div>
<div class="ttc" id="astructpoint_html_a9a82ca9504acabb1e30569f89c805471"><div class="ttname"><a href="structpoint.html#a9a82ca9504acabb1e30569f89c805471">point::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00024">point.h:24</a></div></div>
<div class="ttc" id="astructpoint_html_ad679b07fb69d55f5ad454d0f1f2891d5"><div class="ttname"><a href="structpoint.html#ad679b07fb69d55f5ad454d0f1f2891d5">point::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00023">point.h:23</a></div></div>
<div class="ttc" id="astructter__t_html"><div class="ttname"><a href="structter__t.html">ter_t</a></div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00598">mapdata.h:598</a></div></div>
<div class="ttc" id="astructter__t_html_a353932a6b434023d88b9a6625b356cdb"><div class="ttname"><a href="structter__t.html#a353932a6b434023d88b9a6625b356cdb">ter_t::count</a></div><div class="ttdeci">static size_t count()</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00775">mapdata.cpp:775</a></div></div>
<div class="ttc" id="astructter__t_html_a876ecdb9de153e3d864ee221ed63bd45"><div class="ttname"><a href="structter__t.html#a876ecdb9de153e3d864ee221ed63bd45">ter_t::id</a></div><div class="ttdeci">ter_str_id id</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00602">mapdata.h:602</a></div></div>
<div class="ttc" id="astructtile__render__info_1_1common_html"><div class="ttname"><a href="structtile__render__info_1_1common.html">tile_render_info::common</a></div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00284">map.h:284</a></div></div>
<div class="ttc" id="astructtile__render__info_1_1sprite_html"><div class="ttname"><a href="structtile__render__info_1_1sprite.html">tile_render_info::sprite</a></div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00300">map.h:300</a></div></div>
<div class="ttc" id="astructtile__render__info_1_1vision__effect_html"><div class="ttname"><a href="structtile__render__info_1_1vision__effect.html">tile_render_info::vision_effect</a></div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00293">map.h:293</a></div></div>
<div class="ttc" id="astructtile__render__info_html"><div class="ttname"><a href="structtile__render__info.html">tile_render_info</a></div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00283">map.h:283</a></div></div>
<div class="ttc" id="astructtile__type_html"><div class="ttname"><a href="structtile__type.html">tile_type</a></div><div class="ttdoc">Structures.</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00039">cata_tiles.h:39</a></div></div>
<div class="ttc" id="astructtile__type_html_a0cbe74ee58be622d2e5399a791ae3efe"><div class="ttname"><a href="structtile__type.html#a0cbe74ee58be622d2e5399a791ae3efe">tile_type::bg</a></div><div class="ttdeci">weighted_int_list&lt; std::vector&lt; int &gt; &gt; bg</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00041">cata_tiles.h:41</a></div></div>
<div class="ttc" id="astructtile__type_html_a2c4d836f396cc106934adc00f922c5f0"><div class="ttname"><a href="structtile__type.html#a2c4d836f396cc106934adc00f922c5f0">tile_type::multitile</a></div><div class="ttdeci">bool multitile</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00042">cata_tiles.h:42</a></div></div>
<div class="ttc" id="astructtile__type_html_a31339fa61963ae8bc47b29ebe2e865c9"><div class="ttname"><a href="structtile__type.html#a31339fa61963ae8bc47b29ebe2e865c9">tile_type::offset_retracted</a></div><div class="ttdeci">point offset_retracted</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00047">cata_tiles.h:47</a></div></div>
<div class="ttc" id="astructtile__type_html_a35bb6574422477b93e5b447fb16d4cfb"><div class="ttname"><a href="structtile__type.html#a35bb6574422477b93e5b447fb16d4cfb">tile_type::fg</a></div><div class="ttdeci">weighted_int_list&lt; std::vector&lt; int &gt; &gt; fg</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00041">cata_tiles.h:41</a></div></div>
<div class="ttc" id="astructtile__type_html_a96b2abd5f9ca94ab686a7e3d08e6adc7"><div class="ttname"><a href="structtile__type.html#a96b2abd5f9ca94ab686a7e3d08e6adc7">tile_type::animated</a></div><div class="ttdeci">bool animated</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00044">cata_tiles.h:44</a></div></div>
<div class="ttc" id="astructtile__type_html_ab75d45791aefe26d2f20f992ec64318a"><div class="ttname"><a href="structtile__type.html#ab75d45791aefe26d2f20f992ec64318a">tile_type::pixelscale</a></div><div class="ttdeci">float pixelscale</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00048">cata_tiles.h:48</a></div></div>
<div class="ttc" id="astructtile__type_html_ac90d8d872e121c75ff8c1261c7bf0dd2"><div class="ttname"><a href="structtile__type.html#ac90d8d872e121c75ff8c1261c7bf0dd2">tile_type::offset</a></div><div class="ttdeci">point offset</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00046">cata_tiles.h:46</a></div></div>
<div class="ttc" id="astructtile__type_html_adeeea68947a7fcd56075c444481722eb"><div class="ttname"><a href="structtile__type.html#adeeea68947a7fcd56075c444481722eb">tile_type::rotates</a></div><div class="ttdeci">bool rotates</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00043">cata_tiles.h:43</a></div></div>
<div class="ttc" id="astructtile__type_html_afda60888f095bae6ba9bbdd657039d2b"><div class="ttname"><a href="structtile__type.html#afda60888f095bae6ba9bbdd657039d2b">tile_type::height_3d</a></div><div class="ttdeci">int height_3d</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00045">cata_tiles.h:45</a></div></div>
<div class="ttc" id="astructtile__type_html_afdce3fa4361373a841391a76cdb8905f"><div class="ttname"><a href="structtile__type.html#afdce3fa4361373a841391a76cdb8905f">tile_type::available_subtiles</a></div><div class="ttdeci">std::vector&lt; std::string &gt; available_subtiles</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00050">cata_tiles.h:50</a></div></div>
<div class="ttc" id="astructtileset_1_1season__tile__value_html"><div class="ttname"><a href="structtileset_1_1season__tile__value.html">tileset::season_tile_value</a></div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00154">cata_tiles.h:154</a></div></div>
<div class="ttc" id="astructtileset_1_1season__tile__value_html_a7a105d4122840a82a4efc024d749553e"><div class="ttname"><a href="structtileset_1_1season__tile__value.html#a7a105d4122840a82a4efc024d749553e">tileset::season_tile_value::default_tile</a></div><div class="ttdeci">tile_type * default_tile</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00155">cata_tiles.h:155</a></div></div>
<div class="ttc" id="astructtileset_1_1season__tile__value_html_ae6d6ac004f8be2fd015dd510c72ae7c2"><div class="ttname"><a href="structtileset_1_1season__tile__value.html#ae6d6ac004f8be2fd015dd510c72ae7c2">tileset::season_tile_value::season_tile</a></div><div class="ttdeci">std::optional&lt; tile_lookup_res &gt; season_tile</div><div class="ttdef"><b>Definition:</b> <a href="cata__tiles_8h_source.html#l00156">cata_tiles.h:156</a></div></div>
<div class="ttc" id="astructtrap_html"><div class="ttname"><a href="structtrap.html">trap</a></div><div class="ttdoc">Some traps aren't actually traps in the usual sense of the word.</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00109">trap.h:109</a></div></div>
<div class="ttc" id="astructtrap_html_a4d4f2d0ba3ca652e09d818843b7f49dd"><div class="ttname"><a href="structtrap.html#a4d4f2d0ba3ca652e09d818843b7f49dd">trap::count</a></div><div class="ttdeci">static size_t count()</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00127">trap.cpp:127</a></div></div>
<div class="ttc" id="astructtrap_html_a6a9ac96c5c81eb31093e049ffeac8b4f"><div class="ttname"><a href="structtrap.html#a6a9ac96c5c81eb31093e049ffeac8b4f">trap::is_null</a></div><div class="ttdeci">bool is_null() const</div><div class="ttdoc">Whether this is the null-traps, aka no trap at all.</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00366">trap.cpp:366</a></div></div>
<div class="ttc" id="astructtrap_html_a92373743ed980b356de173c228c79499"><div class="ttname"><a href="structtrap.html#a92373743ed980b356de173c228c79499">trap::color</a></div><div class="ttdeci">nc_color color</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00117">trap.h:117</a></div></div>
<div class="ttc" id="astructtrap_html_a975d50578595efdc3b93fb32bab0e41b"><div class="ttname"><a href="structtrap.html#a975d50578595efdc3b93fb32bab0e41b">trap::sym</a></div><div class="ttdeci">int sym</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00116">trap.h:116</a></div></div>
<div class="ttc" id="astructtrap_html_ab2767aee5179ad23b3ad0b6b4b2415af"><div class="ttname"><a href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">trap::loadid</a></div><div class="ttdeci">trap_id loadid</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00112">trap.h:112</a></div></div>
<div class="ttc" id="astructtrap_html_abeb5ff27f9f78475035f22aabdcfe834"><div class="ttname"><a href="structtrap.html#abeb5ff27f9f78475035f22aabdcfe834">trap::can_see</a></div><div class="ttdeci">bool can_see(const tripoint &amp;pos, const Character &amp;p) const</div><div class="ttdoc">Can player/npc p see this kind of trap, either by their memory (they known there is the trap) or by t...</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00320">trap.cpp:320</a></div></div>
<div class="ttc" id="astructtripoint_html"><div class="ttname"><a href="structtripoint.html">tripoint</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00129">point.h:129</a></div></div>
<div class="ttc" id="astructtripoint_html_a89f6c0a16e2bfd7ce4f1f1d20404c4d7"><div class="ttname"><a href="structtripoint.html#a89f6c0a16e2bfd7ce4f1f1d20404c4d7">tripoint::y</a></div><div class="ttdeci">int y</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00133">point.h:133</a></div></div>
<div class="ttc" id="astructtripoint_html_ac944c0e329b5eba2602f7a52f66bbbb9"><div class="ttname"><a href="structtripoint.html#ac944c0e329b5eba2602f7a52f66bbbb9">tripoint::z</a></div><div class="ttdeci">int z</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00134">point.h:134</a></div></div>
<div class="ttc" id="astructtripoint_html_accc0725c936dbebb2486f969f39e2e5f"><div class="ttname"><a href="structtripoint.html#accc0725c936dbebb2486f969f39e2e5f">tripoint::xy</a></div><div class="ttdeci">constexpr point xy() const</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00202">point.h:202</a></div></div>
<div class="ttc" id="astructtripoint_html_affdc0d5b75024cbfacd208a495def3dc"><div class="ttname"><a href="structtripoint.html#affdc0d5b75024cbfacd208a495def3dc">tripoint::x</a></div><div class="ttdeci">int x</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00132">point.h:132</a></div></div>
<div class="ttc" id="astructvar_html"><div class="ttname"><a href="structvar.html">var</a></div><div class="ttdef"><b>Definition:</b> <a href="math__parser__impl_8h_source.html#l00109">math_parser_impl.h:109</a></div></div>
<div class="ttc" id="astructvisibility__variables_html"><div class="ttname"><a href="structvisibility__variables.html">visibility_variables</a></div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00122">map.h:122</a></div></div>
<div class="ttc" id="astructvisibility__variables_html_a1c7e65e8b8105ef486b2b9874b674d97"><div class="ttname"><a href="structvisibility__variables.html#a1c7e65e8b8105ef486b2b9874b674d97">visibility_variables::u_is_boomered</a></div><div class="ttdeci">bool u_is_boomered</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00126">map.h:126</a></div></div>
<div class="ttc" id="astructweather__printable_html"><div class="ttname"><a href="structweather__printable.html">weather_printable</a></div><div class="ttdoc">Weather drawing tracking.</div><div class="ttdef"><b>Definition:</b> <a href="weather_8h_source.html#l00098">weather.h:98</a></div></div>
<div class="ttc" id="astructweighted__int__list_html"><div class="ttname"><a href="structweighted__int__list.html">weighted_int_list</a></div><div class="ttdef"><b>Definition:</b> <a href="weighted__list_8h_source.html#l00225">weighted_list.h:225</a></div></div>
<div class="ttc" id="astructweighted__list_html_a05d7ee6620edd859f0f35a7c4f69027f"><div class="ttname"><a href="structweighted__list.html#a05d7ee6620edd859f0f35a7c4f69027f">weighted_list::size</a></div><div class="ttdeci">size_t size() const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="weighted__list_8h_source.html#l00192">weighted_list.h:192</a></div></div>
<div class="ttc" id="astructweighted__list_html_a23a0eb0640d5aacb0fae74940d2864bd"><div class="ttname"><a href="structweighted__list.html#a23a0eb0640d5aacb0fae74940d2864bd">weighted_list::get_weight</a></div><div class="ttdeci">W get_weight() const</div><div class="ttdoc">This will return the sum of all the object's weights in the list.</div><div class="ttdef"><b>Definition:</b> <a href="weighted__list_8h_source.html#l00166">weighted_list.h:166</a></div></div>
<div class="ttc" id="astructweighted__list_html_ac22edb12b0027bf3f6d35e6504aeacb5"><div class="ttname"><a href="structweighted__list.html#ac22edb12b0027bf3f6d35e6504aeacb5">weighted_list::empty</a></div><div class="ttdeci">bool empty() const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="weighted__list_8h_source.html#l00195">weighted_list.h:195</a></div></div>
<div class="ttc" id="astructweighted__list_html_ad960be5e22f6aaa4eb01af592a9476f5"><div class="ttname"><a href="structweighted__list.html#ad960be5e22f6aaa4eb01af592a9476f5">weighted_list::add</a></div><div class="ttdeci">T * add(const T &amp;obj, const W &amp;weight)</div><div class="ttdoc">This will add a new object to the weighted list.</div><div class="ttdef"><b>Definition:</b> <a href="weighted__list_8h_source.html#l00040">weighted_list.h:40</a></div></div>
<div class="ttc" id="astructweighted__object_html"><div class="ttname"><a href="structweighted__object.html">weighted_object</a></div><div class="ttdef"><b>Definition:</b> <a href="weighted__list_8h_source.html#l00014">weighted_list.h:14</a></div></div>
<div class="ttc" id="astructwrapped__vehicle_html"><div class="ttname"><a href="structwrapped__vehicle.html">wrapped_vehicle</a></div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00089">map.h:89</a></div></div>
<div class="ttc" id="asubmap_8h_html"><div class="ttname"><a href="submap_8h.html">submap.h</a></div></div>
<div class="ttc" id="atileray_8h_html"><div class="ttname"><a href="tileray_8h.html">tileray.h</a></div></div>
<div class="ttc" id="atranslation_8cpp_html_a176e288c640c6506a86330cb10fbe13a"><div class="ttname"><a href="translation_8cpp.html#a176e288c640c6506a86330cb10fbe13a">to_translation</a></div><div class="ttdeci">translation to_translation(const std::string &amp;raw)</div><div class="ttdoc">Shorthands for translation::to_translation.</div><div class="ttdef"><b>Definition:</b> <a href="translation_8cpp_source.html#l00420">translation.cpp:420</a></div></div>
<div class="ttc" id="atranslation_8cpp_html_a7afa19f8e1a45d955fc6fbaa420a6760"><div class="ttname"><a href="translation_8cpp.html#a7afa19f8e1a45d955fc6fbaa420a6760">no_translation</a></div><div class="ttdeci">translation no_translation(const std::string &amp;str)</div><div class="ttdoc">Shorthand for translation::no_translation.</div><div class="ttdef"><b>Definition:</b> <a href="translation_8cpp_source.html#l00441">translation.cpp:441</a></div></div>
<div class="ttc" id="atranslations_8h_html"><div class="ttname"><a href="translations_8h.html">translations.h</a></div></div>
<div class="ttc" id="atrap_8cpp_html_a7b8e40eb2b50e3841e2d9f2d0531226a"><div class="ttname"><a href="trap_8cpp.html#a7b8e40eb2b50e3841e2d9f2d0531226a">tr_null</a></div><div class="ttdeci">trap_id tr_null</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00421">trap.cpp:421</a></div></div>
<div class="ttc" id="atrap_8h_html"><div class="ttname"><a href="trap_8h.html">trap.h</a></div></div>
<div class="ttc" id="atype__id_8h_html"><div class="ttname"><a href="type__id_8h.html">type_id.h</a></div></div>
<div class="ttc" id="aunits__utility_8cpp_html_abc1b64df407a608febfde03382d40e2e"><div class="ttname"><a href="units__utility_8cpp.html#abc1b64df407a608febfde03382d40e2e">angle_to_dir4</a></div><div class="ttdeci">int angle_to_dir4(const units::angle direction)</div><div class="ttdef"><b>Definition:</b> <a href="units__utility_8cpp_source.html#l00025">units_utility.cpp:25</a></div></div>
<div class="ttc" id="aunits__utility_8h_html"><div class="ttname"><a href="units__utility_8h.html">units_utility.h</a></div></div>
<div class="ttc" id="aveh__type_8h_html"><div class="ttname"><a href="veh__type_8h.html">veh_type.h</a></div></div>
<div class="ttc" id="avehicle_8h_html"><div class="ttname"><a href="vehicle_8h.html">vehicle.h</a></div></div>
<div class="ttc" id="avehicle__move_8cpp_html_abc9fa7d03f14e2a5323ee0ff66e7938e"><div class="ttname"><a href="vehicle__move_8cpp.html#abc9fa7d03f14e2a5323ee0ff66e7938e">tile_height</a></div><div class="ttdeci">static const float tile_height</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__move_8cpp_source.html#l00079">vehicle_move.cpp:79</a></div></div>
<div class="ttc" id="avpart__position_8h_html"><div class="ttname"><a href="vpart__position_8h.html">vpart_position.h</a></div></div>
<div class="ttc" id="aweather_8h_html"><div class="ttname"><a href="weather_8h.html">weather.h</a></div></div>
<div class="ttc" id="aweather__type_8h_html_a0b78777ab367c0db919aacd8bba938f0a2ac43aa43bf473f9a9c09b4b608619d3"><div class="ttname"><a href="weather__type_8h.html#a0b78777ab367c0db919aacd8bba938f0a2ac43aa43bf473f9a9c09b4b608619d3">precip_class::light</a></div><div class="ttdeci">@ light</div></div>
<div class="ttc" id="aweighted__list_8h_html"><div class="ttname"><a href="weighted__list_8h.html">weighted_list.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 7 2024 08:48:25 for Cataclysm DDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
