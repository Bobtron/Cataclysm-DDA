<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm DDA: mapgen_palette Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm DDA
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classmapgen__palette-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mapgen_palette Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="mapgen_8h_source.html">mapgen.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmapgen__palette_1_1add__palette__context.html">add_palette_context</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aaa8d532929c86b55e56bc1067df5046a"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#aaa8d532929c86b55e56bc1067df5046a">placing_map</a> = std::unordered_map&lt; <a class="el" href="classmap__key.html">map_key</a>, std::vector&lt; <a class="el" href="memory__fast_8h.html#ada897699f31fc8b37c5af09d95d45840">shared_ptr_fast</a>&lt; const <a class="el" href="classjmapgen__piece.html">jmapgen_piece</a> &gt; &gt;&gt;</td></tr>
<tr class="memdesc:aaa8d532929c86b55e56bc1067df5046a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The mapping from character (key) to a list of things that should be placed.  <a href="classmapgen__palette.html#aaa8d532929c86b55e56bc1067df5046a">More...</a><br /></td></tr>
<tr class="separator:aaa8d532929c86b55e56bc1067df5046a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0665610ad46dfa7bd270fda185ddc517"><td class="memTemplParams" colspan="2">template&lt;typename PieceType &gt; </td></tr>
<tr class="memitem:a0665610ad46dfa7bd270fda185ddc517"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a> (const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;jo, const std::string &amp;member_name, <a class="el" href="classmapgen__palette.html#aaa8d532929c86b55e56bc1067df5046a">placing_map</a> &amp;<a class="el" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, const std::string &amp;<a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>)</td></tr>
<tr class="memdesc:a0665610ad46dfa7bd270fda185ddc517"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load (append to format_placings) the places that should be put there.  <a href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">More...</a><br /></td></tr>
<tr class="separator:a0665610ad46dfa7bd270fda185ddc517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab075da8871854552d9d214c190b94a0b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#ab075da8871854552d9d214c190b94a0b">check</a> () const</td></tr>
<tr class="separator:ab075da8871854552d9d214c190b94a0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0804b84fa50cb79440fbd8735080dc7"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structmapgen__parameters.html">mapgen_parameters</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#ab0804b84fa50cb79440fbd8735080dc7">get_parameters</a> () const</td></tr>
<tr class="separator:ab0804b84fa50cb79440fbd8735080dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aa9aa2da916f94d93e04ecb5f6dfc020b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmapgen__palette.html">mapgen_palette</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#aa9aa2da916f94d93e04ecb5f6dfc020b">load_temp</a> (const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;jo, std::string_view src, const std::string &amp;<a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>)</td></tr>
<tr class="memdesc:aa9aa2da916f94d93e04ecb5f6dfc020b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads a palette object and returns it.  <a href="classmapgen__palette.html#aa9aa2da916f94d93e04ecb5f6dfc020b">More...</a><br /></td></tr>
<tr class="separator:aa9aa2da916f94d93e04ecb5f6dfc020b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2950ac41bfcd3bb2019486493f4a928"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#aa2950ac41bfcd3bb2019486493f4a928">load</a> (const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;jo, std::string_view src)</td></tr>
<tr class="memdesc:aa2950ac41bfcd3bb2019486493f4a928"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load a palette object and adds it to the global set of palettes.  <a href="classmapgen__palette.html#aa2950ac41bfcd3bb2019486493f4a928">More...</a><br /></td></tr>
<tr class="separator:aa2950ac41bfcd3bb2019486493f4a928"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a502bd8a6fd76cedea890b30d0d017421"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classmapgen__palette.html">mapgen_palette</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a502bd8a6fd76cedea890b30d0d017421">get</a> (const <a class="el" href="type__id_8h.html#a0e3e62a8831861ee9ebec5b109fd962d">palette_id</a> &amp;<a class="el" href="classmapgen__palette.html#a43fdbd0d1b590c7b77bb365682519078">id</a>)</td></tr>
<tr class="memdesc:a502bd8a6fd76cedea890b30d0d017421"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a palette with given id.  <a href="classmapgen__palette.html#a502bd8a6fd76cedea890b30d0d017421">More...</a><br /></td></tr>
<tr class="separator:a502bd8a6fd76cedea890b30d0d017421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f0ec4474aedee26a697c47067432e95"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a5f0ec4474aedee26a697c47067432e95">check_definitions</a> ()</td></tr>
<tr class="separator:a5f0ec4474aedee26a697c47067432e95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7164412835166b8a3c111a658ea78d8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#ae7164412835166b8a3c111a658ea78d8">reset</a> ()</td></tr>
<tr class="separator:ae7164412835166b8a3c111a658ea78d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a43fdbd0d1b590c7b77bb365682519078"><td class="memItemLeft" align="right" valign="top"><a class="el" href="type__id_8h.html#a0e3e62a8831861ee9ebec5b109fd962d">palette_id</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a43fdbd0d1b590c7b77bb365682519078">id</a></td></tr>
<tr class="separator:a43fdbd0d1b590c7b77bb365682519078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bf6afe53988e0c41840803a6ac8f0f4"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; <a class="el" href="classmap__key.html">map_key</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a0bf6afe53988e0c41840803a6ac8f0f4">keys_with_terrain</a></td></tr>
<tr class="separator:a0bf6afe53988e0c41840803a6ac8f0f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a1f275fb82ecab159858a32ab1d8bef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmapgen__palette.html#aaa8d532929c86b55e56bc1067df5046a">placing_map</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a></td></tr>
<tr class="separator:a3a1f275fb82ecab159858a32ab1d8bef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a163a39c5236e2f6f3becf2d65735d22a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a163a39c5236e2f6f3becf2d65735d22a">add</a> (const <a class="el" href="classmapgen__value.html">mapgen_value</a>&lt; std::string &gt; &amp;rh, const <a class="el" href="structmapgen__palette_1_1add__palette__context.html">add_palette_context</a> &amp;)</td></tr>
<tr class="memdesc:a163a39c5236e2f6f3becf2d65735d22a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a palette to this one.  <a href="classmapgen__palette.html#a163a39c5236e2f6f3becf2d65735d22a">More...</a><br /></td></tr>
<tr class="separator:a163a39c5236e2f6f3becf2d65735d22a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab25750635d2bef4e1d6dbf7fb3725f96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#ab25750635d2bef4e1d6dbf7fb3725f96">add</a> (const <a class="el" href="type__id_8h.html#a0e3e62a8831861ee9ebec5b109fd962d">palette_id</a> &amp;rh, const <a class="el" href="structmapgen__palette_1_1add__palette__context.html">add_palette_context</a> &amp;)</td></tr>
<tr class="separator:ab25750635d2bef4e1d6dbf7fb3725f96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0bfd1a474cb3bd5a986580b70282a61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#ad0bfd1a474cb3bd5a986580b70282a61">add</a> (const <a class="el" href="classmapgen__palette.html">mapgen_palette</a> &amp;rh, const <a class="el" href="structmapgen__palette_1_1add__palette__context.html">add_palette_context</a> &amp;)</td></tr>
<tr class="separator:ad0bfd1a474cb3bd5a986580b70282a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a3777e70543d4874ae20667c1e163dfc4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classmapgen__palette.html">mapgen_palette</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a3777e70543d4874ae20667c1e163dfc4">load_internal</a> (const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;jo, std::string_view src, const std::string &amp;<a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, bool require_id, bool allow_recur)</td></tr>
<tr class="separator:a3777e70543d4874ae20667c1e163dfc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a316845dd87256596e884b4046edbb269"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmapgen__parameters.html">mapgen_parameters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">parameters</a></td></tr>
<tr class="separator:a316845dd87256596e884b4046edbb269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3caccf2fc5c4fe1adb5014f0e450a0e3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classmapgen__value.html">mapgen_value</a>&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmapgen__palette.html#a3caccf2fc5c4fe1adb5014f0e450a0e3">palettes_used</a></td></tr>
<tr class="separator:a3caccf2fc5c4fe1adb5014f0e450a0e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="mapgen_8h_source.html#l00306">306</a> of file <a class="el" href="mapgen_8h_source.html">mapgen.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="aaa8d532929c86b55e56bc1067df5046a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa8d532929c86b55e56bc1067df5046a">&#9670;&nbsp;</a></span>placing_map</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classmapgen__palette.html#aaa8d532929c86b55e56bc1067df5046a">mapgen_palette::placing_map</a> =  std::unordered_map&lt;<a class="el" href="classmap__key.html">map_key</a>, std::vector&lt; <a class="el" href="memory__fast_8h.html#ada897699f31fc8b37c5af09d95d45840">shared_ptr_fast</a>&lt;const <a class="el" href="classjmapgen__piece.html">jmapgen_piece</a>&gt; &gt;&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The mapping from character (key) to a list of things that should be placed. </p>
<p>This is similar to objects, but it uses key to get the actual position where to place things out of the json "bitmap" (which is used to paint the terrain/furniture). </p>

<p class="definition">Definition at line <a class="el" href="mapgen_8h_source.html#l00316">316</a> of file <a class="el" href="mapgen_8h_source.html">mapgen.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ad0bfd1a474cb3bd5a986580b70282a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0bfd1a474cb3bd5a986580b70282a61">&#9670;&nbsp;</a></span>add() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_palette::add </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmapgen__palette.html">mapgen_palette</a> &amp;&#160;</td>
          <td class="paramname"><em>rh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmapgen__palette_1_1add__palette__context.html">add_palette_context</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04280">4280</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;{</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;    std::string actual_context = <span class="keywordtype">id</span>.is_empty() ? <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>.context : <span class="stringliteral">&quot;palette &quot;</span> + <span class="keywordtype">id</span>.str();</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160; </div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;    <span class="keywordflow">if</span>( !rh.<a class="code" href="classmapgen__palette.html#a43fdbd0d1b590c7b77bb365682519078">id</a>.<a class="code" href="classstring__id.html#ac180a60056901aaf79f5c4b728a257bd">is_empty</a>() ) {</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;        <span class="keyword">const</span> std::vector&lt;palette_id&gt; &amp;ancestors = <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>.ancestors;</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;        <span class="keyword">auto</span> loop_start = std::find( ancestors.begin(), ancestors.end(), rh.<a class="code" href="classmapgen__palette.html#a43fdbd0d1b590c7b77bb365682519078">id</a> );</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;        <span class="keywordflow">if</span>( loop_start != ancestors.end() ) {</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;            std::string loop_ids = <a class="code" href="output_8h.html#a4be67498ee67b5186fcae5cf706f7512">enumerate_as_string</a>( loop_start, ancestors.end(),</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;            []( <span class="keyword">const</span> <a class="code" href="classstring__id.html">palette_id</a> &amp; i ) {</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;                return i.str();</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;            }, <a class="code" href="output_8h.html#acff0d12357d8a4690e781eed41b36b98a9022a153e6190f10d9b57aa4232b8aea">enumeration_conjunction::arrow</a> );</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;            <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;loop in palette references: %s&quot;</span>, loop_ids );</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;        }</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    }</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    add_palette_context new_context = <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>;</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    new_context.ancestors.push_back( rh.<a class="code" href="classmapgen__palette.html#a43fdbd0d1b590c7b77bb365682519078">id</a> );</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;    new_context.current_parameters = &amp;rh.<a class="code" href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">parameters</a>;</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160; </div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classmapgen__value.html">mapgen_value&lt;std::string&gt;</a> &amp;recursive_palette : rh.<a class="code" href="classmapgen__palette.html#a3caccf2fc5c4fe1adb5014f0e450a0e3">palettes_used</a> ) {</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;        <a class="code" href="classmapgen__palette.html#a163a39c5236e2f6f3becf2d65735d22a">add</a>( recursive_palette, new_context );</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;    }</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;placing : rh.<a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a> ) {</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;        <span class="keyword">const</span> std::vector&lt;mapgen_constraint&lt;palette_id&gt;&gt; &amp;constraints = <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>.constraints;</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;        std::vector&lt;shared_ptr_fast&lt;const jmapgen_piece&gt;&gt; constrained_placings = placing.second;</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;        <span class="keywordflow">if</span>( !constraints.empty() ) {</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;            <span class="keywordflow">for</span>( <a class="code" href="memory__fast_8h.html#ada897699f31fc8b37c5af09d95d45840">shared_ptr_fast&lt;const jmapgen_piece&gt;</a> &amp;piece : constrained_placings ) {</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                piece = make_shared_fast&lt;jmapgen_constrained&lt;palette_id&gt;&gt;(</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                            std::move( piece ), constraints );</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;            }</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;        }</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;        std::vector&lt;shared_ptr_fast&lt;const jmapgen_piece&gt;&gt; &amp;these_placings =</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;                    <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>[placing.first];</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;        these_placings.insert( these_placings.end(),</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;                               constrained_placings.begin(), constrained_placings.end() );</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;    }</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classmap__key.html">map_key</a> &amp;placing : rh.<a class="code" href="classmapgen__palette.html#a0bf6afe53988e0c41840803a6ac8f0f4">keys_with_terrain</a> ) {</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;        <a class="code" href="classmapgen__palette.html#a0bf6afe53988e0c41840803a6ac8f0f4">keys_with_terrain</a>.insert( placing );</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;    }</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;    <a class="code" href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">parameters</a>.<a class="code" href="structmapgen__parameters.html#af4fa4b971b74880bf290b78a179cd2cd">check_and_merge</a>( rh.<a class="code" href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">parameters</a>, actual_context );</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;}</div>
<div class="ttc" id="aclassmap__key_html"><div class="ttname"><a href="classmap__key.html">map_key</a></div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00272">mapgen.h:273</a></div></div>
<div class="ttc" id="aclassmapgen__palette_html_a0bf6afe53988e0c41840803a6ac8f0f4"><div class="ttname"><a href="classmapgen__palette.html#a0bf6afe53988e0c41840803a6ac8f0f4">mapgen_palette::keys_with_terrain</a></div><div class="ttdeci">std::unordered_set&lt; map_key &gt; keys_with_terrain</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00319">mapgen.h:319</a></div></div>
<div class="ttc" id="aclassmapgen__palette_html_a163a39c5236e2f6f3becf2d65735d22a"><div class="ttname"><a href="classmapgen__palette.html#a163a39c5236e2f6f3becf2d65735d22a">mapgen_palette::add</a></div><div class="ttdeci">void add(const mapgen_value&lt; std::string &gt; &amp;rh, const add_palette_context &amp;)</div><div class="ttdoc">Adds a palette to this one.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l04240">mapgen.cpp:4240</a></div></div>
<div class="ttc" id="aclassmapgen__palette_html_a316845dd87256596e884b4046edbb269"><div class="ttname"><a href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">mapgen_palette::parameters</a></div><div class="ttdeci">mapgen_parameters parameters</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00356">mapgen.h:356</a></div></div>
<div class="ttc" id="aclassmapgen__palette_html_a3a1f275fb82ecab159858a32ab1d8bef"><div class="ttname"><a href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">mapgen_palette::format_placings</a></div><div class="ttdeci">placing_map format_placings</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00320">mapgen.h:320</a></div></div>
<div class="ttc" id="aclassmapgen__palette_html_a3caccf2fc5c4fe1adb5014f0e450a0e3"><div class="ttname"><a href="classmapgen__palette.html#a3caccf2fc5c4fe1adb5014f0e450a0e3">mapgen_palette::palettes_used</a></div><div class="ttdeci">std::vector&lt; mapgen_value&lt; std::string &gt; &gt; palettes_used</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00361">mapgen.h:361</a></div></div>
<div class="ttc" id="aclassmapgen__palette_html_a43fdbd0d1b590c7b77bb365682519078"><div class="ttname"><a href="classmapgen__palette.html#a43fdbd0d1b590c7b77bb365682519078">mapgen_palette::id</a></div><div class="ttdeci">palette_id id</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00309">mapgen.h:309</a></div></div>
<div class="ttc" id="aclassmapgen__value_html"><div class="ttname"><a href="classmapgen__value.html">mapgen_value&lt; std::string &gt;</a></div></div>
<div class="ttc" id="aclassstring__id_html"><div class="ttname"><a href="classstring__id.html">string_id&lt; mapgen_palette &gt;</a></div></div>
<div class="ttc" id="aclassstring__id_html_ac180a60056901aaf79f5c4b728a257bd"><div class="ttname"><a href="classstring__id.html#ac180a60056901aaf79f5c4b728a257bd">string_id::is_empty</a></div><div class="ttdeci">bool is_empty() const</div><div class="ttdoc">Returns whether this id is empty.</div><div class="ttdef"><b>Definition:</b> <a href="string__id_8h_source.html#l00303">string_id.h:303</a></div></div>
<div class="ttc" id="adebug_8h_html_a87e509562277a7ada3a75330d00cb445"><div class="ttname"><a href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a></div><div class="ttdeci">#define debugmsg(...)</div><div class="ttdoc">Debug message of level D_ERROR and class D_MAIN, also includes the source file name and line,...</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00069">debug.h:69</a></div></div>
<div class="ttc" id="aglobal__vars_8h_html_a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab"><div class="ttname"><a href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">var_type::context</a></div><div class="ttdeci">@ context</div></div>
<div class="ttc" id="amemory__fast_8h_html_ada897699f31fc8b37c5af09d95d45840"><div class="ttname"><a href="memory__fast_8h.html#ada897699f31fc8b37c5af09d95d45840">shared_ptr_fast</a></div><div class="ttdeci">std::shared_ptr&lt; T &gt; shared_ptr_fast</div><div class="ttdef"><b>Definition:</b> <a href="memory__fast_8h_source.html#l00016">memory_fast.h:16</a></div></div>
<div class="ttc" id="aoutput_8h_html_a4be67498ee67b5186fcae5cf706f7512"><div class="ttname"><a href="output_8h.html#a4be67498ee67b5186fcae5cf706f7512">enumerate_as_string</a></div><div class="ttdeci">std::string enumerate_as_string(const Container &amp;values, enumeration_conjunction conj=enumeration_conjunction::and_)</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00647">output.h:647</a></div></div>
<div class="ttc" id="aoutput_8h_html_acff0d12357d8a4690e781eed41b36b98a9022a153e6190f10d9b57aa4232b8aea"><div class="ttname"><a href="output_8h.html#acff0d12357d8a4690e781eed41b36b98a9022a153e6190f10d9b57aa4232b8aea">enumeration_conjunction::arrow</a></div><div class="ttdeci">@ arrow</div></div>
<div class="ttc" id="astructmapgen__parameters_html_af4fa4b971b74880bf290b78a179cd2cd"><div class="ttname"><a href="structmapgen__parameters.html#af4fa4b971b74880bf290b78a179cd2cd">mapgen_parameters::check_and_merge</a></div><div class="ttdeci">void check_and_merge(const mapgen_parameters &amp;, const std::string &amp;context, mapgen_parameter_scope up_to_scope=mapgen_parameter_scope::last)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l01719">mapgen.cpp:1719</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l04240">add()</a>, <a class="el" href="mapgen_8h_source.html#l00371">mapgen_palette::add_palette_context::ancestors</a>, <a class="el" href="output_8h.html#acff0d12357d8a4690e781eed41b36b98a9022a153e6190f10d9b57aa4232b8aea">arrow</a>, <a class="el" href="mapgen_8cpp_source.html#l01719">mapgen_parameters::check_and_merge()</a>, <a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, <a class="el" href="mapgen_8h_source.html#l00373">mapgen_palette::add_palette_context::current_parameters</a>, <a class="el" href="debug_8h_source.html#l00069">debugmsg</a>, <a class="el" href="output_8h_source.html#l00647">enumerate_as_string()</a>, <a class="el" href="mapgen_8h_source.html#l00320">format_placings</a>, <a class="el" href="mapgen_8h_source.html#l00309">id</a>, <a class="el" href="string__id_8h_source.html#l00303">string_id&lt; T &gt;::is_empty()</a>, <a class="el" href="mapgen_8h_source.html#l00319">keys_with_terrain</a>, <a class="el" href="mapgen_8h_source.html#l00361">palettes_used</a>, and <a class="el" href="mapgen_8h_source.html#l00356">parameters</a>.</p>

</div>
</div>
<a id="a163a39c5236e2f6f3becf2d65735d22a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a163a39c5236e2f6f3becf2d65735d22a">&#9670;&nbsp;</a></span>add() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_palette::add </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmapgen__value.html">mapgen_value</a>&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>rh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmapgen__palette_1_1add__palette__context.html">add_palette_context</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a palette to this one. </p>
<p>New values take preference over the old ones.</p>
<p>The ancestors parameter is a set of ids from all the palettes currently being added, when this addition is triggered by the addition of another palette which includes rh. This allows for detection of loops in palette references. </p>

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04240">4240</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;{</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;    std::vector&lt;std::string&gt; possible_values =</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        rh.<a class="code" href="classmapgen__value.html#af1f6fe84dffd3b4b4c5447d95c8387ab">all_possible_results</a>( *<a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>.current_parameters );</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    <span class="keywordflow">if</span>( possible_values.empty() ) {</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;        <span class="keywordflow">if</span>( <span class="keyword">const</span> std::string *param_name = rh.<a class="code" href="classmapgen__value.html#a85a75a5d72a24cc6c0b720423de8bee0">get_name_if_parameter</a>() ) {</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;            <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Parameter %s used for palette id in %s but has no possible values&quot;</span>,</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;                      *param_name, <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>.context );</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;            <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Mapgen value for used for palette id in %s has no possible values&quot;</span>,</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;                      <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>.context );</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;        }</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( possible_values.size() == 1 ) {</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;        <a class="code" href="classmapgen__palette.html#a163a39c5236e2f6f3becf2d65735d22a">add</a>( <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5ccd92e7e1028d9496b40fb4ecc3f51d">palette_id</a>( possible_values.front() ), <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a> );</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;        std::string param_name;</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;        <span class="keywordflow">if</span>( <span class="keyword">const</span> std::string *<a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> = rh.<a class="code" href="classmapgen__value.html#a85a75a5d72a24cc6c0b720423de8bee0">get_name_if_parameter</a>() ) {</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;            param_name = *<a class="code" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a>;</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> param_it =</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;                <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>.top_level_parameters-&gt;add_unique_parameter(</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;                    <span class="stringliteral">&quot;palette_choice_&quot;</span>, rh, <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5ccd92e7e1028d9496b40fb4ecc3f51d">cata_variant_type::palette_id</a>,</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;                    <a class="code" href="mapgen__parameter_8h.html#a3ae906f0a8bbbef8d2b0fc9fb7f7c2f0aa2f9c4bea2399306343ba118ab08aab1">mapgen_parameter_scope::overmap_special</a> );</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;            param_name = param_it-&gt;first;</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;        }</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;        add_palette_context context_with_extra_constraint( <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a> );</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> std::string &amp;value : possible_values ) {</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;            <a class="code" href="classstring__id.html">palette_id</a> val_id( value );</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;            context_with_extra_constraint.constraints.emplace_back( param_name, val_id );</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;            <a class="code" href="classmapgen__palette.html#a163a39c5236e2f6f3becf2d65735d22a">add</a>( val_id, context_with_extra_constraint );</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;            context_with_extra_constraint.constraints.pop_back();</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;        }</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    }</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;}</div>
<div class="ttc" id="acata__variant_8h_html_adfe42687fffdd05d233096b4e7dac2f4a5ccd92e7e1028d9496b40fb4ecc3f51d"><div class="ttname"><a href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5ccd92e7e1028d9496b40fb4ecc3f51d">cata_variant_type::palette_id</a></div><div class="ttdeci">@ palette_id</div></div>
<div class="ttc" id="aclassmapgen__value_html_a85a75a5d72a24cc6c0b720423de8bee0"><div class="ttname"><a href="classmapgen__value.html#a85a75a5d72a24cc6c0b720423de8bee0">mapgen_value::get_name_if_parameter</a></div><div class="ttdeci">const std::string * get_name_if_parameter() const</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l01548">mapgen.cpp:1548</a></div></div>
<div class="ttc" id="aclassmapgen__value_html_af1f6fe84dffd3b4b4c5447d95c8387ab"><div class="ttname"><a href="classmapgen__value.html#af1f6fe84dffd3b4b4c5447d95c8387ab">mapgen_value::all_possible_results</a></div><div class="ttdeci">std::vector&lt; StringId &gt; all_possible_results(const mapgen_parameters &amp;params) const</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l01544">mapgen.cpp:1544</a></div></div>
<div class="ttc" id="amapgen__parameter_8h_html_a3ae906f0a8bbbef8d2b0fc9fb7f7c2f0aa2f9c4bea2399306343ba118ab08aab1"><div class="ttname"><a href="mapgen__parameter_8h.html#a3ae906f0a8bbbef8d2b0fc9fb7f7c2f0aa2f9c4bea2399306343ba118ab08aab1">mapgen_parameter_scope::overmap_special</a></div><div class="ttdeci">@ overmap_special</div></div>
<div class="ttc" id="anamespaceom__direction_html_a8ba958ccfad28c0a5572a04dd1428f32"><div class="ttname"><a href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">om_direction::name</a></div><div class="ttdeci">std::string name(type dir)</div><div class="ttdoc">Get Human readable name of a direction.</div><div class="ttdef"><b>Definition:</b> <a href="overmap_8cpp_source.html#l06412">overmap.cpp:6412</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l01544">mapgen_value&lt; Id &gt;::all_possible_results()</a>, <a class="el" href="mapgen_8h_source.html#l00374">mapgen_palette::add_palette_context::constraints</a>, <a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, <a class="el" href="debug_8h_source.html#l00069">debugmsg</a>, <a class="el" href="mapgen_8cpp_source.html#l01548">mapgen_value&lt; Id &gt;::get_name_if_parameter()</a>, <a class="el" href="overmap_8cpp_source.html#l06412">om_direction::name()</a>, <a class="el" href="mapgen__parameter_8h.html#a3ae906f0a8bbbef8d2b0fc9fb7f7c2f0aa2f9c4bea2399306343ba118ab08aab1">overmap_special</a>, and <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5ccd92e7e1028d9496b40fb4ecc3f51d">palette_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04275">add()</a>, and <a class="el" href="mapgen_8cpp_source.html#l04323">load_internal()</a>.</p>

</div>
</div>
<a id="ab25750635d2bef4e1d6dbf7fb3725f96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab25750635d2bef4e1d6dbf7fb3725f96">&#9670;&nbsp;</a></span>add() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_palette::add </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a0e3e62a8831861ee9ebec5b109fd962d">palette_id</a> &amp;&#160;</td>
          <td class="paramname"><em>rh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmapgen__palette_1_1add__palette__context.html">add_palette_context</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04275">4275</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;{</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;    <a class="code" href="classmapgen__palette.html#a163a39c5236e2f6f3becf2d65735d22a">add</a>( <a class="code" href="classmapgen__palette.html#a502bd8a6fd76cedea890b30d0d017421">get</a>( rh ), <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a> );</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;}</div>
<div class="ttc" id="aclassmapgen__palette_html_a502bd8a6fd76cedea890b30d0d017421"><div class="ttname"><a href="classmapgen__palette.html#a502bd8a6fd76cedea890b30d0d017421">mapgen_palette::get</a></div><div class="ttdeci">static const mapgen_palette &amp; get(const palette_id &amp;id)</div><div class="ttdoc">Returns a palette with given id.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l04216">mapgen.cpp:4216</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l04240">add()</a>, <a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, and <a class="el" href="mapgen_8cpp_source.html#l04216">get()</a>.</p>

</div>
</div>
<a id="ab075da8871854552d9d214c190b94a0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab075da8871854552d9d214c190b94a0b">&#9670;&nbsp;</a></span>check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_palette::check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04183">4183</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;{</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    std::string <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a> = <span class="stringliteral">&quot;palette &quot;</span> + <span class="keywordtype">id</span>.str();</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;    <a class="code" href="structjmapgen__int.html">jmapgen_int</a> fake_coord( -1 );</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    <a class="code" href="structmapgen__parameters.html">mapgen_parameters</a> no_parameters;</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;const std::string, mapgen_parameter&gt; &amp;param : <a class="code" href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">parameters</a>.<a class="code" href="structmapgen__parameters.html#af11d99749c3dd3a67087ea4869a9bcff">map</a> ) {</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;        std::string this_context = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;parameter %s in %s&quot;</span>, param.first, <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a> );</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;        param.second.check( no_parameters, this_context );</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    }</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> std::pair&lt;<span class="keyword">const</span> <a class="code" href="classmap__key.html">map_key</a>, std::vector&lt;<a class="code" href="memory__fast_8h.html#ada897699f31fc8b37c5af09d95d45840">shared_ptr_fast&lt;const jmapgen_piece&gt;</a>&gt;&gt; &amp;p :</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;         <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a> ) {</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="memory__fast_8h.html#ada897699f31fc8b37c5af09d95d45840">shared_ptr_fast&lt;const jmapgen_piece&gt;</a> &amp;j : p.second ) {</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;            j-&gt;check( <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, <a class="code" href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">parameters</a>, fake_coord, fake_coord, fake_coord );</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;        }</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;    }</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;}</div>
<div class="ttc" id="astring__formatter_8h_html_a8964099387da2f95396c67566bafce3d"><div class="ttname"><a href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a></div><div class="ttdeci">std::string string_format(std::string_view format, Args &amp;&amp;...args)</div><div class="ttdoc">Simple wrapper over string_formatter::parse.</div><div class="ttdef"><b>Definition:</b> <a href="string__formatter_8h_source.html#l00417">string_formatter.h:417</a></div></div>
<div class="ttc" id="astructjmapgen__int_html"><div class="ttname"><a href="structjmapgen__int.html">jmapgen_int</a></div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00081">mapgen.h:81</a></div></div>
<div class="ttc" id="astructmapgen__parameters_html"><div class="ttname"><a href="structmapgen__parameters.html">mapgen_parameters</a></div><div class="ttdef"><b>Definition:</b> <a href="mapgen__parameter_8h_source.html#l00056">mapgen_parameter.h:56</a></div></div>
<div class="ttc" id="astructmapgen__parameters_html_af11d99749c3dd3a67087ea4869a9bcff"><div class="ttname"><a href="structmapgen__parameters.html#af11d99749c3dd3a67087ea4869a9bcff">mapgen_parameters::map</a></div><div class="ttdeci">std::unordered_map&lt; std::string, mapgen_parameter &gt; map</div><div class="ttdef"><b>Definition:</b> <a href="mapgen__parameter_8h_source.html#l00057">mapgen_parameter.h:57</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, <a class="el" href="mapgen_8h_source.html#l00320">format_placings</a>, <a class="el" href="mapgen__parameter_8h_source.html#l00057">mapgen_parameters::map</a>, <a class="el" href="mapgen_8h_source.html#l00356">parameters</a>, and <a class="el" href="string__formatter_8h_source.html#l00417">string_format()</a>.</p>

</div>
</div>
<a id="a5f0ec4474aedee26a697c47067432e95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f0ec4474aedee26a697c47067432e95">&#9670;&nbsp;</a></span>check_definitions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_palette::check_definitions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04228">4228</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;{</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;p : <a class="code" href="mapgen_8cpp.html#a4c3eb02c88bc5d32d259bbdd9074a16f">palettes</a> ) {</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;        p.second.check();</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;    }</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;}</div>
<div class="ttc" id="amapgen_8cpp_html_a4c3eb02c88bc5d32d259bbdd9074a16f"><div class="ttname"><a href="mapgen_8cpp.html#a4c3eb02c88bc5d32d259bbdd9074a16f">palettes</a></div><div class="ttdeci">static std::map&lt; palette_id, mapgen_palette &gt; palettes</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l04164">mapgen.cpp:4164</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l04164">palettes</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8cpp_source.html#l00782">DynamicDataLoader::check_consistency()</a>.</p>

</div>
</div>
<a id="a502bd8a6fd76cedea890b30d0d017421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a502bd8a6fd76cedea890b30d0d017421">&#9670;&nbsp;</a></span>get()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classmapgen__palette.html">mapgen_palette</a> &amp; mapgen_palette::get </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a0e3e62a8831861ee9ebec5b109fd962d">palette_id</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a palette with given id. </p>
<p>If not found, debugmsg and returns a dummy. </p>

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04216">4216</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;{</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> iter = <a class="code" href="mapgen_8cpp.html#a4c3eb02c88bc5d32d259bbdd9074a16f">palettes</a>.find( <span class="keywordtype">id</span> );</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;    <span class="keywordflow">if</span>( iter != <a class="code" href="mapgen_8cpp.html#a4c3eb02c88bc5d32d259bbdd9074a16f">palettes</a>.end() ) {</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;        <span class="keywordflow">return</span> iter-&gt;second;</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;    }</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160; </div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;    <a class="code" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Requested palette with unknown id %s&quot;</span>, <span class="keywordtype">id</span>.c_str() );</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;    <span class="keyword">static</span> <a class="code" href="classmapgen__palette.html">mapgen_palette</a> dummy;</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;    <span class="keywordflow">return</span> dummy;</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;}</div>
<div class="ttc" id="aclassmapgen__palette_html"><div class="ttname"><a href="classmapgen__palette.html">mapgen_palette</a></div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00306">mapgen.h:307</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="debug_8h_source.html#l00069">debugmsg</a>, and <a class="el" href="mapgen_8cpp_source.html#l04164">palettes</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04275">add()</a>, <a class="el" href="mapgen_8cpp_source.html#l04861">jmapgen_setmap::apply()</a>, and <a class="el" href="mapgen_8cpp_source.html#l05108">jmapgen_setmap::has_vehicle_collision()</a>.</p>

</div>
</div>
<a id="ab0804b84fa50cb79440fbd8735080dc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0804b84fa50cb79440fbd8735080dc7">&#9670;&nbsp;</a></span>get_parameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structmapgen__parameters.html">mapgen_parameters</a>&amp; mapgen_palette::get_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8h_source.html#l00332">332</a> of file <a class="el" href="mapgen_8h_source.html">mapgen.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                                        {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">parameters</a>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8h_source.html#l00356">parameters</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04531">mapgen_function_json_base::setup_common()</a>.</p>

</div>
</div>
<a id="aa2950ac41bfcd3bb2019486493f4a928"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2950ac41bfcd3bb2019486493f4a928">&#9670;&nbsp;</a></span>load()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_palette::load </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;&#160;</td>
          <td class="paramname"><em>jo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string_view&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load a palette object and adds it to the global set of palettes. </p>
<p>If "palette" field is specified, those palettes will be loaded recursively. </p>

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04206">4206</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;{</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;    <a class="code" href="classmapgen__palette.html">mapgen_palette</a> <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = <a class="code" href="classmapgen__palette.html#a3777e70543d4874ae20667c1e163dfc4">load_internal</a>( jo, src, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">true</span>, <span class="keyword">false</span> );</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.id.is_empty() ) {</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        jo.<a class="code" href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">throw_error</a>( <span class="stringliteral">&quot;Named palette needs an id&quot;</span> );</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;    }</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160; </div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    <a class="code" href="mapgen_8cpp.html#a4c3eb02c88bc5d32d259bbdd9074a16f">palettes</a>[ <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.id ] = <a class="code" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;}</div>
<div class="ttc" id="aclassJsonObject_html_af3e3ae76afc340c1fa3510acaaba57b8"><div class="ttname"><a href="classJsonObject.html#af3e3ae76afc340c1fa3510acaaba57b8">JsonObject::throw_error</a></div><div class="ttdeci">void throw_error(const std::string &amp;err) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8cpp_source.html#l00353">flexbuffer_json.cpp:353</a></div></div>
<div class="ttc" id="aclassmapgen__palette_html_a3777e70543d4874ae20667c1e163dfc4"><div class="ttname"><a href="classmapgen__palette.html#a3777e70543d4874ae20667c1e163dfc4">mapgen_palette::load_internal</a></div><div class="ttdeci">static mapgen_palette load_internal(const JsonObject &amp;jo, std::string_view src, const std::string &amp;context, bool require_id, bool allow_recur)</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l04323">mapgen.cpp:4323</a></div></div>
<div class="ttc" id="anamespacecata_1_1hash64__detail_html_a5ca825db6fd06946302c60daa97333e4"><div class="ttname"><a href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">cata::hash64_detail::ret</a></div><div class="ttdeci">T ret</div><div class="ttdef"><b>Definition:</b> <a href="hash__utils_8h_source.html#l00097">hash_utils.h:97</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l04323">load_internal()</a>, <a class="el" href="mapgen_8cpp_source.html#l04164">palettes</a>, <a class="el" href="hash__utils_8h_source.html#l00097">cata::hash64_detail::ret</a>, and <a class="el" href="flexbuffer__json_8cpp_source.html#l00353">JsonObject::throw_error()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8cpp_source.html#l00237">DynamicDataLoader::initialize()</a>.</p>

</div>
</div>
<a id="a3777e70543d4874ae20667c1e163dfc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3777e70543d4874ae20667c1e163dfc4">&#9670;&nbsp;</a></span>load_internal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmapgen__palette.html">mapgen_palette</a> mapgen_palette::load_internal </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;&#160;</td>
          <td class="paramname"><em>jo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string_view&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>require_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>allow_recur</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04323">4323</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;{</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;    <a class="code" href="classmapgen__palette.html">mapgen_palette</a> new_pal;</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    <a class="code" href="classmapgen__palette.html#aaa8d532929c86b55e56bc1067df5046a">mapgen_palette::placing_map</a> &amp;<a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a> = new_pal.<a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>;</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;    <span class="keyword">auto</span> &amp;<a class="code" href="classmapgen__palette.html#a0bf6afe53988e0c41840803a6ac8f0f4">keys_with_terrain</a> = new_pal.<a class="code" href="classmapgen__palette.html#a0bf6afe53988e0c41840803a6ac8f0f4">keys_with_terrain</a>;</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    <span class="keywordflow">if</span>( require_id ) {</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;        new_pal.<a class="code" href="classmapgen__palette.html#a43fdbd0d1b590c7b77bb365682519078">id</a> = <a class="code" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5ccd92e7e1028d9496b40fb4ecc3f51d">palette_id</a>( jo.<a class="code" href="classJsonObject.html#a1abb3808bb2a992716d5ef6f27a32b3c">get_string</a>( <span class="stringliteral">&quot;id&quot;</span> ) );</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;    }</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160; </div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    jo.<a class="code" href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">read</a>( <span class="stringliteral">&quot;parameters&quot;</span>, new_pal.<a class="code" href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">parameters</a>.<a class="code" href="structmapgen__parameters.html#af11d99749c3dd3a67087ea4869a9bcff">map</a> );</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160; </div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    <span class="keywordflow">if</span>( jo.<a class="code" href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">has_array</a>( <span class="stringliteral">&quot;palettes&quot;</span> ) ) {</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;        jo.<a class="code" href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">read</a>( <span class="stringliteral">&quot;palettes&quot;</span>, new_pal.<a class="code" href="classmapgen__palette.html#a3caccf2fc5c4fe1adb5014f0e450a0e3">palettes_used</a> );</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;        <span class="keywordflow">if</span>( allow_recur ) {</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;            <span class="comment">// allow_recur means that it&#39;s safe to assume all the palettes have</span></div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;            <span class="comment">// been defined and we can inline now.  Otherwise we just leave the</span></div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;            <span class="comment">// list in our palettes_used array and it will be consumed</span></div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;            <span class="comment">// recursively by calls to add which add this palette.</span></div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;            add_palette_context add_context{ <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, &amp;new_pal.<a class="code" href="classmapgen__palette.html#a316845dd87256596e884b4046edbb269">parameters</a> };</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;            <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;p : new_pal.<a class="code" href="classmapgen__palette.html#a3caccf2fc5c4fe1adb5014f0e450a0e3">palettes_used</a> ) {</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;                new_pal.<a class="code" href="classmapgen__palette.html#a163a39c5236e2f6f3becf2d65735d22a">add</a>( p, add_context );</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;            }</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;            new_pal.<a class="code" href="classmapgen__palette.html#a3caccf2fc5c4fe1adb5014f0e450a0e3">palettes_used</a>.clear();</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        }</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    }</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160; </div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;    <span class="comment">// mandatory: every character in rows must have matching entry, unless fill_ter is set</span></div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;    <span class="comment">// &quot;terrain&quot;: { &quot;a&quot;: &quot;t_grass&quot;, &quot;b&quot;: &quot;t_lava&quot; }.  To help enforce this we</span></div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;    <span class="comment">// keep track of everything in the &quot;terrain&quot; object</span></div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    <span class="keywordflow">if</span>( jo.<a class="code" href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">has_member</a>( <span class="stringliteral">&quot;terrain&quot;</span> ) ) {</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonMember.html">JsonMember</a> <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a> : jo.<a class="code" href="classJsonObject.html#a3b9722313d9692826235c87e73e94f04">get_object</a>( <span class="stringliteral">&quot;terrain&quot;</span> ) ) {</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;            <a class="code" href="classmapgen__palette.html#a0bf6afe53988e0c41840803a6ac8f0f4">keys_with_terrain</a>.insert( <a class="code" href="classmap__key.html">map_key</a>( <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a> ) );</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;        }</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;    }</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160; </div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    std::string <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> = <span class="stringliteral">&quot;palette &quot;</span> + new_pal.<a class="code" href="classmapgen__palette.html#a43fdbd0d1b590c7b77bb365682519078">id</a>.<a class="code" href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">str</a>();</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__terrain.html">jmapgen_terrain</a>&gt;( jo, <span class="stringliteral">&quot;terrain&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__furniture.html">jmapgen_furniture</a>&gt;( jo, <span class="stringliteral">&quot;furniture&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__field.html">jmapgen_field</a>&gt;( jo, <span class="stringliteral">&quot;fields&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__npc.html">jmapgen_npc</a>&gt;( jo, <span class="stringliteral">&quot;npcs&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__sign.html">jmapgen_sign</a>&gt;( jo, <span class="stringliteral">&quot;signs&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__vending__machine.html">jmapgen_vending_machine</a>&gt;( jo, <span class="stringliteral">&quot;vendingmachines&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__toilet.html">jmapgen_toilet</a>&gt;( jo, <span class="stringliteral">&quot;toilets&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__gaspump.html">jmapgen_gaspump</a>&gt;( jo, <span class="stringliteral">&quot;gaspumps&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__item__group.html">jmapgen_item_group</a>&gt;( jo, <span class="stringliteral">&quot;items&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__monster__group.html">jmapgen_monster_group</a>&gt;( jo, <span class="stringliteral">&quot;monsters&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__vehicle.html">jmapgen_vehicle</a>&gt;( jo, <span class="stringliteral">&quot;vehicles&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    <span class="comment">// json member name is not optimal, it should be plural like all the others above, but that conflicts</span></div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    <span class="comment">// with the items entry which refers to item groups.</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__spawn__item.html">jmapgen_spawn_item</a>&gt;( jo, <span class="stringliteral">&quot;item&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__remove__vehicles.html">jmapgen_remove_vehicles</a>&gt;( jo, <span class="stringliteral">&quot;remove_vehicles&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__remove__all.html">jmapgen_remove_all</a>&gt;( jo, <span class="stringliteral">&quot;remove_all&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__trap.html">jmapgen_trap</a>&gt;( jo, <span class="stringliteral">&quot;traps&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__monster.html">jmapgen_monster</a>&gt;( jo, <span class="stringliteral">&quot;monster&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__make__rubble.html">jmapgen_make_rubble</a>&gt;( jo, <span class="stringliteral">&quot;rubble&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__computer.html">jmapgen_computer</a>&gt;( jo, <span class="stringliteral">&quot;computers&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__sealed__item.html">jmapgen_sealed_item</a>&gt;( jo, <span class="stringliteral">&quot;sealed_item&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__nested.html">jmapgen_nested</a>&gt;( jo, <span class="stringliteral">&quot;nested&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__liquid__item.html">jmapgen_liquid_item</a>&gt;( jo, <span class="stringliteral">&quot;liquids&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__corpse.html">jmapgen_corpse</a>&gt;( jo, <span class="stringliteral">&quot;corpses&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__graffiti.html">jmapgen_graffiti</a>&gt;( jo, <span class="stringliteral">&quot;graffiti&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__zone.html">jmapgen_zone</a>&gt;( jo, <span class="stringliteral">&quot;zones&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__ter__furn__transform.html">jmapgen_ter_furn_transform</a>&gt;( jo, <span class="stringliteral">&quot;ter_furn_transforms&quot;</span>,</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;            <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;    new_pal.<a class="code" href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">load_place_mapings</a>&lt;<a class="code" href="classjmapgen__faction.html">jmapgen_faction</a>&gt;( jo, <span class="stringliteral">&quot;faction_owner_character&quot;</span>, <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>, <a class="code" href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a> );</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160; </div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;    <span class="keywordflow">for</span>( mapgen_palette::placing_map::value_type &amp;p : <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a> ) {</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;        p.second.erase(</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;            std::remove_if(</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;                p.second.begin(), p.second.end(),</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;        []( <span class="keyword">const</span> <a class="code" href="memory__fast_8h.html#ada897699f31fc8b37c5af09d95d45840">shared_ptr_fast&lt;const jmapgen_piece&gt;</a> &amp;placing ) {</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;            <span class="keywordflow">return</span> placing-&gt;is_nop();</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;        } ), p.second.end() );</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    }</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;    <span class="keywordflow">return</span> new_pal;</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;}</div>
<div class="ttc" id="aclassJsonMember_html"><div class="ttname"><a href="classJsonMember.html">JsonMember</a></div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00501">flexbuffer_json.h:502</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a1abb3808bb2a992716d5ef6f27a32b3c"><div class="ttname"><a href="classJsonObject.html#a1abb3808bb2a992716d5ef6f27a32b3c">JsonObject::get_string</a></div><div class="ttdeci">std::string get_string(const std::string &amp;key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00813">flexbuffer_json-inl.h:813</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a3b9722313d9692826235c87e73e94f04"><div class="ttname"><a href="classJsonObject.html#a3b9722313d9692826235c87e73e94f04">JsonObject::get_object</a></div><div class="ttdeci">JsonObject get_object(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00864">flexbuffer_json-inl.h:864</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a4d917fcb285203f91b74002565375dce"><div class="ttname"><a href="classJsonObject.html#a4d917fcb285203f91b74002565375dce">JsonObject::has_array</a></div><div class="ttdeci">bool has_array(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00984">flexbuffer_json-inl.h:984</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a619cb4eae7922f357db47479fc71cf9b"><div class="ttname"><a href="classJsonObject.html#a619cb4eae7922f357db47479fc71cf9b">JsonObject::has_member</a></div><div class="ttdeci">bool has_member(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00944">flexbuffer_json-inl.h:944</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a8517ac783372bd0bf149ab8e5f7aae18"><div class="ttname"><a href="classJsonObject.html#a8517ac783372bd0bf149ab8e5f7aae18">JsonObject::read</a></div><div class="ttdeci">bool read(std::string_view name, T &amp;t, bool throw_on_error=true) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l01059">flexbuffer_json-inl.h:1059</a></div></div>
<div class="ttc" id="aclassjmapgen__computer_html"><div class="ttname"><a href="classjmapgen__computer.html">jmapgen_computer</a></div><div class="ttdoc">Place a computer (console) with given stats and effects.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l03150">mapgen.cpp:3151</a></div></div>
<div class="ttc" id="aclassjmapgen__corpse_html"><div class="ttname"><a href="classjmapgen__corpse.html">jmapgen_corpse</a></div><div class="ttdoc">Place a corpse of a random monster from a monster group into the map.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02241">mapgen.cpp:2242</a></div></div>
<div class="ttc" id="aclassjmapgen__faction_html"><div class="ttname"><a href="classjmapgen__faction.html">jmapgen_faction</a></div><div class="ttdoc">Place ownership area.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l01929">mapgen.cpp:1930</a></div></div>
<div class="ttc" id="aclassjmapgen__field_html"><div class="ttname"><a href="classjmapgen__field.html">jmapgen_field</a></div><div class="ttdoc">Places fields on the map.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l01826">mapgen.cpp:1827</a></div></div>
<div class="ttc" id="aclassjmapgen__furniture_html"><div class="ttname"><a href="classjmapgen__furniture.html">jmapgen_furniture</a></div><div class="ttdoc">Place a furniture.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02873">mapgen.cpp:2874</a></div></div>
<div class="ttc" id="aclassjmapgen__gaspump_html"><div class="ttname"><a href="classjmapgen__gaspump.html">jmapgen_gaspump</a></div><div class="ttdoc">Place a gas pump with fuel in it.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02133">mapgen.cpp:2134</a></div></div>
<div class="ttc" id="aclassjmapgen__graffiti_html"><div class="ttname"><a href="classjmapgen__graffiti.html">jmapgen_graffiti</a></div><div class="ttdoc">Place graffiti with some text or a snippet.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02019">mapgen.cpp:2020</a></div></div>
<div class="ttc" id="aclassjmapgen__item__group_html"><div class="ttname"><a href="classjmapgen__item__group.html">jmapgen_item_group</a></div><div class="ttdoc">Place items from an item group.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02269">mapgen.cpp:2270</a></div></div>
<div class="ttc" id="aclassjmapgen__liquid__item_html"><div class="ttname"><a href="classjmapgen__liquid__item.html">jmapgen_liquid_item</a></div><div class="ttdoc">Place a specific liquid into the map.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02186">mapgen.cpp:2187</a></div></div>
<div class="ttc" id="aclassjmapgen__make__rubble_html"><div class="ttname"><a href="classjmapgen__make__rubble.html">jmapgen_make_rubble</a></div><div class="ttdoc">Calls map::make_rubble to create rubble and destroy the existing terrain/furniture.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l03105">mapgen.cpp:3106</a></div></div>
<div class="ttc" id="aclassjmapgen__monster__group_html"><div class="ttname"><a href="classjmapgen__monster__group.html">jmapgen_monster_group</a></div><div class="ttdoc">Place spawn points for a monster group (actual monster spawning is done later).</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02366">mapgen.cpp:2367</a></div></div>
<div class="ttc" id="aclassjmapgen__monster_html"><div class="ttname"><a href="classjmapgen__monster.html">jmapgen_monster</a></div><div class="ttdoc">Place spawn points for a specific monster.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02406">mapgen.cpp:2407</a></div></div>
<div class="ttc" id="aclassjmapgen__nested_html"><div class="ttname"><a href="classjmapgen__nested.html">jmapgen_nested</a></div><div class="ttdoc">Calls another mapgen call inside the current one.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l03517">mapgen.cpp:3518</a></div></div>
<div class="ttc" id="aclassjmapgen__npc_html"><div class="ttname"><a href="classjmapgen__npc.html">jmapgen_npc</a></div><div class="ttdoc">Place an NPC.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l01870">mapgen.cpp:1871</a></div></div>
<div class="ttc" id="aclassjmapgen__remove__all_html"><div class="ttname"><a href="classjmapgen__remove__all.html">jmapgen_remove_all</a></div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l03483">mapgen.cpp:3484</a></div></div>
<div class="ttc" id="aclassjmapgen__remove__vehicles_html"><div class="ttname"><a href="classjmapgen__remove__vehicles.html">jmapgen_remove_vehicles</a></div><div class="ttdoc">Removes vehicles.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l03419">mapgen.cpp:3420</a></div></div>
<div class="ttc" id="aclassjmapgen__sealed__item_html"><div class="ttname"><a href="classjmapgen__sealed__item.html">jmapgen_sealed_item</a></div><div class="ttdoc">Place an item in furniture (expected to be used with NOITEM SEALED furniture like plants).</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l03225">mapgen.cpp:3226</a></div></div>
<div class="ttc" id="aclassjmapgen__sign_html"><div class="ttname"><a href="classjmapgen__sign.html">jmapgen_sign</a></div><div class="ttdoc">Place a sign with some text.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l01961">mapgen.cpp:1962</a></div></div>
<div class="ttc" id="aclassjmapgen__spawn__item_html"><div class="ttname"><a href="classjmapgen__spawn__item.html">jmapgen_spawn_item</a></div><div class="ttdoc">Place a specific item.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02767">mapgen.cpp:2768</a></div></div>
<div class="ttc" id="aclassjmapgen__ter__furn__transform_html"><div class="ttname"><a href="classjmapgen__ter__furn__transform.html">jmapgen_ter_furn_transform</a></div><div class="ttdoc">Run a transformation.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l03075">mapgen.cpp:3076</a></div></div>
<div class="ttc" id="aclassjmapgen__terrain_html"><div class="ttname"><a href="classjmapgen__terrain.html">jmapgen_terrain</a></div><div class="ttdoc">Place terrain.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02907">mapgen.cpp:2908</a></div></div>
<div class="ttc" id="aclassjmapgen__toilet_html"><div class="ttname"><a href="classjmapgen__toilet.html">jmapgen_toilet</a></div><div class="ttdoc">Place a toilet with (dirty) water in it.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02104">mapgen.cpp:2105</a></div></div>
<div class="ttc" id="aclassjmapgen__trap_html"><div class="ttname"><a href="classjmapgen__trap.html">jmapgen_trap</a></div><div class="ttdoc">Place a trap.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02820">mapgen.cpp:2821</a></div></div>
<div class="ttc" id="aclassjmapgen__vehicle_html"><div class="ttname"><a href="classjmapgen__vehicle.html">jmapgen_vehicle</a></div><div class="ttdoc">Place a vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02581">mapgen.cpp:2582</a></div></div>
<div class="ttc" id="aclassjmapgen__vending__machine_html"><div class="ttname"><a href="classjmapgen__vending__machine.html">jmapgen_vending_machine</a></div><div class="ttdoc">Place a vending machine with content.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l02065">mapgen.cpp:2066</a></div></div>
<div class="ttc" id="aclassjmapgen__zone_html"><div class="ttname"><a href="classjmapgen__zone.html">jmapgen_zone</a></div><div class="ttdoc">Place a zone.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l03359">mapgen.cpp:3360</a></div></div>
<div class="ttc" id="aclassmapgen__palette_html_a0665610ad46dfa7bd270fda185ddc517"><div class="ttname"><a href="classmapgen__palette.html#a0665610ad46dfa7bd270fda185ddc517">mapgen_palette::load_place_mapings</a></div><div class="ttdeci">void load_place_mapings(const JsonObject &amp;jo, const std::string &amp;member_name, placing_map &amp;format_placings, const std::string &amp;context)</div><div class="ttdoc">Load (append to format_placings) the places that should be put there.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8cpp_source.html#l04134">mapgen.cpp:4134</a></div></div>
<div class="ttc" id="aclassmapgen__palette_html_aaa8d532929c86b55e56bc1067df5046a"><div class="ttname"><a href="classmapgen__palette.html#aaa8d532929c86b55e56bc1067df5046a">mapgen_palette::placing_map</a></div><div class="ttdeci">std::unordered_map&lt; map_key, std::vector&lt; shared_ptr_fast&lt; const jmapgen_piece &gt; &gt;&gt; placing_map</div><div class="ttdoc">The mapping from character (key) to a list of things that should be placed.</div><div class="ttdef"><b>Definition:</b> <a href="mapgen_8h_source.html#l00316">mapgen.h:317</a></div></div>
<div class="ttc" id="aclassstring__id_html_ae75b0a209b55081a67c5fe6c17a4be00"><div class="ttname"><a href="classstring__id.html#ae75b0a209b55081a67c5fe6c17a4be00">string_id::str</a></div><div class="ttdeci">const std::string &amp; str() const</div><div class="ttdoc">Returns the identifier as plain std::string.</div><div class="ttdef"><b>Definition:</b> <a href="string__id_8h_source.html#l00260">string_id.h:260</a></div></div>
<div class="ttc" id="acondition_8h_html_a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3"><div class="ttname"><a href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">jarg::member</a></div><div class="ttdeci">@ member</div></div>
<div class="ttc" id="amagic_8cpp_html_a6753ecfe87da659675b18c2f81d6ec12"><div class="ttname"><a href="magic_8cpp.html#a6753ecfe87da659675b18c2f81d6ec12">c</a></div><div class="ttdeci">static constexpr double c</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01568">magic.cpp:1568</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l04240">add()</a>, <a class="el" href="magic_8cpp_source.html#l01568">c</a>, <a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, <a class="el" href="mapgen_8h_source.html#l00320">format_placings</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l00864">JsonObject::get_object()</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l00813">JsonObject::get_string()</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l00984">JsonObject::has_array()</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l00944">JsonObject::has_member()</a>, <a class="el" href="mapgen_8h_source.html#l00309">id</a>, <a class="el" href="mapgen_8h_source.html#l00319">keys_with_terrain</a>, <a class="el" href="mapgen_8cpp_source.html#l04134">load_place_mapings()</a>, <a class="el" href="mapgen__parameter_8h_source.html#l00057">mapgen_parameters::map</a>, <a class="el" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a>, <a class="el" href="cata__variant_8h.html#adfe42687fffdd05d233096b4e7dac2f4a5ccd92e7e1028d9496b40fb4ecc3f51d">palette_id</a>, <a class="el" href="mapgen_8h_source.html#l00361">palettes_used</a>, <a class="el" href="mapgen_8h_source.html#l00356">parameters</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l01059">JsonObject::read()</a>, and <a class="el" href="string__id_8h_source.html#l00260">string_id&lt; T &gt;::str()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04206">load()</a>, and <a class="el" href="mapgen_8cpp_source.html#l04200">load_temp()</a>.</p>

</div>
</div>
<a id="a0665610ad46dfa7bd270fda185ddc517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0665610ad46dfa7bd270fda185ddc517">&#9670;&nbsp;</a></span>load_place_mapings()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename PieceType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_palette::load_place_mapings </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;&#160;</td>
          <td class="paramname"><em>jo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>member_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmapgen__palette.html#aaa8d532929c86b55e56bc1067df5046a">placing_map</a> &amp;&#160;</td>
          <td class="paramname"><em>format_placings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load (append to format_placings) the places that should be put there. </p>
<p>member_name is the name of an optional object / array in the json object jsi. </p>

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04134">4134</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;{</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;    <span class="keywordflow">if</span>( jo.<a class="code" href="classJsonObject.html#a62e862f0390ad12302c9677069fb9d23">has_object</a>( <span class="stringliteral">&quot;mapping&quot;</span> ) ) {</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonMember.html">JsonMember</a> <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a> : jo.<a class="code" href="classJsonObject.html#a3b9722313d9692826235c87e73e94f04">get_object</a>( <span class="stringliteral">&quot;mapping&quot;</span> ) ) {</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;            <span class="keyword">const</span> <a class="code" href="classmap__key.html">map_key</a> key( <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a> );</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;            <a class="code" href="classJsonObject.html">JsonObject</a> <a class="code" href="namespacemath__opers.html#afa17fbd2e65f7936ed252fa80298d9a4">sub</a> = <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a>.get_object();</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;            <a class="code" href="namespacemath__opers.html#afa17fbd2e65f7936ed252fa80298d9a4">sub</a>.allow_omitted_members();</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;            <span class="keywordflow">if</span>( !<a class="code" href="namespacemath__opers.html#afa17fbd2e65f7936ed252fa80298d9a4">sub</a>.has_member( member_name ) ) {</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;            }</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;            <span class="keyword">auto</span> &amp;vect = <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>[ key ];</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;            <span class="comment">// NOLINTNEXTLINE(cata-translate-string-literal)</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;            std::string this_context = <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s in mapping in %s&quot;</span>, member_name, <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a> );</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;            ::load_place_mapings&lt;PieceType&gt;( <a class="code" href="namespacemath__opers.html#afa17fbd2e65f7936ed252fa80298d9a4">sub</a>.get_member( member_name ), vect, this_context );</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;        }</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;    }</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;    <span class="keywordflow">if</span>( !jo.<a class="code" href="classJsonObject.html#a62e862f0390ad12302c9677069fb9d23">has_object</a>( member_name ) ) {</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    }</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code" href="classJsonMember.html">JsonMember</a> <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a> : jo.<a class="code" href="classJsonObject.html#a3b9722313d9692826235c87e73e94f04">get_object</a>( member_name ) ) {</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;        <span class="keyword">const</span> <a class="code" href="classmap__key.html">map_key</a> key( <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a> );</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;        <span class="keyword">auto</span> &amp;vect = <a class="code" href="classmapgen__palette.html#a3a1f275fb82ecab159858a32ab1d8bef">format_placings</a>[ key ];</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;        std::string this_context =</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;            <span class="comment">// NOLINTNEXTLINE(cata-translate-string-literal)</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;            <a class="code" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s %s in %s&quot;</span>, member_name, <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a>.name(), <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a> );</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;        ::load_place_mapings&lt;PieceType&gt;( <a class="code" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a>, vect, this_context );</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    }</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;}</div>
<div class="ttc" id="aclassJsonObject_html"><div class="ttname"><a href="classJsonObject.html">JsonObject</a></div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json_8h_source.html#l00526">flexbuffer_json.h:527</a></div></div>
<div class="ttc" id="aclassJsonObject_html_a62e862f0390ad12302c9677069fb9d23"><div class="ttname"><a href="classJsonObject.html#a62e862f0390ad12302c9677069fb9d23">JsonObject::has_object</a></div><div class="ttdeci">bool has_object(std::string_view key) const</div><div class="ttdef"><b>Definition:</b> <a href="flexbuffer__json-inl_8h_source.html#l00990">flexbuffer_json-inl.h:990</a></div></div>
<div class="ttc" id="anamespacemath__opers_html_afa17fbd2e65f7936ed252fa80298d9a4"><div class="ttname"><a href="namespacemath__opers.html#afa17fbd2e65f7936ed252fa80298d9a4">math_opers::sub</a></div><div class="ttdeci">constexpr double sub(double l, double r)</div><div class="ttdef"><b>Definition:</b> <a href="math__parser__impl_8h_source.html#l00213">math_parser_impl.h:213</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, <a class="el" href="mapgen_8h_source.html#l00320">format_placings</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l00864">JsonObject::get_object()</a>, <a class="el" href="flexbuffer__json-inl_8h_source.html#l00990">JsonObject::has_object()</a>, <a class="el" href="condition_8h.html#a56caa864bd8a797e79177057e53088f7aaa08769cdcb26674c6706093503ff0a3">member</a>, <a class="el" href="string__formatter_8h_source.html#l00417">string_format()</a>, and <a class="el" href="math__parser__impl_8h_source.html#l00213">math_opers::sub()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04323">load_internal()</a>.</p>

</div>
</div>
<a id="aa9aa2da916f94d93e04ecb5f6dfc020b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9aa2da916f94d93e04ecb5f6dfc020b">&#9670;&nbsp;</a></span>load_temp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmapgen__palette.html">mapgen_palette</a> mapgen_palette::load_temp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classJsonObject.html">JsonObject</a> &amp;&#160;</td>
          <td class="paramname"><em>jo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string_view&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Loads a palette object and returns it. </p>
<p>Doesn't save it anywhere. </p>

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04200">4200</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;{</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classmapgen__palette.html#a3777e70543d4874ae20667c1e163dfc4">load_internal</a>( jo, src, <a class="code" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, <span class="keyword">false</span>, <span class="keyword">true</span> );</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="global__vars_8h.html#a54b344f3b76633f42ae19af82cc1cc89a5c18ef72771564b7f43c497dc507aeab">context</a>, and <a class="el" href="mapgen_8cpp_source.html#l04323">load_internal()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04531">mapgen_function_json_base::setup_common()</a>.</p>

</div>
</div>
<a id="ae7164412835166b8a3c111a658ea78d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7164412835166b8a3c111a658ea78d8">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void mapgen_palette::reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8cpp_source.html#l04235">4235</a> of file <a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;{</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;    <a class="code" href="mapgen_8cpp.html#a4c3eb02c88bc5d32d259bbdd9074a16f">palettes</a>.clear();</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mapgen_8cpp_source.html#l04164">palettes</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8cpp_source.html#l00548">DynamicDataLoader::unload_data()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3a1f275fb82ecab159858a32ab1d8bef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a1f275fb82ecab159858a32ab1d8bef">&#9670;&nbsp;</a></span>format_placings</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmapgen__palette.html#aaa8d532929c86b55e56bc1067df5046a">placing_map</a> mapgen_palette::format_placings</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8h_source.html#l00320">320</a> of file <a class="el" href="mapgen_8h_source.html">mapgen.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04280">add()</a>, <a class="el" href="mapgen_8cpp_source.html#l04183">check()</a>, <a class="el" href="mapgen_8cpp_source.html#l04323">load_internal()</a>, <a class="el" href="mapgen_8cpp_source.html#l04134">load_place_mapings()</a>, and <a class="el" href="mapgen_8cpp_source.html#l04531">mapgen_function_json_base::setup_common()</a>.</p>

</div>
</div>
<a id="a43fdbd0d1b590c7b77bb365682519078"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43fdbd0d1b590c7b77bb365682519078">&#9670;&nbsp;</a></span>id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="type__id_8h.html#a0e3e62a8831861ee9ebec5b109fd962d">palette_id</a> mapgen_palette::id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8h_source.html#l00309">309</a> of file <a class="el" href="mapgen_8h_source.html">mapgen.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04280">add()</a>, <a class="el" href="mapgen_8cpp_source.html#l04718">mapgen_function_json_base::check_common()</a>, and <a class="el" href="mapgen_8cpp_source.html#l04323">load_internal()</a>.</p>

</div>
</div>
<a id="a0bf6afe53988e0c41840803a6ac8f0f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bf6afe53988e0c41840803a6ac8f0f4">&#9670;&nbsp;</a></span>keys_with_terrain</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;<a class="el" href="classmap__key.html">map_key</a>&gt; mapgen_palette::keys_with_terrain</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8h_source.html#l00319">319</a> of file <a class="el" href="mapgen_8h_source.html">mapgen.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04280">add()</a>, <a class="el" href="mapgen_8cpp_source.html#l04323">load_internal()</a>, and <a class="el" href="mapgen_8cpp_source.html#l04531">mapgen_function_json_base::setup_common()</a>.</p>

</div>
</div>
<a id="a3caccf2fc5c4fe1adb5014f0e450a0e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3caccf2fc5c4fe1adb5014f0e450a0e3">&#9670;&nbsp;</a></span>palettes_used</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classmapgen__value.html">mapgen_value</a>&lt;std::string&gt; &gt; mapgen_palette::palettes_used</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8h_source.html#l00361">361</a> of file <a class="el" href="mapgen_8h_source.html">mapgen.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04280">add()</a>, and <a class="el" href="mapgen_8cpp_source.html#l04323">load_internal()</a>.</p>

</div>
</div>
<a id="a316845dd87256596e884b4046edbb269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a316845dd87256596e884b4046edbb269">&#9670;&nbsp;</a></span>parameters</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmapgen__parameters.html">mapgen_parameters</a> mapgen_palette::parameters</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mapgen_8h_source.html#l00356">356</a> of file <a class="el" href="mapgen_8h_source.html">mapgen.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="mapgen_8cpp_source.html#l04280">add()</a>, <a class="el" href="mapgen_8cpp_source.html#l04183">check()</a>, <a class="el" href="mapgen_8cpp_source.html#l04782">jmapgen_objects::check()</a>, <a class="el" href="mapgen_8cpp_source.html#l04718">mapgen_function_json_base::check_common()</a>, <a class="el" href="mapgen_8cpp_source.html#l05277">mapgen_function_json::get_mapgen_params()</a>, <a class="el" href="mapgen_8h_source.html#l00332">get_parameters()</a>, <a class="el" href="mapgen_8cpp_source.html#l04323">load_internal()</a>, and <a class="el" href="mapgen_8cpp_source.html#l04531">mapgen_function_json_base::setup_common()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="mapgen_8h_source.html">mapgen.h</a></li>
<li>src/<a class="el" href="mapgen_8cpp_source.html">mapgen.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue May 7 2024 08:48:41 for Cataclysm DDA by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
